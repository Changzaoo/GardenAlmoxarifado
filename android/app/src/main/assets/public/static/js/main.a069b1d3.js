/*! For license information please see main.a069b1d3.js.LICENSE.txt */
(()=>{var e={167:function(e,t,r){e.exports=function(e){return e.mode.CFB=function(){var t=e.lib.BlockCipherMode.extend();function r(e,t,r,a){var n,s=this._iv;s?(n=s.slice(0),this._iv=void 0):n=this._prevBlock,a.encryptBlock(n,0);for(var i=0;i<r;i++)e[t+i]^=n[i]}return t.Encryptor=t.extend({processBlock:function(e,t){var a=this._cipher,n=a.blockSize;r.call(this,e,t,n,a),this._prevBlock=e.slice(t,t+n)}}),t.Decryptor=t.extend({processBlock:function(e,t){var a=this._cipher,n=a.blockSize,s=e.slice(t,t+n);r.call(this,e,t,n,a),this._prevBlock=s}}),t}(),e.mode.CFB}(r(4703),r(7755))},306:(e,t,r)=>{"use strict";r.d(t,{Dc:()=>ve,gS:()=>uh,hq:()=>yh,collection:()=>Hd,deleteDoc:()=>dh,doc:()=>Gd,ol:()=>eu,x7:()=>sh,GG:()=>oh,aU:()=>Jd,GV:()=>vh,AB:()=>Gu,aQ:()=>hh,My:()=>qu,P:()=>Ou,O5:()=>xh,setDoc:()=>lh,HM:()=>Ku,updateDoc:()=>ch,_M:()=>zu,wP:()=>bh});var a,n,s=r(9379),i=r(8791),o=r(6863),l=r(2226),c=r(498),d="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{},u={};(function(){var e;function t(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}function r(e,t,r){r||(r=0);var a=Array(16);if("string"===typeof t)for(var n=0;16>n;++n)a[n]=t.charCodeAt(r++)|t.charCodeAt(r++)<<8|t.charCodeAt(r++)<<16|t.charCodeAt(r++)<<24;else for(n=0;16>n;++n)a[n]=t[r++]|t[r++]<<8|t[r++]<<16|t[r++]<<24;t=e.g[0],r=e.g[1],n=e.g[2];var s=e.g[3],i=t+(s^r&(n^s))+a[0]+3614090360&4294967295;i=(r=(n=(s=(t=(r=(n=(s=(t=(r=(n=(s=(t=(r=(n=(s=(t=(r=(n=(s=(t=(r=(n=(s=(t=(r=(n=(s=(t=(r=(n=(s=(t=(r=(n=(s=(t=(r=(n=(s=(t=(r=(n=(s=(t=(r=(n=(s=(t=(r=(n=(s=(t=(r=(n=(s=(t=(r=(n=(s=(t=r+(i<<7&4294967295|i>>>25))+((i=s+(n^t&(r^n))+a[1]+3905402710&4294967295)<<12&4294967295|i>>>20))+((i=n+(r^s&(t^r))+a[2]+606105819&4294967295)<<17&4294967295|i>>>15))+((i=r+(t^n&(s^t))+a[3]+3250441966&4294967295)<<22&4294967295|i>>>10))+((i=t+(s^r&(n^s))+a[4]+4118548399&4294967295)<<7&4294967295|i>>>25))+((i=s+(n^t&(r^n))+a[5]+1200080426&4294967295)<<12&4294967295|i>>>20))+((i=n+(r^s&(t^r))+a[6]+2821735955&4294967295)<<17&4294967295|i>>>15))+((i=r+(t^n&(s^t))+a[7]+4249261313&4294967295)<<22&4294967295|i>>>10))+((i=t+(s^r&(n^s))+a[8]+1770035416&4294967295)<<7&4294967295|i>>>25))+((i=s+(n^t&(r^n))+a[9]+2336552879&4294967295)<<12&4294967295|i>>>20))+((i=n+(r^s&(t^r))+a[10]+4294925233&4294967295)<<17&4294967295|i>>>15))+((i=r+(t^n&(s^t))+a[11]+2304563134&4294967295)<<22&4294967295|i>>>10))+((i=t+(s^r&(n^s))+a[12]+1804603682&4294967295)<<7&4294967295|i>>>25))+((i=s+(n^t&(r^n))+a[13]+4254626195&4294967295)<<12&4294967295|i>>>20))+((i=n+(r^s&(t^r))+a[14]+2792965006&4294967295)<<17&4294967295|i>>>15))+((i=r+(t^n&(s^t))+a[15]+1236535329&4294967295)<<22&4294967295|i>>>10))+((i=t+(n^s&(r^n))+a[1]+4129170786&4294967295)<<5&4294967295|i>>>27))+((i=s+(r^n&(t^r))+a[6]+3225465664&4294967295)<<9&4294967295|i>>>23))+((i=n+(t^r&(s^t))+a[11]+643717713&4294967295)<<14&4294967295|i>>>18))+((i=r+(s^t&(n^s))+a[0]+3921069994&4294967295)<<20&4294967295|i>>>12))+((i=t+(n^s&(r^n))+a[5]+3593408605&4294967295)<<5&4294967295|i>>>27))+((i=s+(r^n&(t^r))+a[10]+38016083&4294967295)<<9&4294967295|i>>>23))+((i=n+(t^r&(s^t))+a[15]+3634488961&4294967295)<<14&4294967295|i>>>18))+((i=r+(s^t&(n^s))+a[4]+3889429448&4294967295)<<20&4294967295|i>>>12))+((i=t+(n^s&(r^n))+a[9]+568446438&4294967295)<<5&4294967295|i>>>27))+((i=s+(r^n&(t^r))+a[14]+3275163606&4294967295)<<9&4294967295|i>>>23))+((i=n+(t^r&(s^t))+a[3]+4107603335&4294967295)<<14&4294967295|i>>>18))+((i=r+(s^t&(n^s))+a[8]+1163531501&4294967295)<<20&4294967295|i>>>12))+((i=t+(n^s&(r^n))+a[13]+2850285829&4294967295)<<5&4294967295|i>>>27))+((i=s+(r^n&(t^r))+a[2]+4243563512&4294967295)<<9&4294967295|i>>>23))+((i=n+(t^r&(s^t))+a[7]+1735328473&4294967295)<<14&4294967295|i>>>18))+((i=r+(s^t&(n^s))+a[12]+2368359562&4294967295)<<20&4294967295|i>>>12))+((i=t+(r^n^s)+a[5]+4294588738&4294967295)<<4&4294967295|i>>>28))+((i=s+(t^r^n)+a[8]+2272392833&4294967295)<<11&4294967295|i>>>21))+((i=n+(s^t^r)+a[11]+1839030562&4294967295)<<16&4294967295|i>>>16))+((i=r+(n^s^t)+a[14]+4259657740&4294967295)<<23&4294967295|i>>>9))+((i=t+(r^n^s)+a[1]+2763975236&4294967295)<<4&4294967295|i>>>28))+((i=s+(t^r^n)+a[4]+1272893353&4294967295)<<11&4294967295|i>>>21))+((i=n+(s^t^r)+a[7]+4139469664&4294967295)<<16&4294967295|i>>>16))+((i=r+(n^s^t)+a[10]+3200236656&4294967295)<<23&4294967295|i>>>9))+((i=t+(r^n^s)+a[13]+681279174&4294967295)<<4&4294967295|i>>>28))+((i=s+(t^r^n)+a[0]+3936430074&4294967295)<<11&4294967295|i>>>21))+((i=n+(s^t^r)+a[3]+3572445317&4294967295)<<16&4294967295|i>>>16))+((i=r+(n^s^t)+a[6]+76029189&4294967295)<<23&4294967295|i>>>9))+((i=t+(r^n^s)+a[9]+3654602809&4294967295)<<4&4294967295|i>>>28))+((i=s+(t^r^n)+a[12]+3873151461&4294967295)<<11&4294967295|i>>>21))+((i=n+(s^t^r)+a[15]+530742520&4294967295)<<16&4294967295|i>>>16))+((i=r+(n^s^t)+a[2]+3299628645&4294967295)<<23&4294967295|i>>>9))+((i=t+(n^(r|~s))+a[0]+4096336452&4294967295)<<6&4294967295|i>>>26))+((i=s+(r^(t|~n))+a[7]+1126891415&4294967295)<<10&4294967295|i>>>22))+((i=n+(t^(s|~r))+a[14]+2878612391&4294967295)<<15&4294967295|i>>>17))+((i=r+(s^(n|~t))+a[5]+4237533241&4294967295)<<21&4294967295|i>>>11))+((i=t+(n^(r|~s))+a[12]+1700485571&4294967295)<<6&4294967295|i>>>26))+((i=s+(r^(t|~n))+a[3]+2399980690&4294967295)<<10&4294967295|i>>>22))+((i=n+(t^(s|~r))+a[10]+4293915773&4294967295)<<15&4294967295|i>>>17))+((i=r+(s^(n|~t))+a[1]+2240044497&4294967295)<<21&4294967295|i>>>11))+((i=t+(n^(r|~s))+a[8]+1873313359&4294967295)<<6&4294967295|i>>>26))+((i=s+(r^(t|~n))+a[15]+4264355552&4294967295)<<10&4294967295|i>>>22))+((i=n+(t^(s|~r))+a[6]+2734768916&4294967295)<<15&4294967295|i>>>17))+((i=r+(s^(n|~t))+a[13]+1309151649&4294967295)<<21&4294967295|i>>>11))+((s=(t=r+((i=t+(n^(r|~s))+a[4]+4149444226&4294967295)<<6&4294967295|i>>>26))+((i=s+(r^(t|~n))+a[11]+3174756917&4294967295)<<10&4294967295|i>>>22))^((n=s+((i=n+(t^(s|~r))+a[2]+718787259&4294967295)<<15&4294967295|i>>>17))|~t))+a[9]+3951481745&4294967295,e.g[0]=e.g[0]+t&4294967295,e.g[1]=e.g[1]+(n+(i<<21&4294967295|i>>>11))&4294967295,e.g[2]=e.g[2]+n&4294967295,e.g[3]=e.g[3]+s&4294967295}function s(e,t){this.h=t;for(var r=[],a=!0,n=e.length-1;0<=n;n--){var s=0|e[n];a&&s==t||(r[n]=s,a=!1)}this.g=r}!function(e,t){function r(){}r.prototype=t.prototype,e.D=t.prototype,e.prototype=new r,e.prototype.constructor=e,e.C=function(e,r,a){for(var n=Array(arguments.length-2),s=2;s<arguments.length;s++)n[s-2]=arguments[s];return t.prototype[r].apply(e,n)}}(t,function(){this.blockSize=-1}),t.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0},t.prototype.u=function(e,t){void 0===t&&(t=e.length);for(var a=t-this.blockSize,n=this.B,s=this.h,i=0;i<t;){if(0==s)for(;i<=a;)r(this,e,i),i+=this.blockSize;if("string"===typeof e){for(;i<t;)if(n[s++]=e.charCodeAt(i++),s==this.blockSize){r(this,n),s=0;break}}else for(;i<t;)if(n[s++]=e[i++],s==this.blockSize){r(this,n),s=0;break}}this.h=s,this.o+=t},t.prototype.v=function(){var e=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;var r=8*this.o;for(t=e.length-8;t<e.length;++t)e[t]=255&r,r/=256;for(this.u(e),e=Array(16),t=r=0;4>t;++t)for(var a=0;32>a;a+=8)e[r++]=this.g[t]>>>a&255;return e};var i={};function o(e){return-128<=e&&128>e?function(e,t){var r=i;return Object.prototype.hasOwnProperty.call(r,e)?r[e]:r[e]=t(e)}(e,function(e){return new s([0|e],0>e?-1:0)}):new s([0|e],0>e?-1:0)}function l(e){if(isNaN(e)||!isFinite(e))return c;if(0>e)return g(l(-e));for(var t=[],r=1,a=0;e>=r;a++)t[a]=e/r|0,r*=4294967296;return new s(t,0)}var c=o(0),d=o(1),h=o(16777216);function m(e){if(0!=e.h)return!1;for(var t=0;t<e.g.length;t++)if(0!=e.g[t])return!1;return!0}function f(e){return-1==e.h}function g(e){for(var t=e.g.length,r=[],a=0;a<t;a++)r[a]=~e.g[a];return new s(r,~e.h).add(d)}function p(e,t){return e.add(g(t))}function x(e,t){for(;(65535&e[t])!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function y(e,t){this.g=e,this.h=t}function v(e,t){if(m(t))throw Error("division by zero");if(m(e))return new y(c,c);if(f(e))return t=v(g(e),t),new y(g(t.g),g(t.h));if(f(t))return t=v(e,g(t)),new y(g(t.g),t.h);if(30<e.g.length){if(f(e)||f(t))throw Error("slowDivide_ only works with positive integers.");for(var r=d,a=t;0>=a.l(e);)r=b(r),a=b(a);var n=w(r,1),s=w(a,1);for(a=w(a,2),r=w(r,2);!m(a);){var i=s.add(a);0>=i.l(e)&&(n=n.add(r),s=i),a=w(a,1),r=w(r,1)}return t=p(e,n.j(t)),new y(n,t)}for(n=c;0<=e.l(t);){for(r=Math.max(1,Math.floor(e.m()/t.m())),a=48>=(a=Math.ceil(Math.log(r)/Math.LN2))?1:Math.pow(2,a-48),i=(s=l(r)).j(t);f(i)||0<i.l(e);)i=(s=l(r-=a)).j(t);m(s)&&(s=d),n=n.add(s),e=p(e,i)}return new y(n,e)}function b(e){for(var t=e.g.length+1,r=[],a=0;a<t;a++)r[a]=e.i(a)<<1|e.i(a-1)>>>31;return new s(r,e.h)}function w(e,t){var r=t>>5;t%=32;for(var a=e.g.length-r,n=[],i=0;i<a;i++)n[i]=0<t?e.i(i+r)>>>t|e.i(i+r+1)<<32-t:e.i(i+r);return new s(n,e.h)}(e=s.prototype).m=function(){if(f(this))return-g(this).m();for(var e=0,t=1,r=0;r<this.g.length;r++){var a=this.i(r);e+=(0<=a?a:4294967296+a)*t,t*=4294967296}return e},e.toString=function(e){if(2>(e=e||10)||36<e)throw Error("radix out of range: "+e);if(m(this))return"0";if(f(this))return"-"+g(this).toString(e);for(var t=l(Math.pow(e,6)),r=this,a="";;){var n=v(r,t).g,s=((0<(r=p(r,n.j(t))).g.length?r.g[0]:r.h)>>>0).toString(e);if(m(r=n))return s+a;for(;6>s.length;)s="0"+s;a=s+a}},e.i=function(e){return 0>e?0:e<this.g.length?this.g[e]:this.h},e.l=function(e){return f(e=p(this,e))?-1:m(e)?0:1},e.abs=function(){return f(this)?g(this):this},e.add=function(e){for(var t=Math.max(this.g.length,e.g.length),r=[],a=0,n=0;n<=t;n++){var i=a+(65535&this.i(n))+(65535&e.i(n)),o=(i>>>16)+(this.i(n)>>>16)+(e.i(n)>>>16);a=o>>>16,i&=65535,o&=65535,r[n]=o<<16|i}return new s(r,-2147483648&r[r.length-1]?-1:0)},e.j=function(e){if(m(this)||m(e))return c;if(f(this))return f(e)?g(this).j(g(e)):g(g(this).j(e));if(f(e))return g(this.j(g(e)));if(0>this.l(h)&&0>e.l(h))return l(this.m()*e.m());for(var t=this.g.length+e.g.length,r=[],a=0;a<2*t;a++)r[a]=0;for(a=0;a<this.g.length;a++)for(var n=0;n<e.g.length;n++){var i=this.i(a)>>>16,o=65535&this.i(a),d=e.i(n)>>>16,u=65535&e.i(n);r[2*a+2*n]+=o*u,x(r,2*a+2*n),r[2*a+2*n+1]+=i*u,x(r,2*a+2*n+1),r[2*a+2*n+1]+=o*d,x(r,2*a+2*n+1),r[2*a+2*n+2]+=i*d,x(r,2*a+2*n+2)}for(a=0;a<t;a++)r[a]=r[2*a+1]<<16|r[2*a];for(a=t;a<2*t;a++)r[a]=0;return new s(r,0)},e.A=function(e){return v(this,e).h},e.and=function(e){for(var t=Math.max(this.g.length,e.g.length),r=[],a=0;a<t;a++)r[a]=this.i(a)&e.i(a);return new s(r,this.h&e.h)},e.or=function(e){for(var t=Math.max(this.g.length,e.g.length),r=[],a=0;a<t;a++)r[a]=this.i(a)|e.i(a);return new s(r,this.h|e.h)},e.xor=function(e){for(var t=Math.max(this.g.length,e.g.length),r=[],a=0;a<t;a++)r[a]=this.i(a)^e.i(a);return new s(r,this.h^e.h)},t.prototype.digest=t.prototype.v,t.prototype.reset=t.prototype.s,t.prototype.update=t.prototype.u,n=u.Md5=t,s.prototype.add=s.prototype.add,s.prototype.multiply=s.prototype.j,s.prototype.modulo=s.prototype.A,s.prototype.compare=s.prototype.l,s.prototype.toNumber=s.prototype.m,s.prototype.toString=s.prototype.toString,s.prototype.getBits=s.prototype.i,s.fromNumber=l,s.fromString=function e(t,r){if(0==t.length)throw Error("number format error: empty string");if(2>(r=r||10)||36<r)throw Error("radix out of range: "+r);if("-"==t.charAt(0))return g(e(t.substring(1),r));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var a=l(Math.pow(r,8)),n=c,s=0;s<t.length;s+=8){var i=Math.min(8,t.length-s),o=parseInt(t.substring(s,s+i),r);8>i?(i=l(Math.pow(r,i)),n=n.j(i).add(l(o))):n=(n=n.j(a)).add(l(o))}return n},a=u.Integer=s}).apply("undefined"!==typeof d?d:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{});var h,m,f,g,p,x,y,v,b="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{},w={};(function(){var e,t="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,r){return e==Array.prototype||e==Object.prototype||(e[t]=r.value),e};var r=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof b&&b];for(var t=0;t<e.length;++t){var r=e[t];if(r&&r.Math==Math)return r}throw Error("Cannot find global object")}(this);!function(e,a){if(a)e:{var n=r;e=e.split(".");for(var s=0;s<e.length-1;s++){var i=e[s];if(!(i in n))break e;n=n[i]}(a=a(s=n[e=e[e.length-1]]))!=s&&null!=a&&t(n,e,{configurable:!0,writable:!0,value:a})}}("Array.prototype.values",function(e){return e||function(){return function(e,t){e instanceof String&&(e+="");var r=0,a=!1,n={next:function(){if(!a&&r<e.length){var n=r++;return{value:t(n,e[n]),done:!1}}return a=!0,{done:!0,value:void 0}}};return n[Symbol.iterator]=function(){return n},n}(this,function(e,t){return t})}});var a=a||{},n=this||self;function s(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function i(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}function o(e,t,r){return e.call.apply(e.bind,arguments)}function l(e,t,r){if(!e)throw Error();if(2<arguments.length){var a=Array.prototype.slice.call(arguments,2);return function(){var r=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(r,a),e.apply(t,r)}}return function(){return e.apply(t,arguments)}}function c(e,t,r){return(c=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?o:l).apply(null,arguments)}function d(e,t){var r=Array.prototype.slice.call(arguments,1);return function(){var t=r.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function u(e,t){function r(){}r.prototype=t.prototype,e.aa=t.prototype,e.prototype=new r,e.prototype.constructor=e,e.Qb=function(e,r,a){for(var n=Array(arguments.length-2),s=2;s<arguments.length;s++)n[s-2]=arguments[s];return t.prototype[r].apply(e,n)}}function k(e){const t=e.length;if(0<t){const r=Array(t);for(let a=0;a<t;a++)r[a]=e[a];return r}return[]}function N(e,t){for(let r=1;r<arguments.length;r++){const t=arguments[r];if(s(t)){const r=e.length||0,a=t.length||0;e.length=r+a;for(let n=0;n<a;n++)e[r+n]=t[n]}else e.push(t)}}function j(e){return/^[\s\xa0]*$/.test(e)}function S(){var e=n.navigator;return e&&(e=e.userAgent)?e:""}function _(e){return _[" "](e),e}_[" "]=function(){};var E=-1!=S().indexOf("Gecko")&&!(-1!=S().toLowerCase().indexOf("webkit")&&-1==S().indexOf("Edge"))&&!(-1!=S().indexOf("Trident")||-1!=S().indexOf("MSIE"))&&-1==S().indexOf("Edge");function A(e,t,r){for(const a in e)t.call(r,e[a],a,e)}function C(e){const t={};for(const r in e)t[r]=e[r];return t}const I="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function T(e,t){let r,a;for(let n=1;n<arguments.length;n++){for(r in a=arguments[n],a)e[r]=a[r];for(let t=0;t<I.length;t++)r=I[t],Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}}function D(e){var t=1;e=e.split(":");const r=[];for(;0<t&&e.length;)r.push(e.shift()),t--;return e.length&&r.push(e.join(":")),r}function P(e){n.setTimeout(()=>{throw e},0)}function F(){var e=B;let t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var L=new class{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}(()=>new M,e=>e.reset());class M{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}let R,O=!1,B=new class{constructor(){this.h=this.g=null}add(e,t){const r=L.get();r.set(e,t),this.h?this.h.next=r:this.g=r,this.h=r}},z=()=>{const e=n.Promise.resolve(void 0);R=()=>{e.then(U)}};var U=()=>{for(var e;e=F();){try{e.h.call(e.g)}catch(r){P(r)}var t=L;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}O=!1};function V(){this.s=this.s,this.C=this.C}function q(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}V.prototype.s=!1,V.prototype.ma=function(){this.s||(this.s=!0,this.N())},V.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()},q.prototype.h=function(){this.defaultPrevented=!0};var H=function(){if(!n.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{const e=()=>{};n.addEventListener("test",e,t),n.removeEventListener("test",e,t)}catch(r){}return e}();function G(e,t){if(q.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var r=this.type=e.type,a=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(E){e:{try{_(t.nodeName);var n=!0;break e}catch(s){}n=!1}n||(t=null)}}else"mouseover"==r?t=e.fromElement:"mouseout"==r&&(t=e.toElement);this.relatedTarget=t,a?(this.clientX=void 0!==a.clientX?a.clientX:a.pageX,this.clientY=void 0!==a.clientY?a.clientY:a.pageY,this.screenX=a.screenX||0,this.screenY=a.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"===typeof e.pointerType?e.pointerType:W[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&G.aa.h.call(this)}}u(G,q);var W={2:"touch",3:"pen",4:"mouse"};G.prototype.h=function(){G.aa.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var K="closure_listenable_"+(1e6*Math.random()|0),Q=0;function Y(e,t,r,a,n){this.listener=e,this.proxy=null,this.src=t,this.type=r,this.capture=!!a,this.ha=n,this.key=++Q,this.da=this.fa=!1}function X(e){e.da=!0,e.listener=null,e.proxy=null,e.src=null,e.ha=null}function J(e){this.src=e,this.g={},this.h=0}function Z(e,t){var r=t.type;if(r in e.g){var a,n=e.g[r],s=Array.prototype.indexOf.call(n,t,void 0);(a=0<=s)&&Array.prototype.splice.call(n,s,1),a&&(X(t),0==e.g[r].length&&(delete e.g[r],e.h--))}}function $(e,t,r,a){for(var n=0;n<e.length;++n){var s=e[n];if(!s.da&&s.listener==t&&s.capture==!!r&&s.ha==a)return n}return-1}J.prototype.add=function(e,t,r,a,n){var s=e.toString();(e=this.g[s])||(e=this.g[s]=[],this.h++);var i=$(e,t,a,n);return-1<i?(t=e[i],r||(t.fa=!1)):((t=new Y(t,this.src,s,!!a,n)).fa=r,e.push(t)),t};var ee="closure_lm_"+(1e6*Math.random()|0),te={};function re(e,t,r,a,n){if(a&&a.once)return ne(e,t,r,a,n);if(Array.isArray(t)){for(var s=0;s<t.length;s++)re(e,t[s],r,a,n);return null}return r=ue(r),e&&e[K]?e.K(t,r,i(a)?!!a.capture:!!a,n):ae(e,t,r,!1,a,n)}function ae(e,t,r,a,n,s){if(!t)throw Error("Invalid event type");var o=i(n)?!!n.capture:!!n,l=ce(e);if(l||(e[ee]=l=new J(e)),(r=l.add(t,r,a,o,s)).proxy)return r;if(a=function(){function e(r){return t.call(e.src,e.listener,r)}const t=le;return e}(),r.proxy=a,a.src=e,a.listener=r,e.addEventListener)H||(n=o),void 0===n&&(n=!1),e.addEventListener(t.toString(),a,n);else if(e.attachEvent)e.attachEvent(oe(t.toString()),a);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(a)}return r}function ne(e,t,r,a,n){if(Array.isArray(t)){for(var s=0;s<t.length;s++)ne(e,t[s],r,a,n);return null}return r=ue(r),e&&e[K]?e.L(t,r,i(a)?!!a.capture:!!a,n):ae(e,t,r,!0,a,n)}function se(e,t,r,a,n){if(Array.isArray(t))for(var s=0;s<t.length;s++)se(e,t[s],r,a,n);else a=i(a)?!!a.capture:!!a,r=ue(r),e&&e[K]?(e=e.i,(t=String(t).toString())in e.g&&(-1<(r=$(s=e.g[t],r,a,n))&&(X(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.g[t],e.h--)))):e&&(e=ce(e))&&(t=e.g[t.toString()],e=-1,t&&(e=$(t,r,a,n)),(r=-1<e?t[e]:null)&&ie(r))}function ie(e){if("number"!==typeof e&&e&&!e.da){var t=e.src;if(t&&t[K])Z(t.i,e);else{var r=e.type,a=e.proxy;t.removeEventListener?t.removeEventListener(r,a,e.capture):t.detachEvent?t.detachEvent(oe(r),a):t.addListener&&t.removeListener&&t.removeListener(a),(r=ce(t))?(Z(r,e),0==r.h&&(r.src=null,t[ee]=null)):X(e)}}}function oe(e){return e in te?te[e]:te[e]="on"+e}function le(e,t){if(e.da)e=!0;else{t=new G(t,this);var r=e.listener,a=e.ha||e.src;e.fa&&ie(e),e=r.call(a,t)}return e}function ce(e){return(e=e[ee])instanceof J?e:null}var de="__closure_events_fn_"+(1e9*Math.random()>>>0);function ue(e){return"function"===typeof e?e:(e[de]||(e[de]=function(t){return e.handleEvent(t)}),e[de])}function he(){V.call(this),this.i=new J(this),this.M=this,this.F=null}function me(e,t){var r,a=e.F;if(a)for(r=[];a;a=a.F)r.push(a);if(e=e.M,a=t.type||t,"string"===typeof t)t=new q(t,e);else if(t instanceof q)t.target=t.target||e;else{var n=t;T(t=new q(a,e),n)}if(n=!0,r)for(var s=r.length-1;0<=s;s--){var i=t.g=r[s];n=fe(i,a,!0,t)&&n}if(n=fe(i=t.g=e,a,!0,t)&&n,n=fe(i,a,!1,t)&&n,r)for(s=0;s<r.length;s++)n=fe(i=t.g=r[s],a,!1,t)&&n}function fe(e,t,r,a){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var n=!0,s=0;s<t.length;++s){var i=t[s];if(i&&!i.da&&i.capture==r){var o=i.listener,l=i.ha||i.src;i.fa&&Z(e.i,i),n=!1!==o.call(l,a)&&n}}return n&&!a.defaultPrevented}function ge(e,t,r){if("function"===typeof e)r&&(e=c(e,r));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=c(e.handleEvent,e)}return 2147483647<Number(t)?-1:n.setTimeout(e,t||0)}function pe(e){e.g=ge(()=>{e.g=null,e.i&&(e.i=!1,pe(e))},e.l);const t=e.h;e.h=null,e.m.apply(null,t)}u(he,V),he.prototype[K]=!0,he.prototype.removeEventListener=function(e,t,r,a){se(this,e,t,r,a)},he.prototype.N=function(){if(he.aa.N.call(this),this.i){var e,t=this.i;for(e in t.g){for(var r=t.g[e],a=0;a<r.length;a++)X(r[a]);delete t.g[e],t.h--}}this.F=null},he.prototype.K=function(e,t,r,a){return this.i.add(String(e),t,!1,r,a)},he.prototype.L=function(e,t,r,a){return this.i.add(String(e),t,!0,r,a)};class xe extends V{constructor(e,t){super(),this.m=e,this.l=t,this.h=null,this.i=!1,this.g=null}j(e){this.h=arguments,this.g?this.i=!0:pe(this)}N(){super.N(),this.g&&(n.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ye(e){V.call(this),this.h=e,this.g={}}u(ye,V);var ve=[];function be(e){A(e.g,function(e,t){this.g.hasOwnProperty(t)&&ie(e)},e),e.g={}}ye.prototype.N=function(){ye.aa.N.call(this),be(this)},ye.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var we=n.JSON.stringify,ke=n.JSON.parse,Ne=class{stringify(e){return n.JSON.stringify(e,void 0)}parse(e){return n.JSON.parse(e,void 0)}};function je(){}function Se(e){return e.h||(e.h=e.i())}function _e(){}je.prototype.h=null;var Ee={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Ae(){q.call(this,"d")}function Ce(){q.call(this,"c")}u(Ae,q),u(Ce,q);var Ie={},Te=null;function De(){return Te=Te||new he}function Pe(e){q.call(this,Ie.La,e)}function Fe(e){const t=De();me(t,new Pe(t))}function Le(e,t){q.call(this,Ie.STAT_EVENT,e),this.stat=t}function Me(e){const t=De();me(t,new Le(t,e))}function Re(e,t){q.call(this,Ie.Ma,e),this.size=t}function Oe(e,t){if("function"!==typeof e)throw Error("Fn must not be null and must be a function");return n.setTimeout(function(){e()},t)}function Be(){this.g=!0}function ze(e,t,r,a){e.info(function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var r=JSON.parse(t);if(r)for(e=0;e<r.length;e++)if(Array.isArray(r[e])){var a=r[e];if(!(2>a.length)){var n=a[1];if(Array.isArray(n)&&!(1>n.length)){var s=n[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var i=1;i<n.length;i++)n[i]=""}}}return we(r)}catch(o){return t}}(e,r)+(a?" "+a:"")})}Ie.La="serverreachability",u(Pe,q),Ie.STAT_EVENT="statevent",u(Le,q),Ie.Ma="timingevent",u(Re,q),Be.prototype.xa=function(){this.g=!1},Be.prototype.info=function(){};var Ue,Ve={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},qe={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"};function He(){}function Ge(e,t,r,a){this.j=e,this.i=t,this.l=r,this.R=a||1,this.U=new ye(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new We}function We(){this.i=null,this.g="",this.h=!1}u(He,je),He.prototype.g=function(){return new XMLHttpRequest},He.prototype.i=function(){return{}},Ue=new He;var Ke={},Qe={};function Ye(e,t,r){e.L=1,e.v=wt(pt(t)),e.m=r,e.P=!0,Xe(e,null)}function Xe(e,t){e.F=Date.now(),$e(e),e.A=pt(e.v);var r=e.A,a=e.R;Array.isArray(a)||(a=[String(a)]),Lt(r.i,"t",a),e.C=0,r=e.j.J,e.h=new We,e.g=kr(e.j,r?t:null,!e.m),0<e.O&&(e.M=new xe(c(e.Y,e,e.g),e.O)),t=e.U,r=e.g,a=e.ca;var n="readystatechange";Array.isArray(n)||(n&&(ve[0]=n.toString()),n=ve);for(var s=0;s<n.length;s++){var i=re(r,n[s],a||t.handleEvent,!1,t.h||t);if(!i)break;t.g[i.key]=i}t=e.H?C(e.H):{},e.m?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ea(e.A,e.u,e.m,t)):(e.u="GET",e.g.ea(e.A,e.u,null,t)),Fe(),function(e,t,r,a,n,s){e.info(function(){if(e.g)if(s)for(var i="",o=s.split("&"),l=0;l<o.length;l++){var c=o[l].split("=");if(1<c.length){var d=c[0];c=c[1];var u=d.split("_");i=2<=u.length&&"type"==u[1]?i+(d+"=")+c+"&":i+(d+"=redacted&")}}else i=null;else i=s;return"XMLHTTP REQ ("+a+") [attempt "+n+"]: "+t+"\n"+r+"\n"+i})}(e.i,e.u,e.A,e.l,e.R,e.m)}function Je(e){return!!e.g&&("GET"==e.u&&2!=e.L&&e.j.Ca)}function Ze(e,t){var r=e.C,a=t.indexOf("\n",r);return-1==a?Qe:(r=Number(t.substring(r,a)),isNaN(r)?Ke:(a+=1)+r>t.length?Qe:(t=t.slice(a,a+r),e.C=a+r,t))}function $e(e){e.S=Date.now()+e.I,et(e,e.I)}function et(e,t){if(null!=e.B)throw Error("WatchDog timer not null");e.B=Oe(c(e.ba,e),t)}function tt(e){e.B&&(n.clearTimeout(e.B),e.B=null)}function rt(e){0==e.j.G||e.J||xr(e.j,e)}function at(e){tt(e);var t=e.M;t&&"function"==typeof t.ma&&t.ma(),e.M=null,be(e.U),e.g&&(t=e.g,e.g=null,t.abort(),t.ma())}function nt(e,t){try{var r=e.j;if(0!=r.G&&(r.g==e||ct(r.h,e)))if(!e.K&&ct(r.h,e)&&3==r.G){try{var a=r.Da.g.parse(t)}catch(d){a=null}if(Array.isArray(a)&&3==a.length){var n=a;if(0==n[0]){e:if(!r.u){if(r.g){if(!(r.g.F+3e3<e.F))break e;pr(r),ir(r)}mr(r),Me(18)}}else r.za=n[1],0<r.za-r.T&&37500>n[2]&&r.F&&0==r.v&&!r.C&&(r.C=Oe(c(r.Za,r),6e3));if(1>=lt(r.h)&&r.ca){try{r.ca()}catch(d){}r.ca=void 0}}else vr(r,11)}else if((e.K||r.g==e)&&pr(r),!j(t))for(n=r.Da.g.parse(t),t=0;t<n.length;t++){let c=n[t];if(r.T=c[0],c=c[1],2==r.G)if("c"==c[0]){r.K=c[1],r.ia=c[2];const t=c[3];null!=t&&(r.la=t,r.j.info("VER="+r.la));const n=c[4];null!=n&&(r.Aa=n,r.j.info("SVER="+r.Aa));const d=c[5];null!=d&&"number"===typeof d&&0<d&&(a=1.5*d,r.L=a,r.j.info("backChannelRequestTimeoutMs_="+a)),a=r;const u=e.g;if(u){const e=u.g?u.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(e){var s=a.h;s.g||-1==e.indexOf("spdy")&&-1==e.indexOf("quic")&&-1==e.indexOf("h2")||(s.j=s.l,s.g=new Set,s.h&&(dt(s,s.h),s.h=null))}if(a.D){const e=u.g?u.g.getResponseHeader("X-HTTP-Session-Id"):null;e&&(a.ya=e,bt(a.I,a.D,e))}}r.G=3,r.l&&r.l.ua(),r.ba&&(r.R=Date.now()-e.F,r.j.info("Handshake RTT: "+r.R+"ms"));var i=e;if((a=r).qa=wr(a,a.J?a.ia:null,a.W),i.K){ut(a.h,i);var o=i,l=a.L;l&&(o.I=l),o.B&&(tt(o),$e(o)),a.g=i}else hr(a);0<r.i.length&&lr(r)}else"stop"!=c[0]&&"close"!=c[0]||vr(r,7);else 3==r.G&&("stop"==c[0]||"close"==c[0]?"stop"==c[0]?vr(r,7):sr(r):"noop"!=c[0]&&r.l&&r.l.ta(c),r.v=0)}Fe()}catch(d){}}Ge.prototype.ca=function(e){e=e.target;const t=this.M;t&&3==tr(e)?t.j():this.Y(e)},Ge.prototype.Y=function(e){try{if(e==this.g)e:{const h=tr(this.g);var t=this.g.Ba();this.g.Z();if(!(3>h)&&(3!=h||this.g&&(this.h.h||this.g.oa()||rr(this.g)))){this.J||4!=h||7==t||Fe(),tt(this);var r=this.g.Z();this.X=r;t:if(Je(this)){var a=rr(this.g);e="";var s=a.length,i=4==tr(this.g);if(!this.h.i){if("undefined"===typeof TextDecoder){at(this),rt(this);var o="";break t}this.h.i=new n.TextDecoder}for(t=0;t<s;t++)this.h.h=!0,e+=this.h.i.decode(a[t],{stream:!(i&&t==s-1)});a.length=0,this.h.g+=e,this.C=0,o=this.h.g}else o=this.g.oa();if(this.o=200==r,function(e,t,r,a,n,s,i){e.info(function(){return"XMLHTTP RESP ("+a+") [ attempt "+n+"]: "+t+"\n"+r+"\n"+s+" "+i})}(this.i,this.u,this.A,this.l,this.R,h,r),this.o){if(this.T&&!this.K){t:{if(this.g){var l,c=this.g;if((l=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!j(l)){var d=l;break t}}d=null}if(!(r=d)){this.o=!1,this.s=3,Me(12),at(this),rt(this);break e}ze(this.i,this.l,r,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,nt(this,r)}if(this.P){let e;for(r=!0;!this.J&&this.C<o.length;){if(e=Ze(this,o),e==Qe){4==h&&(this.s=4,Me(14),r=!1),ze(this.i,this.l,null,"[Incomplete Response]");break}if(e==Ke){this.s=4,Me(15),ze(this.i,this.l,o,"[Invalid Chunk]"),r=!1;break}ze(this.i,this.l,e,null),nt(this,e)}if(Je(this)&&0!=this.C&&(this.h.g=this.h.g.slice(this.C),this.C=0),4!=h||0!=o.length||this.h.h||(this.s=1,Me(16),r=!1),this.o=this.o&&r,r){if(0<o.length&&!this.W){this.W=!0;var u=this.j;u.g==this&&u.ba&&!u.M&&(u.j.info("Great, no buffering proxy detected. Bytes received: "+o.length),fr(u),u.M=!0,Me(11))}}else ze(this.i,this.l,o,"[Invalid Chunked Response]"),at(this),rt(this)}else ze(this.i,this.l,o,null),nt(this,o);4==h&&at(this),this.o&&!this.J&&(4==h?xr(this.j,this):(this.o=!1,$e(this)))}else(function(e){const t={};e=(e.g&&2<=tr(e)&&e.g.getAllResponseHeaders()||"").split("\r\n");for(let a=0;a<e.length;a++){if(j(e[a]))continue;var r=D(e[a]);const n=r[0];if("string"!==typeof(r=r[1]))continue;r=r.trim();const s=t[n]||[];t[n]=s,s.push(r)}!function(e,t){for(const r in e)t.call(void 0,e[r],r,e)}(t,function(e){return e.join(", ")})})(this.g),400==r&&0<o.indexOf("Unknown SID")?(this.s=3,Me(12)):(this.s=0,Me(13)),at(this),rt(this)}}}catch(h){}},Ge.prototype.cancel=function(){this.J=!0,at(this)},Ge.prototype.ba=function(){this.B=null;const e=Date.now();0<=e-this.S?(function(e,t){e.info(function(){return"TIMEOUT: "+t})}(this.i,this.A),2!=this.L&&(Fe(),Me(17)),at(this),this.s=2,rt(this)):et(this,this.S-e)};var st=class{constructor(e,t){this.g=e,this.map=t}};function it(e){this.l=e||10,n.PerformanceNavigationTiming?e=0<(e=n.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):e=!!(n.chrome&&n.chrome.loadTimes&&n.chrome.loadTimes()&&n.chrome.loadTimes().wasFetchedViaSpdy),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function ot(e){return!!e.h||!!e.g&&e.g.size>=e.j}function lt(e){return e.h?1:e.g?e.g.size:0}function ct(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function dt(e,t){e.g?e.g.add(t):e.h=t}function ut(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function ht(e){if(null!=e.h)return e.i.concat(e.h.D);if(null!=e.g&&0!==e.g.size){let t=e.i;for(const r of e.g.values())t=t.concat(r.D);return t}return k(e.i)}function mt(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(s(e)||"string"===typeof e)Array.prototype.forEach.call(e,t,void 0);else for(var r=function(e){if(e.na&&"function"==typeof e.na)return e.na();if(!e.V||"function"!=typeof e.V){if("undefined"!==typeof Map&&e instanceof Map)return Array.from(e.keys());if(!("undefined"!==typeof Set&&e instanceof Set)){if(s(e)||"string"===typeof e){var t=[];e=e.length;for(var r=0;r<e;r++)t.push(r);return t}t=[],r=0;for(const a in e)t[r++]=a;return t}}}(e),a=function(e){if(e.V&&"function"==typeof e.V)return e.V();if("undefined"!==typeof Map&&e instanceof Map||"undefined"!==typeof Set&&e instanceof Set)return Array.from(e.values());if("string"===typeof e)return e.split("");if(s(e)){for(var t=[],r=e.length,a=0;a<r;a++)t.push(e[a]);return t}for(a in t=[],r=0,e)t[r++]=e[a];return t}(e),n=a.length,i=0;i<n;i++)t.call(void 0,a[i],r&&r[i],e)}it.prototype.cancel=function(){if(this.i=ht(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const e of this.g.values())e.cancel();this.g.clear()}};var ft=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function gt(e){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,e instanceof gt){this.h=e.h,xt(this,e.j),this.o=e.o,this.g=e.g,yt(this,e.s),this.l=e.l;var t=e.i,r=new Tt;r.i=t.i,t.g&&(r.g=new Map(t.g),r.h=t.h),vt(this,r),this.m=e.m}else e&&(t=String(e).match(ft))?(this.h=!1,xt(this,t[1]||"",!0),this.o=kt(t[2]||""),this.g=kt(t[3]||"",!0),yt(this,t[4]),this.l=kt(t[5]||"",!0),vt(this,t[6]||"",!0),this.m=kt(t[7]||"")):(this.h=!1,this.i=new Tt(null,this.h))}function pt(e){return new gt(e)}function xt(e,t,r){e.j=r?kt(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function yt(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.s=t}else e.s=null}function vt(e,t,r){t instanceof Tt?(e.i=t,function(e,t){t&&!e.j&&(Dt(e),e.i=null,e.g.forEach(function(e,t){var r=t.toLowerCase();t!=r&&(Pt(this,t),Lt(this,r,e))},e)),e.j=t}(e.i,e.h)):(r||(t=Nt(t,Ct)),e.i=new Tt(t,e.h))}function bt(e,t,r){e.i.set(t,r)}function wt(e){return bt(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function kt(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function Nt(e,t,r){return"string"===typeof e?(e=encodeURI(e).replace(t,jt),r&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function jt(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}gt.prototype.toString=function(){var e=[],t=this.j;t&&e.push(Nt(t,_t,!0),":");var r=this.g;return(r||"file"==t)&&(e.push("//"),(t=this.o)&&e.push(Nt(t,_t,!0),"@"),e.push(encodeURIComponent(String(r)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(r=this.s)&&e.push(":",String(r))),(r=this.l)&&(this.g&&"/"!=r.charAt(0)&&e.push("/"),e.push(Nt(r,"/"==r.charAt(0)?At:Et,!0))),(r=this.i.toString())&&e.push("?",r),(r=this.m)&&e.push("#",Nt(r,It)),e.join("")};var St,_t=/[#\/\?@]/g,Et=/[#\?:]/g,At=/[#\?]/g,Ct=/[#\?@]/g,It=/#/g;function Tt(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function Dt(e){e.g||(e.g=new Map,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var r=0;r<e.length;r++){var a=e[r].indexOf("="),n=null;if(0<=a){var s=e[r].substring(0,a);n=e[r].substring(a+1)}else s=e[r];t(s,n?decodeURIComponent(n.replace(/\+/g," ")):"")}}}(e.i,function(t,r){e.add(decodeURIComponent(t.replace(/\+/g," ")),r)}))}function Pt(e,t){Dt(e),t=Mt(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function Ft(e,t){return Dt(e),t=Mt(e,t),e.g.has(t)}function Lt(e,t,r){Pt(e,t),0<r.length&&(e.i=null,e.g.set(Mt(e,t),k(r)),e.h+=r.length)}function Mt(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}function Rt(e,t,r,a,n){try{n&&(n.onload=null,n.onerror=null,n.onabort=null,n.ontimeout=null),a(r)}catch(s){}}function Ot(){this.g=new Ne}function Bt(e,t,r){const a=r||"";try{mt(e,function(e,r){let n=e;i(e)&&(n=we(e)),t.push(a+r+"="+encodeURIComponent(n))})}catch(n){throw t.push(a+"type="+encodeURIComponent("_badmap")),n}}function zt(e){this.l=e.Ub||null,this.j=e.eb||!1}function Ut(e,t){he.call(this),this.D=e,this.o=t,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}function Vt(e){e.j.read().then(e.Pa.bind(e)).catch(e.ga.bind(e))}function qt(e){e.readyState=4,e.l=null,e.j=null,e.v=null,Ht(e)}function Ht(e){e.onreadystatechange&&e.onreadystatechange.call(e)}function Gt(e){let t="";return A(e,function(e,r){t+=r,t+=":",t+=e,t+="\r\n"}),t}function Wt(e,t,r){e:{for(a in r){var a=!1;break e}a=!0}a||(r=Gt(r),"string"===typeof e?null!=r&&encodeURIComponent(String(r)):bt(e,t,r))}function Kt(e){he.call(this),this.headers=new Map,this.o=e||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}(e=Tt.prototype).add=function(e,t){Dt(this),this.i=null,e=Mt(this,e);var r=this.g.get(e);return r||this.g.set(e,r=[]),r.push(t),this.h+=1,this},e.forEach=function(e,t){Dt(this),this.g.forEach(function(r,a){r.forEach(function(r){e.call(t,r,a,this)},this)},this)},e.na=function(){Dt(this);const e=Array.from(this.g.values()),t=Array.from(this.g.keys()),r=[];for(let a=0;a<t.length;a++){const n=e[a];for(let e=0;e<n.length;e++)r.push(t[a])}return r},e.V=function(e){Dt(this);let t=[];if("string"===typeof e)Ft(this,e)&&(t=t.concat(this.g.get(Mt(this,e))));else{e=Array.from(this.g.values());for(let r=0;r<e.length;r++)t=t.concat(e[r])}return t},e.set=function(e,t){return Dt(this),this.i=null,Ft(this,e=Mt(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},e.get=function(e,t){return e&&0<(e=this.V(e)).length?String(e[0]):t},e.toString=function(){if(this.i)return this.i;if(!this.g)return"";const e=[],t=Array.from(this.g.keys());for(var r=0;r<t.length;r++){var a=t[r];const s=encodeURIComponent(String(a)),i=this.V(a);for(a=0;a<i.length;a++){var n=s;""!==i[a]&&(n+="="+encodeURIComponent(String(i[a]))),e.push(n)}}return this.i=e.join("&")},u(zt,je),zt.prototype.g=function(){return new Ut(this.l,this.j)},zt.prototype.i=(St={},function(){return St}),u(Ut,he),(e=Ut.prototype).open=function(e,t){if(0!=this.readyState)throw this.abort(),Error("Error reopening a connection");this.B=e,this.A=t,this.readyState=1,Ht(this)},e.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const t={headers:this.u,method:this.B,credentials:this.m,cache:void 0};e&&(t.body=e),(this.D||n).fetch(new Request(this.A,t)).then(this.Sa.bind(this),this.ga.bind(this))},e.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,qt(this)),this.readyState=0},e.Sa=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,Ht(this)),this.g&&(this.readyState=3,Ht(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if("undefined"!==typeof n.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Vt(this)}else e.text().then(this.Ra.bind(this),this.ga.bind(this))},e.Pa=function(e){if(this.g){if(this.o&&e.value)this.response.push(e.value);else if(!this.o){var t=e.value?e.value:new Uint8Array(0);(t=this.v.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?qt(this):Ht(this),3==this.readyState&&Vt(this)}},e.Ra=function(e){this.g&&(this.response=this.responseText=e,qt(this))},e.Qa=function(e){this.g&&(this.response=e,qt(this))},e.ga=function(){this.g&&qt(this)},e.setRequestHeader=function(e,t){this.u.append(e,t)},e.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},e.getAllResponseHeaders=function(){if(!this.h)return"";const e=[],t=this.h.entries();for(var r=t.next();!r.done;)r=r.value,e.push(r[0]+": "+r[1]),r=t.next();return e.join("\r\n")},Object.defineProperty(Ut.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}}),u(Kt,he);var Qt=/^https?$/i,Yt=["POST","PUT"];function Xt(e,t){e.h=!1,e.g&&(e.j=!0,e.g.abort(),e.j=!1),e.l=t,e.m=5,Jt(e),$t(e)}function Jt(e){e.A||(e.A=!0,me(e,"complete"),me(e,"error"))}function Zt(e){if(e.h&&"undefined"!=typeof a&&(!e.v[1]||4!=tr(e)||2!=e.Z()))if(e.u&&4==tr(e))ge(e.Ea,0,e);else if(me(e,"readystatechange"),4==tr(e)){e.h=!1;try{const a=e.Z();e:switch(a){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break e;default:t=!1}var r;if(!(r=t)){var s;if(s=0===a){var i=String(e.D).match(ft)[1]||null;!i&&n.self&&n.self.location&&(i=n.self.location.protocol.slice(0,-1)),s=!Qt.test(i?i.toLowerCase():"")}r=s}if(r)me(e,"complete"),me(e,"success");else{e.m=6;try{var o=2<tr(e)?e.g.statusText:""}catch(l){o=""}e.l=o+" ["+e.Z()+"]",Jt(e)}}finally{$t(e)}}}function $t(e,t){if(e.g){er(e);const a=e.g,n=e.v[0]?()=>{}:null;e.g=null,e.v=null,t||me(e,"ready");try{a.onreadystatechange=n}catch(r){}}}function er(e){e.I&&(n.clearTimeout(e.I),e.I=null)}function tr(e){return e.g?e.g.readyState:0}function rr(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.H){case"":case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(t){return null}}function ar(e,t,r){return r&&r.internalChannelParams&&r.internalChannelParams[e]||t}function nr(e){this.Aa=0,this.i=[],this.j=new Be,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=ar("failFast",!1,e),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=ar("baseRetryDelayMs",5e3,e),this.cb=ar("retryDelaySeedMs",1e4,e),this.Wa=ar("forwardChannelMaxRetries",2,e),this.wa=ar("forwardChannelRequestTimeoutMs",2e4,e),this.pa=e&&e.xmlHttpFactory||void 0,this.Xa=e&&e.Tb||void 0,this.Ca=e&&e.useFetchStreams||!1,this.L=void 0,this.J=e&&e.supportsCrossDomainXhr||!1,this.K="",this.h=new it(e&&e.concurrentRequestLimit),this.Da=new Ot,this.P=e&&e.fastHandshake||!1,this.O=e&&e.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=e&&e.Rb||!1,e&&e.xa&&this.j.xa(),e&&e.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&e&&e.detectBufferingProxy||!1,this.ja=void 0,e&&e.longPollingTimeout&&0<e.longPollingTimeout&&(this.ja=e.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}function sr(e){if(or(e),3==e.G){var t=e.U++,r=pt(e.I);if(bt(r,"SID",e.K),bt(r,"RID",t),bt(r,"TYPE","terminate"),dr(e,r),(t=new Ge(e,e.j,t)).L=2,t.v=wt(pt(r)),r=!1,n.navigator&&n.navigator.sendBeacon)try{r=n.navigator.sendBeacon(t.v.toString(),"")}catch(a){}!r&&n.Image&&((new Image).src=t.v,r=!0),r||(t.g=kr(t.j,null),t.g.ea(t.v)),t.F=Date.now(),$e(t)}br(e)}function ir(e){e.g&&(fr(e),e.g.cancel(),e.g=null)}function or(e){ir(e),e.u&&(n.clearTimeout(e.u),e.u=null),pr(e),e.h.cancel(),e.s&&("number"===typeof e.s&&n.clearTimeout(e.s),e.s=null)}function lr(e){if(!ot(e.h)&&!e.s){e.s=!0;var t=e.Ga;R||z(),O||(R(),O=!0),B.add(t,e),e.B=0}}function cr(e,t){var r;r=t?t.l:e.U++;const a=pt(e.I);bt(a,"SID",e.K),bt(a,"RID",r),bt(a,"AID",e.T),dr(e,a),e.m&&e.o&&Wt(a,e.m,e.o),r=new Ge(e,e.j,r,e.B+1),null===e.m&&(r.H=e.o),t&&(e.i=t.D.concat(e.i)),t=ur(e,r,1e3),r.I=Math.round(.5*e.wa)+Math.round(.5*e.wa*Math.random()),dt(e.h,r),Ye(r,a,t)}function dr(e,t){e.H&&A(e.H,function(e,r){bt(t,r,e)}),e.l&&mt({},function(e,r){bt(t,r,e)})}function ur(e,t,r){r=Math.min(e.i.length,r);var a=e.l?c(e.l.Na,e.l,e):null;e:{var n=e.i;let t=-1;for(;;){const e=["count="+r];-1==t?0<r?(t=n[0].g,e.push("ofs="+t)):t=0:e.push("ofs="+t);let i=!0;for(let o=0;o<r;o++){let r=n[o].g;const l=n[o].map;if(r-=t,0>r)t=Math.max(0,n[o].g-100),i=!1;else try{Bt(l,e,"req"+r+"_")}catch(s){a&&a(l)}}if(i){a=e.join("&");break e}}}return e=e.i.splice(0,r),t.D=e,a}function hr(e){if(!e.g&&!e.u){e.Y=1;var t=e.Fa;R||z(),O||(R(),O=!0),B.add(t,e),e.v=0}}function mr(e){return!(e.g||e.u||3<=e.v)&&(e.Y++,e.u=Oe(c(e.Fa,e),yr(e,e.v)),e.v++,!0)}function fr(e){null!=e.A&&(n.clearTimeout(e.A),e.A=null)}function gr(e){e.g=new Ge(e,e.j,"rpc",e.Y),null===e.m&&(e.g.H=e.o),e.g.O=0;var t=pt(e.qa);bt(t,"RID","rpc"),bt(t,"SID",e.K),bt(t,"AID",e.T),bt(t,"CI",e.F?"0":"1"),!e.F&&e.ja&&bt(t,"TO",e.ja),bt(t,"TYPE","xmlhttp"),dr(e,t),e.m&&e.o&&Wt(t,e.m,e.o),e.L&&(e.g.I=e.L);var r=e.g;e=e.ia,r.L=1,r.v=wt(pt(t)),r.m=null,r.P=!0,Xe(r,e)}function pr(e){null!=e.C&&(n.clearTimeout(e.C),e.C=null)}function xr(e,t){var r=null;if(e.g==t){pr(e),fr(e),e.g=null;var a=2}else{if(!ct(e.h,t))return;r=t.D,ut(e.h,t),a=1}if(0!=e.G)if(t.o)if(1==a){r=t.m?t.m.length:0,t=Date.now()-t.F;var n=e.B;me(a=De(),new Re(a,r)),lr(e)}else hr(e);else if(3==(n=t.s)||0==n&&0<t.X||!(1==a&&function(e,t){return!(lt(e.h)>=e.h.j-(e.s?1:0))&&(e.s?(e.i=t.D.concat(e.i),!0):!(1==e.G||2==e.G||e.B>=(e.Va?0:e.Wa))&&(e.s=Oe(c(e.Ga,e,t),yr(e,e.B)),e.B++,!0))}(e,t)||2==a&&mr(e)))switch(r&&0<r.length&&(t=e.h,t.i=t.i.concat(r)),n){case 1:vr(e,5);break;case 4:vr(e,10);break;case 3:vr(e,6);break;default:vr(e,2)}}function yr(e,t){let r=e.Ta+Math.floor(Math.random()*e.cb);return e.isActive()||(r*=2),r*t}function vr(e,t){if(e.j.info("Error code "+t),2==t){var r=c(e.fb,e),a=e.Xa;const t=!a;a=new gt(a||"//www.google.com/images/cleardot.gif"),n.location&&"http"==n.location.protocol||xt(a,"https"),wt(a),t?function(e,t){const r=new Be;if(n.Image){const a=new Image;a.onload=d(Rt,r,"TestLoadImage: loaded",!0,t,a),a.onerror=d(Rt,r,"TestLoadImage: error",!1,t,a),a.onabort=d(Rt,r,"TestLoadImage: abort",!1,t,a),a.ontimeout=d(Rt,r,"TestLoadImage: timeout",!1,t,a),n.setTimeout(function(){a.ontimeout&&a.ontimeout()},1e4),a.src=e}else t(!1)}(a.toString(),r):function(e,t){new Be;const r=new AbortController,a=setTimeout(()=>{r.abort(),Rt(0,0,!1,t)},1e4);fetch(e,{signal:r.signal}).then(e=>{clearTimeout(a),e.ok?Rt(0,0,!0,t):Rt(0,0,!1,t)}).catch(()=>{clearTimeout(a),Rt(0,0,!1,t)})}(a.toString(),r)}else Me(2);e.G=0,e.l&&e.l.sa(t),br(e),or(e)}function br(e){if(e.G=0,e.ka=[],e.l){const t=ht(e.h);0==t.length&&0==e.i.length||(N(e.ka,t),N(e.ka,e.i),e.h.i.length=0,k(e.i),e.i.length=0),e.l.ra()}}function wr(e,t,r){var a=r instanceof gt?pt(r):new gt(r);if(""!=a.g)t&&(a.g=t+"."+a.g),yt(a,a.s);else{var s=n.location;a=s.protocol,t=t?t+"."+s.hostname:s.hostname,s=+s.port;var i=new gt(null);a&&xt(i,a),t&&(i.g=t),s&&yt(i,s),r&&(i.l=r),a=i}return r=e.D,t=e.ya,r&&t&&bt(a,r,t),bt(a,"VER",e.la),dr(e,a),a}function kr(e,t,r){if(t&&!e.J)throw Error("Can't create secondary domain capable XhrIo object.");return(t=e.Ca&&!e.pa?new Kt(new zt({eb:r})):new Kt(e.pa)).Ha(e.J),t}function Nr(){}function jr(){}function Sr(e,t){he.call(this),this.g=new nr(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.o=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.va&&(e?e["X-WebChannel-Client-Profile"]=t.va:e={"X-WebChannel-Client-Profile":t.va}),this.g.S=e,(e=t&&t.Sb)&&!j(e)&&(this.g.m=e),this.v=t&&t.supportsCrossDomainXhr||!1,this.u=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!j(t)&&(this.g.D=t,null!==(e=this.h)&&t in e&&(t in(e=this.h)&&delete e[t])),this.j=new Ar(this)}function _r(e){Ae.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var t=e.__sm__;if(t){e:{for(const r in t){e=r;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function Er(){Ce.call(this),this.status=1}function Ar(e){this.g=e}(e=Kt.prototype).Ha=function(e){this.J=e},e.ea=function(e,t,r,a){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+e);t=t?t.toUpperCase():"GET",this.D=e,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Ue.g(),this.v=this.o?Se(this.o):Se(Ue),this.g.onreadystatechange=c(this.Ea,this);try{this.B=!0,this.g.open(t,String(e),!0),this.B=!1}catch(i){return void Xt(this,i)}if(e=r||"",r=new Map(this.headers),a)if(Object.getPrototypeOf(a)===Object.prototype)for(var s in a)r.set(s,a[s]);else{if("function"!==typeof a.keys||"function"!==typeof a.get)throw Error("Unknown input type for opt_headers: "+String(a));for(const e of a.keys())r.set(e,a.get(e))}a=Array.from(r.keys()).find(e=>"content-type"==e.toLowerCase()),s=n.FormData&&e instanceof n.FormData,!(0<=Array.prototype.indexOf.call(Yt,t,void 0))||a||s||r.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[n,o]of r)this.g.setRequestHeader(n,o);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{er(this),this.u=!0,this.g.send(e),this.u=!1}catch(i){Xt(this,i)}},e.abort=function(e){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=e||7,me(this,"complete"),me(this,"abort"),$t(this))},e.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),$t(this,!0)),Kt.aa.N.call(this)},e.Ea=function(){this.s||(this.B||this.u||this.j?Zt(this):this.bb())},e.bb=function(){Zt(this)},e.isActive=function(){return!!this.g},e.Z=function(){try{return 2<tr(this)?this.g.status:-1}catch(St){return-1}},e.oa=function(){try{return this.g?this.g.responseText:""}catch(St){return""}},e.Oa=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),ke(t)}},e.Ba=function(){return this.m},e.Ka=function(){return"string"===typeof this.l?this.l:String(this.l)},(e=nr.prototype).la=8,e.G=1,e.connect=function(e,t,r,a){Me(0),this.W=e,this.H=t||{},r&&void 0!==a&&(this.H.OSID=r,this.H.OAID=a),this.F=this.X,this.I=wr(this,null,this.W),lr(this)},e.Ga=function(e){if(this.s)if(this.s=null,1==this.G){if(!e){this.U=Math.floor(1e5*Math.random()),e=this.U++;const n=new Ge(this,this.j,e);let s=this.o;if(this.S&&(s?(s=C(s),T(s,this.S)):s=this.S),null!==this.m||this.O||(n.H=s,s=null),this.P)e:{for(var t=0,r=0;r<this.i.length;r++){var a=this.i[r];if(void 0===(a="__data__"in a.map&&"string"===typeof(a=a.map.__data__)?a.length:void 0))break;if(4096<(t+=a)){t=r;break e}if(4096===t||r===this.i.length-1){t=r+1;break e}}t=1e3}else t=1e3;t=ur(this,n,t),bt(r=pt(this.I),"RID",e),bt(r,"CVER",22),this.D&&bt(r,"X-HTTP-Session-Id",this.D),dr(this,r),s&&(this.O?t="headers="+encodeURIComponent(String(Gt(s)))+"&"+t:this.m&&Wt(r,this.m,s)),dt(this.h,n),this.Ua&&bt(r,"TYPE","init"),this.P?(bt(r,"$req",t),bt(r,"SID","null"),n.T=!0,Ye(n,r,null)):Ye(n,r,t),this.G=2}}else 3==this.G&&(e?cr(this,e):0==this.i.length||ot(this.h)||cr(this))},e.Fa=function(){if(this.u=null,gr(this),this.ba&&!(this.M||null==this.g||0>=this.R)){var e=2*this.R;this.j.info("BP detection timer enabled: "+e),this.A=Oe(c(this.ab,this),e)}},e.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Me(10),ir(this),gr(this))},e.Za=function(){null!=this.C&&(this.C=null,ir(this),mr(this),Me(19))},e.fb=function(e){e?(this.j.info("Successfully pinged google.com"),Me(2)):(this.j.info("Failed to ping google.com"),Me(1))},e.isActive=function(){return!!this.l&&this.l.isActive(this)},(e=Nr.prototype).ua=function(){},e.ta=function(){},e.sa=function(){},e.ra=function(){},e.isActive=function(){return!0},e.Na=function(){},jr.prototype.g=function(e,t){return new Sr(e,t)},u(Sr,he),Sr.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Sr.prototype.close=function(){sr(this.g)},Sr.prototype.o=function(e){var t=this.g;if("string"===typeof e){var r={};r.__data__=e,e=r}else this.u&&((r={}).__data__=we(e),e=r);t.i.push(new st(t.Ya++,e)),3==t.G&&lr(t)},Sr.prototype.N=function(){this.g.l=null,delete this.j,sr(this.g),delete this.g,Sr.aa.N.call(this)},u(_r,Ae),u(Er,Ce),u(Ar,Nr),Ar.prototype.ua=function(){me(this.g,"a")},Ar.prototype.ta=function(e){me(this.g,new _r(e))},Ar.prototype.sa=function(e){me(this.g,new Er)},Ar.prototype.ra=function(){me(this.g,"b")},jr.prototype.createWebChannel=jr.prototype.g,Sr.prototype.send=Sr.prototype.o,Sr.prototype.open=Sr.prototype.m,Sr.prototype.close=Sr.prototype.close,v=w.createWebChannelTransport=function(){return new jr},y=w.getStatEventTarget=function(){return De()},x=w.Event=Ie,p=w.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Ve.NO_ERROR=0,Ve.TIMEOUT=8,Ve.HTTP_ERROR=6,g=w.ErrorCode=Ve,qe.COMPLETE="complete",f=w.EventType=qe,_e.EventType=Ee,Ee.OPEN="a",Ee.CLOSE="b",Ee.ERROR="c",Ee.MESSAGE="d",he.prototype.listen=he.prototype.K,m=w.WebChannel=_e,w.FetchXmlHttpFactory=zt,Kt.prototype.listenOnce=Kt.prototype.L,Kt.prototype.getLastError=Kt.prototype.Ka,Kt.prototype.getLastErrorCode=Kt.prototype.Ba,Kt.prototype.getStatus=Kt.prototype.Z,Kt.prototype.getResponseJson=Kt.prototype.Oa,Kt.prototype.getResponseText=Kt.prototype.oa,Kt.prototype.send=Kt.prototype.ea,Kt.prototype.setWithCredentials=Kt.prototype.Ha,h=w.XhrIo=Kt}).apply("undefined"!==typeof b?b:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{});const k="@firebase/firestore",N="4.9.1";class j{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}j.UNAUTHENTICATED=new j(null),j.GOOGLE_CREDENTIALS=new j("google-credentials-uid"),j.FIRST_PARTY=new j("first-party-uid"),j.MOCK_USER=new j("mock-user");let S="12.2.0";const _=new l.Vy("@firebase/firestore");function E(){return _.logLevel}function A(e){if(_.logLevel<=l.$b.DEBUG){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];const n=r.map(T);_.debug("Firestore (".concat(S,"): ").concat(e),...n)}}function C(e){if(_.logLevel<=l.$b.ERROR){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];const n=r.map(T);_.error("Firestore (".concat(S,"): ").concat(e),...n)}}function I(e){if(_.logLevel<=l.$b.WARN){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];const n=r.map(T);_.warn("Firestore (".concat(S,"): ").concat(e),...n)}}function T(e){if("string"==typeof e)return e;try{return function(e){return JSON.stringify(e)}(e)}catch(t){return e}}function D(e,t,r){let a="Unexpected state";"string"==typeof t?a=t:r=t,P(e,a,r)}function P(e,t,r){let a="FIRESTORE (".concat(S,") INTERNAL ASSERTION FAILED: ").concat(t," (ID: ").concat(e.toString(16),")");if(void 0!==r)try{a+=" CONTEXT: "+JSON.stringify(r)}catch(e){a+=" CONTEXT: "+r}throw C(a),new Error(a)}function F(e,t,r,a){let n="Unexpected state";"string"==typeof r?n=r:a=r,e||P(t,n,a)}function L(e,t){return e}const M={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class R extends c.g{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>"".concat(this.name,": [code=").concat(this.code,"]: ").concat(this.message)}}class O{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}class B{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization","Bearer ".concat(e))}}class z{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(j.UNAUTHENTICATED))}shutdown(){}}class U{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class V{constructor(e){this.t=e,this.currentUser=j.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){F(void 0===this.o,42304);let r=this.i;const a=e=>this.i!==r?(r=this.i,t(e)):Promise.resolve();let n=new O;this.o=()=>{this.i++,this.currentUser=this.u(),n.resolve(),n=new O,e.enqueueRetryable(()=>a(this.currentUser))};const s=()=>{const t=n;e.enqueueRetryable(async()=>{await t.promise,await a(this.currentUser)})},i=e=>{A("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.o&&(this.auth.addAuthTokenListener(this.o),s())};this.t.onInit(e=>i(e)),setTimeout(()=>{if(!this.auth){const e=this.t.getImmediate({optional:!0});e?i(e):(A("FirebaseAuthCredentialsProvider","Auth not yet detected"),n.resolve(),n=new O)}},0),s()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(t=>this.i!==e?(A("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?(F("string"==typeof t.accessToken,31837,{l:t}),new B(t.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return F(null===e||"string"==typeof e,2055,{h:e}),new j(e)}}class q{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=j.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class H{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new q(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(j.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class G{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class W{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,(0,i.xZ)(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){F(void 0===this.o,3512);const r=e=>{null!=e.error&&A("FirebaseAppCheckTokenProvider","Error getting App Check token; using placeholder token instead. Error: ".concat(e.error.message));const r=e.token!==this.m;return this.m=e.token,A("FirebaseAppCheckTokenProvider","Received ".concat(r?"new":"existing"," token.")),r?t(e.token):Promise.resolve()};this.o=t=>{e.enqueueRetryable(()=>r(t))};const a=e=>{A("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(e=>a(e)),setTimeout(()=>{if(!this.appCheck){const e=this.V.getImmediate({optional:!0});e?a(e):A("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new G(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(e=>e?(F("string"==typeof e.token,44558,{tokenResult:e}),this.m=e.token,new G(e.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function K(e){const t="undefined"!=typeof self&&(self.crypto||self.msCrypto),r=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(r);else for(let a=0;a<e;a++)r[a]=Math.floor(256*Math.random());return r}class Q{static newId(){const e=62*Math.floor(256/62);let t="";for(;t.length<20;){const r=K(40);for(let a=0;a<r.length;++a)t.length<20&&r[a]<e&&(t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(r[a]%62))}return t}}function Y(e,t){return e<t?-1:e>t?1:0}function X(e,t){const r=Math.min(e.length,t.length);for(let a=0;a<r;a++){const r=e.charAt(a),n=t.charAt(a);if(r!==n)return $(r)===$(n)?Y(r,n):$(r)?1:-1}return Y(e.length,t.length)}const J=55296,Z=57343;function $(e){const t=e.charCodeAt(0);return t>=J&&t<=Z}function ee(e,t,r){return e.length===t.length&&e.every((e,a)=>r(e,t[a]))}function te(e){return e+"\0"}const re="__name__";class ae{constructor(e,t,r){void 0===t?t=0:t>e.length&&D(637,{offset:t,range:e.length}),void 0===r?r=e.length-t:r>e.length-t&&D(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return 0===ae.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof ae?e.forEach(e=>{t.push(e)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let a=0;a<r;a++){const r=ae.compareSegments(e.get(a),t.get(a));if(0!==r)return r}return Y(e.length,t.length)}static compareSegments(e,t){const r=ae.isNumericId(e),a=ae.isNumericId(t);return r&&!a?-1:!r&&a?1:r&&a?ae.extractNumericId(e).compare(ae.extractNumericId(t)):X(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return a.fromString(e.substring(4,e.length-2))}}class ne extends ae{construct(e,t,r){return new ne(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(){const e=[];for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];for(const n of r){if(n.indexOf("//")>=0)throw new R(M.INVALID_ARGUMENT,"Invalid segment (".concat(n,"). Paths must not contain // in them."));e.push(...n.split("/").filter(e=>e.length>0))}return new ne(e)}static emptyPath(){return new ne([])}}const se=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class ie extends ae{construct(e,t,r){return new ie(e,t,r)}static isValidIdentifier(e){return se.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),ie.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&this.get(0)===re}static keyField(){return new ie([re])}static fromServerFormat(e){const t=[];let r="",a=0;const n=()=>{if(0===r.length)throw new R(M.INVALID_ARGUMENT,"Invalid field path (".concat(e,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"));t.push(r),r=""};let s=!1;for(;a<e.length;){const t=e[a];if("\\"===t){if(a+1===e.length)throw new R(M.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const t=e[a+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new R(M.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=t,a+=2}else"`"===t?(s=!s,a++):"."!==t||s?(r+=t,a++):(n(),a++)}if(n(),s)throw new R(M.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new ie(t)}static emptyPath(){return new ie([])}}class oe{constructor(e){this.path=e}static fromPath(e){return new oe(ne.fromString(e))}static fromName(e){return new oe(ne.fromString(e).popFirst(5))}static empty(){return new oe(ne.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===ne.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return ne.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new oe(new ne(e.slice()))}}function le(e,t,r){if(!r)throw new R(M.INVALID_ARGUMENT,"Function ".concat(e,"() cannot be called with an empty ").concat(t,"."))}function ce(e){if(!oe.isDocumentKey(e))throw new R(M.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but ".concat(e," has ").concat(e.length,"."))}function de(e){if(oe.isDocumentKey(e))throw new R(M.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but ".concat(e," has ").concat(e.length,"."))}function ue(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}function he(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e="".concat(e.substring(0,20),"...")),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{const t=function(e){return e.constructor?e.constructor.name:null}(e);return t?"a custom ".concat(t," object"):"an object"}}return"function"==typeof e?"a function":D(12329,{type:typeof e})}function me(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new R(M.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=he(e);throw new R(M.INVALID_ARGUMENT,"Expected type '".concat(t.name,"', but it was: ").concat(r))}}return e}function fe(e,t){if(t<=0)throw new R(M.INVALID_ARGUMENT,"Function ".concat(e,"() requires a positive number, but it was: ").concat(t,"."))}function ge(e,t){const r={typeString:e};return t&&(r.value=t),r}function pe(e,t){if(!ue(e))throw new R(M.INVALID_ARGUMENT,"JSON must be an object");let r;for(const a in t)if(t[a]){const n=t[a].typeString,s="value"in t[a]?{value:t[a].value}:void 0;if(!(a in e)){r="JSON missing required field: '".concat(a,"'");break}const i=e[a];if(n&&typeof i!==n){r="JSON field '".concat(a,"' must be a ").concat(n,".");break}if(void 0!==s&&i!==s.value){r="Expected '".concat(a,"' field to equal '").concat(s.value,"'");break}}if(r)throw new R(M.INVALID_ARGUMENT,r);return!0}const xe=-62135596800,ye=1e6;class ve{static now(){return ve.fromMillis(Date.now())}static fromDate(e){return ve.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*ye);return new ve(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new R(M.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new R(M.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<xe)throw new R(M.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new R(M.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/ye}_compareTo(e){return this.seconds===e.seconds?Y(this.nanoseconds,e.nanoseconds):Y(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:ve._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(pe(e,ve._jsonSchema))return new ve(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-xe;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}ve._jsonSchemaVersion="firestore/timestamp/1.0",ve._jsonSchema={type:ge("string",ve._jsonSchemaVersion),seconds:ge("number"),nanoseconds:ge("number")};class be{static fromTimestamp(e){return new be(e)}static min(){return new be(new ve(0,0))}static max(){return new be(new ve(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const we=-1;class ke{constructor(e,t,r,a){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=a}}function Ne(e){return e.fields.find(e=>2===e.kind)}function je(e){return e.fields.filter(e=>2!==e.kind)}ke.UNKNOWN_ID=-1;class Se{constructor(e,t){this.fieldPath=e,this.kind=t}}class _e{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new _e(0,Ce.min())}}function Ee(e,t){const r=e.toTimestamp().seconds,a=e.toTimestamp().nanoseconds+1,n=be.fromTimestamp(1e9===a?new ve(r+1,0):new ve(r,a));return new Ce(n,oe.empty(),t)}function Ae(e){return new Ce(e.readTime,e.key,we)}class Ce{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new Ce(be.min(),oe.empty(),we)}static max(){return new Ce(be.max(),oe.empty(),we)}}function Ie(e,t){let r=e.readTime.compareTo(t.readTime);return 0!==r?r:(r=oe.comparator(e.documentKey,t.documentKey),0!==r?r:Y(e.largestBatchId,t.largestBatchId))}const Te="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class De{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}async function Pe(e){if(e.code!==M.FAILED_PRECONDITION||e.message!==Te)throw e;A("LocalStore","Unexpectedly lost primary lease")}class Fe{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)},e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&D(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new Fe((r,a)=>{this.nextCallback=t=>{this.wrapSuccess(e,t).next(r,a)},this.catchCallback=e=>{this.wrapFailure(t,e).next(r,a)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof Fe?t:Fe.resolve(t)}catch(e){return Fe.reject(e)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):Fe.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):Fe.reject(t)}static resolve(e){return new Fe((t,r)=>{t(e)})}static reject(e){return new Fe((t,r)=>{r(e)})}static waitFor(e){return new Fe((t,r)=>{let a=0,n=0,s=!1;e.forEach(e=>{++a,e.next(()=>{++n,s&&n===a&&t()},e=>r(e))}),s=!0,n===a&&t()})}static or(e){let t=Fe.resolve(!1);for(const r of e)t=t.next(e=>e?Fe.resolve(e):r());return t}static forEach(e,t){const r=[];return e.forEach((e,a)=>{r.push(t.call(this,e,a))}),this.waitFor(r)}static mapArray(e,t){return new Fe((r,a)=>{const n=e.length,s=new Array(n);let i=0;for(let o=0;o<n;o++){const l=o;t(e[l]).next(e=>{s[l]=e,++i,i===n&&r(s)},e=>a(e))}})}static doWhile(e,t){return new Fe((r,a)=>{const n=()=>{!0===e()?t().next(()=>{n()},a):r()};n()})}}const Le="SimpleDb";class Me{static open(e,t,r,a){try{return new Me(t,e.transaction(a,r))}catch(e){throw new ze(t,e)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new O,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new ze(e,t.error)):this.S.resolve()},this.transaction.onerror=t=>{const r=Ge(t.target.error);this.S.reject(new ze(e,r))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(A(Le,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||"function"!=typeof e.commit||e.commit()}store(e){const t=this.transaction.objectStore(e);return new Ve(t)}}class Re{static delete(e){return A(Le,"Removing database:",e),qe((0,c.mS)().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!(0,c.zW)())return!1;if(Re.F())return!0;const e=(0,c.ZQ)(),t=Re.M(e),r=0<t&&t<10,a=Oe(e),n=0<a&&a<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||n)}static F(){var e;return"undefined"!=typeof process&&"YES"===(null===(e=process.__PRIVATE_env)||void 0===e?void 0:e.__PRIVATE_USE_MOCK_PERSISTENCE)}static O(e,t){return e.store(t)}static M(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}constructor(e,t,r){this.name=e,this.version=t,this.N=r,this.B=null,12.2===Re.M((0,c.ZQ)())&&C("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(A(Le,"Opening database:",this.name),this.db=await new Promise((t,r)=>{const a=indexedDB.open(this.name,this.version);a.onsuccess=e=>{const r=e.target.result;t(r)},a.onblocked=()=>{r(new ze(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},a.onerror=t=>{const a=t.target.error;"VersionError"===a.name?r(new R(M.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):"InvalidStateError"===a.name?r(new R(M.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+a)):r(new ze(e,a))},a.onupgradeneeded=e=>{A(Le,'Database "'+this.name+'" requires upgrade from version:',e.oldVersion);const t=e.target.result;this.N.k(t,a.transaction,e.oldVersion,this.version).next(()=>{A(Le,"Database upgrade to version "+this.version+" complete")})}})),this.q&&(this.db.onversionchange=e=>this.q(e)),this.db}$(e){this.q=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,r,a){const n="readonly"===t;let s=0;for(;;){++s;try{this.db=await this.L(e);const t=Me.open(this.db,e,n?"readonly":"readwrite",r),s=a(t).next(e=>(t.C(),e)).catch(e=>(t.abort(e),Fe.reject(e))).toPromise();return s.catch(()=>{}),await t.D,s}catch(e){const t=e,r="FirebaseError"!==t.name&&s<3;if(A(Le,"Transaction failed with error:",t.message,"Retrying:",r),this.close(),!r)return Promise.reject(t)}}}close(){this.db&&this.db.close(),this.db=void 0}}function Oe(e){const t=e.match(/Android ([\d.]+)/i),r=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(r)}class Be{constructor(e){this.U=e,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(e){this.U=e}done(){this.K=!0}j(e){this.W=e}delete(){return qe(this.U.delete())}}class ze extends R{constructor(e,t){super(M.UNAVAILABLE,"IndexedDB transaction '".concat(e,"' failed: ").concat(t)),this.name="IndexedDbTransactionError"}}function Ue(e){return"IndexedDbTransactionError"===e.name}class Ve{constructor(e){this.store=e}put(e,t){let r;return void 0!==t?(A(Le,"PUT",this.store.name,e,t),r=this.store.put(t,e)):(A(Le,"PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),qe(r)}add(e){return A(Le,"ADD",this.store.name,e,e),qe(this.store.add(e))}get(e){return qe(this.store.get(e)).next(t=>(void 0===t&&(t=null),A(Le,"GET",this.store.name,e,t),t))}delete(e){return A(Le,"DELETE",this.store.name,e),qe(this.store.delete(e))}count(){return A(Le,"COUNT",this.store.name),qe(this.store.count())}J(e,t){const r=this.options(e,t),a=r.index?this.store.index(r.index):this.store;if("function"==typeof a.getAll){const e=a.getAll(r.range);return new Fe((t,r)=>{e.onerror=e=>{r(e.target.error)},e.onsuccess=e=>{t(e.target.result)}})}{const e=this.cursor(r),t=[];return this.H(e,(e,r)=>{t.push(r)}).next(()=>t)}}Y(e,t){const r=this.store.getAll(e,null===t?void 0:t);return new Fe((e,t)=>{r.onerror=e=>{t(e.target.error)},r.onsuccess=t=>{e(t.target.result)}})}Z(e,t){A(Le,"DELETE ALL",this.store.name);const r=this.options(e,t);r.X=!1;const a=this.cursor(r);return this.H(a,(e,t,r)=>r.delete())}ee(e,t){let r;t?r=e:(r={},t=e);const a=this.cursor(r);return this.H(a,t)}te(e){const t=this.cursor({});return new Fe((r,a)=>{t.onerror=e=>{const t=Ge(e.target.error);a(t)},t.onsuccess=t=>{const a=t.target.result;a?e(a.primaryKey,a.value).next(e=>{e?a.continue():r()}):r()}})}H(e,t){const r=[];return new Fe((a,n)=>{e.onerror=e=>{n(e.target.error)},e.onsuccess=e=>{const n=e.target.result;if(!n)return void a();const s=new Be(n),i=t(n.primaryKey,n.value,s);if(i instanceof Fe){const e=i.catch(e=>(s.done(),Fe.reject(e)));r.push(e)}s.isDone?a():null===s.G?n.continue():n.continue(s.G)}}).next(()=>Fe.waitFor(r))}options(e,t){let r;return void 0!==e&&("string"==typeof e?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const r=this.store.index(e.index);return e.X?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function qe(e){return new Fe((t,r)=>{e.onsuccess=e=>{const r=e.target.result;t(r)},e.onerror=e=>{const t=Ge(e.target.error);r(t)}})}let He=!1;function Ge(e){const t=Re.M((0,c.ZQ)());if(t>=12.2&&t<13){const t="An internal error was encountered in the Indexed Database server";if(e.message.indexOf(t)>=0){const e=new R("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '".concat(t,"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround."));return He||(He=!0,setTimeout(()=>{throw e},0)),e}}return e}const We="IndexBackfiller";class Ke{constructor(e,t){this.asyncQueue=e,this.ne=t,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return null!==this.task}re(e){A(We,"Scheduled in ".concat(e,"ms")),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{const e=await this.ne.ie();A(We,"Documents written: ".concat(e))}catch(e){Ue(e)?A(We,"Ignoring IndexedDB error during index backfill: ",e):await Pe(e)}await this.re(6e4)})}}class Qe{constructor(e,t){this.localStore=e,this.persistence=t}async ie(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50;return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.se(t,e))}se(e,t){const r=new Set;let a=t,n=!0;return Fe.doWhile(()=>!0===n&&a>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(t=>{if(null!==t&&!r.has(t))return A(We,"Processing collection: ".concat(t)),this.oe(e,t,a).next(e=>{a-=e,r.add(t)});n=!1})).next(()=>t-a)}oe(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(a=>this.localStore.localDocuments.getNextDocuments(e,t,a,r).next(r=>{const n=r.changes;return this.localStore.indexManager.updateIndexEntries(e,n).next(()=>this._e(a,r)).next(r=>(A(We,"Updating offset: ".concat(r)),this.localStore.indexManager.updateCollectionGroup(e,t,r))).next(()=>n.size)}))}_e(e,t){let r=e;return t.changes.forEach((e,t)=>{const a=Ae(t);Ie(a,r)>0&&(r=a)}),new Ce(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}}class Ye{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this.ae(e),this.ue=e=>t.writeSequenceNumber(e))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Ye.ce=-1;const Xe=-1;function Je(e){return null==e}function Ze(e){return 0===e&&1/e==-1/0}function $e(e){return"number"==typeof e&&Number.isInteger(e)&&!Ze(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}const et="\x01";function tt(e){let t="";for(let r=0;r<e.length;r++)t.length>0&&(t=at(t)),t=rt(e.get(r),t);return at(t)}function rt(e,t){let r=t;const a=e.length;for(let n=0;n<a;n++){const t=e.charAt(n);switch(t){case"\0":r+="\x01\x10";break;case et:r+="\x01\x11";break;default:r+=t}}return r}function at(e){return e+et+"\x01"}function nt(e){const t=e.length;if(F(t>=2,64408,{path:e}),2===t)return F(e.charAt(0)===et&&"\x01"===e.charAt(1),56145,{path:e}),ne.emptyPath();const r=t-2,a=[];let n="";for(let s=0;s<t;){const t=e.indexOf(et,s);switch((t<0||t>r)&&D(50515,{path:e}),e.charAt(t+1)){case"\x01":const r=e.substring(s,t);let i;0===n.length?i=r:(n+=r,i=n,n=""),a.push(i);break;case"\x10":n+=e.substring(s,t),n+="\0";break;case"\x11":n+=e.substring(s,t+1);break;default:D(61167,{path:e})}s=t+2}return new ne(a)}const st="remoteDocuments",it="owner",ot="owner",lt="mutationQueues",ct="mutations",dt="batchId",ut="userMutationsIndex",ht=["userId","batchId"];function mt(e,t){return[e,tt(t)]}function ft(e,t,r){return[e,tt(t),r]}const gt={},pt="documentMutations",xt="remoteDocumentsV14",yt=["prefixPath","collectionGroup","readTime","documentId"],vt="documentKeyIndex",bt=["prefixPath","collectionGroup","documentId"],wt="collectionGroupIndex",kt=["collectionGroup","readTime","prefixPath","documentId"],Nt="remoteDocumentGlobal",jt="remoteDocumentGlobalKey",St="targets",_t="queryTargetsIndex",Et=["canonicalId","targetId"],At="targetDocuments",Ct=["targetId","path"],It="documentTargetsIndex",Tt=["path","targetId"],Dt="targetGlobalKey",Pt="targetGlobal",Ft="collectionParents",Lt=["collectionId","parent"],Mt="clientMetadata",Rt="bundles",Ot="namedQueries",Bt="indexConfiguration",zt="collectionGroupIndex",Ut="indexState",Vt=["indexId","uid"],qt="sequenceNumberIndex",Ht=["uid","sequenceNumber"],Gt="indexEntries",Wt=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],Kt="documentKeyIndex",Qt=["indexId","uid","orderedDocumentKey"],Yt="documentOverlays",Xt=["userId","collectionPath","documentId"],Jt="collectionPathOverlayIndex",Zt=["userId","collectionPath","largestBatchId"],$t="collectionGroupOverlayIndex",er=["userId","collectionGroup","largestBatchId"],tr="globals",rr=[lt,ct,pt,st,St,it,Pt,At,Mt,Nt,Ft,Rt,Ot],ar=[...rr,Yt],nr=[lt,ct,pt,xt,St,it,Pt,At,Mt,Nt,Ft,Rt,Ot,Yt],sr=nr,ir=[...sr,Bt,Ut,Gt],or=ir,lr=[...ir,tr],cr=lr;class dr extends De{constructor(e,t){super(),this.le=e,this.currentSequenceNumber=t}}function ur(e,t){const r=L(e);return Re.O(r.le,t)}function hr(e){let t=0;for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&t++;return t}function mr(e,t){for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&t(r,e[r])}function fr(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}class gr{constructor(e,t){this.comparator=e,this.root=t||xr.EMPTY}insert(e,t){return new gr(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,xr.BLACK,null,null))}remove(e){return new gr(this.comparator,this.root.remove(e,this.comparator).copy(null,null,xr.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(0===r)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const a=this.comparator(e,r.key);if(0===a)return t+r.left.size;a<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){const e=[];return this.inorderTraversal((t,r)=>(e.push("".concat(t,":").concat(r)),!1)),"{".concat(e.join(", "),"}")}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new pr(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new pr(this.root,e,this.comparator,!1)}getReverseIterator(){return new pr(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new pr(this.root,e,this.comparator,!0)}}class pr{constructor(e,t,r,a){this.isReverse=a,this.nodeStack=[];let n=1;for(;!e.isEmpty();)if(n=t?r(e.key,t):1,t&&a&&(n*=-1),n<0)e=this.isReverse?e.left:e.right;else{if(0===n){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class xr{constructor(e,t,r,a,n){this.key=e,this.value=t,this.color=null!=r?r:xr.RED,this.left=null!=a?a:xr.EMPTY,this.right=null!=n?n:xr.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,a,n){return new xr(null!=e?e:this.key,null!=t?t:this.value,null!=r?r:this.color,null!=a?a:this.left,null!=n?n:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let a=this;const n=r(e,a.key);return a=n<0?a.copy(null,null,null,a.left.insert(e,t,r),null):0===n?a.copy(null,t,null,null,null):a.copy(null,null,null,null,a.right.insert(e,t,r)),a.fixUp()}removeMin(){if(this.left.isEmpty())return xr.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,a=this;if(t(e,a.key)<0)a.left.isEmpty()||a.left.isRed()||a.left.left.isRed()||(a=a.moveRedLeft()),a=a.copy(null,null,null,a.left.remove(e,t),null);else{if(a.left.isRed()&&(a=a.rotateRight()),a.right.isEmpty()||a.right.isRed()||a.right.left.isRed()||(a=a.moveRedRight()),0===t(e,a.key)){if(a.right.isEmpty())return xr.EMPTY;r=a.right.min(),a=a.copy(r.key,r.value,null,null,a.right.removeMin())}a=a.copy(null,null,null,null,a.right.remove(e,t))}return a.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,xr.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,xr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw D(43730,{key:this.key,value:this.value});if(this.right.isRed())throw D(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw D(27949);return e+(this.isRed()?0:1)}}xr.EMPTY=null,xr.RED=!0,xr.BLACK=!1,xr.EMPTY=new class{constructor(){this.size=0}get key(){throw D(57766)}get value(){throw D(16141)}get color(){throw D(16727)}get left(){throw D(29726)}get right(){throw D(36894)}copy(e,t,r,a,n){return this}insert(e,t,r){return new xr(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class yr{constructor(e){this.comparator=e,this.data=new gr(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const a=r.getNext();if(this.comparator(a.key,e[1])>=0)return;t(a.key)}}forEachWhile(e,t){let r;for(r=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new vr(this.data.getIterator())}getIteratorFrom(e){return new vr(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(e=>{t=t.add(e)}),t}isEqual(e){if(!(e instanceof yr))return!1;if(this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const e=t.getNext().key,a=r.getNext().key;if(0!==this.comparator(e,a))return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new yr(this.comparator);return t.data=e,t}}class vr{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function br(e){return e.hasNext()?e.getNext():void 0}class wr{constructor(e){this.fields=e,e.sort(ie.comparator)}static empty(){return new wr([])}unionWith(e){let t=new yr(ie.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new wr(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return ee(this.fields,e.fields,(e,t)=>e.isEqual(t))}}class kr extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Nr{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(e){try{return atob(e)}catch(e){throw"undefined"!=typeof DOMException&&e instanceof DOMException?new kr("Invalid base64 string: "+e):e}}(e);return new Nr(t)}static fromUint8Array(e){const t=function(e){let t="";for(let r=0;r<e.length;++r)t+=String.fromCharCode(e[r]);return t}(e);return new Nr(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Y(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Nr.EMPTY_BYTE_STRING=new Nr("");const jr=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Sr(e){if(F(!!e,39018),"string"==typeof e){let t=0;const r=jr.exec(e);if(F(!!r,46558,{timestamp:e}),r[1]){let e=r[1];e=(e+"000000000").substr(0,9),t=Number(e)}const a=new Date(e);return{seconds:Math.floor(a.getTime()/1e3),nanos:t}}return{seconds:_r(e.seconds),nanos:_r(e.nanos)}}function _r(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function Er(e){return"string"==typeof e?Nr.fromBase64String(e):Nr.fromUint8Array(e)}const Ar="server_timestamp",Cr="__type__",Ir="__previous_value__",Tr="__local_write_time__";function Dr(e){var t,r;return(null===(t=((null===e||void 0===e||null===(r=e.mapValue)||void 0===r?void 0:r.fields)||{})[Cr])||void 0===t?void 0:t.stringValue)===Ar}function Pr(e){const t=e.mapValue.fields[Ir];return Dr(t)?Pr(t):t}function Fr(e){const t=Sr(e.mapValue.fields[Tr].timestampValue);return new ve(t.seconds,t.nanos)}class Lr{constructor(e,t,r,a,n,s,i,o,l,c){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=a,this.ssl=n,this.forceLongPolling=s,this.autoDetectLongPolling=i,this.longPollingOptions=o,this.useFetchStreams=l,this.isUsingEmulator=c}}const Mr="(default)";class Rr{constructor(e,t){this.projectId=e,this.database=t||Mr}static empty(){return new Rr("","")}get isDefaultDatabase(){return this.database===Mr}isEqual(e){return e instanceof Rr&&e.projectId===this.projectId&&e.database===this.database}}const Or="__type__",Br="__max__",zr={mapValue:{fields:{__type__:{stringValue:Br}}}},Ur="__vector__",Vr="value",qr={nullValue:"NULL_VALUE"};function Hr(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?Dr(e)?4:oa(e)?9007199254740991:sa(e)?10:11:D(28295,{value:e})}function Gr(e,t){if(e===t)return!0;const r=Hr(e);if(r!==Hr(t))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return Fr(e).isEqual(Fr(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;const r=Sr(e.timestampValue),a=Sr(t.timestampValue);return r.seconds===a.seconds&&r.nanos===a.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(e,t){return Er(e.bytesValue).isEqual(Er(t.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return _r(e.geoPointValue.latitude)===_r(t.geoPointValue.latitude)&&_r(e.geoPointValue.longitude)===_r(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return _r(e.integerValue)===_r(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){const r=_r(e.doubleValue),a=_r(t.doubleValue);return r===a?Ze(r)===Ze(a):isNaN(r)&&isNaN(a)}return!1}(e,t);case 9:return ee(e.arrayValue.values||[],t.arrayValue.values||[],Gr);case 10:case 11:return function(e,t){const r=e.mapValue.fields||{},a=t.mapValue.fields||{};if(hr(r)!==hr(a))return!1;for(const n in r)if(r.hasOwnProperty(n)&&(void 0===a[n]||!Gr(r[n],a[n])))return!1;return!0}(e,t);default:return D(52216,{left:e})}}function Wr(e,t){return void 0!==(e.values||[]).find(e=>Gr(e,t))}function Kr(e,t){if(e===t)return 0;const r=Hr(e),a=Hr(t);if(r!==a)return Y(r,a);switch(r){case 0:case 9007199254740991:return 0;case 1:return Y(e.booleanValue,t.booleanValue);case 2:return function(e,t){const r=_r(e.integerValue||e.doubleValue),a=_r(t.integerValue||t.doubleValue);return r<a?-1:r>a?1:r===a?0:isNaN(r)?isNaN(a)?0:-1:1}(e,t);case 3:return Qr(e.timestampValue,t.timestampValue);case 4:return Qr(Fr(e),Fr(t));case 5:return X(e.stringValue,t.stringValue);case 6:return function(e,t){const r=Er(e),a=Er(t);return r.compareTo(a)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){const r=e.split("/"),a=t.split("/");for(let n=0;n<r.length&&n<a.length;n++){const e=Y(r[n],a[n]);if(0!==e)return e}return Y(r.length,a.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){const r=Y(_r(e.latitude),_r(t.latitude));return 0!==r?r:Y(_r(e.longitude),_r(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return Yr(e.arrayValue,t.arrayValue);case 10:return function(e,t,r,a,n,s){const i=e.fields||{},o=t.fields||{},l=null===(r=i[Vr])||void 0===r?void 0:r.arrayValue,c=null===(a=o[Vr])||void 0===a?void 0:a.arrayValue,d=Y((null===l||void 0===l||null===(n=l.values)||void 0===n?void 0:n.length)||0,(null===c||void 0===c||null===(s=c.values)||void 0===s?void 0:s.length)||0);return 0!==d?d:Yr(l,c)}(e.mapValue,t.mapValue);case 11:return function(e,t){if(e===zr.mapValue&&t===zr.mapValue)return 0;if(e===zr.mapValue)return 1;if(t===zr.mapValue)return-1;const r=e.fields||{},a=Object.keys(r),n=t.fields||{},s=Object.keys(n);a.sort(),s.sort();for(let i=0;i<a.length&&i<s.length;++i){const e=X(a[i],s[i]);if(0!==e)return e;const t=Kr(r[a[i]],n[s[i]]);if(0!==t)return t}return Y(a.length,s.length)}(e.mapValue,t.mapValue);default:throw D(23264,{he:r})}}function Qr(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return Y(e,t);const r=Sr(e),a=Sr(t),n=Y(r.seconds,a.seconds);return 0!==n?n:Y(r.nanos,a.nanos)}function Yr(e,t){const r=e.values||[],a=t.values||[];for(let n=0;n<r.length&&n<a.length;++n){const e=Kr(r[n],a[n]);if(e)return e}return Y(r.length,a.length)}function Xr(e){return Jr(e)}function Jr(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){const t=Sr(e);return"time(".concat(t.seconds,",").concat(t.nanos,")")}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?function(e){return Er(e).toBase64()}(e.bytesValue):"referenceValue"in e?function(e){return oe.fromName(e).toString()}(e.referenceValue):"geoPointValue"in e?function(e){return"geo(".concat(e.latitude,",").concat(e.longitude,")")}(e.geoPointValue):"arrayValue"in e?function(e){let t="[",r=!0;for(const a of e.values||[])r?r=!1:t+=",",t+=Jr(a);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){const t=Object.keys(e.fields||{}).sort();let r="{",a=!0;for(const n of t)a?a=!1:r+=",",r+="".concat(n,":").concat(Jr(e.fields[n]));return r+"}"}(e.mapValue):D(61005,{value:e})}function Zr(e){switch(Hr(e)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const t=Pr(e);return t?16+Zr(t):16;case 5:return 2*e.stringValue.length;case 6:return Er(e.bytesValue).approximateByteSize();case 7:return e.referenceValue.length;case 9:return function(e){return(e.values||[]).reduce((e,t)=>e+Zr(t),0)}(e.arrayValue);case 10:case 11:return function(e){let t=0;return mr(e.fields,(e,r)=>{t+=e.length+Zr(r)}),t}(e.mapValue);default:throw D(13486,{value:e})}}function $r(e,t){return{referenceValue:"projects/".concat(e.projectId,"/databases/").concat(e.database,"/documents/").concat(t.path.canonicalString())}}function ea(e){return!!e&&"integerValue"in e}function ta(e){return!!e&&"arrayValue"in e}function ra(e){return!!e&&"nullValue"in e}function aa(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function na(e){return!!e&&"mapValue"in e}function sa(e){var t,r;return(null===(t=((null===e||void 0===e||null===(r=e.mapValue)||void 0===r?void 0:r.fields)||{})[Or])||void 0===t?void 0:t.stringValue)===Ur}function ia(e){if(e.geoPointValue)return{geoPointValue:(0,s.A)({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:(0,s.A)({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return mr(e.mapValue.fields,(e,r)=>t.mapValue.fields[e]=ia(r)),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let r=0;r<(e.arrayValue.values||[]).length;++r)t.arrayValue.values[r]=ia(e.arrayValue.values[r]);return t}return(0,s.A)({},e)}function oa(e){return(((e.mapValue||{}).fields||{}).__type__||{}).stringValue===Br}const la={mapValue:{fields:{[Or]:{stringValue:Ur},[Vr]:{arrayValue:{}}}}};function ca(e){return"nullValue"in e?qr:"booleanValue"in e?{booleanValue:!1}:"integerValue"in e||"doubleValue"in e?{doubleValue:NaN}:"timestampValue"in e?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in e?{stringValue:""}:"bytesValue"in e?{bytesValue:""}:"referenceValue"in e?$r(Rr.empty(),oe.empty()):"geoPointValue"in e?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in e?{arrayValue:{}}:"mapValue"in e?sa(e)?la:{mapValue:{}}:D(35942,{value:e})}function da(e){return"nullValue"in e?{booleanValue:!1}:"booleanValue"in e?{doubleValue:NaN}:"integerValue"in e||"doubleValue"in e?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in e?{stringValue:""}:"stringValue"in e?{bytesValue:""}:"bytesValue"in e?$r(Rr.empty(),oe.empty()):"referenceValue"in e?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in e?{arrayValue:{}}:"arrayValue"in e?la:"mapValue"in e?sa(e)?{mapValue:{}}:zr:D(61959,{value:e})}function ua(e,t){const r=Kr(e.value,t.value);return 0!==r?r:e.inclusive&&!t.inclusive?-1:!e.inclusive&&t.inclusive?1:0}function ha(e,t){const r=Kr(e.value,t.value);return 0!==r?r:e.inclusive&&!t.inclusive?1:!e.inclusive&&t.inclusive?-1:0}class ma{constructor(e){this.value=e}static empty(){return new ma({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!na(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=ia(t)}setAll(e){let t=ie.emptyPath(),r={},a=[];e.forEach((e,n)=>{if(!t.isImmediateParentOf(n)){const e=this.getFieldsMap(t);this.applyChanges(e,r,a),r={},a=[],t=n.popLast()}e?r[n.lastSegment()]=ia(e):a.push(n.lastSegment())});const n=this.getFieldsMap(t);this.applyChanges(n,r,a)}delete(e){const t=this.field(e.popLast());na(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Gr(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let a=t.mapValue.fields[e.get(r)];na(a)&&a.mapValue.fields||(a={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=a),t=a}return t.mapValue.fields}applyChanges(e,t,r){mr(t,(t,r)=>e[t]=r);for(const a of r)delete e[a]}clone(){return new ma(ia(this.value))}}function fa(e){const t=[];return mr(e.fields,(e,r)=>{const a=new ie([e]);if(na(r)){const e=fa(r.mapValue).fields;if(0===e.length)t.push(a);else for(const r of e)t.push(a.child(r))}else t.push(a)}),new wr(t)}class ga{constructor(e,t,r,a,n,s,i){this.key=e,this.documentType=t,this.version=r,this.readTime=a,this.createTime=n,this.data=s,this.documentState=i}static newInvalidDocument(e){return new ga(e,0,be.min(),be.min(),be.min(),ma.empty(),0)}static newFoundDocument(e,t,r,a){return new ga(e,1,t,be.min(),r,a,0)}static newNoDocument(e,t){return new ga(e,2,t,be.min(),be.min(),ma.empty(),0)}static newUnknownDocument(e,t){return new ga(e,3,t,be.min(),be.min(),ma.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(be.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=ma.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=ma.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=be.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof ga&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new ga(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return"Document(".concat(this.key,", ").concat(this.version,", ").concat(JSON.stringify(this.data.value),", {createTime: ").concat(this.createTime,"}), {documentType: ").concat(this.documentType,"}), {documentState: ").concat(this.documentState,"})")}}class pa{constructor(e,t){this.position=e,this.inclusive=t}}function xa(e,t,r){let a=0;for(let n=0;n<e.position.length;n++){const s=t[n],i=e.position[n];if(a=s.field.isKeyField()?oe.comparator(oe.fromName(i.referenceValue),r.key):Kr(i,r.data.field(s.field)),"desc"===s.dir&&(a*=-1),0!==a)break}return a}function ya(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let r=0;r<e.position.length;r++)if(!Gr(e.position[r],t.position[r]))return!1;return!0}class va{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc";this.field=e,this.dir=t}}function ba(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}class wa{}class ka extends wa{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,r):new Da(e,t,r):"array-contains"===t?new Ma(e,r):"in"===t?new Ra(e,r):"not-in"===t?new Oa(e,r):"array-contains-any"===t?new Ba(e,r):new ka(e,t,r)}static createKeyFieldInFilter(e,t,r){return"in"===t?new Pa(e,r):new Fa(e,r)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&void 0===t.nullValue&&this.matchesComparison(Kr(t,this.value)):null!==t&&Hr(this.value)===Hr(t)&&this.matchesComparison(Kr(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return D(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Na extends wa{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new Na(e,t)}matches(e){return ja(this)?void 0===this.filters.find(t=>!t.matches(e)):void 0!==this.filters.find(t=>t.matches(e))}getFlattenedFilters(){return null!==this.Pe||(this.Pe=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function ja(e){return"and"===e.op}function Sa(e){return"or"===e.op}function _a(e){return Ea(e)&&ja(e)}function Ea(e){for(const t of e.filters)if(t instanceof Na)return!1;return!0}function Aa(e){if(e instanceof ka)return e.field.canonicalString()+e.op.toString()+Xr(e.value);if(_a(e))return e.filters.map(e=>Aa(e)).join(",");{const t=e.filters.map(e=>Aa(e)).join(",");return"".concat(e.op,"(").concat(t,")")}}function Ca(e,t){return e instanceof ka?function(e,t){return t instanceof ka&&e.op===t.op&&e.field.isEqual(t.field)&&Gr(e.value,t.value)}(e,t):e instanceof Na?function(e,t){return t instanceof Na&&e.op===t.op&&e.filters.length===t.filters.length&&e.filters.reduce((e,r,a)=>e&&Ca(r,t.filters[a]),!0)}(e,t):void D(19439)}function Ia(e,t){const r=e.filters.concat(t);return Na.create(r,e.op)}function Ta(e){return e instanceof ka?function(e){return"".concat(e.field.canonicalString()," ").concat(e.op," ").concat(Xr(e.value))}(e):e instanceof Na?function(e){return e.op.toString()+" {"+e.getFilters().map(Ta).join(" ,")+"}"}(e):"Filter"}class Da extends ka{constructor(e,t,r){super(e,t,r),this.key=oe.fromName(r.referenceValue)}matches(e){const t=oe.comparator(e.key,this.key);return this.matchesComparison(t)}}class Pa extends ka{constructor(e,t){super(e,"in",t),this.keys=La("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class Fa extends ka{constructor(e,t){super(e,"not-in",t),this.keys=La("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function La(e,t){var r;return((null===(r=t.arrayValue)||void 0===r?void 0:r.values)||[]).map(e=>oe.fromName(e.referenceValue))}class Ma extends ka{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return ta(t)&&Wr(t.arrayValue,this.value)}}class Ra extends ka{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&Wr(this.value.arrayValue,t)}}class Oa extends ka{constructor(e,t){super(e,"not-in",t)}matches(e){if(Wr(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&void 0===t.nullValue&&!Wr(this.value.arrayValue,t)}}class Ba extends ka{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!ta(t)||!t.arrayValue.values)&&t.arrayValue.values.some(e=>Wr(this.value.arrayValue,e))}}class za{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=a,this.limit=n,this.startAt=s,this.endAt=i,this.Te=null}}function Ua(e){return new za(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,arguments.length>6&&void 0!==arguments[6]?arguments[6]:null)}function Va(e){const t=L(e);if(null===t.Te){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map(e=>Aa(e)).join(","),e+="|ob:",e+=t.orderBy.map(e=>function(e){return e.field.canonicalString()+e.dir}(e)).join(","),Je(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map(e=>Xr(e)).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map(e=>Xr(e)).join(",")),t.Te=e}return t.Te}function qa(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(let r=0;r<e.orderBy.length;r++)if(!ba(e.orderBy[r],t.orderBy[r]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let r=0;r<e.filters.length;r++)if(!Ca(e.filters[r],t.filters[r]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!ya(e.startAt,t.startAt)&&ya(e.endAt,t.endAt)}function Ha(e){return oe.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}function Ga(e,t){return e.filters.filter(e=>e instanceof ka&&e.field.isEqual(t))}function Wa(e,t,r){let a=qr,n=!0;for(const s of Ga(e,t)){let e=qr,t=!0;switch(s.op){case"<":case"<=":e=ca(s.value);break;case"==":case"in":case">=":e=s.value;break;case">":e=s.value,t=!1;break;case"!=":case"not-in":e=qr}ua({value:a,inclusive:n},{value:e,inclusive:t})<0&&(a=e,n=t)}if(null!==r)for(let s=0;s<e.orderBy.length;++s)if(e.orderBy[s].field.isEqual(t)){const e=r.position[s];ua({value:a,inclusive:n},{value:e,inclusive:r.inclusive})<0&&(a=e,n=r.inclusive);break}return{value:a,inclusive:n}}function Ka(e,t,r){let a=zr,n=!0;for(const s of Ga(e,t)){let e=zr,t=!0;switch(s.op){case">=":case">":e=da(s.value),t=!1;break;case"==":case"in":case"<=":e=s.value;break;case"<":e=s.value,t=!1;break;case"!=":case"not-in":e=zr}ha({value:a,inclusive:n},{value:e,inclusive:t})>0&&(a=e,n=t)}if(null!==r)for(let s=0;s<e.orderBy.length;++s)if(e.orderBy[s].field.isEqual(t)){const e=r.position[s];ha({value:a,inclusive:n},{value:e,inclusive:r.inclusive})>0&&(a=e,n=r.inclusive);break}return{value:a,inclusive:n}}class Qa{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"F",i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=a,this.limit=n,this.limitType=s,this.startAt=i,this.endAt=o,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function Ya(e,t,r,a,n,s,i,o){return new Qa(e,t,r,a,n,s,i,o)}function Xa(e){return new Qa(e)}function Ja(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function Za(e){return null!==e.collectionGroup}function $a(e){const t=L(e);if(null===t.Ie){t.Ie=[];const e=new Set;for(const n of t.explicitOrderBy)t.Ie.push(n),e.add(n.field.canonicalString());const r=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc",a=function(e){let t=new yr(ie.comparator);return e.filters.forEach(e=>{e.getFlattenedFilters().forEach(e=>{e.isInequality()&&(t=t.add(e.field))})}),t}(t);a.forEach(a=>{e.has(a.canonicalString())||a.isKeyField()||t.Ie.push(new va(a,r))}),e.has(ie.keyField().canonicalString())||t.Ie.push(new va(ie.keyField(),r))}return t.Ie}function en(e){const t=L(e);return t.Ee||(t.Ee=tn(t,$a(e))),t.Ee}function tn(e,t){if("F"===e.limitType)return Ua(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map(e=>{const t="desc"===e.dir?"asc":"desc";return new va(e.field,t)});const r=e.endAt?new pa(e.endAt.position,e.endAt.inclusive):null,a=e.startAt?new pa(e.startAt.position,e.startAt.inclusive):null;return Ua(e.path,e.collectionGroup,t,e.filters,e.limit,r,a)}}function rn(e,t){const r=e.filters.concat([t]);return new Qa(e.path,e.collectionGroup,e.explicitOrderBy.slice(),r,e.limit,e.limitType,e.startAt,e.endAt)}function an(e,t,r){return new Qa(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,r,e.startAt,e.endAt)}function nn(e,t){return qa(en(e),en(t))&&e.limitType===t.limitType}function sn(e){return"".concat(Va(en(e)),"|lt:").concat(e.limitType)}function on(e){return"Query(target=".concat(function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=", filters: [".concat(e.filters.map(e=>Ta(e)).join(", "),"]")),Je(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=", orderBy: [".concat(e.orderBy.map(e=>function(e){return"".concat(e.field.canonicalString()," (").concat(e.dir,")")}(e)).join(", "),"]")),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(e=>Xr(e)).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(e=>Xr(e)).join(",")),"Target(".concat(t,")")}(en(e)),"; limitType=").concat(e.limitType,")")}function ln(e,t){return t.isFoundDocument()&&function(e,t){const r=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(r):oe.isDocumentKey(e.path)?e.path.isEqual(r):e.path.isImmediateParentOf(r)}(e,t)&&function(e,t){for(const r of $a(e))if(!r.field.isKeyField()&&null===t.data.field(r.field))return!1;return!0}(e,t)&&function(e,t){for(const r of e.filters)if(!r.matches(t))return!1;return!0}(e,t)&&function(e,t){return!(e.startAt&&!function(e,t,r){const a=xa(e,t,r);return e.inclusive?a<=0:a<0}(e.startAt,$a(e),t))&&!(e.endAt&&!function(e,t,r){const a=xa(e,t,r);return e.inclusive?a>=0:a>0}(e.endAt,$a(e),t))}(e,t)}function cn(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function dn(e){return(t,r)=>{let a=!1;for(const n of $a(e)){const e=un(n,t,r);if(0!==e)return e;a=a||n.field.isKeyField()}return 0}}function un(e,t,r){const a=e.field.isKeyField()?oe.comparator(t.key,r.key):function(e,t,r){const a=t.data.field(e),n=r.data.field(e);return null!==a&&null!==n?Kr(a,n):D(42886)}(e.field,t,r);switch(e.dir){case"asc":return a;case"desc":return-1*a;default:return D(19790,{direction:e.dir})}}class hn{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(void 0!==r)for(const[a,n]of r)if(this.equalsFn(a,e))return n}has(e){return void 0!==this.get(e)}set(e,t){const r=this.mapKeyFn(e),a=this.inner[r];if(void 0===a)return this.inner[r]=[[e,t]],void this.innerSize++;for(let n=0;n<a.length;n++)if(this.equalsFn(a[n][0],e))return void(a[n]=[e,t]);a.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(void 0===r)return!1;for(let a=0;a<r.length;a++)if(this.equalsFn(r[a][0],e))return 1===r.length?delete this.inner[t]:r.splice(a,1),this.innerSize--,!0;return!1}forEach(e){mr(this.inner,(t,r)=>{for(const[a,n]of r)e(a,n)})}isEmpty(){return fr(this.inner)}size(){return this.innerSize}}const mn=new gr(oe.comparator);function fn(){return mn}const gn=new gr(oe.comparator);function pn(){let e=gn;for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];for(const n of r)e=e.insert(n.key,n);return e}function xn(e){let t=gn;return e.forEach((e,r)=>t=t.insert(e,r.overlayedDocument)),t}function yn(){return bn()}function vn(){return bn()}function bn(){return new hn(e=>e.toString(),(e,t)=>e.isEqual(t))}const wn=new gr(oe.comparator),kn=new yr(oe.comparator);function Nn(){let e=kn;for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];for(const n of r)e=e.add(n);return e}const jn=new yr(Y);function Sn(){return jn}function _n(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ze(t)?"-0":t}}function En(e){return{integerValue:""+e}}function An(e,t){return $e(t)?En(t):_n(e,t)}class Cn{constructor(){this._=void 0}}function In(e,t,r){return e instanceof Pn?function(e,t){const r={fields:{[Cr]:{stringValue:Ar},[Tr]:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&Dr(t)&&(t=Pr(t)),t&&(r.fields[Ir]=t),{mapValue:r}}(r,t):e instanceof Fn?Ln(e,t):e instanceof Mn?Rn(e,t):function(e,t){const r=Dn(e,t),a=Bn(r)+Bn(e.Ae);return ea(r)&&ea(e.Ae)?En(a):_n(e.serializer,a)}(e,t)}function Tn(e,t,r){return e instanceof Fn?Ln(e,t):e instanceof Mn?Rn(e,t):r}function Dn(e,t){return e instanceof On?function(e){return ea(e)||function(e){return!!e&&"doubleValue"in e}(e)}(t)?t:{integerValue:0}:null}class Pn extends Cn{}class Fn extends Cn{constructor(e){super(),this.elements=e}}function Ln(e,t){const r=zn(t);for(const a of e.elements)r.some(e=>Gr(e,a))||r.push(a);return{arrayValue:{values:r}}}class Mn extends Cn{constructor(e){super(),this.elements=e}}function Rn(e,t){let r=zn(t);for(const a of e.elements)r=r.filter(e=>!Gr(e,a));return{arrayValue:{values:r}}}class On extends Cn{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function Bn(e){return _r(e.integerValue||e.doubleValue)}function zn(e){return ta(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}class Un{constructor(e,t){this.field=e,this.transform=t}}class Vn{constructor(e,t){this.version=e,this.transformResults=t}}class qn{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new qn}static exists(e){return new qn(void 0,e)}static updateTime(e){return new qn(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Hn(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class Gn{}function Wn(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new rs(e.key,qn.none()):new Jn(e.key,e.data,qn.none());{const r=e.data,a=ma.empty();let n=new yr(ie.comparator);for(let e of t.fields)if(!n.has(e)){let t=r.field(e);null===t&&e.length>1&&(e=e.popLast(),t=r.field(e)),null===t?a.delete(e):a.set(e,t),n=n.add(e)}return new Zn(e.key,a,new wr(n.toArray()),qn.none())}}function Kn(e,t,r){e instanceof Jn?function(e,t,r){const a=e.value.clone(),n=es(e.fieldTransforms,t,r.transformResults);a.setAll(n),t.convertToFoundDocument(r.version,a).setHasCommittedMutations()}(e,t,r):e instanceof Zn?function(e,t,r){if(!Hn(e.precondition,t))return void t.convertToUnknownDocument(r.version);const a=es(e.fieldTransforms,t,r.transformResults),n=t.data;n.setAll($n(e)),n.setAll(a),t.convertToFoundDocument(r.version,n).setHasCommittedMutations()}(e,t,r):function(e,t,r){t.convertToNoDocument(r.version).setHasCommittedMutations()}(0,t,r)}function Qn(e,t,r,a){return e instanceof Jn?function(e,t,r,a){if(!Hn(e.precondition,t))return r;const n=e.value.clone(),s=ts(e.fieldTransforms,a,t);return n.setAll(s),t.convertToFoundDocument(t.version,n).setHasLocalMutations(),null}(e,t,r,a):e instanceof Zn?function(e,t,r,a){if(!Hn(e.precondition,t))return r;const n=ts(e.fieldTransforms,a,t),s=t.data;return s.setAll($n(e)),s.setAll(n),t.convertToFoundDocument(t.version,s).setHasLocalMutations(),null===r?null:r.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map(e=>e.field))}(e,t,r,a):function(e,t,r){return Hn(e.precondition,t)?(t.convertToNoDocument(t.version).setHasLocalMutations(),null):r}(e,t,r)}function Yn(e,t){let r=null;for(const a of e.fieldTransforms){const e=t.data.field(a.field),n=Dn(a.transform,e||null);null!=n&&(null===r&&(r=ma.empty()),r.set(a.field,n))}return r||null}function Xn(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(e,t){return void 0===e&&void 0===t||!(!e||!t)&&ee(e,t,(e,t)=>function(e,t){return e.field.isEqual(t.field)&&function(e,t){return e instanceof Fn&&t instanceof Fn||e instanceof Mn&&t instanceof Mn?ee(e.elements,t.elements,Gr):e instanceof On&&t instanceof On?Gr(e.Ae,t.Ae):e instanceof Pn&&t instanceof Pn}(e.transform,t.transform)}(e,t))}(e.fieldTransforms,t.fieldTransforms)&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class Jn extends Gn{constructor(e,t,r){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=a,this.type=0}getFieldMask(){return null}}class Zn extends Gn{constructor(e,t,r,a){let n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=a,this.fieldTransforms=n,this.type=1}getFieldMask(){return this.fieldMask}}function $n(e){const t=new Map;return e.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const a=e.data.field(r);t.set(r,a)}}),t}function es(e,t,r){const a=new Map;F(e.length===r.length,32656,{Re:r.length,Ve:e.length});for(let n=0;n<r.length;n++){const s=e[n],i=s.transform,o=t.data.field(s.field);a.set(s.field,Tn(i,o,r[n]))}return a}function ts(e,t,r){const a=new Map;for(const n of e){const e=n.transform,s=r.data.field(n.field);a.set(n.field,In(e,s,t))}return a}class rs extends Gn{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class as extends Gn{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class ns{constructor(e,t,r,a){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=a}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let a=0;a<this.mutations.length;a++){const t=this.mutations[a];t.key.isEqual(e.key)&&Kn(t,e,r[a])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=Qn(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=Qn(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=vn();return this.mutations.forEach(a=>{const n=e.get(a.key),s=n.overlayedDocument;let i=this.applyToLocalView(s,n.mutatedFields);i=t.has(a.key)?null:i;const o=Wn(s,i);null!==o&&r.set(a.key,o),s.isValidDocument()||s.convertToNoDocument(be.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),Nn())}isEqual(e){return this.batchId===e.batchId&&ee(this.mutations,e.mutations,(e,t)=>Xn(e,t))&&ee(this.baseMutations,e.baseMutations,(e,t)=>Xn(e,t))}}class ss{constructor(e,t,r,a){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=a}static from(e,t,r){F(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let a=wn;const n=e.mutations;for(let s=0;s<n.length;s++)a=a.insert(n[s].key,r[s].version);return new ss(e,t,r,a)}}class is{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return"Overlay{\n      largestBatchId: ".concat(this.largestBatchId,",\n      mutation: ").concat(this.mutation.toString(),"\n    }")}}class os{constructor(e,t){this.count=e,this.unchangedNames=t}}var ls,cs;function ds(e){switch(e){case M.OK:return D(64938);case M.CANCELLED:case M.UNKNOWN:case M.DEADLINE_EXCEEDED:case M.RESOURCE_EXHAUSTED:case M.INTERNAL:case M.UNAVAILABLE:case M.UNAUTHENTICATED:return!1;case M.INVALID_ARGUMENT:case M.NOT_FOUND:case M.ALREADY_EXISTS:case M.PERMISSION_DENIED:case M.FAILED_PRECONDITION:case M.ABORTED:case M.OUT_OF_RANGE:case M.UNIMPLEMENTED:case M.DATA_LOSS:return!0;default:return D(15467,{code:e})}}function us(e){if(void 0===e)return C("GRPC error has no .code"),M.UNKNOWN;switch(e){case ls.OK:return M.OK;case ls.CANCELLED:return M.CANCELLED;case ls.UNKNOWN:return M.UNKNOWN;case ls.DEADLINE_EXCEEDED:return M.DEADLINE_EXCEEDED;case ls.RESOURCE_EXHAUSTED:return M.RESOURCE_EXHAUSTED;case ls.INTERNAL:return M.INTERNAL;case ls.UNAVAILABLE:return M.UNAVAILABLE;case ls.UNAUTHENTICATED:return M.UNAUTHENTICATED;case ls.INVALID_ARGUMENT:return M.INVALID_ARGUMENT;case ls.NOT_FOUND:return M.NOT_FOUND;case ls.ALREADY_EXISTS:return M.ALREADY_EXISTS;case ls.PERMISSION_DENIED:return M.PERMISSION_DENIED;case ls.FAILED_PRECONDITION:return M.FAILED_PRECONDITION;case ls.ABORTED:return M.ABORTED;case ls.OUT_OF_RANGE:return M.OUT_OF_RANGE;case ls.UNIMPLEMENTED:return M.UNIMPLEMENTED;case ls.DATA_LOSS:return M.DATA_LOSS;default:return D(39323,{code:e})}}(cs=ls||(ls={}))[cs.OK=0]="OK",cs[cs.CANCELLED=1]="CANCELLED",cs[cs.UNKNOWN=2]="UNKNOWN",cs[cs.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",cs[cs.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",cs[cs.NOT_FOUND=5]="NOT_FOUND",cs[cs.ALREADY_EXISTS=6]="ALREADY_EXISTS",cs[cs.PERMISSION_DENIED=7]="PERMISSION_DENIED",cs[cs.UNAUTHENTICATED=16]="UNAUTHENTICATED",cs[cs.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",cs[cs.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",cs[cs.ABORTED=10]="ABORTED",cs[cs.OUT_OF_RANGE=11]="OUT_OF_RANGE",cs[cs.UNIMPLEMENTED=12]="UNIMPLEMENTED",cs[cs.INTERNAL=13]="INTERNAL",cs[cs.UNAVAILABLE=14]="UNAVAILABLE",cs[cs.DATA_LOSS=15]="DATA_LOSS";let hs=null;function ms(){return new TextEncoder}const fs=new a([4294967295,4294967295],0);function gs(e){const t=ms().encode(e),r=new n;return r.update(t),new Uint8Array(r.digest())}function ps(e){const t=new DataView(e.buffer),r=t.getUint32(0,!0),n=t.getUint32(4,!0),s=t.getUint32(8,!0),i=t.getUint32(12,!0);return[new a([r,n],0),new a([s,i],0)]}class xs{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new ys("Invalid padding: ".concat(t));if(r<0)throw new ys("Invalid hash count: ".concat(r));if(e.length>0&&0===this.hashCount)throw new ys("Invalid hash count: ".concat(r));if(0===e.length&&0!==t)throw new ys("Invalid padding when bitmap length is 0: ".concat(t));this.ge=8*e.length-t,this.pe=a.fromNumber(this.ge)}ye(e,t,r){let n=e.add(t.multiply(a.fromNumber(r)));return 1===n.compare(fs)&&(n=new a([n.getBits(0),n.getBits(1)],0)),n.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(0===this.ge)return!1;const t=gs(e),[r,a]=ps(t);for(let n=0;n<this.hashCount;n++){const e=this.ye(r,a,n);if(!this.we(e))return!1}return!0}static create(e,t,r){const a=e%8==0?0:8-e%8,n=new Uint8Array(Math.ceil(e/8)),s=new xs(n,a,t);return r.forEach(e=>s.insert(e)),s}insert(e){if(0===this.ge)return;const t=gs(e),[r,a]=ps(t);for(let n=0;n<this.hashCount;n++){const e=this.ye(r,a,n);this.Se(e)}}Se(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class ys extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class vs{constructor(e,t,r,a,n){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=a,this.resolvedLimboDocuments=n}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const a=new Map;return a.set(e,bs.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new vs(be.min(),a,new gr(Y),fn(),Nn())}}class bs{constructor(e,t,r,a,n){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=a,this.removedDocuments=n}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new bs(r,t,Nn(),Nn(),Nn())}}class ws{constructor(e,t,r,a){this.be=e,this.removedTargetIds=t,this.key=r,this.De=a}}class ks{constructor(e,t){this.targetId=e,this.Ce=t}}class Ns{constructor(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Nr.EMPTY_BYTE_STRING,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=a}}class js{constructor(){this.ve=0,this.Fe=Es(),this.Me=Nr.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return 0!==this.ve}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Nn(),t=Nn(),r=Nn();return this.Fe.forEach((a,n)=>{switch(n){case 0:e=e.add(a);break;case 2:t=t.add(a);break;case 1:r=r.add(a);break;default:D(38017,{changeType:n})}}),new bs(this.Me,this.xe,e,t,r)}qe(){this.Oe=!1,this.Fe=Es()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,F(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class Ss{constructor(e){this.Ge=e,this.ze=new Map,this.je=fn(),this.Je=_s(),this.He=_s(),this.Ye=new gr(Y)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,t=>{const r=this.nt(t);switch(e.state){case 0:this.rt(t)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),r.Le(e.resumeToken));break;default:D(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach((e,r)=>{this.rt(r)&&t(r)})}st(e){const t=e.targetId,r=e.Ce.count,a=this.ot(t);if(a){const s=a.target;if(Ha(s))if(0===r){const e=new oe(s.path);this.et(t,e,ga.newNoDocument(e,be.min()))}else F(1===r,20013,{expectedCount:r});else{const a=this._t(t);if(a!==r){var n;const r=this.ut(e),s=r?this.ct(r,e,a):1;if(0!==s){this.it(t);const e=2===s?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,e)}null===(n=hs)||void 0===n||n.lt(function(e,t,r,a,n,s,i,o,l,c){const d={localCacheCount:e,existenceFilterCount:t.count,databaseId:r.database,projectId:r.projectId},u=t.unchangedNames;return u&&(d.bloomFilter={applied:0===n,hashCount:null!==(s=null===u||void 0===u?void 0:u.hashCount)&&void 0!==s?s:0,bitmapLength:null!==(i=null===u||void 0===u||null===(o=u.bits)||void 0===o||null===(o=o.bitmap)||void 0===o?void 0:o.length)&&void 0!==i?i:0,padding:null!==(l=null===u||void 0===u||null===(c=u.bits)||void 0===c?void 0:c.padding)&&void 0!==l?l:0,mightContain:e=>{var t;return null!==(t=null===a||void 0===a?void 0:a.mightContain(e))&&void 0!==t&&t}}),d}(a,e.Ce,this.Ge.ht(),r,s))}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:a=0},hashCount:n=0}=t;let s,i;try{s=Er(r).toUint8Array()}catch(e){if(e instanceof kr)return I("Decoding the base64 bloom filter in existence filter failed ("+e.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw e}try{i=new xs(s,a,n)}catch(e){return I(e instanceof ys?"BloomFilter error: ":"Applying bloom filter failed: ",e),null}return 0===i.ge?null:i}ct(e,t,r){return t.Ce.count===r-this.Pt(e,t.targetId)?0:2}Pt(e,t){const r=this.Ge.getRemoteKeysForTarget(t);let a=0;return r.forEach(r=>{const n=this.Ge.ht(),s="projects/".concat(n.projectId,"/databases/").concat(n.database,"/documents/").concat(r.path.canonicalString());e.mightContain(s)||(this.et(t,r,null),a++)}),a}Tt(e){const t=new Map;this.ze.forEach((r,a)=>{const n=this.ot(a);if(n){if(r.current&&Ha(n.target)){const t=new oe(n.target.path);this.It(t).has(a)||this.Et(a,t)||this.et(a,t,ga.newNoDocument(t,e))}r.Be&&(t.set(a,r.ke()),r.qe())}});let r=Nn();this.He.forEach((e,t)=>{let a=!0;t.forEachWhile(e=>{const t=this.ot(e);return!t||"TargetPurposeLimboResolution"===t.purpose||(a=!1,!1)}),a&&(r=r.add(e))}),this.je.forEach((t,r)=>r.setReadTime(e));const a=new vs(e,t,this.Ye,this.je,r);return this.je=fn(),this.Je=_s(),this.He=_s(),this.Ye=new gr(Y),a}Xe(e,t){if(!this.rt(e))return;const r=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,r),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,r){if(!this.rt(e))return;const a=this.nt(e);this.Et(e,t)?a.Qe(t,1):a.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),r&&(this.je=this.je.insert(t,r))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new js,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new yr(Y),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new yr(Y),this.Je=this.Je.insert(e,t)),t}rt(e){const t=null!==this.ot(e);return t||A("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new js),this.Ge.getRemoteKeysForTarget(e).forEach(t=>{this.et(e,t,null)})}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function _s(){return new gr(oe.comparator)}function Es(){return new gr(oe.comparator)}const As={asc:"ASCENDING",desc:"DESCENDING"},Cs={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Is={and:"AND",or:"OR"};class Ts{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Ds(e,t){return e.useProto3Json||Je(t)?t:{value:t}}function Ps(e,t){return e.useProto3Json?"".concat(new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z",""),".").concat(("000000000"+t.nanoseconds).slice(-9),"Z"):{seconds:""+t.seconds,nanos:t.nanoseconds}}function Fs(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function Ls(e,t){return Ps(e,t.toTimestamp())}function Ms(e){return F(!!e,49232),be.fromTimestamp(function(e){const t=Sr(e);return new ve(t.seconds,t.nanos)}(e))}function Rs(e,t){return Os(e,t).canonicalString()}function Os(e,t){const r=function(e){return new ne(["projects",e.projectId,"databases",e.database])}(e).child("documents");return void 0===t?r:r.child(t)}function Bs(e){const t=ne.fromString(e);return F(oi(t),10190,{key:t.toString()}),t}function zs(e,t){return Rs(e.databaseId,t.path)}function Us(e,t){const r=Bs(t);if(r.get(1)!==e.databaseId.projectId)throw new R(M.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+e.databaseId.projectId);if(r.get(3)!==e.databaseId.database)throw new R(M.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+e.databaseId.database);return new oe(Gs(r))}function Vs(e,t){return Rs(e.databaseId,t)}function qs(e){const t=Bs(e);return 4===t.length?ne.emptyPath():Gs(t)}function Hs(e){return new ne(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function Gs(e){return F(e.length>4&&"documents"===e.get(4),29091,{key:e.toString()}),e.popFirst(5)}function Ws(e,t,r){return{name:zs(e,t),fields:r.value.mapValue.fields}}function Ks(e,t,r){const a=Us(e,t.name),n=Ms(t.updateTime),s=t.createTime?Ms(t.createTime):be.min(),i=new ma({mapValue:{fields:t.fields}}),o=ga.newFoundDocument(a,n,s,i);return r&&o.setHasCommittedMutations(),r?o.setHasCommittedMutations():o}function Qs(e,t){let r;if(t instanceof Jn)r={update:Ws(e,t.key,t.value)};else if(t instanceof rs)r={delete:zs(e,t.key)};else if(t instanceof Zn)r={update:Ws(e,t.key,t.data),updateMask:ii(t.fieldMask)};else{if(!(t instanceof as))return D(16599,{Vt:t.type});r={verify:zs(e,t.key)}}return t.fieldTransforms.length>0&&(r.updateTransforms=t.fieldTransforms.map(e=>function(e,t){const r=t.transform;if(r instanceof Pn)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(r instanceof Fn)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:r.elements}};if(r instanceof Mn)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:r.elements}};if(r instanceof On)return{fieldPath:t.field.canonicalString(),increment:r.Ae};throw D(20930,{transform:t.transform})}(0,e))),t.precondition.isNone||(r.currentDocument=function(e,t){return void 0!==t.updateTime?{updateTime:Ls(e,t.updateTime)}:void 0!==t.exists?{exists:t.exists}:D(27497)}(e,t.precondition)),r}function Ys(e,t){const r=t.currentDocument?function(e){return void 0!==e.updateTime?qn.updateTime(Ms(e.updateTime)):void 0!==e.exists?qn.exists(e.exists):qn.none()}(t.currentDocument):qn.none(),a=t.updateTransforms?t.updateTransforms.map(t=>function(e,t){let r=null;if("setToServerValue"in t)F("REQUEST_TIME"===t.setToServerValue,16630,{proto:t}),r=new Pn;else if("appendMissingElements"in t){const e=t.appendMissingElements.values||[];r=new Fn(e)}else if("removeAllFromArray"in t){const e=t.removeAllFromArray.values||[];r=new Mn(e)}else"increment"in t?r=new On(e,t.increment):D(16584,{proto:t});const a=ie.fromServerFormat(t.fieldPath);return new Un(a,r)}(e,t)):[];if(t.update){t.update.name;const n=Us(e,t.update.name),s=new ma({mapValue:{fields:t.update.fields}});if(t.updateMask){const e=function(e){const t=e.fieldPaths||[];return new wr(t.map(e=>ie.fromServerFormat(e)))}(t.updateMask);return new Zn(n,s,e,r,a)}return new Jn(n,s,r,a)}if(t.delete){const a=Us(e,t.delete);return new rs(a,r)}if(t.verify){const a=Us(e,t.verify);return new as(a,r)}return D(1463,{proto:t})}function Xs(e,t){return{documents:[Vs(e,t.path)]}}function Js(e,t){const r={structuredQuery:{}},a=t.path;let n;null!==t.collectionGroup?(n=a,r.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(n=a.popLast(),r.structuredQuery.from=[{collectionId:a.lastSegment()}]),r.parent=Vs(e,n);const s=function(e){if(0!==e.length)return si(Na.create(e,"and"))}(t.filters);s&&(r.structuredQuery.where=s);const i=function(e){if(0!==e.length)return e.map(e=>function(e){return{field:ai(e.field),direction:ei(e.dir)}}(e))}(t.orderBy);i&&(r.structuredQuery.orderBy=i);const o=Ds(e,t.limit);return null!==o&&(r.structuredQuery.limit=o),t.startAt&&(r.structuredQuery.startAt=function(e){return{before:e.inclusive,values:e.position}}(t.startAt)),t.endAt&&(r.structuredQuery.endAt=function(e){return{before:!e.inclusive,values:e.position}}(t.endAt)),{ft:r,parent:n}}function Zs(e){let t=qs(e.parent);const r=e.structuredQuery,a=r.from?r.from.length:0;let n=null;if(a>0){F(1===a,65062);const e=r.from[0];e.allDescendants?n=e.collectionId:t=t.child(e.collectionId)}let s=[];r.where&&(s=function(e){const t=$s(e);return t instanceof Na&&_a(t)?t.getFilters():[t]}(r.where));let i=[];r.orderBy&&(i=function(e){return e.map(e=>function(e){return new va(ni(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))}(e))}(r.orderBy));let o=null;r.limit&&(o=function(e){let t;return t="object"==typeof e?e.value:e,Je(t)?null:t}(r.limit));let l=null;r.startAt&&(l=function(e){const t=!!e.before,r=e.values||[];return new pa(r,t)}(r.startAt));let c=null;return r.endAt&&(c=function(e){const t=!e.before,r=e.values||[];return new pa(r,t)}(r.endAt)),Ya(t,n,i,s,o,"F",l,c)}function $s(e){return void 0!==e.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":const t=ni(e.unaryFilter.field);return ka.create(t,"==",{doubleValue:NaN});case"IS_NULL":const r=ni(e.unaryFilter.field);return ka.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const a=ni(e.unaryFilter.field);return ka.create(a,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const n=ni(e.unaryFilter.field);return ka.create(n,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return D(61313);default:return D(60726)}}(e):void 0!==e.fieldFilter?function(e){return ka.create(ni(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return D(58110);default:return D(50506)}}(e.fieldFilter.op),e.fieldFilter.value)}(e):void 0!==e.compositeFilter?function(e){return Na.create(e.compositeFilter.filters.map(e=>$s(e)),function(e){switch(e){case"AND":return"and";case"OR":return"or";default:return D(1026)}}(e.compositeFilter.op))}(e):D(30097,{filter:e})}function ei(e){return As[e]}function ti(e){return Cs[e]}function ri(e){return Is[e]}function ai(e){return{fieldPath:e.canonicalString()}}function ni(e){return ie.fromServerFormat(e.fieldPath)}function si(e){return e instanceof ka?function(e){if("=="===e.op){if(aa(e.value))return{unaryFilter:{field:ai(e.field),op:"IS_NAN"}};if(ra(e.value))return{unaryFilter:{field:ai(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(aa(e.value))return{unaryFilter:{field:ai(e.field),op:"IS_NOT_NAN"}};if(ra(e.value))return{unaryFilter:{field:ai(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ai(e.field),op:ti(e.op),value:e.value}}}(e):e instanceof Na?function(e){const t=e.getFilters().map(e=>si(e));return 1===t.length?t[0]:{compositeFilter:{op:ri(e.op),filters:t}}}(e):D(54877,{filter:e})}function ii(e){const t=[];return e.fields.forEach(e=>t.push(e.canonicalString())),{fieldPaths:t}}function oi(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}class li{constructor(e,t,r,a){let n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:be.min(),s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:be.min(),i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:Nr.EMPTY_BYTE_STRING,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=a,this.snapshotVersion=n,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=i,this.expectedCount=o}withSequenceNumber(e){return new li(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new li(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new li(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new li(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class ci{constructor(e){this.yt=e}}function di(e,t){const r=t.key,a={prefixPath:r.getCollectionPath().popLast().toArray(),collectionGroup:r.collectionGroup,documentId:r.path.lastSegment(),readTime:ui(t.readTime),hasCommittedMutations:t.hasCommittedMutations};if(t.isFoundDocument())a.document=function(e,t){return{name:zs(e,t.key),fields:t.data.value.mapValue.fields,updateTime:Ps(e,t.version.toTimestamp()),createTime:Ps(e,t.createTime.toTimestamp())}}(e.yt,t);else if(t.isNoDocument())a.noDocument={path:r.path.toArray(),readTime:hi(t.version)};else{if(!t.isUnknownDocument())return D(57904,{document:t});a.unknownDocument={path:r.path.toArray(),version:hi(t.version)}}return a}function ui(e){const t=e.toTimestamp();return[t.seconds,t.nanoseconds]}function hi(e){const t=e.toTimestamp();return{seconds:t.seconds,nanoseconds:t.nanoseconds}}function mi(e){const t=new ve(e.seconds,e.nanoseconds);return be.fromTimestamp(t)}function fi(e,t){const r=(t.baseMutations||[]).map(t=>Ys(e.yt,t));for(let s=0;s<t.mutations.length-1;++s){const e=t.mutations[s];if(s+1<t.mutations.length&&void 0!==t.mutations[s+1].transform){const r=t.mutations[s+1];e.updateTransforms=r.transform.fieldTransforms,t.mutations.splice(s+1,1),++s}}const a=t.mutations.map(t=>Ys(e.yt,t)),n=ve.fromMillis(t.localWriteTimeMs);return new ns(t.batchId,n,r,a)}function gi(e){const t=mi(e.readTime),r=void 0!==e.lastLimboFreeSnapshotVersion?mi(e.lastLimboFreeSnapshotVersion):be.min();let a;return a=function(e){return void 0!==e.documents}(e.query)?function(e){const t=e.documents.length;return F(1===t,1966,{count:t}),en(Xa(qs(e.documents[0])))}(e.query):function(e){return en(Zs(e))}(e.query),new li(a,e.targetId,"TargetPurposeListen",e.lastListenSequenceNumber,t,r,Nr.fromBase64String(e.resumeToken))}function pi(e,t){const r=hi(t.snapshotVersion),a=hi(t.lastLimboFreeSnapshotVersion);let n;n=Ha(t.target)?Xs(e.yt,t.target):Js(e.yt,t.target).ft;const s=t.resumeToken.toBase64();return{targetId:t.targetId,canonicalId:Va(t.target),readTime:r,resumeToken:s,lastListenSequenceNumber:t.sequenceNumber,lastLimboFreeSnapshotVersion:a,query:n}}function xi(e){const t=Zs({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?an(t,t.limit,"L"):t}function yi(e,t){return new is(t.largestBatchId,Ys(e.yt,t.overlayMutation))}function vi(e,t){const r=t.path.lastSegment();return[e,tt(t.path.popLast()),r]}function bi(e,t,r,a){return{indexId:e,uid:t,sequenceNumber:r,readTime:hi(a.readTime),documentKey:tt(a.documentKey.path),largestBatchId:a.largestBatchId}}class wi{getBundleMetadata(e,t){return ki(e).get(t).next(e=>{if(e)return function(e){return{id:e.bundleId,createTime:mi(e.createTime),version:e.version}}(e)})}saveBundleMetadata(e,t){return ki(e).put(function(e){return{bundleId:e.id,createTime:hi(Ms(e.createTime)),version:e.version}}(t))}getNamedQuery(e,t){return Ni(e).get(t).next(e=>{if(e)return function(e){return{name:e.name,query:xi(e.bundledQuery),readTime:mi(e.readTime)}}(e)})}saveNamedQuery(e,t){return Ni(e).put(function(e){return{name:e.name,readTime:hi(Ms(e.readTime)),bundledQuery:e.bundledQuery}}(t))}}function ki(e){return ur(e,Rt)}function Ni(e){return ur(e,Ot)}class ji{constructor(e,t){this.serializer=e,this.userId=t}static wt(e,t){const r=t.uid||"";return new ji(e,r)}getOverlay(e,t){return Si(e).get(vi(this.userId,t)).next(e=>e?yi(this.serializer,e):null)}getOverlays(e,t){const r=yn();return Fe.forEach(t,t=>this.getOverlay(e,t).next(e=>{null!==e&&r.set(t,e)})).next(()=>r)}saveOverlays(e,t,r){const a=[];return r.forEach((r,n)=>{const s=new is(t,n);a.push(this.St(e,s))}),Fe.waitFor(a)}removeOverlaysForBatchId(e,t,r){const a=new Set;t.forEach(e=>a.add(tt(e.getCollectionPath())));const n=[];return a.forEach(t=>{const a=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,r+1],!1,!0);n.push(Si(e).Z(Jt,a))}),Fe.waitFor(n)}getOverlaysForCollection(e,t,r){const a=yn(),n=tt(t),s=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return Si(e).J(Jt,s).next(e=>{for(const t of e){const e=yi(this.serializer,t);a.set(e.getKey(),e)}return a})}getOverlaysForCollectionGroup(e,t,r,a){const n=yn();let s;const i=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Si(e).ee({index:$t,range:i},(e,t,r)=>{const i=yi(this.serializer,t);n.size()<a||i.largestBatchId===s?(n.set(i.getKey(),i),s=i.largestBatchId):r.done()}).next(()=>n)}St(e,t){return Si(e).put(function(e,t,r){const[a,n,s]=vi(t,r.mutation.key);return{userId:t,collectionPath:n,documentId:s,collectionGroup:r.mutation.key.getCollectionGroup(),largestBatchId:r.largestBatchId,overlayMutation:Qs(e.yt,r.mutation)}}(this.serializer,this.userId,t))}}function Si(e){return ur(e,Yt)}class _i{bt(e){return ur(e,tr)}getSessionToken(e){return this.bt(e).get("sessionToken").next(e=>{const t=null===e||void 0===e?void 0:e.value;return t?Nr.fromUint8Array(t):Nr.EMPTY_BYTE_STRING})}setSessionToken(e,t){return this.bt(e).put({name:"sessionToken",value:t.toUint8Array()})}}class Ei{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(_r(e.integerValue));else if("doubleValue"in e){const r=_r(e.doubleValue);isNaN(r)?this.Ft(t,13):(this.Ft(t,15),Ze(r)?t.Mt(0):t.Mt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Ft(t,20),"string"==typeof r&&(r=Sr(r)),t.xt("".concat(r.seconds||"")),t.Mt(r.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(Er(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){const r=e.geoPointValue;this.Ft(t,45),t.Mt(r.latitude||0),t.Mt(r.longitude||0)}else"mapValue"in e?oa(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):sa(e)?this.kt(e.mapValue,t):(this.qt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.Qt(e.arrayValue,t),this.Nt(t)):D(19022,{$t:e})}Ot(e,t){this.Ft(t,25),this.Ut(e,t)}Ut(e,t){t.xt(e)}qt(e,t){const r=e.fields||{};this.Ft(t,55);for(const a of Object.keys(r))this.Ot(a,t),this.Ct(r[a],t)}kt(e,t){var r;const a=e.fields||{};this.Ft(t,53);const n=Vr,s=(null===(r=a[n].arrayValue)||void 0===r||null===(r=r.values)||void 0===r?void 0:r.length)||0;this.Ft(t,15),t.Mt(_r(s)),this.Ot(n,t),this.Ct(a[n],t)}Qt(e,t){const r=e.values||[];this.Ft(t,50);for(const a of r)this.Ct(a,t)}Lt(e,t){this.Ft(t,37),oe.fromName(e).path.forEach(e=>{this.Ft(t,60),this.Ut(e,t)})}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}Ei.Kt=new Ei;const Ai=255;function Ci(e){if(0===e)return 8;let t=0;return e>>4||(t+=4,e<<=4),e>>6||(t+=2,e<<=2),e>>7||(t+=1),t}function Ii(e){const t=64-function(e){let t=0;for(let r=0;r<8;++r){const a=Ci(255&e[r]);if(t+=a,8!==a)break}return t}(e);return Math.ceil(t/8)}class Ti{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Gt(r.value),r=t.next();this.zt()}jt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Jt(r.value),r=t.next();this.Ht()}Yt(e){for(const t of e){const e=t.charCodeAt(0);if(e<128)this.Gt(e);else if(e<2048)this.Gt(960|e>>>6),this.Gt(128|63&e);else if(t<"\ud800"||"\udbff"<t)this.Gt(480|e>>>12),this.Gt(128|63&e>>>6),this.Gt(128|63&e);else{const e=t.codePointAt(0);this.Gt(240|e>>>18),this.Gt(128|63&e>>>12),this.Gt(128|63&e>>>6),this.Gt(128|63&e)}}this.zt()}Zt(e){for(const t of e){const e=t.charCodeAt(0);if(e<128)this.Jt(e);else if(e<2048)this.Jt(960|e>>>6),this.Jt(128|63&e);else if(t<"\ud800"||"\udbff"<t)this.Jt(480|e>>>12),this.Jt(128|63&e>>>6),this.Jt(128|63&e);else{const e=t.codePointAt(0);this.Jt(240|e>>>18),this.Jt(128|63&e>>>12),this.Jt(128|63&e>>>6),this.Jt(128|63&e)}}this.Ht()}Xt(e){const t=this.en(e),r=Ii(t);this.tn(1+r),this.buffer[this.position++]=255&r;for(let a=t.length-r;a<t.length;++a)this.buffer[this.position++]=255&t[a]}nn(e){const t=this.en(e),r=Ii(t);this.tn(1+r),this.buffer[this.position++]=~(255&r);for(let a=t.length-r;a<t.length;++a)this.buffer[this.position++]=~(255&t[a])}rn(){this.sn(Ai),this.sn(255)}_n(){this.an(Ai),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const t=function(e){const t=new DataView(new ArrayBuffer(8));return t.setFloat64(0,e,!1),new Uint8Array(t.buffer)}(e),r=!!(128&t[0]);t[0]^=r?255:128;for(let a=1;a<t.length;++a)t[a]^=r?255:0;return t}Gt(e){const t=255&e;0===t?(this.sn(0),this.sn(255)):t===Ai?(this.sn(Ai),this.sn(0)):this.sn(t)}Jt(e){const t=255&e;0===t?(this.an(0),this.an(255)):t===Ai?(this.an(Ai),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);const a=new Uint8Array(r);a.set(this.buffer),this.buffer=a}}class Di{constructor(e){this.cn=e}Bt(e){this.cn.Wt(e)}xt(e){this.cn.Yt(e)}Mt(e){this.cn.Xt(e)}vt(){this.cn.rn()}}class Pi{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class Fi{constructor(){this.cn=new Ti,this.ln=new Di(this.cn),this.hn=new Pi(this.cn)}seed(e){this.cn.seed(e)}Pn(e){return 0===e?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}}class Li{constructor(e,t,r,a){this.Tn=e,this.In=t,this.En=r,this.dn=a}An(){const e=this.dn.length,t=0===e||255===this.dn[e-1]?e+1:e,r=new Uint8Array(t);return r.set(this.dn,0),t!==e?r.set([0],this.dn.length):++r[r.length-1],new Li(this.Tn,this.In,this.En,r)}Rn(e,t,r){return{indexId:this.Tn,uid:e,arrayValue:Oi(this.En),directionalValue:Oi(this.dn),orderedDocumentKey:Oi(t),documentKey:r.path.toArray()}}Vn(e,t,r){const a=this.Rn(e,t,r);return[a.indexId,a.uid,a.arrayValue,a.directionalValue,a.orderedDocumentKey,a.documentKey]}}function Mi(e,t){let r=e.Tn-t.Tn;return 0!==r?r:(r=Ri(e.En,t.En),0!==r?r:(r=Ri(e.dn,t.dn),0!==r?r:oe.comparator(e.In,t.In)))}function Ri(e,t){for(let r=0;r<e.length&&r<t.length;++r){const a=e[r]-t[r];if(0!==a)return a}return e.length-t.length}function Oi(e){return(0,c.Ov)()?function(e){let t="";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t}(e):e}function Bi(e){return"string"!=typeof e?e:function(e){const t=new Uint8Array(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}(e)}class zi{constructor(e){this.mn=new yr((e,t)=>ie.comparator(e.field,t.field)),this.collectionId=null!=e.collectionGroup?e.collectionGroup:e.path.lastSegment(),this.fn=e.orderBy,this.gn=[];for(const t of e.filters){const e=t;e.isInequality()?this.mn=this.mn.add(e):this.gn.push(e)}}get pn(){return this.mn.size>1}yn(e){if(F(e.collectionGroup===this.collectionId,49279),this.pn)return!1;const t=Ne(e);if(void 0!==t&&!this.wn(t))return!1;const r=je(e);let a=new Set,n=0,s=0;for(;n<r.length&&this.wn(r[n]);++n)a=a.add(r[n].fieldPath.canonicalString());if(n===r.length)return!0;if(this.mn.size>0){const e=this.mn.getIterator().getNext();if(!a.has(e.field.canonicalString())){const t=r[n];if(!this.Sn(e,t)||!this.bn(this.fn[s++],t))return!1}++n}for(;n<r.length;++n){const e=r[n];if(s>=this.fn.length||!this.bn(this.fn[s++],e))return!1}return!0}Dn(){if(this.pn)return null;let e=new yr(ie.comparator);const t=[];for(const r of this.gn)if(!r.field.isKeyField())if("array-contains"===r.op||"array-contains-any"===r.op)t.push(new Se(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new Se(r.field,0))}for(const r of this.fn)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new Se(r.field,"asc"===r.dir?0:1)));return new ke(ke.UNKNOWN_ID,this.collectionId,t,_e.empty())}wn(e){for(const t of this.gn)if(this.Sn(t,e))return!0;return!1}Sn(e,t){if(void 0===e||!e.field.isEqual(t.fieldPath))return!1;const r="array-contains"===e.op||"array-contains-any"===e.op;return 2===t.kind===r}bn(e,t){return!!e.field.isEqual(t.fieldPath)&&(0===t.kind&&"asc"===e.dir||1===t.kind&&"desc"===e.dir)}}function Ui(e){if(F(e instanceof ka||e instanceof Na,20012),e instanceof ka){if(e instanceof Ra){var t;const r=(null===(t=e.value.arrayValue)||void 0===t||null===(t=t.values)||void 0===t?void 0:t.map(t=>ka.create(e.field,"==",t)))||[];return Na.create(r,"or")}return e}const r=e.filters.map(e=>Ui(e));return Na.create(r,e.op)}function Vi(e){if(0===e.getFilters().length)return[];const t=Wi(Ui(e));return F(Gi(t),7391),qi(t)||Hi(t)?[t]:t.getFilters()}function qi(e){return e instanceof ka}function Hi(e){return e instanceof Na&&_a(e)}function Gi(e){return qi(e)||Hi(e)||function(e){if(e instanceof Na&&Sa(e)){for(const t of e.getFilters())if(!qi(t)&&!Hi(t))return!1;return!0}return!1}(e)}function Wi(e){if(F(e instanceof ka||e instanceof Na,34018),e instanceof ka)return e;if(1===e.filters.length)return Wi(e.filters[0]);const t=e.filters.map(e=>Wi(e));let r=Na.create(t,e.op);return r=Yi(r),Gi(r)?r:(F(r instanceof Na,64498),F(ja(r),40251),F(r.filters.length>1,57927),r.filters.reduce((e,t)=>Ki(e,t)))}function Ki(e,t){let r;return F(e instanceof ka||e instanceof Na,38388),F(t instanceof ka||t instanceof Na,25473),r=e instanceof ka?t instanceof ka?function(e,t){return Na.create([e,t],"and")}(e,t):Qi(e,t):t instanceof ka?Qi(t,e):function(e,t){if(F(e.filters.length>0&&t.filters.length>0,48005),ja(e)&&ja(t))return Ia(e,t.getFilters());const r=Sa(e)?e:t,a=Sa(e)?t:e,n=r.filters.map(e=>Ki(e,a));return Na.create(n,"or")}(e,t),Yi(r)}function Qi(e,t){if(ja(t))return Ia(t,e.getFilters());{const r=t.filters.map(t=>Ki(e,t));return Na.create(r,"or")}}function Yi(e){if(F(e instanceof ka||e instanceof Na,11850),e instanceof ka)return e;const t=e.getFilters();if(1===t.length)return Yi(t[0]);if(Ea(e))return e;const r=t.map(e=>Yi(e)),a=[];return r.forEach(t=>{t instanceof ka?a.push(t):t instanceof Na&&(t.op===e.op?a.push(...t.filters):a.push(t))}),1===a.length?a[0]:Na.create(a,e.op)}class Xi{constructor(){this.Cn=new Ji}addToCollectionParentIndex(e,t){return this.Cn.add(t),Fe.resolve()}getCollectionParents(e,t){return Fe.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return Fe.resolve()}deleteFieldIndex(e,t){return Fe.resolve()}deleteAllFieldIndexes(e){return Fe.resolve()}createTargetIndexes(e,t){return Fe.resolve()}getDocumentsMatchingTarget(e,t){return Fe.resolve(null)}getIndexType(e,t){return Fe.resolve(0)}getFieldIndexes(e,t){return Fe.resolve([])}getNextCollectionGroupToUpdate(e){return Fe.resolve(null)}getMinOffset(e,t){return Fe.resolve(Ce.min())}getMinOffsetFromCollectionGroup(e,t){return Fe.resolve(Ce.min())}updateCollectionGroup(e,t,r){return Fe.resolve()}updateIndexEntries(e,t){return Fe.resolve()}}class Ji{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),a=this.index[t]||new yr(ne.comparator),n=!a.has(r);return this.index[t]=a.add(r),n}has(e){const t=e.lastSegment(),r=e.popLast(),a=this.index[t];return a&&a.has(r)}getEntries(e){return(this.index[e]||new yr(ne.comparator)).toArray()}}const Zi="IndexedDbIndexManager",$i=new Uint8Array(0);class eo{constructor(e,t){this.databaseId=t,this.vn=new Ji,this.Fn=new hn(e=>Va(e),(e,t)=>qa(e,t)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.vn.has(t)){const r=t.lastSegment(),a=t.popLast();e.addOnCommittedListener(()=>{this.vn.add(t)});const n={collectionId:r,parent:tt(a)};return to(e).put(n)}return Fe.resolve()}getCollectionParents(e,t){const r=[],a=IDBKeyRange.bound([t,""],[te(t),""],!1,!0);return to(e).J(a).next(e=>{for(const a of e){if(a.collectionId!==t)break;r.push(nt(a.parent))}return r})}addFieldIndex(e,t){const r=ao(e),a=function(e){return{indexId:e.indexId,collectionGroup:e.collectionGroup,fields:e.fields.map(e=>[e.fieldPath.canonicalString(),e.kind])}}(t);delete a.indexId;const n=r.add(a);if(t.indexState){const r=no(e);return n.next(e=>{r.put(bi(e,this.uid,t.indexState.sequenceNumber,t.indexState.offset))})}return n.next()}deleteFieldIndex(e,t){const r=ao(e),a=no(e),n=ro(e);return r.delete(t.indexId).next(()=>a.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>n.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const t=ao(e),r=ro(e),a=no(e);return t.Z().next(()=>r.Z()).next(()=>a.Z())}createTargetIndexes(e,t){return Fe.forEach(this.Mn(t),t=>this.getIndexType(e,t).next(r=>{if(0===r||1===r){const r=new zi(t).Dn();if(null!=r)return this.addFieldIndex(e,r)}}))}getDocumentsMatchingTarget(e,t){const r=ro(e);let a=!0;const n=new Map;return Fe.forEach(this.Mn(t),t=>this.xn(e,t).next(e=>{a&&(a=!!e),n.set(t,e)})).next(()=>{if(a){let e=Nn();const a=[];return Fe.forEach(n,(n,s)=>{A(Zi,"Using index ".concat(function(e){return"id=".concat(e.indexId,"|cg=").concat(e.collectionGroup,"|f=").concat(e.fields.map(e=>"".concat(e.fieldPath,":").concat(e.kind)).join(","))}(n)," to execute ").concat(Va(t)));const i=function(e,t){const r=Ne(t);if(void 0===r)return null;for(const a of Ga(e,r.fieldPath))switch(a.op){case"array-contains-any":return a.value.arrayValue.values||[];case"array-contains":return[a.value]}return null}(s,n),o=function(e,t){const r=new Map;for(const a of je(t))for(const t of Ga(e,a.fieldPath))switch(t.op){case"==":case"in":r.set(a.fieldPath.canonicalString(),t.value);break;case"not-in":case"!=":return r.set(a.fieldPath.canonicalString(),t.value),Array.from(r.values())}return null}(s,n),l=function(e,t){const r=[];let a=!0;for(const n of je(t)){const t=0===n.kind?Wa(e,n.fieldPath,e.startAt):Ka(e,n.fieldPath,e.startAt);r.push(t.value),a&&(a=t.inclusive)}return new pa(r,a)}(s,n),c=function(e,t){const r=[];let a=!0;for(const n of je(t)){const t=0===n.kind?Ka(e,n.fieldPath,e.endAt):Wa(e,n.fieldPath,e.endAt);r.push(t.value),a&&(a=t.inclusive)}return new pa(r,a)}(s,n),d=this.On(n,s,l),u=this.On(n,s,c),h=this.Nn(n,s,o),m=this.Bn(n.indexId,i,d,l.inclusive,u,c.inclusive,h);return Fe.forEach(m,n=>r.Y(n,t.limit).next(t=>{t.forEach(t=>{const r=oe.fromSegments(t.documentKey);e.has(r)||(e=e.add(r),a.push(r))})}))}).next(()=>a)}return Fe.resolve(null)})}Mn(e){let t=this.Fn.get(e);return t||(t=0===e.filters.length?[e]:Vi(Na.create(e.filters,"and")).map(t=>Ua(e.path,e.collectionGroup,e.orderBy,t.getFilters(),e.limit,e.startAt,e.endAt)),this.Fn.set(e,t),t)}Bn(e,t,r,a,n,s,i){const o=(null!=t?t.length:1)*Math.max(r.length,n.length),l=o/(null!=t?t.length:1),c=[];for(let d=0;d<o;++d){const o=t?this.Ln(t[d/l]):$i,u=this.kn(e,o,r[d%l],a),h=this.qn(e,o,n[d%l],s),m=i.map(t=>this.kn(e,o,t,!0));c.push(...this.createRange(u,h,m))}return c}kn(e,t,r,a){const n=new Li(e,oe.empty(),t,r);return a?n:n.An()}qn(e,t,r,a){const n=new Li(e,oe.empty(),t,r);return a?n.An():n}xn(e,t){const r=new zi(t),a=null!=t.collectionGroup?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,a).next(e=>{let t=null;for(const a of e)r.yn(a)&&(!t||a.fields.length>t.fields.length)&&(t=a);return t})}getIndexType(e,t){let r=2;const a=this.Mn(t);return Fe.forEach(a,t=>this.xn(e,t).next(e=>{e?0!==r&&e.fields.length<function(e){let t=new yr(ie.comparator),r=!1;for(const a of e.filters)for(const e of a.getFlattenedFilters())e.field.isKeyField()||("array-contains"===e.op||"array-contains-any"===e.op?r=!0:t=t.add(e.field));for(const a of e.orderBy)a.field.isKeyField()||(t=t.add(a.field));return t.size+(r?1:0)}(t)&&(r=1):r=0})).next(()=>function(e){return null!==e.limit}(t)&&a.length>1&&2===r?1:r)}Qn(e,t){const r=new Fi;for(const a of je(e)){const e=t.data.field(a.fieldPath);if(null==e)return null;const n=r.Pn(a.kind);Ei.Kt.Dt(e,n)}return r.un()}Ln(e){const t=new Fi;return Ei.Kt.Dt(e,t.Pn(0)),t.un()}$n(e,t){const r=new Fi;return Ei.Kt.Dt($r(this.databaseId,t),r.Pn(function(e){const t=je(e);return 0===t.length?0:t[t.length-1].kind}(e))),r.un()}Nn(e,t,r){if(null===r)return[];let a=[];a.push(new Fi);let n=0;for(const s of je(e)){const e=r[n++];for(const r of a)if(this.Un(t,s.fieldPath)&&ta(e))a=this.Kn(a,s,e);else{const t=r.Pn(s.kind);Ei.Kt.Dt(e,t)}}return this.Wn(a)}On(e,t,r){return this.Nn(e,t,r.position)}Wn(e){const t=[];for(let r=0;r<e.length;++r)t[r]=e[r].un();return t}Kn(e,t,r){const a=[...e],n=[];for(const s of r.arrayValue.values||[])for(const e of a){const r=new Fi;r.seed(e.un()),Ei.Kt.Dt(s,r.Pn(t.kind)),n.push(r)}return n}Un(e,t){return!!e.filters.find(e=>e instanceof ka&&e.field.isEqual(t)&&("in"===e.op||"not-in"===e.op))}getFieldIndexes(e,t){const r=ao(e),a=no(e);return(t?r.J(zt,IDBKeyRange.bound(t,t)):r.J()).next(e=>{const t=[];return Fe.forEach(e,e=>a.get([e.indexId,this.uid]).next(r=>{t.push(function(e,t){const r=t?new _e(t.sequenceNumber,new Ce(mi(t.readTime),new oe(nt(t.documentKey)),t.largestBatchId)):_e.empty(),a=e.fields.map(e=>{let[t,r]=e;return new Se(ie.fromServerFormat(t),r)});return new ke(e.indexId,e.collectionGroup,a,r)}(e,r))})).next(()=>t)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(e=>0===e.length?null:(e.sort((e,t)=>{const r=e.indexState.sequenceNumber-t.indexState.sequenceNumber;return 0!==r?r:Y(e.collectionGroup,t.collectionGroup)}),e[0].collectionGroup))}updateCollectionGroup(e,t,r){const a=ao(e),n=no(e);return this.Gn(e).next(e=>a.J(zt,IDBKeyRange.bound(t,t)).next(t=>Fe.forEach(t,t=>n.put(bi(t.indexId,this.uid,e,r)))))}updateIndexEntries(e,t){const r=new Map;return Fe.forEach(t,(t,a)=>{const n=r.get(t.collectionGroup);return(n?Fe.resolve(n):this.getFieldIndexes(e,t.collectionGroup)).next(n=>(r.set(t.collectionGroup,n),Fe.forEach(n,r=>this.zn(e,t,r).next(t=>{const n=this.jn(a,r);return t.isEqual(n)?Fe.resolve():this.Jn(e,a,r,t,n)}))))})}Hn(e,t,r,a){return ro(e).put(a.Rn(this.uid,this.$n(r,t.key),t.key))}Yn(e,t,r,a){return ro(e).delete(a.Vn(this.uid,this.$n(r,t.key),t.key))}zn(e,t,r){const a=ro(e);let n=new yr(Mi);return a.ee({index:Kt,range:IDBKeyRange.only([r.indexId,this.uid,Oi(this.$n(r,t))])},(e,a)=>{n=n.add(new Li(r.indexId,t,Bi(a.arrayValue),Bi(a.directionalValue)))}).next(()=>n)}jn(e,t){let r=new yr(Mi);const a=this.Qn(t,e);if(null==a)return r;const n=Ne(t);if(null!=n){const s=e.data.field(n.fieldPath);if(ta(s))for(const n of s.arrayValue.values||[])r=r.add(new Li(t.indexId,e.key,this.Ln(n),a))}else r=r.add(new Li(t.indexId,e.key,$i,a));return r}Jn(e,t,r,a,n){A(Zi,"Updating index entries for document '%s'",t.key);const s=[];return function(e,t,r,a,n){const s=e.getIterator(),i=t.getIterator();let o=br(s),l=br(i);for(;o||l;){let e=!1,t=!1;if(o&&l){const a=r(o,l);a<0?t=!0:a>0&&(e=!0)}else null!=o?t=!0:e=!0;e?(a(l),l=br(i)):t?(n(o),o=br(s)):(o=br(s),l=br(i))}}(a,n,Mi,a=>{s.push(this.Hn(e,t,r,a))},a=>{s.push(this.Yn(e,t,r,a))}),Fe.waitFor(s)}Gn(e){let t=1;return no(e).ee({index:qt,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(e,r,a)=>{a.done(),t=r.sequenceNumber+1}).next(()=>t)}createRange(e,t,r){r=r.sort((e,t)=>Mi(e,t)).filter((e,t,r)=>!t||0!==Mi(e,r[t-1]));const a=[];a.push(e);for(const s of r){const r=Mi(s,e),n=Mi(s,t);if(0===r)a[0]=e.An();else if(r>0&&n<0)a.push(s),a.push(s.An());else if(n>0)break}a.push(t);const n=[];for(let s=0;s<a.length;s+=2){if(this.Zn(a[s],a[s+1]))return[];const e=a[s].Vn(this.uid,$i,oe.empty()),t=a[s+1].Vn(this.uid,$i,oe.empty());n.push(IDBKeyRange.bound(e,t))}return n}Zn(e,t){return Mi(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(so)}getMinOffset(e,t){return Fe.mapArray(this.Mn(t),t=>this.xn(e,t).next(e=>e||D(44426))).next(so)}}function to(e){return ur(e,Ft)}function ro(e){return ur(e,Gt)}function ao(e){return ur(e,Bt)}function no(e){return ur(e,Ut)}function so(e){F(0!==e.length,28825);let t=e[0].indexState.offset,r=t.largestBatchId;for(let a=1;a<e.length;a++){const n=e[a].indexState.offset;Ie(n,t)<0&&(t=n),r<n.largestBatchId&&(r=n.largestBatchId)}return new Ce(t.readTime,t.documentKey,r)}const io={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},oo=41943040;class lo{static withCacheSize(e){return new lo(e,lo.DEFAULT_COLLECTION_PERCENTILE,lo.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}}function co(e,t,r){const a=e.store(ct),n=e.store(pt),s=[],i=IDBKeyRange.only(r.batchId);let o=0;const l=a.ee({range:i},(e,t,r)=>(o++,r.delete()));s.push(l.next(()=>{F(1===o,47070,{batchId:r.batchId})}));const c=[];for(const d of r.mutations){const e=ft(t,d.key.path,r.batchId);s.push(n.delete(e)),c.push(d.key)}return Fe.waitFor(s).next(()=>c)}function uo(e){if(!e)return 0;let t;if(e.document)t=e.document;else if(e.unknownDocument)t=e.unknownDocument;else{if(!e.noDocument)throw D(14731);t=e.noDocument}return JSON.stringify(t).length}lo.DEFAULT_COLLECTION_PERCENTILE=10,lo.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,lo.DEFAULT=new lo(oo,lo.DEFAULT_COLLECTION_PERCENTILE,lo.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),lo.DISABLED=new lo(-1,0,0);class ho{constructor(e,t,r,a){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=a,this.Xn={}}static wt(e,t,r,a){F(""!==e.uid,64387);const n=e.isAuthenticated()?e.uid:"";return new ho(n,t,r,a)}checkEmpty(e){let t=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return fo(e).ee({index:ut,range:r},(e,r,a)=>{t=!1,a.done()}).next(()=>t)}addMutationBatch(e,t,r,a){const n=go(e),s=fo(e);return s.add({}).next(i=>{F("number"==typeof i,49019);const o=new ns(i,t,r,a),l=function(e,t,r){const a=r.baseMutations.map(t=>Qs(e.yt,t)),n=r.mutations.map(t=>Qs(e.yt,t));return{userId:t,batchId:r.batchId,localWriteTimeMs:r.localWriteTime.toMillis(),baseMutations:a,mutations:n}}(this.serializer,this.userId,o),c=[];let d=new yr((e,t)=>Y(e.canonicalString(),t.canonicalString()));for(const e of a){const t=ft(this.userId,e.key.path,i);d=d.add(e.key.path.popLast()),c.push(s.put(l)),c.push(n.put(t,gt))}return d.forEach(t=>{c.push(this.indexManager.addToCollectionParentIndex(e,t))}),e.addOnCommittedListener(()=>{this.Xn[i]=o.keys()}),Fe.waitFor(c).next(()=>o)})}lookupMutationBatch(e,t){return fo(e).get(t).next(e=>e?(F(e.userId===this.userId,48,"Unexpected user for mutation batch",{userId:e.userId,batchId:t}),fi(this.serializer,e)):null)}er(e,t){return this.Xn[t]?Fe.resolve(this.Xn[t]):this.lookupMutationBatch(e,t).next(e=>{if(e){const r=e.keys();return this.Xn[t]=r,r}return null})}getNextMutationBatchAfterBatchId(e,t){const r=t+1,a=IDBKeyRange.lowerBound([this.userId,r]);let n=null;return fo(e).ee({index:ut,range:a},(e,t,a)=>{t.userId===this.userId&&(F(t.batchId>=r,47524,{tr:r}),n=fi(this.serializer,t)),a.done()}).next(()=>n)}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=Xe;return fo(e).ee({index:ut,range:t,reverse:!0},(e,t,a)=>{r=t.batchId,a.done()}).next(()=>r)}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,Xe],[this.userId,Number.POSITIVE_INFINITY]);return fo(e).J(ut,t).next(e=>e.map(e=>fi(this.serializer,e)))}getAllMutationBatchesAffectingDocumentKey(e,t){const r=mt(this.userId,t.path),a=IDBKeyRange.lowerBound(r),n=[];return go(e).ee({range:a},(r,a,s)=>{const[i,o,l]=r,c=nt(o);if(i===this.userId&&t.path.isEqual(c))return fo(e).get(l).next(e=>{if(!e)throw D(61480,{nr:r,batchId:l});F(e.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:e.userId,batchId:l}),n.push(fi(this.serializer,e))});s.done()}).next(()=>n)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new yr(Y);const a=[];return t.forEach(t=>{const n=mt(this.userId,t.path),s=IDBKeyRange.lowerBound(n),i=go(e).ee({range:s},(e,a,n)=>{const[s,i,o]=e,l=nt(i);s===this.userId&&t.path.isEqual(l)?r=r.add(o):n.done()});a.push(i)}),Fe.waitFor(a).next(()=>this.rr(e,r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,a=r.length+1,n=mt(this.userId,r),s=IDBKeyRange.lowerBound(n);let i=new yr(Y);return go(e).ee({range:s},(e,t,n)=>{const[s,o,l]=e,c=nt(o);s===this.userId&&r.isPrefixOf(c)?c.length===a&&(i=i.add(l)):n.done()}).next(()=>this.rr(e,i))}rr(e,t){const r=[],a=[];return t.forEach(t=>{a.push(fo(e).get(t).next(e=>{if(null===e)throw D(35274,{batchId:t});F(e.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:e.userId,batchId:t}),r.push(fi(this.serializer,e))}))}),Fe.waitFor(a).next(()=>r)}removeMutationBatch(e,t){return co(e.le,this.userId,t).next(r=>(e.addOnCommittedListener(()=>{this.ir(t.batchId)}),Fe.forEach(r,t=>this.referenceDelegate.markPotentiallyOrphaned(e,t))))}ir(e){delete this.Xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return Fe.resolve();const r=IDBKeyRange.lowerBound(function(e){return[e]}(this.userId)),a=[];return go(e).ee({range:r},(e,t,r)=>{if(e[0]===this.userId){const t=nt(e[1]);a.push(t)}else r.done()}).next(()=>{F(0===a.length,56720,{sr:a.map(e=>e.canonicalString())})})})}containsKey(e,t){return mo(e,this.userId,t)}_r(e){return po(e).get(this.userId).next(e=>e||{userId:this.userId,lastAcknowledgedBatchId:Xe,lastStreamToken:""})}}function mo(e,t,r){const a=mt(t,r.path),n=a[1],s=IDBKeyRange.lowerBound(a);let i=!1;return go(e).ee({range:s,X:!0},(e,r,a)=>{const[s,o,l]=e;s===t&&o===n&&(i=!0),a.done()}).next(()=>i)}function fo(e){return ur(e,ct)}function go(e){return ur(e,pt)}function po(e){return ur(e,lt)}class xo{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new xo(0)}static cr(){return new xo(-1)}}class yo{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.lr(e).next(t=>{const r=new xo(t.highestTargetId);return t.highestTargetId=r.next(),this.hr(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.lr(e).next(e=>be.fromTimestamp(new ve(e.lastRemoteSnapshotVersion.seconds,e.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.lr(e).next(e=>e.highestListenSequenceNumber)}setTargetsMetadata(e,t,r){return this.lr(e).next(a=>(a.highestListenSequenceNumber=t,r&&(a.lastRemoteSnapshotVersion=r.toTimestamp()),t>a.highestListenSequenceNumber&&(a.highestListenSequenceNumber=t),this.hr(e,a)))}addTargetData(e,t){return this.Pr(e,t).next(()=>this.lr(e).next(r=>(r.targetCount+=1,this.Tr(t,r),this.hr(e,r))))}updateTargetData(e,t){return this.Pr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>vo(e).delete(t.targetId)).next(()=>this.lr(e)).next(t=>(F(t.targetCount>0,8065),t.targetCount-=1,this.hr(e,t)))}removeTargets(e,t,r){let a=0;const n=[];return vo(e).ee((s,i)=>{const o=gi(i);o.sequenceNumber<=t&&null===r.get(o.targetId)&&(a++,n.push(this.removeTargetData(e,o)))}).next(()=>Fe.waitFor(n)).next(()=>a)}forEachTarget(e,t){return vo(e).ee((e,r)=>{const a=gi(r);t(a)})}lr(e){return bo(e).get(Dt).next(e=>(F(null!==e,2888),e))}hr(e,t){return bo(e).put(Dt,t)}Pr(e,t){return vo(e).put(pi(this.serializer,t))}Tr(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.lr(e).next(e=>e.targetCount)}getTargetData(e,t){const r=Va(t),a=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let n=null;return vo(e).ee({range:a,index:_t},(e,r,a)=>{const s=gi(r);qa(t,s.target)&&(n=s,a.done())}).next(()=>n)}addMatchingKeys(e,t,r){const a=[],n=wo(e);return t.forEach(t=>{const s=tt(t.path);a.push(n.put({targetId:r,path:s})),a.push(this.referenceDelegate.addReference(e,r,t))}),Fe.waitFor(a)}removeMatchingKeys(e,t,r){const a=wo(e);return Fe.forEach(t,t=>{const n=tt(t.path);return Fe.waitFor([a.delete([r,n]),this.referenceDelegate.removeReference(e,r,t)])})}removeMatchingKeysForTargetId(e,t){const r=wo(e),a=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(a)}getMatchingKeysForTargetId(e,t){const r=IDBKeyRange.bound([t],[t+1],!1,!0),a=wo(e);let n=Nn();return a.ee({range:r,X:!0},(e,t,r)=>{const a=nt(e[1]),s=new oe(a);n=n.add(s)}).next(()=>n)}containsKey(e,t){const r=tt(t.path),a=IDBKeyRange.bound([r],[te(r)],!1,!0);let n=0;return wo(e).ee({index:It,X:!0,range:a},(e,t,r)=>{let[a,s]=e;0!==a&&(n++,r.done())}).next(()=>n>0)}At(e,t){return vo(e).get(t).next(e=>e?gi(e):null)}}function vo(e){return ur(e,St)}function bo(e){return ur(e,Pt)}function wo(e){return ur(e,At)}const ko="LruGarbageCollector",No=1048576;function jo(e,t){let[r,a]=e,[n,s]=t;const i=Y(r,n);return 0===i?Y(a,s):i}class So{constructor(e){this.Ir=e,this.buffer=new yr(jo),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const e=this.buffer.last();jo(t,e)<0&&(this.buffer=this.buffer.delete(e).add(t))}}get maxValue(){return this.buffer.last()[0]}}class _o{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Rr=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return null!==this.Rr}Vr(e){A(ko,"Garbage collection scheduled in ".concat(e,"ms")),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(e){Ue(e)?A(ko,"Ignoring IndexedDB error during garbage collection: ",e):await Pe(e)}await this.Vr(3e5)})}}class Eo{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next(e=>Math.floor(t/100*e))}nthSequenceNumber(e,t){if(0===t)return Fe.resolve(Ye.ce);const r=new So(t);return this.mr.forEachTarget(e,e=>r.Ar(e.sequenceNumber)).next(()=>this.mr.pr(e,e=>r.Ar(e))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.mr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return-1===this.params.cacheSizeCollectionThreshold?(A("LruGarbageCollector","Garbage collection skipped; disabled"),Fe.resolve(io)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(A("LruGarbageCollector","Garbage collection skipped; Cache size ".concat(r," is lower than threshold ").concat(this.params.cacheSizeCollectionThreshold)),io):this.yr(e,t))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let r,a,n,s,i,o,c;const d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(t=>(t>this.params.maximumSequenceNumbersToCollect?(A("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of ".concat(this.params.maximumSequenceNumbersToCollect," from ").concat(t)),a=this.params.maximumSequenceNumbersToCollect):a=t,s=Date.now(),this.nthSequenceNumber(e,a))).next(a=>(r=a,i=Date.now(),this.removeTargets(e,r,t))).next(t=>(n=t,o=Date.now(),this.removeOrphanedDocuments(e,r))).next(e=>(c=Date.now(),E()<=l.$b.DEBUG&&A("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in ".concat(s-d,"ms\n\tDetermined least recently used ").concat(a," in ")+(i-s)+"ms\n"+"\tRemoved ".concat(n," targets in ")+(o-i)+"ms\n"+"\tRemoved ".concat(e," documents in ")+(c-o)+"ms\n"+"Total Duration: ".concat(c-d,"ms")),Fe.resolve({didRun:!0,sequenceNumbersCollected:a,targetsRemoved:n,documentsRemoved:e})))}}function Ao(e,t){return new Eo(e,t)}class Co{constructor(e,t){this.db=e,this.garbageCollector=Ao(this,t)}gr(e){const t=this.wr(e);return this.db.getTargetCache().getTargetCount(e).next(e=>t.next(t=>e+t))}wr(e){let t=0;return this.pr(e,e=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}pr(e,t){return this.Sr(e,(e,r)=>t(r))}addReference(e,t,r){return Io(e,r)}removeReference(e,t,r){return Io(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return Io(e,t)}br(e,t){return function(e,t){let r=!1;return po(e).te(a=>mo(e,a,t).next(e=>(e&&(r=!0),Fe.resolve(!e)))).next(()=>r)}(e,t)}removeOrphanedDocuments(e,t){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),a=[];let n=0;return this.Sr(e,(s,i)=>{if(i<=t){const t=this.br(e,s).next(t=>{if(!t)return n++,r.getEntry(e,s).next(()=>(r.removeEntry(s,be.min()),wo(e).delete(function(e){return[0,tt(e.path)]}(s))))});a.push(t)}}).next(()=>Fe.waitFor(a)).next(()=>r.apply(e)).next(()=>n)}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return Io(e,t)}Sr(e,t){const r=wo(e);let a,n=Ye.ce;return r.ee({index:It},(e,r)=>{let[s,i]=e,{path:o,sequenceNumber:l}=r;0===s?(n!==Ye.ce&&t(new oe(nt(a)),n),n=l,a=o):n=Ye.ce}).next(()=>{n!==Ye.ce&&t(new oe(nt(a)),n)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Io(e,t){return wo(e).put(function(e,t){return{targetId:0,path:tt(e.path),sequenceNumber:t}}(t,e.currentSequenceNumber))}class To{constructor(){this.changes=new hn(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,ga.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return void 0!==r?Fe.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class Do{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return Mo(e).put(r)}removeEntry(e,t,r){return Mo(e).delete(function(e,t){const r=e.path.toArray();return[r.slice(0,r.length-2),r[r.length-2],ui(t),r[r.length-1]]}(t,r))}updateMetadata(e,t){return this.getMetadata(e).next(r=>(r.byteSize+=t,this.Dr(e,r)))}getEntry(e,t){let r=ga.newInvalidDocument(t);return Mo(e).ee({index:vt,range:IDBKeyRange.only(Ro(t))},(e,a)=>{r=this.Cr(t,a)}).next(()=>r)}vr(e,t){let r={size:0,document:ga.newInvalidDocument(t)};return Mo(e).ee({index:vt,range:IDBKeyRange.only(Ro(t))},(e,a)=>{r={document:this.Cr(t,a),size:uo(a)}}).next(()=>r)}getEntries(e,t){let r=fn();return this.Fr(e,t,(e,t)=>{const a=this.Cr(e,t);r=r.insert(e,a)}).next(()=>r)}Mr(e,t){let r=fn(),a=new gr(oe.comparator);return this.Fr(e,t,(e,t)=>{const n=this.Cr(e,t);r=r.insert(e,n),a=a.insert(e,uo(t))}).next(()=>({documents:r,Or:a}))}Fr(e,t,r){if(t.isEmpty())return Fe.resolve();let a=new yr(Bo);t.forEach(e=>a=a.add(e));const n=IDBKeyRange.bound(Ro(a.first()),Ro(a.last())),s=a.getIterator();let i=s.getNext();return Mo(e).ee({index:vt,range:n},(e,t,a)=>{const n=oe.fromSegments([...t.prefixPath,t.collectionGroup,t.documentId]);for(;i&&Bo(i,n)<0;)r(i,null),i=s.getNext();i&&i.isEqual(n)&&(r(i,t),i=s.hasNext()?s.getNext():null),i?a.j(Ro(i)):a.done()}).next(()=>{for(;i;)r(i,null),i=s.hasNext()?s.getNext():null})}getDocumentsMatchingQuery(e,t,r,a,n){const s=t.path,i=[s.popLast().toArray(),s.lastSegment(),ui(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],o=[s.popLast().toArray(),s.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Mo(e).J(IDBKeyRange.bound(i,o,!0)).next(e=>{null===n||void 0===n||n.incrementDocumentReadCount(e.length);let r=fn();for(const n of e){const e=this.Cr(oe.fromSegments(n.prefixPath.concat(n.collectionGroup,n.documentId)),n);e.isFoundDocument()&&(ln(t,e)||a.has(e.key))&&(r=r.insert(e.key,e))}return r})}getAllFromCollectionGroup(e,t,r,a){let n=fn();const s=Oo(t,r),i=Oo(t,Ce.max());return Mo(e).ee({index:wt,range:IDBKeyRange.bound(s,i,!0)},(e,t,r)=>{const s=this.Cr(oe.fromSegments(t.prefixPath.concat(t.collectionGroup,t.documentId)),t);n=n.insert(s.key,s),n.size===a&&r.done()}).next(()=>n)}newChangeBuffer(e){return new Fo(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(e=>e.byteSize)}getMetadata(e){return Lo(e).get(jt).next(e=>(F(!!e,20021),e))}Dr(e,t){return Lo(e).put(jt,t)}Cr(e,t){if(t){const e=function(e,t){let r;if(t.document)r=Ks(e.yt,t.document,!!t.hasCommittedMutations);else if(t.noDocument){const e=oe.fromSegments(t.noDocument.path),a=mi(t.noDocument.readTime);r=ga.newNoDocument(e,a),t.hasCommittedMutations&&r.setHasCommittedMutations()}else{if(!t.unknownDocument)return D(56709);{const e=oe.fromSegments(t.unknownDocument.path),a=mi(t.unknownDocument.version);r=ga.newUnknownDocument(e,a)}}return t.readTime&&r.setReadTime(function(e){const t=new ve(e[0],e[1]);return be.fromTimestamp(t)}(t.readTime)),r}(this.serializer,t);if(!e.isNoDocument()||!e.version.isEqual(be.min()))return e}return ga.newInvalidDocument(e)}}function Po(e){return new Do(e)}class Fo extends To{constructor(e,t){super(),this.Nr=e,this.trackRemovals=t,this.Br=new hn(e=>e.toString(),(e,t)=>e.isEqual(t))}applyChanges(e){const t=[];let r=0,a=new yr((e,t)=>Y(e.canonicalString(),t.canonicalString()));return this.changes.forEach((n,s)=>{const i=this.Br.get(n);if(t.push(this.Nr.removeEntry(e,n,i.readTime)),s.isValidDocument()){const o=di(this.Nr.serializer,s);a=a.add(n.path.popLast());const l=uo(o);r+=l-i.size,t.push(this.Nr.addEntry(e,n,o))}else if(r-=i.size,this.trackRemovals){const r=di(this.Nr.serializer,s.convertToNoDocument(be.min()));t.push(this.Nr.addEntry(e,n,r))}}),a.forEach(r=>{t.push(this.Nr.indexManager.addToCollectionParentIndex(e,r))}),t.push(this.Nr.updateMetadata(e,r)),Fe.waitFor(t)}getFromCache(e,t){return this.Nr.vr(e,t).next(e=>(this.Br.set(t,{size:e.size,readTime:e.document.readTime}),e.document))}getAllFromCache(e,t){return this.Nr.Mr(e,t).next(e=>{let{documents:t,Or:r}=e;return r.forEach((e,r)=>{this.Br.set(e,{size:r,readTime:t.get(e).readTime})}),t})}}function Lo(e){return ur(e,Nt)}function Mo(e){return ur(e,xt)}function Ro(e){const t=e.path.toArray();return[t.slice(0,t.length-2),t[t.length-2],t[t.length-1]]}function Oo(e,t){const r=t.documentKey.path.toArray();return[e,ui(t.readTime),r.slice(0,r.length-2),r.length>0?r[r.length-1]:""]}function Bo(e,t){const r=e.path.toArray(),a=t.path.toArray();let n=0;for(let s=0;s<r.length-2&&s<a.length-2;++s)if(n=Y(r[s],a[s]),n)return n;return n=Y(r.length,a.length),n||(n=Y(r[r.length-2],a[a.length-2]),n||Y(r[r.length-1],a[a.length-1]))}class zo{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class Uo{constructor(e,t,r,a){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=a}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(a=>(r=a,this.remoteDocumentCache.getEntry(e,t))).next(e=>(null!==r&&Qn(r.mutation,e,wr.empty(),ve.now()),e))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.getLocalViewOfDocuments(e,t,Nn()).next(()=>t))}getLocalViewOfDocuments(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Nn();const a=yn();return this.populateOverlays(e,a,t).next(()=>this.computeViews(e,t,a,r).next(e=>{let t=pn();return e.forEach((e,r)=>{t=t.insert(e,r.overlayedDocument)}),t}))}getOverlayedDocuments(e,t){const r=yn();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,Nn()))}populateOverlays(e,t,r){const a=[];return r.forEach(e=>{t.has(e)||a.push(e)}),this.documentOverlayCache.getOverlays(e,a).next(e=>{e.forEach((e,r)=>{t.set(e,r)})})}computeViews(e,t,r,a){let n=fn();const s=bn(),i=bn();return t.forEach((e,t)=>{const i=r.get(t.key);a.has(t.key)&&(void 0===i||i.mutation instanceof Zn)?n=n.insert(t.key,t):void 0!==i?(s.set(t.key,i.mutation.getFieldMask()),Qn(i.mutation,t,i.mutation.getFieldMask(),ve.now())):s.set(t.key,wr.empty())}),this.recalculateAndSaveOverlays(e,n).next(e=>(e.forEach((e,t)=>s.set(e,t)),t.forEach((e,t)=>{var r;return i.set(e,new zo(t,null!==(r=s.get(e))&&void 0!==r?r:null))}),i))}recalculateAndSaveOverlays(e,t){const r=bn();let a=new gr((e,t)=>e-t),n=Nn();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(e=>{for(const n of e)n.keys().forEach(e=>{const s=t.get(e);if(null===s)return;let i=r.get(e)||wr.empty();i=n.applyToLocalView(s,i),r.set(e,i);const o=(a.get(n.batchId)||Nn()).add(e);a=a.insert(n.batchId,o)})}).next(()=>{const s=[],i=a.getReverseIterator();for(;i.hasNext();){const a=i.getNext(),o=a.key,l=a.value,c=vn();l.forEach(e=>{if(!n.has(e)){const a=Wn(t.get(e),r.get(e));null!==a&&c.set(e,a),n=n.add(e)}}),s.push(this.documentOverlayCache.saveOverlays(e,o,c))}return Fe.waitFor(s)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.recalculateAndSaveOverlays(e,t))}getDocumentsMatchingQuery(e,t,r,a){return function(e){return oe.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Za(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,a):this.getDocumentsMatchingCollectionQuery(e,t,r,a)}getNextDocuments(e,t,r,a){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,a).next(n=>{const s=a-n.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,a-n.size):Fe.resolve(yn());let i=we,o=n;return s.next(t=>Fe.forEach(t,(t,r)=>(i<r.largestBatchId&&(i=r.largestBatchId),n.get(t)?Fe.resolve():this.remoteDocumentCache.getEntry(e,t).next(e=>{o=o.insert(t,e)}))).next(()=>this.populateOverlays(e,t,n)).next(()=>this.computeViews(e,o,t,Nn())).next(e=>({batchId:i,changes:xn(e)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new oe(t)).next(e=>{let t=pn();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t})}getDocumentsMatchingCollectionGroupQuery(e,t,r,a){const n=t.collectionGroup;let s=pn();return this.indexManager.getCollectionParents(e,n).next(i=>Fe.forEach(i,i=>{const o=function(e,t){return new Qa(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(t,i.child(n));return this.getDocumentsMatchingCollectionQuery(e,o,r,a).next(e=>{e.forEach((e,t)=>{s=s.insert(e,t)})})}).next(()=>s))}getDocumentsMatchingCollectionQuery(e,t,r,a){let n;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(s=>(n=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,n,a))).next(e=>{n.forEach((t,r)=>{const a=r.getKey();null===e.get(a)&&(e=e.insert(a,ga.newInvalidDocument(a)))});let r=pn();return e.forEach((e,a)=>{const s=n.get(e);void 0!==s&&Qn(s.mutation,a,wr.empty(),ve.now()),ln(t,a)&&(r=r.insert(e,a))}),r})}}class Vo{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return Fe.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,function(e){return{id:e.id,version:e.version,createTime:Ms(e.createTime)}}(t)),Fe.resolve()}getNamedQuery(e,t){return Fe.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,function(e){return{name:e.name,query:xi(e.bundledQuery),readTime:Ms(e.readTime)}}(t)),Fe.resolve()}}class qo{constructor(){this.overlays=new gr(oe.comparator),this.qr=new Map}getOverlay(e,t){return Fe.resolve(this.overlays.get(t))}getOverlays(e,t){const r=yn();return Fe.forEach(t,t=>this.getOverlay(e,t).next(e=>{null!==e&&r.set(t,e)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((r,a)=>{this.St(e,t,a)}),Fe.resolve()}removeOverlaysForBatchId(e,t,r){const a=this.qr.get(r);return void 0!==a&&(a.forEach(e=>this.overlays=this.overlays.remove(e)),this.qr.delete(r)),Fe.resolve()}getOverlaysForCollection(e,t,r){const a=yn(),n=t.length+1,s=new oe(t.child("")),i=this.overlays.getIteratorFrom(s);for(;i.hasNext();){const e=i.getNext().value,s=e.getKey();if(!t.isPrefixOf(s.path))break;s.path.length===n&&e.largestBatchId>r&&a.set(e.getKey(),e)}return Fe.resolve(a)}getOverlaysForCollectionGroup(e,t,r,a){let n=new gr((e,t)=>e-t);const s=this.overlays.getIterator();for(;s.hasNext();){const e=s.getNext().value;if(e.getKey().getCollectionGroup()===t&&e.largestBatchId>r){let t=n.get(e.largestBatchId);null===t&&(t=yn(),n=n.insert(e.largestBatchId,t)),t.set(e.getKey(),e)}}const i=yn(),o=n.getIterator();for(;o.hasNext()&&(o.getNext().value.forEach((e,t)=>i.set(e,t)),!(i.size()>=a)););return Fe.resolve(i)}St(e,t,r){const a=this.overlays.get(r.key);if(null!==a){const e=this.qr.get(a.largestBatchId).delete(r.key);this.qr.set(a.largestBatchId,e)}this.overlays=this.overlays.insert(r.key,new is(t,r));let n=this.qr.get(t);void 0===n&&(n=Nn(),this.qr.set(t,n)),this.qr.set(t,n.add(r.key))}}class Ho{constructor(){this.sessionToken=Nr.EMPTY_BYTE_STRING}getSessionToken(e){return Fe.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,Fe.resolve()}}class Go{constructor(){this.Qr=new yr(Wo.$r),this.Ur=new yr(Wo.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const r=new Wo(e,t);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,t){e.forEach(e=>this.addReference(e,t))}removeReference(e,t){this.Gr(new Wo(e,t))}zr(e,t){e.forEach(e=>this.removeReference(e,t))}jr(e){const t=new oe(new ne([])),r=new Wo(t,e),a=new Wo(t,e+1),n=[];return this.Ur.forEachInRange([r,a],e=>{this.Gr(e),n.push(e.key)}),n}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new oe(new ne([])),r=new Wo(t,e),a=new Wo(t,e+1);let n=Nn();return this.Ur.forEachInRange([r,a],e=>{n=n.add(e.key)}),n}containsKey(e){const t=new Wo(e,0),r=this.Qr.firstAfterOrEqual(t);return null!==r&&e.isEqual(r.key)}}class Wo{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return oe.comparator(e.key,t.key)||Y(e.Yr,t.Yr)}static Kr(e,t){return Y(e.Yr,t.Yr)||oe.comparator(e.key,t.key)}}class Ko{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new yr(Wo.$r)}checkEmpty(e){return Fe.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,r,a){const n=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const s=new ns(n,t,r,a);this.mutationQueue.push(s);for(const i of a)this.Zr=this.Zr.add(new Wo(i.key,n)),this.indexManager.addToCollectionParentIndex(e,i.key.path.popLast());return Fe.resolve(s)}lookupMutationBatch(e,t){return Fe.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,a=this.ei(r),n=a<0?0:a;return Fe.resolve(this.mutationQueue.length>n?this.mutationQueue[n]:null)}getHighestUnacknowledgedBatchId(){return Fe.resolve(0===this.mutationQueue.length?Xe:this.tr-1)}getAllMutationBatches(e){return Fe.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new Wo(t,0),a=new Wo(t,Number.POSITIVE_INFINITY),n=[];return this.Zr.forEachInRange([r,a],e=>{const t=this.Xr(e.Yr);n.push(t)}),Fe.resolve(n)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new yr(Y);return t.forEach(e=>{const t=new Wo(e,0),a=new Wo(e,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([t,a],e=>{r=r.add(e.Yr)})}),Fe.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,a=r.length+1;let n=r;oe.isDocumentKey(n)||(n=n.child(""));const s=new Wo(new oe(n),0);let i=new yr(Y);return this.Zr.forEachWhile(e=>{const t=e.key.path;return!!r.isPrefixOf(t)&&(t.length===a&&(i=i.add(e.Yr)),!0)},s),Fe.resolve(this.ti(i))}ti(e){const t=[];return e.forEach(e=>{const r=this.Xr(e);null!==r&&t.push(r)}),t}removeMutationBatch(e,t){F(0===this.ni(t.batchId,"removed"),55003),this.mutationQueue.shift();let r=this.Zr;return Fe.forEach(t.mutations,a=>{const n=new Wo(a.key,t.batchId);return r=r.delete(n),this.referenceDelegate.markPotentiallyOrphaned(e,a.key)}).next(()=>{this.Zr=r})}ir(e){}containsKey(e,t){const r=new Wo(t,0),a=this.Zr.firstAfterOrEqual(r);return Fe.resolve(t.isEqual(a&&a.key))}performConsistencyCheck(e){return this.mutationQueue.length,Fe.resolve()}ni(e,t){return this.ei(e)}ei(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class Qo{constructor(e){this.ri=e,this.docs=new gr(oe.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,a=this.docs.get(r),n=a?a.size:0,s=this.ri(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:s}),this.size+=s-n,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return Fe.resolve(r?r.document.mutableCopy():ga.newInvalidDocument(t))}getEntries(e,t){let r=fn();return t.forEach(e=>{const t=this.docs.get(e);r=r.insert(e,t?t.document.mutableCopy():ga.newInvalidDocument(e))}),Fe.resolve(r)}getDocumentsMatchingQuery(e,t,r,a){let n=fn();const s=t.path,i=new oe(s.child("__id-9223372036854775808__")),o=this.docs.getIteratorFrom(i);for(;o.hasNext();){const{key:e,value:{document:i}}=o.getNext();if(!s.isPrefixOf(e.path))break;e.path.length>s.length+1||Ie(Ae(i),r)<=0||(a.has(i.key)||ln(t,i))&&(n=n.insert(i.key,i.mutableCopy()))}return Fe.resolve(n)}getAllFromCollectionGroup(e,t,r,a){D(9500)}ii(e,t){return Fe.forEach(this.docs,e=>t(e))}newChangeBuffer(e){return new Yo(this)}getSize(e){return Fe.resolve(this.size)}}class Yo extends To{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach((r,a)=>{a.isValidDocument()?t.push(this.Nr.addEntry(e,a)):this.Nr.removeEntry(r)}),Fe.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}class Xo{constructor(e){this.persistence=e,this.si=new hn(e=>Va(e),qa),this.lastRemoteSnapshotVersion=be.min(),this.highestTargetId=0,this.oi=0,this._i=new Go,this.targetCount=0,this.ai=xo.ur()}forEachTarget(e,t){return this.si.forEach((e,r)=>t(r)),Fe.resolve()}getLastRemoteSnapshotVersion(e){return Fe.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Fe.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),Fe.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.oi&&(this.oi=t),Fe.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new xo(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,Fe.resolve()}updateTargetData(e,t){return this.Pr(t),Fe.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,Fe.resolve()}removeTargets(e,t,r){let a=0;const n=[];return this.si.forEach((s,i)=>{i.sequenceNumber<=t&&null===r.get(i.targetId)&&(this.si.delete(s),n.push(this.removeMatchingKeysForTargetId(e,i.targetId)),a++)}),Fe.waitFor(n).next(()=>a)}getTargetCount(e){return Fe.resolve(this.targetCount)}getTargetData(e,t){const r=this.si.get(t)||null;return Fe.resolve(r)}addMatchingKeys(e,t,r){return this._i.Wr(t,r),Fe.resolve()}removeMatchingKeys(e,t,r){this._i.zr(t,r);const a=this.persistence.referenceDelegate,n=[];return a&&t.forEach(t=>{n.push(a.markPotentiallyOrphaned(e,t))}),Fe.waitFor(n)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),Fe.resolve()}getMatchingKeysForTargetId(e,t){const r=this._i.Hr(t);return Fe.resolve(r)}containsKey(e,t){return Fe.resolve(this._i.containsKey(t))}}class Jo{constructor(e,t){this.ui={},this.overlays={},this.ci=new Ye(0),this.li=!1,this.li=!0,this.hi=new Ho,this.referenceDelegate=e(this),this.Pi=new Xo(this),this.indexManager=new Xi,this.remoteDocumentCache=function(e){return new Qo(e)}(e=>this.referenceDelegate.Ti(e)),this.serializer=new ci(t),this.Ii=new Vo(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new qo,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.ui[e.toKey()];return r||(r=new Ko(t,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,r){A("MemoryPersistence","Starting transaction:",e);const a=new Zo(this.ci.next());return this.referenceDelegate.Ei(),r(a).next(e=>this.referenceDelegate.di(a).next(()=>e)).toPromise().then(e=>(a.raiseOnCommittedEvent(),e))}Ai(e,t){return Fe.or(Object.values(this.ui).map(r=>()=>r.containsKey(e,t)))}}class Zo extends De{constructor(e){super(),this.currentSequenceNumber=e}}class $o{constructor(e){this.persistence=e,this.Ri=new Go,this.Vi=null}static mi(e){return new $o(e)}get fi(){if(this.Vi)return this.Vi;throw D(60996)}addReference(e,t,r){return this.Ri.addReference(r,t),this.fi.delete(r.toString()),Fe.resolve()}removeReference(e,t,r){return this.Ri.removeReference(r,t),this.fi.add(r.toString()),Fe.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),Fe.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach(e=>this.fi.add(e.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(e=>{e.forEach(e=>this.fi.add(e.toString()))}).next(()=>r.removeTargetData(e,t))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Fe.forEach(this.fi,r=>{const a=oe.fromPath(r);return this.gi(e,a).next(e=>{e||t.removeEntry(a,be.min())})}).next(()=>(this.Vi=null,t.apply(e)))}updateLimboDocument(e,t){return this.gi(e,t).next(e=>{e?this.fi.delete(t.toString()):this.fi.add(t.toString())})}Ti(e){return 0}gi(e,t){return Fe.or([()=>Fe.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class el{constructor(e,t){this.persistence=e,this.pi=new hn(e=>tt(e.path),(e,t)=>e.isEqual(t)),this.garbageCollector=Ao(this,t)}static mi(e,t){return new el(e,t)}Ei(){}di(e){return Fe.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(e=>t.next(t=>e+t))}wr(e){let t=0;return this.pr(e,e=>{t++}).next(()=>t)}pr(e,t){return Fe.forEach(this.pi,(r,a)=>this.br(e,r,a).next(e=>e?Fe.resolve():t(a)))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0;const a=this.persistence.getRemoteDocumentCache(),n=a.newChangeBuffer();return a.ii(e,a=>this.br(e,a,t).next(e=>{e||(r++,n.removeEntry(a,be.min()))})).next(()=>n.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),Fe.resolve()}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),Fe.resolve()}removeReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),Fe.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),Fe.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Zr(e.data.value)),t}br(e,t,r){return Fe.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const e=this.pi.get(t);return Fe.resolve(void 0!==e&&e>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class tl{constructor(e){this.serializer=e}k(e,t,r,a){const n=new Me("createOrUpgrade",t);r<1&&a>=1&&(function(e){e.createObjectStore(it)}(e),function(e){e.createObjectStore(lt,{keyPath:"userId"});e.createObjectStore(ct,{keyPath:dt,autoIncrement:!0}).createIndex(ut,ht,{unique:!0}),e.createObjectStore(pt)}(e),rl(e),function(e){e.createObjectStore(st)}(e));let s=Fe.resolve();return r<3&&a>=3&&(0!==r&&(function(e){e.deleteObjectStore(At),e.deleteObjectStore(St),e.deleteObjectStore(Pt)}(e),rl(e)),s=s.next(()=>function(e){const t=e.store(Pt),r={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:be.min().toTimestamp(),targetCount:0};return t.put(Dt,r)}(n))),r<4&&a>=4&&(0!==r&&(s=s.next(()=>function(e,t){return t.store(ct).J().next(r=>{e.deleteObjectStore(ct),e.createObjectStore(ct,{keyPath:dt,autoIncrement:!0}).createIndex(ut,ht,{unique:!0});const a=t.store(ct),n=r.map(e=>a.put(e));return Fe.waitFor(n)})}(e,n))),s=s.next(()=>{!function(e){e.createObjectStore(Mt,{keyPath:"clientId"})}(e)})),r<5&&a>=5&&(s=s.next(()=>this.yi(n))),r<6&&a>=6&&(s=s.next(()=>(function(e){e.createObjectStore(Nt)}(e),this.wi(n)))),r<7&&a>=7&&(s=s.next(()=>this.Si(n))),r<8&&a>=8&&(s=s.next(()=>this.bi(e,n))),r<9&&a>=9&&(s=s.next(()=>{!function(e){e.objectStoreNames.contains("remoteDocumentChanges")&&e.deleteObjectStore("remoteDocumentChanges")}(e)})),r<10&&a>=10&&(s=s.next(()=>this.Di(n))),r<11&&a>=11&&(s=s.next(()=>{!function(e){e.createObjectStore(Rt,{keyPath:"bundleId"})}(e),function(e){e.createObjectStore(Ot,{keyPath:"name"})}(e)})),r<12&&a>=12&&(s=s.next(()=>{!function(e){const t=e.createObjectStore(Yt,{keyPath:Xt});t.createIndex(Jt,Zt,{unique:!1}),t.createIndex($t,er,{unique:!1})}(e)})),r<13&&a>=13&&(s=s.next(()=>function(e){const t=e.createObjectStore(xt,{keyPath:yt});t.createIndex(vt,bt),t.createIndex(wt,kt)}(e)).next(()=>this.Ci(e,n)).next(()=>e.deleteObjectStore(st))),r<14&&a>=14&&(s=s.next(()=>this.Fi(e,n))),r<15&&a>=15&&(s=s.next(()=>function(e){e.createObjectStore(Bt,{keyPath:"indexId",autoIncrement:!0}).createIndex(zt,"collectionGroup",{unique:!1});e.createObjectStore(Ut,{keyPath:Vt}).createIndex(qt,Ht,{unique:!1});e.createObjectStore(Gt,{keyPath:Wt}).createIndex(Kt,Qt,{unique:!1})}(e))),r<16&&a>=16&&(s=s.next(()=>{t.objectStore(Ut).clear()}).next(()=>{t.objectStore(Gt).clear()})),r<17&&a>=17&&(s=s.next(()=>{!function(e){e.createObjectStore(tr,{keyPath:"name"})}(e)})),r<18&&a>=18&&(0,c.Ov)()&&(s=s.next(()=>{t.objectStore(Ut).clear()}).next(()=>{t.objectStore(Gt).clear()})),s}wi(e){let t=0;return e.store(st).ee((e,r)=>{t+=uo(r)}).next(()=>{const r={byteSize:t};return e.store(Nt).put(jt,r)})}yi(e){const t=e.store(lt),r=e.store(ct);return t.J().next(t=>Fe.forEach(t,t=>{const a=IDBKeyRange.bound([t.userId,Xe],[t.userId,t.lastAcknowledgedBatchId]);return r.J(ut,a).next(r=>Fe.forEach(r,r=>{F(r.userId===t.userId,18650,"Cannot process batch from unexpected user",{batchId:r.batchId});const a=fi(this.serializer,r);return co(e,t.userId,a).next(()=>{})}))}))}Si(e){const t=e.store(At),r=e.store(st);return e.store(Pt).get(Dt).next(e=>{const a=[];return r.ee((r,n)=>{const s=new ne(r),i=function(e){return[0,tt(e)]}(s);a.push(t.get(i).next(r=>r?Fe.resolve():(r=>t.put({targetId:0,path:tt(r),sequenceNumber:e.highestListenSequenceNumber}))(s)))}).next(()=>Fe.waitFor(a))})}bi(e,t){e.createObjectStore(Ft,{keyPath:Lt});const r=t.store(Ft),a=new Ji,n=e=>{if(a.add(e)){const t=e.lastSegment(),a=e.popLast();return r.put({collectionId:t,parent:tt(a)})}};return t.store(st).ee({X:!0},(e,t)=>{const r=new ne(e);return n(r.popLast())}).next(()=>t.store(pt).ee({X:!0},(e,t)=>{let[r,a,s]=e;const i=nt(a);return n(i.popLast())}))}Di(e){const t=e.store(St);return t.ee((e,r)=>{const a=gi(r),n=pi(this.serializer,a);return t.put(n)})}Ci(e,t){const r=t.store(st),a=[];return r.ee((e,r)=>{const n=t.store(xt),s=function(e){return e.document?new oe(ne.fromString(e.document.name).popFirst(5)):e.noDocument?oe.fromSegments(e.noDocument.path):e.unknownDocument?oe.fromSegments(e.unknownDocument.path):D(36783)}(r).path.toArray(),i={prefixPath:s.slice(0,s.length-2),collectionGroup:s[s.length-2],documentId:s[s.length-1],readTime:r.readTime||[0,0],unknownDocument:r.unknownDocument,noDocument:r.noDocument,document:r.document,hasCommittedMutations:!!r.hasCommittedMutations};a.push(n.put(i))}).next(()=>Fe.waitFor(a))}Fi(e,t){const r=t.store(ct),a=Po(this.serializer),n=new Jo($o.mi,this.serializer.yt);return r.J().next(e=>{const r=new Map;return e.forEach(e=>{var t;let a=null!==(t=r.get(e.userId))&&void 0!==t?t:Nn();fi(this.serializer,e).keys().forEach(e=>a=a.add(e)),r.set(e.userId,a)}),Fe.forEach(r,(e,r)=>{const s=new j(r),i=ji.wt(this.serializer,s),o=n.getIndexManager(s),l=ho.wt(s,this.serializer,o,n.referenceDelegate);return new Uo(a,l,i,o).recalculateAndSaveOverlaysForDocumentKeys(new dr(t,Ye.ce),e).next()})})}}function rl(e){e.createObjectStore(At,{keyPath:Ct}).createIndex(It,Tt,{unique:!0}),e.createObjectStore(St,{keyPath:"targetId"}).createIndex(_t,Et,{unique:!0}),e.createObjectStore(Pt)}const al="IndexedDbPersistence",nl=18e5,sl=5e3,il="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",ol="main";class ll{constructor(e,t,r,a,n,s,i,o,l,c){let d=arguments.length>10&&void 0!==arguments[10]?arguments[10]:18;if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.Mi=n,this.window=s,this.document=i,this.xi=l,this.Oi=c,this.Ni=d,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=e=>Promise.resolve(),!ll.v())throw new R(M.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new Co(this,a),this.$i=t+ol,this.serializer=new ci(o),this.Ui=new Re(this.$i,this.Ni,new tl(this.serializer)),this.hi=new _i,this.Pi=new yo(this.referenceDelegate,this.serializer),this.remoteDocumentCache=Po(this.serializer),this.Ii=new wi,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,!1===c&&C(al,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new R(M.FAILED_PRECONDITION,il);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Pi.getHighestSequenceNumber(e))}).then(e=>{this.ci=new Ye(e,this.xi)}).then(()=>{this.li=!0}).catch(e=>(this.Ui&&this.Ui.close(),Promise.reject(e)))}Ji(e){return this.Qi=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ui.$(async t=>{null===t.newVersion&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Mi.enqueueAndForget(async()=>{this.started&&await this.Wi()}))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>dl(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.Hi(e).next(e=>{e||(this.isPrimary=!1,this.Mi.enqueueRetryable(()=>this.Qi(!1)))})}).next(()=>this.Yi(e)).next(t=>this.isPrimary&&!t?this.Zi(e).next(()=>!1):!!t&&this.Xi(e).next(()=>!0))).catch(e=>{if(Ue(e))return A(al,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return A(al,"Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.Mi.enqueueRetryable(()=>this.Qi(e)),this.isPrimary=e})}Hi(e){return cl(e).get(ot).next(e=>Fe.resolve(this.es(e)))}ts(e){return dl(e).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.rs(this.qi,nl)){this.qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",e=>{const t=ur(e,Mt);return t.J().next(e=>{const r=this.ss(e,nl),a=e.filter(e=>-1===r.indexOf(e));return Fe.forEach(a,e=>t.delete(e.clientId)).next(()=>a)})}).catch(()=>[]);if(this.Ki)for(const t of e)this.Ki.removeItem(this._s(t.clientId))}}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.Wi().then(()=>this.ns()).then(()=>this.ji()))}es(e){return!!e&&e.ownerId===this.clientId}Yi(e){return this.Oi?Fe.resolve(!0):cl(e).get(ot).next(t=>{if(null!==t&&this.rs(t.leaseTimestampMs,sl)&&!this.us(t.ownerId)){if(this.es(t)&&this.networkEnabled)return!0;if(!this.es(t)){if(!t.allowTabSynchronization)throw new R(M.FAILED_PRECONDITION,il);return!1}}return!(!this.networkEnabled||!this.inForeground)||dl(e).J().next(e=>void 0===this.ss(e,sl).find(e=>{if(this.clientId!==e.clientId){const t=!this.networkEnabled&&e.networkEnabled,r=!this.inForeground&&e.inForeground,a=this.networkEnabled===e.networkEnabled;if(t||r&&a)return!0}return!1}))}).next(e=>(this.isPrimary!==e&&A(al,"Client ".concat(e?"is":"is not"," eligible for a primary lease.")),e))}async shutdown(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),await this.Ui.runTransaction("shutdown","readwrite",[it,Mt],e=>{const t=new dr(e,Ye.ce);return this.Zi(t).next(()=>this.ts(t))}),this.Ui.close(),this.Ps()}ss(e,t){return e.filter(e=>this.rs(e.updateTimeMs,t)&&!this.us(e.clientId))}Ts(){return this.runTransaction("getActiveClients","readonly",e=>dl(e).J().next(e=>this.ss(e,nl).map(e=>e.clientId)))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(e,t){return ho.wt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new eo(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return ji.wt(this.serializer,e)}getBundleCache(){return this.Ii}runTransaction(e,t,r){A(al,"Starting transaction:",e);const a="readonly"===t?"readonly":"readwrite",n=function(e){return 18===e?cr:17===e?lr:16===e?or:15===e?ir:14===e?sr:13===e?nr:12===e?ar:11===e?rr:void D(60245)}(this.Ni);let s;return this.Ui.runTransaction(e,a,n,a=>(s=new dr(a,this.ci?this.ci.next():Ye.ce),"readwrite-primary"===t?this.Hi(s).next(e=>!!e||this.Yi(s)).next(t=>{if(!t)throw C("Failed to obtain primary lease for action '".concat(e,"'.")),this.isPrimary=!1,this.Mi.enqueueRetryable(()=>this.Qi(!1)),new R(M.FAILED_PRECONDITION,Te);return r(s)}).next(e=>this.Xi(s).next(()=>e)):this.Is(s).next(()=>r(s)))).then(e=>(s.raiseOnCommittedEvent(),e))}Is(e){return cl(e).get(ot).next(e=>{if(null!==e&&this.rs(e.leaseTimestampMs,sl)&&!this.us(e.ownerId)&&!this.es(e)&&!(this.Oi||this.allowTabSynchronization&&e.allowTabSynchronization))throw new R(M.FAILED_PRECONDITION,il)})}Xi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return cl(e).put(ot,t)}static v(){return Re.v()}Zi(e){const t=cl(e);return t.get(ot).next(e=>this.es(e)?(A(al,"Releasing primary lease."),t.delete(ot)):Fe.resolve())}rs(e,t){const r=Date.now();return!(e<r-t)&&(!(e>r)||(C("Detected an update time that is in the future: ".concat(e," > ").concat(r)),!1))}Gi(){null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Li=()=>{this.Mi.enqueueAndForget(()=>(this.inForeground="visible"===this.document.visibilityState,this.Wi()))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground="visible"===this.document.visibilityState)}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){var e;"function"==typeof(null===(e=this.window)||void 0===e?void 0:e.addEventListener)&&(this.Bi=()=>{this.cs();const e=/(?:Version|Mobile)\/1[456]/;(0,c.nr)()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(e){try{var t;const r=null!==(null===(t=this.Ki)||void 0===t?void 0:t.getItem(this._s(e)));return A(al,"Client '".concat(e,"' ").concat(r?"is":"is not"," zombied in LocalStorage")),r}catch(e){return C(al,"Failed to get zombied client id.",e),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(e){C("Failed to set zombie client id.",e)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch(e){}}_s(e){return"firestore_zombie_".concat(this.persistenceKey,"_").concat(e)}}function cl(e){return ur(e,it)}function dl(e){return ur(e,Mt)}function ul(e,t){let r=e.projectId;return e.isDefaultDatabase||(r+="."+e.database),"firestore/"+t+"/"+r+"/"}class hl{constructor(e,t,r,a){this.targetId=e,this.fromCache=t,this.Es=r,this.ds=a}static As(e,t){let r=Nn(),a=Nn();for(const n of t.docChanges)switch(n.type){case 0:r=r.add(n.doc.key);break;case 1:a=a.add(n.doc.key)}return new hl(e,t.fromCache,r,a)}}class ml{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class fl{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(0,c.nr)()?8:Oe((0,c.ZQ)())>0?6:4}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,r,a){const n={result:null};return this.ys(e,t).next(e=>{n.result=e}).next(()=>{if(!n.result)return this.ws(e,t,a,r).next(e=>{n.result=e})}).next(()=>{if(n.result)return;const r=new ml;return this.Ss(e,t,r).next(a=>{if(n.result=a,this.Vs)return this.bs(e,t,r,a.size)})}).next(()=>n.result)}bs(e,t,r,a){return r.documentReadCount<this.fs?(E()<=l.$b.DEBUG&&A("QueryEngine","SDK will not create cache indexes for query:",on(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),Fe.resolve()):(E()<=l.$b.DEBUG&&A("QueryEngine","Query:",on(t),"scans",r.documentReadCount,"local documents and returns",a,"documents as results."),r.documentReadCount>this.gs*a?(E()<=l.$b.DEBUG&&A("QueryEngine","The SDK decides to create cache indexes for query:",on(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,en(t))):Fe.resolve())}ys(e,t){if(Ja(t))return Fe.resolve(null);let r=en(t);return this.indexManager.getIndexType(e,r).next(a=>0===a?null:(null!==t.limit&&1===a&&(t=an(t,null,"F"),r=en(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(a=>{const n=Nn(...a);return this.ps.getDocuments(e,n).next(a=>this.indexManager.getMinOffset(e,r).next(r=>{const s=this.Ds(t,a);return this.Cs(t,s,n,r.readTime)?this.ys(e,an(t,null,"F")):this.vs(e,s,t,r)}))})))}ws(e,t,r,a){return Ja(t)||a.isEqual(be.min())?Fe.resolve(null):this.ps.getDocuments(e,r).next(n=>{const s=this.Ds(t,n);return this.Cs(t,s,r,a)?Fe.resolve(null):(E()<=l.$b.DEBUG&&A("QueryEngine","Re-using previous result from %s to execute query: %s",a.toString(),on(t)),this.vs(e,s,t,Ee(a,we)).next(e=>e))})}Ds(e,t){let r=new yr(dn(e));return t.forEach((t,a)=>{ln(e,a)&&(r=r.add(a))}),r}Cs(e,t,r,a){if(null===e.limit)return!1;if(r.size!==t.size)return!0;const n="F"===e.limitType?t.last():t.first();return!!n&&(n.hasPendingWrites||n.version.compareTo(a)>0)}Ss(e,t,r){return E()<=l.$b.DEBUG&&A("QueryEngine","Using full collection scan to execute query:",on(t)),this.ps.getDocumentsMatchingQuery(e,t,Ce.min(),r)}vs(e,t,r,a){return this.ps.getDocumentsMatchingQuery(e,r,a).next(e=>(t.forEach(t=>{e=e.insert(t.key,t)}),e))}}const gl="LocalStore",pl=3e8;class xl{constructor(e,t,r,a){this.persistence=e,this.Fs=t,this.serializer=a,this.Ms=new gr(Y),this.xs=new hn(e=>Va(e),qa),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Uo(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Ms))}}function yl(e,t,r,a){return new xl(e,t,r,a)}async function vl(e,t){const r=L(e);return await r.persistence.runTransaction("Handle user change","readonly",e=>{let a;return r.mutationQueue.getAllMutationBatches(e).next(n=>(a=n,r.Bs(t),r.mutationQueue.getAllMutationBatches(e))).next(t=>{const n=[],s=[];let i=Nn();for(const e of a){n.push(e.batchId);for(const t of e.mutations)i=i.add(t.key)}for(const e of t){s.push(e.batchId);for(const t of e.mutations)i=i.add(t.key)}return r.localDocuments.getDocuments(e,i).next(e=>({Ls:e,removedBatchIds:n,addedBatchIds:s}))})})}function bl(e){const t=L(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",e=>t.Pi.getLastRemoteSnapshotVersion(e))}function wl(e,t,r){let a=Nn(),n=Nn();return r.forEach(e=>a=a.add(e)),t.getEntries(e,a).next(e=>{let a=fn();return r.forEach((r,s)=>{const i=e.get(r);s.isFoundDocument()!==i.isFoundDocument()&&(n=n.add(r)),s.isNoDocument()&&s.version.isEqual(be.min())?(t.removeEntry(r,s.readTime),a=a.insert(r,s)):!i.isValidDocument()||s.version.compareTo(i.version)>0||0===s.version.compareTo(i.version)&&i.hasPendingWrites?(t.addEntry(s),a=a.insert(r,s)):A(gl,"Ignoring outdated watch update for ",r,". Current version:",i.version," Watch version:",s.version)}),{ks:a,qs:n}})}function kl(e,t){const r=L(e);return r.persistence.runTransaction("Get next mutation batch","readonly",e=>(void 0===t&&(t=Xe),r.mutationQueue.getNextMutationBatchAfterBatchId(e,t)))}function Nl(e,t){const r=L(e);return r.persistence.runTransaction("Allocate target","readwrite",e=>{let a;return r.Pi.getTargetData(e,t).next(n=>n?(a=n,Fe.resolve(a)):r.Pi.allocateTargetId(e).next(n=>(a=new li(t,n,"TargetPurposeListen",e.currentSequenceNumber),r.Pi.addTargetData(e,a).next(()=>a))))}).then(e=>{const a=r.Ms.get(e.targetId);return(null===a||e.snapshotVersion.compareTo(a.snapshotVersion)>0)&&(r.Ms=r.Ms.insert(e.targetId,e),r.xs.set(t,e.targetId)),e})}async function jl(e,t,r){const a=L(e),n=a.Ms.get(t),s=r?"readwrite":"readwrite-primary";try{r||await a.persistence.runTransaction("Release target",s,e=>a.persistence.referenceDelegate.removeTarget(e,n))}catch(e){if(!Ue(e))throw e;A(gl,"Failed to update sequence numbers for target ".concat(t,": ").concat(e))}a.Ms=a.Ms.remove(t),a.xs.delete(n.target)}function Sl(e,t,r){const a=L(e);let n=be.min(),s=Nn();return a.persistence.runTransaction("Execute query","readwrite",e=>function(e,t,r){const a=L(e),n=a.xs.get(r);return void 0!==n?Fe.resolve(a.Ms.get(n)):a.Pi.getTargetData(t,r)}(a,e,en(t)).next(t=>{if(t)return n=t.lastLimboFreeSnapshotVersion,a.Pi.getMatchingKeysForTargetId(e,t.targetId).next(e=>{s=e})}).next(()=>a.Fs.getDocumentsMatchingQuery(e,t,r?n:be.min(),r?s:Nn())).next(e=>(_l(a,cn(t),e),{documents:e,Qs:s})))}function _l(e,t,r){let a=e.Os.get(t)||be.min();r.forEach((e,t)=>{t.readTime.compareTo(a)>0&&(a=t.readTime)}),e.Os.set(t,a)}class El{constructor(){this.activeTargetIds=Sn()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Al{constructor(){this.Mo=new El,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e){return(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,r){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new El,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class Cl{Oo(e){}shutdown(){}}const Il="ConnectivityMonitor";class Tl{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){A(Il,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){A(Il,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let Dl=null;function Pl(){return null===Dl?Dl=268435456+Math.round(2147483648*Math.random()):Dl++,"0x"+Dl.toString(16)}const Fl="RestConnection",Ll={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Ml{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),a=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko="projects/".concat(r,"/databases/").concat(a),this.Wo=this.databaseId.database===Mr?"project_id=".concat(r):"project_id=".concat(r,"&database_id=").concat(a)}Go(e,t,r,a,n){const s=Pl(),i=this.zo(e,t.toUriEncodedString());A(Fl,"Sending RPC '".concat(e,"' ").concat(s,":"),i,r);const o={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(o,a,n);const{host:l}=new URL(i),d=(0,c.zJ)(l);return this.Jo(e,i,o,r,d).then(t=>(A(Fl,"Received RPC '".concat(e,"' ").concat(s,": "),t),t),t=>{throw I(Fl,"RPC '".concat(e,"' ").concat(s," failed with error: "),t,"url: ",i,"request:",r),t})}Ho(e,t,r,a,n,s){return this.Go(e,t,r,a,n)}jo(e,t,r){e["X-Goog-Api-Client"]="gl-js/ fire/"+S,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((t,r)=>e[r]=t),r&&r.headers.forEach((t,r)=>e[r]=t)}zo(e,t){const r=Ll[e];return"".concat(this.Uo,"/v1/").concat(t,":").concat(r)}terminate(){}}class Rl{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const Ol="WebChannelConnection";class Bl extends Ml{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,r,a,n){const s=Pl();return new Promise((n,i)=>{const o=new h;o.setWithCredentials(!0),o.listenOnce(f.COMPLETE,()=>{try{switch(o.getLastErrorCode()){case g.NO_ERROR:const r=o.getResponseJson();A(Ol,"XHR for RPC '".concat(e,"' ").concat(s," received:"),JSON.stringify(r)),n(r);break;case g.TIMEOUT:A(Ol,"RPC '".concat(e,"' ").concat(s," timed out")),i(new R(M.DEADLINE_EXCEEDED,"Request time out"));break;case g.HTTP_ERROR:const a=o.getStatus();if(A(Ol,"RPC '".concat(e,"' ").concat(s," failed with status:"),a,"response text:",o.getResponseText()),a>0){var t;let e=o.getResponseJson();Array.isArray(e)&&(e=e[0]);const r=null===(t=e)||void 0===t?void 0:t.error;if(r&&r.status&&r.message){const e=function(e){const t=e.toLowerCase().replace(/_/g,"-");return Object.values(M).indexOf(t)>=0?t:M.UNKNOWN}(r.status);i(new R(e,r.message))}else i(new R(M.UNKNOWN,"Server responded with status "+o.getStatus()))}else i(new R(M.UNAVAILABLE,"Connection failed."));break;default:D(9055,{l_:e,streamId:s,h_:o.getLastErrorCode(),P_:o.getLastError()})}}finally{A(Ol,"RPC '".concat(e,"' ").concat(s," completed."))}});const l=JSON.stringify(a);A(Ol,"RPC '".concat(e,"' ").concat(s," sending request:"),a),o.send(t,"POST",l,r,15)})}T_(e,t,r){const a=Pl(),n=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=v(),i=y(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/".concat(this.databaseId.projectId,"/databases/").concat(this.databaseId.database)},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;void 0!==l&&(o.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(o.useFetchStreams=!0),this.jo(o.initMessageHeaders,t,r),o.encodeInitMessageHeaders=!0;const c=n.join("");A(Ol,"Creating RPC '".concat(e,"' stream ").concat(a,": ").concat(c),o);const d=s.createWebChannel(c,o);this.I_(d);let u=!1,h=!1;const f=new Rl({Yo:t=>{h?A(Ol,"Not sending because RPC '".concat(e,"' stream ").concat(a," is closed:"),t):(u||(A(Ol,"Opening RPC '".concat(e,"' stream ").concat(a," transport.")),d.open(),u=!0),A(Ol,"RPC '".concat(e,"' stream ").concat(a," sending:"),t),d.send(t))},Zo:()=>d.close()}),g=(e,t,r)=>{e.listen(t,e=>{try{r(e)}catch(e){setTimeout(()=>{throw e},0)}})};return g(d,m.EventType.OPEN,()=>{h||(A(Ol,"RPC '".concat(e,"' stream ").concat(a," transport opened.")),f.o_())}),g(d,m.EventType.CLOSE,()=>{h||(h=!0,A(Ol,"RPC '".concat(e,"' stream ").concat(a," transport closed")),f.a_(),this.E_(d))}),g(d,m.EventType.ERROR,t=>{h||(h=!0,I(Ol,"RPC '".concat(e,"' stream ").concat(a," transport errored. Name:"),t.name,"Message:",t.message),f.a_(new R(M.UNAVAILABLE,"The operation could not be completed")))}),g(d,m.EventType.MESSAGE,t=>{if(!h){var r;const n=t.data[0];F(!!n,16349);const s=n,i=(null===s||void 0===s?void 0:s.error)||(null===(r=s[0])||void 0===r?void 0:r.error);if(i){A(Ol,"RPC '".concat(e,"' stream ").concat(a," received error:"),i);const t=i.status;let r=function(e){const t=ls[e];if(void 0!==t)return us(t)}(t),n=i.message;void 0===r&&(r=M.INTERNAL,n="Unknown error status: "+t+" with message "+i.message),h=!0,f.a_(new R(r,n)),d.close()}else A(Ol,"RPC '".concat(e,"' stream ").concat(a," received:"),n),f.u_(n)}}),g(i,x.STAT_EVENT,t=>{t.stat===p.PROXY?A(Ol,"RPC '".concat(e,"' stream ").concat(a," detected buffering proxy")):t.stat===p.NOPROXY&&A(Ol,"RPC '".concat(e,"' stream ").concat(a," detected no buffering proxy"))}),setTimeout(()=>{f.__()},0),f}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(t=>t===e)}}function zl(){return"undefined"!=typeof window?window:null}function Ul(){return"undefined"!=typeof document?document:null}function Vl(e){return new Ts(e,!0)}class ql{constructor(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1.5,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:6e4;this.Mi=e,this.timerId=t,this.d_=r,this.A_=a,this.R_=n,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),a=Math.max(0,t-r);a>0&&A("ExponentialBackoff","Backing off for ".concat(a," ms (base delay: ").concat(this.V_," ms, delay with jitter: ").concat(t," ms, last attempt: ").concat(r," ms ago)")),this.m_=this.Mi.enqueueAfterDelay(this.timerId,a,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){null!==this.m_&&(this.m_.skipDelay(),this.m_=null)}cancel(){null!==this.m_&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const Hl="PersistentStream";class Gl{constructor(e,t,r,a,n,s,i,o){this.Mi=e,this.S_=r,this.b_=a,this.connection=n,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=i,this.listener=o,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new ql(e,t)}x_(){return 1===this.state||5===this.state||this.O_()}O_(){return 2===this.state||3===this.state}start(){this.F_=0,4!==this.state?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&null===this.C_&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,4!==e?this.M_.reset():t&&t.code===M.RESOURCE_EXHAUSTED?(C(t.toString()),C("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===M.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(e=>{let[r,a]=e;this.D_===t&&this.G_(r,a)},t=>{e(()=>{const e=new R(M.UNKNOWN,"Fetching auth token failed: "+t.message);return this.z_(e)})})}G_(e,t){const r=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo(()=>{r(()=>this.listener.Xo())}),this.stream.t_(()=>{r(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(e=>{r(()=>this.z_(e))}),this.stream.onMessage(e=>{r(()=>1==++this.F_?this.J_(e):this.onNext(e))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return A(Hl,"close with error: ".concat(e)),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget(()=>this.D_===e?t():(A(Hl,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class Wl extends Gl{constructor(e,t,r,a,n,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,a,s),this.serializer=n}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=function(e,t){let r;if("targetChange"in t){t.targetChange;const a=function(e){return"NO_CHANGE"===e?0:"ADD"===e?1:"REMOVE"===e?2:"CURRENT"===e?3:"RESET"===e?4:D(39313,{state:e})}(t.targetChange.targetChangeType||"NO_CHANGE"),n=t.targetChange.targetIds||[],s=function(e,t){return e.useProto3Json?(F(void 0===t||"string"==typeof t,58123),Nr.fromBase64String(t||"")):(F(void 0===t||t instanceof Buffer||t instanceof Uint8Array,16193),Nr.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),i=t.targetChange.cause,o=i&&function(e){const t=void 0===e.code?M.UNKNOWN:us(e.code);return new R(t,e.message||"")}(i);r=new Ns(a,n,s,o||null)}else if("documentChange"in t){t.documentChange;const a=t.documentChange;a.document,a.document.name,a.document.updateTime;const n=Us(e,a.document.name),s=Ms(a.document.updateTime),i=a.document.createTime?Ms(a.document.createTime):be.min(),o=new ma({mapValue:{fields:a.document.fields}}),l=ga.newFoundDocument(n,s,i,o),c=a.targetIds||[],d=a.removedTargetIds||[];r=new ws(c,d,l.key,l)}else if("documentDelete"in t){t.documentDelete;const a=t.documentDelete;a.document;const n=Us(e,a.document),s=a.readTime?Ms(a.readTime):be.min(),i=ga.newNoDocument(n,s),o=a.removedTargetIds||[];r=new ws([],o,i.key,i)}else if("documentRemove"in t){t.documentRemove;const a=t.documentRemove;a.document;const n=Us(e,a.document),s=a.removedTargetIds||[];r=new ws([],s,n,null)}else{if(!("filter"in t))return D(11601,{Rt:t});{t.filter;const e=t.filter;e.targetId;const{count:a=0,unchangedNames:n}=e,s=new os(a,n),i=e.targetId;r=new ks(i,s)}}return r}(this.serializer,e),r=function(e){if(!("targetChange"in e))return be.min();const t=e.targetChange;return t.targetIds&&t.targetIds.length?be.min():t.readTime?Ms(t.readTime):be.min()}(e);return this.listener.H_(t,r)}Y_(e){const t={};t.database=Hs(this.serializer),t.addTarget=function(e,t){let r;const a=t.target;if(r=Ha(a)?{documents:Xs(e,a)}:{query:Js(e,a).ft},r.targetId=t.targetId,t.resumeToken.approximateByteSize()>0){r.resumeToken=Fs(e,t.resumeToken);const a=Ds(e,t.expectedCount);null!==a&&(r.expectedCount=a)}else if(t.snapshotVersion.compareTo(be.min())>0){r.readTime=Ps(e,t.snapshotVersion.toTimestamp());const a=Ds(e,t.expectedCount);null!==a&&(r.expectedCount=a)}return r}(this.serializer,e);const r=function(e,t){const r=function(e){switch(e){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return D(28987,{purpose:e})}}(t.purpose);return null==r?null:{"goog-listen-tags":r}}(this.serializer,e);r&&(t.labels=r),this.q_(t)}Z_(e){const t={};t.database=Hs(this.serializer),t.removeTarget=e,this.q_(t)}}class Kl extends Gl{constructor(e,t,r,a,n,s){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,a,s),this.serializer=n}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return F(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,F(!e.writeResults||0===e.writeResults.length,55816),this.listener.ta()}onNext(e){F(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=function(e,t){return e&&e.length>0?(F(void 0!==t,14353),e.map(e=>function(e,t){let r=e.updateTime?Ms(e.updateTime):Ms(t);return r.isEqual(be.min())&&(r=Ms(t)),new Vn(r,e.transformResults||[])}(e,t))):[]}(e.writeResults,e.commitTime),r=Ms(e.commitTime);return this.listener.na(r,t)}ra(){const e={};e.database=Hs(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map(e=>Qs(this.serializer,e))};this.q_(t)}}class Ql{}class Yl extends Ql{constructor(e,t,r,a){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=a,this.ia=!1}sa(){if(this.ia)throw new R(M.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,r,a){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(n=>{let[s,i]=n;return this.connection.Go(e,Os(t,r),a,s,i)}).catch(e=>{throw"FirebaseError"===e.name?(e.code===M.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new R(M.UNKNOWN,e.toString())})}Ho(e,t,r,a,n){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(s=>{let[i,o]=s;return this.connection.Ho(e,Os(t,r),a,i,o,n)}).catch(e=>{throw"FirebaseError"===e.name?(e.code===M.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new R(M.UNKNOWN,e.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class Xl{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){0===this.oa&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){"Online"===this.state?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la("Connection failed 1 times. Most recent error: ".concat(e.toString())),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,"Online"===e&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t="Could not reach Cloud Firestore backend. ".concat(e,"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.");this.aa?(C(t),this.aa=!1):A("OnlineStateTracker",t)}Pa(){null!==this._a&&(this._a.cancel(),this._a=null)}}const Jl="RemoteStore";class Zl{constructor(e,t,r,a,n){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=n,this.Aa.Oo(e=>{r.enqueueAndForget(async()=>{oc(this)&&(A(Jl,"Restarting streams for network reachability change."),await async function(e){const t=L(e);t.Ea.add(4),await ec(t),t.Ra.set("Unknown"),t.Ea.delete(4),await $l(t)}(this))})}),this.Ra=new Xl(r,a)}}async function $l(e){if(oc(e))for(const t of e.da)await t(!0)}async function ec(e){for(const t of e.da)await t(!1)}function tc(e,t){const r=L(e);r.Ia.has(t.targetId)||(r.Ia.set(t.targetId,t),ic(r)?sc(r):_c(r).O_()&&ac(r,t))}function rc(e,t){const r=L(e),a=_c(r);r.Ia.delete(t),a.O_()&&nc(r,t),0===r.Ia.size&&(a.O_()?a.L_():oc(r)&&r.Ra.set("Unknown"))}function ac(e,t){if(e.Va.Ue(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(be.min())>0){const r=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(r)}_c(e).Y_(t)}function nc(e,t){e.Va.Ue(t),_c(e).Z_(t)}function sc(e){e.Va=new Ss({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),At:t=>e.Ia.get(t)||null,ht:()=>e.datastore.serializer.databaseId}),_c(e).start(),e.Ra.ua()}function ic(e){return oc(e)&&!_c(e).x_()&&e.Ia.size>0}function oc(e){return 0===L(e).Ea.size}function lc(e){e.Va=void 0}async function cc(e){e.Ra.set("Online")}async function dc(e){e.Ia.forEach((t,r)=>{ac(e,t)})}async function uc(e,t){lc(e),ic(e)?(e.Ra.ha(t),sc(e)):e.Ra.set("Unknown")}async function hc(e,t,r){if(e.Ra.set("Online"),t instanceof Ns&&2===t.state&&t.cause)try{await async function(e,t){const r=t.cause;for(const a of t.targetIds)e.Ia.has(a)&&(await e.remoteSyncer.rejectListen(a,r),e.Ia.delete(a),e.Va.removeTarget(a))}(e,t)}catch(r){A(Jl,"Failed to remove targets %s: %s ",t.targetIds.join(","),r),await mc(e,r)}else if(t instanceof ws?e.Va.Ze(t):t instanceof ks?e.Va.st(t):e.Va.tt(t),!r.isEqual(be.min()))try{const t=await bl(e.localStore);r.compareTo(t)>=0&&await function(e,t){const r=e.Va.Tt(t);return r.targetChanges.forEach((r,a)=>{if(r.resumeToken.approximateByteSize()>0){const n=e.Ia.get(a);n&&e.Ia.set(a,n.withResumeToken(r.resumeToken,t))}}),r.targetMismatches.forEach((t,r)=>{const a=e.Ia.get(t);if(!a)return;e.Ia.set(t,a.withResumeToken(Nr.EMPTY_BYTE_STRING,a.snapshotVersion)),nc(e,t);const n=new li(a.target,t,r,a.sequenceNumber);ac(e,n)}),e.remoteSyncer.applyRemoteEvent(r)}(e,r)}catch(t){A(Jl,"Failed to raise snapshot:",t),await mc(e,t)}}async function mc(e,t,r){if(!Ue(t))throw t;e.Ea.add(1),await ec(e),e.Ra.set("Offline"),r||(r=()=>bl(e.localStore)),e.asyncQueue.enqueueRetryable(async()=>{A(Jl,"Retrying IndexedDB access"),await r(),e.Ea.delete(1),await $l(e)})}function fc(e,t){return t().catch(r=>mc(e,r,t))}async function gc(e){const t=L(e),r=Ec(t);let a=t.Ta.length>0?t.Ta[t.Ta.length-1].batchId:Xe;for(;pc(t);)try{const e=await kl(t.localStore,a);if(null===e){0===t.Ta.length&&r.L_();break}a=e.batchId,xc(t,e)}catch(e){await mc(t,e)}yc(t)&&vc(t)}function pc(e){return oc(e)&&e.Ta.length<10}function xc(e,t){e.Ta.push(t);const r=Ec(e);r.O_()&&r.X_&&r.ea(t.mutations)}function yc(e){return oc(e)&&!Ec(e).x_()&&e.Ta.length>0}function vc(e){Ec(e).start()}async function bc(e){Ec(e).ra()}async function wc(e){const t=Ec(e);for(const r of e.Ta)t.ea(r.mutations)}async function kc(e,t,r){const a=e.Ta.shift(),n=ss.from(a,t,r);await fc(e,()=>e.remoteSyncer.applySuccessfulWrite(n)),await gc(e)}async function Nc(e,t){t&&Ec(e).X_&&await async function(e,t){if(function(e){return ds(e)&&e!==M.ABORTED}(t.code)){const r=e.Ta.shift();Ec(e).B_(),await fc(e,()=>e.remoteSyncer.rejectFailedWrite(r.batchId,t)),await gc(e)}}(e,t),yc(e)&&vc(e)}async function jc(e,t){const r=L(e);r.asyncQueue.verifyOperationInProgress(),A(Jl,"RemoteStore received new credentials");const a=oc(r);r.Ea.add(3),await ec(r),a&&r.Ra.set("Unknown"),await r.remoteSyncer.handleCredentialChange(t),r.Ea.delete(3),await $l(r)}async function Sc(e,t){const r=L(e);t?(r.Ea.delete(2),await $l(r)):t||(r.Ea.add(2),await ec(r),r.Ra.set("Unknown"))}function _c(e){return e.ma||(e.ma=function(e,t,r){const a=L(e);return a.sa(),new Wl(t,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,r)}(e.datastore,e.asyncQueue,{Xo:cc.bind(null,e),t_:dc.bind(null,e),r_:uc.bind(null,e),H_:hc.bind(null,e)}),e.da.push(async t=>{t?(e.ma.B_(),ic(e)?sc(e):e.Ra.set("Unknown")):(await e.ma.stop(),lc(e))})),e.ma}function Ec(e){return e.fa||(e.fa=function(e,t,r){const a=L(e);return a.sa(),new Kl(t,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,r)}(e.datastore,e.asyncQueue,{Xo:()=>Promise.resolve(),t_:bc.bind(null,e),r_:Nc.bind(null,e),ta:wc.bind(null,e),na:kc.bind(null,e)}),e.da.push(async t=>{t?(e.fa.B_(),await gc(e)):(await e.fa.stop(),e.Ta.length>0&&(A(Jl,"Stopping write stream with ".concat(e.Ta.length," pending writes")),e.Ta=[]))})),e.fa}class Ac{constructor(e,t,r,a,n){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=a,this.removalCallback=n,this.deferred=new O,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(e=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,a,n){const s=Date.now()+r,i=new Ac(e,t,s,a,n);return i.start(r),i}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new R(M.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Cc(e,t){if(C("AsyncQueue","".concat(t,": ").concat(e)),Ue(e))return new R(M.UNAVAILABLE,"".concat(t,": ").concat(e));throw e}class Ic{static emptySet(e){return new Ic(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||oe.comparator(t.key,r.key):(e,t)=>oe.comparator(e.key,t.key),this.keyedMap=pn(),this.sortedSet=new gr(this.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Ic))return!1;if(this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const e=t.getNext().key,a=r.getNext().key;if(!e.isEqual(a))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const r=new Ic;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}class Tc{constructor(){this.ga=new gr(oe.comparator)}track(e){const t=e.doc.key,r=this.ga.get(t);r?0!==e.type&&3===r.type?this.ga=this.ga.insert(t,e):3===e.type&&1!==r.type?this.ga=this.ga.insert(t,{type:r.type,doc:e.doc}):2===e.type&&2===r.type?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):2===e.type&&0===r.type?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):1===e.type&&0===r.type?this.ga=this.ga.remove(t):1===e.type&&2===r.type?this.ga=this.ga.insert(t,{type:1,doc:r.doc}):0===e.type&&1===r.type?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):D(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal((t,r)=>{e.push(r)}),e}}class Dc{constructor(e,t,r,a,n,s,i,o,l){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=a,this.mutatedKeys=n,this.fromCache=s,this.syncStateChanged=i,this.excludesMetadataChanges=o,this.hasCachedResults=l}static fromInitialDocuments(e,t,r,a,n){const s=[];return t.forEach(e=>{s.push({type:0,doc:e})}),new Dc(e,t,Ic.emptySet(t),s,r,a,!0,!1,n)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&nn(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let a=0;a<t.length;a++)if(t[a].type!==r[a].type||!t[a].doc.isEqual(r[a].doc))return!1;return!0}}class Pc{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class Fc{constructor(){this.queries=Lc(),this.onlineState="Unknown",this.Ca=new Set}terminate(){!function(e,t){const r=L(e),a=r.queries;r.queries=Lc(),a.forEach((e,r)=>{for(const a of r.Sa)a.onError(t)})}(this,new R(M.ABORTED,"Firestore shutting down"))}}function Lc(){return new hn(e=>sn(e),nn)}async function Mc(e,t){const r=L(e);let a=3;const n=t.query;let s=r.queries.get(n);s?!s.ba()&&t.Da()&&(a=2):(s=new Pc,a=t.Da()?0:1);try{switch(a){case 0:s.wa=await r.onListen(n,!0);break;case 1:s.wa=await r.onListen(n,!1);break;case 2:await r.onFirstRemoteStoreListen(n)}}catch(e){const r=Cc(e,"Initialization of query '".concat(on(t.query),"' failed"));return void t.onError(r)}r.queries.set(n,s),s.Sa.push(t),t.va(r.onlineState),s.wa&&t.Fa(s.wa)&&zc(r)}async function Rc(e,t){const r=L(e),a=t.query;let n=3;const s=r.queries.get(a);if(s){const e=s.Sa.indexOf(t);e>=0&&(s.Sa.splice(e,1),0===s.Sa.length?n=t.Da()?0:1:!s.ba()&&t.Da()&&(n=2))}switch(n){case 0:return r.queries.delete(a),r.onUnlisten(a,!0);case 1:return r.queries.delete(a),r.onUnlisten(a,!1);case 2:return r.onLastRemoteStoreUnlisten(a);default:return}}function Oc(e,t){const r=L(e);let a=!1;for(const n of t){const e=n.query,t=r.queries.get(e);if(t){for(const e of t.Sa)e.Fa(n)&&(a=!0);t.wa=n}}a&&zc(r)}function Bc(e,t,r){const a=L(e),n=a.queries.get(t);if(n)for(const s of n.Sa)s.onError(r);a.queries.delete(t)}function zc(e){e.Ca.forEach(e=>{e.next()})}var Uc,Vc;(Vc=Uc||(Uc={})).Ma="default",Vc.Cache="cache";class qc{constructor(e,t,r){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const t=[];for(const r of e.docChanges)3!==r.type&&t.push(r);e=new Dc(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache)return!0;if(!this.Da())return!0;const r="Offline"!==t;return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}ka(e){e=Dc.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Uc.Cache}}class Hc{constructor(e){this.key=e}}class Gc{constructor(e){this.key=e}}class Wc{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Nn(),this.mutatedKeys=Nn(),this.eu=dn(e),this.tu=new Ic(this.eu)}get nu(){return this.Ya}ru(e,t){const r=t?t.iu:new Tc,a=t?t.tu:this.tu;let n=t?t.mutatedKeys:this.mutatedKeys,s=a,i=!1;const o="F"===this.query.limitType&&a.size===this.query.limit?a.last():null,l="L"===this.query.limitType&&a.size===this.query.limit?a.first():null;if(e.inorderTraversal((e,t)=>{const c=a.get(e),d=ln(this.query,t)?t:null,u=!!c&&this.mutatedKeys.has(c.key),h=!!d&&(d.hasLocalMutations||this.mutatedKeys.has(d.key)&&d.hasCommittedMutations);let m=!1;c&&d?c.data.isEqual(d.data)?u!==h&&(r.track({type:3,doc:d}),m=!0):this.su(c,d)||(r.track({type:2,doc:d}),m=!0,(o&&this.eu(d,o)>0||l&&this.eu(d,l)<0)&&(i=!0)):!c&&d?(r.track({type:0,doc:d}),m=!0):c&&!d&&(r.track({type:1,doc:c}),m=!0,(o||l)&&(i=!0)),m&&(d?(s=s.add(d),n=h?n.add(e):n.delete(e)):(s=s.delete(e),n=n.delete(e)))}),null!==this.query.limit)for(;s.size>this.query.limit;){const e="F"===this.query.limitType?s.last():s.first();s=s.delete(e.key),n=n.delete(e.key),r.track({type:1,doc:e})}return{tu:s,iu:r,Cs:i,mutatedKeys:n}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,a){const n=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const s=e.iu.ya();s.sort((e,t)=>function(e,t){const r=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return D(20277,{Rt:e})}};return r(e)-r(t)}(e.type,t.type)||this.eu(e.doc,t.doc)),this.ou(r),a=null!==a&&void 0!==a&&a;const i=t&&!a?this._u():[],o=0===this.Xa.size&&this.current&&!a?1:0,l=o!==this.Za;return this.Za=o,0!==s.length||l?{snapshot:new Dc(this.query,e.tu,n,s,e.mutatedKeys,0===o,l,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:i}:{au:i}}va(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({tu:this.tu,iu:new Tc,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(e=>this.Ya=this.Ya.add(e)),e.modifiedDocuments.forEach(e=>{}),e.removedDocuments.forEach(e=>this.Ya=this.Ya.delete(e)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Nn(),this.tu.forEach(e=>{this.uu(e.key)&&(this.Xa=this.Xa.add(e.key))});const t=[];return e.forEach(e=>{this.Xa.has(e)||t.push(new Gc(e))}),this.Xa.forEach(r=>{e.has(r)||t.push(new Hc(r))}),t}cu(e){this.Ya=e.Qs,this.Xa=Nn();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return Dc.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,0===this.Za,this.hasCachedResults)}}const Kc="SyncEngine";class Qc{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class Yc{constructor(e){this.key=e,this.hu=!1}}class Xc{constructor(e,t,r,a,n,s){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=a,this.currentUser=n,this.maxConcurrentLimboResolutions=s,this.Pu={},this.Tu=new hn(e=>sn(e),nn),this.Iu=new Map,this.Eu=new Set,this.du=new gr(oe.comparator),this.Au=new Map,this.Ru=new Go,this.Vu={},this.mu=new Map,this.fu=xo.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return!0===this.gu}}async function Jc(e,t){let r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const a=yd(e);let n;const s=a.Tu.get(t);return s?(a.sharedClientState.addLocalQueryTarget(s.targetId),n=s.view.lu()):n=await $c(a,t,r,!0),n}async function Zc(e,t){const r=yd(e);await $c(r,t,!0,!1)}async function $c(e,t,r,a){const n=await Nl(e.localStore,en(t)),s=n.targetId,i=e.sharedClientState.addLocalQueryTarget(s,r);let o;return a&&(o=await ed(e,t,s,"current"===i,n.resumeToken)),e.isPrimaryClient&&r&&tc(e.remoteStore,n),o}async function ed(e,t,r,a,n){e.pu=(t,r,a)=>async function(e,t,r,a){let n=t.view.ru(r);n.Cs&&(n=await Sl(e.localStore,t.query,!1).then(e=>{let{documents:r}=e;return t.view.ru(r,n)}));const s=a&&a.targetChanges.get(t.targetId),i=a&&null!=a.targetMismatches.get(t.targetId),o=t.view.applyChanges(n,e.isPrimaryClient,s,i);return hd(e,t.targetId,o.au),o.snapshot}(e,t,r,a);const s=await Sl(e.localStore,t,!0),i=new Wc(t,s.Qs),o=i.ru(s.documents),l=bs.createSynthesizedTargetChangeForCurrentChange(r,a&&"Offline"!==e.onlineState,n),c=i.applyChanges(o,e.isPrimaryClient,l);hd(e,r,c.au);const d=new Qc(t,r,i);return e.Tu.set(t,d),e.Iu.has(r)?e.Iu.get(r).push(t):e.Iu.set(r,[t]),c.snapshot}async function td(e,t,r){const a=L(e),n=a.Tu.get(t),s=a.Iu.get(n.targetId);if(s.length>1)return a.Iu.set(n.targetId,s.filter(e=>!nn(e,t))),void a.Tu.delete(t);a.isPrimaryClient?(a.sharedClientState.removeLocalQueryTarget(n.targetId),a.sharedClientState.isActiveQueryTarget(n.targetId)||await jl(a.localStore,n.targetId,!1).then(()=>{a.sharedClientState.clearQueryState(n.targetId),r&&rc(a.remoteStore,n.targetId),dd(a,n.targetId)}).catch(Pe)):(dd(a,n.targetId),await jl(a.localStore,n.targetId,!0))}async function rd(e,t){const r=L(e),a=r.Tu.get(t),n=r.Iu.get(a.targetId);r.isPrimaryClient&&1===n.length&&(r.sharedClientState.removeLocalQueryTarget(a.targetId),rc(r.remoteStore,a.targetId))}async function ad(e,t){const r=L(e);try{const e=await function(e,t){const r=L(e),a=t.snapshotVersion;let n=r.Ms;return r.persistence.runTransaction("Apply remote event","readwrite-primary",e=>{const s=r.Ns.newChangeBuffer({trackRemovals:!0});n=r.Ms;const i=[];t.targetChanges.forEach((s,o)=>{const l=n.get(o);if(!l)return;i.push(r.Pi.removeMatchingKeys(e,s.removedDocuments,o).next(()=>r.Pi.addMatchingKeys(e,s.addedDocuments,o)));let c=l.withSequenceNumber(e.currentSequenceNumber);null!==t.targetMismatches.get(o)?c=c.withResumeToken(Nr.EMPTY_BYTE_STRING,be.min()).withLastLimboFreeSnapshotVersion(be.min()):s.resumeToken.approximateByteSize()>0&&(c=c.withResumeToken(s.resumeToken,a)),n=n.insert(o,c),function(e,t,r){return 0===e.resumeToken.approximateByteSize()||(t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=pl||r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size>0)}(l,c,s)&&i.push(r.Pi.updateTargetData(e,c))});let o=fn(),l=Nn();if(t.documentUpdates.forEach(a=>{t.resolvedLimboDocuments.has(a)&&i.push(r.persistence.referenceDelegate.updateLimboDocument(e,a))}),i.push(wl(e,s,t.documentUpdates).next(e=>{o=e.ks,l=e.qs})),!a.isEqual(be.min())){const t=r.Pi.getLastRemoteSnapshotVersion(e).next(t=>r.Pi.setTargetsMetadata(e,e.currentSequenceNumber,a));i.push(t)}return Fe.waitFor(i).next(()=>s.apply(e)).next(()=>r.localDocuments.getLocalViewOfDocuments(e,o,l)).next(()=>o)}).then(e=>(r.Ms=n,e))}(r.localStore,t);t.targetChanges.forEach((e,t)=>{const a=r.Au.get(t);a&&(F(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1,22616),e.addedDocuments.size>0?a.hu=!0:e.modifiedDocuments.size>0?F(a.hu,14607):e.removedDocuments.size>0&&(F(a.hu,42227),a.hu=!1))}),await gd(r,e,t)}catch(e){await Pe(e)}}function nd(e,t,r){const a=L(e);if(a.isPrimaryClient&&0===r||!a.isPrimaryClient&&1===r){const e=[];a.Tu.forEach((r,a)=>{const n=a.view.va(t);n.snapshot&&e.push(n.snapshot)}),function(e,t){const r=L(e);r.onlineState=t;let a=!1;r.queries.forEach((e,r)=>{for(const n of r.Sa)n.va(t)&&(a=!0)}),a&&zc(r)}(a.eventManager,t),e.length&&a.Pu.H_(e),a.onlineState=t,a.isPrimaryClient&&a.sharedClientState.setOnlineState(t)}}async function sd(e,t,r){const a=L(e);a.sharedClientState.updateQueryState(t,"rejected",r);const n=a.Au.get(t),s=n&&n.key;if(s){let e=new gr(oe.comparator);e=e.insert(s,ga.newNoDocument(s,be.min()));const r=Nn().add(s),n=new vs(be.min(),new Map,new gr(Y),e,r);await ad(a,n),a.du=a.du.remove(s),a.Au.delete(t),fd(a)}else await jl(a.localStore,t,!1).then(()=>dd(a,t,r)).catch(Pe)}async function id(e,t){const r=L(e),a=t.batch.batchId;try{const e=await function(e,t){const r=L(e);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",e=>{const a=t.batch.keys(),n=r.Ns.newChangeBuffer({trackRemovals:!0});return function(e,t,r,a){const n=r.batch,s=n.keys();let i=Fe.resolve();return s.forEach(e=>{i=i.next(()=>a.getEntry(t,e)).next(t=>{const s=r.docVersions.get(e);F(null!==s,48541),t.version.compareTo(s)<0&&(n.applyToRemoteDocument(t,r),t.isValidDocument()&&(t.setReadTime(r.commitVersion),a.addEntry(t)))})}),i.next(()=>e.mutationQueue.removeMutationBatch(t,n))}(r,e,t,n).next(()=>n.apply(e)).next(()=>r.mutationQueue.performConsistencyCheck(e)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(e,a,t.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){let t=Nn();for(let r=0;r<e.mutationResults.length;++r)e.mutationResults[r].transformResults.length>0&&(t=t.add(e.batch.mutations[r].key));return t}(t))).next(()=>r.localDocuments.getDocuments(e,a))})}(r.localStore,t);cd(r,a,null),ld(r,a),r.sharedClientState.updateMutationState(a,"acknowledged"),await gd(r,e)}catch(e){await Pe(e)}}async function od(e,t,r){const a=L(e);try{const e=await function(e,t){const r=L(e);return r.persistence.runTransaction("Reject batch","readwrite-primary",e=>{let a;return r.mutationQueue.lookupMutationBatch(e,t).next(t=>(F(null!==t,37113),a=t.keys(),r.mutationQueue.removeMutationBatch(e,t))).next(()=>r.mutationQueue.performConsistencyCheck(e)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(e,a,t)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,a)).next(()=>r.localDocuments.getDocuments(e,a))})}(a.localStore,t);cd(a,t,r),ld(a,t),a.sharedClientState.updateMutationState(t,"rejected",r),await gd(a,e)}catch(r){await Pe(r)}}function ld(e,t){(e.mu.get(t)||[]).forEach(e=>{e.resolve()}),e.mu.delete(t)}function cd(e,t,r){const a=L(e);let n=a.Vu[a.currentUser.toKey()];if(n){const e=n.get(t);e&&(r?e.reject(r):e.resolve(),n=n.remove(t)),a.Vu[a.currentUser.toKey()]=n}}function dd(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e.sharedClientState.removeLocalQueryTarget(t);for(const a of e.Iu.get(t))e.Tu.delete(a),r&&e.Pu.yu(a,r);e.Iu.delete(t),e.isPrimaryClient&&e.Ru.jr(t).forEach(t=>{e.Ru.containsKey(t)||ud(e,t)})}function ud(e,t){e.Eu.delete(t.path.canonicalString());const r=e.du.get(t);null!==r&&(rc(e.remoteStore,r),e.du=e.du.remove(t),e.Au.delete(r),fd(e))}function hd(e,t,r){for(const a of r)a instanceof Hc?(e.Ru.addReference(a.key,t),md(e,a)):a instanceof Gc?(A(Kc,"Document no longer in limbo: "+a.key),e.Ru.removeReference(a.key,t),e.Ru.containsKey(a.key)||ud(e,a.key)):D(19791,{wu:a})}function md(e,t){const r=t.key,a=r.path.canonicalString();e.du.get(r)||e.Eu.has(a)||(A(Kc,"New document in limbo: "+r),e.Eu.add(a),fd(e))}function fd(e){for(;e.Eu.size>0&&e.du.size<e.maxConcurrentLimboResolutions;){const t=e.Eu.values().next().value;e.Eu.delete(t);const r=new oe(ne.fromString(t)),a=e.fu.next();e.Au.set(a,new Yc(r)),e.du=e.du.insert(r,a),tc(e.remoteStore,new li(en(Xa(r.path)),a,"TargetPurposeLimboResolution",Ye.ce))}}async function gd(e,t,r){const a=L(e),n=[],s=[],i=[];a.Tu.isEmpty()||(a.Tu.forEach((e,o)=>{i.push(a.pu(o,t,r).then(e=>{if((e||r)&&a.isPrimaryClient){var t;const n=e?!e.fromCache:null===r||void 0===r||null===(t=r.targetChanges.get(o.targetId))||void 0===t?void 0:t.current;a.sharedClientState.updateQueryState(o.targetId,n?"current":"not-current")}if(e){n.push(e);const t=hl.As(o.targetId,e);s.push(t)}}))}),await Promise.all(i),a.Pu.H_(n),await async function(e,t){const r=L(e);try{await r.persistence.runTransaction("notifyLocalViewChanges","readwrite",e=>Fe.forEach(t,t=>Fe.forEach(t.Es,a=>r.persistence.referenceDelegate.addReference(e,t.targetId,a)).next(()=>Fe.forEach(t.ds,a=>r.persistence.referenceDelegate.removeReference(e,t.targetId,a)))))}catch(e){if(!Ue(e))throw e;A(gl,"Failed to update sequence numbers: "+e)}for(const a of t){const e=a.targetId;if(!a.fromCache){const t=r.Ms.get(e),a=t.snapshotVersion,n=t.withLastLimboFreeSnapshotVersion(a);r.Ms=r.Ms.insert(e,n)}}}(a.localStore,s))}async function pd(e,t){const r=L(e);if(!r.currentUser.isEqual(t)){A(Kc,"User change. New user:",t.toKey());const e=await vl(r.localStore,t);r.currentUser=t,function(e,t){e.mu.forEach(e=>{e.forEach(e=>{e.reject(new R(M.CANCELLED,t))})}),e.mu.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(t,e.removedBatchIds,e.addedBatchIds),await gd(r,e.Ls)}}function xd(e,t){const r=L(e),a=r.Au.get(t);if(a&&a.hu)return Nn().add(a.key);{let e=Nn();const a=r.Iu.get(t);if(!a)return e;for(const t of a){const a=r.Tu.get(t);e=e.unionWith(a.view.nu)}return e}}function yd(e){const t=L(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=ad.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=xd.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=sd.bind(null,t),t.Pu.H_=Oc.bind(null,t.eventManager),t.Pu.yu=Bc.bind(null,t.eventManager),t}function vd(e){const t=L(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=id.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=od.bind(null,t),t}class bd{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Vl(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return yl(this.persistence,new fl,e.initialUser,this.serializer)}Cu(e){return new Jo($o.mi,this.serializer)}Du(e){return new Al}async terminate(){var e,t;null!==(e=this.gcScheduler)&&void 0!==e&&e.stop(),null!==(t=this.indexBackfillerScheduler)&&void 0!==t&&t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}bd.provider={build:()=>new bd};class wd extends bd{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){F(this.persistence.referenceDelegate instanceof el,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new _o(r,e.asyncQueue,t)}Cu(e){const t=void 0!==this.cacheSizeBytes?lo.withCacheSize(this.cacheSizeBytes):lo.DEFAULT;return new Jo(e=>el.mi(e,t),this.serializer)}}class kd extends bd{constructor(e,t,r){super(),this.xu=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await vd(this.xu.syncEngine),await gc(this.xu.remoteStore),await this.persistence.Ji(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}vu(e){return yl(this.persistence,new fl,e.initialUser,this.serializer)}Fu(e,t){const r=this.persistence.referenceDelegate.garbageCollector;return new _o(r,e.asyncQueue,t)}Mu(e,t){const r=new Qe(t,this.persistence);return new Ke(e.asyncQueue,r)}Cu(e){const t=ul(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=void 0!==this.cacheSizeBytes?lo.withCacheSize(this.cacheSizeBytes):lo.DEFAULT;return new ll(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,zl(),Ul(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new Al}}class Nd{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>nd(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=pd.bind(null,this.syncEngine),await Sc(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new Fc}createDatastore(e){const t=Vl(e.databaseInfo.databaseId),r=function(e){return new Bl(e)}(e.databaseInfo);return function(e,t,r,a){return new Yl(e,t,r,a)}(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return function(e,t,r,a,n){return new Zl(e,t,r,a,n)}(this.localStore,this.datastore,e.asyncQueue,e=>nd(this.syncEngine,e,0),Tl.v()?new Tl:new Cl)}createSyncEngine(e,t){return function(e,t,r,a,n,s,i){const o=new Xc(e,t,r,a,n,s);return i&&(o.gu=!0),o}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(e){const t=L(e);A(Jl,"RemoteStore shutting down."),t.Ea.add(5),await ec(t),t.Aa.shutdown(),t.Ra.set("Unknown")}(this.remoteStore),null!==(e=this.datastore)&&void 0!==e&&e.terminate(),null===(t=this.eventManager)||void 0===t||t.terminate()}}Nd.provider={build:()=>new Nd};class jd{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):C("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout(()=>{this.muted||e(t)},0)}}const Sd="FirestoreClient";class _d{constructor(e,t,r,a,n){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=a,this.user=j.UNAUTHENTICATED,this.clientId=Q.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=n,this.authCredentials.start(r,async e=>{A(Sd,"Received user=",e.uid),await this.authCredentialListener(e),this.user=e}),this.appCheckCredentials.start(r,e=>(A(Sd,"Received new app check token=",e),this.appCheckCredentialListener(e,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new O;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=Cc(t,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function Ed(e,t){e.asyncQueue.verifyOperationInProgress(),A(Sd,"Initializing OfflineComponentProvider");const r=e.configuration;await t.initialize(r);let a=r.initialUser;e.setCredentialChangeListener(async e=>{a.isEqual(e)||(await vl(t.localStore,e),a=e)}),t.persistence.setDatabaseDeletedListener(()=>e.terminate()),e._offlineComponents=t}async function Ad(e,t){e.asyncQueue.verifyOperationInProgress();const r=await Cd(e);A(Sd,"Initializing OnlineComponentProvider"),await t.initialize(r,e.configuration),e.setCredentialChangeListener(e=>jc(t.remoteStore,e)),e.setAppCheckTokenChangeListener((e,r)=>jc(t.remoteStore,r)),e._onlineComponents=t}async function Cd(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){A(Sd,"Using user provided OfflineComponentProvider");try{await Ed(e,e._uninitializedComponentsProvider._offline)}catch(t){const r=t;if(!function(e){return"FirebaseError"===e.name?e.code===M.FAILED_PRECONDITION||e.code===M.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||22===e.code||20===e.code||11===e.code}(r))throw r;I("Error using user provided cache. Falling back to memory cache: "+r),await Ed(e,new bd)}}else A(Sd,"Using default OfflineComponentProvider"),await Ed(e,new wd(void 0));return e._offlineComponents}async function Id(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(A(Sd,"Using user provided OnlineComponentProvider"),await Ad(e,e._uninitializedComponentsProvider._online)):(A(Sd,"Using default OnlineComponentProvider"),await Ad(e,new Nd))),e._onlineComponents}function Td(e){return Id(e).then(e=>e.syncEngine)}async function Dd(e){const t=await Id(e),r=t.eventManager;return r.onListen=Jc.bind(null,t.syncEngine),r.onUnlisten=td.bind(null,t.syncEngine),r.onFirstRemoteStoreListen=Zc.bind(null,t.syncEngine),r.onLastRemoteStoreUnlisten=rd.bind(null,t.syncEngine),r}function Pd(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const a=new O;return e.asyncQueue.enqueueAndForget(async()=>function(e,t,r,a,n){const s=new jd({next:o=>{s.Nu(),t.enqueueAndForget(()=>Rc(e,i));const l=o.docs.has(r);!l&&o.fromCache?n.reject(new R(M.UNAVAILABLE,"Failed to get document because the client is offline.")):l&&o.fromCache&&a&&"server"===a.source?n.reject(new R(M.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):n.resolve(o)},error:e=>n.reject(e)}),i=new qc(Xa(r.path),s,{includeMetadataChanges:!0,qa:!0});return Mc(e,i)}(await Dd(e),e.asyncQueue,t,r,a)),a.promise}function Fd(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const a=new O;return e.asyncQueue.enqueueAndForget(async()=>function(e,t,r,a,n){const s=new jd({next:r=>{s.Nu(),t.enqueueAndForget(()=>Rc(e,i)),r.fromCache&&"server"===a.source?n.reject(new R(M.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):n.resolve(r)},error:e=>n.reject(e)}),i=new qc(r,s,{includeMetadataChanges:!0,qa:!0});return Mc(e,i)}(await Dd(e),e.asyncQueue,t,r,a)),a.promise}function Ld(e){const t={};return void 0!==e.timeoutSeconds&&(t.timeoutSeconds=e.timeoutSeconds),t}const Md=new Map,Rd="firestore.googleapis.com",Od=!0;class Bd{constructor(e){var t,r;if(void 0===e.host){if(void 0!==e.ssl)throw new R(M.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Rd,this.ssl=Od}else this.host=e.host,this.ssl=null!==(t=e.ssl)&&void 0!==t?t:Od;if(this.isUsingEmulator=void 0!==e.emulatorOptions,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=oo;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<No)throw new R(M.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}(function(e,t,r,a){if(!0===t&&!0===a)throw new R(M.INVALID_ARGUMENT,"".concat(e," and ").concat(r," cannot be used together."))})("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===e.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Ld(null!==(r=e.experimentalLongPollingOptions)&&void 0!==r?r:{}),function(e){if(void 0!==e.timeoutSeconds){if(isNaN(e.timeoutSeconds))throw new R(M.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(e.timeoutSeconds," (must not be NaN)"));if(e.timeoutSeconds<5)throw new R(M.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(e.timeoutSeconds," (minimum allowed value is 5)"));if(e.timeoutSeconds>30)throw new R(M.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(e.timeoutSeconds," (maximum allowed value is 30)"))}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(e,t){return e.timeoutSeconds===t.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class zd{constructor(e,t,r,a){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=a,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Bd({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new R(M.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return"notTerminated"!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new R(M.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Bd(e),this._emulatorOptions=e.emulatorOptions||{},void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new z;switch(e.type){case"firstParty":return new H(e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new R(M.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return"notTerminated"===this._terminateTask&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){"notTerminated"===this._terminateTask?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=Md.get(e);t&&(A("ComponentProvider","Removing Datastore"),Md.delete(e),t.terminate())}(this),Promise.resolve()}}class Ud{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Ud(this.firestore,e,this._query)}}class Vd{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new qd(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Vd(this.firestore,e,this._key)}toJSON(){return{type:Vd._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if(pe(t,Vd._jsonSchema))return new Vd(e,r||null,new oe(ne.fromString(t.referencePath)))}}Vd._jsonSchemaVersion="firestore/documentReference/1.0",Vd._jsonSchema={type:ge("string",Vd._jsonSchemaVersion),referencePath:ge("string")};class qd extends Ud{constructor(e,t,r){super(e,t,Xa(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Vd(this.firestore,null,new oe(e))}withConverter(e){return new qd(this.firestore,e,this._path)}}function Hd(e,t){for(var r=arguments.length,a=new Array(r>2?r-2:0),n=2;n<r;n++)a[n-2]=arguments[n];if(e=(0,c.Ku)(e),le("collection","path",t),e instanceof zd){const r=ne.fromString(t,...a);return de(r),new qd(e,null,r)}{if(!(e instanceof Vd||e instanceof qd))throw new R(M.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=e._path.child(ne.fromString(t,...a));return de(r),new qd(e.firestore,null,r)}}function Gd(e,t){for(var r=arguments.length,a=new Array(r>2?r-2:0),n=2;n<r;n++)a[n-2]=arguments[n];if(e=(0,c.Ku)(e),1===arguments.length&&(t=Q.newId()),le("doc","path",t),e instanceof zd){const r=ne.fromString(t,...a);return ce(r),new Vd(e,null,new oe(r))}{if(!(e instanceof Vd||e instanceof qd))throw new R(M.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=e._path.child(ne.fromString(t,...a));return ce(r),new Vd(e.firestore,e instanceof qd?e.converter:null,new oe(r))}}const Wd="AsyncQueue";class Kd{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Promise.resolve();this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new ql(this,"async_queue_retry"),this._c=()=>{const e=Ul();e&&A(Wd,"Visibility state changed to "+e.visibilityState),this.M_.w_()},this.ac=e;const t=Ul();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=Ul();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const t=new O;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(0!==this.Xu.length){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Ue(e))throw e;A(Wd,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const t=this.ac.then(()=>(this.rc=!0,e().catch(e=>{throw this.nc=e,this.rc=!1,C("INTERNAL UNHANDLED ERROR: ",Qd(e)),e}).then(e=>(this.rc=!1,e))));return this.ac=t,t}enqueueAfterDelay(e,t,r){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const a=Ac.createAndSchedule(this,e,t,r,e=>this.hc(e));return this.tc.push(a),a}uc(){this.nc&&D(47125,{Pc:Qd(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do{e=this.ac,await e}while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((e,t)=>e.targetTimeMs-t.targetTimeMs);for(const t of this.tc)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function Qd(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}function Yd(e){return function(e,t){if("object"!=typeof e||null===e)return!1;const r=e;for(const a of t)if(a in r&&"function"==typeof r[a])return!0;return!1}(e,["next","error","complete"])}class Xd extends zd{constructor(e,t,r,a){super(e,t,r,a),this.type="firestore",this._queue=new Kd,this._persistenceKey=(null===a||void 0===a?void 0:a.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Kd(e),this._firestoreClient=void 0,await e}}}function Jd(e,t){const r="object"==typeof e?e:(0,i.Sx)(),a="string"==typeof e?e:t||Mr,n=(0,i.j6)(r,"firestore").getImmediate({identifier:a});if(!n._initialized){const e=(0,c.yU)("firestore");e&&function(e,t,r){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};e=me(e,zd);const n=(0,c.zJ)(t),i=e._getSettings(),o=(0,s.A)((0,s.A)({},i),{},{emulatorOptions:e._getEmulatorOptions()}),l="".concat(t,":").concat(r);n&&((0,c.gE)("https://".concat(l)),(0,c.P1)("Firestore",!0)),i.host!==Rd&&i.host!==l&&I("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const d=(0,s.A)((0,s.A)({},i),{},{host:l,ssl:n,emulatorOptions:a});if(!(0,c.bD)(d,o)&&(e._setSettings(d),a.mockUserToken)){let t,r;if("string"==typeof a.mockUserToken)t=a.mockUserToken,r=j.MOCK_USER;else{var u;t=(0,c.Fy)(a.mockUserToken,null===(u=e._app)||void 0===u?void 0:u.options.projectId);const n=a.mockUserToken.sub||a.mockUserToken.user_id;if(!n)throw new R(M.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");r=new j(n)}e._authCredentials=new U(new B(t,r))}}(n,...e)}return n}function Zd(e){if(e._terminated)throw new R(M.FAILED_PRECONDITION,"The client has already been terminated.");return e._firestoreClient||$d(e),e._firestoreClient}function $d(e){var t,r,a;const n=e._freezeSettings(),s=function(e,t,r,a){return new Lr(e,t,r,a.host,a.ssl,a.experimentalForceLongPolling,a.experimentalAutoDetectLongPolling,Ld(a.experimentalLongPollingOptions),a.useFetchStreams,a.isUsingEmulator)}(e._databaseId,(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",e._persistenceKey,n);e._componentsProvider||null!==(r=n.localCache)&&void 0!==r&&r._offlineComponentProvider&&null!==(a=n.localCache)&&void 0!==a&&a._onlineComponentProvider&&(e._componentsProvider={_offline:n.localCache._offlineComponentProvider,_online:n.localCache._onlineComponentProvider}),e._firestoreClient=new _d(e._authCredentials,e._appCheckCredentials,e._queue,s,e._componentsProvider&&function(e){const t=null===e||void 0===e?void 0:e._online.build();return{_offline:null===e||void 0===e?void 0:e._offline.build(t),_online:t}}(e._componentsProvider))}function eu(e,t){I("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const r=e._freezeSettings();return tu(e,Nd.provider,{build:e=>new kd(e,r.cacheSizeBytes,null===t||void 0===t?void 0:t.forceOwnership)}),Promise.resolve()}function tu(e,t,r){if((e=me(e,Xd))._firestoreClient||e._terminated)throw new R(M.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(e._componentsProvider||e._getSettings().localCache)throw new R(M.FAILED_PRECONDITION,"SDK cache is already specified.");e._componentsProvider={_online:t,_offline:r},$d(e)}class ru{constructor(e){this._byteString=e}static fromBase64String(e){try{return new ru(Nr.fromBase64String(e))}catch(e){throw new R(M.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(e){return new ru(Nr.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:ru._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(pe(e,ru._jsonSchema))return ru.fromBase64String(e.bytes)}}ru._jsonSchemaVersion="firestore/bytes/1.0",ru._jsonSchema={type:ge("string",ru._jsonSchemaVersion),bytes:ge("string")};class au{constructor(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];for(let a=0;a<t.length;++a)if(0===t[a].length)throw new R(M.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ie(t)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class nu{constructor(e){this._methodName=e}}class su{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new R(M.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new R(M.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Y(this._lat,e._lat)||Y(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:su._jsonSchemaVersion}}static fromJSON(e){if(pe(e,su._jsonSchema))return new su(e.latitude,e.longitude)}}su._jsonSchemaVersion="firestore/geoPoint/1.0",su._jsonSchema={type:ge("string",su._jsonSchemaVersion),latitude:ge("number"),longitude:ge("number")};class iu{constructor(e){this._values=(e||[]).map(e=>e)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;++r)if(e[r]!==t[r])return!1;return!0}(this._values,e._values)}toJSON(){return{type:iu._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(pe(e,iu._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(e=>"number"==typeof e))return new iu(e.vectorValues);throw new R(M.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}iu._jsonSchemaVersion="firestore/vectorValue/1.0",iu._jsonSchema={type:ge("string",iu._jsonSchemaVersion),vectorValues:ge("object")};const ou=/^__.*__$/;class lu{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return null!==this.fieldMask?new Zn(e,this.data,this.fieldMask,t,this.fieldTransforms):new Jn(e,this.data,t,this.fieldTransforms)}}class cu{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new Zn(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function du(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw D(40011,{Ac:e})}}class uu{constructor(e,t,r,a,n,s){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=a,void 0===n&&this.Rc(),this.fieldTransforms=n||[],this.fieldMask=s||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new uu((0,s.A)((0,s.A)({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var t;const r=null===(t=this.path)||void 0===t?void 0:t.child(e),a=this.Vc({path:r,fc:!1});return a.gc(e),a}yc(e){var t;const r=null===(t=this.path)||void 0===t?void 0:t.child(e),a=this.Vc({path:r,fc:!1});return a.Rc(),a}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Iu(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return void 0!==this.fieldMask.find(t=>e.isPrefixOf(t))||void 0!==this.fieldTransforms.find(t=>e.isPrefixOf(t.field))}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(0===e.length)throw this.Sc("Document fields must not be empty");if(du(this.Ac)&&ou.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class hu{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||Vl(e)}Cc(e,t,r){let a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return new uu({Ac:e,methodName:t,Dc:r,path:ie.emptyPath(),fc:!1,bc:a},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function mu(e){const t=e._freezeSettings(),r=Vl(e._databaseId);return new hu(e._databaseId,!!t.ignoreUndefinedProperties,r)}function fu(e,t,r,a,n){let s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};const i=e.Cc(s.merge||s.mergeFields?2:0,t,r,n);_u("Data must be an object, but it was:",i,a);const o=ju(a,i);let l,c;if(s.merge)l=new wr(i.fieldMask),c=i.fieldTransforms;else if(s.mergeFields){const e=[];for(const a of s.mergeFields){const n=Eu(t,a,r);if(!i.contains(n))throw new R(M.INVALID_ARGUMENT,"Field '".concat(n,"' is specified in your field mask but missing from your input data."));Tu(e,n)||e.push(n)}l=new wr(e),c=i.fieldTransforms.filter(e=>l.covers(e.field))}else l=null,c=i.fieldTransforms;return new lu(new ma(o),l,c)}class gu extends nu{_toFieldTransform(e){if(2!==e.Ac)throw 1===e.Ac?e.Sc("".concat(this._methodName,"() can only appear at the top level of your update data")):e.Sc("".concat(this._methodName,"() cannot be used with set() unless you pass {merge:true}"));return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof gu}}function pu(e,t,r){return new uu({Ac:3,Dc:t.settings.Dc,methodName:e._methodName,fc:r},t.databaseId,t.serializer,t.ignoreUndefinedProperties)}class xu extends nu{_toFieldTransform(e){return new Un(e.path,new Pn)}isEqual(e){return e instanceof xu}}class yu extends nu{constructor(e,t){super(e),this.vc=t}_toFieldTransform(e){const t=pu(this,e,!0),r=this.vc.map(e=>Nu(e,t)),a=new Fn(r);return new Un(e.path,a)}isEqual(e){return e instanceof yu&&(0,c.bD)(this.vc,e.vc)}}class vu extends nu{constructor(e,t){super(e),this.Fc=t}_toFieldTransform(e){const t=new On(e.serializer,An(e.serializer,this.Fc));return new Un(e.path,t)}isEqual(e){return e instanceof vu&&this.Fc===e.Fc}}function bu(e,t,r,a){const n=e.Cc(1,t,r);_u("Data must be an object, but it was:",n,a);const s=[],i=ma.empty();mr(a,(e,a)=>{const o=Cu(t,e,r);a=(0,c.Ku)(a);const l=n.yc(o);if(a instanceof gu)s.push(o);else{const e=Nu(a,l);null!=e&&(s.push(o),i.set(o,e))}});const o=new wr(s);return new cu(i,o,n.fieldTransforms)}function wu(e,t,r,a,n,s){const i=e.Cc(1,t,r),o=[Eu(t,a,r)],l=[n];if(s.length%2!=0)throw new R(M.INVALID_ARGUMENT,"Function ".concat(t,"() needs to be called with an even number of arguments that alternate between field names and values."));for(let c=0;c<s.length;c+=2)o.push(Eu(t,s[c])),l.push(s[c+1]);const d=[],u=ma.empty();for(let m=o.length-1;m>=0;--m)if(!Tu(d,o[m])){const e=o[m];let t=l[m];t=(0,c.Ku)(t);const r=i.yc(e);if(t instanceof gu)d.push(e);else{const a=Nu(t,r);null!=a&&(d.push(e),u.set(e,a))}}const h=new wr(d);return new cu(u,h,i.fieldTransforms)}function ku(e,t,r){let a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return Nu(r,e.Cc(a?4:3,t))}function Nu(e,t){if(Su(e=(0,c.Ku)(e)))return _u("Unsupported field value:",t,e),ju(e,t);if(e instanceof nu)return function(e,t){if(!du(t.Ac))throw t.Sc("".concat(e._methodName,"() can only be used with update() and set()"));if(!t.path)throw t.Sc("".concat(e._methodName,"() is not currently supported inside arrays"));const r=e._toFieldTransform(t);r&&t.fieldTransforms.push(r)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.fc&&4!==t.Ac)throw t.Sc("Nested arrays are not supported");return function(e,t){const r=[];let a=0;for(const n of e){let e=Nu(n,t.wc(a));null==e&&(e={nullValue:"NULL_VALUE"}),r.push(e),a++}return{arrayValue:{values:r}}}(e,t)}return function(e,t){if(null===(e=(0,c.Ku)(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return An(t.serializer,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){const r=ve.fromDate(e);return{timestampValue:Ps(t.serializer,r)}}if(e instanceof ve){const r=new ve(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:Ps(t.serializer,r)}}if(e instanceof su)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof ru)return{bytesValue:Fs(t.serializer,e._byteString)};if(e instanceof Vd){const r=t.databaseId,a=e.firestore._databaseId;if(!a.isEqual(r))throw t.Sc("Document reference is for database ".concat(a.projectId,"/").concat(a.database," but should be for database ").concat(r.projectId,"/").concat(r.database));return{referenceValue:Rs(e.firestore._databaseId||t.databaseId,e._key.path)}}if(e instanceof iu)return function(e,t){return{mapValue:{fields:{[Or]:{stringValue:Ur},[Vr]:{arrayValue:{values:e.toArray().map(e=>{if("number"!=typeof e)throw t.Sc("VectorValues must only contain numeric values.");return _n(t.serializer,e)})}}}}}}(e,t);throw t.Sc("Unsupported field value: ".concat(he(e)))}(e,t)}function ju(e,t){const r={};return fr(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):mr(e,(e,a)=>{const n=Nu(a,t.mc(e));null!=n&&(r[e]=n)}),{mapValue:{fields:r}}}function Su(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof ve||e instanceof su||e instanceof ru||e instanceof Vd||e instanceof nu||e instanceof iu)}function _u(e,t,r){if(!Su(r)||!ue(r)){const a=he(r);throw"an object"===a?t.Sc(e+" a custom object"):t.Sc(e+" "+a)}}function Eu(e,t,r){if((t=(0,c.Ku)(t))instanceof au)return t._internalPath;if("string"==typeof t)return Cu(e,t);throw Iu("Field path arguments must be of type string or ",e,!1,void 0,r)}const Au=new RegExp("[~\\*/\\[\\]]");function Cu(e,t,r){if(t.search(Au)>=0)throw Iu("Invalid field path (".concat(t,"). Paths must not contain '~', '*', '/', '[', or ']'"),e,!1,void 0,r);try{return new au(...t.split("."))._internalPath}catch(a){throw Iu("Invalid field path (".concat(t,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"),e,!1,void 0,r)}}function Iu(e,t,r,a,n){const s=a&&!a.isEmpty(),i=void 0!==n;let o="Function ".concat(t,"() called with invalid data");r&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(s||i)&&(l+=" (found",s&&(l+=" in field ".concat(a)),i&&(l+=" in document ".concat(n)),l+=")"),new R(M.INVALID_ARGUMENT,o+e+l)}function Tu(e,t){return e.some(e=>e.isEqual(t))}class Du{constructor(e,t,r,a,n){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=a,this._converter=n}get id(){return this._key.path.lastSegment()}get ref(){return new Vd(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new Pu(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Fu("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class Pu extends Du{data(){return super.data()}}function Fu(e,t){return"string"==typeof t?Cu(e,t):t instanceof au?t._internalPath:t._delegate._internalPath}function Lu(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new R(M.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Mu{}class Ru extends Mu{}function Ou(e,t){let r=[];for(var a=arguments.length,n=new Array(a>2?a-2:0),s=2;s<a;s++)n[s-2]=arguments[s];t instanceof Mu&&r.push(t),r=r.concat(n),function(e){const t=e.filter(e=>e instanceof Uu).length,r=e.filter(e=>e instanceof Bu).length;if(t>1||t>0&&r>0)throw new R(M.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)e=i._apply(e);return e}class Bu extends Ru{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new Bu(e,t,r)}_apply(e){const t=this._parse(e);return Ju(e._query,t),new Ud(e.firestore,e.converter,rn(e._query,t))}_parse(e){const t=mu(e.firestore),r=function(e,t,r,a,n,s,i){let o;if(n.isKeyField()){if("array-contains"===s||"array-contains-any"===s)throw new R(M.INVALID_ARGUMENT,"Invalid Query. You can't perform '".concat(s,"' queries on documentId()."));if("in"===s||"not-in"===s){Xu(i,s);const t=[];for(const r of i)t.push(Yu(a,e,r));o={arrayValue:{values:t}}}else o=Yu(a,e,i)}else"in"!==s&&"not-in"!==s&&"array-contains-any"!==s||Xu(i,s),o=ku(r,t,i,"in"===s||"not-in"===s);return ka.create(n,s,o)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value);return r}}function zu(e,t,r){const a=t,n=Fu("where",e);return Bu._create(n,a,r)}class Uu extends Mu{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Uu(e,t)}_parse(e){const t=this._queryConstraints.map(t=>t._parse(e)).filter(e=>e.getFilters().length>0);return 1===t.length?t[0]:Na.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return 0===t.getFilters().length?e:(function(e,t){let r=e;const a=t.getFlattenedFilters();for(const n of a)Ju(r,n),r=rn(r,n)}(e._query,t),new Ud(e.firestore,e.converter,rn(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class Vu extends Ru{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new Vu(e,t)}_apply(e){const t=function(e,t,r){if(null!==e.startAt)throw new R(M.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new R(M.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new va(t,r)}(e._query,this._field,this._direction);return new Ud(e.firestore,e.converter,function(e,t){const r=e.explicitOrderBy.concat([t]);return new Qa(e.path,e.collectionGroup,r,e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(e._query,t))}}function qu(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc",r=Fu("orderBy",e);return Vu._create(r,t)}class Hu extends Ru{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new Hu(e,t,r)}_apply(e){return new Ud(e.firestore,e.converter,an(e._query,this._limit,this._limitType))}}function Gu(e){return fe("limit",e),Hu._create("limit",e,"F")}class Wu extends Ru{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new Wu(e,t,r)}_apply(e){const t=Qu(e,this.type,this._docOrFields,this._inclusive);return new Ud(e.firestore,e.converter,function(e,t){return new Qa(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,t,e.endAt)}(e._query,t))}}function Ku(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return Wu._create("startAfter",t,!1)}function Qu(e,t,r,a){if(r[0]=(0,c.Ku)(r[0]),r[0]instanceof Du)return function(e,t,r,a,n){if(!a)throw new R(M.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for ".concat(r,"()."));const s=[];for(const i of $a(e))if(i.field.isKeyField())s.push($r(t,a.key));else{const e=a.data.field(i.field);if(Dr(e))throw new R(M.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+i.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===e){const e=i.field.canonicalString();throw new R(M.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '".concat(e,"' (used as the orderBy) does not exist."))}s.push(e)}return new pa(s,n)}(e._query,e.firestore._databaseId,t,r[0]._document,a);{const n=mu(e.firestore);return function(e,t,r,a,n,s){const i=e.explicitOrderBy;if(n.length>i.length)throw new R(M.INVALID_ARGUMENT,"Too many arguments provided to ".concat(a,"(). The number of arguments must be less than or equal to the number of orderBy() clauses"));const o=[];for(let l=0;l<n.length;l++){const s=n[l];if(i[l].field.isKeyField()){if("string"!=typeof s)throw new R(M.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in ".concat(a,"(), but got a ").concat(typeof s));if(!Za(e)&&-1!==s.indexOf("/"))throw new R(M.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by documentId(), the value passed to ".concat(a,"() must be a plain document ID, but '").concat(s,"' contains a slash."));const r=e.path.child(ne.fromString(s));if(!oe.isDocumentKey(r))throw new R(M.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by documentId(), the value passed to ".concat(a,"() must result in a valid document path, but '").concat(r,"' is not because it contains an odd number of segments."));const n=new oe(r);o.push($r(t,n))}else{const e=ku(r,a,s);o.push(e)}}return new pa(o,s)}(e._query,e.firestore._databaseId,n,t,r,a)}}function Yu(e,t,r){if("string"==typeof(r=(0,c.Ku)(r))){if(""===r)throw new R(M.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Za(t)&&-1!==r.indexOf("/"))throw new R(M.INVALID_ARGUMENT,"Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '".concat(r,"' contains a '/' character."));const a=t.path.child(ne.fromString(r));if(!oe.isDocumentKey(a))throw new R(M.INVALID_ARGUMENT,"Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '".concat(a,"' is not because it has an odd number of segments (").concat(a.length,")."));return $r(e,new oe(a))}if(r instanceof Vd)return $r(e,r._key);throw new R(M.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ".concat(he(r),"."))}function Xu(e,t){if(!Array.isArray(e)||0===e.length)throw new R(M.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '".concat(t.toString(),"' filters."))}function Ju(e,t){const r=function(e,t){for(const r of e)for(const e of r.getFlattenedFilters())if(t.indexOf(e.op)>=0)return e.op;return null}(e.filters,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==r)throw r===t.op?new R(M.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '".concat(t.op.toString(),"' filter.")):new R(M.INVALID_ARGUMENT,"Invalid query. You cannot use '".concat(t.op.toString(),"' filters with '").concat(r.toString(),"' filters."))}class Zu{convertValue(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";switch(Hr(e)){case 0:return null;case 1:return e.booleanValue;case 2:return _r(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Er(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw D(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";const r={};return mr(e,(e,a)=>{r[e]=this.convertValue(a,t)}),r}convertVectorValue(e){var t;const r=null===(t=e.fields)||void 0===t||null===(t=t[Vr].arrayValue)||void 0===t||null===(t=t.values)||void 0===t?void 0:t.map(e=>_r(e.doubleValue));return new iu(r)}convertGeoPoint(e){return new su(_r(e.latitude),_r(e.longitude))}convertArray(e,t){return(e.values||[]).map(e=>this.convertValue(e,t))}convertServerTimestamp(e,t){switch(t){case"previous":const r=Pr(e);return null==r?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Fr(e));default:return null}}convertTimestamp(e){const t=Sr(e);return new ve(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=ne.fromString(e);F(oi(r),9688,{name:e});const a=new Rr(r.get(1),r.get(3)),n=new oe(r.popFirst(5));return a.isEqual(t)||C("Document ".concat(n," contains a document reference within a different database (").concat(a.projectId,"/").concat(a.database,") which is not supported. It will be treated as a reference in the current database (").concat(t.projectId,"/").concat(t.database,") instead.")),n}}function $u(e,t,r){let a;return a=e?r&&(r.merge||r.mergeFields)?e.toFirestore(t,r):e.toFirestore(t):t,a}class eh{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class th extends Du{constructor(e,t,r,a,n,s){super(e,t,r,a,s),this._firestore=e,this._firestoreImpl=e,this.metadata=n}exists(){return super.exists()}data(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._document){if(this._converter){const t=new rh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._document){const r=this._document.data.field(Fu("DocumentSnapshot.get",e));if(null!==r)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new R(M.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=th._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),e&&e.isValidDocument()&&e.isFoundDocument()?(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t):t}}th._jsonSchemaVersion="firestore/documentSnapshot/1.0",th._jsonSchema={type:ge("string",th._jsonSchemaVersion),bundleSource:ge("string","DocumentSnapshot"),bundleName:ge("string"),bundle:ge("string")};class rh extends th{data(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return super.data(e)}}class ah{constructor(e,t,r,a){this._firestore=e,this._userDataWriter=t,this._snapshot=a,this.metadata=new eh(a.hasPendingWrites,a.fromCache),this.query=r}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new rh(this._firestore,this._userDataWriter,r.key,r,new eh(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(){const e=!!(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new R(M.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){let t=0;return e._snapshot.docChanges.map(r=>{const a=new rh(e._firestore,e._userDataWriter,r.doc.key,r.doc,new eh(e._snapshot.mutatedKeys.has(r.doc.key),e._snapshot.fromCache),e.query.converter);return r.doc,{type:"added",doc:a,oldIndex:-1,newIndex:t++}})}{let r=e._snapshot.oldDocs;return e._snapshot.docChanges.filter(e=>t||3!==e.type).map(t=>{const a=new rh(e._firestore,e._userDataWriter,t.doc.key,t.doc,new eh(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter);let n=-1,s=-1;return 0!==t.type&&(n=r.indexOf(t.doc.key),r=r.delete(t.doc.key)),1!==t.type&&(r=r.add(t.doc),s=r.indexOf(t.doc.key)),{type:nh(t.type),doc:a,oldIndex:n,newIndex:s}})}}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new R(M.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=ah._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Q.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],r=[],a=[];return this.docs.forEach(e=>{null!==e._document&&(t.push(e._document),r.push(this._userDataWriter.convertObjectMap(e._document.data.value.mapValue.fields,"previous")),a.push(e.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function nh(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return D(61501,{type:e})}}function sh(e){e=me(e,Vd);const t=me(e.firestore,Xd);return Pd(Zd(t),e._key).then(r=>fh(t,e,r))}ah._jsonSchemaVersion="firestore/querySnapshot/1.0",ah._jsonSchema={type:ge("string",ah._jsonSchemaVersion),bundleSource:ge("string","QuerySnapshot"),bundleName:ge("string"),bundle:ge("string")};class ih extends Zu{constructor(e){super(),this.firestore=e}convertBytes(e){return new ru(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Vd(this.firestore,null,t)}}function oh(e){e=me(e,Ud);const t=me(e.firestore,Xd),r=Zd(t),a=new ih(t);return Lu(e._query),Fd(r,e._query).then(r=>new ah(t,a,e,r))}function lh(e,t,r){e=me(e,Vd);const a=me(e.firestore,Xd),n=$u(e.converter,t,r);return mh(a,[fu(mu(a),"setDoc",e._key,n,null!==e.converter,r).toMutation(e._key,qn.none())])}function ch(e,t,r){e=me(e,Vd);const a=me(e.firestore,Xd),n=mu(a);let s;for(var i=arguments.length,o=new Array(i>3?i-3:0),l=3;l<i;l++)o[l-3]=arguments[l];return s="string"==typeof(t=(0,c.Ku)(t))||t instanceof au?wu(n,"updateDoc",e._key,t,r,o):bu(n,"updateDoc",e._key,t),mh(a,[s.toMutation(e._key,qn.exists(!0))])}function dh(e){return mh(me(e.firestore,Xd),[new rs(e._key,qn.none())])}function uh(e,t){const r=me(e.firestore,Xd),a=Gd(e),n=$u(e.converter,t);return mh(r,[fu(mu(e.firestore),"addDoc",a._key,n,null!==e.converter,{}).toMutation(a._key,qn.exists(!1))]).then(()=>a)}function hh(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];e=(0,c.Ku)(e);let n={includeMetadataChanges:!1,source:"default"},s=0;"object"!=typeof r[s]||Yd(r[s])||(n=r[s++]);const i={includeMetadataChanges:n.includeMetadataChanges,source:n.source};if(Yd(r[s])){var o,l,d;const e=r[s];r[s]=null===(o=e.next)||void 0===o?void 0:o.bind(e),r[s+1]=null===(l=e.error)||void 0===l?void 0:l.bind(e),r[s+2]=null===(d=e.complete)||void 0===d?void 0:d.bind(e)}let u,h,m;if(e instanceof Vd)h=me(e.firestore,Xd),m=Xa(e._key.path),u={next:t=>{r[s]&&r[s](fh(h,e,t))},error:r[s+1],complete:r[s+2]};else{const t=me(e,Ud);h=me(t.firestore,Xd),m=t._query;const a=new ih(h);u={next:e=>{r[s]&&r[s](new ah(h,a,t,e))},error:r[s+1],complete:r[s+2]},Lu(e._query)}return function(e,t,r,a){const n=new jd(a),s=new qc(t,n,r);return e.asyncQueue.enqueueAndForget(async()=>Mc(await Dd(e),s)),()=>{n.Nu(),e.asyncQueue.enqueueAndForget(async()=>Rc(await Dd(e),s))}}(Zd(h),m,i,u)}function mh(e,t){return function(e,t){const r=new O;return e.asyncQueue.enqueueAndForget(async()=>async function(e,t,r){const a=vd(e);try{const e=await function(e,t){const r=L(e),a=ve.now(),n=t.reduce((e,t)=>e.add(t.key),Nn());let s,i;return r.persistence.runTransaction("Locally write mutations","readwrite",e=>{let o=fn(),l=Nn();return r.Ns.getEntries(e,n).next(e=>{o=e,o.forEach((e,t)=>{t.isValidDocument()||(l=l.add(e))})}).next(()=>r.localDocuments.getOverlayedDocuments(e,o)).next(n=>{s=n;const i=[];for(const e of t){const t=Yn(e,s.get(e.key).overlayedDocument);null!=t&&i.push(new Zn(e.key,t,fa(t.value.mapValue),qn.exists(!0)))}return r.mutationQueue.addMutationBatch(e,a,i,t)}).next(t=>{i=t;const a=t.applyToLocalDocumentSet(s,l);return r.documentOverlayCache.saveOverlays(e,t.batchId,a)})}).then(()=>({batchId:i.batchId,changes:xn(s)}))}(a.localStore,t);a.sharedClientState.addPendingMutation(e.batchId),function(e,t,r){let a=e.Vu[e.currentUser.toKey()];a||(a=new gr(Y)),a=a.insert(t,r),e.Vu[e.currentUser.toKey()]=a}(a,e.batchId,r),await gd(a,e.changes),await gc(a.remoteStore)}catch(e){const t=Cc(e,"Failed to persist write");r.reject(t)}}(await Td(e),t,r)),r.promise}(Zd(e),t)}function fh(e,t,r){const a=r.docs.get(t._key),n=new ih(e);return new th(e,n,t._key,a,new eh(r.hasPendingWrites,r.fromCache),t.converter)}class gh{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=mu(e)}set(e,t,r){this._verifyNotCommitted();const a=ph(e,this._firestore),n=$u(a.converter,t,r),s=fu(this._dataReader,"WriteBatch.set",a._key,n,null!==a.converter,r);return this._mutations.push(s.toMutation(a._key,qn.none())),this}update(e,t,r){this._verifyNotCommitted();const a=ph(e,this._firestore);let n;for(var s=arguments.length,i=new Array(s>3?s-3:0),o=3;o<s;o++)i[o-3]=arguments[o];return n="string"==typeof(t=(0,c.Ku)(t))||t instanceof au?wu(this._dataReader,"WriteBatch.update",a._key,t,r,i):bu(this._dataReader,"WriteBatch.update",a._key,t),this._mutations.push(n.toMutation(a._key,qn.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=ph(e,this._firestore);return this._mutations=this._mutations.concat(new rs(t._key,qn.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new R(M.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function ph(e,t){if((e=(0,c.Ku)(e)).firestore!==t)throw new R(M.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}function xh(){return new xu("serverTimestamp")}function yh(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return new yu("arrayUnion",t)}function vh(e){return new vu("increment",e)}function bh(e){return Zd(e=me(e,Xd)),new gh(e,t=>mh(e,t))}new WeakMap;!function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];!function(e){S=e}(i.MF),(0,i.om)(new o.uA("firestore",(e,r)=>{let{instanceIdentifier:a,options:n}=r;const i=e.getProvider("app").getImmediate(),o=new Xd(new V(e.getProvider("auth-internal")),new W(i,e.getProvider("app-check-internal")),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new R(M.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Rr(e.options.projectId,t)}(i,a),i);return n=(0,s.A)({useFetchStreams:t},n),o._setSettings(n),o},"PUBLIC").setMultipleInstances(!0)),(0,i.KO)(k,N,e),(0,i.KO)(k,N,"esm2020")}()},477:()=>{},498:(e,t,r)=>{"use strict";r.d(t,{cY:()=>g,FA:()=>L,g:()=>F,dM:()=>P,u:()=>l,Uj:()=>o,p9:()=>X,Fy:()=>y,tD:()=>q,bD:()=>O,hp:()=>V,T9:()=>m,Tj:()=>u,yU:()=>h,XA:()=>f,mS:()=>c,Ku:()=>J,ZQ:()=>k,sr:()=>_,zJ:()=>p,c1:()=>S,Im:()=>R,lT:()=>A,zW:()=>T,jZ:()=>N,lV:()=>E,nr:()=>C,Ov:()=>I,gE:()=>x,Am:()=>z,I9:()=>U,P1:()=>w,eX:()=>D});var a=r(9379);const n=function(e){const t=[];let r=0;for(let a=0;a<e.length;a++){let n=e.charCodeAt(a);n<128?t[r++]=n:n<2048?(t[r++]=n>>6|192,t[r++]=63&n|128):55296===(64512&n)&&a+1<e.length&&56320===(64512&e.charCodeAt(a+1))?(n=65536+((1023&n)<<10)+(1023&e.charCodeAt(++a)),t[r++]=n>>18|240,t[r++]=n>>12&63|128,t[r++]=n>>6&63|128,t[r++]=63&n|128):(t[r++]=n>>12|224,t[r++]=n>>6&63|128,t[r++]=63&n|128)}return t},s={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"===typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,a=[];for(let n=0;n<e.length;n+=3){const t=e[n],s=n+1<e.length,i=s?e[n+1]:0,o=n+2<e.length,l=o?e[n+2]:0,c=t>>2,d=(3&t)<<4|i>>4;let u=(15&i)<<2|l>>6,h=63&l;o||(h=64,s||(u=64)),a.push(r[c],r[d],r[u],r[h])}return a.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(n(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let r=0,a=0;for(;r<e.length;){const n=e[r++];if(n<128)t[a++]=String.fromCharCode(n);else if(n>191&&n<224){const s=e[r++];t[a++]=String.fromCharCode((31&n)<<6|63&s)}else if(n>239&&n<365){const s=((7&n)<<18|(63&e[r++])<<12|(63&e[r++])<<6|63&e[r++])-65536;t[a++]=String.fromCharCode(55296+(s>>10)),t[a++]=String.fromCharCode(56320+(1023&s))}else{const s=e[r++],i=e[r++];t[a++]=String.fromCharCode((15&n)<<12|(63&s)<<6|63&i)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const r=t?this.charToByteMapWebSafe_:this.charToByteMap_,a=[];for(let n=0;n<e.length;){const t=r[e.charAt(n++)],s=n<e.length?r[e.charAt(n)]:0;++n;const o=n<e.length?r[e.charAt(n)]:64;++n;const l=n<e.length?r[e.charAt(n)]:64;if(++n,null==t||null==s||null==o||null==l)throw new i;const c=t<<2|s>>4;if(a.push(c),64!==o){const e=s<<4&240|o>>2;if(a.push(e),64!==l){const e=o<<6&192|l;a.push(e)}}}return a},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class i extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const o=function(e){return function(e){const t=n(e);return s.encodeByteArray(t,!0)}(e).replace(/\./g,"")},l=function(e){try{return s.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};function c(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof r.g)return r.g;throw new Error("Unable to locate global object.")}const d=()=>{try{return c().__FIREBASE_DEFAULTS__||(()=>{if("undefined"===typeof process)return;const e={NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_ENV:"production"}.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0})()||(()=>{if("undefined"===typeof document)return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(r){return}const t=e&&l(e[1]);return t&&JSON.parse(t)})()}catch(e){return void console.info("Unable to get __FIREBASE_DEFAULTS__ due to: ".concat(e))}},u=e=>{var t;return null===(t=d())||void 0===t||null===(t=t.emulatorHosts)||void 0===t?void 0:t[e]},h=e=>{const t=u(e);if(!t)return;const r=t.lastIndexOf(":");if(r<=0||r+1===t.length)throw new Error("Invalid host ".concat(t," with no separate hostname and port!"));const a=parseInt(t.substring(r+1),10);return"["===t[0]?[t.substring(1,r-1),a]:[t.substring(0,r),a]},m=()=>{var e;return null===(e=d())||void 0===e?void 0:e.config},f=e=>{var t;return null===(t=d())||void 0===t?void 0:t["_".concat(e)]};class g{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),"function"===typeof e&&(this.promise.catch(()=>{}),1===e.length?e(t):e(t,r))}}}function p(e){try{return(e.startsWith("http://")||e.startsWith("https://")?new URL(e).hostname:e).endsWith(".cloudworkstations.dev")}catch(t){return!1}}async function x(e){return(await fetch(e,{credentials:"include"})).ok}function y(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r=t||"demo-project",n=e.iat||0,s=e.sub||e.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const i=(0,a.A)({iss:"https://securetoken.google.com/".concat(r),aud:r,iat:n,exp:n+3600,auth_time:n,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},e);return[o(JSON.stringify({alg:"none",type:"JWT"})),o(JSON.stringify(i)),""].join(".")}const v={};let b=!1;function w(e,t){if("undefined"===typeof window||"undefined"===typeof document||!p(window.location.host)||v[e]===t||v[e]||b)return;function r(e){return"__firebase__banner__".concat(e)}v[e]=t;const a="__firebase__banner",n=function(){const e={prod:[],emulator:[]};for(const t of Object.keys(v))v[t]?e.emulator.push(t):e.prod.push(t);return e}().prod.length>0;function s(){const e=document.createElement("span");return e.style.cursor="pointer",e.style.marginLeft="16px",e.style.fontSize="24px",e.innerHTML=" &times;",e.onclick=()=>{b=!0,function(){const e=document.getElementById(a);e&&e.remove()}()},e}function i(){const e=function(e){let t=document.getElementById(e),r=!1;return t||(t=document.createElement("div"),t.setAttribute("id",e),r=!0),{created:r,element:t}}(a),t=r("text"),i=document.getElementById(t)||document.createElement("span"),o=r("learnmore"),l=document.getElementById(o)||document.createElement("a"),c=r("preprendIcon"),d=document.getElementById(c)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(e.created){const t=e.element;!function(e){e.style.display="flex",e.style.background="#7faaf0",e.style.position="fixed",e.style.bottom="5px",e.style.left="5px",e.style.padding=".5em",e.style.borderRadius="5px",e.style.alignItems="center"}(t),function(e,t){e.setAttribute("id",t),e.innerText="Learn more",e.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",e.setAttribute("target","__blank"),e.style.paddingLeft="5px",e.style.textDecoration="underline"}(l,o);const r=s();!function(e,t){e.setAttribute("width","24"),e.setAttribute("id",t),e.setAttribute("height","24"),e.setAttribute("viewBox","0 0 24 24"),e.setAttribute("fill","none"),e.style.marginLeft="-6px"}(d,c),t.append(d,i,l,r),document.body.appendChild(t)}n?(i.innerText="Preview backend disconnected.",d.innerHTML='<g clip-path="url(#clip0_6013_33858)">\n<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>\n</g>\n<defs>\n<clipPath id="clip0_6013_33858">\n<rect width="24" height="24" fill="white"/>\n</clipPath>\n</defs>'):(d.innerHTML='<g clip-path="url(#clip0_6083_34804)">\n<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>\n</g>\n<defs>\n<clipPath id="clip0_6083_34804">\n<rect width="24" height="24" fill="white"/>\n</clipPath>\n</defs>',i.innerText="Preview backend running in this workspace."),i.setAttribute("id",t)}"loading"===document.readyState?window.addEventListener("DOMContentLoaded",i):i()}function k(){return"undefined"!==typeof navigator&&"string"===typeof navigator.userAgent?navigator.userAgent:""}function N(){return"undefined"!==typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(k())}function j(){var e;const t=null===(e=d())||void 0===e?void 0:e.forceEnvironment;if("node"===t)return!0;if("browser"===t)return!1;try{return"[object process]"===Object.prototype.toString.call(r.g.process)}catch(a){return!1}}function S(){return"undefined"!==typeof navigator&&"Cloudflare-Workers"===navigator.userAgent}function _(){const e="object"===typeof chrome?chrome.runtime:"object"===typeof browser?browser.runtime:void 0;return"object"===typeof e&&void 0!==e.id}function E(){return"object"===typeof navigator&&"ReactNative"===navigator.product}function A(){const e=k();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}function C(){return!j()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function I(){return!j()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function T(){try{return"object"===typeof indexedDB}catch(e){return!1}}function D(){return new Promise((e,t)=>{try{let r=!0;const a="validate-browser-context-for-indexeddb-analytics-module",n=self.indexedDB.open(a);n.onsuccess=()=>{n.result.close(),r||self.indexedDB.deleteDatabase(a),e(!0)},n.onupgradeneeded=()=>{r=!1},n.onerror=()=>{var e;t((null===(e=n.error)||void 0===e?void 0:e.message)||"")}}catch(r){t(r)}})}function P(){return!("undefined"===typeof navigator||!navigator.cookieEnabled)}class F extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name="FirebaseError",Object.setPrototypeOf(this,F.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,L.prototype.create)}}class L{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e){const t=(arguments.length<=1?void 0:arguments[1])||{},r="".concat(this.service,"/").concat(e),a=this.errors[e],n=a?function(e,t){return e.replace(M,(e,r)=>{const a=t[r];return null!=a?String(a):"<".concat(r,"?>")})}(a,t):"Error",s="".concat(this.serviceName,": ").concat(n," (").concat(r,").");return new F(r,s,t)}}const M=/\{\$([^}]+)}/g;function R(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function O(e,t){if(e===t)return!0;const r=Object.keys(e),a=Object.keys(t);for(const n of r){if(!a.includes(n))return!1;const r=e[n],s=t[n];if(B(r)&&B(s)){if(!O(r,s))return!1}else if(r!==s)return!1}for(const n of a)if(!r.includes(n))return!1;return!0}function B(e){return null!==e&&"object"===typeof e}function z(e){const t=[];for(const[r,a]of Object.entries(e))Array.isArray(a)?a.forEach(e=>{t.push(encodeURIComponent(r)+"="+encodeURIComponent(e))}):t.push(encodeURIComponent(r)+"="+encodeURIComponent(a));return t.length?"&"+t.join("&"):""}function U(e){const t={};return e.replace(/^\?/,"").split("&").forEach(e=>{if(e){const[r,a]=e.split("=");t[decodeURIComponent(r)]=decodeURIComponent(a)}}),t}function V(e){const t=e.indexOf("?");if(!t)return"";const r=e.indexOf("#",t);return e.substring(t,r>0?r:void 0)}function q(e,t){const r=new H(e,t);return r.subscribe.bind(r)}class H{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(e=>{this.error(e)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let a;if(void 0===e&&void 0===t&&void 0===r)throw new Error("Missing Observer.");a=function(e,t){if("object"!==typeof e||null===e)return!1;for(const r of t)if(r in e&&"function"===typeof e[r])return!0;return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:r},void 0===a.next&&(a.next=G),void 0===a.error&&(a.error=G),void 0===a.complete&&(a.complete=G);const n=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?a.error(this.finalError):a.complete()}catch(e){}}),this.observers.push(a),n}unsubscribeOne(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(r){"undefined"!==typeof console&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function G(){}const W=1e3,K=2,Q=144e5,Y=.5;function X(e){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:K;const r=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:W)*Math.pow(t,e),a=Math.round(Y*r*(Math.random()-.5)*2);return Math.min(Q,r+a)}function J(e){return e&&e._delegate?e._delegate:e}},676:function(e,t,r){e.exports=function(e){return function(){var t=e,r=t.lib.StreamCipher,a=t.algo,n=[],s=[],i=[],o=a.Rabbit=r.extend({_doReset:function(){for(var e=this._key.words,t=this.cfg.iv,r=0;r<4;r++)e[r]=16711935&(e[r]<<8|e[r]>>>24)|4278255360&(e[r]<<24|e[r]>>>8);var a=this._X=[e[0],e[3]<<16|e[2]>>>16,e[1],e[0]<<16|e[3]>>>16,e[2],e[1]<<16|e[0]>>>16,e[3],e[2]<<16|e[1]>>>16],n=this._C=[e[2]<<16|e[2]>>>16,4294901760&e[0]|65535&e[1],e[3]<<16|e[3]>>>16,4294901760&e[1]|65535&e[2],e[0]<<16|e[0]>>>16,4294901760&e[2]|65535&e[3],e[1]<<16|e[1]>>>16,4294901760&e[3]|65535&e[0]];for(this._b=0,r=0;r<4;r++)l.call(this);for(r=0;r<8;r++)n[r]^=a[r+4&7];if(t){var s=t.words,i=s[0],o=s[1],c=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8),d=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8),u=c>>>16|4294901760&d,h=d<<16|65535&c;for(n[0]^=c,n[1]^=u,n[2]^=d,n[3]^=h,n[4]^=c,n[5]^=u,n[6]^=d,n[7]^=h,r=0;r<4;r++)l.call(this)}},_doProcessBlock:function(e,t){var r=this._X;l.call(this),n[0]=r[0]^r[5]>>>16^r[3]<<16,n[1]=r[2]^r[7]>>>16^r[5]<<16,n[2]=r[4]^r[1]>>>16^r[7]<<16,n[3]=r[6]^r[3]>>>16^r[1]<<16;for(var a=0;a<4;a++)n[a]=16711935&(n[a]<<8|n[a]>>>24)|4278255360&(n[a]<<24|n[a]>>>8),e[t+a]^=n[a]},blockSize:4,ivSize:2});function l(){for(var e=this._X,t=this._C,r=0;r<8;r++)s[r]=t[r];for(t[0]=t[0]+1295307597+this._b|0,t[1]=t[1]+3545052371+(t[0]>>>0<s[0]>>>0?1:0)|0,t[2]=t[2]+886263092+(t[1]>>>0<s[1]>>>0?1:0)|0,t[3]=t[3]+1295307597+(t[2]>>>0<s[2]>>>0?1:0)|0,t[4]=t[4]+3545052371+(t[3]>>>0<s[3]>>>0?1:0)|0,t[5]=t[5]+886263092+(t[4]>>>0<s[4]>>>0?1:0)|0,t[6]=t[6]+1295307597+(t[5]>>>0<s[5]>>>0?1:0)|0,t[7]=t[7]+3545052371+(t[6]>>>0<s[6]>>>0?1:0)|0,this._b=t[7]>>>0<s[7]>>>0?1:0,r=0;r<8;r++){var a=e[r]+t[r],n=65535&a,o=a>>>16,l=((n*n>>>17)+n*o>>>15)+o*o,c=((4294901760&a)*a|0)+((65535&a)*a|0);i[r]=l^c}e[0]=i[0]+(i[7]<<16|i[7]>>>16)+(i[6]<<16|i[6]>>>16)|0,e[1]=i[1]+(i[0]<<8|i[0]>>>24)+i[7]|0,e[2]=i[2]+(i[1]<<16|i[1]>>>16)+(i[0]<<16|i[0]>>>16)|0,e[3]=i[3]+(i[2]<<8|i[2]>>>24)+i[1]|0,e[4]=i[4]+(i[3]<<16|i[3]>>>16)+(i[2]<<16|i[2]>>>16)|0,e[5]=i[5]+(i[4]<<8|i[4]>>>24)+i[3]|0,e[6]=i[6]+(i[5]<<16|i[5]>>>16)+(i[4]<<16|i[4]>>>16)|0,e[7]=i[7]+(i[6]<<8|i[6]>>>24)+i[5]|0}t.Rabbit=r._createHelper(o)}(),e.Rabbit}(r(4703),r(3988),r(7766),r(7020),r(7755))},815:(e,t,r)=>{"use strict";r.d(t,{Wp:()=>a.Wp});var a=r(8791);(0,a.KO)("firebase","12.2.1","app")},1042:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=[];var a;t.LogLevel=void 0,(a=t.LogLevel||(t.LogLevel={}))[a.DEBUG=0]="DEBUG",a[a.VERBOSE=1]="VERBOSE",a[a.INFO=2]="INFO",a[a.WARN=3]="WARN",a[a.ERROR=4]="ERROR",a[a.SILENT=5]="SILENT";const n={debug:t.LogLevel.DEBUG,verbose:t.LogLevel.VERBOSE,info:t.LogLevel.INFO,warn:t.LogLevel.WARN,error:t.LogLevel.ERROR,silent:t.LogLevel.SILENT},s=t.LogLevel.INFO,i={[t.LogLevel.DEBUG]:"log",[t.LogLevel.VERBOSE]:"log",[t.LogLevel.INFO]:"info",[t.LogLevel.WARN]:"warn",[t.LogLevel.ERROR]:"error"},o=function(e,t){if(t<e.logLevel)return;const r=(new Date).toISOString(),a=i[t];if(!a)throw new Error("Attempted to log a message with an invalid logType (value: ".concat(t,")"));for(var n=arguments.length,s=new Array(n>2?n-2:0),o=2;o<n;o++)s[o-2]=arguments[o];console[a]("[".concat(r,"]  ").concat(e.name,":"),...s)};t.Logger=class{constructor(e){this.name=e,this._logLevel=s,this._logHandler=o,this._userLogHandler=null,r.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in t.LogLevel))throw new TypeError('Invalid value "'.concat(e,'" assigned to `logLevel`'));this._logLevel=e}setLogLevel(e){this._logLevel="string"===typeof e?n[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!==typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(){for(var e=arguments.length,r=new Array(e),a=0;a<e;a++)r[a]=arguments[a];this._userLogHandler&&this._userLogHandler(this,t.LogLevel.DEBUG,...r),this._logHandler(this,t.LogLevel.DEBUG,...r)}log(){for(var e=arguments.length,r=new Array(e),a=0;a<e;a++)r[a]=arguments[a];this._userLogHandler&&this._userLogHandler(this,t.LogLevel.VERBOSE,...r),this._logHandler(this,t.LogLevel.VERBOSE,...r)}info(){for(var e=arguments.length,r=new Array(e),a=0;a<e;a++)r[a]=arguments[a];this._userLogHandler&&this._userLogHandler(this,t.LogLevel.INFO,...r),this._logHandler(this,t.LogLevel.INFO,...r)}warn(){for(var e=arguments.length,r=new Array(e),a=0;a<e;a++)r[a]=arguments[a];this._userLogHandler&&this._userLogHandler(this,t.LogLevel.WARN,...r),this._logHandler(this,t.LogLevel.WARN,...r)}error(){for(var e=arguments.length,r=new Array(e),a=0;a<e;a++)r[a]=arguments[a];this._userLogHandler&&this._userLogHandler(this,t.LogLevel.ERROR,...r),this._logHandler(this,t.LogLevel.ERROR,...r)}},t.setLogLevel=function(e){r.forEach(t=>{t.setLogLevel(e)})},t.setUserLogHandler=function(e,a){for(const s of r){let r=null;a&&a.level&&(r=n[a.level]),s.userLogHandler=null===e?null:function(a,n){for(var s=arguments.length,i=new Array(s>2?s-2:0),o=2;o<s;o++)i[o-2]=arguments[o];const l=i.map(e=>{if(null==e)return null;if("string"===typeof e)return e;if("number"===typeof e||"boolean"===typeof e)return e.toString();if(e instanceof Error)return e.message;try{return JSON.stringify(e)}catch(t){return null}}).filter(e=>e).join(" ");n>=(null!==r&&void 0!==r?r:a.logLevel)&&e({level:t.LogLevel[n].toLowerCase(),message:l,args:i,type:a.name})}}}},1045:function(e,t,r){e.exports=function(e){return e.mode.CTR=function(){var t=e.lib.BlockCipherMode.extend(),r=t.Encryptor=t.extend({processBlock:function(e,t){var r=this._cipher,a=r.blockSize,n=this._iv,s=this._counter;n&&(s=this._counter=n.slice(0),this._iv=void 0);var i=s.slice(0);r.encryptBlock(i,0),s[a-1]=s[a-1]+1|0;for(var o=0;o<a;o++)e[t+o]^=i[o]}});return t.Decryptor=r,t}(),e.mode.CTR}(r(4703),r(7755))},1115:function(e,t,r){e.exports=function(e){return function(){var t=e,r=t.lib.CipherParams,a=t.enc.Hex;t.format.Hex={stringify:function(e){return e.ciphertext.toString(a)},parse:function(e){var t=a.parse(e);return r.create({ciphertext:t})}}}(),e.format.Hex}(r(4703),r(7755))},1352:(e,t,r)=>{"use strict";var a=r(7119);t.createRoot=a.createRoot,t.hydrateRoot=a.hydrateRoot},1494:(e,t,r)=>{"use strict";var a=r(2897).default;Object.defineProperty(t,"__esModule",{value:!0});var n=r(4459);const s={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"},i=function(e,t){if(!e)throw o(t)},o=function(e){return new Error("Firebase Database ("+s.SDK_VERSION+") INTERNAL ASSERT FAILED: "+e)},l=function(e){const t=[];let r=0;for(let a=0;a<e.length;a++){let n=e.charCodeAt(a);n<128?t[r++]=n:n<2048?(t[r++]=n>>6|192,t[r++]=63&n|128):55296===(64512&n)&&a+1<e.length&&56320===(64512&e.charCodeAt(a+1))?(n=65536+((1023&n)<<10)+(1023&e.charCodeAt(++a)),t[r++]=n>>18|240,t[r++]=n>>12&63|128,t[r++]=n>>6&63|128,t[r++]=63&n|128):(t[r++]=n>>12|224,t[r++]=n>>6&63|128,t[r++]=63&n|128)}return t},c={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"===typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,a=[];for(let n=0;n<e.length;n+=3){const t=e[n],s=n+1<e.length,i=s?e[n+1]:0,o=n+2<e.length,l=o?e[n+2]:0,c=t>>2,d=(3&t)<<4|i>>4;let u=(15&i)<<2|l>>6,h=63&l;o||(h=64,s||(u=64)),a.push(r[c],r[d],r[u],r[h])}return a.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(l(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let r=0,a=0;for(;r<e.length;){const n=e[r++];if(n<128)t[a++]=String.fromCharCode(n);else if(n>191&&n<224){const s=e[r++];t[a++]=String.fromCharCode((31&n)<<6|63&s)}else if(n>239&&n<365){const s=((7&n)<<18|(63&e[r++])<<12|(63&e[r++])<<6|63&e[r++])-65536;t[a++]=String.fromCharCode(55296+(s>>10)),t[a++]=String.fromCharCode(56320+(1023&s))}else{const s=e[r++],i=e[r++];t[a++]=String.fromCharCode((15&n)<<12|(63&s)<<6|63&i)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const r=t?this.charToByteMapWebSafe_:this.charToByteMap_,a=[];for(let n=0;n<e.length;){const t=r[e.charAt(n++)],s=n<e.length?r[e.charAt(n)]:0;++n;const i=n<e.length?r[e.charAt(n)]:64;++n;const o=n<e.length?r[e.charAt(n)]:64;if(++n,null==t||null==s||null==i||null==o)throw new d;const l=t<<2|s>>4;if(a.push(l),64!==i){const e=s<<4&240|i>>2;if(a.push(e),64!==o){const e=i<<6&192|o;a.push(e)}}}return a},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class d extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const u=function(e){const t=l(e);return c.encodeByteArray(t,!0)},h=function(e){return u(e).replace(/\./g,"")},m=function(e){try{return c.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};function f(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:return new Date(t.getTime());case Object:void 0===e&&(e={});break;case Array:e=[];break;default:return t}for(const r in t)t.hasOwnProperty(r)&&g(r)&&(e[r]=f(e[r],t[r]));return e}function g(e){return"__proto__"!==e}function p(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof r.g)return r.g;throw new Error("Unable to locate global object.")}const x=()=>{try{return n.getDefaultsFromPostinstall()||p().__FIREBASE_DEFAULTS__||(()=>{if("undefined"===typeof process)return;const e={NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_ENV:"production"}.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0})()||(()=>{if("undefined"===typeof document)return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(r){return}const t=e&&m(e[1]);return t&&JSON.parse(t)})()}catch(e){return void console.info("Unable to get __FIREBASE_DEFAULTS__ due to: ".concat(e))}},y=e=>{var t;return null===(t=x())||void 0===t||null===(t=t.emulatorHosts)||void 0===t?void 0:t[e]};class v{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),"function"===typeof e&&(this.promise.catch(()=>{}),1===e.length?e(t):e(t,r))}}}function b(e){try{return(e.startsWith("http://")||e.startsWith("https://")?new URL(e).hostname:e).endsWith(".cloudworkstations.dev")}catch(t){return!1}}const w={};let k=!1;function N(){return"undefined"!==typeof navigator&&"string"===typeof navigator.userAgent?navigator.userAgent:""}function j(){var e;const t=null===(e=x())||void 0===e?void 0:e.forceEnvironment;if("node"===t)return!0;if("browser"===t)return!1;try{return"[object process]"===Object.prototype.toString.call(r.g.process)}catch(a){return!1}}function S(){return"undefined"!==typeof WorkerGlobalScope&&"undefined"!==typeof self&&self instanceof WorkerGlobalScope}class _ extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name="FirebaseError",Object.setPrototypeOf(this,_.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,E.prototype.create)}}class E{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e){const t=(arguments.length<=1?void 0:arguments[1])||{},r="".concat(this.service,"/").concat(e),a=this.errors[e],n=a?function(e,t){return e.replace(A,(e,r)=>{const a=t[r];return null!=a?String(a):"<".concat(r,"?>")})}(a,t):"Error",s="".concat(this.serviceName,": ").concat(n," (").concat(r,").");return new _(r,s,t)}}const A=/\{\$([^}]+)}/g;function C(e){return JSON.parse(e)}const I=function(e){let t={},r={},a={},n="";try{const s=e.split(".");t=C(m(s[0])||""),r=C(m(s[1])||""),n=s[2],a=r.d||{},delete r.d}catch(s){}return{header:t,claims:r,data:a,signature:n}};function T(e){return null!==e&&"object"===typeof e}class D{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(e=>{this.error(e)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let a;if(void 0===e&&void 0===t&&void 0===r)throw new Error("Missing Observer.");a=function(e,t){if("object"!==typeof e||null===e)return!1;for(const r of t)if(r in e&&"function"===typeof e[r])return!0;return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:r},void 0===a.next&&(a.next=P),void 0===a.error&&(a.error=P),void 0===a.complete&&(a.complete=P);const n=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?a.error(this.finalError):a.complete()}catch(e){}}),this.observers.push(a),n}unsubscribeOne(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(r){"undefined"!==typeof console&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function P(){}function F(e,t){return"".concat(e," failed: ").concat(t," argument ")}const L=144e5;t.CONSTANTS=s,t.DecodeBase64StringError=d,t.Deferred=v,t.ErrorFactory=E,t.FirebaseError=_,t.MAX_VALUE_MILLIS=L,t.RANDOM_FACTOR=.5,t.Sha1=class{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,t){t||(t=0);const r=this.W_;if("string"===typeof e)for(let d=0;d<16;d++)r[d]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(let d=0;d<16;d++)r[d]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(let d=16;d<80;d++){const e=r[d-3]^r[d-8]^r[d-14]^r[d-16];r[d]=4294967295&(e<<1|e>>>31)}let a,n,s=this.chain_[0],i=this.chain_[1],o=this.chain_[2],l=this.chain_[3],c=this.chain_[4];for(let d=0;d<80;d++){d<40?d<20?(a=l^i&(o^l),n=1518500249):(a=i^o^l,n=1859775393):d<60?(a=i&o|l&(i|o),n=2400959708):(a=i^o^l,n=3395469782);const e=(s<<5|s>>>27)+a+c+n+r[d]&4294967295;c=l,l=o,o=4294967295&(i<<30|i>>>2),i=s,s=e}this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+i&4294967295,this.chain_[2]=this.chain_[2]+o&4294967295,this.chain_[3]=this.chain_[3]+l&4294967295,this.chain_[4]=this.chain_[4]+c&4294967295}update(e,t){if(null==e)return;void 0===t&&(t=e.length);const r=t-this.blockSize;let a=0;const n=this.buf_;let s=this.inbuf_;for(;a<t;){if(0===s)for(;a<=r;)this.compress_(e,a),a+=this.blockSize;if("string"===typeof e){for(;a<t;)if(n[s]=e.charCodeAt(a),++s,++a,s===this.blockSize){this.compress_(n),s=0;break}}else for(;a<t;)if(n[s]=e[a],++s,++a,s===this.blockSize){this.compress_(n),s=0;break}}this.inbuf_=s,this.total_+=t}digest(){const e=[];let t=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let a=this.blockSize-1;a>=56;a--)this.buf_[a]=255&t,t/=256;this.compress_(this.buf_);let r=0;for(let a=0;a<5;a++)for(let t=24;t>=0;t-=8)e[r]=this.chain_[a]>>t&255,++r;return e}},t.areCookiesEnabled=function(){return!("undefined"===typeof navigator||!navigator.cookieEnabled)},t.assert=i,t.assertionError=o,t.async=function(e,t){return function(){for(var r=arguments.length,a=new Array(r),n=0;n<r;n++)a[n]=arguments[n];Promise.resolve(!0).then(()=>{e(...a)}).catch(e=>{t&&t(e)})}},t.base64=c,t.base64Decode=m,t.base64Encode=u,t.base64urlEncodeWithoutPadding=h,t.calculateBackoffMillis=function(e){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;const r=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3)*Math.pow(t,e),a=Math.round(.5*r*(Math.random()-.5)*2);return Math.min(L,r+a)},t.contains=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.createMockUserToken=function(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r=t||"demo-project",n=e.iat||0,s=e.sub||e.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const i=a({iss:"https://securetoken.google.com/".concat(r),aud:r,iat:n,exp:n+3600,auth_time:n,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},e);return[h(JSON.stringify({alg:"none",type:"JWT"})),h(JSON.stringify(i)),""].join(".")},t.createSubscribe=function(e,t){const r=new D(e,t);return r.subscribe.bind(r)},t.decode=I,t.deepCopy=function(e){return f(void 0,e)},t.deepEqual=function e(t,r){if(t===r)return!0;const a=Object.keys(t),n=Object.keys(r);for(const s of a){if(!n.includes(s))return!1;const a=t[s],i=r[s];if(T(a)&&T(i)){if(!e(a,i))return!1}else if(a!==i)return!1}for(const s of n)if(!a.includes(s))return!1;return!0},t.deepExtend=f,t.errorPrefix=F,t.extractQuerystring=function(e){const t=e.indexOf("?");if(!t)return"";const r=e.indexOf("#",t);return e.substring(t,r>0?r:void 0)},t.getDefaultAppConfig=()=>{var e;return null===(e=x())||void 0===e?void 0:e.config},t.getDefaultEmulatorHost=y,t.getDefaultEmulatorHostnameAndPort=e=>{const t=y(e);if(!t)return;const r=t.lastIndexOf(":");if(r<=0||r+1===t.length)throw new Error("Invalid host ".concat(t," with no separate hostname and port!"));const a=parseInt(t.substring(r+1),10);return"["===t[0]?[t.substring(1,r-1),a]:[t.substring(0,r),a]},t.getDefaults=x,t.getExperimentalSetting=e=>{var t;return null===(t=x())||void 0===t?void 0:t["_".concat(e)]},t.getGlobal=p,t.getModularInstance=function(e){return e&&e._delegate?e._delegate:e},t.getUA=N,t.isAdmin=function(e){const t=I(e).claims;return"object"===typeof t&&!0===t.admin},t.isBrowser=function(){return"undefined"!==typeof window||S()},t.isBrowserExtension=function(){const e="object"===typeof chrome?chrome.runtime:"object"===typeof browser?browser.runtime:void 0;return"object"===typeof e&&void 0!==e.id},t.isCloudWorkstation=b,t.isCloudflareWorker=function(){return"undefined"!==typeof navigator&&"Cloudflare-Workers"===navigator.userAgent},t.isElectron=function(){return N().indexOf("Electron/")>=0},t.isEmpty=function(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0},t.isIE=function(){const e=N();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0},t.isIndexedDBAvailable=function(){try{return"object"===typeof indexedDB}catch(e){return!1}},t.isMobileCordova=function(){return"undefined"!==typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(N())},t.isNode=j,t.isNodeSdk=function(){return!0===s.NODE_CLIENT||!0===s.NODE_ADMIN},t.isReactNative=function(){return"object"===typeof navigator&&"ReactNative"===navigator.product},t.isSafari=function(){return!j()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")},t.isSafariOrWebkit=function(){return!j()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")},t.isUWP=function(){return N().indexOf("MSAppHost/")>=0},t.isValidFormat=function(e){const t=I(e).claims;return!!t&&"object"===typeof t&&t.hasOwnProperty("iat")},t.isValidTimestamp=function(e){const t=I(e).claims,r=Math.floor((new Date).getTime()/1e3);let a=0,n=0;return"object"===typeof t&&(t.hasOwnProperty("nbf")?a=t.nbf:t.hasOwnProperty("iat")&&(a=t.iat),n=t.hasOwnProperty("exp")?t.exp:a+86400),!!r&&!!a&&!!n&&r>=a&&r<=n},t.isWebWorker=S,t.issuedAtTime=function(e){const t=I(e).claims;return"object"===typeof t&&t.hasOwnProperty("iat")?t.iat:null},t.jsonEval=C,t.map=function(e,t,r){const a={};for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(a[n]=t.call(r,e[n],n,e));return a},t.ordinal=function(e){return Number.isFinite(e)?e+function(e){e=Math.abs(e);const t=e%100;if(t>=10&&t<=20)return"th";const r=e%10;if(1===r)return"st";if(2===r)return"nd";if(3===r)return"rd";return"th"}(e):"".concat(e)},t.pingServer=async function(e){return(await fetch(e,{credentials:"include"})).ok},t.promiseWithTimeout=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2e3;const r=new v;return setTimeout(()=>r.reject("timeout!"),t),e.then(r.resolve,r.reject),r.promise},t.querystring=function(e){const t=[];for(const[r,a]of Object.entries(e))Array.isArray(a)?a.forEach(e=>{t.push(encodeURIComponent(r)+"="+encodeURIComponent(e))}):t.push(encodeURIComponent(r)+"="+encodeURIComponent(a));return t.length?"&"+t.join("&"):""},t.querystringDecode=function(e){const t={};return e.replace(/^\?/,"").split("&").forEach(e=>{if(e){const[r,a]=e.split("=");t[decodeURIComponent(r)]=decodeURIComponent(a)}}),t},t.safeGet=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)?e[t]:void 0},t.stringLength=function(e){let t=0;for(let r=0;r<e.length;r++){const a=e.charCodeAt(r);a<128?t++:a<2048?t+=2:a>=55296&&a<=56319?(t+=4,r++):t+=3}return t},t.stringToByteArray=function(e){const t=[];let r=0;for(let a=0;a<e.length;a++){let n=e.charCodeAt(a);if(n>=55296&&n<=56319){const t=n-55296;a++,i(a<e.length,"Surrogate pair missing trail surrogate.");n=65536+(t<<10)+(e.charCodeAt(a)-56320)}n<128?t[r++]=n:n<2048?(t[r++]=n>>6|192,t[r++]=63&n|128):n<65536?(t[r++]=n>>12|224,t[r++]=n>>6&63|128,t[r++]=63&n|128):(t[r++]=n>>18|240,t[r++]=n>>12&63|128,t[r++]=n>>6&63|128,t[r++]=63&n|128)}return t},t.stringify=function(e){return JSON.stringify(e)},t.updateEmulatorBanner=function(e,t){if("undefined"===typeof window||"undefined"===typeof document||!b(window.location.host)||w[e]===t||w[e]||k)return;function r(e){return"__firebase__banner__".concat(e)}w[e]=t;const a="__firebase__banner",n=function(){const e={prod:[],emulator:[]};for(const t of Object.keys(w))w[t]?e.emulator.push(t):e.prod.push(t);return e}().prod.length>0;function s(){const e=document.createElement("span");return e.style.cursor="pointer",e.style.marginLeft="16px",e.style.fontSize="24px",e.innerHTML=" &times;",e.onclick=()=>{k=!0,function(){const e=document.getElementById(a);e&&e.remove()}()},e}function i(){const e=function(e){let t=document.getElementById(e),r=!1;return t||(t=document.createElement("div"),t.setAttribute("id",e),r=!0),{created:r,element:t}}(a),t=r("text"),i=document.getElementById(t)||document.createElement("span"),o=r("learnmore"),l=document.getElementById(o)||document.createElement("a"),c=r("preprendIcon"),d=document.getElementById(c)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(e.created){const t=e.element;!function(e){e.style.display="flex",e.style.background="#7faaf0",e.style.position="fixed",e.style.bottom="5px",e.style.left="5px",e.style.padding=".5em",e.style.borderRadius="5px",e.style.alignItems="center"}(t),function(e,t){e.setAttribute("id",t),e.innerText="Learn more",e.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",e.setAttribute("target","__blank"),e.style.paddingLeft="5px",e.style.textDecoration="underline"}(l,o);const r=s();!function(e,t){e.setAttribute("width","24"),e.setAttribute("id",t),e.setAttribute("height","24"),e.setAttribute("viewBox","0 0 24 24"),e.setAttribute("fill","none"),e.style.marginLeft="-6px"}(d,c),t.append(d,i,l,r),document.body.appendChild(t)}n?(i.innerText="Preview backend disconnected.",d.innerHTML='<g clip-path="url(#clip0_6013_33858)">\n<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>\n</g>\n<defs>\n<clipPath id="clip0_6013_33858">\n<rect width="24" height="24" fill="white"/>\n</clipPath>\n</defs>'):(d.innerHTML='<g clip-path="url(#clip0_6083_34804)">\n<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>\n</g>\n<defs>\n<clipPath id="clip0_6083_34804">\n<rect width="24" height="24" fill="white"/>\n</clipPath>\n</defs>',i.innerText="Preview backend running in this workspace."),i.setAttribute("id",t)}"loading"===document.readyState?window.addEventListener("DOMContentLoaded",i):i()},t.validateArgCount=function(e,t,r,a){let n;if(a<t?n="at least "+t:a>r&&(n=0===r?"none":"no more than "+r),n){throw new Error(e+" failed: Was called with "+a+(1===a?" argument.":" arguments.")+" Expects "+n+".")}},t.validateCallback=function(e,t,r,a){if((!a||r)&&"function"!==typeof r)throw new Error(F(e,t)+"must be a valid function.")},t.validateContextObject=function(e,t,r,a){if((!a||r)&&("object"!==typeof r||null===r))throw new Error(F(e,t)+"must be a valid context object.")},t.validateIndexedDBOpenable=function(){return new Promise((e,t)=>{try{let r=!0;const a="validate-browser-context-for-indexeddb-analytics-module",n=self.indexedDB.open(a);n.onsuccess=()=>{n.result.close(),r||self.indexedDB.deleteDatabase(a),e(!0)},n.onupgradeneeded=()=>{r=!1},n.onerror=()=>{var e;t((null===(e=n.error)||void 0===e?void 0:e.message)||"")}}catch(r){t(r)}})},t.validateNamespace=function(e,t,r){if((!r||t)&&"string"!==typeof t)throw new Error(F(e,"namespace")+"must be a valid firebase namespace.")}},1761:(e,t)=>{"use strict";function r(e,t){var r=e.length;e.push(t);e:for(;0<r;){var a=r-1>>>1,n=e[a];if(!(0<s(n,t)))break e;e[a]=t,e[r]=n,r=a}}function a(e){return 0===e.length?null:e[0]}function n(e){if(0===e.length)return null;var t=e[0],r=e.pop();if(r!==t){e[0]=r;e:for(var a=0,n=e.length,i=n>>>1;a<i;){var o=2*(a+1)-1,l=e[o],c=o+1,d=e[c];if(0>s(l,r))c<n&&0>s(d,l)?(e[a]=d,e[c]=r,a=c):(e[a]=l,e[o]=r,a=o);else{if(!(c<n&&0>s(d,r)))break e;e[a]=d,e[c]=r,a=c}}}return t}function s(e,t){var r=e.sortIndex-t.sortIndex;return 0!==r?r:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],d=[],u=1,h=null,m=3,f=!1,g=!1,p=!1,x="function"===typeof setTimeout?setTimeout:null,y="function"===typeof clearTimeout?clearTimeout:null,v="undefined"!==typeof setImmediate?setImmediate:null;function b(e){for(var t=a(d);null!==t;){if(null===t.callback)n(d);else{if(!(t.startTime<=e))break;n(d),t.sortIndex=t.expirationTime,r(c,t)}t=a(d)}}function w(e){if(p=!1,b(e),!g)if(null!==a(c))g=!0,P(k);else{var t=a(d);null!==t&&F(w,t.startTime-e)}}function k(e,r){g=!1,p&&(p=!1,y(_),_=-1),f=!0;var s=m;try{for(b(r),h=a(c);null!==h&&(!(h.expirationTime>r)||e&&!C());){var i=h.callback;if("function"===typeof i){h.callback=null,m=h.priorityLevel;var o=i(h.expirationTime<=r);r=t.unstable_now(),"function"===typeof o?h.callback=o:h===a(c)&&n(c),b(r)}else n(c);h=a(c)}if(null!==h)var l=!0;else{var u=a(d);null!==u&&F(w,u.startTime-r),l=!1}return l}finally{h=null,m=s,f=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var N,j=!1,S=null,_=-1,E=5,A=-1;function C(){return!(t.unstable_now()-A<E)}function I(){if(null!==S){var e=t.unstable_now();A=e;var r=!0;try{r=S(!0,e)}finally{r?N():(j=!1,S=null)}}else j=!1}if("function"===typeof v)N=function(){v(I)};else if("undefined"!==typeof MessageChannel){var T=new MessageChannel,D=T.port2;T.port1.onmessage=I,N=function(){D.postMessage(null)}}else N=function(){x(I,0)};function P(e){S=e,j||(j=!0,N())}function F(e,r){_=x(function(){e(t.unstable_now())},r)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){g||f||(g=!0,P(k))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return m},t.unstable_getFirstCallbackNode=function(){return a(c)},t.unstable_next=function(e){switch(m){case 1:case 2:case 3:var t=3;break;default:t=m}var r=m;m=t;try{return e()}finally{m=r}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var r=m;m=e;try{return t()}finally{m=r}},t.unstable_scheduleCallback=function(e,n,s){var i=t.unstable_now();switch("object"===typeof s&&null!==s?s="number"===typeof(s=s.delay)&&0<s?i+s:i:s=i,e){case 1:var o=-1;break;case 2:o=250;break;case 5:o=1073741823;break;case 4:o=1e4;break;default:o=5e3}return e={id:u++,callback:n,priorityLevel:e,startTime:s,expirationTime:o=s+o,sortIndex:-1},s>i?(e.sortIndex=s,r(d,e),null===a(c)&&e===a(d)&&(p?(y(_),_=-1):p=!0,F(w,s-i))):(e.sortIndex=o,r(c,e),g||f||(g=!0,P(k))),e},t.unstable_shouldYield=C,t.unstable_wrapCallback=function(e){var t=m;return function(){var r=m;m=t;try{return e.apply(this,arguments)}finally{m=r}}}},1942:(e,t,r)=>{(function(){"use strict";var t;function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}function a(e,t,r){r||(r=0);var a=Array(16);if("string"===typeof t)for(var n=0;16>n;++n)a[n]=t.charCodeAt(r++)|t.charCodeAt(r++)<<8|t.charCodeAt(r++)<<16|t.charCodeAt(r++)<<24;else for(n=0;16>n;++n)a[n]=t[r++]|t[r++]<<8|t[r++]<<16|t[r++]<<24;t=e.g[0],r=e.g[1],n=e.g[2];var s=e.g[3],i=t+(s^r&(n^s))+a[0]+3614090360&4294967295;i=(r=(n=(s=(t=(r=(n=(s=(t=(r=(n=(s=(t=(r=(n=(s=(t=(r=(n=(s=(t=(r=(n=(s=(t=(r=(n=(s=(t=(r=(n=(s=(t=(r=(n=(s=(t=(r=(n=(s=(t=(r=(n=(s=(t=(r=(n=(s=(t=(r=(n=(s=(t=(r=(n=(s=(t=(r=(n=(s=(t=r+(i<<7&4294967295|i>>>25))+((i=s+(n^t&(r^n))+a[1]+3905402710&4294967295)<<12&4294967295|i>>>20))+((i=n+(r^s&(t^r))+a[2]+606105819&4294967295)<<17&4294967295|i>>>15))+((i=r+(t^n&(s^t))+a[3]+3250441966&4294967295)<<22&4294967295|i>>>10))+((i=t+(s^r&(n^s))+a[4]+4118548399&4294967295)<<7&4294967295|i>>>25))+((i=s+(n^t&(r^n))+a[5]+1200080426&4294967295)<<12&4294967295|i>>>20))+((i=n+(r^s&(t^r))+a[6]+2821735955&4294967295)<<17&4294967295|i>>>15))+((i=r+(t^n&(s^t))+a[7]+4249261313&4294967295)<<22&4294967295|i>>>10))+((i=t+(s^r&(n^s))+a[8]+1770035416&4294967295)<<7&4294967295|i>>>25))+((i=s+(n^t&(r^n))+a[9]+2336552879&4294967295)<<12&4294967295|i>>>20))+((i=n+(r^s&(t^r))+a[10]+4294925233&4294967295)<<17&4294967295|i>>>15))+((i=r+(t^n&(s^t))+a[11]+2304563134&4294967295)<<22&4294967295|i>>>10))+((i=t+(s^r&(n^s))+a[12]+1804603682&4294967295)<<7&4294967295|i>>>25))+((i=s+(n^t&(r^n))+a[13]+4254626195&4294967295)<<12&4294967295|i>>>20))+((i=n+(r^s&(t^r))+a[14]+2792965006&4294967295)<<17&4294967295|i>>>15))+((i=r+(t^n&(s^t))+a[15]+1236535329&4294967295)<<22&4294967295|i>>>10))+((i=t+(n^s&(r^n))+a[1]+4129170786&4294967295)<<5&4294967295|i>>>27))+((i=s+(r^n&(t^r))+a[6]+3225465664&4294967295)<<9&4294967295|i>>>23))+((i=n+(t^r&(s^t))+a[11]+643717713&4294967295)<<14&4294967295|i>>>18))+((i=r+(s^t&(n^s))+a[0]+3921069994&4294967295)<<20&4294967295|i>>>12))+((i=t+(n^s&(r^n))+a[5]+3593408605&4294967295)<<5&4294967295|i>>>27))+((i=s+(r^n&(t^r))+a[10]+38016083&4294967295)<<9&4294967295|i>>>23))+((i=n+(t^r&(s^t))+a[15]+3634488961&4294967295)<<14&4294967295|i>>>18))+((i=r+(s^t&(n^s))+a[4]+3889429448&4294967295)<<20&4294967295|i>>>12))+((i=t+(n^s&(r^n))+a[9]+568446438&4294967295)<<5&4294967295|i>>>27))+((i=s+(r^n&(t^r))+a[14]+3275163606&4294967295)<<9&4294967295|i>>>23))+((i=n+(t^r&(s^t))+a[3]+4107603335&4294967295)<<14&4294967295|i>>>18))+((i=r+(s^t&(n^s))+a[8]+1163531501&4294967295)<<20&4294967295|i>>>12))+((i=t+(n^s&(r^n))+a[13]+2850285829&4294967295)<<5&4294967295|i>>>27))+((i=s+(r^n&(t^r))+a[2]+4243563512&4294967295)<<9&4294967295|i>>>23))+((i=n+(t^r&(s^t))+a[7]+1735328473&4294967295)<<14&4294967295|i>>>18))+((i=r+(s^t&(n^s))+a[12]+2368359562&4294967295)<<20&4294967295|i>>>12))+((i=t+(r^n^s)+a[5]+4294588738&4294967295)<<4&4294967295|i>>>28))+((i=s+(t^r^n)+a[8]+2272392833&4294967295)<<11&4294967295|i>>>21))+((i=n+(s^t^r)+a[11]+1839030562&4294967295)<<16&4294967295|i>>>16))+((i=r+(n^s^t)+a[14]+4259657740&4294967295)<<23&4294967295|i>>>9))+((i=t+(r^n^s)+a[1]+2763975236&4294967295)<<4&4294967295|i>>>28))+((i=s+(t^r^n)+a[4]+1272893353&4294967295)<<11&4294967295|i>>>21))+((i=n+(s^t^r)+a[7]+4139469664&4294967295)<<16&4294967295|i>>>16))+((i=r+(n^s^t)+a[10]+3200236656&4294967295)<<23&4294967295|i>>>9))+((i=t+(r^n^s)+a[13]+681279174&4294967295)<<4&4294967295|i>>>28))+((i=s+(t^r^n)+a[0]+3936430074&4294967295)<<11&4294967295|i>>>21))+((i=n+(s^t^r)+a[3]+3572445317&4294967295)<<16&4294967295|i>>>16))+((i=r+(n^s^t)+a[6]+76029189&4294967295)<<23&4294967295|i>>>9))+((i=t+(r^n^s)+a[9]+3654602809&4294967295)<<4&4294967295|i>>>28))+((i=s+(t^r^n)+a[12]+3873151461&4294967295)<<11&4294967295|i>>>21))+((i=n+(s^t^r)+a[15]+530742520&4294967295)<<16&4294967295|i>>>16))+((i=r+(n^s^t)+a[2]+3299628645&4294967295)<<23&4294967295|i>>>9))+((i=t+(n^(r|~s))+a[0]+4096336452&4294967295)<<6&4294967295|i>>>26))+((i=s+(r^(t|~n))+a[7]+1126891415&4294967295)<<10&4294967295|i>>>22))+((i=n+(t^(s|~r))+a[14]+2878612391&4294967295)<<15&4294967295|i>>>17))+((i=r+(s^(n|~t))+a[5]+4237533241&4294967295)<<21&4294967295|i>>>11))+((i=t+(n^(r|~s))+a[12]+1700485571&4294967295)<<6&4294967295|i>>>26))+((i=s+(r^(t|~n))+a[3]+2399980690&4294967295)<<10&4294967295|i>>>22))+((i=n+(t^(s|~r))+a[10]+4293915773&4294967295)<<15&4294967295|i>>>17))+((i=r+(s^(n|~t))+a[1]+2240044497&4294967295)<<21&4294967295|i>>>11))+((i=t+(n^(r|~s))+a[8]+1873313359&4294967295)<<6&4294967295|i>>>26))+((i=s+(r^(t|~n))+a[15]+4264355552&4294967295)<<10&4294967295|i>>>22))+((i=n+(t^(s|~r))+a[6]+2734768916&4294967295)<<15&4294967295|i>>>17))+((i=r+(s^(n|~t))+a[13]+1309151649&4294967295)<<21&4294967295|i>>>11))+((s=(t=r+((i=t+(n^(r|~s))+a[4]+4149444226&4294967295)<<6&4294967295|i>>>26))+((i=s+(r^(t|~n))+a[11]+3174756917&4294967295)<<10&4294967295|i>>>22))^((n=s+((i=n+(t^(s|~r))+a[2]+718787259&4294967295)<<15&4294967295|i>>>17))|~t))+a[9]+3951481745&4294967295,e.g[0]=e.g[0]+t&4294967295,e.g[1]=e.g[1]+(n+(i<<21&4294967295|i>>>11))&4294967295,e.g[2]=e.g[2]+n&4294967295,e.g[3]=e.g[3]+s&4294967295}function n(e,t){this.h=t;for(var r=[],a=!0,n=e.length-1;0<=n;n--){var s=0|e[n];a&&s==t||(r[n]=s,a=!1)}this.g=r}!function(e,t){function r(){}r.prototype=t.prototype,e.D=t.prototype,e.prototype=new r,e.prototype.constructor=e,e.C=function(e,r,a){for(var n=Array(arguments.length-2),s=2;s<arguments.length;s++)n[s-2]=arguments[s];return t.prototype[r].apply(e,n)}}(r,function(){this.blockSize=-1}),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0},r.prototype.u=function(e,t){void 0===t&&(t=e.length);for(var r=t-this.blockSize,n=this.B,s=this.h,i=0;i<t;){if(0==s)for(;i<=r;)a(this,e,i),i+=this.blockSize;if("string"===typeof e){for(;i<t;)if(n[s++]=e.charCodeAt(i++),s==this.blockSize){a(this,n),s=0;break}}else for(;i<t;)if(n[s++]=e[i++],s==this.blockSize){a(this,n),s=0;break}}this.h=s,this.o+=t},r.prototype.v=function(){var e=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;var r=8*this.o;for(t=e.length-8;t<e.length;++t)e[t]=255&r,r/=256;for(this.u(e),e=Array(16),t=r=0;4>t;++t)for(var a=0;32>a;a+=8)e[r++]=this.g[t]>>>a&255;return e};var s={};function i(e){return-128<=e&&128>e?function(e,t){var r=s;return Object.prototype.hasOwnProperty.call(r,e)?r[e]:r[e]=t(e)}(e,function(e){return new n([0|e],0>e?-1:0)}):new n([0|e],0>e?-1:0)}function o(e){if(isNaN(e)||!isFinite(e))return l;if(0>e)return m(o(-e));for(var t=[],r=1,a=0;e>=r;a++)t[a]=e/r|0,r*=4294967296;return new n(t,0)}var l=i(0),c=i(1),d=i(16777216);function u(e){if(0!=e.h)return!1;for(var t=0;t<e.g.length;t++)if(0!=e.g[t])return!1;return!0}function h(e){return-1==e.h}function m(e){for(var t=e.g.length,r=[],a=0;a<t;a++)r[a]=~e.g[a];return new n(r,~e.h).add(c)}function f(e,t){return e.add(m(t))}function g(e,t){for(;(65535&e[t])!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function p(e,t){this.g=e,this.h=t}function x(e,t){if(u(t))throw Error("division by zero");if(u(e))return new p(l,l);if(h(e))return t=x(m(e),t),new p(m(t.g),m(t.h));if(h(t))return t=x(e,m(t)),new p(m(t.g),t.h);if(30<e.g.length){if(h(e)||h(t))throw Error("slowDivide_ only works with positive integers.");for(var r=c,a=t;0>=a.l(e);)r=y(r),a=y(a);var n=v(r,1),s=v(a,1);for(a=v(a,2),r=v(r,2);!u(a);){var i=s.add(a);0>=i.l(e)&&(n=n.add(r),s=i),a=v(a,1),r=v(r,1)}return t=f(e,n.j(t)),new p(n,t)}for(n=l;0<=e.l(t);){for(r=Math.max(1,Math.floor(e.m()/t.m())),a=48>=(a=Math.ceil(Math.log(r)/Math.LN2))?1:Math.pow(2,a-48),i=(s=o(r)).j(t);h(i)||0<i.l(e);)i=(s=o(r-=a)).j(t);u(s)&&(s=c),n=n.add(s),e=f(e,i)}return new p(n,e)}function y(e){for(var t=e.g.length+1,r=[],a=0;a<t;a++)r[a]=e.i(a)<<1|e.i(a-1)>>>31;return new n(r,e.h)}function v(e,t){var r=t>>5;t%=32;for(var a=e.g.length-r,s=[],i=0;i<a;i++)s[i]=0<t?e.i(i+r)>>>t|e.i(i+r+1)<<32-t:e.i(i+r);return new n(s,e.h)}(t=n.prototype).m=function(){if(h(this))return-m(this).m();for(var e=0,t=1,r=0;r<this.g.length;r++){var a=this.i(r);e+=(0<=a?a:4294967296+a)*t,t*=4294967296}return e},t.toString=function(e){if(2>(e=e||10)||36<e)throw Error("radix out of range: "+e);if(u(this))return"0";if(h(this))return"-"+m(this).toString(e);for(var t=o(Math.pow(e,6)),r=this,a="";;){var n=x(r,t).g,s=((0<(r=f(r,n.j(t))).g.length?r.g[0]:r.h)>>>0).toString(e);if(u(r=n))return s+a;for(;6>s.length;)s="0"+s;a=s+a}},t.i=function(e){return 0>e?0:e<this.g.length?this.g[e]:this.h},t.l=function(e){return h(e=f(this,e))?-1:u(e)?0:1},t.abs=function(){return h(this)?m(this):this},t.add=function(e){for(var t=Math.max(this.g.length,e.g.length),r=[],a=0,s=0;s<=t;s++){var i=a+(65535&this.i(s))+(65535&e.i(s)),o=(i>>>16)+(this.i(s)>>>16)+(e.i(s)>>>16);a=o>>>16,i&=65535,o&=65535,r[s]=o<<16|i}return new n(r,-2147483648&r[r.length-1]?-1:0)},t.j=function(e){if(u(this)||u(e))return l;if(h(this))return h(e)?m(this).j(m(e)):m(m(this).j(e));if(h(e))return m(this.j(m(e)));if(0>this.l(d)&&0>e.l(d))return o(this.m()*e.m());for(var t=this.g.length+e.g.length,r=[],a=0;a<2*t;a++)r[a]=0;for(a=0;a<this.g.length;a++)for(var s=0;s<e.g.length;s++){var i=this.i(a)>>>16,c=65535&this.i(a),f=e.i(s)>>>16,p=65535&e.i(s);r[2*a+2*s]+=c*p,g(r,2*a+2*s),r[2*a+2*s+1]+=i*p,g(r,2*a+2*s+1),r[2*a+2*s+1]+=c*f,g(r,2*a+2*s+1),r[2*a+2*s+2]+=i*f,g(r,2*a+2*s+2)}for(a=0;a<t;a++)r[a]=r[2*a+1]<<16|r[2*a];for(a=t;a<2*t;a++)r[a]=0;return new n(r,0)},t.A=function(e){return x(this,e).h},t.and=function(e){for(var t=Math.max(this.g.length,e.g.length),r=[],a=0;a<t;a++)r[a]=this.i(a)&e.i(a);return new n(r,this.h&e.h)},t.or=function(e){for(var t=Math.max(this.g.length,e.g.length),r=[],a=0;a<t;a++)r[a]=this.i(a)|e.i(a);return new n(r,this.h|e.h)},t.xor=function(e){for(var t=Math.max(this.g.length,e.g.length),r=[],a=0;a<t;a++)r[a]=this.i(a)^e.i(a);return new n(r,this.h^e.h)},r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,e.exports.Md5=r,n.prototype.add=n.prototype.add,n.prototype.multiply=n.prototype.j,n.prototype.modulo=n.prototype.A,n.prototype.compare=n.prototype.l,n.prototype.toNumber=n.prototype.m,n.prototype.toString=n.prototype.toString,n.prototype.getBits=n.prototype.i,n.fromNumber=o,n.fromString=function e(t,r){if(0==t.length)throw Error("number format error: empty string");if(2>(r=r||10)||36<r)throw Error("radix out of range: "+r);if("-"==t.charAt(0))return m(e(t.substring(1),r));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var a=o(Math.pow(r,8)),n=l,s=0;s<t.length;s+=8){var i=Math.min(8,t.length-s),c=parseInt(t.substring(s,s+i),r);8>i?(i=o(Math.pow(r,i)),n=n.j(i).add(o(c))):n=(n=n.j(a)).add(o(c))}return n},e.exports.Integer=n}).apply("undefined"!==typeof r.g?r.g:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},2045:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(1494);const n="[DEFAULT]";class s{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const e=new a.Deferred;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:t});r&&e.resolve(r)}catch(r){}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const r=this.normalizeInstanceIdentifier(null===e||void 0===e?void 0:e.identifier),a=null!==(t=null===e||void 0===e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(r)&&!this.shouldAutoInitialize()){if(a)return null;throw Error("Service ".concat(this.name," is not available"))}try{return this.getOrInitializeService({instanceIdentifier:r})}catch(n){if(a)return null;throw n}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error("Mismatching Component ".concat(e.name," for Provider ").concat(this.name,"."));if(this.component)throw Error("Component for ".concat(this.name," has already been provided"));if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:n})}catch(t){}for(const[e,r]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(e);try{const e=this.getOrInitializeService({instanceIdentifier:a});r.resolve(e)}catch(t){}}}}clearInstance(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n;this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(e=>"INTERNAL"in e).map(e=>e.INTERNAL.delete()),...e.filter(e=>"_delete"in e).map(e=>e._delete())])}isComponentSet(){return null!=this.component}isInitialized(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n;return this.instances.has(e)}getOptions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n;return this.instancesOptions.get(e)||{}}initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error("".concat(this.name,"(").concat(r,") has already been initialized"));if(!this.isComponentSet())throw Error("Component ".concat(this.name," has not been registered yet"));const a=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[n,s]of this.instancesDeferred.entries()){r===this.normalizeInstanceIdentifier(n)&&s.resolve(a)}return a}onInit(e,t){var r;const a=this.normalizeInstanceIdentifier(t),n=null!==(r=this.onInitCallbacks.get(a))&&void 0!==r?r:new Set;n.add(e),this.onInitCallbacks.set(a,n);const s=this.instances.get(a);return s&&e(s,a),()=>{n.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const n of r)try{n(e,t)}catch(a){}}getOrInitializeService(e){let{instanceIdentifier:t,options:r={}}=e,a=this.instances.get(t);if(!a&&this.component&&(a=this.component.instanceFactory(this.container,{instanceIdentifier:(s=t,s===n?void 0:s),options:r}),this.instances.set(t,a),this.instancesOptions.set(t,r),this.invokeOnInitCallbacks(a,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,a)}catch(i){}var s;return a||null}normalizeInstanceIdentifier(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n;return this.component?this.component.multipleInstances?e:n:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}t.Component=class{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}},t.ComponentContainer=class{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error("Component ".concat(e.name," has already been registered with ").concat(this.name));t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new s(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}},t.Provider=s},2049:(e,t)=>{"use strict";var r=Symbol.for("react.element"),a=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),m=Symbol.iterator;var f={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},g=Object.assign,p={};function x(e,t,r){this.props=e,this.context=t,this.refs=p,this.updater=r||f}function y(){}function v(e,t,r){this.props=e,this.context=t,this.refs=p,this.updater=r||f}x.prototype.isReactComponent={},x.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},x.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},y.prototype=x.prototype;var b=v.prototype=new y;b.constructor=v,g(b,x.prototype),b.isPureReactComponent=!0;var w=Array.isArray,k=Object.prototype.hasOwnProperty,N={current:null},j={key:!0,ref:!0,__self:!0,__source:!0};function S(e,t,a){var n,s={},i=null,o=null;if(null!=t)for(n in void 0!==t.ref&&(o=t.ref),void 0!==t.key&&(i=""+t.key),t)k.call(t,n)&&!j.hasOwnProperty(n)&&(s[n]=t[n]);var l=arguments.length-2;if(1===l)s.children=a;else if(1<l){for(var c=Array(l),d=0;d<l;d++)c[d]=arguments[d+2];s.children=c}if(e&&e.defaultProps)for(n in l=e.defaultProps)void 0===s[n]&&(s[n]=l[n]);return{$$typeof:r,type:e,key:i,ref:o,props:s,_owner:N.current}}function _(e){return"object"===typeof e&&null!==e&&e.$$typeof===r}var E=/\/+/g;function A(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(e){return t[e]})}(""+e.key):t.toString(36)}function C(e,t,n,s,i){var o=typeof e;"undefined"!==o&&"boolean"!==o||(e=null);var l=!1;if(null===e)l=!0;else switch(o){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case r:case a:l=!0}}if(l)return i=i(l=e),e=""===s?"."+A(l,0):s,w(i)?(n="",null!=e&&(n=e.replace(E,"$&/")+"/"),C(i,t,n,"",function(e){return e})):null!=i&&(_(i)&&(i=function(e,t){return{$$typeof:r,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(i,n+(!i.key||l&&l.key===i.key?"":(""+i.key).replace(E,"$&/")+"/")+e)),t.push(i)),1;if(l=0,s=""===s?".":s+":",w(e))for(var c=0;c<e.length;c++){var d=s+A(o=e[c],c);l+=C(o,t,n,d,i)}else if(d=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=m&&e[m]||e["@@iterator"])?e:null}(e),"function"===typeof d)for(e=d.call(e),c=0;!(o=e.next()).done;)l+=C(o=o.value,t,n,d=s+A(o,c++),i);else if("object"===o)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function I(e,t,r){if(null==e)return e;var a=[],n=0;return C(e,a,"","",function(e){return t.call(r,e,n++)}),a}function T(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)},function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var D={current:null},P={transition:null},F={ReactCurrentDispatcher:D,ReactCurrentBatchConfig:P,ReactCurrentOwner:N};function L(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:I,forEach:function(e,t,r){I(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return I(e,function(){t++}),t},toArray:function(e){return I(e,function(e){return e})||[]},only:function(e){if(!_(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=x,t.Fragment=n,t.Profiler=i,t.PureComponent=v,t.StrictMode=s,t.Suspense=d,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=F,t.act=L,t.cloneElement=function(e,t,a){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=g({},e.props),s=e.key,i=e.ref,o=e._owner;if(null!=t){if(void 0!==t.ref&&(i=t.ref,o=N.current),void 0!==t.key&&(s=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)k.call(t,c)&&!j.hasOwnProperty(c)&&(n[c]=void 0===t[c]&&void 0!==l?l[c]:t[c])}var c=arguments.length-2;if(1===c)n.children=a;else if(1<c){l=Array(c);for(var d=0;d<c;d++)l[d]=arguments[d+2];n.children=l}return{$$typeof:r,type:e.type,key:s,ref:i,props:n,_owner:o}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:o,_context:e},e.Consumer=e},t.createElement=S,t.createFactory=function(e){var t=S.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=_,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:T}},t.memo=function(e,t){return{$$typeof:u,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=P.transition;P.transition={};try{e()}finally{P.transition=t}},t.unstable_act=L,t.useCallback=function(e,t){return D.current.useCallback(e,t)},t.useContext=function(e){return D.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return D.current.useDeferredValue(e)},t.useEffect=function(e,t){return D.current.useEffect(e,t)},t.useId=function(){return D.current.useId()},t.useImperativeHandle=function(e,t,r){return D.current.useImperativeHandle(e,t,r)},t.useInsertionEffect=function(e,t){return D.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return D.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return D.current.useMemo(e,t)},t.useReducer=function(e,t,r){return D.current.useReducer(e,t,r)},t.useRef=function(e){return D.current.useRef(e)},t.useState=function(e){return D.current.useState(e)},t.useSyncExternalStore=function(e,t,r){return D.current.useSyncExternalStore(e,t,r)},t.useTransition=function(){return D.current.useTransition()},t.version="18.3.1"},2226:(e,t,r)=>{"use strict";r.d(t,{$b:()=>n,Vy:()=>c});const a=[];var n;!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(n||(n={}));const s={debug:n.DEBUG,verbose:n.VERBOSE,info:n.INFO,warn:n.WARN,error:n.ERROR,silent:n.SILENT},i=n.INFO,o={[n.DEBUG]:"log",[n.VERBOSE]:"log",[n.INFO]:"info",[n.WARN]:"warn",[n.ERROR]:"error"},l=function(e,t){if(t<e.logLevel)return;const r=(new Date).toISOString(),a=o[t];if(!a)throw new Error("Attempted to log a message with an invalid logType (value: ".concat(t,")"));for(var n=arguments.length,s=new Array(n>2?n-2:0),i=2;i<n;i++)s[i-2]=arguments[i];console[a]("[".concat(r,"]  ").concat(e.name,":"),...s)};class c{constructor(e){this.name=e,this._logLevel=i,this._logHandler=l,this._userLogHandler=null,a.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in n))throw new TypeError('Invalid value "'.concat(e,'" assigned to `logLevel`'));this._logLevel=e}setLogLevel(e){this._logLevel="string"===typeof e?s[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!==typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this._userLogHandler&&this._userLogHandler(this,n.DEBUG,...t),this._logHandler(this,n.DEBUG,...t)}log(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this._userLogHandler&&this._userLogHandler(this,n.VERBOSE,...t),this._logHandler(this,n.VERBOSE,...t)}info(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this._userLogHandler&&this._userLogHandler(this,n.INFO,...t),this._logHandler(this,n.INFO,...t)}warn(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this._userLogHandler&&this._userLogHandler(this,n.WARN,...t),this._logHandler(this,n.WARN,...t)}error(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this._userLogHandler&&this._userLogHandler(this,n.ERROR,...t),this._logHandler(this,n.ERROR,...t)}}},2284:(e,t,r)=>{"use strict";function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}r.d(t,{A:()=>a})},2410:(e,t,r)=>{"use strict";r.r(t),r.d(t,{auth:()=>x,db:()=>p,default:()=>v,storage:()=>y});var a=r(815),n=r(306),s=r(2644),i=r(2423),o=r(9661);const l="WlpoYVN5QW5MbXRsaE9VVUFidFJjT2c2NGRYZENMYmx0dl9pRTRF",c="Z2FyZGVuLWMwYjUwLmZpcmViYXNlYXBwLmNvbQ==",d="Z2FyZGVuLWMwYjUw",u="Z2FyZGVuLWMwYjUwLmZpcmViYXNlc3RvcmFnZS5hcHA=",h="NDY3MzQ0MzU0OTk3",m="MTo0NjczNDQzNTQ5OTc6d2ViOjNjMzM5N2UwMTc2MDYwYmIwYzk4ZmM=",f="Ry03TE1MOTNRRFRGCg==",g=(()=>{try{const e=performance.now(),t=(()=>{const e={apiKey:{NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_ENV:"production"}.REACT_APP_FIREBASE_API_KEY||(0,o.Yc)(l),authDomain:{NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_ENV:"production"}.REACT_APP_FIREBASE_AUTH_DOMAIN||(0,o.Yc)(c),projectId:{NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_ENV:"production"}.REACT_APP_FIREBASE_PROJECT_ID||(0,o.Yc)(d),storageBucket:{NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_ENV:"production"}.REACT_APP_FIREBASE_STORAGE_BUCKET||(0,o.Yc)(u),messagingSenderId:{NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_ENV:"production"}.REACT_APP_FIREBASE_MESSAGING_SENDER_ID||(0,o.Yc)(h),appId:{NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_ENV:"production"}.REACT_APP_FIREBASE_APP_ID||(0,o.Yc)(m),measurementId:{NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_ENV:"production"}.REACT_APP_FIREBASE_MEASUREMENT_ID||(0,o.Yc)(f)};return Object.defineProperty(e,Symbol.for("firebase"),{value:(new Date).getTime(),enumerable:!1}),e})();if(performance.now()-e>100)throw new Error("Debugging detected");const r=(0,a.Wp)(t);return setTimeout(()=>{t.apiKey=null,t.appId=null,Object.freeze(t)},0),r}catch(e){return console.error("Error initializing Firebase"),window.location.reload(),null}})(),p=(0,n.aU)(g);(0,n.ol)(p).catch(e=>{"failed-precondition"===e.code?console.warn("Multiple tabs open, persistence can only be enabled in one tab at a time."):"unimplemented"===e.code&&console.warn("The current browser does not support persistence.")});const x=(0,s.xI)(g);x.onAuthStateChanged(e=>{e&&e.getIdToken(!0)});const y=(0,i.c7)(g);const v=g},2423:(e,t,r)=>{"use strict";r.d(t,{XR:()=>Se,qk:()=>je,c7:()=>Ee,KR:()=>_e,D:()=>Ne});var a=r(8791),n=r(498),s=r(6863);const i="firebasestorage.googleapis.com",o="storageBucket";class l extends n.g{constructor(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;super(u(e),"Firebase Storage: ".concat(t," (").concat(u(e),")")),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,l.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return u(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message="".concat(this._baseMessage,"\n").concat(this.customData.serverResponse):this.message=this._baseMessage}}var c,d;function u(e){return"storage/"+e}function h(){return new l(c.UNKNOWN,"An unknown error occurred, please check the error payload for server response.")}function m(){return new l(c.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function f(){return new l(c.CANCELED,"User canceled the upload/download.")}function g(){return new l(c.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function p(e){return new l(c.INVALID_ARGUMENT,e)}function x(){return new l(c.APP_DELETED,"The Firebase app was deleted.")}function y(e,t){return new l(c.INVALID_FORMAT,"String does not match format '"+e+"': "+t)}function v(e){throw new l(c.INTERNAL_ERROR,"Internal error: "+e)}!function(e){e.UNKNOWN="unknown",e.OBJECT_NOT_FOUND="object-not-found",e.BUCKET_NOT_FOUND="bucket-not-found",e.PROJECT_NOT_FOUND="project-not-found",e.QUOTA_EXCEEDED="quota-exceeded",e.UNAUTHENTICATED="unauthenticated",e.UNAUTHORIZED="unauthorized",e.UNAUTHORIZED_APP="unauthorized-app",e.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",e.INVALID_CHECKSUM="invalid-checksum",e.CANCELED="canceled",e.INVALID_EVENT_NAME="invalid-event-name",e.INVALID_URL="invalid-url",e.INVALID_DEFAULT_BUCKET="invalid-default-bucket",e.NO_DEFAULT_BUCKET="no-default-bucket",e.CANNOT_SLICE_BLOB="cannot-slice-blob",e.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",e.NO_DOWNLOAD_URL="no-download-url",e.INVALID_ARGUMENT="invalid-argument",e.INVALID_ARGUMENT_COUNT="invalid-argument-count",e.APP_DELETED="app-deleted",e.INVALID_ROOT_OPERATION="invalid-root-operation",e.INVALID_FORMAT="invalid-format",e.INTERNAL_ERROR="internal-error",e.UNSUPPORTED_ENVIRONMENT="unsupported-environment"}(c||(c={}));class b{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return 0===this.path.length}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let r;try{r=b.makeFromUrl(e,t)}catch(n){return new b(e,"")}if(""===r.path)return r;throw a=e,new l(c.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+a+"'.");var a}static makeFromUrl(e,t){let r=null;const a="([A-Za-z0-9.\\-_]+)";const n=new RegExp("^gs://"+a+"(/(.*))?$","i");function s(e){e.path_=decodeURIComponent(e.path)}const o=t.replace(/[.]/g,"\\."),d=[{regex:n,indices:{bucket:1,path:3},postModify:function(e){"/"===e.path.charAt(e.path.length-1)&&(e.path_=e.path_.slice(0,-1))}},{regex:new RegExp("^https?://".concat(o,"/").concat("v[A-Za-z0-9_]+","/b/").concat(a,"/o").concat("(/([^?#]*).*)?$"),"i"),indices:{bucket:1,path:3},postModify:s},{regex:new RegExp("^https?://".concat(t===i?"(?:storage.googleapis.com|storage.cloud.google.com)":t,"/").concat(a,"/").concat("([^?#]*)"),"i"),indices:{bucket:1,path:2},postModify:s}];for(let i=0;i<d.length;i++){const t=d[i],a=t.regex.exec(e);if(a){const e=a[t.indices.bucket];let n=a[t.indices.path];n||(n=""),r=new b(e,n),t.postModify(r);break}}if(null==r)throw function(e){return new l(c.INVALID_URL,"Invalid URL '"+e+"'.")}(e);return r}}class w{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(){}}function k(e){return"string"===typeof e||e instanceof String}function N(e){return j()&&e instanceof Blob}function j(){return"undefined"!==typeof Blob}function S(e,t,r,a){if(a<t)throw p("Invalid value for '".concat(e,"'. Expected ").concat(t," or greater."));if(a>r)throw p("Invalid value for '".concat(e,"'. Expected ").concat(r," or less."))}function _(e,t,r){let a=t;return null==r&&(a="https://".concat(t)),"".concat(r,"://").concat(a,"/v0").concat(e)}function E(e){const t=encodeURIComponent;let r="?";for(const a in e)if(e.hasOwnProperty(a)){r=r+(t(a)+"="+t(e[a]))+"&"}return r=r.slice(0,-1),r}function A(e,t){const r=e>=500&&e<600,a=-1!==[408,429].indexOf(e),n=-1!==t.indexOf(e);return r||a||n}!function(e){e[e.NO_ERROR=0]="NO_ERROR",e[e.NETWORK_ERROR=1]="NETWORK_ERROR",e[e.ABORT=2]="ABORT"}(d||(d={}));class C{constructor(e,t,r,a,n,s,i,o,l,c,d){let u=!(arguments.length>11&&void 0!==arguments[11])||arguments[11],h=arguments.length>12&&void 0!==arguments[12]&&arguments[12];this.url_=e,this.method_=t,this.headers_=r,this.body_=a,this.successCodes_=n,this.additionalRetryCodes_=s,this.callback_=i,this.errorCallback_=o,this.timeout_=l,this.progressCallback_=c,this.connectionFactory_=d,this.retry=u,this.isUsingEmulator=h,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((e,t)=>{this.resolve_=e,this.reject_=t,this.start_()})}start_(){const e=(e,t)=>{if(t)return void e(!1,new I(!1,null,!0));const r=this.connectionFactory_();this.pendingConnection_=r;const a=e=>{const t=e.loaded,r=e.lengthComputable?e.total:-1;null!==this.progressCallback_&&this.progressCallback_(t,r)};null!==this.progressCallback_&&r.addUploadProgressListener(a),r.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{null!==this.progressCallback_&&r.removeUploadProgressListener(a),this.pendingConnection_=null;const t=r.getErrorCode()===d.NO_ERROR,n=r.getStatus();if(!t||A(n,this.additionalRetryCodes_)&&this.retry){const t=r.getErrorCode()===d.ABORT;return void e(!1,new I(!1,null,t))}const s=-1!==this.successCodes_.indexOf(n);e(!0,new I(s,r))})},t=(e,t)=>{const r=this.resolve_,a=this.reject_,n=t.connection;if(t.wasSuccessCode)try{const e=this.callback_(n,n.getResponse());void 0!==e?r(e):r()}catch(s){a(s)}else if(null!==n){const e=h();e.serverResponse=n.getErrorText(),this.errorCallback_?a(this.errorCallback_(n,e)):a(e)}else if(t.canceled){a(this.appDelete_?x():f())}else{a(m())}};this.canceled_?t(0,new I(!1,null,!0)):this.backoffId_=function(e,t,r){let a=1,n=null,s=null,i=!1,o=0;function l(){return 2===o}let c=!1;function d(){if(!c){c=!0;for(var e=arguments.length,r=new Array(e),a=0;a<e;a++)r[a]=arguments[a];t.apply(null,r)}}function u(t){n=setTimeout(()=>{n=null,e(m,l())},t)}function h(){s&&clearTimeout(s)}function m(e){if(c)return void h();for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];if(e)return h(),void d.call(null,e,...r);if(l()||i)return h(),void d.call(null,e,...r);let s;a<64&&(a*=2),1===o?(o=2,s=0):s=1e3*(a+Math.random()),u(s)}let f=!1;function g(e){f||(f=!0,h(),c||(null!==n?(e||(o=2),clearTimeout(n),u(0)):e||(o=1)))}return u(0),s=setTimeout(()=>{i=!0,g(!0)},r),g}(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,null!==this.backoffId_&&(0,this.backoffId_)(!1),null!==this.pendingConnection_&&this.pendingConnection_.abort()}}class I{constructor(e,t,r){this.wasSuccessCode=e,this.connection=t,this.canceled=!!r}}function T(){return"undefined"!==typeof BlobBuilder?BlobBuilder:"undefined"!==typeof WebKitBlobBuilder?WebKitBlobBuilder:void 0}function D(){const e=T();for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];if(void 0!==e){const t=new e;for(let e=0;e<r.length;e++)t.append(r[e]);return t.getBlob()}if(j())return new Blob(r);throw new l(c.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}function P(e){if("undefined"===typeof atob)throw t="base-64",new l(c.UNSUPPORTED_ENVIRONMENT,"".concat(t," is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information."));var t;return atob(e)}const F="raw",L="base64",M="base64url",R="data_url";class O{constructor(e,t){this.data=e,this.contentType=t||null}}function B(e,t){switch(e){case F:return new O(z(t));case L:case M:return new O(U(e,t));case R:return new O(function(e){const t=new V(e);return t.base64?U(L,t.rest):function(e){let t;try{t=decodeURIComponent(e)}catch(r){throw y(R,"Malformed data URL.")}return z(t)}(t.rest)}(t),new V(t).contentType)}throw h()}function z(e){const t=[];for(let r=0;r<e.length;r++){let a=e.charCodeAt(r);if(a<=127)t.push(a);else if(a<=2047)t.push(192|a>>6,128|63&a);else if(55296===(64512&a)){if(r<e.length-1&&56320===(64512&e.charCodeAt(r+1))){a=65536|(1023&a)<<10|1023&e.charCodeAt(++r),t.push(240|a>>18,128|a>>12&63,128|a>>6&63,128|63&a)}else t.push(239,191,189)}else 56320===(64512&a)?t.push(239,191,189):t.push(224|a>>12,128|a>>6&63,128|63&a)}return new Uint8Array(t)}function U(e,t){switch(e){case L:{const r=-1!==t.indexOf("-"),a=-1!==t.indexOf("_");if(r||a){throw y(e,"Invalid character '"+(r?"-":"_")+"' found: is it base64url encoded?")}break}case M:{const r=-1!==t.indexOf("+"),a=-1!==t.indexOf("/");if(r||a){throw y(e,"Invalid character '"+(r?"+":"/")+"' found: is it base64 encoded?")}t=t.replace(/-/g,"+").replace(/_/g,"/");break}}let r;try{r=P(t)}catch(n){if(n.message.includes("polyfill"))throw n;throw y(e,"Invalid character found")}const a=new Uint8Array(r.length);for(let s=0;s<r.length;s++)a[s]=r.charCodeAt(s);return a}class V{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(null===t)throw y(R,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=t[1]||null;null!=r&&(this.base64=function(e,t){if(!(e.length>=t.length))return!1;return e.substring(e.length-t.length)===t}(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}class q{constructor(e,t){let r=0,a="";N(e)?(this.data_=e,r=e.size,a=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=a}size(){return this.size_}type(){return this.type_}slice(e,t){if(N(this.data_)){const r=function(e,t,r){return e.webkitSlice?e.webkitSlice(t,r):e.mozSlice?e.mozSlice(t,r):e.slice?e.slice(t,r):null}(this.data_,e,t);return null===r?null:new q(r)}{const r=new Uint8Array(this.data_.buffer,e,t-e);return new q(r,!0)}}static getBlob(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];if(j()){const e=t.map(e=>e instanceof q?e.data_:e);return new q(D.apply(null,e))}{const e=t.map(e=>k(e)?B(F,e).data:e.data_);let r=0;e.forEach(e=>{r+=e.byteLength});const a=new Uint8Array(r);let n=0;return e.forEach(e=>{for(let t=0;t<e.length;t++)a[n++]=e[t]}),new q(a,!0)}}uploadData(){return this.data_}}function H(e){let t;try{t=JSON.parse(e)}catch(a){return null}return"object"!==typeof(r=t)||Array.isArray(r)?null:t;var r}function G(e){const t=e.lastIndexOf("/",e.length-2);return-1===t?e:e.slice(t+1)}function W(e,t){return t}class K{constructor(e,t,r,a){this.server=e,this.local=t||e,this.writable=!!r,this.xform=a||W}}let Q=null;function Y(){if(Q)return Q;const e=[];e.push(new K("bucket")),e.push(new K("generation")),e.push(new K("metageneration")),e.push(new K("name","fullPath",!0));const t=new K("name");t.xform=function(e,t){return function(e){return!k(e)||e.length<2?e:G(e)}(t)},e.push(t);const r=new K("size");return r.xform=function(e,t){return void 0!==t?Number(t):t},e.push(r),e.push(new K("timeCreated")),e.push(new K("updated")),e.push(new K("md5Hash",null,!0)),e.push(new K("cacheControl",null,!0)),e.push(new K("contentDisposition",null,!0)),e.push(new K("contentEncoding",null,!0)),e.push(new K("contentLanguage",null,!0)),e.push(new K("contentType",null,!0)),e.push(new K("metadata","customMetadata",!0)),Q=e,Q}function X(e,t,r){const a={type:"file"},n=r.length;for(let s=0;s<n;s++){const e=r[s];a[e.local]=e.xform(a,t[e.server])}return function(e,t){Object.defineProperty(e,"ref",{get:function(){const r=e.bucket,a=e.fullPath,n=new b(r,a);return t._makeStorageReference(n)}})}(a,e),a}function J(e,t,r){const a=H(t);if(null===a)return null;return X(e,a,r)}function Z(e,t){const r={},a=t.length;for(let n=0;n<a;n++){const a=t[n];a.writable&&(r[a.server]=e[a.local])}return JSON.stringify(r)}class ${constructor(e,t,r,a){this.url=e,this.method=t,this.handler=r,this.timeout=a,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function ee(e){if(!e)throw h()}function te(e,t){return function(r,a){const n=J(e,a,t);return ee(null!==n),n}}function re(e,t){return function(r,a){const n=J(e,a,t);return ee(null!==n),function(e,t,r,a){const n=H(t);if(null===n)return null;if(!k(n.downloadTokens))return null;const s=n.downloadTokens;if(0===s.length)return null;const i=encodeURIComponent;return s.split(",").map(t=>{const n=e.bucket,s=e.fullPath;return _("/b/"+i(n)+"/o/"+i(s),r,a)+E({alt:"media",token:t})})[0]}(n,a,e.host,e._protocol)}}function ae(e){return function(t,r){let a;var n,s;return 401===t.getStatus()?a=t.getErrorText().includes("Firebase App Check token is invalid")?new l(c.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project."):new l(c.UNAUTHENTICATED,"User is not authenticated, please authenticate using Firebase Authentication and try again."):402===t.getStatus()?(s=e.bucket,a=new l(c.QUOTA_EXCEEDED,"Quota for bucket '"+s+"' exceeded, please view quota on https://firebase.google.com/pricing/.")):403===t.getStatus()?(n=e.path,a=new l(c.UNAUTHORIZED,"User does not have permission to access '"+n+"'.")):a=r,a.status=t.getStatus(),a.serverResponse=r.serverResponse,a}}function ne(e){const t=ae(e);return function(r,a){let n=t(r,a);var s;return 404===r.getStatus()&&(s=e.path,n=new l(c.OBJECT_NOT_FOUND,"Object '"+s+"' does not exist.")),n.serverResponse=a.serverResponse,n}}function se(e,t,r){const a=Object.assign({},r);return a.fullPath=e.path,a.size=t.size(),a.contentType||(a.contentType=function(e,t){return e&&e.contentType||t&&t.type()||"application/octet-stream"}(null,t)),a}function ie(e,t,r,a,n){const s=t.bucketOnlyServerUrl(),i={"X-Goog-Upload-Protocol":"multipart"};const o=function(){let e="";for(let t=0;t<2;t++)e+=Math.random().toString().slice(2);return e}();i["Content-Type"]="multipart/related; boundary="+o;const l=se(t,a,n),c="--"+o+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+Z(l,r)+"\r\n--"+o+"\r\nContent-Type: "+l.contentType+"\r\n\r\n",d="\r\n--"+o+"--",u=q.getBlob(c,a,d);if(null===u)throw g();const h={name:l.fullPath},m=_(s,e.host,e._protocol),f=e.maxUploadRetryTime,p=new $(m,"POST",te(e,r),f);return p.urlParams=h,p.headers=i,p.body=u.uploadData(),p.errorHandler=ae(t),p}let oe=null;class le{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=d.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=d.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=d.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,r,a,s){if(this.sent_)throw v("cannot .send() more than once");if((0,n.zJ)(e)&&r&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(t,e,!0),void 0!==s)for(const n in s)s.hasOwnProperty(n)&&this.xhr_.setRequestHeader(n,s[n].toString());return void 0!==a?this.xhr_.send(a):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw v("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw v("cannot .getStatus() before sending");try{return this.xhr_.status}catch(e){return-1}}getResponse(){if(!this.sent_)throw v("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw v("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.removeEventListener("progress",e)}}class ce extends le{initXhr(){this.xhr_.responseType="text"}}function de(){return oe?oe():new ce}class ue{constructor(e,t){this._service=e,this._location=t instanceof b?t:b.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new ue(e,t)}get root(){const e=new b(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return G(this._location.path)}get storage(){return this._service}get parent(){const e=function(e){if(0===e.length)return null;const t=e.lastIndexOf("/");return-1===t?"":e.slice(0,t)}(this._location.path);if(null===e)return null;const t=new b(this._location.bucket,e);return new ue(this._service,t)}_throwIfRoot(e){if(""===this._location.path)throw function(e){return new l(c.INVALID_ROOT_OPERATION,"The operation '"+e+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}(e)}}function he(e,t,r){e._throwIfRoot("uploadBytes");const a=ie(e.storage,e._location,Y(),new q(t,!0),r);return e.storage.makeRequestWithTokens(a,de).then(t=>({metadata:t,ref:e}))}function me(e){e._throwIfRoot("getDownloadURL");const t=function(e,t,r){const a=_(t.fullServerUrl(),e.host,e._protocol),n=e.maxOperationRetryTime,s=new $(a,"GET",re(e,r),n);return s.errorHandler=ne(t),s}(e.storage,e._location,Y());return e.storage.makeRequestWithTokens(t,de).then(e=>{if(null===e)throw new l(c.NO_DOWNLOAD_URL,"The given file does not have any download URLs.");return e})}function fe(e){e._throwIfRoot("deleteObject");const t=function(e,t){const r=_(t.fullServerUrl(),e.host,e._protocol),a=e.maxOperationRetryTime,n=new $(r,"DELETE",function(e,t){},a);return n.successCodes=[200,204],n.errorHandler=ne(t),n}(e.storage,e._location);return e.storage.makeRequestWithTokens(t,de)}function ge(e,t){const r=function(e,t){const r=t.split("/").filter(e=>e.length>0).join("/");return 0===e.length?r:e+"/"+r}(e._location.path,t),a=new b(e._location.bucket,r);return new ue(e.storage,a)}function pe(e,t){if(e instanceof ve){const r=e;if(null==r._bucket)throw new l(c.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+o+"' property when initializing the app?");const a=new ue(r,r._bucket);return null!=t?pe(a,t):a}return void 0!==t?ge(e,t):e}function xe(e,t){if(t&&/^[A-Za-z]+:\/\//.test(t)){if(e instanceof ve)return new ue(e,t);throw p("To use ref(service, url), the first argument must be a Storage instance.")}return pe(e,t)}function ye(e,t){const r=null===t||void 0===t?void 0:t[o];return null==r?null:b.makeFromBucketSpec(r,e)}class ve{constructor(e,t,r,a,n){let s=arguments.length>5&&void 0!==arguments[5]&&arguments[5];this.app=e,this._authProvider=t,this._appCheckProvider=r,this._url=a,this._firebaseVersion=n,this._isUsingEmulator=s,this._bucket=null,this._host=i,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null!=a?b.makeFromBucketSpec(a,this._host):ye(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,null!=this._url?this._bucket=b.makeFromBucketSpec(this._url,e):this._bucket=ye(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){S("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){S("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(null!==t)return t.accessToken}return null}async _getAppCheckToken(){if((0,a.xZ)(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});if(e){return(await e.getToken()).token}return null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new ue(this,e)}_makeRequest(e,t,r,a){let n=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];if(this._deleted)return new w(x());{const s=function(e,t,r,a,n,s){let i=!(arguments.length>6&&void 0!==arguments[6])||arguments[6],o=arguments.length>7&&void 0!==arguments[7]&&arguments[7];const l=E(e.urlParams),c=e.url+l,d=Object.assign({},e.headers);return function(e,t){t&&(e["X-Firebase-GMPID"]=t)}(d,t),function(e,t){null!==t&&t.length>0&&(e.Authorization="Firebase "+t)}(d,r),function(e,t){e["X-Firebase-Storage-Version"]="webjs/"+(null!==t&&void 0!==t?t:"AppManager")}(d,s),function(e,t){null!==t&&(e["X-Firebase-AppCheck"]=t)}(d,a),new C(c,e.method,d,e.body,e.successCodes,e.additionalRetryCodes,e.handler,e.errorHandler,e.timeout,e.progressCallback,n,i,o)}(e,this._appId,r,a,t,this._firebaseVersion,n,this._isUsingEmulator);return this._requests.add(s),s.getPromise().then(()=>this._requests.delete(s),()=>this._requests.delete(s)),s}}async makeRequestWithTokens(e,t){const[r,a]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,r,a).getPromise()}}const be="@firebase/storage",we="0.14.0",ke="storage";function Ne(e,t,r){return he(e=(0,n.Ku)(e),t,r)}function je(e){return me(e=(0,n.Ku)(e))}function Se(e){return fe(e=(0,n.Ku)(e))}function _e(e,t){return xe(e=(0,n.Ku)(e),t)}function Ee(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,a.Sx)(),t=arguments.length>1?arguments[1]:void 0;e=(0,n.Ku)(e);const r=(0,a.j6)(e,ke).getImmediate({identifier:t}),s=(0,n.yU)("storage");return s&&function(e,t,r){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};!function(e,t,r){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};e.host="".concat(t,":").concat(r);const s=(0,n.zJ)(t);s&&((0,n.gE)("https://".concat(e.host,"/b")),(0,n.P1)("Storage",!0)),e._isUsingEmulator=!0,e._protocol=s?"https":"http";const{mockUserToken:i}=a;i&&(e._overrideAuthToken="string"===typeof i?i:(0,n.Fy)(i,e.app.options.projectId))}(e,t,r,a)}(r,...s),r}function Ae(e,t){let{instanceIdentifier:r}=t;const n=e.getProvider("app").getImmediate(),s=e.getProvider("auth-internal"),i=e.getProvider("app-check-internal");return new ve(n,s,i,r,a.MF)}(0,a.om)(new s.uA(ke,Ae,"PUBLIC").setMultipleInstances(!0)),(0,a.KO)(be,we,""),(0,a.KO)(be,we,"esm2020")},2644:(e,t,r)=>{"use strict";r.d(t,{xI:()=>Ir});var a=r(3986),n=r(9379),s=r(8791),i=r(498),o=r(2226),l=r(6863);const c=["providerId"],d=["uid","auth","stsTokenManager"],u=["providerId","signInMethod"];function h(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const m=h,f=new i.FA("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),g=new o.Vy("@firebase/auth");function p(e){if(g.logLevel<=o.$b.ERROR){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];g.error("Auth (".concat(s.MF,"): ").concat(e),...r)}}function x(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];throw w(e,...r)}function y(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];return w(e,...r)}function v(e,t,r){const a=(0,n.A)((0,n.A)({},m()),{},{[t]:r});return new i.FA("auth","Firebase",a).create(t,{appName:e.name})}function b(e){return v(e,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function w(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];if("string"!==typeof e){const t=r[0],a=[...r.slice(1)];return a[0]&&(a[0].appName=e.name),e._errorFactory.create(t,...a)}return f.create(e,...r)}function k(e,t){if(!e){for(var r=arguments.length,a=new Array(r>2?r-2:0),n=2;n<r;n++)a[n-2]=arguments[n];throw w(t,...a)}}function N(e){const t="INTERNAL ASSERTION FAILED: "+e;throw p(t),new Error(t)}function j(e,t){e||N(t)}function S(){var e;return"undefined"!==typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function _(){return"http:"===E()||"https:"===E()}function E(){var e;return"undefined"!==typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}class A{constructor(e,t){this.shortDelay=e,this.longDelay=t,j(t>e,"Short delay should be less than long delay!"),this.isMobile=(0,i.jZ)()||(0,i.lV)()}get(){return"undefined"!==typeof navigator&&navigator&&"onLine"in navigator&&"boolean"===typeof navigator.onLine&&(_()||(0,i.sr)()||"connection"in navigator)&&!navigator.onLine?Math.min(5e3,this.shortDelay):this.isMobile?this.longDelay:this.shortDelay}}function C(e,t){j(e.emulator,"Emulator should always be set here");const{url:r}=e.emulator;return t?"".concat(r).concat(t.startsWith("/")?t.slice(1):t):r}class I{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!==typeof self&&"fetch"in self?self.fetch:"undefined"!==typeof globalThis&&globalThis.fetch?globalThis.fetch:"undefined"!==typeof fetch?fetch:void N("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!==typeof self&&"Headers"in self?self.Headers:"undefined"!==typeof globalThis&&globalThis.Headers?globalThis.Headers:"undefined"!==typeof Headers?Headers:void N("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!==typeof self&&"Response"in self?self.Response:"undefined"!==typeof globalThis&&globalThis.Response?globalThis.Response:"undefined"!==typeof Response?Response:void N("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const T={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},D=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],P=new A(3e4,6e4);function F(e,t){return e.tenantId&&!t.tenantId?(0,n.A)((0,n.A)({},t),{},{tenantId:e.tenantId}):t}async function L(e,t,r,a){return M(e,arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},async()=>{let s={},o={};a&&("GET"===t?o=a:s={body:JSON.stringify(a)});const l=(0,i.Am)((0,n.A)({key:e.config.apiKey},o)).slice(1),c=await e._getAdditionalHeaders();c["Content-Type"]="application/json",e.languageCode&&(c["X-Firebase-Locale"]=e.languageCode);const d=(0,n.A)({method:t,headers:c},s);return(0,i.c1)()||(d.referrerPolicy="no-referrer"),e.emulatorConfig&&(0,i.zJ)(e.emulatorConfig.host)&&(d.credentials="include"),I.fetch()(await O(e,e.config.apiHost,r,l),d)})}async function M(e,t,r){e._canInitEmulator=!1;const a=(0,n.A)((0,n.A)({},T),t);try{const t=new z(e),n=await Promise.race([r(),t.promise]);t.clearNetworkTimeout();const s=await n.json();if("needConfirmation"in s)throw U(e,"account-exists-with-different-credential",s);if(n.ok&&!("errorMessage"in s))return s;{const t=n.ok?s.errorMessage:s.error.message,[r,i]=t.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===r)throw U(e,"credential-already-in-use",s);if("EMAIL_EXISTS"===r)throw U(e,"email-already-in-use",s);if("USER_DISABLED"===r)throw U(e,"user-disabled",s);const o=a[r]||r.toLowerCase().replace(/[_\s]+/g,"-");if(i)throw v(e,o,i);x(e,o)}}catch(s){if(s instanceof i.g)throw s;x(e,"network-request-failed",{message:String(s)})}}async function R(e,t,r,a){let n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};const s=await L(e,t,r,a,n);return"mfaPendingCredential"in s&&x(e,"multi-factor-auth-required",{_serverResponse:s}),s}async function O(e,t,r,a){const n="".concat(t).concat(r,"?").concat(a),s=e,i=s.config.emulator?C(e.config,n):"".concat(e.config.apiScheme,"://").concat(n);if(D.includes(r)&&(await s._persistenceManagerAvailable,"COOKIE"===s._getPersistenceType())){return s._getPersistence()._getFinalTarget(i).toString()}return i}function B(e){switch(e){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class z{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((e,t)=>{this.timer=setTimeout(()=>t(y(this.auth,"network-request-failed")),P.get())})}}function U(e,t,r){const a={appName:e.name};r.email&&(a.email=r.email),r.phoneNumber&&(a.phoneNumber=r.phoneNumber);const n=y(e,t,a);return n.customData._tokenResponse=r,n}function V(e){return void 0!==e&&void 0!==e.enterprise}class q{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],void 0===e.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||0===this.recaptchaEnforcementState.length)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return B(t.enforcementState);return null}isProviderEnabled(e){return"ENFORCE"===this.getProviderEnforcementState(e)||"AUDIT"===this.getProviderEnforcementState(e)}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function H(e,t){return L(e,"GET","/v2/recaptchaConfig",F(e,t))}async function G(e,t){return L(e,"POST","/v1/accounts:lookup",t)}function W(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(t){}}function K(e){return 1e3*Number(e)}function Q(e){const[t,r,a]=e.split(".");if(void 0===t||void 0===r||void 0===a)return p("JWT malformed, contained fewer than 3 sections"),null;try{const e=(0,i.u)(r);return e?JSON.parse(e):(p("Failed to decode base64 JWT payload"),null)}catch(n){return p("Caught error parsing JWT payload as JSON",null===n||void 0===n?void 0:n.toString()),null}}function Y(e){const t=Q(e);return k(t,"internal-error"),k("undefined"!==typeof t.exp,"internal-error"),k("undefined"!==typeof t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}async function X(e,t){if(arguments.length>2&&void 0!==arguments[2]&&arguments[2])return t;try{return await t}catch(r){throw r instanceof i.g&&function(e){let{code:t}=e;return t==="auth/".concat("user-disabled")||t==="auth/".concat("user-token-expired")}(r)&&e.auth.currentUser===e&&await e.auth.signOut(),r}}class J{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){if(e){const e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}{var t;this.errorBackoff=3e4;const e=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,e)}}schedule(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){return void((null===e||void 0===e?void 0:e.code)==="auth/".concat("network-request-failed")&&this.schedule(!0))}this.schedule()}}class Z{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=W(this.lastLoginAt),this.creationTime=W(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function $(e){var t;const r=e.auth,a=await e.getIdToken(),n=await X(e,G(r,{idToken:a}));k(null===n||void 0===n?void 0:n.users.length,r,"internal-error");const s=n.users[0];e._notifyReloadListener(s);const i=null!==(t=s.providerUserInfo)&&void 0!==t&&t.length?ee(s.providerUserInfo):[],o=(l=e.providerData,c=i,[...l.filter(e=>!c.some(t=>t.providerId===e.providerId)),...c]);var l,c;const d=e.isAnonymous,u=!(e.email&&s.passwordHash)&&!(null!==o&&void 0!==o&&o.length),h=!!d&&u,m={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new Z(s.createdAt,s.lastLoginAt),isAnonymous:h};Object.assign(e,m)}function ee(e){return e.map(e=>{let{providerId:t}=e,r=(0,a.A)(e,c);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}class te{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){k(e.idToken,"internal-error"),k("undefined"!==typeof e.idToken,"internal-error"),k("undefined"!==typeof e.refreshToken,"internal-error");const t="expiresIn"in e&&"undefined"!==typeof e.expiresIn?Number(e.expiresIn):Y(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){k(0!==e.length,"internal-error");const t=Y(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]||!this.accessToken||this.isExpired?(k(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null):this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:a,expiresIn:n}=await async function(e,t){const r=await M(e,{},async()=>{const r=(0,i.Am)({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:a,apiKey:n}=e.config,s=await O(e,a,"/v1/token","key=".concat(n)),o=await e._getAdditionalHeaders();o["Content-Type"]="application/x-www-form-urlencoded";const l={method:"POST",headers:o,body:r};return e.emulatorConfig&&(0,i.zJ)(e.emulatorConfig.host)&&(l.credentials="include"),I.fetch()(s,l)});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}(e,t);this.updateTokensAndExpiration(r,a,Number(n))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*r}static fromJSON(e,t){const{refreshToken:r,accessToken:a,expirationTime:n}=t,s=new te;return r&&(k("string"===typeof r,"internal-error",{appName:e}),s.refreshToken=r),a&&(k("string"===typeof a,"internal-error",{appName:e}),s.accessToken=a),n&&(k("number"===typeof n,"internal-error",{appName:e}),s.expirationTime=n),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new te,this.toJSON())}_performRefresh(){return N("not implemented")}}function re(e,t){k("string"===typeof e||"undefined"===typeof e,"internal-error",{appName:t})}class ae{constructor(e){let{uid:t,auth:r,stsTokenManager:n}=e,s=(0,a.A)(e,d);this.providerId="firebase",this.proactiveRefresh=new J(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=n,this.accessToken=n.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Z(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const t=await X(this,this.stsTokenManager.getToken(this.auth,e));return k(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return async function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const r=(0,i.Ku)(e),a=await r.getIdToken(t),n=Q(a);k(n&&n.exp&&n.auth_time&&n.iat,r.auth,"internal-error");const s="object"===typeof n.firebase?n.firebase:void 0,o=null===s||void 0===s?void 0:s.sign_in_provider;return{claims:n,token:a,authTime:W(K(n.auth_time)),issuedAtTime:W(K(n.iat)),expirationTime:W(K(n.exp)),signInProvider:o||null,signInSecondFactor:(null===s||void 0===s?void 0:s.sign_in_second_factor)||null}}(this,e)}reload(){return async function(e){const t=(0,i.Ku)(e);await $(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}(this)}_assign(e){this!==e&&(k(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(e=>(0,n.A)({},e)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new ae((0,n.A)((0,n.A)({},this),{},{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){k(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await $(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if((0,s.xZ)(this.auth.app))return Promise.reject(b(this.auth));const e=await this.getIdToken();return await X(this,async function(e,t){return L(e,"POST","/v1/accounts:delete",t)}(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return(0,n.A)((0,n.A)({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>(0,n.A)({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{},{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,a,s,i,o,l,c,d;const u=null!==(r=t.displayName)&&void 0!==r?r:void 0,h=null!==(a=t.email)&&void 0!==a?a:void 0,m=null!==(s=t.phoneNumber)&&void 0!==s?s:void 0,f=null!==(i=t.photoURL)&&void 0!==i?i:void 0,g=null!==(o=t.tenantId)&&void 0!==o?o:void 0,p=null!==(l=t._redirectEventId)&&void 0!==l?l:void 0,x=null!==(c=t.createdAt)&&void 0!==c?c:void 0,y=null!==(d=t.lastLoginAt)&&void 0!==d?d:void 0,{uid:v,emailVerified:b,isAnonymous:w,providerData:N,stsTokenManager:j}=t;k(v&&j,e,"internal-error");const S=te.fromJSON(this.name,j);k("string"===typeof v,e,"internal-error"),re(u,e.name),re(h,e.name),k("boolean"===typeof b,e,"internal-error"),k("boolean"===typeof w,e,"internal-error"),re(m,e.name),re(f,e.name),re(g,e.name),re(p,e.name),re(x,e.name),re(y,e.name);const _=new ae({uid:v,auth:e,email:h,emailVerified:b,displayName:u,isAnonymous:w,photoURL:f,phoneNumber:m,tenantId:g,stsTokenManager:S,createdAt:x,lastLoginAt:y});return N&&Array.isArray(N)&&(_.providerData=N.map(e=>(0,n.A)({},e))),p&&(_._redirectEventId=p),_}static async _fromIdTokenResponse(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const a=new te;a.updateFromServerResponse(t);const n=new ae({uid:t.localId,auth:e,stsTokenManager:a,isAnonymous:r});return await $(n),n}static async _fromGetAccountInfoResponse(e,t,r){const a=t.users[0];k(void 0!==a.localId,"internal-error");const n=void 0!==a.providerUserInfo?ee(a.providerUserInfo):[],s=!(a.email&&a.passwordHash)&&!(null!==n&&void 0!==n&&n.length),i=new te;i.updateFromIdToken(r);const o=new ae({uid:a.localId,auth:e,stsTokenManager:i,isAnonymous:s}),l={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:n,metadata:new Z(a.createdAt,a.lastLoginAt),isAnonymous:!(a.email&&a.passwordHash)&&!(null!==n&&void 0!==n&&n.length)};return Object.assign(o,l),o}}const ne=new Map;function se(e){j(e instanceof Function,"Expected a class definition");let t=ne.get(e);return t?(j(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,ne.set(e,t),t)}class ie{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return void 0===t?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}ie.type="NONE";const oe=ie;function le(e,t,r){return"firebase".concat(":",e,":").concat(t,":").concat(r)}class ce{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:a,name:n}=this.auth;this.fullUserKey=le(this.userKey,a.apiKey,n),this.fullPersistenceKey=le("persistence",a.apiKey,n),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if("string"===typeof e){const t=await G(this.auth,{idToken:e}).catch(()=>{});return t?ae._fromGetAccountInfoResponse(this.auth,t,e):null}return ae._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=e,t?this.setCurrentUser(t):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"authUser";if(!t.length)return new ce(se(oe),e,r);const a=(await Promise.all(t.map(async e=>{if(await e._isAvailable())return e}))).filter(e=>e);let n=a[0]||se(oe);const s=le(r,e.config.apiKey,e.name);let i=null;for(const c of t)try{const t=await c._get(s);if(t){let r;if("string"===typeof t){const a=await G(e,{idToken:t}).catch(()=>{});if(!a)break;r=await ae._fromGetAccountInfoResponse(e,a,t)}else r=ae._fromJSON(e,t);c!==n&&(i=r),n=c;break}}catch(l){}const o=a.filter(e=>e._shouldAllowMigration);return n._shouldAllowMigration&&o.length?(n=o[0],i&&await n._set(s,i.toJSON()),await Promise.all(t.map(async e=>{if(e!==n)try{await e._remove(s)}catch(t){}})),new ce(n,e,r)):new ce(n,e,r)}}function de(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(fe(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(ue(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(pe(t))return"Blackberry";if(xe(t))return"Webos";if(he(t))return"Safari";if((t.includes("chrome/")||me(t))&&!t.includes("edge/"))return"Chrome";if(ge(t))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=e.match(t);if(2===(null===r||void 0===r?void 0:r.length))return r[1]}return"Other"}function ue(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,i.ZQ)();return/firefox\//i.test(e)}function he(){const e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,i.ZQ)()).toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function me(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,i.ZQ)();return/crios\//i.test(e)}function fe(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,i.ZQ)();return/iemobile/i.test(e)}function ge(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,i.ZQ)();return/android/i.test(e)}function pe(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,i.ZQ)();return/blackberry/i.test(e)}function xe(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,i.ZQ)();return/webos/i.test(e)}function ye(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,i.ZQ)();return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function ve(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,i.ZQ)();return ye(e)||ge(e)||xe(e)||pe(e)||/windows phone/i.test(e)||fe(e)}function be(e){let t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];switch(e){case"Browser":t=de((0,i.ZQ)());break;case"Worker":t="".concat(de((0,i.ZQ)()),"-").concat(e);break;default:t=e}const a=r.length?r.join(","):"FirebaseCore-web";return"".concat(t,"/","JsCore","/").concat(s.MF,"/").concat(a)}class we{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=t=>new Promise((r,a)=>{try{r(e(t))}catch(n){a(n)}});r.onAbort=t,this.queue.push(r);const a=this.queue.length-1;return()=>{this.queue[a]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const e of t)try{e()}catch(a){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null===r||void 0===r?void 0:r.message})}}}class ke{constructor(e){var t,r,a,n;const s=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=null!==(t=s.minPasswordLength)&&void 0!==t?t:6,s.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=s.maxPasswordLength),void 0!==s.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=s.containsLowercaseCharacter),void 0!==s.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=s.containsUppercaseCharacter),void 0!==s.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=s.containsNumericCharacter),void 0!==s.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=s.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=null!==(r=null===(a=e.allowedNonAlphanumericCharacters)||void 0===a?void 0:a.join(""))&&void 0!==r?r:"",this.forceUpgradeOnSignin=null!==(n=e.forceUpgradeOnSignin)&&void 0!==n&&n,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,r,a,n,s,i;const o={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,o),this.validatePasswordCharacterOptions(e,o),o.isValid&&(o.isValid=null===(t=o.meetsMinPasswordLength)||void 0===t||t),o.isValid&&(o.isValid=null===(r=o.meetsMaxPasswordLength)||void 0===r||r),o.isValid&&(o.isValid=null===(a=o.containsLowercaseLetter)||void 0===a||a),o.isValid&&(o.isValid=null===(n=o.containsUppercaseLetter)||void 0===n||n),o.isValid&&(o.isValid=null===(s=o.containsNumericCharacter)||void 0===s||s),o.isValid&&(o.isValid=null===(i=o.containsNonAlphanumericCharacter)||void 0===i||i),o}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,a=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),a&&(t.meetsMaxPasswordLength=e.length<=a)}validatePasswordCharacterOptions(e,t){let r;this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);for(let a=0;a<e.length;a++)r=e.charAt(a),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,a,n){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=a)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=n))}}class Ne{constructor(e,t,r,a){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=a,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Se(this),this.idTokenSubscription=new Se(this),this.beforeStateQueue=new we(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=f,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=a.sdkClientVersion,this._persistenceManagerAvailable=new Promise(e=>this._resolvePersistenceManagerAvailable=e)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=se(t)),this._initializationPromise=this.queue(async()=>{var r,a,n;if(!this._deleted&&(this.persistenceManager=await ce.create(this,e),null===(r=this._resolvePersistenceManagerAvailable)||void 0===r||r.call(this),!this._deleted)){if(null!==(a=this._popupRedirectResolver)&&void 0!==a&&a._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(s){}await this.initializeCurrentUser(t),this.lastNotifiedUid=(null===(n=this.currentUser)||void 0===n?void 0:n.uid)||null,this._deleted||(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();return this.currentUser||e?this.currentUser&&e&&this.currentUser.uid===e.uid?(this._currentUser._assign(e),void await this.currentUser.getIdToken()):void await this._updateCurrentUser(e,!0):void 0}async initializeCurrentUserFromIdToken(e){try{const t=await G(this,{idToken:e}),r=await ae._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if((0,s.xZ)(this.app)){const e=this.app.settings.authIdToken;return e?new Promise(t=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(e).then(t,t))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let r=t,a=!1;if(e&&this.config.authDomain){var n,i;await this.getOrInitRedirectPersistenceManager();const t=null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId,s=null===(i=r)||void 0===i?void 0:i._redirectEventId,o=await this.tryRedirectSignIn(e);t&&t!==s||null===o||void 0===o||!o.user||(r=o.user,a=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(a)try{await this.beforeStateQueue.runMiddleware(r)}catch(o){r=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return k(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(r){await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await $(e)}catch(t){if((null===t||void 0===t?void 0:t.code)!=="auth/".concat("network-request-failed"))return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=function(){if("undefined"===typeof navigator)return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if((0,s.xZ)(this.app))return Promise.reject(b(this));const t=e?(0,i.Ku)(e):null;return t&&k(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!this._deleted)return e&&k(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return(0,s.xZ)(this.app)?Promise.reject(b(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return(0,s.xZ)(this.app)?Promise.reject(b(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(se(e))})}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await async function(e){return L(e,"GET","/v2/passwordPolicy",F(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}))}(this),t=new ke(e);null===this.tenantId?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new i.FA("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:await this.currentUser.getIdToken()};null!=this.tenantId&&(t.tenantId=this.tenantId),await async function(e,t){return L(e,"POST","/v2/accounts:revokeToken",F(e,t))}(this,t)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return null===e?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&se(e)||this._popupRedirectResolver;k(t,this,"argument-error"),this.redirectPersistenceManager=await ce.create(this,[se(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,r;return this._isInitialized&&await this.queue(async()=>{}),(null===(t=this._currentUser)||void 0===t?void 0:t._redirectEventId)===e?this._currentUser:(null===(r=this.redirectUser)||void 0===r?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return"".concat(this.config.authDomain,":").concat(this.config.apiKey,":").concat(this.name)}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=null!==(e=null===(t=this.currentUser)||void 0===t?void 0:t.uid)&&void 0!==e?e:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,a){if(this._deleted)return()=>{};const n="function"===typeof t?t:t.next.bind(t);let s=!1;const i=this._isInitialized?Promise.resolve():this._initializationPromise;if(k(i,this,"internal-error"),i.then(()=>{s||n(this.currentUser)}),"function"===typeof t){const n=e.addObserver(t,r,a);return()=>{s=!0,n()}}{const r=e.addObserver(t);return()=>{s=!0,r()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return k(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=be(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const r=await(null===(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getHeartbeatsHeader());r&&(t["X-Firebase-Client"]=r);const a=await this._getAppCheckToken();return a&&(t["X-Firebase-AppCheck"]=a),t}async _getAppCheckToken(){var e;if((0,s.xZ)(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=await(null===(e=this.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getToken());return null!==t&&void 0!==t&&t.error&&function(e){if(g.logLevel<=o.$b.WARN){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];g.warn("Auth (".concat(s.MF,"): ").concat(e),...r)}}("Error while retrieving App Check token: ".concat(t.error)),null===t||void 0===t?void 0:t.token}}function je(e){return(0,i.Ku)(e)}class Se{constructor(e){this.auth=e,this.observer=null,this.addObserver=(0,i.tD)(e=>this.observer=e)}get next(){return k(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let _e={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Ee(e){return _e.loadJS(e)}function Ae(e){return"__".concat(e).concat(Math.floor(1e6*Math.random()))}class Ce{constructor(){this.enterprise=new Ie}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class Ie{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const Te="NO_RECAPTCHA";class De{constructor(e){this.type="recaptcha-enterprise",this.auth=je(e)}async verify(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"verify",t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];function r(t,r,a){const n=window.grecaptcha;V(n)?n.enterprise.ready(()=>{n.enterprise.execute(t,{action:e}).then(e=>{r(e)}).catch(()=>{r(Te)})}):a(Error("No reCAPTCHA enterprise script loaded."))}if(this.auth.settings.appVerificationDisabledForTesting){return(new Ce).execute("siteKey",{action:"verify"})}return new Promise((e,a)=>{(async function(e){if(!t){if(null==e.tenantId&&null!=e._agentRecaptchaConfig)return e._agentRecaptchaConfig.siteKey;if(null!=e.tenantId&&void 0!==e._tenantRecaptchaConfigs[e.tenantId])return e._tenantRecaptchaConfigs[e.tenantId].siteKey}return new Promise(async(t,r)=>{H(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(a=>{if(void 0!==a.recaptchaKey){const r=new q(a);return null==e.tenantId?e._agentRecaptchaConfig=r:e._tenantRecaptchaConfigs[e.tenantId]=r,t(r.siteKey)}r(new Error("recaptcha Enterprise site key undefined"))}).catch(e=>{r(e)})})})(this.auth).then(n=>{if(!t&&V(window.grecaptcha))r(n,e,a);else{if("undefined"===typeof window)return void a(new Error("RecaptchaVerifier is only supported in browser"));let t=_e.recaptchaEnterpriseScript;0!==t.length&&(t+=n),Ee(t).then(()=>{r(n,e,a)}).catch(e=>{a(e)})}}).catch(e=>{a(e)})})}}async function Pe(e,t,r){let a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const i=new De(e);let o;if(s)o=Te;else try{o=await i.verify(r)}catch(c){o=await i.verify(r,!0)}const l=(0,n.A)({},t);if("mfaSmsEnrollment"===r||"mfaSmsSignIn"===r){if("phoneEnrollmentInfo"in l){const e=l.phoneEnrollmentInfo.phoneNumber,t=l.phoneEnrollmentInfo.recaptchaToken;Object.assign(l,{phoneEnrollmentInfo:{phoneNumber:e,recaptchaToken:t,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in l){const e=l.phoneSignInInfo.recaptchaToken;Object.assign(l,{phoneSignInInfo:{recaptchaToken:e,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return l}return a?Object.assign(l,{captchaResp:o}):Object.assign(l,{captchaResponse:o}),Object.assign(l,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(l,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),l}async function Fe(e,t,r,a,n){if("EMAIL_PASSWORD_PROVIDER"===n){var s;if(null!==(s=e._getRecaptchaConfig())&&void 0!==s&&s.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const n=await Pe(e,t,r,"getOobCode"===r);return a(e,n)}return a(e,t).catch(async n=>{if(n.code==="auth/".concat("missing-recaptcha-token")){console.log("".concat(r," is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow."));const n=await Pe(e,t,r,"getOobCode"===r);return a(e,n)}return Promise.reject(n)})}if("PHONE_PROVIDER"===n){var i;if(null!==(i=e._getRecaptchaConfig())&&void 0!==i&&i.isProviderEnabled("PHONE_PROVIDER")){const n=await Pe(e,t,r);return a(e,n).catch(async n=>{var s;if("AUDIT"===(null===(s=e._getRecaptchaConfig())||void 0===s?void 0:s.getProviderEnforcementState("PHONE_PROVIDER"))&&(n.code==="auth/".concat("missing-recaptcha-token")||n.code==="auth/".concat("invalid-app-credential"))){console.log("Failed to verify with reCAPTCHA Enterprise. Automatically triggering the reCAPTCHA v2 flow to complete the ".concat(r," flow."));const n=await Pe(e,t,r,!1,!0);return a(e,n)}return Promise.reject(n)})}{const n=await Pe(e,t,r,!1,!0);return a(e,n)}}return Promise.reject(n+" provider is not supported.")}async function Le(e){const t=je(e),r=await H(t,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),a=new q(r);if(null==t.tenantId?t._agentRecaptchaConfig=a:t._tenantRecaptchaConfigs[t.tenantId]=a,a.isAnyProviderEnabled()){new De(t).verify()}}function Me(e,t,r){const a=je(e);k(/^https?:\/\//.test(t),a,"invalid-emulator-scheme");const n=!(null===r||void 0===r||!r.disableWarnings),s=Re(t),{host:o,port:l}=function(e){const t=Re(e),r=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!r)return{host:"",port:null};const a=r[2].split("@").pop()||"",n=/^(\[[^\]]+\])(:|$)/.exec(a);if(n){const e=n[1];return{host:e,port:Oe(a.substr(e.length+1))}}{const[e,t]=a.split(":");return{host:e,port:Oe(t)}}}(t),c=null===l?"":":".concat(l),d={url:"".concat(s,"//").concat(o).concat(c,"/")},u=Object.freeze({host:o,port:l,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:n})});if(!a._canInitEmulator)return k(a.config.emulator&&a.emulatorConfig,a,"emulator-config-failed"),void k((0,i.bD)(d,a.config.emulator)&&(0,i.bD)(u,a.emulatorConfig),a,"emulator-config-failed");a.config.emulator=d,a.emulatorConfig=u,a.settings.appVerificationDisabledForTesting=!0,(0,i.zJ)(o)?((0,i.gE)("".concat(s,"//").concat(o).concat(c)),(0,i.P1)("Auth",!0)):n||function(){function e(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!==typeof console&&"function"===typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials.");"undefined"!==typeof window&&"undefined"!==typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}()}function Re(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function Oe(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}class Be{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return N("not implemented")}_getIdTokenResponse(e){return N("not implemented")}_linkToIdToken(e,t){return N("not implemented")}_getReauthenticationResolver(e){return N("not implemented")}}async function ze(e,t){return L(e,"POST","/v1/accounts:signUp",t)}async function Ue(e,t){return R(e,"POST","/v1/accounts:signInWithPassword",F(e,t))}class Ve extends Be{constructor(e,t,r){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;super("password",r),this._email=e,this._password=t,this._tenantId=a}static _fromEmailAndPassword(e,t){return new Ve(e,t,"password")}static _fromEmailAndCode(e,t){return new Ve(e,t,"emailLink",arguments.length>2&&void 0!==arguments[2]?arguments[2]:null)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t="string"===typeof e?JSON.parse(e):e;if(null!==t&&void 0!==t&&t.email&&null!==t&&void 0!==t&&t.password){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":return Fe(e,{returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signInWithPassword",Ue,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return async function(e,t){return R(e,"POST","/v1/accounts:signInWithEmailLink",F(e,t))}(e,{email:this._email,oobCode:this._password});default:x(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":return Fe(e,{idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",ze,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return async function(e,t){return R(e,"POST","/v1/accounts:signInWithEmailLink",F(e,t))}(e,{idToken:t,email:this._email,oobCode:this._password});default:x(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function qe(e,t){return R(e,"POST","/v1/accounts:signInWithIdp",F(e,t))}class He extends Be{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new He(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):x("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"===typeof e?JSON.parse(e):e,{providerId:r,signInMethod:n}=t,s=(0,a.A)(t,u);if(!r||!n)return null;const i=new He(r,n);return i.idToken=s.idToken||void 0,i.accessToken=s.accessToken||void 0,i.secret=s.secret,i.nonce=s.nonce,i.pendingToken=s.pendingToken||null,i}_getIdTokenResponse(e){return qe(e,this.buildRequest())}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,qe(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,qe(e,t)}buildRequest(){const e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=(0,i.Am)(t)}return e}}async function Ge(e,t){return L(e,"POST","/v1/accounts:sendVerificationCode",F(e,t))}const We={USER_NOT_FOUND:"user-not-found"};class Ke extends Be{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new Ke({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new Ke({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return async function(e,t){return R(e,"POST","/v1/accounts:signInWithPhoneNumber",F(e,t))}(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return async function(e,t){const r=await R(e,"POST","/v1/accounts:signInWithPhoneNumber",F(e,t));if(r.temporaryProof)throw U(e,"account-exists-with-different-credential",r);return r}(e,(0,n.A)({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return async function(e,t){return R(e,"POST","/v1/accounts:signInWithPhoneNumber",F(e,(0,n.A)((0,n.A)({},t),{},{operation:"REAUTH"})),We)}(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:r,verificationCode:a}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:r,code:a}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){"string"===typeof e&&(e=JSON.parse(e));const{verificationId:t,verificationCode:r,phoneNumber:a,temporaryProof:n}=e;return r||t||a||n?new Ke({verificationId:t,verificationCode:r,phoneNumber:a,temporaryProof:n}):null}}class Qe{constructor(e){var t,r,a,n,s,o;const l=(0,i.I9)((0,i.hp)(e)),c=null!==(t=l.apiKey)&&void 0!==t?t:null,d=null!==(r=l.oobCode)&&void 0!==r?r:null,u=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(a=l.mode)&&void 0!==a?a:null);k(c&&d&&u,"argument-error"),this.apiKey=c,this.operation=u,this.code=d,this.continueUrl=null!==(n=l.continueUrl)&&void 0!==n?n:null,this.languageCode=null!==(s=l.lang)&&void 0!==s?s:null,this.tenantId=null!==(o=l.tenantId)&&void 0!==o?o:null}static parseLink(e){const t=function(e){const t=(0,i.I9)((0,i.hp)(e)).link,r=t?(0,i.I9)((0,i.hp)(t)).deep_link_id:null,a=(0,i.I9)((0,i.hp)(e)).deep_link_id;return(a?(0,i.I9)((0,i.hp)(a)).link:null)||a||r||t||e}(e);try{return new Qe(t)}catch(r){return null}}}class Ye{constructor(){this.providerId=Ye.PROVIDER_ID}static credential(e,t){return Ve._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const r=Qe.parseLink(t);return k(r,"argument-error"),Ve._fromEmailAndCode(e,r.code,r.tenantId)}}Ye.PROVIDER_ID="password",Ye.EMAIL_PASSWORD_SIGN_IN_METHOD="password",Ye.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class Xe{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class Je extends Xe{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Ze extends Je{constructor(){super("facebook.com")}static credential(e){return He._fromParams({providerId:Ze.PROVIDER_ID,signInMethod:Ze.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ze.credentialFromTaggedObject(e)}static credentialFromError(e){return Ze.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return Ze.credential(t.oauthAccessToken)}catch(r){return null}}}Ze.FACEBOOK_SIGN_IN_METHOD="facebook.com",Ze.PROVIDER_ID="facebook.com";class $e extends Je{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return He._fromParams({providerId:$e.PROVIDER_ID,signInMethod:$e.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return $e.credentialFromTaggedObject(e)}static credentialFromError(e){return $e.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{oauthIdToken:r,oauthAccessToken:a}=t;if(!r&&!a)return null;try{return $e.credential(r,a)}catch(n){return null}}}$e.GOOGLE_SIGN_IN_METHOD="google.com",$e.PROVIDER_ID="google.com";class et extends Je{constructor(){super("github.com")}static credential(e){return He._fromParams({providerId:et.PROVIDER_ID,signInMethod:et.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return et.credentialFromTaggedObject(e)}static credentialFromError(e){return et.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return et.credential(t.oauthAccessToken)}catch(r){return null}}}et.GITHUB_SIGN_IN_METHOD="github.com",et.PROVIDER_ID="github.com";class tt extends Je{constructor(){super("twitter.com")}static credential(e,t){return He._fromParams({providerId:tt.PROVIDER_ID,signInMethod:tt.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return tt.credentialFromTaggedObject(e)}static credentialFromError(e){return tt.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{oauthAccessToken:r,oauthTokenSecret:a}=t;if(!r||!a)return null;try{return tt.credential(r,a)}catch(n){return null}}}tt.TWITTER_SIGN_IN_METHOD="twitter.com",tt.PROVIDER_ID="twitter.com";class rt{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r){let a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const n=await ae._fromIdTokenResponse(e,r,a),s=at(r);return new rt({user:n,providerId:s,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const a=at(r);return new rt({user:e,providerId:a,_tokenResponse:r,operationType:t})}}function at(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}class nt extends i.g{constructor(e,t,r,a){var n;super(t.code,t.message),this.operationType=r,this.user=a,Object.setPrototypeOf(this,nt.prototype),this.customData={appName:e.name,tenantId:null!==(n=e.tenantId)&&void 0!==n?n:void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,a){return new nt(e,t,r,a)}}function st(e,t,r,a){return("reauthenticate"===t?r._getReauthenticationResolver(e):r._getIdTokenResponse(e)).catch(r=>{if(r.code==="auth/".concat("multi-factor-auth-required"))throw nt._fromErrorAndOperation(e,r,t,a);throw r})}async function it(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const a=await X(e,t._linkToIdToken(e.auth,await e.getIdToken()),r);return rt._forOperation(e,"link",a)}async function ot(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const{auth:a}=e;if((0,s.xZ)(a.app))return Promise.reject(b(a));const n="reauthenticate";try{const s=await X(e,st(a,n,t,e),r);k(s.idToken,a,"internal-error");const i=Q(s.idToken);k(i,a,"internal-error");const{sub:o}=i;return k(e.uid===o,a,"user-mismatch"),rt._forOperation(e,n,s)}catch(i){throw(null===i||void 0===i?void 0:i.code)==="auth/".concat("user-not-found")&&x(a,"user-mismatch"),i}}async function lt(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if((0,s.xZ)(e.app))return Promise.reject(b(e));const a="signIn",n=await st(e,a,t),i=await rt._fromIdTokenResponse(e,a,n);return r||await e._updateCurrentUser(i.user),i}function ct(e,t){return L(e,"POST","/v2/accounts/mfaEnrollment:start",F(e,t))}new WeakMap;const dt="__sak";class ut{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(dt,"1"),this.storage.removeItem(dt),Promise.resolve(!0)):Promise.resolve(!1)}catch(e){return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}class ht extends ut{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=ve(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),a=this.localCache[t];r!==a&&e(t,a,r)}}onStorageEvent(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e.key)return void this.forAllChangedKeys((e,t,r)=>{this.notifyListeners(e,r)});const r=e.key;t?this.detachListener():this.stopPolling();const a=()=>{const e=this.storage.getItem(r);(t||this.localCache[r]!==e)&&this.notifyListeners(r,e)},n=this.storage.getItem(r);(0,i.lT)()&&10===document.documentMode&&n!==e.newValue&&e.newValue!==e.oldValue?setTimeout(a,10):a()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const a of Array.from(r))a(t?JSON.parse(t):t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}ht.type="LOCAL";const mt=ht;function ft(e){var t,r;const a=e.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&"),n=RegExp("".concat(a,"=([^;]+)"));return null!==(t=null===(r=document.cookie.match(n))||void 0===r?void 0:r[1])&&void 0!==t?t:null}function gt(e){const t="http:"===window.location.protocol;return"".concat(t?"__dev_":"__HOST-","FIREBASE_").concat(e.split(":")[3])}class pt{constructor(){this.type="COOKIE",this.listenerUnsubscribes=new Map}_getFinalTarget(e){if(void 0===typeof window)return e;const t=new URL("".concat(window.location.origin,"/__cookies__"));return t.searchParams.set("finalTarget",e),t}async _isAvailable(){var e;return!("boolean"===typeof isSecureContext&&!isSecureContext)&&("undefined"!==typeof navigator&&"undefined"!==typeof document&&(null===(e=navigator.cookieEnabled)||void 0===e||e))}async _set(e,t){}async _get(e){if(!this._isAvailable())return null;const t=gt(e);if(window.cookieStore){const e=await window.cookieStore.get(t);return null===e||void 0===e?void 0:e.value}return ft(t)}async _remove(e){if(!this._isAvailable())return;if(!await this._get(e))return;const t=gt(e);document.cookie="".concat(t,"=;Max-Age=34560000;Partitioned;Secure;SameSite=Strict;Path=/;Priority=High"),await fetch("/__cookies__",{method:"DELETE"}).catch(()=>{})}_addListener(e,t){if(!this._isAvailable())return;const r=gt(e);if(window.cookieStore){const e=e=>{const a=e.changed.find(e=>e.name===r);a&&t(a.value);e.deleted.find(e=>e.name===r)&&t(null)},a=()=>window.cookieStore.removeEventListener("change",e);return this.listenerUnsubscribes.set(t,a),window.cookieStore.addEventListener("change",e)}let a=ft(r);const n=setInterval(()=>{const e=ft(r);e!==a&&(t(e),a=e)},1e3);this.listenerUnsubscribes.set(t,()=>clearInterval(n))}_removeListener(e,t){const r=this.listenerUnsubscribes.get(t);r&&(r(),this.listenerUnsubscribes.delete(t))}}pt.type="COOKIE";class xt extends ut{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}xt.type="SESSION";const yt=xt;class vt{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(t=>t.isListeningto(e));if(t)return t;const r=new vt(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:a,data:n}=t.data,s=this.handlersMap[a];if(null===s||void 0===s||!s.size)return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:a});const i=Array.from(s).map(async e=>e(t.origin,n)),o=await function(e){return Promise.all(e.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}(i);t.ports[0].postMessage({status:"done",eventId:r,eventType:a,response:o})}_subscribe(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function bt(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,r="";for(let a=0;a<t;a++)r+=Math.floor(10*Math.random());return e+r}vt.receivers=[];class wt{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50;const a="undefined"!==typeof MessageChannel?new MessageChannel:null;if(!a)throw new Error("connection_unavailable");let n,s;return new Promise((i,o)=>{const l=bt("",20);a.port1.start();const c=setTimeout(()=>{o(new Error("unsupported_event"))},r);s={messageChannel:a,onMessage(e){const t=e;if(t.data.eventId===l)switch(t.data.status){case"ack":clearTimeout(c),n=setTimeout(()=>{o(new Error("timeout"))},3e3);break;case"done":clearTimeout(n),i(t.data.response);break;default:clearTimeout(c),clearTimeout(n),o(new Error("invalid_response"))}}},this.handlers.add(s),a.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:e,eventId:l,data:t},[a.port2])}).finally(()=>{s&&this.removeMessageHandler(s)})}}function kt(){return window}function Nt(){return"undefined"!==typeof kt().WorkerGlobalScope&&"function"===typeof kt().importScripts}const jt="firebaseLocalStorageDb",St="firebaseLocalStorage",_t="fbase_key";class Et{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function At(e,t){return e.transaction([St],t?"readwrite":"readonly").objectStore(St)}function Ct(){const e=indexedDB.open(jt,1);return new Promise((t,r)=>{e.addEventListener("error",()=>{r(e.error)}),e.addEventListener("upgradeneeded",()=>{const t=e.result;try{t.createObjectStore(St,{keyPath:_t})}catch(a){r(a)}}),e.addEventListener("success",async()=>{const r=e.result;r.objectStoreNames.contains(St)?t(r):(r.close(),await function(){const e=indexedDB.deleteDatabase(jt);return new Et(e).toPromise()}(),t(await Ct()))})})}async function It(e,t,r){const a=At(e,!0).put({[_t]:t,value:r});return new Et(a).toPromise()}function Tt(e,t){const r=At(e,!0).delete(t);return new Et(r).toPromise()}class Dt{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db||(this.db=await Ct()),this.db}async _withRetries(e){let t=0;for(;;)try{const t=await this._openDb();return await e(t)}catch(r){if(t++>3)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Nt()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=vt._getInstance(Nt()?self:null),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await async function(){var e;if(null===(e=navigator)||void 0===e||!e.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch(t){return null}}(),!this.activeServiceWorker)return;this.sender=new wt(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&null!==(e=r[0])&&void 0!==e&&e.fulfilled&&null!==(t=r[0])&&void 0!==t&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(this.sender&&this.activeServiceWorker&&function(){var e;return(null===(e=navigator)||void 0===e||null===(e=e.serviceWorker)||void 0===e?void 0:e.controller)||null}()===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch(t){}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Ct();return await It(e,dt,"1"),await Tt(e,dt),!0}catch(e){}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>It(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(t=>async function(e,t){const r=At(e,!1).get(t),a=await new Et(r).toPromise();return void 0===a?null:a.value}(t,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>Tt(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(e=>{const t=At(e,!1).getAll();return new Et(t).toPromise()});if(!e)return[];if(0!==this.pendingWrites)return[];const t=[],r=new Set;if(0!==e.length)for(const{fbase_key:a,value:n}of e)r.add(a),JSON.stringify(this.localCache[a])!==JSON.stringify(n)&&(this.notifyListeners(a,n),t.push(a));for(const a of Object.keys(this.localCache))this.localCache[a]&&!r.has(a)&&(this.notifyListeners(a,null),t.push(a));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const a of Array.from(r))a(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}Dt.type="LOCAL";const Pt=Dt;function Ft(e,t){return L(e,"POST","/v2/accounts/mfaSignIn:start",F(e,t))}Ae("rcb"),new A(3e4,6e4);const Lt="recaptcha";async function Mt(e,t,r){if(!e._getRecaptchaConfig())try{await Le(e)}catch(n){console.log("Failed to initialize reCAPTCHA Enterprise config. Triggering the reCAPTCHA v2 verification.")}try{let n;if(n="string"===typeof t?{phoneNumber:t}:t,"session"in n){const t=n.session;if("phoneNumber"in n){k("enroll"===t.type,e,"internal-error");const a={idToken:t.credential,phoneEnrollmentInfo:{phoneNumber:n.phoneNumber,clientType:"CLIENT_TYPE_WEB"}},s=Fe(e,a,"mfaSmsEnrollment",async(e,t)=>{if(t.phoneEnrollmentInfo.captchaResponse===Te){k((null===r||void 0===r?void 0:r.type)===Lt,e,"argument-error");return ct(e,await Rt(e,t,r))}return ct(e,t)},"PHONE_PROVIDER");return(await s.catch(e=>Promise.reject(e))).phoneSessionInfo.sessionInfo}{var a;k("signin"===t.type,e,"internal-error");const s=(null===(a=n.multiFactorHint)||void 0===a?void 0:a.uid)||n.multiFactorUid;k(s,e,"missing-multi-factor-info");const i={mfaPendingCredential:t.credential,mfaEnrollmentId:s,phoneSignInInfo:{clientType:"CLIENT_TYPE_WEB"}},o=Fe(e,i,"mfaSmsSignIn",async(e,t)=>{if(t.phoneSignInInfo.captchaResponse===Te){k((null===r||void 0===r?void 0:r.type)===Lt,e,"argument-error");return Ft(e,await Rt(e,t,r))}return Ft(e,t)},"PHONE_PROVIDER");return(await o.catch(e=>Promise.reject(e))).phoneResponseInfo.sessionInfo}}{const t={phoneNumber:n.phoneNumber,clientType:"CLIENT_TYPE_WEB"},a=Fe(e,t,"sendVerificationCode",async(e,t)=>{if(t.captchaResponse===Te){k((null===r||void 0===r?void 0:r.type)===Lt,e,"argument-error");return Ge(e,await Rt(e,t,r))}return Ge(e,t)},"PHONE_PROVIDER");return(await a.catch(e=>Promise.reject(e))).sessionInfo}}finally{null===r||void 0===r||r._reset()}}async function Rt(e,t,r){k(r.type===Lt,e,"argument-error");const a=await r.verify();k("string"===typeof a,e,"argument-error");const s=(0,n.A)({},t);if("phoneEnrollmentInfo"in s){const e=s.phoneEnrollmentInfo.phoneNumber,t=s.phoneEnrollmentInfo.captchaResponse,r=s.phoneEnrollmentInfo.clientType,n=s.phoneEnrollmentInfo.recaptchaVersion;return Object.assign(s,{phoneEnrollmentInfo:{phoneNumber:e,recaptchaToken:a,captchaResponse:t,clientType:r,recaptchaVersion:n}}),s}if("phoneSignInInfo"in s){const e=s.phoneSignInInfo.captchaResponse,t=s.phoneSignInInfo.clientType,r=s.phoneSignInInfo.recaptchaVersion;return Object.assign(s,{phoneSignInInfo:{recaptchaToken:a,captchaResponse:e,clientType:t,recaptchaVersion:r}}),s}return Object.assign(s,{recaptchaToken:a}),s}class Ot{constructor(e){this.providerId=Ot.PROVIDER_ID,this.auth=je(e)}verifyPhoneNumber(e,t){return Mt(this.auth,e,(0,i.Ku)(t))}static credential(e,t){return Ke._fromVerification(e,t)}static credentialFromResult(e){const t=e;return Ot.credentialFromTaggedObject(t)}static credentialFromError(e){return Ot.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{phoneNumber:r,temporaryProof:a}=t;return r&&a?Ke._fromTokenResponse(r,a):null}}function Bt(e,t){return t?se(t):(k(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}Ot.PROVIDER_ID="phone",Ot.PHONE_SIGN_IN_METHOD="phone";class zt extends Be{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return qe(e,this._buildIdpRequest())}_linkToIdToken(e,t){return qe(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return qe(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function Ut(e){return lt(e.auth,new zt(e),e.bypassAuthState)}function Vt(e){const{auth:t,user:r}=e;return k(r,t,"internal-error"),ot(r,new zt(e),e.bypassAuthState)}async function qt(e){const{auth:t,user:r}=e;return k(r,t,"internal-error"),it(r,new zt(e),e.bypassAuthState)}class Ht{constructor(e,t,r,a){let n=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.auth=e,this.resolver=r,this.user=a,this.bypassAuthState=n,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:a,tenantId:n,error:s,type:i}=e;if(s)return void this.reject(s);const o={auth:this.auth,requestUri:t,sessionId:r,tenantId:n||void 0,postBody:a||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(i)(o))}catch(l){this.reject(l)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Ut;case"linkViaPopup":case"linkViaRedirect":return qt;case"reauthViaPopup":case"reauthViaRedirect":return Vt;default:x(this.auth,"internal-error")}}resolve(e){j(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){j(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const Gt=new A(2e3,1e4);class Wt extends Ht{constructor(e,t,r,a,n){super(e,t,a,n),this.provider=r,this.authWindow=null,this.pollId=null,Wt.currentPopupAction&&Wt.currentPopupAction.cancel(),Wt.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return k(e,this.auth,"internal-error"),e}async onExecution(){j(1===this.filter.length,"Popup operations only handle one event");const e=bt();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(e=>{this.reject(e)}),this.resolver._isIframeWebStorageSupported(this.auth,e=>{e||this.reject(y(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}cancel(){this.reject(y(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Wt.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t;null!==(t=this.authWindow)&&void 0!==t&&null!==(t=t.window)&&void 0!==t&&t.closed?this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(y(this.auth,"popup-closed-by-user"))},8e3):this.pollId=window.setTimeout(e,Gt.get())};e()}}Wt.currentPopupAction=null;const Kt=new Map;class Qt extends Ht{constructor(e,t){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,arguments.length>2&&void 0!==arguments[2]&&arguments[2]),this.eventId=null}async execute(){let e=Kt.get(this.auth._key());if(!e){try{const t=await async function(e,t){const r=Jt(t),a=Xt(e);if(!await a._isAvailable())return!1;const n="true"===await a._get(r);return await a._remove(r),n}(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(t)}catch(t){e=()=>Promise.reject(t)}Kt.set(this.auth._key(),e)}return this.bypassAuthState||Kt.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if("signInViaRedirect"===e.type)return super.onAuthEvent(e);if("unknown"!==e.type){if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}function Yt(e,t){Kt.set(e._key(),t)}function Xt(e){return se(e._redirectPersistence)}function Jt(e){return le("pendingRedirect",e.config.apiKey,e.name)}async function Zt(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if((0,s.xZ)(e.app))return Promise.reject(b(e));const a=je(e),n=Bt(a,t),i=new Qt(a,n,r),o=await i.execute();return o&&!r&&(delete o.user._redirectEventId,await a._persistUserIfCurrent(o.user),await a._setRedirectUser(null,t)),o}class $t{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return tr(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!tr(e)){var r;const a=(null===(r=e.error.code)||void 0===r?void 0:r.split("auth/")[1])||"internal-error";t.onError(y(this.auth,a))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(er(e))}saveEventToCache(e){this.cachedEventUids.add(er(e)),this.lastProcessedEventTime=Date.now()}}function er(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter(e=>e).join("-")}function tr(e){let{type:t,error:r}=e;return"unknown"===t&&(null===r||void 0===r?void 0:r.code)==="auth/".concat("no-auth-event")}const rr=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,ar=/^https?/;async function nr(e){if(e.config.emulator)return;const{authorizedDomains:t}=await async function(e){return L(e,"GET","/v1/projects",arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})}(e);for(const a of t)try{if(sr(a))return}catch(r){}x(e,"unauthorized-domain")}function sr(e){const t=S(),{protocol:r,hostname:a}=new URL(t);if(e.startsWith("chrome-extension://")){const n=new URL(e);return""===n.hostname&&""===a?"chrome-extension:"===r&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===r&&n.hostname===a}if(!ar.test(r))return!1;if(rr.test(e))return a===e;const n=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+n+"|"+n+")$","i").test(a)}const ir=new A(3e4,6e4);function or(){const e=kt().___jsl;if(null!==e&&void 0!==e&&e.H)for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let r=0;r<e.CP.length;r++)e.CP[r]=null}function lr(e){return new Promise((t,r)=>{var a,n;function s(){or(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{or(),r(y(e,"network-request-failed"))},timeout:ir.get()})}if(null!==(a=kt().gapi)&&void 0!==a&&null!==(a=a.iframes)&&void 0!==a&&a.Iframe)t(gapi.iframes.getContext());else{if(null===(n=kt().gapi)||void 0===n||!n.load){const t=Ae("iframefcb");return kt()[t]=()=>{gapi.load?s():r(y(e,"network-request-failed"))},Ee("".concat(_e.gapiScript,"?onload=").concat(t)).catch(e=>r(e))}s()}}).catch(e=>{throw cr=null,e})}let cr=null;const dr=new A(5e3,15e3),ur={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},hr=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function mr(e){const t=e.config;k(t.authDomain,e,"auth-domain-config-required");const r=t.emulator?C(t,"emulator/auth/iframe"):"https://".concat(e.config.authDomain,"/").concat("__/auth/iframe"),a={apiKey:t.apiKey,appName:e.name,v:s.MF},n=hr.get(e.config.apiHost);n&&(a.eid=n);const o=e._getFrameworks();return o.length&&(a.fw=o.join(",")),"".concat(r,"?").concat((0,i.Am)(a).slice(1))}async function fr(e){const t=await function(e){return cr=cr||lr(e),cr}(e),r=kt().gapi;return k(r,e,"internal-error"),t.open({where:document.body,url:mr(e),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:ur,dontclear:!0},t=>new Promise(async(r,a)=>{await t.restyle({setHideOnLeave:!1});const n=y(e,"network-request-failed"),s=kt().setTimeout(()=>{a(n)},dr.get());function i(){kt().clearTimeout(s),r(t)}t.ping(i).then(i,()=>{a(n)})}))}const gr={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class pr{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(e){}}}function xr(e,t,r){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:500,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:600;const o=Math.max((window.screen.availHeight-s)/2,0).toString(),l=Math.max((window.screen.availWidth-a)/2,0).toString();let c="";const d=(0,n.A)((0,n.A)({},gr),{},{width:a.toString(),height:s.toString(),top:o,left:l}),u=(0,i.ZQ)().toLowerCase();r&&(c=me(u)?"_blank":r),ue(u)&&(t=t||"http://localhost",d.scrollbars="yes");const h=Object.entries(d).reduce((e,t)=>{let[r,a]=t;return"".concat(e).concat(r,"=").concat(a,",")},"");if(function(){var e;return ye(arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,i.ZQ)())&&!(null===(e=window.navigator)||void 0===e||!e.standalone)}(u)&&"_self"!==c)return function(e,t){const r=document.createElement("a");r.href=e,r.target=t;const a=document.createEvent("MouseEvent");a.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(a)}(t||"",c),new pr(null);const m=window.open(t||"",c,h);k(m,e,"popup-blocked");try{m.focus()}catch(f){}return new pr(m)}const yr="__/auth/handler",vr="emulator/auth/handler",br=encodeURIComponent("fac");async function wr(e,t,r,a,n,o){k(e.config.authDomain,e,"auth-domain-config-required"),k(e.config.apiKey,e,"invalid-api-key");const l={apiKey:e.config.apiKey,appName:e.name,authType:r,redirectUrl:a,v:s.MF,eventId:n};if(t instanceof Xe){t.setDefaultLanguage(e.languageCode),l.providerId=t.providerId||"",(0,i.Im)(t.getCustomParameters())||(l.customParameters=JSON.stringify(t.getCustomParameters()));for(const[e,t]of Object.entries(o||{}))l[e]=t}if(t instanceof Je){const e=t.getScopes().filter(e=>""!==e);e.length>0&&(l.scopes=e.join(","))}e.tenantId&&(l.tid=e.tenantId);const c=l;for(const s of Object.keys(c))void 0===c[s]&&delete c[s];const d=await e._getAppCheckToken(),u=d?"#".concat(br,"=").concat(encodeURIComponent(d)):"";return"".concat(function(e){let{config:t}=e;if(!t.emulator)return"https://".concat(t.authDomain,"/").concat(yr);return C(t,vr)}(e),"?").concat((0,i.Am)(c).slice(1)).concat(u)}const kr="webStorageSupport";const Nr=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=yt,this._completeRedirectFn=Zt,this._overrideRedirectResult=Yt}async _openPopup(e,t,r,a){var n;j(null===(n=this.eventManagers[e._key()])||void 0===n?void 0:n.manager,"_initialize() not called before _openPopup()");return xr(e,await wr(e,t,r,S(),a),bt())}async _openRedirect(e,t,r,a){await this._originValidation(e);return function(e){kt().location.href=e}(await wr(e,t,r,S(),a)),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:e,promise:r}=this.eventManagers[t];return e?Promise.resolve(e):(j(r,"If manager is not set, promise should be"),r)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await fr(e),r=new $t(e);return t.register("authEvent",t=>{k(null===t||void 0===t?void 0:t.authEvent,e,"invalid-auth-event");return{status:r.onEvent(t.authEvent)?"ACK":"ERROR"}},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(kr,{type:kr},r=>{var a;const n=null===r||void 0===r||null===(a=r[0])||void 0===a?void 0:a[kr];void 0!==n&&t(!!n),x(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=nr(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return ve()||he()||ye()}};var jr="@firebase/auth",Sr="1.11.0";class _r{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}async getToken(e){if(this.assertAuthConfigured(),await this.auth._initializationPromise,!this.auth.currentUser)return null;return{accessToken:await this.auth.currentUser.getIdToken(e)}}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(t=>{e((null===t||void 0===t?void 0:t.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){k(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const Er=(0,i.XA)("authIdTokenMaxAge")||300;let Ar=null;const Cr=e=>async t=>{const r=t&&await t.getIdTokenResult(),a=r&&((new Date).getTime()-Date.parse(r.issuedAtTime))/1e3;if(a&&a>Er)return;const n=null===r||void 0===r?void 0:r.token;Ar!==n&&(Ar=n,await fetch(e,{method:n?"POST":"DELETE",headers:n?{Authorization:"Bearer ".concat(n)}:{}}))};function Ir(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,s.Sx)();const t=(0,s.j6)(e,"auth");if(t.isInitialized())return t.getImmediate();const r=function(e,t){const r=(0,s.j6)(e,"auth");if(r.isInitialized()){const e=r.getImmediate(),a=r.getOptions();if((0,i.bD)(a,null!==t&&void 0!==t?t:{}))return e;x(e,"already-initialized")}return r.initialize({options:t})}(e,{popupRedirectResolver:Nr,persistence:[Pt,mt,yt]}),a=(0,i.XA)("authTokenSyncURL");if(a&&"boolean"===typeof isSecureContext&&isSecureContext){const e=new URL(a,location.origin);if(location.origin===e.origin){const t=Cr(e.toString());!function(e,t,r){(0,i.Ku)(e).beforeAuthStateChanged(t,r)}(r,t,()=>t(r.currentUser)),function(e,t,r,a){(0,i.Ku)(e).onIdTokenChanged(t,r,a)}(r,e=>t(e))}}const n=(0,i.Tj)("auth");return n&&Me(r,"http://".concat(n)),r}var Tr;_e={loadJS:e=>new Promise((t,r)=>{const a=document.createElement("script");a.setAttribute("src",e),a.onload=t,a.onerror=e=>{const t=y("internal-error");t.customData=e,r(t)},a.type="text/javascript",a.charset="UTF-8",function(){var e,t;return null!==(e=null===(t=document.getElementsByTagName("head"))||void 0===t?void 0:t[0])&&void 0!==e?e:document}().appendChild(a)}),gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="},Tr="Browser",(0,s.om)(new l.uA("auth",(e,t)=>{let{options:r}=t;const a=e.getProvider("app").getImmediate(),n=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:i,authDomain:o}=a.options;k(i&&!i.includes(":"),"invalid-api-key",{appName:a.name});const l={apiKey:i,authDomain:o,clientPlatform:Tr,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:be(Tr)},c=new Ne(a,n,s,l);return function(e,t){const r=(null===t||void 0===t?void 0:t.persistence)||[],a=(Array.isArray(r)?r:[r]).map(se);null!==t&&void 0!==t&&t.errorMap&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(a,null===t||void 0===t?void 0:t.popupRedirectResolver)}(c,r),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),(0,s.om)(new l.uA("auth-internal",e=>(e=>new _r(e))(je(e.getProvider("auth").getImmediate())),"PRIVATE").setInstantiationMode("EXPLICIT")),(0,s.KO)(jr,Sr,function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}(Tr)),(0,s.KO)(jr,Sr,"esm2020")},2654:(e,t,r)=>{"use strict";var a=r(9950),n=Symbol.for("react.element"),s=Symbol.for("react.fragment"),i=Object.prototype.hasOwnProperty,o=a.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,r){var a,s={},c=null,d=null;for(a in void 0!==r&&(c=""+r),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(d=t.ref),t)i.call(t,a)&&!l.hasOwnProperty(a)&&(s[a]=t[a]);if(e&&e.defaultProps)for(a in t=e.defaultProps)void 0===s[a]&&(s[a]=t[a]);return{$$typeof:n,type:e,key:c,ref:d,props:s,_owner:o.current}}t.Fragment=s,t.jsx=c,t.jsxs=c},2689:function(e,t,r){e.exports=function(e){return function(){var t=e,r=t.lib,a=r.WordArray,n=r.Hasher,s=t.algo,i=[],o=s.SHA1=n.extend({_doReset:function(){this._hash=new a.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var r=this._hash.words,a=r[0],n=r[1],s=r[2],o=r[3],l=r[4],c=0;c<80;c++){if(c<16)i[c]=0|e[t+c];else{var d=i[c-3]^i[c-8]^i[c-14]^i[c-16];i[c]=d<<1|d>>>31}var u=(a<<5|a>>>27)+l+i[c];u+=c<20?1518500249+(n&s|~n&o):c<40?1859775393+(n^s^o):c<60?(n&s|n&o|s&o)-1894007588:(n^s^o)-899497514,l=o,o=s,s=n<<30|n>>>2,n=a,a=u}r[0]=r[0]+a|0,r[1]=r[1]+n|0,r[2]=r[2]+s|0,r[3]=r[3]+o|0,r[4]=r[4]+l|0},_doFinalize:function(){var e=this._data,t=e.words,r=8*this._nDataBytes,a=8*e.sigBytes;return t[a>>>5]|=128<<24-a%32,t[14+(a+64>>>9<<4)]=Math.floor(r/4294967296),t[15+(a+64>>>9<<4)]=r,e.sigBytes=4*t.length,this._process(),this._hash},clone:function(){var e=n.clone.call(this);return e._hash=this._hash.clone(),e}});t.SHA1=n._createHelper(o),t.HmacSHA1=n._createHmacHelper(o)}(),e.SHA1}(r(4703))},2768:function(e,t,r){e.exports=function(e){return e.mode.ECB=function(){var t=e.lib.BlockCipherMode.extend();return t.Encryptor=t.extend({processBlock:function(e,t){this._cipher.encryptBlock(e,t)}}),t.Decryptor=t.extend({processBlock:function(e,t){this._cipher.decryptBlock(e,t)}}),t}(),e.mode.ECB}(r(4703),r(7755))},2868:()=>{},2897:(e,t,r)=>{var a=r(3693);function n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,a)}return r}e.exports=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach(function(t){a(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e},e.exports.__esModule=!0,e.exports.default=e.exports},3137:function(e,t,r){e.exports=function(e){return function(){var t=e,r=t.lib.BlockCipher,a=t.algo,n=[],s=[],i=[],o=[],l=[],c=[],d=[],u=[],h=[],m=[];!function(){for(var e=[],t=0;t<256;t++)e[t]=t<128?t<<1:t<<1^283;var r=0,a=0;for(t=0;t<256;t++){var f=a^a<<1^a<<2^a<<3^a<<4;f=f>>>8^255&f^99,n[r]=f,s[f]=r;var g=e[r],p=e[g],x=e[p],y=257*e[f]^16843008*f;i[r]=y<<24|y>>>8,o[r]=y<<16|y>>>16,l[r]=y<<8|y>>>24,c[r]=y,y=16843009*x^65537*p^257*g^16843008*r,d[f]=y<<24|y>>>8,u[f]=y<<16|y>>>16,h[f]=y<<8|y>>>24,m[f]=y,r?(r=g^e[e[e[x^g]]],a^=e[e[a]]):r=a=1}}();var f=[0,1,2,4,8,16,32,64,128,27,54],g=a.AES=r.extend({_doReset:function(){if(!this._nRounds||this._keyPriorReset!==this._key){for(var e=this._keyPriorReset=this._key,t=e.words,r=e.sigBytes/4,a=4*((this._nRounds=r+6)+1),s=this._keySchedule=[],i=0;i<a;i++)i<r?s[i]=t[i]:(c=s[i-1],i%r?r>6&&i%r==4&&(c=n[c>>>24]<<24|n[c>>>16&255]<<16|n[c>>>8&255]<<8|n[255&c]):(c=n[(c=c<<8|c>>>24)>>>24]<<24|n[c>>>16&255]<<16|n[c>>>8&255]<<8|n[255&c],c^=f[i/r|0]<<24),s[i]=s[i-r]^c);for(var o=this._invKeySchedule=[],l=0;l<a;l++){if(i=a-l,l%4)var c=s[i];else c=s[i-4];o[l]=l<4||i<=4?c:d[n[c>>>24]]^u[n[c>>>16&255]]^h[n[c>>>8&255]]^m[n[255&c]]}}},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._keySchedule,i,o,l,c,n)},decryptBlock:function(e,t){var r=e[t+1];e[t+1]=e[t+3],e[t+3]=r,this._doCryptBlock(e,t,this._invKeySchedule,d,u,h,m,s),r=e[t+1],e[t+1]=e[t+3],e[t+3]=r},_doCryptBlock:function(e,t,r,a,n,s,i,o){for(var l=this._nRounds,c=e[t]^r[0],d=e[t+1]^r[1],u=e[t+2]^r[2],h=e[t+3]^r[3],m=4,f=1;f<l;f++){var g=a[c>>>24]^n[d>>>16&255]^s[u>>>8&255]^i[255&h]^r[m++],p=a[d>>>24]^n[u>>>16&255]^s[h>>>8&255]^i[255&c]^r[m++],x=a[u>>>24]^n[h>>>16&255]^s[c>>>8&255]^i[255&d]^r[m++],y=a[h>>>24]^n[c>>>16&255]^s[d>>>8&255]^i[255&u]^r[m++];c=g,d=p,u=x,h=y}g=(o[c>>>24]<<24|o[d>>>16&255]<<16|o[u>>>8&255]<<8|o[255&h])^r[m++],p=(o[d>>>24]<<24|o[u>>>16&255]<<16|o[h>>>8&255]<<8|o[255&c])^r[m++],x=(o[u>>>24]<<24|o[h>>>16&255]<<16|o[c>>>8&255]<<8|o[255&d])^r[m++],y=(o[h>>>24]<<24|o[c>>>16&255]<<16|o[d>>>8&255]<<8|o[255&u])^r[m++],e[t]=g,e[t+1]=p,e[t+2]=x,e[t+3]=y},keySize:8});t.AES=r._createHelper(g)}(),e.AES}(r(4703),r(3988),r(7766),r(7020),r(7755))},3693:(e,t,r)=>{var a=r(7736);e.exports=function(e,t,r){return(t=a(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e},e.exports.__esModule=!0,e.exports.default=e.exports},3738:e=>{function t(r){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,t(r)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},3986:(e,t,r)=>{"use strict";function a(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(-1!==t.indexOf(a))continue;r[a]=e[a]}return r}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)r=s[a],-1===t.indexOf(r)&&{}.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}r.d(t,{A:()=>a})},3988:function(e,t,r){e.exports=function(e){return function(){var t=e,r=t.lib.WordArray;function a(e,t,a){for(var n=[],s=0,i=0;i<t;i++)if(i%4){var o=a[e.charCodeAt(i-1)]<<i%4*2|a[e.charCodeAt(i)]>>>6-i%4*2;n[s>>>2]|=o<<24-s%4*8,s++}return r.create(n,s)}t.enc.Base64={stringify:function(e){var t=e.words,r=e.sigBytes,a=this._map;e.clamp();for(var n=[],s=0;s<r;s+=3)for(var i=(t[s>>>2]>>>24-s%4*8&255)<<16|(t[s+1>>>2]>>>24-(s+1)%4*8&255)<<8|t[s+2>>>2]>>>24-(s+2)%4*8&255,o=0;o<4&&s+.75*o<r;o++)n.push(a.charAt(i>>>6*(3-o)&63));var l=a.charAt(64);if(l)for(;n.length%4;)n.push(l);return n.join("")},parse:function(e){var t=e.length,r=this._map,n=this._reverseMap;if(!n){n=this._reverseMap=[];for(var s=0;s<r.length;s++)n[r.charCodeAt(s)]=s}var i=r.charAt(64);if(i){var o=e.indexOf(i);-1!==o&&(t=o)}return a(e,t,n)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),e.enc.Base64}(r(4703))},4239:function(e,t,r){e.exports=function(e){return e.pad.Iso10126={pad:function(t,r){var a=4*r,n=a-t.sigBytes%a;t.concat(e.lib.WordArray.random(n-1)).concat(e.lib.WordArray.create([n<<24],1))},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},e.pad.Iso10126}(r(4703),r(7755))},4272:(e,t,r)=>{"use strict";r.r(t),r.d(t,{deleteDB:()=>y,openDB:()=>x,unwrap:()=>p,wrap:()=>g});var a=r(9379);const n=(e,t)=>t.some(t=>e instanceof t);let s,i;const o=new WeakMap,l=new WeakMap,c=new WeakMap,d=new WeakMap,u=new WeakMap;let h={get(e,t,r){if(e instanceof IDBTransaction){if("done"===t)return l.get(e);if("objectStoreNames"===t)return e.objectStoreNames||c.get(e);if("store"===t)return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return g(e[t])},set:(e,t,r)=>(e[t]=r,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function m(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(i||(i=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(){for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return e.apply(p(this),r),g(o.get(this))}:function(){for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return g(e.apply(p(this),r))}:function(t){for(var r=arguments.length,a=new Array(r>1?r-1:0),n=1;n<r;n++)a[n-1]=arguments[n];const s=e.call(p(this),t,...a);return c.set(s,t.sort?t.sort():[t]),g(s)}}function f(e){return"function"===typeof e?m(e):(e instanceof IDBTransaction&&function(e){if(l.has(e))return;const t=new Promise((t,r)=>{const a=()=>{e.removeEventListener("complete",n),e.removeEventListener("error",s),e.removeEventListener("abort",s)},n=()=>{t(),a()},s=()=>{r(e.error||new DOMException("AbortError","AbortError")),a()};e.addEventListener("complete",n),e.addEventListener("error",s),e.addEventListener("abort",s)});l.set(e,t)}(e),n(e,s||(s=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(e,h):e)}function g(e){if(e instanceof IDBRequest)return function(e){const t=new Promise((t,r)=>{const a=()=>{e.removeEventListener("success",n),e.removeEventListener("error",s)},n=()=>{t(g(e.result)),a()},s=()=>{r(e.error),a()};e.addEventListener("success",n),e.addEventListener("error",s)});return t.then(t=>{t instanceof IDBCursor&&o.set(t,e)}).catch(()=>{}),u.set(t,e),t}(e);if(d.has(e))return d.get(e);const t=f(e);return t!==e&&(d.set(e,t),u.set(t,e)),t}const p=e=>u.get(e);function x(e,t){let{blocked:r,upgrade:a,blocking:n,terminated:s}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const i=indexedDB.open(e,t),o=g(i);return a&&i.addEventListener("upgradeneeded",e=>{a(g(i.result),e.oldVersion,e.newVersion,g(i.transaction),e)}),r&&i.addEventListener("blocked",e=>r(e.oldVersion,e.newVersion,e)),o.then(e=>{s&&e.addEventListener("close",()=>s()),n&&e.addEventListener("versionchange",e=>n(e.oldVersion,e.newVersion,e))}).catch(()=>{}),o}function y(e){let{blocked:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r=indexedDB.deleteDatabase(e);return t&&r.addEventListener("blocked",e=>t(e.oldVersion,e)),g(r).then(()=>{})}const v=["get","getKey","getAll","getAllKeys","count"],b=["put","add","delete","clear"],w=new Map;function k(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!==typeof t)return;if(w.get(t))return w.get(t);const r=t.replace(/FromIndex$/,""),a=t!==r,n=b.includes(r);if(!(r in(a?IDBIndex:IDBObjectStore).prototype)||!n&&!v.includes(r))return;const s=async function(e){const t=this.transaction(e,n?"readwrite":"readonly");let s=t.store;for(var i=arguments.length,o=new Array(i>1?i-1:0),l=1;l<i;l++)o[l-1]=arguments[l];return a&&(s=s.index(o.shift())),(await Promise.all([s[r](...o),n&&t.done]))[0]};return w.set(t,s),s}h=(e=>(0,a.A)((0,a.A)({},e),{},{get:(t,r,a)=>k(t,r)||e.get(t,r,a),has:(t,r)=>!!k(t,r)||e.has(t,r)}))(h)},4278:function(e,t,r){e.exports=function(e){return function(){var t=e,r=t.lib.StreamCipher,a=t.algo,n=[],s=[],i=[],o=a.RabbitLegacy=r.extend({_doReset:function(){var e=this._key.words,t=this.cfg.iv,r=this._X=[e[0],e[3]<<16|e[2]>>>16,e[1],e[0]<<16|e[3]>>>16,e[2],e[1]<<16|e[0]>>>16,e[3],e[2]<<16|e[1]>>>16],a=this._C=[e[2]<<16|e[2]>>>16,4294901760&e[0]|65535&e[1],e[3]<<16|e[3]>>>16,4294901760&e[1]|65535&e[2],e[0]<<16|e[0]>>>16,4294901760&e[2]|65535&e[3],e[1]<<16|e[1]>>>16,4294901760&e[3]|65535&e[0]];this._b=0;for(var n=0;n<4;n++)l.call(this);for(n=0;n<8;n++)a[n]^=r[n+4&7];if(t){var s=t.words,i=s[0],o=s[1],c=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8),d=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8),u=c>>>16|4294901760&d,h=d<<16|65535&c;for(a[0]^=c,a[1]^=u,a[2]^=d,a[3]^=h,a[4]^=c,a[5]^=u,a[6]^=d,a[7]^=h,n=0;n<4;n++)l.call(this)}},_doProcessBlock:function(e,t){var r=this._X;l.call(this),n[0]=r[0]^r[5]>>>16^r[3]<<16,n[1]=r[2]^r[7]>>>16^r[5]<<16,n[2]=r[4]^r[1]>>>16^r[7]<<16,n[3]=r[6]^r[3]>>>16^r[1]<<16;for(var a=0;a<4;a++)n[a]=16711935&(n[a]<<8|n[a]>>>24)|4278255360&(n[a]<<24|n[a]>>>8),e[t+a]^=n[a]},blockSize:4,ivSize:2});function l(){for(var e=this._X,t=this._C,r=0;r<8;r++)s[r]=t[r];for(t[0]=t[0]+1295307597+this._b|0,t[1]=t[1]+3545052371+(t[0]>>>0<s[0]>>>0?1:0)|0,t[2]=t[2]+886263092+(t[1]>>>0<s[1]>>>0?1:0)|0,t[3]=t[3]+1295307597+(t[2]>>>0<s[2]>>>0?1:0)|0,t[4]=t[4]+3545052371+(t[3]>>>0<s[3]>>>0?1:0)|0,t[5]=t[5]+886263092+(t[4]>>>0<s[4]>>>0?1:0)|0,t[6]=t[6]+1295307597+(t[5]>>>0<s[5]>>>0?1:0)|0,t[7]=t[7]+3545052371+(t[6]>>>0<s[6]>>>0?1:0)|0,this._b=t[7]>>>0<s[7]>>>0?1:0,r=0;r<8;r++){var a=e[r]+t[r],n=65535&a,o=a>>>16,l=((n*n>>>17)+n*o>>>15)+o*o,c=((4294901760&a)*a|0)+((65535&a)*a|0);i[r]=l^c}e[0]=i[0]+(i[7]<<16|i[7]>>>16)+(i[6]<<16|i[6]>>>16)|0,e[1]=i[1]+(i[0]<<8|i[0]>>>24)+i[7]|0,e[2]=i[2]+(i[1]<<16|i[1]>>>16)+(i[0]<<16|i[0]>>>16)|0,e[3]=i[3]+(i[2]<<8|i[2]>>>24)+i[1]|0,e[4]=i[4]+(i[3]<<16|i[3]>>>16)+(i[2]<<16|i[2]>>>16)|0,e[5]=i[5]+(i[4]<<8|i[4]>>>24)+i[3]|0,e[6]=i[6]+(i[5]<<16|i[5]>>>16)+(i[4]<<16|i[4]>>>16)|0,e[7]=i[7]+(i[6]<<8|i[6]>>>24)+i[5]|0}t.RabbitLegacy=r._createHelper(o)}(),e.RabbitLegacy}(r(4703),r(3988),r(7766),r(7020),r(7755))},4290:function(e,t,r){e.exports=function(e){return function(){var t=e,r=t.lib.Hasher,a=t.x64,n=a.Word,s=a.WordArray,i=t.algo;function o(){return n.create.apply(n,arguments)}var l=[o(1116352408,3609767458),o(1899447441,602891725),o(3049323471,3964484399),o(3921009573,2173295548),o(961987163,4081628472),o(1508970993,3053834265),o(2453635748,2937671579),o(2870763221,3664609560),o(3624381080,2734883394),o(310598401,1164996542),o(607225278,1323610764),o(1426881987,3590304994),o(1925078388,4068182383),o(2162078206,991336113),o(2614888103,633803317),o(3248222580,3479774868),o(3835390401,2666613458),o(4022224774,944711139),o(264347078,2341262773),o(604807628,2007800933),o(770255983,1495990901),o(1249150122,1856431235),o(1555081692,3175218132),o(1996064986,2198950837),o(2554220882,3999719339),o(2821834349,766784016),o(2952996808,2566594879),o(3210313671,3203337956),o(3336571891,1034457026),o(3584528711,2466948901),o(113926993,3758326383),o(338241895,168717936),o(666307205,1188179964),o(773529912,1546045734),o(1294757372,1522805485),o(1396182291,2643833823),o(1695183700,2343527390),o(1986661051,1014477480),o(2177026350,1206759142),o(2456956037,344077627),o(2730485921,1290863460),o(2820302411,3158454273),o(3259730800,3505952657),o(3345764771,106217008),o(3516065817,3606008344),o(3600352804,1432725776),o(4094571909,1467031594),o(275423344,851169720),o(430227734,3100823752),o(506948616,1363258195),o(659060556,3750685593),o(883997877,3785050280),o(958139571,3318307427),o(1322822218,3812723403),o(1537002063,2003034995),o(1747873779,3602036899),o(1955562222,1575990012),o(2024104815,1125592928),o(2227730452,2716904306),o(2361852424,442776044),o(2428436474,593698344),o(2756734187,3733110249),o(3204031479,2999351573),o(3329325298,3815920427),o(3391569614,3928383900),o(3515267271,566280711),o(3940187606,3454069534),o(4118630271,4000239992),o(116418474,1914138554),o(174292421,2731055270),o(289380356,3203993006),o(460393269,320620315),o(685471733,587496836),o(852142971,1086792851),o(1017036298,365543100),o(1126000580,2618297676),o(1288033470,3409855158),o(1501505948,4234509866),o(1607167915,987167468),o(1816402316,1246189591)],c=[];!function(){for(var e=0;e<80;e++)c[e]=o()}();var d=i.SHA512=r.extend({_doReset:function(){this._hash=new s.init([new n.init(1779033703,4089235720),new n.init(3144134277,2227873595),new n.init(1013904242,4271175723),new n.init(2773480762,1595750129),new n.init(1359893119,2917565137),new n.init(2600822924,725511199),new n.init(528734635,4215389547),new n.init(1541459225,327033209)])},_doProcessBlock:function(e,t){for(var r=this._hash.words,a=r[0],n=r[1],s=r[2],i=r[3],o=r[4],d=r[5],u=r[6],h=r[7],m=a.high,f=a.low,g=n.high,p=n.low,x=s.high,y=s.low,v=i.high,b=i.low,w=o.high,k=o.low,N=d.high,j=d.low,S=u.high,_=u.low,E=h.high,A=h.low,C=m,I=f,T=g,D=p,P=x,F=y,L=v,M=b,R=w,O=k,B=N,z=j,U=S,V=_,q=E,H=A,G=0;G<80;G++){var W,K,Q=c[G];if(G<16)K=Q.high=0|e[t+2*G],W=Q.low=0|e[t+2*G+1];else{var Y=c[G-15],X=Y.high,J=Y.low,Z=(X>>>1|J<<31)^(X>>>8|J<<24)^X>>>7,$=(J>>>1|X<<31)^(J>>>8|X<<24)^(J>>>7|X<<25),ee=c[G-2],te=ee.high,re=ee.low,ae=(te>>>19|re<<13)^(te<<3|re>>>29)^te>>>6,ne=(re>>>19|te<<13)^(re<<3|te>>>29)^(re>>>6|te<<26),se=c[G-7],ie=se.high,oe=se.low,le=c[G-16],ce=le.high,de=le.low;K=(K=(K=Z+ie+((W=$+oe)>>>0<$>>>0?1:0))+ae+((W+=ne)>>>0<ne>>>0?1:0))+ce+((W+=de)>>>0<de>>>0?1:0),Q.high=K,Q.low=W}var ue,he=R&B^~R&U,me=O&z^~O&V,fe=C&T^C&P^T&P,ge=I&D^I&F^D&F,pe=(C>>>28|I<<4)^(C<<30|I>>>2)^(C<<25|I>>>7),xe=(I>>>28|C<<4)^(I<<30|C>>>2)^(I<<25|C>>>7),ye=(R>>>14|O<<18)^(R>>>18|O<<14)^(R<<23|O>>>9),ve=(O>>>14|R<<18)^(O>>>18|R<<14)^(O<<23|R>>>9),be=l[G],we=be.high,ke=be.low,Ne=q+ye+((ue=H+ve)>>>0<H>>>0?1:0),je=xe+ge;q=U,H=V,U=B,V=z,B=R,z=O,R=L+(Ne=(Ne=(Ne=Ne+he+((ue+=me)>>>0<me>>>0?1:0))+we+((ue+=ke)>>>0<ke>>>0?1:0))+K+((ue+=W)>>>0<W>>>0?1:0))+((O=M+ue|0)>>>0<M>>>0?1:0)|0,L=P,M=F,P=T,F=D,T=C,D=I,C=Ne+(pe+fe+(je>>>0<xe>>>0?1:0))+((I=ue+je|0)>>>0<ue>>>0?1:0)|0}f=a.low=f+I,a.high=m+C+(f>>>0<I>>>0?1:0),p=n.low=p+D,n.high=g+T+(p>>>0<D>>>0?1:0),y=s.low=y+F,s.high=x+P+(y>>>0<F>>>0?1:0),b=i.low=b+M,i.high=v+L+(b>>>0<M>>>0?1:0),k=o.low=k+O,o.high=w+R+(k>>>0<O>>>0?1:0),j=d.low=j+z,d.high=N+B+(j>>>0<z>>>0?1:0),_=u.low=_+V,u.high=S+U+(_>>>0<V>>>0?1:0),A=h.low=A+H,h.high=E+q+(A>>>0<H>>>0?1:0)},_doFinalize:function(){var e=this._data,t=e.words,r=8*this._nDataBytes,a=8*e.sigBytes;return t[a>>>5]|=128<<24-a%32,t[30+(a+128>>>10<<5)]=Math.floor(r/4294967296),t[31+(a+128>>>10<<5)]=r,e.sigBytes=4*t.length,this._process(),this._hash.toX32()},clone:function(){var e=r.clone.call(this);return e._hash=this._hash.clone(),e},blockSize:32});t.SHA512=r._createHelper(d),t.HmacSHA512=r._createHmacHelper(d)}(),e.SHA512}(r(4703),r(4654))},4414:(e,t,r)=>{"use strict";e.exports=r(2654)},4459:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getDefaultsFromPostinstall=()=>{}},4618:(e,t,r)=>{(function(){"use strict";var t,a="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,r){return e==Array.prototype||e==Object.prototype||(e[t]=r.value),e};var n=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof r.g&&r.g];for(var t=0;t<e.length;++t){var a=e[t];if(a&&a.Math==Math)return a}throw Error("Cannot find global object")}(this);!function(e,t){if(t)e:{var r=n;e=e.split(".");for(var s=0;s<e.length-1;s++){var i=e[s];if(!(i in r))break e;r=r[i]}(t=t(s=r[e=e[e.length-1]]))!=s&&null!=t&&a(r,e,{configurable:!0,writable:!0,value:t})}}("Array.prototype.values",function(e){return e||function(){return function(e,t){e instanceof String&&(e+="");var r=0,a=!1,n={next:function(){if(!a&&r<e.length){var n=r++;return{value:t(n,e[n]),done:!1}}return a=!0,{done:!0,value:void 0}}};return n[Symbol.iterator]=function(){return n},n}(this,function(e,t){return t})}});var s=s||{},i=this||self;function o(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function l(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}function c(e,t,r){return e.call.apply(e.bind,arguments)}function d(e,t,r){if(!e)throw Error();if(2<arguments.length){var a=Array.prototype.slice.call(arguments,2);return function(){var r=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(r,a),e.apply(t,r)}}return function(){return e.apply(t,arguments)}}function u(e,t,r){return(u=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?c:d).apply(null,arguments)}function h(e,t){var r=Array.prototype.slice.call(arguments,1);return function(){var t=r.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function m(e,t){function r(){}r.prototype=t.prototype,e.aa=t.prototype,e.prototype=new r,e.prototype.constructor=e,e.Qb=function(e,r,a){for(var n=Array(arguments.length-2),s=2;s<arguments.length;s++)n[s-2]=arguments[s];return t.prototype[r].apply(e,n)}}function f(e){const t=e.length;if(0<t){const r=Array(t);for(let a=0;a<t;a++)r[a]=e[a];return r}return[]}function g(e,t){for(let r=1;r<arguments.length;r++){const t=arguments[r];if(o(t)){const r=e.length||0,a=t.length||0;e.length=r+a;for(let n=0;n<a;n++)e[r+n]=t[n]}else e.push(t)}}function p(e){return/^[\s\xa0]*$/.test(e)}function x(){var e=i.navigator;return e&&(e=e.userAgent)?e:""}function y(e){return y[" "](e),e}y[" "]=function(){};var v=-1!=x().indexOf("Gecko")&&!(-1!=x().toLowerCase().indexOf("webkit")&&-1==x().indexOf("Edge"))&&!(-1!=x().indexOf("Trident")||-1!=x().indexOf("MSIE"))&&-1==x().indexOf("Edge");function b(e,t,r){for(const a in e)t.call(r,e[a],a,e)}function w(e){const t={};for(const r in e)t[r]=e[r];return t}const k="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function N(e,t){let r,a;for(let n=1;n<arguments.length;n++){for(r in a=arguments[n],a)e[r]=a[r];for(let t=0;t<k.length;t++)r=k[t],Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}}function j(e){var t=1;e=e.split(":");const r=[];for(;0<t&&e.length;)r.push(e.shift()),t--;return e.length&&r.push(e.join(":")),r}function S(e){i.setTimeout(()=>{throw e},0)}function _(){var e=T;let t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var E=new class{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}(()=>new A,e=>e.reset());class A{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}let C,I=!1,T=new class{constructor(){this.h=this.g=null}add(e,t){const r=E.get();r.set(e,t),this.h?this.h.next=r:this.g=r,this.h=r}},D=()=>{const e=i.Promise.resolve(void 0);C=()=>{e.then(P)}};var P=()=>{for(var e;e=_();){try{e.h.call(e.g)}catch(r){S(r)}var t=E;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}I=!1};function F(){this.s=this.s,this.C=this.C}function L(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}F.prototype.s=!1,F.prototype.ma=function(){this.s||(this.s=!0,this.N())},F.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()},L.prototype.h=function(){this.defaultPrevented=!0};var M=function(){if(!i.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{const e=()=>{};i.addEventListener("test",e,t),i.removeEventListener("test",e,t)}catch(r){}return e}();function R(e,t){if(L.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var r=this.type=e.type,a=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(v){e:{try{y(t.nodeName);var n=!0;break e}catch(s){}n=!1}n||(t=null)}}else"mouseover"==r?t=e.fromElement:"mouseout"==r&&(t=e.toElement);this.relatedTarget=t,a?(this.clientX=void 0!==a.clientX?a.clientX:a.pageX,this.clientY=void 0!==a.clientY?a.clientY:a.pageY,this.screenX=a.screenX||0,this.screenY=a.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"===typeof e.pointerType?e.pointerType:O[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&R.aa.h.call(this)}}m(R,L);var O={2:"touch",3:"pen",4:"mouse"};R.prototype.h=function(){R.aa.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var B="closure_listenable_"+(1e6*Math.random()|0),z=0;function U(e,t,r,a,n){this.listener=e,this.proxy=null,this.src=t,this.type=r,this.capture=!!a,this.ha=n,this.key=++z,this.da=this.fa=!1}function V(e){e.da=!0,e.listener=null,e.proxy=null,e.src=null,e.ha=null}function q(e){this.src=e,this.g={},this.h=0}function H(e,t){var r=t.type;if(r in e.g){var a,n=e.g[r],s=Array.prototype.indexOf.call(n,t,void 0);(a=0<=s)&&Array.prototype.splice.call(n,s,1),a&&(V(t),0==e.g[r].length&&(delete e.g[r],e.h--))}}function G(e,t,r,a){for(var n=0;n<e.length;++n){var s=e[n];if(!s.da&&s.listener==t&&s.capture==!!r&&s.ha==a)return n}return-1}q.prototype.add=function(e,t,r,a,n){var s=e.toString();(e=this.g[s])||(e=this.g[s]=[],this.h++);var i=G(e,t,a,n);return-1<i?(t=e[i],r||(t.fa=!1)):((t=new U(t,this.src,s,!!a,n)).fa=r,e.push(t)),t};var W="closure_lm_"+(1e6*Math.random()|0),K={};function Q(e,t,r,a,n){if(a&&a.once)return X(e,t,r,a,n);if(Array.isArray(t)){for(var s=0;s<t.length;s++)Q(e,t[s],r,a,n);return null}return r=ae(r),e&&e[B]?e.K(t,r,l(a)?!!a.capture:!!a,n):Y(e,t,r,!1,a,n)}function Y(e,t,r,a,n,s){if(!t)throw Error("Invalid event type");var i=l(n)?!!n.capture:!!n,o=te(e);if(o||(e[W]=o=new q(e)),(r=o.add(t,r,a,i,s)).proxy)return r;if(a=function(){function e(r){return t.call(e.src,e.listener,r)}const t=ee;return e}(),r.proxy=a,a.src=e,a.listener=r,e.addEventListener)M||(n=i),void 0===n&&(n=!1),e.addEventListener(t.toString(),a,n);else if(e.attachEvent)e.attachEvent($(t.toString()),a);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(a)}return r}function X(e,t,r,a,n){if(Array.isArray(t)){for(var s=0;s<t.length;s++)X(e,t[s],r,a,n);return null}return r=ae(r),e&&e[B]?e.L(t,r,l(a)?!!a.capture:!!a,n):Y(e,t,r,!0,a,n)}function J(e,t,r,a,n){if(Array.isArray(t))for(var s=0;s<t.length;s++)J(e,t[s],r,a,n);else a=l(a)?!!a.capture:!!a,r=ae(r),e&&e[B]?(e=e.i,(t=String(t).toString())in e.g&&(-1<(r=G(s=e.g[t],r,a,n))&&(V(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.g[t],e.h--)))):e&&(e=te(e))&&(t=e.g[t.toString()],e=-1,t&&(e=G(t,r,a,n)),(r=-1<e?t[e]:null)&&Z(r))}function Z(e){if("number"!==typeof e&&e&&!e.da){var t=e.src;if(t&&t[B])H(t.i,e);else{var r=e.type,a=e.proxy;t.removeEventListener?t.removeEventListener(r,a,e.capture):t.detachEvent?t.detachEvent($(r),a):t.addListener&&t.removeListener&&t.removeListener(a),(r=te(t))?(H(r,e),0==r.h&&(r.src=null,t[W]=null)):V(e)}}}function $(e){return e in K?K[e]:K[e]="on"+e}function ee(e,t){if(e.da)e=!0;else{t=new R(t,this);var r=e.listener,a=e.ha||e.src;e.fa&&Z(e),e=r.call(a,t)}return e}function te(e){return(e=e[W])instanceof q?e:null}var re="__closure_events_fn_"+(1e9*Math.random()>>>0);function ae(e){return"function"===typeof e?e:(e[re]||(e[re]=function(t){return e.handleEvent(t)}),e[re])}function ne(){F.call(this),this.i=new q(this),this.M=this,this.F=null}function se(e,t){var r,a=e.F;if(a)for(r=[];a;a=a.F)r.push(a);if(e=e.M,a=t.type||t,"string"===typeof t)t=new L(t,e);else if(t instanceof L)t.target=t.target||e;else{var n=t;N(t=new L(a,e),n)}if(n=!0,r)for(var s=r.length-1;0<=s;s--){var i=t.g=r[s];n=ie(i,a,!0,t)&&n}if(n=ie(i=t.g=e,a,!0,t)&&n,n=ie(i,a,!1,t)&&n,r)for(s=0;s<r.length;s++)n=ie(i=t.g=r[s],a,!1,t)&&n}function ie(e,t,r,a){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var n=!0,s=0;s<t.length;++s){var i=t[s];if(i&&!i.da&&i.capture==r){var o=i.listener,l=i.ha||i.src;i.fa&&H(e.i,i),n=!1!==o.call(l,a)&&n}}return n&&!a.defaultPrevented}function oe(e,t,r){if("function"===typeof e)r&&(e=u(e,r));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=u(e.handleEvent,e)}return 2147483647<Number(t)?-1:i.setTimeout(e,t||0)}function le(e){e.g=oe(()=>{e.g=null,e.i&&(e.i=!1,le(e))},e.l);const t=e.h;e.h=null,e.m.apply(null,t)}m(ne,F),ne.prototype[B]=!0,ne.prototype.removeEventListener=function(e,t,r,a){J(this,e,t,r,a)},ne.prototype.N=function(){if(ne.aa.N.call(this),this.i){var e,t=this.i;for(e in t.g){for(var r=t.g[e],a=0;a<r.length;a++)V(r[a]);delete t.g[e],t.h--}}this.F=null},ne.prototype.K=function(e,t,r,a){return this.i.add(String(e),t,!1,r,a)},ne.prototype.L=function(e,t,r,a){return this.i.add(String(e),t,!0,r,a)};class ce extends F{constructor(e,t){super(),this.m=e,this.l=t,this.h=null,this.i=!1,this.g=null}j(e){this.h=arguments,this.g?this.i=!0:le(this)}N(){super.N(),this.g&&(i.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function de(e){F.call(this),this.h=e,this.g={}}m(de,F);var ue=[];function he(e){b(e.g,function(e,t){this.g.hasOwnProperty(t)&&Z(e)},e),e.g={}}de.prototype.N=function(){de.aa.N.call(this),he(this)},de.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var me=i.JSON.stringify,fe=i.JSON.parse,ge=class{stringify(e){return i.JSON.stringify(e,void 0)}parse(e){return i.JSON.parse(e,void 0)}};function pe(){}function xe(e){return e.h||(e.h=e.i())}function ye(){}pe.prototype.h=null;var ve={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function be(){L.call(this,"d")}function we(){L.call(this,"c")}m(be,L),m(we,L);var ke={},Ne=null;function je(){return Ne=Ne||new ne}function Se(e){L.call(this,ke.La,e)}function _e(e){const t=je();se(t,new Se(t,e))}function Ee(e,t){L.call(this,ke.STAT_EVENT,e),this.stat=t}function Ae(e){const t=je();se(t,new Ee(t,e))}function Ce(e,t){L.call(this,ke.Ma,e),this.size=t}function Ie(e,t){if("function"!==typeof e)throw Error("Fn must not be null and must be a function");return i.setTimeout(function(){e()},t)}function Te(){this.g=!0}function De(e,t,r,a){e.info(function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var r=JSON.parse(t);if(r)for(e=0;e<r.length;e++)if(Array.isArray(r[e])){var a=r[e];if(!(2>a.length)){var n=a[1];if(Array.isArray(n)&&!(1>n.length)){var s=n[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var i=1;i<n.length;i++)n[i]=""}}}return me(r)}catch(o){return t}}(e,r)+(a?" "+a:"")})}ke.La="serverreachability",m(Se,L),ke.STAT_EVENT="statevent",m(Ee,L),ke.Ma="timingevent",m(Ce,L),Te.prototype.xa=function(){this.g=!1},Te.prototype.info=function(){};var Pe,Fe={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Le={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"};function Me(){}function Re(e,t,r,a){this.j=e,this.i=t,this.l=r,this.R=a||1,this.U=new de(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Oe}function Oe(){this.i=null,this.g="",this.h=!1}m(Me,pe),Me.prototype.g=function(){return new XMLHttpRequest},Me.prototype.i=function(){return{}},Pe=new Me;var Be={},ze={};function Ue(e,t,r){e.L=1,e.v=mt(lt(t)),e.m=r,e.P=!0,Ve(e,null)}function Ve(e,t){e.F=Date.now(),Ge(e),e.A=lt(e.v);var r=e.A,a=e.R;Array.isArray(a)||(a=[String(a)]),Et(r.i,"t",a),e.C=0,r=e.j.J,e.h=new Oe,e.g=fr(e.j,r?t:null,!e.m),0<e.O&&(e.M=new ce(u(e.Y,e,e.g),e.O)),t=e.U,r=e.g,a=e.ca;var n="readystatechange";Array.isArray(n)||(n&&(ue[0]=n.toString()),n=ue);for(var s=0;s<n.length;s++){var i=Q(r,n[s],a||t.handleEvent,!1,t.h||t);if(!i)break;t.g[i.key]=i}t=e.H?w(e.H):{},e.m?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ea(e.A,e.u,e.m,t)):(e.u="GET",e.g.ea(e.A,e.u,null,t)),_e(1),function(e,t,r,a,n,s){e.info(function(){if(e.g)if(s)for(var i="",o=s.split("&"),l=0;l<o.length;l++){var c=o[l].split("=");if(1<c.length){var d=c[0];c=c[1];var u=d.split("_");i=2<=u.length&&"type"==u[1]?i+(d+"=")+c+"&":i+(d+"=redacted&")}}else i=null;else i=s;return"XMLHTTP REQ ("+a+") [attempt "+n+"]: "+t+"\n"+r+"\n"+i})}(e.i,e.u,e.A,e.l,e.R,e.m)}function qe(e){return!!e.g&&("GET"==e.u&&2!=e.L&&e.j.Ca)}function He(e,t){var r=e.C,a=t.indexOf("\n",r);return-1==a?ze:(r=Number(t.substring(r,a)),isNaN(r)?Be:(a+=1)+r>t.length?ze:(t=t.slice(a,a+r),e.C=a+r,t))}function Ge(e){e.S=Date.now()+e.I,We(e,e.I)}function We(e,t){if(null!=e.B)throw Error("WatchDog timer not null");e.B=Ie(u(e.ba,e),t)}function Ke(e){e.B&&(i.clearTimeout(e.B),e.B=null)}function Qe(e){0==e.j.G||e.J||cr(e.j,e)}function Ye(e){Ke(e);var t=e.M;t&&"function"==typeof t.ma&&t.ma(),e.M=null,he(e.U),e.g&&(t=e.g,e.g=null,t.abort(),t.ma())}function Xe(e,t){try{var r=e.j;if(0!=r.G&&(r.g==e||tt(r.h,e)))if(!e.K&&tt(r.h,e)&&3==r.G){try{var a=r.Da.g.parse(t)}catch(c){a=null}if(Array.isArray(a)&&3==a.length){var n=a;if(0==n[0]){e:if(!r.u){if(r.g){if(!(r.g.F+3e3<e.F))break e;lr(r),Zt(r)}sr(r),Ae(18)}}else r.za=n[1],0<r.za-r.T&&37500>n[2]&&r.F&&0==r.v&&!r.C&&(r.C=Ie(u(r.Za,r),6e3));if(1>=et(r.h)&&r.ca){try{r.ca()}catch(c){}r.ca=void 0}}else ur(r,11)}else if((e.K||r.g==e)&&lr(r),!p(t))for(n=r.Da.g.parse(t),t=0;t<n.length;t++){let c=n[t];if(r.T=c[0],c=c[1],2==r.G)if("c"==c[0]){r.K=c[1],r.ia=c[2];const t=c[3];null!=t&&(r.la=t,r.j.info("VER="+r.la));const n=c[4];null!=n&&(r.Aa=n,r.j.info("SVER="+r.Aa));const d=c[5];null!=d&&"number"===typeof d&&0<d&&(a=1.5*d,r.L=a,r.j.info("backChannelRequestTimeoutMs_="+a)),a=r;const u=e.g;if(u){const e=u.g?u.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(e){var s=a.h;s.g||-1==e.indexOf("spdy")&&-1==e.indexOf("quic")&&-1==e.indexOf("h2")||(s.j=s.l,s.g=new Set,s.h&&(rt(s,s.h),s.h=null))}if(a.D){const e=u.g?u.g.getResponseHeader("X-HTTP-Session-Id"):null;e&&(a.ya=e,ht(a.I,a.D,e))}}r.G=3,r.l&&r.l.ua(),r.ba&&(r.R=Date.now()-e.F,r.j.info("Handshake RTT: "+r.R+"ms"));var i=e;if((a=r).qa=mr(a,a.J?a.ia:null,a.W),i.K){at(a.h,i);var o=i,l=a.L;l&&(o.I=l),o.B&&(Ke(o),Ge(o)),a.g=i}else nr(a);0<r.i.length&&er(r)}else"stop"!=c[0]&&"close"!=c[0]||ur(r,7);else 3==r.G&&("stop"==c[0]||"close"==c[0]?"stop"==c[0]?ur(r,7):Jt(r):"noop"!=c[0]&&r.l&&r.l.ta(c),r.v=0)}_e(4)}catch(c){}}Re.prototype.ca=function(e){e=e.target;const t=this.M;t&&3==Kt(e)?t.j():this.Y(e)},Re.prototype.Y=function(e){try{if(e==this.g)e:{const h=Kt(this.g);var t=this.g.Ba();const m=this.g.Z();if(!(3>h)&&(3!=h||this.g&&(this.h.h||this.g.oa()||Qt(this.g)))){this.J||4!=h||7==t||_e(8==t||0>=m?3:2),Ke(this);var r=this.g.Z();this.X=r;t:if(qe(this)){var a=Qt(this.g);e="";var n=a.length,s=4==Kt(this.g);if(!this.h.i){if("undefined"===typeof TextDecoder){Ye(this),Qe(this);var o="";break t}this.h.i=new i.TextDecoder}for(t=0;t<n;t++)this.h.h=!0,e+=this.h.i.decode(a[t],{stream:!(s&&t==n-1)});a.length=0,this.h.g+=e,this.C=0,o=this.h.g}else o=this.g.oa();if(this.o=200==r,function(e,t,r,a,n,s,i){e.info(function(){return"XMLHTTP RESP ("+a+") [ attempt "+n+"]: "+t+"\n"+r+"\n"+s+" "+i})}(this.i,this.u,this.A,this.l,this.R,h,r),this.o){if(this.T&&!this.K){t:{if(this.g){var l,c=this.g;if((l=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!p(l)){var d=l;break t}}d=null}if(!(r=d)){this.o=!1,this.s=3,Ae(12),Ye(this),Qe(this);break e}De(this.i,this.l,r,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Xe(this,r)}if(this.P){let e;for(r=!0;!this.J&&this.C<o.length;){if(e=He(this,o),e==ze){4==h&&(this.s=4,Ae(14),r=!1),De(this.i,this.l,null,"[Incomplete Response]");break}if(e==Be){this.s=4,Ae(15),De(this.i,this.l,o,"[Invalid Chunk]"),r=!1;break}De(this.i,this.l,e,null),Xe(this,e)}if(qe(this)&&0!=this.C&&(this.h.g=this.h.g.slice(this.C),this.C=0),4!=h||0!=o.length||this.h.h||(this.s=1,Ae(16),r=!1),this.o=this.o&&r,r){if(0<o.length&&!this.W){this.W=!0;var u=this.j;u.g==this&&u.ba&&!u.M&&(u.j.info("Great, no buffering proxy detected. Bytes received: "+o.length),ir(u),u.M=!0,Ae(11))}}else De(this.i,this.l,o,"[Invalid Chunked Response]"),Ye(this),Qe(this)}else De(this.i,this.l,o,null),Xe(this,o);4==h&&Ye(this),this.o&&!this.J&&(4==h?cr(this.j,this):(this.o=!1,Ge(this)))}else(function(e){const t={};e=(e.g&&2<=Kt(e)&&e.g.getAllResponseHeaders()||"").split("\r\n");for(let a=0;a<e.length;a++){if(p(e[a]))continue;var r=j(e[a]);const n=r[0];if("string"!==typeof(r=r[1]))continue;r=r.trim();const s=t[n]||[];t[n]=s,s.push(r)}!function(e,t){for(const r in e)t.call(void 0,e[r],r,e)}(t,function(e){return e.join(", ")})})(this.g),400==r&&0<o.indexOf("Unknown SID")?(this.s=3,Ae(12)):(this.s=0,Ae(13)),Ye(this),Qe(this)}}}catch(h){}},Re.prototype.cancel=function(){this.J=!0,Ye(this)},Re.prototype.ba=function(){this.B=null;const e=Date.now();0<=e-this.S?(function(e,t){e.info(function(){return"TIMEOUT: "+t})}(this.i,this.A),2!=this.L&&(_e(3),Ae(17)),Ye(this),this.s=2,Qe(this)):We(this,this.S-e)};var Je=class{constructor(e,t){this.g=e,this.map=t}};function Ze(e){this.l=e||10,i.PerformanceNavigationTiming?e=0<(e=i.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):e=!!(i.chrome&&i.chrome.loadTimes&&i.chrome.loadTimes()&&i.chrome.loadTimes().wasFetchedViaSpdy),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function $e(e){return!!e.h||!!e.g&&e.g.size>=e.j}function et(e){return e.h?1:e.g?e.g.size:0}function tt(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function rt(e,t){e.g?e.g.add(t):e.h=t}function at(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function nt(e){if(null!=e.h)return e.i.concat(e.h.D);if(null!=e.g&&0!==e.g.size){let t=e.i;for(const r of e.g.values())t=t.concat(r.D);return t}return f(e.i)}function st(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(o(e)||"string"===typeof e)Array.prototype.forEach.call(e,t,void 0);else for(var r=function(e){if(e.na&&"function"==typeof e.na)return e.na();if(!e.V||"function"!=typeof e.V){if("undefined"!==typeof Map&&e instanceof Map)return Array.from(e.keys());if(!("undefined"!==typeof Set&&e instanceof Set)){if(o(e)||"string"===typeof e){var t=[];e=e.length;for(var r=0;r<e;r++)t.push(r);return t}t=[],r=0;for(const a in e)t[r++]=a;return t}}}(e),a=function(e){if(e.V&&"function"==typeof e.V)return e.V();if("undefined"!==typeof Map&&e instanceof Map||"undefined"!==typeof Set&&e instanceof Set)return Array.from(e.values());if("string"===typeof e)return e.split("");if(o(e)){for(var t=[],r=e.length,a=0;a<r;a++)t.push(e[a]);return t}for(a in t=[],r=0,e)t[r++]=e[a];return t}(e),n=a.length,s=0;s<n;s++)t.call(void 0,a[s],r&&r[s],e)}Ze.prototype.cancel=function(){if(this.i=nt(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const e of this.g.values())e.cancel();this.g.clear()}};var it=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function ot(e){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,e instanceof ot){this.h=e.h,ct(this,e.j),this.o=e.o,this.g=e.g,dt(this,e.s),this.l=e.l;var t=e.i,r=new Nt;r.i=t.i,t.g&&(r.g=new Map(t.g),r.h=t.h),ut(this,r),this.m=e.m}else e&&(t=String(e).match(it))?(this.h=!1,ct(this,t[1]||"",!0),this.o=ft(t[2]||""),this.g=ft(t[3]||"",!0),dt(this,t[4]),this.l=ft(t[5]||"",!0),ut(this,t[6]||"",!0),this.m=ft(t[7]||"")):(this.h=!1,this.i=new Nt(null,this.h))}function lt(e){return new ot(e)}function ct(e,t,r){e.j=r?ft(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function dt(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.s=t}else e.s=null}function ut(e,t,r){t instanceof Nt?(e.i=t,function(e,t){t&&!e.j&&(jt(e),e.i=null,e.g.forEach(function(e,t){var r=t.toLowerCase();t!=r&&(St(this,t),Et(this,r,e))},e)),e.j=t}(e.i,e.h)):(r||(t=gt(t,wt)),e.i=new Nt(t,e.h))}function ht(e,t,r){e.i.set(t,r)}function mt(e){return ht(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function ft(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function gt(e,t,r){return"string"===typeof e?(e=encodeURI(e).replace(t,pt),r&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function pt(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}ot.prototype.toString=function(){var e=[],t=this.j;t&&e.push(gt(t,yt,!0),":");var r=this.g;return(r||"file"==t)&&(e.push("//"),(t=this.o)&&e.push(gt(t,yt,!0),"@"),e.push(encodeURIComponent(String(r)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(r=this.s)&&e.push(":",String(r))),(r=this.l)&&(this.g&&"/"!=r.charAt(0)&&e.push("/"),e.push(gt(r,"/"==r.charAt(0)?bt:vt,!0))),(r=this.i.toString())&&e.push("?",r),(r=this.m)&&e.push("#",gt(r,kt)),e.join("")};var xt,yt=/[#\/\?@]/g,vt=/[#\?:]/g,bt=/[#\?]/g,wt=/[#\?@]/g,kt=/#/g;function Nt(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function jt(e){e.g||(e.g=new Map,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var r=0;r<e.length;r++){var a=e[r].indexOf("="),n=null;if(0<=a){var s=e[r].substring(0,a);n=e[r].substring(a+1)}else s=e[r];t(s,n?decodeURIComponent(n.replace(/\+/g," ")):"")}}}(e.i,function(t,r){e.add(decodeURIComponent(t.replace(/\+/g," ")),r)}))}function St(e,t){jt(e),t=At(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function _t(e,t){return jt(e),t=At(e,t),e.g.has(t)}function Et(e,t,r){St(e,t),0<r.length&&(e.i=null,e.g.set(At(e,t),f(r)),e.h+=r.length)}function At(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}function Ct(e,t,r,a,n){try{n&&(n.onload=null,n.onerror=null,n.onabort=null,n.ontimeout=null),a(r)}catch(s){}}function It(){this.g=new ge}function Tt(e,t,r){const a=r||"";try{st(e,function(e,r){let n=e;l(e)&&(n=me(e)),t.push(a+r+"="+encodeURIComponent(n))})}catch(n){throw t.push(a+"type="+encodeURIComponent("_badmap")),n}}function Dt(e){this.l=e.Ub||null,this.j=e.eb||!1}function Pt(e,t){ne.call(this),this.D=e,this.o=t,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}function Ft(e){e.j.read().then(e.Pa.bind(e)).catch(e.ga.bind(e))}function Lt(e){e.readyState=4,e.l=null,e.j=null,e.v=null,Mt(e)}function Mt(e){e.onreadystatechange&&e.onreadystatechange.call(e)}function Rt(e){let t="";return b(e,function(e,r){t+=r,t+=":",t+=e,t+="\r\n"}),t}function Ot(e,t,r){e:{for(a in r){var a=!1;break e}a=!0}a||(r=Rt(r),"string"===typeof e?(encodeURIComponent(String(t)),null!=r&&encodeURIComponent(String(r))):ht(e,t,r))}function Bt(e){ne.call(this),this.headers=new Map,this.o=e||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}(t=Nt.prototype).add=function(e,t){jt(this),this.i=null,e=At(this,e);var r=this.g.get(e);return r||this.g.set(e,r=[]),r.push(t),this.h+=1,this},t.forEach=function(e,t){jt(this),this.g.forEach(function(r,a){r.forEach(function(r){e.call(t,r,a,this)},this)},this)},t.na=function(){jt(this);const e=Array.from(this.g.values()),t=Array.from(this.g.keys()),r=[];for(let a=0;a<t.length;a++){const n=e[a];for(let e=0;e<n.length;e++)r.push(t[a])}return r},t.V=function(e){jt(this);let t=[];if("string"===typeof e)_t(this,e)&&(t=t.concat(this.g.get(At(this,e))));else{e=Array.from(this.g.values());for(let r=0;r<e.length;r++)t=t.concat(e[r])}return t},t.set=function(e,t){return jt(this),this.i=null,_t(this,e=At(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},t.get=function(e,t){return e&&0<(e=this.V(e)).length?String(e[0]):t},t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const e=[],t=Array.from(this.g.keys());for(var r=0;r<t.length;r++){var a=t[r];const s=encodeURIComponent(String(a)),i=this.V(a);for(a=0;a<i.length;a++){var n=s;""!==i[a]&&(n+="="+encodeURIComponent(String(i[a]))),e.push(n)}}return this.i=e.join("&")},m(Dt,pe),Dt.prototype.g=function(){return new Pt(this.l,this.j)},Dt.prototype.i=(xt={},function(){return xt}),m(Pt,ne),(t=Pt.prototype).open=function(e,t){if(0!=this.readyState)throw this.abort(),Error("Error reopening a connection");this.B=e,this.A=t,this.readyState=1,Mt(this)},t.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const t={headers:this.u,method:this.B,credentials:this.m,cache:void 0};e&&(t.body=e),(this.D||i).fetch(new Request(this.A,t)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Lt(this)),this.readyState=0},t.Sa=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,Mt(this)),this.g&&(this.readyState=3,Mt(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if("undefined"!==typeof i.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Ft(this)}else e.text().then(this.Ra.bind(this),this.ga.bind(this))},t.Pa=function(e){if(this.g){if(this.o&&e.value)this.response.push(e.value);else if(!this.o){var t=e.value?e.value:new Uint8Array(0);(t=this.v.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?Lt(this):Mt(this),3==this.readyState&&Ft(this)}},t.Ra=function(e){this.g&&(this.response=this.responseText=e,Lt(this))},t.Qa=function(e){this.g&&(this.response=e,Lt(this))},t.ga=function(){this.g&&Lt(this)},t.setRequestHeader=function(e,t){this.u.append(e,t)},t.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const e=[],t=this.h.entries();for(var r=t.next();!r.done;)r=r.value,e.push(r[0]+": "+r[1]),r=t.next();return e.join("\r\n")},Object.defineProperty(Pt.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}}),m(Bt,ne);var zt=/^https?$/i,Ut=["POST","PUT"];function Vt(e,t){e.h=!1,e.g&&(e.j=!0,e.g.abort(),e.j=!1),e.l=t,e.m=5,qt(e),Gt(e)}function qt(e){e.A||(e.A=!0,se(e,"complete"),se(e,"error"))}function Ht(e){if(e.h&&"undefined"!=typeof s&&(!e.v[1]||4!=Kt(e)||2!=e.Z()))if(e.u&&4==Kt(e))oe(e.Ea,0,e);else if(se(e,"readystatechange"),4==Kt(e)){e.h=!1;try{const s=e.Z();e:switch(s){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break e;default:t=!1}var r;if(!(r=t)){var a;if(a=0===s){var n=String(e.D).match(it)[1]||null;!n&&i.self&&i.self.location&&(n=i.self.location.protocol.slice(0,-1)),a=!zt.test(n?n.toLowerCase():"")}r=a}if(r)se(e,"complete"),se(e,"success");else{e.m=6;try{var o=2<Kt(e)?e.g.statusText:""}catch(l){o=""}e.l=o+" ["+e.Z()+"]",qt(e)}}finally{Gt(e)}}}function Gt(e,t){if(e.g){Wt(e);const a=e.g,n=e.v[0]?()=>{}:null;e.g=null,e.v=null,t||se(e,"ready");try{a.onreadystatechange=n}catch(r){}}}function Wt(e){e.I&&(i.clearTimeout(e.I),e.I=null)}function Kt(e){return e.g?e.g.readyState:0}function Qt(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.H){case"":case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(t){return null}}function Yt(e,t,r){return r&&r.internalChannelParams&&r.internalChannelParams[e]||t}function Xt(e){this.Aa=0,this.i=[],this.j=new Te,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Yt("failFast",!1,e),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Yt("baseRetryDelayMs",5e3,e),this.cb=Yt("retryDelaySeedMs",1e4,e),this.Wa=Yt("forwardChannelMaxRetries",2,e),this.wa=Yt("forwardChannelRequestTimeoutMs",2e4,e),this.pa=e&&e.xmlHttpFactory||void 0,this.Xa=e&&e.Tb||void 0,this.Ca=e&&e.useFetchStreams||!1,this.L=void 0,this.J=e&&e.supportsCrossDomainXhr||!1,this.K="",this.h=new Ze(e&&e.concurrentRequestLimit),this.Da=new It,this.P=e&&e.fastHandshake||!1,this.O=e&&e.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=e&&e.Rb||!1,e&&e.xa&&this.j.xa(),e&&e.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&e&&e.detectBufferingProxy||!1,this.ja=void 0,e&&e.longPollingTimeout&&0<e.longPollingTimeout&&(this.ja=e.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}function Jt(e){if($t(e),3==e.G){var t=e.U++,r=lt(e.I);if(ht(r,"SID",e.K),ht(r,"RID",t),ht(r,"TYPE","terminate"),rr(e,r),(t=new Re(e,e.j,t)).L=2,t.v=mt(lt(r)),r=!1,i.navigator&&i.navigator.sendBeacon)try{r=i.navigator.sendBeacon(t.v.toString(),"")}catch(a){}!r&&i.Image&&((new Image).src=t.v,r=!0),r||(t.g=fr(t.j,null),t.g.ea(t.v)),t.F=Date.now(),Ge(t)}hr(e)}function Zt(e){e.g&&(ir(e),e.g.cancel(),e.g=null)}function $t(e){Zt(e),e.u&&(i.clearTimeout(e.u),e.u=null),lr(e),e.h.cancel(),e.s&&("number"===typeof e.s&&i.clearTimeout(e.s),e.s=null)}function er(e){if(!$e(e.h)&&!e.s){e.s=!0;var t=e.Ga;C||D(),I||(C(),I=!0),T.add(t,e),e.B=0}}function tr(e,t){var r;r=t?t.l:e.U++;const a=lt(e.I);ht(a,"SID",e.K),ht(a,"RID",r),ht(a,"AID",e.T),rr(e,a),e.m&&e.o&&Ot(a,e.m,e.o),r=new Re(e,e.j,r,e.B+1),null===e.m&&(r.H=e.o),t&&(e.i=t.D.concat(e.i)),t=ar(e,r,1e3),r.I=Math.round(.5*e.wa)+Math.round(.5*e.wa*Math.random()),rt(e.h,r),Ue(r,a,t)}function rr(e,t){e.H&&b(e.H,function(e,r){ht(t,r,e)}),e.l&&st({},function(e,r){ht(t,r,e)})}function ar(e,t,r){r=Math.min(e.i.length,r);var a=e.l?u(e.l.Na,e.l,e):null;e:{var n=e.i;let t=-1;for(;;){const e=["count="+r];-1==t?0<r?(t=n[0].g,e.push("ofs="+t)):t=0:e.push("ofs="+t);let i=!0;for(let o=0;o<r;o++){let r=n[o].g;const l=n[o].map;if(r-=t,0>r)t=Math.max(0,n[o].g-100),i=!1;else try{Tt(l,e,"req"+r+"_")}catch(s){a&&a(l)}}if(i){a=e.join("&");break e}}}return e=e.i.splice(0,r),t.D=e,a}function nr(e){if(!e.g&&!e.u){e.Y=1;var t=e.Fa;C||D(),I||(C(),I=!0),T.add(t,e),e.v=0}}function sr(e){return!(e.g||e.u||3<=e.v)&&(e.Y++,e.u=Ie(u(e.Fa,e),dr(e,e.v)),e.v++,!0)}function ir(e){null!=e.A&&(i.clearTimeout(e.A),e.A=null)}function or(e){e.g=new Re(e,e.j,"rpc",e.Y),null===e.m&&(e.g.H=e.o),e.g.O=0;var t=lt(e.qa);ht(t,"RID","rpc"),ht(t,"SID",e.K),ht(t,"AID",e.T),ht(t,"CI",e.F?"0":"1"),!e.F&&e.ja&&ht(t,"TO",e.ja),ht(t,"TYPE","xmlhttp"),rr(e,t),e.m&&e.o&&Ot(t,e.m,e.o),e.L&&(e.g.I=e.L);var r=e.g;e=e.ia,r.L=1,r.v=mt(lt(t)),r.m=null,r.P=!0,Ve(r,e)}function lr(e){null!=e.C&&(i.clearTimeout(e.C),e.C=null)}function cr(e,t){var r=null;if(e.g==t){lr(e),ir(e),e.g=null;var a=2}else{if(!tt(e.h,t))return;r=t.D,at(e.h,t),a=1}if(0!=e.G)if(t.o)if(1==a){r=t.m?t.m.length:0,t=Date.now()-t.F;var n=e.B;se(a=je(),new Ce(a,r,t,n)),er(e)}else nr(e);else if(3==(n=t.s)||0==n&&0<t.X||!(1==a&&function(e,t){return!(et(e.h)>=e.h.j-(e.s?1:0))&&(e.s?(e.i=t.D.concat(e.i),!0):!(1==e.G||2==e.G||e.B>=(e.Va?0:e.Wa))&&(e.s=Ie(u(e.Ga,e,t),dr(e,e.B)),e.B++,!0))}(e,t)||2==a&&sr(e)))switch(r&&0<r.length&&(t=e.h,t.i=t.i.concat(r)),n){case 1:ur(e,5);break;case 4:ur(e,10);break;case 3:ur(e,6);break;default:ur(e,2)}}function dr(e,t){let r=e.Ta+Math.floor(Math.random()*e.cb);return e.isActive()||(r*=2),r*t}function ur(e,t){if(e.j.info("Error code "+t),2==t){var r=u(e.fb,e),a=e.Xa;const t=!a;a=new ot(a||"//www.google.com/images/cleardot.gif"),i.location&&"http"==i.location.protocol||ct(a,"https"),mt(a),t?function(e,t){const r=new Te;if(i.Image){const a=new Image;a.onload=h(Ct,r,"TestLoadImage: loaded",!0,t,a),a.onerror=h(Ct,r,"TestLoadImage: error",!1,t,a),a.onabort=h(Ct,r,"TestLoadImage: abort",!1,t,a),a.ontimeout=h(Ct,r,"TestLoadImage: timeout",!1,t,a),i.setTimeout(function(){a.ontimeout&&a.ontimeout()},1e4),a.src=e}else t(!1)}(a.toString(),r):function(e,t){new Te;const r=new AbortController,a=setTimeout(()=>{r.abort(),Ct(0,0,!1,t)},1e4);fetch(e,{signal:r.signal}).then(e=>{clearTimeout(a),e.ok?Ct(0,0,!0,t):Ct(0,0,!1,t)}).catch(()=>{clearTimeout(a),Ct(0,0,!1,t)})}(a.toString(),r)}else Ae(2);e.G=0,e.l&&e.l.sa(t),hr(e),$t(e)}function hr(e){if(e.G=0,e.ka=[],e.l){const t=nt(e.h);0==t.length&&0==e.i.length||(g(e.ka,t),g(e.ka,e.i),e.h.i.length=0,f(e.i),e.i.length=0),e.l.ra()}}function mr(e,t,r){var a=r instanceof ot?lt(r):new ot(r);if(""!=a.g)t&&(a.g=t+"."+a.g),dt(a,a.s);else{var n=i.location;a=n.protocol,t=t?t+"."+n.hostname:n.hostname,n=+n.port;var s=new ot(null);a&&ct(s,a),t&&(s.g=t),n&&dt(s,n),r&&(s.l=r),a=s}return r=e.D,t=e.ya,r&&t&&ht(a,r,t),ht(a,"VER",e.la),rr(e,a),a}function fr(e,t,r){if(t&&!e.J)throw Error("Can't create secondary domain capable XhrIo object.");return(t=e.Ca&&!e.pa?new Bt(new Dt({eb:r})):new Bt(e.pa)).Ha(e.J),t}function gr(){}function pr(){}function xr(e,t){ne.call(this),this.g=new Xt(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.o=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.va&&(e?e["X-WebChannel-Client-Profile"]=t.va:e={"X-WebChannel-Client-Profile":t.va}),this.g.S=e,(e=t&&t.Sb)&&!p(e)&&(this.g.m=e),this.v=t&&t.supportsCrossDomainXhr||!1,this.u=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!p(t)&&(this.g.D=t,null!==(e=this.h)&&t in e&&(t in(e=this.h)&&delete e[t])),this.j=new br(this)}function yr(e){be.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var t=e.__sm__;if(t){e:{for(const r in t){e=r;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function vr(){we.call(this),this.status=1}function br(e){this.g=e}(t=Bt.prototype).Ha=function(e){this.J=e},t.ea=function(e,t,r,a){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+e);t=t?t.toUpperCase():"GET",this.D=e,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Pe.g(),this.v=this.o?xe(this.o):xe(Pe),this.g.onreadystatechange=u(this.Ea,this);try{this.B=!0,this.g.open(t,String(e),!0),this.B=!1}catch(s){return void Vt(this,s)}if(e=r||"",r=new Map(this.headers),a)if(Object.getPrototypeOf(a)===Object.prototype)for(var n in a)r.set(n,a[n]);else{if("function"!==typeof a.keys||"function"!==typeof a.get)throw Error("Unknown input type for opt_headers: "+String(a));for(const e of a.keys())r.set(e,a.get(e))}a=Array.from(r.keys()).find(e=>"content-type"==e.toLowerCase()),n=i.FormData&&e instanceof i.FormData,!(0<=Array.prototype.indexOf.call(Ut,t,void 0))||a||n||r.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[i,o]of r)this.g.setRequestHeader(i,o);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Wt(this),this.u=!0,this.g.send(e),this.u=!1}catch(s){Vt(this,s)}},t.abort=function(e){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=e||7,se(this,"complete"),se(this,"abort"),Gt(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Gt(this,!0)),Bt.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?Ht(this):this.bb())},t.bb=function(){Ht(this)},t.isActive=function(){return!!this.g},t.Z=function(){try{return 2<Kt(this)?this.g.status:-1}catch(xt){return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch(xt){return""}},t.Oa=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),fe(t)}},t.Ba=function(){return this.m},t.Ka=function(){return"string"===typeof this.l?this.l:String(this.l)},(t=Xt.prototype).la=8,t.G=1,t.connect=function(e,t,r,a){Ae(0),this.W=e,this.H=t||{},r&&void 0!==a&&(this.H.OSID=r,this.H.OAID=a),this.F=this.X,this.I=mr(this,null,this.W),er(this)},t.Ga=function(e){if(this.s)if(this.s=null,1==this.G){if(!e){this.U=Math.floor(1e5*Math.random()),e=this.U++;const n=new Re(this,this.j,e);let s=this.o;if(this.S&&(s?(s=w(s),N(s,this.S)):s=this.S),null!==this.m||this.O||(n.H=s,s=null),this.P)e:{for(var t=0,r=0;r<this.i.length;r++){var a=this.i[r];if(void 0===(a="__data__"in a.map&&"string"===typeof(a=a.map.__data__)?a.length:void 0))break;if(4096<(t+=a)){t=r;break e}if(4096===t||r===this.i.length-1){t=r+1;break e}}t=1e3}else t=1e3;t=ar(this,n,t),ht(r=lt(this.I),"RID",e),ht(r,"CVER",22),this.D&&ht(r,"X-HTTP-Session-Id",this.D),rr(this,r),s&&(this.O?t="headers="+encodeURIComponent(String(Rt(s)))+"&"+t:this.m&&Ot(r,this.m,s)),rt(this.h,n),this.Ua&&ht(r,"TYPE","init"),this.P?(ht(r,"$req",t),ht(r,"SID","null"),n.T=!0,Ue(n,r,null)):Ue(n,r,t),this.G=2}}else 3==this.G&&(e?tr(this,e):0==this.i.length||$e(this.h)||tr(this))},t.Fa=function(){if(this.u=null,or(this),this.ba&&!(this.M||null==this.g||0>=this.R)){var e=2*this.R;this.j.info("BP detection timer enabled: "+e),this.A=Ie(u(this.ab,this),e)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Ae(10),Zt(this),or(this))},t.Za=function(){null!=this.C&&(this.C=null,Zt(this),sr(this),Ae(19))},t.fb=function(e){e?(this.j.info("Successfully pinged google.com"),Ae(2)):(this.j.info("Failed to ping google.com"),Ae(1))},t.isActive=function(){return!!this.l&&this.l.isActive(this)},(t=gr.prototype).ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){},pr.prototype.g=function(e,t){return new xr(e,t)},m(xr,ne),xr.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},xr.prototype.close=function(){Jt(this.g)},xr.prototype.o=function(e){var t=this.g;if("string"===typeof e){var r={};r.__data__=e,e=r}else this.u&&((r={}).__data__=me(e),e=r);t.i.push(new Je(t.Ya++,e)),3==t.G&&er(t)},xr.prototype.N=function(){this.g.l=null,delete this.j,Jt(this.g),delete this.g,xr.aa.N.call(this)},m(yr,be),m(vr,we),m(br,gr),br.prototype.ua=function(){se(this.g,"a")},br.prototype.ta=function(e){se(this.g,new yr(e))},br.prototype.sa=function(e){se(this.g,new vr(e))},br.prototype.ra=function(){se(this.g,"b")},pr.prototype.createWebChannel=pr.prototype.g,xr.prototype.send=xr.prototype.o,xr.prototype.open=xr.prototype.m,xr.prototype.close=xr.prototype.close,e.exports.createWebChannelTransport=function(){return new pr},e.exports.getStatEventTarget=function(){return je()},e.exports.Event=ke,e.exports.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Fe.NO_ERROR=0,Fe.TIMEOUT=8,Fe.HTTP_ERROR=6,e.exports.ErrorCode=Fe,Le.COMPLETE="complete",e.exports.EventType=Le,ye.EventType=ve,ve.OPEN="a",ve.CLOSE="b",ve.ERROR="c",ve.MESSAGE="d",ne.prototype.listen=ne.prototype.K,e.exports.WebChannel=ye,e.exports.FetchXmlHttpFactory=Dt,Bt.prototype.listenOnce=Bt.prototype.L,Bt.prototype.getLastError=Bt.prototype.Ka,Bt.prototype.getLastErrorCode=Bt.prototype.Ba,Bt.prototype.getStatus=Bt.prototype.Z,Bt.prototype.getResponseJson=Bt.prototype.Oa,Bt.prototype.getResponseText=Bt.prototype.oa,Bt.prototype.send=Bt.prototype.ea,Bt.prototype.setWithCredentials=Bt.prototype.Ha,e.exports.XhrIo=Bt}).apply("undefined"!==typeof r.g?r.g:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})},4654:function(e,t,r){e.exports=function(e){return function(t){var r=e,a=r.lib,n=a.Base,s=a.WordArray,i=r.x64={};i.Word=n.extend({init:function(e,t){this.high=e,this.low=t}}),i.WordArray=n.extend({init:function(e,r){e=this.words=e||[],this.sigBytes=r!=t?r:8*e.length},toX32:function(){for(var e=this.words,t=e.length,r=[],a=0;a<t;a++){var n=e[a];r.push(n.high),r.push(n.low)}return s.create(r,this.sigBytes)},clone:function(){for(var e=n.clone.call(this),t=e.words=this.words.slice(0),r=t.length,a=0;a<r;a++)t[a]=t[a].clone();return e}})}(),e}(r(4703))},4703:function(e,t,r){e.exports=function(){var e=e||function(e,t){var a;if("undefined"!==typeof window&&window.crypto&&(a=window.crypto),"undefined"!==typeof self&&self.crypto&&(a=self.crypto),"undefined"!==typeof globalThis&&globalThis.crypto&&(a=globalThis.crypto),!a&&"undefined"!==typeof window&&window.msCrypto&&(a=window.msCrypto),!a&&"undefined"!==typeof r.g&&r.g.crypto&&(a=r.g.crypto),!a)try{a=r(477)}catch(p){}var n=function(){if(a){if("function"===typeof a.getRandomValues)try{return a.getRandomValues(new Uint32Array(1))[0]}catch(p){}if("function"===typeof a.randomBytes)try{return a.randomBytes(4).readInt32LE()}catch(p){}}throw new Error("Native crypto module could not be used to get secure random number.")},s=Object.create||function(){function e(){}return function(t){var r;return e.prototype=t,r=new e,e.prototype=null,r}}(),i={},o=i.lib={},l=o.Base={extend:function(e){var t=s(this);return e&&t.mixIn(e),t.hasOwnProperty("init")&&this.init!==t.init||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},c=o.WordArray=l.extend({init:function(e,r){e=this.words=e||[],this.sigBytes=r!=t?r:4*e.length},toString:function(e){return(e||u).stringify(this)},concat:function(e){var t=this.words,r=e.words,a=this.sigBytes,n=e.sigBytes;if(this.clamp(),a%4)for(var s=0;s<n;s++){var i=r[s>>>2]>>>24-s%4*8&255;t[a+s>>>2]|=i<<24-(a+s)%4*8}else for(var o=0;o<n;o+=4)t[a+o>>>2]=r[o>>>2];return this.sigBytes+=n,this},clamp:function(){var t=this.words,r=this.sigBytes;t[r>>>2]&=4294967295<<32-r%4*8,t.length=e.ceil(r/4)},clone:function(){var e=l.clone.call(this);return e.words=this.words.slice(0),e},random:function(e){for(var t=[],r=0;r<e;r+=4)t.push(n());return new c.init(t,e)}}),d=i.enc={},u=d.Hex={stringify:function(e){for(var t=e.words,r=e.sigBytes,a=[],n=0;n<r;n++){var s=t[n>>>2]>>>24-n%4*8&255;a.push((s>>>4).toString(16)),a.push((15&s).toString(16))}return a.join("")},parse:function(e){for(var t=e.length,r=[],a=0;a<t;a+=2)r[a>>>3]|=parseInt(e.substr(a,2),16)<<24-a%8*4;return new c.init(r,t/2)}},h=d.Latin1={stringify:function(e){for(var t=e.words,r=e.sigBytes,a=[],n=0;n<r;n++){var s=t[n>>>2]>>>24-n%4*8&255;a.push(String.fromCharCode(s))}return a.join("")},parse:function(e){for(var t=e.length,r=[],a=0;a<t;a++)r[a>>>2]|=(255&e.charCodeAt(a))<<24-a%4*8;return new c.init(r,t)}},m=d.Utf8={stringify:function(e){try{return decodeURIComponent(escape(h.stringify(e)))}catch(t){throw new Error("Malformed UTF-8 data")}},parse:function(e){return h.parse(unescape(encodeURIComponent(e)))}},f=o.BufferedBlockAlgorithm=l.extend({reset:function(){this._data=new c.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=m.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var r,a=this._data,n=a.words,s=a.sigBytes,i=this.blockSize,o=s/(4*i),l=(o=t?e.ceil(o):e.max((0|o)-this._minBufferSize,0))*i,d=e.min(4*l,s);if(l){for(var u=0;u<l;u+=i)this._doProcessBlock(n,u);r=n.splice(0,l),a.sigBytes-=d}return new c.init(r,d)},clone:function(){var e=l.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0}),g=(o.Hasher=f.extend({cfg:l.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){f.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,r){return new e.init(r).finalize(t)}},_createHmacHelper:function(e){return function(t,r){return new g.HMAC.init(e,r).finalize(t)}}}),i.algo={});return i}(Math);return e}()},4774:function(e,t,r){e.exports=function(e){return function(){var t=e,r=t.lib,a=r.WordArray,n=r.BlockCipher,s=t.algo,i=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],o=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],l=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],c=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],d=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],u=s.DES=n.extend({_doReset:function(){for(var e=this._key.words,t=[],r=0;r<56;r++){var a=i[r]-1;t[r]=e[a>>>5]>>>31-a%32&1}for(var n=this._subKeys=[],s=0;s<16;s++){var c=n[s]=[],d=l[s];for(r=0;r<24;r++)c[r/6|0]|=t[(o[r]-1+d)%28]<<31-r%6,c[4+(r/6|0)]|=t[28+(o[r+24]-1+d)%28]<<31-r%6;for(c[0]=c[0]<<1|c[0]>>>31,r=1;r<7;r++)c[r]=c[r]>>>4*(r-1)+3;c[7]=c[7]<<5|c[7]>>>27}var u=this._invSubKeys=[];for(r=0;r<16;r++)u[r]=n[15-r]},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._subKeys)},decryptBlock:function(e,t){this._doCryptBlock(e,t,this._invSubKeys)},_doCryptBlock:function(e,t,r){this._lBlock=e[t],this._rBlock=e[t+1],h.call(this,4,252645135),h.call(this,16,65535),m.call(this,2,858993459),m.call(this,8,16711935),h.call(this,1,1431655765);for(var a=0;a<16;a++){for(var n=r[a],s=this._lBlock,i=this._rBlock,o=0,l=0;l<8;l++)o|=c[l][((i^n[l])&d[l])>>>0];this._lBlock=i,this._rBlock=s^o}var u=this._lBlock;this._lBlock=this._rBlock,this._rBlock=u,h.call(this,1,1431655765),m.call(this,8,16711935),m.call(this,2,858993459),h.call(this,16,65535),h.call(this,4,252645135),e[t]=this._lBlock,e[t+1]=this._rBlock},keySize:2,ivSize:2,blockSize:2});function h(e,t){var r=(this._lBlock>>>e^this._rBlock)&t;this._rBlock^=r,this._lBlock^=r<<e}function m(e,t){var r=(this._rBlock>>>e^this._lBlock)&t;this._lBlock^=r,this._rBlock^=r<<e}t.DES=n._createHelper(u);var f=s.TripleDES=n.extend({_doReset:function(){var e=this._key.words;if(2!==e.length&&4!==e.length&&e.length<6)throw new Error("Invalid key length - 3DES requires the key length to be 64, 128, 192 or >192.");var t=e.slice(0,2),r=e.length<4?e.slice(0,2):e.slice(2,4),n=e.length<6?e.slice(0,2):e.slice(4,6);this._des1=u.createEncryptor(a.create(t)),this._des2=u.createEncryptor(a.create(r)),this._des3=u.createEncryptor(a.create(n))},encryptBlock:function(e,t){this._des1.encryptBlock(e,t),this._des2.decryptBlock(e,t),this._des3.encryptBlock(e,t)},decryptBlock:function(e,t){this._des3.decryptBlock(e,t),this._des2.encryptBlock(e,t),this._des1.decryptBlock(e,t)},keySize:6,ivSize:2,blockSize:2});t.TripleDES=n._createHelper(f)}(),e.TripleDES}(r(4703),r(3988),r(7766),r(7020),r(7755))},4798:function(e,t,r){e.exports=function(e){return function(){var t=e,r=t.lib.WordArray,a=t.algo,n=a.SHA256,s=a.SHA224=n.extend({_doReset:function(){this._hash=new r.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var e=n._doFinalize.call(this);return e.sigBytes-=4,e}});t.SHA224=n._createHelper(s),t.HmacSHA224=n._createHmacHelper(s)}(),e.SHA224}(r(4703),r(7427))},4980:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});var a=r(2284);function n(e){var t=function(e,t){if("object"!=(0,a.A)(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=(0,a.A)(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==(0,a.A)(t)?t:t+""}function s(e,t,r){return(t=n(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}},5003:function(e,t,r){e.exports=function(e){return function(){var t=e,r=t.lib.StreamCipher,a=t.algo,n=a.RC4=r.extend({_doReset:function(){for(var e=this._key,t=e.words,r=e.sigBytes,a=this._S=[],n=0;n<256;n++)a[n]=n;n=0;for(var s=0;n<256;n++){var i=n%r,o=t[i>>>2]>>>24-i%4*8&255;s=(s+a[n]+o)%256;var l=a[n];a[n]=a[s],a[s]=l}this._i=this._j=0},_doProcessBlock:function(e,t){e[t]^=s.call(this)},keySize:8,ivSize:0});function s(){for(var e=this._S,t=this._i,r=this._j,a=0,n=0;n<4;n++){r=(r+e[t=(t+1)%256])%256;var s=e[t];e[t]=e[r],e[r]=s,a|=e[(e[t]+e[r])%256]<<24-8*n}return this._i=t,this._j=r,a}t.RC4=r._createHelper(n);var i=a.RC4Drop=n.extend({cfg:n.cfg.extend({drop:192}),_doReset:function(){n._doReset.call(this);for(var e=this.cfg.drop;e>0;e--)s.call(this)}});t.RC4Drop=r._createHelper(i)}(),e.RC4}(r(4703),r(3988),r(7766),r(7020),r(7755))},5097:(e,t,r)=>{"use strict";var a=r(2897).default;Object.defineProperty(t,"__esModule",{value:!0});var n=r(2045),s=r(1042),i=r(1494),o=r(4272);class l{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(function(e){const t=e.getComponent();return"VERSION"===(null===t||void 0===t?void 0:t.type)}(e)){const t=e.getImmediate();return"".concat(t.library,"/").concat(t.version)}return null}).filter(e=>e).join(" ")}}const c="@firebase/app",d="0.14.2",u=new s.Logger("@firebase/app"),h="@firebase/app-compat",m="@firebase/analytics-compat",f="@firebase/analytics",g="@firebase/app-check-compat",p="@firebase/app-check",x="@firebase/auth",y="@firebase/auth-compat",v="@firebase/database",b="@firebase/data-connect",w="@firebase/database-compat",k="@firebase/functions",N="@firebase/functions-compat",j="@firebase/installations",S="@firebase/installations-compat",_="@firebase/messaging",E="@firebase/messaging-compat",A="@firebase/performance",C="@firebase/performance-compat",I="@firebase/remote-config",T="@firebase/remote-config-compat",D="@firebase/storage",P="@firebase/storage-compat",F="@firebase/firestore",L="@firebase/ai",M="@firebase/firestore-compat",R="firebase",O="[DEFAULT]",B={[c]:"fire-core",[h]:"fire-core-compat",[f]:"fire-analytics",[m]:"fire-analytics-compat",[p]:"fire-app-check",[g]:"fire-app-check-compat",[x]:"fire-auth",[y]:"fire-auth-compat",[v]:"fire-rtdb",[b]:"fire-data-connect",[w]:"fire-rtdb-compat",[k]:"fire-fn",[N]:"fire-fn-compat",[j]:"fire-iid",[S]:"fire-iid-compat",[_]:"fire-fcm",[E]:"fire-fcm-compat",[A]:"fire-perf",[C]:"fire-perf-compat",[I]:"fire-rc",[T]:"fire-rc-compat",[D]:"fire-gcs",[P]:"fire-gcs-compat",[F]:"fire-fst",[M]:"fire-fst-compat",[L]:"fire-vertex","fire-js":"fire-js",[R]:"fire-js-all"},z=new Map,U=new Map,V=new Map;function q(e,t){try{e.container.addComponent(t)}catch(r){u.debug("Component ".concat(t.name," failed to register with FirebaseApp ").concat(e.name),r)}}function H(e){const t=e.name;if(V.has(t))return u.debug("There were multiple attempts to register component ".concat(t,".")),!1;V.set(t,e);for(const r of z.values())q(r,e);for(const r of U.values())q(r,e);return!0}function G(e,t){const r=e.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),e.container.getProvider(t)}function W(e){return void 0!==e.options}function K(e){return!W(e)&&("authIdToken"in e||"appCheckToken"in e||"releaseOnDeref"in e||"automaticDataCollectionEnabled"in e)}const Q={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Y=new i.ErrorFactory("app","Firebase",Q);class X{constructor(e,t,r){this._isDeleted=!1,this._options=a({},e),this._config=a({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new n.Component("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Y.create("app-deleted",{appName:this._name})}}function J(e,t){const r=i.base64Decode(e.split(".")[1]);if(null===r)return void console.error("FirebaseServerApp ".concat(t," is invalid: second part could not be parsed."));if(void 0===JSON.parse(r).exp)return void console.error("FirebaseServerApp ".concat(t," is invalid: expiration claim could not be parsed"));1e3*JSON.parse(r).exp-(new Date).getTime()<=0&&console.error("FirebaseServerApp ".concat(t," is invalid: the token has expired."))}class Z extends X{constructor(e,t,r,n){const s=void 0===t.automaticDataCollectionEnabled||t.automaticDataCollectionEnabled,i={name:r,automaticDataCollectionEnabled:s};if(void 0!==e.apiKey)super(e,i,n);else{super(e.options,i,n)}this._serverConfig=a({automaticDataCollectionEnabled:s},t),this._serverConfig.authIdToken&&J(this._serverConfig.authIdToken,"authIdToken"),this._serverConfig.appCheckToken&&J(this._serverConfig.appCheckToken,"appCheckToken"),this._finalizationRegistry=null,"undefined"!==typeof FinalizationRegistry&&(this._finalizationRegistry=new FinalizationRegistry(()=>{this.automaticCleanup()})),this._refCount=0,this.incRefCount(this._serverConfig.releaseOnDeref),this._serverConfig.releaseOnDeref=void 0,t.releaseOnDeref=void 0,te(c,d,"serverapp")}toJSON(){}get refCount(){return this._refCount}incRefCount(e){this.isDeleted||(this._refCount++,void 0!==e&&null!==this._finalizationRegistry&&this._finalizationRegistry.register(e,this))}decRefCount(){return this.isDeleted?0:--this._refCount}automaticCleanup(){ee(this)}get settings(){return this.checkDestroyed(),this._serverConfig}checkDestroyed(){if(this.isDeleted)throw Y.create("server-app-deleted")}}function $(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e;if("object"!==typeof t){t={name:t}}const s=a({name:O,automaticDataCollectionEnabled:!0},t),o=s.name;if("string"!==typeof o||!o)throw Y.create("bad-app-name",{appName:String(o)});if(r||(r=i.getDefaultAppConfig()),!r)throw Y.create("no-options");const l=z.get(o);if(l){if(i.deepEqual(r,l.options)&&i.deepEqual(s,l.config))return l;throw Y.create("duplicate-app",{appName:o})}const c=new n.ComponentContainer(o);for(const a of V.values())c.addComponent(a);const d=new X(r,s,c);return z.set(o,d),d}async function ee(e){let t=!1;const r=e.name;if(z.has(r))t=!0,z.delete(r);else if(U.has(r)){e.decRefCount()<=0&&(U.delete(r),t=!0)}t&&(await Promise.all(e.container.getProviders().map(e=>e.delete())),e.isDeleted=!0)}function te(e,t,r){var a;let s=null!==(a=B[e])&&void 0!==a?a:e;r&&(s+="-".concat(r));const i=s.match(/\s|\//),o=t.match(/\s|\//);if(i||o){const e=['Unable to register library "'.concat(s,'" with version "').concat(t,'":')];return i&&e.push('library name "'.concat(s,'" contains illegal characters (whitespace or "/")')),i&&o&&e.push("and"),o&&e.push('version name "'.concat(t,'" contains illegal characters (whitespace or "/")')),void u.warn(e.join(" "))}H(new n.Component("".concat(s,"-version"),()=>({library:s,version:t}),"VERSION"))}const re="firebase-heartbeat-store";let ae=null;function ne(){return ae||(ae=o.openDB("firebase-heartbeat-database",1,{upgrade:(e,t)=>{if(0===t)try{e.createObjectStore(re)}catch(r){console.warn(r)}}}).catch(e=>{throw Y.create("idb-open",{originalErrorMessage:e.message})})),ae}async function se(e,t){try{const r=(await ne()).transaction(re,"readwrite"),a=r.objectStore(re);await a.put(t,ie(e)),await r.done}catch(r){if(r instanceof i.FirebaseError)u.warn(r.message);else{const e=Y.create("idb-set",{originalErrorMessage:null===r||void 0===r?void 0:r.message});u.warn(e.message)}}}function ie(e){return"".concat(e.name,"!").concat(e.options.appId)}class oe{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new ce(t),this._heartbeatsCachePromise=this._storage.read().then(e=>(this._heartbeatsCache=e,e))}async triggerHeartbeat(){try{var e;const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),a=le();var t;if(null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats))if(this._heartbeatsCache=await this._heartbeatsCachePromise,null==(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats))return;if(this._heartbeatsCache.lastSentHeartbeatDate===a||this._heartbeatsCache.heartbeats.some(e=>e.date===a))return;if(this._heartbeatsCache.heartbeats.push({date:a,agent:r}),this._heartbeatsCache.heartbeats.length>30){const e=function(e){if(0===e.length)return-1;let t=0,r=e[0].date;for(let a=1;a<e.length;a++)e[a].date<r&&(r=e[a].date,t=a);return t}(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(e,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){u.warn(r)}}async getHeartbeatsHeader(){try{var e;if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)||0===this._heartbeatsCache.heartbeats.length)return"";const t=le(),{heartbeatsToSend:r,unsentEntries:a}=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024;const r=[];let a=e.slice();for(const n of e){const e=r.find(e=>e.agent===n.agent);if(e){if(e.dates.push(n.date),de(r)>t){e.dates.pop();break}}else if(r.push({agent:n.agent,dates:[n.date]}),de(r)>t){r.pop();break}a=a.slice(1)}return{heartbeatsToSend:r,unsentEntries:a}}(this._heartbeatsCache.heartbeats),n=i.base64urlEncodeWithoutPadding(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,a.length>0?(this._heartbeatsCache.heartbeats=a,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),n}catch(t){return u.warn(t),""}}}function le(){return(new Date).toISOString().substring(0,10)}class ce{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!i.isIndexedDBAvailable()&&i.validateIndexedDBOpenable().then(()=>!0).catch(()=>!1)}async read(){if(await this._canUseIndexedDBPromise){const e=await async function(e){try{const t=(await ne()).transaction(re),r=await t.objectStore(re).get(ie(e));return await t.done,r}catch(t){if(t instanceof i.FirebaseError)u.warn(t.message);else{const e=Y.create("idb-get",{originalErrorMessage:null===t||void 0===t?void 0:t.message});u.warn(e.message)}}}(this.app);return null!==e&&void 0!==e&&e.heartbeats?e:{heartbeats:[]}}return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){var t;const r=await this.read();return se(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){if(await this._canUseIndexedDBPromise){var t;const r=await this.read();return se(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}}}function de(e){return i.base64urlEncodeWithoutPadding(JSON.stringify({version:2,heartbeats:e})).length}var ue;ue="node",H(new n.Component("platform-logger",e=>new l(e),"PRIVATE")),H(new n.Component("heartbeat",e=>new oe(e),"PRIVATE")),te(c,d,ue),te(c,d,"cjs2020"),te("fire-js",""),Object.defineProperty(t,"FirebaseError",{enumerable:!0,get:function(){return i.FirebaseError}}),t.SDK_VERSION="12.2.0",t._DEFAULT_ENTRY_NAME=O,t._addComponent=q,t._addOrOverwriteComponent=function(e,t){e.container.addOrOverwriteComponent(t)},t._apps=z,t._clearComponents=function(){V.clear()},t._components=V,t._getProvider=G,t._isFirebaseApp=W,t._isFirebaseServerApp=function(e){return null!==e&&void 0!==e&&void 0!==e.settings},t._isFirebaseServerAppSettings=K,t._registerComponent=H,t._removeServiceInstance=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:O;G(e,t).clearInstance(r)},t._serverApps=U,t.deleteApp=ee,t.getApp=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:O;const t=z.get(e);if(!t&&e===O&&i.getDefaultAppConfig())return $();if(!t)throw Y.create("no-app",{appName:e});return t},t.getApps=function(){return Array.from(z.values())},t.initializeApp=$,t.initializeServerApp=function(e){let t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(i.isBrowser()&&!i.isWebWorker())throw Y.create("invalid-server-app-environment");let s=r||{};if(e&&(W(e)?t=e.options:K(e)?s=e:t=e),void 0===s.automaticDataCollectionEnabled&&(s.automaticDataCollectionEnabled=!0),t||(t=i.getDefaultAppConfig()),!t)throw Y.create("no-options");const o=a(a({},s),t);if(void 0!==o.releaseOnDeref&&delete o.releaseOnDeref,void 0!==s.releaseOnDeref&&"undefined"===typeof FinalizationRegistry)throw Y.create("finalization-registry-not-supported",{});const l=""+(c=JSON.stringify(o),[...c].reduce((e,t)=>Math.imul(31,e)+t.charCodeAt(0)|0,0));var c;const d=U.get(l);if(d)return d.incRefCount(s.releaseOnDeref),d;const u=new n.ComponentContainer(l);for(const a of V.values())u.addComponent(a);const h=new Z(t,s,l,u);return U.set(l,h),h},t.onLog=function(e,t){if(null!==e&&"function"!==typeof e)throw Y.create("invalid-log-argument");s.setUserLogHandler(e,t)},t.registerVersion=te,t.setLogLevel=function(e){s.setLogLevel(e)}},5340:(e,t,r)=>{"use strict";e.exports=r(1761)},5425:function(e,t,r){e.exports=function(e){return function(){var t=e,r=t.lib,a=r.Base,n=r.WordArray,s=t.algo,i=s.SHA256,o=s.HMAC,l=s.PBKDF2=a.extend({cfg:a.extend({keySize:4,hasher:i,iterations:25e4}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var r=this.cfg,a=o.create(r.hasher,e),s=n.create(),i=n.create([1]),l=s.words,c=i.words,d=r.keySize,u=r.iterations;l.length<d;){var h=a.update(t).finalize(i);a.reset();for(var m=h.words,f=m.length,g=h,p=1;p<u;p++){g=a.finalize(g),a.reset();for(var x=g.words,y=0;y<f;y++)m[y]^=x[y]}s.concat(h),c[0]++}return s.sigBytes=4*d,s}});t.PBKDF2=function(e,t,r){return l.create(r).compute(e,t)}}(),e.PBKDF2}(r(4703),r(7427),r(9787))},6008:function(e,t,r){e.exports=function(e){return e.pad.Iso97971={pad:function(t,r){t.concat(e.lib.WordArray.create([2147483648],1)),e.pad.ZeroPadding.pad(t,r)},unpad:function(t){e.pad.ZeroPadding.unpad(t),t.sigBytes--}},e.pad.Iso97971}(r(4703),r(7755))},6290:function(e,t,r){e.exports=function(e){return function(){var t=e,r=t.lib,a=r.WordArray,n=r.Hasher,s=t.algo,i=a.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),o=a.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),l=a.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),c=a.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),d=a.create([0,1518500249,1859775393,2400959708,2840853838]),u=a.create([1352829926,1548603684,1836072691,2053994217,0]),h=s.RIPEMD160=n.extend({_doReset:function(){this._hash=a.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var r=0;r<16;r++){var a=t+r,n=e[a];e[a]=16711935&(n<<8|n>>>24)|4278255360&(n<<24|n>>>8)}var s,h,v,b,w,k,N,j,S,_,E,A=this._hash.words,C=d.words,I=u.words,T=i.words,D=o.words,P=l.words,F=c.words;for(k=s=A[0],N=h=A[1],j=v=A[2],S=b=A[3],_=w=A[4],r=0;r<80;r+=1)E=s+e[t+T[r]]|0,E+=r<16?m(h,v,b)+C[0]:r<32?f(h,v,b)+C[1]:r<48?g(h,v,b)+C[2]:r<64?p(h,v,b)+C[3]:x(h,v,b)+C[4],E=(E=y(E|=0,P[r]))+w|0,s=w,w=b,b=y(v,10),v=h,h=E,E=k+e[t+D[r]]|0,E+=r<16?x(N,j,S)+I[0]:r<32?p(N,j,S)+I[1]:r<48?g(N,j,S)+I[2]:r<64?f(N,j,S)+I[3]:m(N,j,S)+I[4],E=(E=y(E|=0,F[r]))+_|0,k=_,_=S,S=y(j,10),j=N,N=E;E=A[1]+v+S|0,A[1]=A[2]+b+_|0,A[2]=A[3]+w+k|0,A[3]=A[4]+s+N|0,A[4]=A[0]+h+j|0,A[0]=E},_doFinalize:function(){var e=this._data,t=e.words,r=8*this._nDataBytes,a=8*e.sigBytes;t[a>>>5]|=128<<24-a%32,t[14+(a+64>>>9<<4)]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8),e.sigBytes=4*(t.length+1),this._process();for(var n=this._hash,s=n.words,i=0;i<5;i++){var o=s[i];s[i]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8)}return n},clone:function(){var e=n.clone.call(this);return e._hash=this._hash.clone(),e}});function m(e,t,r){return e^t^r}function f(e,t,r){return e&t|~e&r}function g(e,t,r){return(e|~t)^r}function p(e,t,r){return e&r|t&~r}function x(e,t,r){return e^(t|~r)}function y(e,t){return e<<t|e>>>32-t}t.RIPEMD160=n._createHelper(h),t.HmacRIPEMD160=n._createHmacHelper(h)}(Math),e.RIPEMD160}(r(4703))},6722:function(e,t,r){e.exports=function(e){return function(){var t=e,r=t.lib.BlockCipher,a=t.algo;const n=16,s=[608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731],i=[[3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946],[1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055],[3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504],[976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462]];var o={pbox:[],sbox:[]};function l(e,t){let r=t>>24&255,a=t>>16&255,n=t>>8&255,s=255&t,i=e.sbox[0][r]+e.sbox[1][a];return i^=e.sbox[2][n],i+=e.sbox[3][s],i}function c(e,t,r){let a,s=t,i=r;for(let o=0;o<n;++o)s^=e.pbox[o],i=l(e,s)^i,a=s,s=i,i=a;return a=s,s=i,i=a,i^=e.pbox[n],s^=e.pbox[n+1],{left:s,right:i}}function d(e,t,r){let a,s=t,i=r;for(let o=n+1;o>1;--o)s^=e.pbox[o],i=l(e,s)^i,a=s,s=i,i=a;return a=s,s=i,i=a,i^=e.pbox[1],s^=e.pbox[0],{left:s,right:i}}function u(e,t,r){for(let n=0;n<4;n++){e.sbox[n]=[];for(let t=0;t<256;t++)e.sbox[n][t]=i[n][t]}let a=0;for(let i=0;i<n+2;i++)e.pbox[i]=s[i]^t[a],a++,a>=r&&(a=0);let o=0,l=0,d=0;for(let s=0;s<n+2;s+=2)d=c(e,o,l),o=d.left,l=d.right,e.pbox[s]=o,e.pbox[s+1]=l;for(let n=0;n<4;n++)for(let t=0;t<256;t+=2)d=c(e,o,l),o=d.left,l=d.right,e.sbox[n][t]=o,e.sbox[n][t+1]=l;return!0}var h=a.Blowfish=r.extend({_doReset:function(){if(this._keyPriorReset!==this._key){var e=this._keyPriorReset=this._key,t=e.words,r=e.sigBytes/4;u(o,t,r)}},encryptBlock:function(e,t){var r=c(o,e[t],e[t+1]);e[t]=r.left,e[t+1]=r.right},decryptBlock:function(e,t){var r=d(o,e[t],e[t+1]);e[t]=r.left,e[t+1]=r.right},blockSize:2,keySize:4,ivSize:2});t.Blowfish=r._createHelper(h)}(),e.Blowfish}(r(4703),r(3988),r(7766),r(7020),r(7755))},6810:function(e,t,r){e.exports=function(e){return function(){if("function"==typeof ArrayBuffer){var t=e.lib.WordArray,r=t.init,a=t.init=function(e){if(e instanceof ArrayBuffer&&(e=new Uint8Array(e)),(e instanceof Int8Array||"undefined"!==typeof Uint8ClampedArray&&e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array||e instanceof Float64Array)&&(e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength)),e instanceof Uint8Array){for(var t=e.byteLength,a=[],n=0;n<t;n++)a[n>>>2]|=e[n]<<24-n%4*8;r.call(this,a,t)}else r.apply(this,arguments)};a.prototype=t}}(),e.lib.WordArray}(r(4703))},6863:(e,t,r)=>{"use strict";r.d(t,{h1:()=>o,uA:()=>n});var a=r(498);class n{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const s="[DEFAULT]";class i{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const e=new a.cY;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:t});r&&e.resolve(r)}catch(r){}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const r=this.normalizeInstanceIdentifier(null===e||void 0===e?void 0:e.identifier),a=null!==(t=null===e||void 0===e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(r)&&!this.shouldAutoInitialize()){if(a)return null;throw Error("Service ".concat(this.name," is not available"))}try{return this.getOrInitializeService({instanceIdentifier:r})}catch(n){if(a)return null;throw n}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error("Mismatching Component ".concat(e.name," for Provider ").concat(this.name,"."));if(this.component)throw Error("Component for ".concat(this.name," has already been provided"));if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:s})}catch(t){}for(const[e,r]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(e);try{const e=this.getOrInitializeService({instanceIdentifier:a});r.resolve(e)}catch(t){}}}}clearInstance(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s;this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(e=>"INTERNAL"in e).map(e=>e.INTERNAL.delete()),...e.filter(e=>"_delete"in e).map(e=>e._delete())])}isComponentSet(){return null!=this.component}isInitialized(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s;return this.instances.has(e)}getOptions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s;return this.instancesOptions.get(e)||{}}initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error("".concat(this.name,"(").concat(r,") has already been initialized"));if(!this.isComponentSet())throw Error("Component ".concat(this.name," has not been registered yet"));const a=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[n,s]of this.instancesDeferred.entries()){r===this.normalizeInstanceIdentifier(n)&&s.resolve(a)}return a}onInit(e,t){var r;const a=this.normalizeInstanceIdentifier(t),n=null!==(r=this.onInitCallbacks.get(a))&&void 0!==r?r:new Set;n.add(e),this.onInitCallbacks.set(a,n);const s=this.instances.get(a);return s&&e(s,a),()=>{n.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const n of r)try{n(e,t)}catch(a){}}getOrInitializeService(e){let{instanceIdentifier:t,options:r={}}=e,a=this.instances.get(t);if(!a&&this.component&&(a=this.component.instanceFactory(this.container,{instanceIdentifier:(n=t,n===s?void 0:n),options:r}),this.instances.set(t,a),this.instancesOptions.set(t,r),this.invokeOnInitCallbacks(a,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,a)}catch(i){}var n;return a||null}normalizeInstanceIdentifier(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s;return this.component?this.component.multipleInstances?e:s:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class o{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error("Component ".concat(e.name," has already been registered with ").concat(this.name));t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new i(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}},6883:function(e,t,r){e.exports=function(e){return function(){var t=e,r=t.x64,a=r.Word,n=r.WordArray,s=t.algo,i=s.SHA512,o=s.SHA384=i.extend({_doReset:function(){this._hash=new n.init([new a.init(3418070365,3238371032),new a.init(1654270250,914150663),new a.init(2438529370,812702999),new a.init(355462360,4144912697),new a.init(1731405415,4290775857),new a.init(2394180231,1750603025),new a.init(3675008525,1694076839),new a.init(1203062813,3204075428)])},_doFinalize:function(){var e=i._doFinalize.call(this);return e.sigBytes-=16,e}});t.SHA384=i._createHelper(o),t.HmacSHA384=i._createHmacHelper(o)}(),e.SHA384}(r(4703),r(4654),r(4290))},7020:function(e,t,r){e.exports=function(e){return function(){var t=e,r=t.lib,a=r.Base,n=r.WordArray,s=t.algo,i=s.MD5,o=s.EvpKDF=a.extend({cfg:a.extend({keySize:4,hasher:i,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var r,a=this.cfg,s=a.hasher.create(),i=n.create(),o=i.words,l=a.keySize,c=a.iterations;o.length<l;){r&&s.update(r),r=s.update(e).finalize(t),s.reset();for(var d=1;d<c;d++)r=s.finalize(r),s.reset();i.concat(r)}return i.sigBytes=4*l,i}});t.EvpKDF=function(e,t,r){return o.create(r).compute(e,t)}}(),e.EvpKDF}(r(4703),r(2689),r(9787))},7055:function(e,t,r){e.exports=function(e){return function(t){var r=e,a=r.lib,n=a.WordArray,s=a.Hasher,i=r.x64.Word,o=r.algo,l=[],c=[],d=[];!function(){for(var e=1,t=0,r=0;r<24;r++){l[e+5*t]=(r+1)*(r+2)/2%64;var a=(2*e+3*t)%5;e=t%5,t=a}for(e=0;e<5;e++)for(t=0;t<5;t++)c[e+5*t]=t+(2*e+3*t)%5*5;for(var n=1,s=0;s<24;s++){for(var o=0,u=0,h=0;h<7;h++){if(1&n){var m=(1<<h)-1;m<32?u^=1<<m:o^=1<<m-32}128&n?n=n<<1^113:n<<=1}d[s]=i.create(o,u)}}();var u=[];!function(){for(var e=0;e<25;e++)u[e]=i.create()}();var h=o.SHA3=s.extend({cfg:s.cfg.extend({outputLength:512}),_doReset:function(){for(var e=this._state=[],t=0;t<25;t++)e[t]=new i.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(e,t){for(var r=this._state,a=this.blockSize/2,n=0;n<a;n++){var s=e[t+2*n],i=e[t+2*n+1];s=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),i=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8),(A=r[n]).high^=i,A.low^=s}for(var o=0;o<24;o++){for(var h=0;h<5;h++){for(var m=0,f=0,g=0;g<5;g++)m^=(A=r[h+5*g]).high,f^=A.low;var p=u[h];p.high=m,p.low=f}for(h=0;h<5;h++){var x=u[(h+4)%5],y=u[(h+1)%5],v=y.high,b=y.low;for(m=x.high^(v<<1|b>>>31),f=x.low^(b<<1|v>>>31),g=0;g<5;g++)(A=r[h+5*g]).high^=m,A.low^=f}for(var w=1;w<25;w++){var k=(A=r[w]).high,N=A.low,j=l[w];j<32?(m=k<<j|N>>>32-j,f=N<<j|k>>>32-j):(m=N<<j-32|k>>>64-j,f=k<<j-32|N>>>64-j);var S=u[c[w]];S.high=m,S.low=f}var _=u[0],E=r[0];for(_.high=E.high,_.low=E.low,h=0;h<5;h++)for(g=0;g<5;g++){var A=r[w=h+5*g],C=u[w],I=u[(h+1)%5+5*g],T=u[(h+2)%5+5*g];A.high=C.high^~I.high&T.high,A.low=C.low^~I.low&T.low}A=r[0];var D=d[o];A.high^=D.high,A.low^=D.low}},_doFinalize:function(){var e=this._data,r=e.words,a=(this._nDataBytes,8*e.sigBytes),s=32*this.blockSize;r[a>>>5]|=1<<24-a%32,r[(t.ceil((a+1)/s)*s>>>5)-1]|=128,e.sigBytes=4*r.length,this._process();for(var i=this._state,o=this.cfg.outputLength/8,l=o/8,c=[],d=0;d<l;d++){var u=i[d],h=u.high,m=u.low;h=16711935&(h<<8|h>>>24)|4278255360&(h<<24|h>>>8),m=16711935&(m<<8|m>>>24)|4278255360&(m<<24|m>>>8),c.push(m),c.push(h)}return new n.init(c,o)},clone:function(){for(var e=s.clone.call(this),t=e._state=this._state.slice(0),r=0;r<25;r++)t[r]=t[r].clone();return e}});r.SHA3=s._createHelper(h),r.HmacSHA3=s._createHmacHelper(h)}(Math),e.SHA3}(r(4703),r(4654))},7118:function(e,t,r){e.exports=function(e){return e.mode.CTRGladman=function(){var t=e.lib.BlockCipherMode.extend();function r(e){if(255===(e>>24&255)){var t=e>>16&255,r=e>>8&255,a=255&e;255===t?(t=0,255===r?(r=0,255===a?a=0:++a):++r):++t,e=0,e+=t<<16,e+=r<<8,e+=a}else e+=1<<24;return e}function a(e){return 0===(e[0]=r(e[0]))&&(e[1]=r(e[1])),e}var n=t.Encryptor=t.extend({processBlock:function(e,t){var r=this._cipher,n=r.blockSize,s=this._iv,i=this._counter;s&&(i=this._counter=s.slice(0),this._iv=void 0),a(i);var o=i.slice(0);r.encryptBlock(o,0);for(var l=0;l<n;l++)e[t+l]^=o[l]}});return t.Decryptor=n,t}(),e.mode.CTRGladman}(r(4703),r(7755))},7119:(e,t,r)=>{"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=r(8345)},7279:function(e,t,r){e.exports=function(e){return e.pad.AnsiX923={pad:function(e,t){var r=e.sigBytes,a=4*t,n=a-r%a,s=r+n-1;e.clamp(),e.words[s>>>2]|=n<<24-s%4*8,e.sigBytes+=n},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},e.pad.Ansix923}(r(4703),r(7755))},7353:function(e,t,r){e.exports=function(e){return function(){var t=e,r=t.lib.WordArray,a=t.enc;function n(e){return e<<8&4278255360|e>>>8&16711935}a.Utf16=a.Utf16BE={stringify:function(e){for(var t=e.words,r=e.sigBytes,a=[],n=0;n<r;n+=2){var s=t[n>>>2]>>>16-n%4*8&65535;a.push(String.fromCharCode(s))}return a.join("")},parse:function(e){for(var t=e.length,a=[],n=0;n<t;n++)a[n>>>1]|=e.charCodeAt(n)<<16-n%2*16;return r.create(a,2*t)}},a.Utf16LE={stringify:function(e){for(var t=e.words,r=e.sigBytes,a=[],s=0;s<r;s+=2){var i=n(t[s>>>2]>>>16-s%4*8&65535);a.push(String.fromCharCode(i))}return a.join("")},parse:function(e){for(var t=e.length,a=[],s=0;s<t;s++)a[s>>>1]|=n(e.charCodeAt(s)<<16-s%2*16);return r.create(a,2*t)}}}(),e.enc.Utf16}(r(4703))},7427:function(e,t,r){e.exports=function(e){return function(t){var r=e,a=r.lib,n=a.WordArray,s=a.Hasher,i=r.algo,o=[],l=[];!function(){function e(e){for(var r=t.sqrt(e),a=2;a<=r;a++)if(!(e%a))return!1;return!0}function r(e){return 4294967296*(e-(0|e))|0}for(var a=2,n=0;n<64;)e(a)&&(n<8&&(o[n]=r(t.pow(a,.5))),l[n]=r(t.pow(a,1/3)),n++),a++}();var c=[],d=i.SHA256=s.extend({_doReset:function(){this._hash=new n.init(o.slice(0))},_doProcessBlock:function(e,t){for(var r=this._hash.words,a=r[0],n=r[1],s=r[2],i=r[3],o=r[4],d=r[5],u=r[6],h=r[7],m=0;m<64;m++){if(m<16)c[m]=0|e[t+m];else{var f=c[m-15],g=(f<<25|f>>>7)^(f<<14|f>>>18)^f>>>3,p=c[m-2],x=(p<<15|p>>>17)^(p<<13|p>>>19)^p>>>10;c[m]=g+c[m-7]+x+c[m-16]}var y=a&n^a&s^n&s,v=(a<<30|a>>>2)^(a<<19|a>>>13)^(a<<10|a>>>22),b=h+((o<<26|o>>>6)^(o<<21|o>>>11)^(o<<7|o>>>25))+(o&d^~o&u)+l[m]+c[m];h=u,u=d,d=o,o=i+b|0,i=s,s=n,n=a,a=b+(v+y)|0}r[0]=r[0]+a|0,r[1]=r[1]+n|0,r[2]=r[2]+s|0,r[3]=r[3]+i|0,r[4]=r[4]+o|0,r[5]=r[5]+d|0,r[6]=r[6]+u|0,r[7]=r[7]+h|0},_doFinalize:function(){var e=this._data,r=e.words,a=8*this._nDataBytes,n=8*e.sigBytes;return r[n>>>5]|=128<<24-n%32,r[14+(n+64>>>9<<4)]=t.floor(a/4294967296),r[15+(n+64>>>9<<4)]=a,e.sigBytes=4*r.length,this._process(),this._hash},clone:function(){var e=s.clone.call(this);return e._hash=this._hash.clone(),e}});r.SHA256=s._createHelper(d),r.HmacSHA256=s._createHmacHelper(d)}(Math),e.SHA256}(r(4703))},7511:(e,t,r)=>{"use strict";var a=r(2897).default;Object.defineProperty(t,"__esModule",{value:!0});var n=r(5097),s=r(2045),i=r(1042),o=r(1494),l=r(1942),c=r(4618);const d="@firebase/firestore",u="4.9.1";class h{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}h.UNAUTHENTICATED=new h(null),h.GOOGLE_CREDENTIALS=new h("google-credentials-uid"),h.FIRST_PARTY=new h("first-party-uid"),h.MOCK_USER=new h("mock-user");let m="12.2.0";const f=new i.Logger("@firebase/firestore");function g(){return f.logLevel}function p(e){if(f.logLevel<=i.LogLevel.DEBUG){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];const n=r.map(v);f.debug("Firestore (".concat(m,"): ").concat(e),...n)}}function x(e){if(f.logLevel<=i.LogLevel.ERROR){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];const n=r.map(v);f.error("Firestore (".concat(m,"): ").concat(e),...n)}}function y(e){if(f.logLevel<=i.LogLevel.WARN){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];const n=r.map(v);f.warn("Firestore (".concat(m,"): ").concat(e),...n)}}function v(e){if("string"==typeof e)return e;try{return function(e){return JSON.stringify(e)}(e)}catch(t){return e}}function b(e,t,r){let a="Unexpected state";"string"==typeof t?a=t:r=t,w(e,a,r)}function w(e,t,r){let a="FIRESTORE (".concat(m,") INTERNAL ASSERTION FAILED: ").concat(t," (ID: ").concat(e.toString(16),")");if(void 0!==r)try{a+=" CONTEXT: "+JSON.stringify(r)}catch(e){a+=" CONTEXT: "+r}throw x(a),new Error(a)}function k(e,t,r,a){let n="Unexpected state";"string"==typeof r?n=r:a=r,e||w(t,n,a)}function N(e,t){return e}const j={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class S extends o.FirebaseError{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>"".concat(this.name,": [code=").concat(this.code,"]: ").concat(this.message)}}class _{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}class E{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization","Bearer ".concat(e))}}class A{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(h.UNAUTHENTICATED))}shutdown(){}}class C{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class I{constructor(e){this.t=e,this.currentUser=h.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){k(void 0===this.o,42304);let r=this.i;const a=e=>this.i!==r?(r=this.i,t(e)):Promise.resolve();let n=new _;this.o=()=>{this.i++,this.currentUser=this.u(),n.resolve(),n=new _,e.enqueueRetryable(()=>a(this.currentUser))};const s=()=>{const t=n;e.enqueueRetryable(async()=>{await t.promise,await a(this.currentUser)})},i=e=>{p("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.o&&(this.auth.addAuthTokenListener(this.o),s())};this.t.onInit(e=>i(e)),setTimeout(()=>{if(!this.auth){const e=this.t.getImmediate({optional:!0});e?i(e):(p("FirebaseAuthCredentialsProvider","Auth not yet detected"),n.resolve(),n=new _)}},0),s()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(t=>this.i!==e?(p("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?(k("string"==typeof t.accessToken,31837,{l:t}),new E(t.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return k(null===e||"string"==typeof e,2055,{h:e}),new h(e)}}class T{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=h.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class D{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new T(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(h.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class P{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class F{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,n._isFirebaseServerApp(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){k(void 0===this.o,3512);const r=e=>{null!=e.error&&p("FirebaseAppCheckTokenProvider","Error getting App Check token; using placeholder token instead. Error: ".concat(e.error.message));const r=e.token!==this.m;return this.m=e.token,p("FirebaseAppCheckTokenProvider","Received ".concat(r?"new":"existing"," token.")),r?t(e.token):Promise.resolve()};this.o=t=>{e.enqueueRetryable(()=>r(t))};const a=e=>{p("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(e=>a(e)),setTimeout(()=>{if(!this.appCheck){const e=this.V.getImmediate({optional:!0});e?a(e):p("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new P(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(e=>e?(k("string"==typeof e.token,44558,{tokenResult:e}),this.m=e.token,new P(e.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function L(e){const t="undefined"!=typeof self&&(self.crypto||self.msCrypto),r=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(r);else for(let a=0;a<e;a++)r[a]=Math.floor(256*Math.random());return r}class M{static newId(){const e=62*Math.floor(256/62);let t="";for(;t.length<20;){const r=L(40);for(let a=0;a<r.length;++a)t.length<20&&r[a]<e&&(t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(r[a]%62))}return t}}function R(e,t){return e<t?-1:e>t?1:0}function O(e,t){const r=Math.min(e.length,t.length);for(let a=0;a<r;a++){const r=e.charAt(a),n=t.charAt(a);if(r!==n)return U(r)===U(n)?R(r,n):U(r)?1:-1}return R(e.length,t.length)}const B=55296,z=57343;function U(e){const t=e.charCodeAt(0);return t>=B&&t<=z}function V(e,t,r){return e.length===t.length&&e.every((e,a)=>r(e,t[a]))}function q(e){return e+"\0"}const H="__name__";class G{constructor(e,t,r){void 0===t?t=0:t>e.length&&b(637,{offset:t,range:e.length}),void 0===r?r=e.length-t:r>e.length-t&&b(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return 0===G.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof G?e.forEach(e=>{t.push(e)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let a=0;a<r;a++){const r=G.compareSegments(e.get(a),t.get(a));if(0!==r)return r}return R(e.length,t.length)}static compareSegments(e,t){const r=G.isNumericId(e),a=G.isNumericId(t);return r&&!a?-1:!r&&a?1:r&&a?G.extractNumericId(e).compare(G.extractNumericId(t)):O(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return l.Integer.fromString(e.substring(4,e.length-2))}}class W extends G{construct(e,t,r){return new W(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(){const e=[];for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];for(const n of r){if(n.indexOf("//")>=0)throw new S(j.INVALID_ARGUMENT,"Invalid segment (".concat(n,"). Paths must not contain // in them."));e.push(...n.split("/").filter(e=>e.length>0))}return new W(e)}static emptyPath(){return new W([])}}const K=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Q extends G{construct(e,t,r){return new Q(e,t,r)}static isValidIdentifier(e){return K.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Q.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&this.get(0)===H}static keyField(){return new Q([H])}static fromServerFormat(e){const t=[];let r="",a=0;const n=()=>{if(0===r.length)throw new S(j.INVALID_ARGUMENT,"Invalid field path (".concat(e,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"));t.push(r),r=""};let s=!1;for(;a<e.length;){const t=e[a];if("\\"===t){if(a+1===e.length)throw new S(j.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const t=e[a+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new S(j.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=t,a+=2}else"`"===t?(s=!s,a++):"."!==t||s?(r+=t,a++):(n(),a++)}if(n(),s)throw new S(j.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Q(t)}static emptyPath(){return new Q([])}}class Y{constructor(e){this.path=e}static fromPath(e){return new Y(W.fromString(e))}static fromName(e){return new Y(W.fromString(e).popFirst(5))}static empty(){return new Y(W.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===W.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return W.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Y(new W(e.slice()))}}function X(e,t,r){if(!r)throw new S(j.INVALID_ARGUMENT,"Function ".concat(e,"() cannot be called with an empty ").concat(t,"."))}function J(e,t,r,a){if(!0===t&&!0===a)throw new S(j.INVALID_ARGUMENT,"".concat(e," and ").concat(r," cannot be used together."))}function Z(e){if(!Y.isDocumentKey(e))throw new S(j.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but ".concat(e," has ").concat(e.length,"."))}function $(e){if(Y.isDocumentKey(e))throw new S(j.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but ".concat(e," has ").concat(e.length,"."))}function ee(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}function te(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e="".concat(e.substring(0,20),"...")),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{const t=function(e){return e.constructor?e.constructor.name:null}(e);return t?"a custom ".concat(t," object"):"an object"}}return"function"==typeof e?"a function":b(12329,{type:typeof e})}function re(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new S(j.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=te(e);throw new S(j.INVALID_ARGUMENT,"Expected type '".concat(t.name,"', but it was: ").concat(r))}}return e}function ae(e,t){if(t<=0)throw new S(j.INVALID_ARGUMENT,"Function ".concat(e,"() requires a positive number, but it was: ").concat(t,"."))}function ne(e,t){const r={typeString:e};return t&&(r.value=t),r}function se(e,t){if(!ee(e))throw new S(j.INVALID_ARGUMENT,"JSON must be an object");let r;for(const a in t)if(t[a]){const n=t[a].typeString,s="value"in t[a]?{value:t[a].value}:void 0;if(!(a in e)){r="JSON missing required field: '".concat(a,"'");break}const i=e[a];if(n&&typeof i!==n){r="JSON field '".concat(a,"' must be a ").concat(n,".");break}if(void 0!==s&&i!==s.value){r="Expected '".concat(a,"' field to equal '").concat(s.value,"'");break}}if(r)throw new S(j.INVALID_ARGUMENT,r);return!0}const ie=-62135596800,oe=1e6;class le{static now(){return le.fromMillis(Date.now())}static fromDate(e){return le.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*oe);return new le(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new S(j.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new S(j.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<ie)throw new S(j.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new S(j.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/oe}_compareTo(e){return this.seconds===e.seconds?R(this.nanoseconds,e.nanoseconds):R(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:le._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(se(e,le._jsonSchema))return new le(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-ie;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}le._jsonSchemaVersion="firestore/timestamp/1.0",le._jsonSchema={type:ne("string",le._jsonSchemaVersion),seconds:ne("number"),nanoseconds:ne("number")};class ce{static fromTimestamp(e){return new ce(e)}static min(){return new ce(new le(0,0))}static max(){return new ce(new le(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const de=-1;class ue{constructor(e,t,r,a){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=a}}function he(e){return e.fields.find(e=>2===e.kind)}function me(e){return e.fields.filter(e=>2!==e.kind)}function fe(e,t){let r=R(e.collectionGroup,t.collectionGroup);if(0!==r)return r;for(let a=0;a<Math.min(e.fields.length,t.fields.length);++a)if(r=pe(e.fields[a],t.fields[a]),0!==r)return r;return R(e.fields.length,t.fields.length)}ue.UNKNOWN_ID=-1;class ge{constructor(e,t){this.fieldPath=e,this.kind=t}}function pe(e,t){const r=Q.comparator(e.fieldPath,t.fieldPath);return 0!==r?r:R(e.kind,t.kind)}class xe{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new xe(0,be.min())}}function ye(e,t){const r=e.toTimestamp().seconds,a=e.toTimestamp().nanoseconds+1,n=ce.fromTimestamp(1e9===a?new le(r+1,0):new le(r,a));return new be(n,Y.empty(),t)}function ve(e){return new be(e.readTime,e.key,de)}class be{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new be(ce.min(),Y.empty(),de)}static max(){return new be(ce.max(),Y.empty(),de)}}function we(e,t){let r=e.readTime.compareTo(t.readTime);return 0!==r?r:(r=Y.comparator(e.documentKey,t.documentKey),0!==r?r:R(e.largestBatchId,t.largestBatchId))}const ke="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Ne{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}async function je(e){if(e.code!==j.FAILED_PRECONDITION||e.message!==ke)throw e;p("LocalStore","Unexpectedly lost primary lease")}class Se{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)},e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&b(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new Se((r,a)=>{this.nextCallback=t=>{this.wrapSuccess(e,t).next(r,a)},this.catchCallback=e=>{this.wrapFailure(t,e).next(r,a)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof Se?t:Se.resolve(t)}catch(e){return Se.reject(e)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):Se.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):Se.reject(t)}static resolve(e){return new Se((t,r)=>{t(e)})}static reject(e){return new Se((t,r)=>{r(e)})}static waitFor(e){return new Se((t,r)=>{let a=0,n=0,s=!1;e.forEach(e=>{++a,e.next(()=>{++n,s&&n===a&&t()},e=>r(e))}),s=!0,n===a&&t()})}static or(e){let t=Se.resolve(!1);for(const r of e)t=t.next(e=>e?Se.resolve(e):r());return t}static forEach(e,t){const r=[];return e.forEach((e,a)=>{r.push(t.call(this,e,a))}),this.waitFor(r)}static mapArray(e,t){return new Se((r,a)=>{const n=e.length,s=new Array(n);let i=0;for(let o=0;o<n;o++){const l=o;t(e[l]).next(e=>{s[l]=e,++i,i===n&&r(s)},e=>a(e))}})}static doWhile(e,t){return new Se((r,a)=>{const n=()=>{!0===e()?t().next(()=>{n()},a):r()};n()})}}const _e="SimpleDb";class Ee{static open(e,t,r,a){try{return new Ee(t,e.transaction(a,r))}catch(e){throw new Te(t,e)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new _,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new Te(e,t.error)):this.S.resolve()},this.transaction.onerror=t=>{const r=Me(t.target.error);this.S.reject(new Te(e,r))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(p(_e,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){const e=this.transaction;this.aborted||"function"!=typeof e.commit||e.commit()}store(e){const t=this.transaction.objectStore(e);return new Pe(t)}}class Ae{static delete(e){return p(_e,"Removing database:",e),Fe(o.getGlobal().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!o.isIndexedDBAvailable())return!1;if(Ae.F())return!0;const e=o.getUA(),t=Ae.M(e),r=0<t&&t<10,a=Ce(e),n=0<a&&a<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||n)}static F(){var e;return"undefined"!=typeof process&&"YES"===(null===(e=process.__PRIVATE_env)||void 0===e?void 0:e.__PRIVATE_USE_MOCK_PERSISTENCE)}static O(e,t){return e.store(t)}static M(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}constructor(e,t,r){this.name=e,this.version=t,this.N=r,this.B=null,12.2===Ae.M(o.getUA())&&x("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(p(_e,"Opening database:",this.name),this.db=await new Promise((t,r)=>{const a=indexedDB.open(this.name,this.version);a.onsuccess=e=>{const r=e.target.result;t(r)},a.onblocked=()=>{r(new Te(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},a.onerror=t=>{const a=t.target.error;"VersionError"===a.name?r(new S(j.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):"InvalidStateError"===a.name?r(new S(j.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+a)):r(new Te(e,a))},a.onupgradeneeded=e=>{p(_e,'Database "'+this.name+'" requires upgrade from version:',e.oldVersion);const t=e.target.result;this.N.k(t,a.transaction,e.oldVersion,this.version).next(()=>{p(_e,"Database upgrade to version "+this.version+" complete")})}})),this.q&&(this.db.onversionchange=e=>this.q(e)),this.db}$(e){this.q=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,r,a){const n="readonly"===t;let s=0;for(;;){++s;try{this.db=await this.L(e);const t=Ee.open(this.db,e,n?"readonly":"readwrite",r),s=a(t).next(e=>(t.C(),e)).catch(e=>(t.abort(e),Se.reject(e))).toPromise();return s.catch(()=>{}),await t.D,s}catch(e){const t=e,r="FirebaseError"!==t.name&&s<3;if(p(_e,"Transaction failed with error:",t.message,"Retrying:",r),this.close(),!r)return Promise.reject(t)}}}close(){this.db&&this.db.close(),this.db=void 0}}function Ce(e){const t=e.match(/Android ([\d.]+)/i),r=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(r)}class Ie{constructor(e){this.U=e,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(e){this.U=e}done(){this.K=!0}j(e){this.W=e}delete(){return Fe(this.U.delete())}}class Te extends S{constructor(e,t){super(j.UNAVAILABLE,"IndexedDB transaction '".concat(e,"' failed: ").concat(t)),this.name="IndexedDbTransactionError"}}function De(e){return"IndexedDbTransactionError"===e.name}class Pe{constructor(e){this.store=e}put(e,t){let r;return void 0!==t?(p(_e,"PUT",this.store.name,e,t),r=this.store.put(t,e)):(p(_e,"PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Fe(r)}add(e){return p(_e,"ADD",this.store.name,e,e),Fe(this.store.add(e))}get(e){return Fe(this.store.get(e)).next(t=>(void 0===t&&(t=null),p(_e,"GET",this.store.name,e,t),t))}delete(e){return p(_e,"DELETE",this.store.name,e),Fe(this.store.delete(e))}count(){return p(_e,"COUNT",this.store.name),Fe(this.store.count())}J(e,t){const r=this.options(e,t),a=r.index?this.store.index(r.index):this.store;if("function"==typeof a.getAll){const e=a.getAll(r.range);return new Se((t,r)=>{e.onerror=e=>{r(e.target.error)},e.onsuccess=e=>{t(e.target.result)}})}{const e=this.cursor(r),t=[];return this.H(e,(e,r)=>{t.push(r)}).next(()=>t)}}Y(e,t){const r=this.store.getAll(e,null===t?void 0:t);return new Se((e,t)=>{r.onerror=e=>{t(e.target.error)},r.onsuccess=t=>{e(t.target.result)}})}Z(e,t){p(_e,"DELETE ALL",this.store.name);const r=this.options(e,t);r.X=!1;const a=this.cursor(r);return this.H(a,(e,t,r)=>r.delete())}ee(e,t){let r;t?r=e:(r={},t=e);const a=this.cursor(r);return this.H(a,t)}te(e){const t=this.cursor({});return new Se((r,a)=>{t.onerror=e=>{const t=Me(e.target.error);a(t)},t.onsuccess=t=>{const a=t.target.result;a?e(a.primaryKey,a.value).next(e=>{e?a.continue():r()}):r()}})}H(e,t){const r=[];return new Se((a,n)=>{e.onerror=e=>{n(e.target.error)},e.onsuccess=e=>{const n=e.target.result;if(!n)return void a();const s=new Ie(n),i=t(n.primaryKey,n.value,s);if(i instanceof Se){const e=i.catch(e=>(s.done(),Se.reject(e)));r.push(e)}s.isDone?a():null===s.G?n.continue():n.continue(s.G)}}).next(()=>Se.waitFor(r))}options(e,t){let r;return void 0!==e&&("string"==typeof e?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const r=this.store.index(e.index);return e.X?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Fe(e){return new Se((t,r)=>{e.onsuccess=e=>{const r=e.target.result;t(r)},e.onerror=e=>{const t=Me(e.target.error);r(t)}})}let Le=!1;function Me(e){const t=Ae.M(o.getUA());if(t>=12.2&&t<13){const t="An internal error was encountered in the Indexed Database server";if(e.message.indexOf(t)>=0){const e=new S("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '".concat(t,"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround."));return Le||(Le=!0,setTimeout(()=>{throw e},0)),e}}return e}const Re="IndexBackfiller";class Oe{constructor(e,t){this.asyncQueue=e,this.ne=t,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return null!==this.task}re(e){p(Re,"Scheduled in ".concat(e,"ms")),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{const e=await this.ne.ie();p(Re,"Documents written: ".concat(e))}catch(e){De(e)?p(Re,"Ignoring IndexedDB error during index backfill: ",e):await je(e)}await this.re(6e4)})}}class Be{constructor(e,t){this.localStore=e,this.persistence=t}async ie(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50;return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.se(t,e))}se(e,t){const r=new Set;let a=t,n=!0;return Se.doWhile(()=>!0===n&&a>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(t=>{if(null!==t&&!r.has(t))return p(Re,"Processing collection: ".concat(t)),this.oe(e,t,a).next(e=>{a-=e,r.add(t)});n=!1})).next(()=>t-a)}oe(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(a=>this.localStore.localDocuments.getNextDocuments(e,t,a,r).next(r=>{const n=r.changes;return this.localStore.indexManager.updateIndexEntries(e,n).next(()=>this._e(a,r)).next(r=>(p(Re,"Updating offset: ".concat(r)),this.localStore.indexManager.updateCollectionGroup(e,t,r))).next(()=>n.size)}))}_e(e,t){let r=e;return t.changes.forEach((e,t)=>{const a=ve(t);we(a,r)>0&&(r=a)}),new be(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}}class ze{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this.ae(e),this.ue=e=>t.writeSequenceNumber(e))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}ze.ce=-1;const Ue=-1;function Ve(e){return null==e}function qe(e){return 0===e&&1/e==-1/0}function He(e){return"number"==typeof e&&Number.isInteger(e)&&!qe(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}const Ge="\x01";function We(e){let t="";for(let r=0;r<e.length;r++)t.length>0&&(t=Qe(t)),t=Ke(e.get(r),t);return Qe(t)}function Ke(e,t){let r=t;const a=e.length;for(let n=0;n<a;n++){const t=e.charAt(n);switch(t){case"\0":r+="\x01\x10";break;case Ge:r+="\x01\x11";break;default:r+=t}}return r}function Qe(e){return e+Ge+"\x01"}function Ye(e){const t=e.length;if(k(t>=2,64408,{path:e}),2===t)return k(e.charAt(0)===Ge&&"\x01"===e.charAt(1),56145,{path:e}),W.emptyPath();const r=t-2,a=[];let n="";for(let s=0;s<t;){const t=e.indexOf(Ge,s);switch((t<0||t>r)&&b(50515,{path:e}),e.charAt(t+1)){case"\x01":const r=e.substring(s,t);let i;0===n.length?i=r:(n+=r,i=n,n=""),a.push(i);break;case"\x10":n+=e.substring(s,t),n+="\0";break;case"\x11":n+=e.substring(s,t+1);break;default:b(61167,{path:e})}s=t+2}return new W(a)}const Xe="remoteDocuments",Je="owner",Ze="owner",$e="mutationQueues",et="mutations",tt="batchId",rt="userMutationsIndex",at=["userId","batchId"];function nt(e,t){return[e,We(t)]}function st(e,t,r){return[e,We(t),r]}const it={},ot="documentMutations",lt="remoteDocumentsV14",ct=["prefixPath","collectionGroup","readTime","documentId"],dt="documentKeyIndex",ut=["prefixPath","collectionGroup","documentId"],ht="collectionGroupIndex",mt=["collectionGroup","readTime","prefixPath","documentId"],ft="remoteDocumentGlobal",gt="remoteDocumentGlobalKey",pt="targets",xt="queryTargetsIndex",yt=["canonicalId","targetId"],vt="targetDocuments",bt=["targetId","path"],wt="documentTargetsIndex",kt=["path","targetId"],Nt="targetGlobalKey",jt="targetGlobal",St="collectionParents",_t=["collectionId","parent"],Et="clientMetadata",At="bundles",Ct="namedQueries",It="indexConfiguration",Tt="collectionGroupIndex",Dt="indexState",Pt=["indexId","uid"],Ft="sequenceNumberIndex",Lt=["uid","sequenceNumber"],Mt="indexEntries",Rt=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],Ot="documentKeyIndex",Bt=["indexId","uid","orderedDocumentKey"],zt="documentOverlays",Ut=["userId","collectionPath","documentId"],Vt="collectionPathOverlayIndex",qt=["userId","collectionPath","largestBatchId"],Ht="collectionGroupOverlayIndex",Gt=["userId","collectionGroup","largestBatchId"],Wt="globals",Kt=[$e,et,ot,Xe,pt,Je,jt,vt,Et,ft,St,At,Ct],Qt=[...Kt,zt],Yt=[$e,et,ot,lt,pt,Je,jt,vt,Et,ft,St,At,Ct,zt],Xt=Yt,Jt=[...Xt,It,Dt,Mt],Zt=Jt,$t=[...Jt,Wt],er=$t;class tr extends Ne{constructor(e,t){super(),this.le=e,this.currentSequenceNumber=t}}function rr(e,t){const r=N(e);return Ae.O(r.le,t)}function ar(e){let t=0;for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&t++;return t}function nr(e,t){for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&t(r,e[r])}function sr(e,t){const r=[];for(const a in e)Object.prototype.hasOwnProperty.call(e,a)&&r.push(t(e[a],a,e));return r}function ir(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}class or{constructor(e,t){this.comparator=e,this.root=t||cr.EMPTY}insert(e,t){return new or(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,cr.BLACK,null,null))}remove(e){return new or(this.comparator,this.root.remove(e,this.comparator).copy(null,null,cr.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(0===r)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const a=this.comparator(e,r.key);if(0===a)return t+r.left.size;a<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){const e=[];return this.inorderTraversal((t,r)=>(e.push("".concat(t,":").concat(r)),!1)),"{".concat(e.join(", "),"}")}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new lr(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new lr(this.root,e,this.comparator,!1)}getReverseIterator(){return new lr(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new lr(this.root,e,this.comparator,!0)}}class lr{constructor(e,t,r,a){this.isReverse=a,this.nodeStack=[];let n=1;for(;!e.isEmpty();)if(n=t?r(e.key,t):1,t&&a&&(n*=-1),n<0)e=this.isReverse?e.left:e.right;else{if(0===n){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class cr{constructor(e,t,r,a,n){this.key=e,this.value=t,this.color=null!=r?r:cr.RED,this.left=null!=a?a:cr.EMPTY,this.right=null!=n?n:cr.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,a,n){return new cr(null!=e?e:this.key,null!=t?t:this.value,null!=r?r:this.color,null!=a?a:this.left,null!=n?n:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let a=this;const n=r(e,a.key);return a=n<0?a.copy(null,null,null,a.left.insert(e,t,r),null):0===n?a.copy(null,t,null,null,null):a.copy(null,null,null,null,a.right.insert(e,t,r)),a.fixUp()}removeMin(){if(this.left.isEmpty())return cr.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,a=this;if(t(e,a.key)<0)a.left.isEmpty()||a.left.isRed()||a.left.left.isRed()||(a=a.moveRedLeft()),a=a.copy(null,null,null,a.left.remove(e,t),null);else{if(a.left.isRed()&&(a=a.rotateRight()),a.right.isEmpty()||a.right.isRed()||a.right.left.isRed()||(a=a.moveRedRight()),0===t(e,a.key)){if(a.right.isEmpty())return cr.EMPTY;r=a.right.min(),a=a.copy(r.key,r.value,null,null,a.right.removeMin())}a=a.copy(null,null,null,null,a.right.remove(e,t))}return a.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,cr.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,cr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw b(43730,{key:this.key,value:this.value});if(this.right.isRed())throw b(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw b(27949);return e+(this.isRed()?0:1)}}cr.EMPTY=null,cr.RED=!0,cr.BLACK=!1,cr.EMPTY=new class{constructor(){this.size=0}get key(){throw b(57766)}get value(){throw b(16141)}get color(){throw b(16727)}get left(){throw b(29726)}get right(){throw b(36894)}copy(e,t,r,a,n){return this}insert(e,t,r){return new cr(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class dr{constructor(e){this.comparator=e,this.data=new or(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const a=r.getNext();if(this.comparator(a.key,e[1])>=0)return;t(a.key)}}forEachWhile(e,t){let r;for(r=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new ur(this.data.getIterator())}getIteratorFrom(e){return new ur(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(e=>{t=t.add(e)}),t}isEqual(e){if(!(e instanceof dr))return!1;if(this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const e=t.getNext().key,a=r.getNext().key;if(0!==this.comparator(e,a))return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new dr(this.comparator);return t.data=e,t}}class ur{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function hr(e){return e.hasNext()?e.getNext():void 0}class mr{constructor(e){this.fields=e,e.sort(Q.comparator)}static empty(){return new mr([])}unionWith(e){let t=new dr(Q.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new mr(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return V(this.fields,e.fields,(e,t)=>e.isEqual(t))}}class fr extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class gr{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(e){try{return atob(e)}catch(e){throw"undefined"!=typeof DOMException&&e instanceof DOMException?new fr("Invalid base64 string: "+e):e}}(e);return new gr(t)}static fromUint8Array(e){const t=function(e){let t="";for(let r=0;r<e.length;++r)t+=String.fromCharCode(e[r]);return t}(e);return new gr(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return R(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}gr.EMPTY_BYTE_STRING=new gr("");const pr=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function xr(e){if(k(!!e,39018),"string"==typeof e){let t=0;const r=pr.exec(e);if(k(!!r,46558,{timestamp:e}),r[1]){let e=r[1];e=(e+"000000000").substr(0,9),t=Number(e)}const a=new Date(e);return{seconds:Math.floor(a.getTime()/1e3),nanos:t}}return{seconds:yr(e.seconds),nanos:yr(e.nanos)}}function yr(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function vr(e){return"string"==typeof e?gr.fromBase64String(e):gr.fromUint8Array(e)}const br="server_timestamp",wr="__type__",kr="__previous_value__",Nr="__local_write_time__";function jr(e){var t,r;return(null===(t=((null===e||void 0===e||null===(r=e.mapValue)||void 0===r?void 0:r.fields)||{})[wr])||void 0===t?void 0:t.stringValue)===br}function Sr(e){const t=e.mapValue.fields[kr];return jr(t)?Sr(t):t}function _r(e){const t=xr(e.mapValue.fields[Nr].timestampValue);return new le(t.seconds,t.nanos)}class Er{constructor(e,t,r,a,n,s,i,o,l,c){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=a,this.ssl=n,this.forceLongPolling=s,this.autoDetectLongPolling=i,this.longPollingOptions=o,this.useFetchStreams=l,this.isUsingEmulator=c}}const Ar="(default)";class Cr{constructor(e,t){this.projectId=e,this.database=t||Ar}static empty(){return new Cr("","")}get isDefaultDatabase(){return this.database===Ar}isEqual(e){return e instanceof Cr&&e.projectId===this.projectId&&e.database===this.database}}const Ir="__type__",Tr="__max__",Dr={mapValue:{fields:{__type__:{stringValue:Tr}}}},Pr="__vector__",Fr="value",Lr={nullValue:"NULL_VALUE"};function Mr(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?jr(e)?4:$r(e)?9007199254740991:Jr(e)?10:11:b(28295,{value:e})}function Rr(e,t){if(e===t)return!0;const r=Mr(e);if(r!==Mr(t))return!1;switch(r){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return _r(e).isEqual(_r(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;const r=xr(e.timestampValue),a=xr(t.timestampValue);return r.seconds===a.seconds&&r.nanos===a.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(e,t){return vr(e.bytesValue).isEqual(vr(t.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return yr(e.geoPointValue.latitude)===yr(t.geoPointValue.latitude)&&yr(e.geoPointValue.longitude)===yr(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return yr(e.integerValue)===yr(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){const r=yr(e.doubleValue),a=yr(t.doubleValue);return r===a?qe(r)===qe(a):isNaN(r)&&isNaN(a)}return!1}(e,t);case 9:return V(e.arrayValue.values||[],t.arrayValue.values||[],Rr);case 10:case 11:return function(e,t){const r=e.mapValue.fields||{},a=t.mapValue.fields||{};if(ar(r)!==ar(a))return!1;for(const n in r)if(r.hasOwnProperty(n)&&(void 0===a[n]||!Rr(r[n],a[n])))return!1;return!0}(e,t);default:return b(52216,{left:e})}}function Or(e,t){return void 0!==(e.values||[]).find(e=>Rr(e,t))}function Br(e,t){if(e===t)return 0;const r=Mr(e),a=Mr(t);if(r!==a)return R(r,a);switch(r){case 0:case 9007199254740991:return 0;case 1:return R(e.booleanValue,t.booleanValue);case 2:return function(e,t){const r=yr(e.integerValue||e.doubleValue),a=yr(t.integerValue||t.doubleValue);return r<a?-1:r>a?1:r===a?0:isNaN(r)?isNaN(a)?0:-1:1}(e,t);case 3:return zr(e.timestampValue,t.timestampValue);case 4:return zr(_r(e),_r(t));case 5:return O(e.stringValue,t.stringValue);case 6:return function(e,t){const r=vr(e),a=vr(t);return r.compareTo(a)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){const r=e.split("/"),a=t.split("/");for(let n=0;n<r.length&&n<a.length;n++){const e=R(r[n],a[n]);if(0!==e)return e}return R(r.length,a.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){const r=R(yr(e.latitude),yr(t.latitude));return 0!==r?r:R(yr(e.longitude),yr(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return Ur(e.arrayValue,t.arrayValue);case 10:return function(e,t,r,a,n,s){const i=e.fields||{},o=t.fields||{},l=null===(r=i[Fr])||void 0===r?void 0:r.arrayValue,c=null===(a=o[Fr])||void 0===a?void 0:a.arrayValue,d=R((null===l||void 0===l||null===(n=l.values)||void 0===n?void 0:n.length)||0,(null===c||void 0===c||null===(s=c.values)||void 0===s?void 0:s.length)||0);return 0!==d?d:Ur(l,c)}(e.mapValue,t.mapValue);case 11:return function(e,t){if(e===Dr.mapValue&&t===Dr.mapValue)return 0;if(e===Dr.mapValue)return 1;if(t===Dr.mapValue)return-1;const r=e.fields||{},a=Object.keys(r),n=t.fields||{},s=Object.keys(n);a.sort(),s.sort();for(let i=0;i<a.length&&i<s.length;++i){const e=O(a[i],s[i]);if(0!==e)return e;const t=Br(r[a[i]],n[s[i]]);if(0!==t)return t}return R(a.length,s.length)}(e.mapValue,t.mapValue);default:throw b(23264,{he:r})}}function zr(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return R(e,t);const r=xr(e),a=xr(t),n=R(r.seconds,a.seconds);return 0!==n?n:R(r.nanos,a.nanos)}function Ur(e,t){const r=e.values||[],a=t.values||[];for(let n=0;n<r.length&&n<a.length;++n){const e=Br(r[n],a[n]);if(e)return e}return R(r.length,a.length)}function Vr(e){return qr(e)}function qr(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){const t=xr(e);return"time(".concat(t.seconds,",").concat(t.nanos,")")}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?function(e){return vr(e).toBase64()}(e.bytesValue):"referenceValue"in e?function(e){return Y.fromName(e).toString()}(e.referenceValue):"geoPointValue"in e?function(e){return"geo(".concat(e.latitude,",").concat(e.longitude,")")}(e.geoPointValue):"arrayValue"in e?function(e){let t="[",r=!0;for(const a of e.values||[])r?r=!1:t+=",",t+=qr(a);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){const t=Object.keys(e.fields||{}).sort();let r="{",a=!0;for(const n of t)a?a=!1:r+=",",r+="".concat(n,":").concat(qr(e.fields[n]));return r+"}"}(e.mapValue):b(61005,{value:e})}function Hr(e){switch(Mr(e)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const t=Sr(e);return t?16+Hr(t):16;case 5:return 2*e.stringValue.length;case 6:return vr(e.bytesValue).approximateByteSize();case 7:return e.referenceValue.length;case 9:return function(e){return(e.values||[]).reduce((e,t)=>e+Hr(t),0)}(e.arrayValue);case 10:case 11:return function(e){let t=0;return nr(e.fields,(e,r)=>{t+=e.length+Hr(r)}),t}(e.mapValue);default:throw b(13486,{value:e})}}function Gr(e,t){return{referenceValue:"projects/".concat(e.projectId,"/databases/").concat(e.database,"/documents/").concat(t.path.canonicalString())}}function Wr(e){return!!e&&"integerValue"in e}function Kr(e){return!!e&&"arrayValue"in e}function Qr(e){return!!e&&"nullValue"in e}function Yr(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function Xr(e){return!!e&&"mapValue"in e}function Jr(e){var t,r;return(null===(t=((null===e||void 0===e||null===(r=e.mapValue)||void 0===r?void 0:r.fields)||{})[Ir])||void 0===t?void 0:t.stringValue)===Pr}function Zr(e){if(e.geoPointValue)return{geoPointValue:a({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:a({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return nr(e.mapValue.fields,(e,r)=>t.mapValue.fields[e]=Zr(r)),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let r=0;r<(e.arrayValue.values||[]).length;++r)t.arrayValue.values[r]=Zr(e.arrayValue.values[r]);return t}return a({},e)}function $r(e){return(((e.mapValue||{}).fields||{}).__type__||{}).stringValue===Tr}const ea={mapValue:{fields:{[Ir]:{stringValue:Pr},[Fr]:{arrayValue:{}}}}};function ta(e){return"nullValue"in e?Lr:"booleanValue"in e?{booleanValue:!1}:"integerValue"in e||"doubleValue"in e?{doubleValue:NaN}:"timestampValue"in e?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in e?{stringValue:""}:"bytesValue"in e?{bytesValue:""}:"referenceValue"in e?Gr(Cr.empty(),Y.empty()):"geoPointValue"in e?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in e?{arrayValue:{}}:"mapValue"in e?Jr(e)?ea:{mapValue:{}}:b(35942,{value:e})}function ra(e){return"nullValue"in e?{booleanValue:!1}:"booleanValue"in e?{doubleValue:NaN}:"integerValue"in e||"doubleValue"in e?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in e?{stringValue:""}:"stringValue"in e?{bytesValue:""}:"bytesValue"in e?Gr(Cr.empty(),Y.empty()):"referenceValue"in e?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in e?{arrayValue:{}}:"arrayValue"in e?ea:"mapValue"in e?Jr(e)?{mapValue:{}}:Dr:b(61959,{value:e})}function aa(e,t){const r=Br(e.value,t.value);return 0!==r?r:e.inclusive&&!t.inclusive?-1:!e.inclusive&&t.inclusive?1:0}function na(e,t){const r=Br(e.value,t.value);return 0!==r?r:e.inclusive&&!t.inclusive?1:!e.inclusive&&t.inclusive?-1:0}class sa{constructor(e){this.value=e}static empty(){return new sa({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!Xr(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Zr(t)}setAll(e){let t=Q.emptyPath(),r={},a=[];e.forEach((e,n)=>{if(!t.isImmediateParentOf(n)){const e=this.getFieldsMap(t);this.applyChanges(e,r,a),r={},a=[],t=n.popLast()}e?r[n.lastSegment()]=Zr(e):a.push(n.lastSegment())});const n=this.getFieldsMap(t);this.applyChanges(n,r,a)}delete(e){const t=this.field(e.popLast());Xr(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Rr(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let a=t.mapValue.fields[e.get(r)];Xr(a)&&a.mapValue.fields||(a={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=a),t=a}return t.mapValue.fields}applyChanges(e,t,r){nr(t,(t,r)=>e[t]=r);for(const a of r)delete e[a]}clone(){return new sa(Zr(this.value))}}function ia(e){const t=[];return nr(e.fields,(e,r)=>{const a=new Q([e]);if(Xr(r)){const e=ia(r.mapValue).fields;if(0===e.length)t.push(a);else for(const r of e)t.push(a.child(r))}else t.push(a)}),new mr(t)}class oa{constructor(e,t,r,a,n,s,i){this.key=e,this.documentType=t,this.version=r,this.readTime=a,this.createTime=n,this.data=s,this.documentState=i}static newInvalidDocument(e){return new oa(e,0,ce.min(),ce.min(),ce.min(),sa.empty(),0)}static newFoundDocument(e,t,r,a){return new oa(e,1,t,ce.min(),r,a,0)}static newNoDocument(e,t){return new oa(e,2,t,ce.min(),ce.min(),sa.empty(),0)}static newUnknownDocument(e,t){return new oa(e,3,t,ce.min(),ce.min(),sa.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(ce.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=sa.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=sa.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ce.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof oa&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new oa(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return"Document(".concat(this.key,", ").concat(this.version,", ").concat(JSON.stringify(this.data.value),", {createTime: ").concat(this.createTime,"}), {documentType: ").concat(this.documentType,"}), {documentState: ").concat(this.documentState,"})")}}class la{constructor(e,t){this.position=e,this.inclusive=t}}function ca(e,t,r){let a=0;for(let n=0;n<e.position.length;n++){const s=t[n],i=e.position[n];if(a=s.field.isKeyField()?Y.comparator(Y.fromName(i.referenceValue),r.key):Br(i,r.data.field(s.field)),"desc"===s.dir&&(a*=-1),0!==a)break}return a}function da(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let r=0;r<e.position.length;r++)if(!Rr(e.position[r],t.position[r]))return!1;return!0}class ua{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc";this.field=e,this.dir=t}}function ha(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}class ma{}class fa extends ma{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,r):new ja(e,t,r):"array-contains"===t?new Aa(e,r):"in"===t?new Ca(e,r):"not-in"===t?new Ia(e,r):"array-contains-any"===t?new Ta(e,r):new fa(e,t,r)}static createKeyFieldInFilter(e,t,r){return"in"===t?new Sa(e,r):new _a(e,r)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&void 0===t.nullValue&&this.matchesComparison(Br(t,this.value)):null!==t&&Mr(this.value)===Mr(t)&&this.matchesComparison(Br(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return b(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class ga extends ma{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new ga(e,t)}matches(e){return pa(this)?void 0===this.filters.find(t=>!t.matches(e)):void 0!==this.filters.find(t=>t.matches(e))}getFlattenedFilters(){return null!==this.Pe||(this.Pe=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function pa(e){return"and"===e.op}function xa(e){return"or"===e.op}function ya(e){return va(e)&&pa(e)}function va(e){for(const t of e.filters)if(t instanceof ga)return!1;return!0}function ba(e){if(e instanceof fa)return e.field.canonicalString()+e.op.toString()+Vr(e.value);if(ya(e))return e.filters.map(e=>ba(e)).join(",");{const t=e.filters.map(e=>ba(e)).join(",");return"".concat(e.op,"(").concat(t,")")}}function wa(e,t){return e instanceof fa?function(e,t){return t instanceof fa&&e.op===t.op&&e.field.isEqual(t.field)&&Rr(e.value,t.value)}(e,t):e instanceof ga?function(e,t){return t instanceof ga&&e.op===t.op&&e.filters.length===t.filters.length&&e.filters.reduce((e,r,a)=>e&&wa(r,t.filters[a]),!0)}(e,t):void b(19439)}function ka(e,t){const r=e.filters.concat(t);return ga.create(r,e.op)}function Na(e){return e instanceof fa?function(e){return"".concat(e.field.canonicalString()," ").concat(e.op," ").concat(Vr(e.value))}(e):e instanceof ga?function(e){return e.op.toString()+" {"+e.getFilters().map(Na).join(" ,")+"}"}(e):"Filter"}class ja extends fa{constructor(e,t,r){super(e,t,r),this.key=Y.fromName(r.referenceValue)}matches(e){const t=Y.comparator(e.key,this.key);return this.matchesComparison(t)}}class Sa extends fa{constructor(e,t){super(e,"in",t),this.keys=Ea("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class _a extends fa{constructor(e,t){super(e,"not-in",t),this.keys=Ea("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function Ea(e,t){var r;return((null===(r=t.arrayValue)||void 0===r?void 0:r.values)||[]).map(e=>Y.fromName(e.referenceValue))}class Aa extends fa{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Kr(t)&&Or(t.arrayValue,this.value)}}class Ca extends fa{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&Or(this.value.arrayValue,t)}}class Ia extends fa{constructor(e,t){super(e,"not-in",t)}matches(e){if(Or(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&void 0===t.nullValue&&!Or(this.value.arrayValue,t)}}class Ta extends fa{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Kr(t)||!t.arrayValue.values)&&t.arrayValue.values.some(e=>Or(this.value.arrayValue,e))}}class Da{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=a,this.limit=n,this.startAt=s,this.endAt=i,this.Te=null}}function Pa(e){return new Da(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,arguments.length>6&&void 0!==arguments[6]?arguments[6]:null)}function Fa(e){const t=N(e);if(null===t.Te){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map(e=>ba(e)).join(","),e+="|ob:",e+=t.orderBy.map(e=>function(e){return e.field.canonicalString()+e.dir}(e)).join(","),Ve(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map(e=>Vr(e)).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map(e=>Vr(e)).join(",")),t.Te=e}return t.Te}function La(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(let r=0;r<e.orderBy.length;r++)if(!ha(e.orderBy[r],t.orderBy[r]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let r=0;r<e.filters.length;r++)if(!wa(e.filters[r],t.filters[r]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!da(e.startAt,t.startAt)&&da(e.endAt,t.endAt)}function Ma(e){return Y.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}function Ra(e,t){return e.filters.filter(e=>e instanceof fa&&e.field.isEqual(t))}function Oa(e,t,r){let a=Lr,n=!0;for(const s of Ra(e,t)){let e=Lr,t=!0;switch(s.op){case"<":case"<=":e=ta(s.value);break;case"==":case"in":case">=":e=s.value;break;case">":e=s.value,t=!1;break;case"!=":case"not-in":e=Lr}aa({value:a,inclusive:n},{value:e,inclusive:t})<0&&(a=e,n=t)}if(null!==r)for(let s=0;s<e.orderBy.length;++s)if(e.orderBy[s].field.isEqual(t)){const e=r.position[s];aa({value:a,inclusive:n},{value:e,inclusive:r.inclusive})<0&&(a=e,n=r.inclusive);break}return{value:a,inclusive:n}}function Ba(e,t,r){let a=Dr,n=!0;for(const s of Ra(e,t)){let e=Dr,t=!0;switch(s.op){case">=":case">":e=ra(s.value),t=!1;break;case"==":case"in":case"<=":e=s.value;break;case"<":e=s.value,t=!1;break;case"!=":case"not-in":e=Dr}na({value:a,inclusive:n},{value:e,inclusive:t})>0&&(a=e,n=t)}if(null!==r)for(let s=0;s<e.orderBy.length;++s)if(e.orderBy[s].field.isEqual(t)){const e=r.position[s];na({value:a,inclusive:n},{value:e,inclusive:r.inclusive})>0&&(a=e,n=r.inclusive);break}return{value:a,inclusive:n}}class za{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"F",i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=a,this.limit=n,this.limitType=s,this.startAt=i,this.endAt=o,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function Ua(e,t,r,a,n,s,i,o){return new za(e,t,r,a,n,s,i,o)}function Va(e){return new za(e)}function qa(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function Ha(e){return null!==e.collectionGroup}function Ga(e){const t=N(e);if(null===t.Ie){t.Ie=[];const e=new Set;for(const n of t.explicitOrderBy)t.Ie.push(n),e.add(n.field.canonicalString());const r=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc",a=function(e){let t=new dr(Q.comparator);return e.filters.forEach(e=>{e.getFlattenedFilters().forEach(e=>{e.isInequality()&&(t=t.add(e.field))})}),t}(t);a.forEach(a=>{e.has(a.canonicalString())||a.isKeyField()||t.Ie.push(new ua(a,r))}),e.has(Q.keyField().canonicalString())||t.Ie.push(new ua(Q.keyField(),r))}return t.Ie}function Wa(e){const t=N(e);return t.Ee||(t.Ee=Qa(t,Ga(e))),t.Ee}function Ka(e){const t=N(e);return t.de||(t.de=Qa(t,e.explicitOrderBy)),t.de}function Qa(e,t){if("F"===e.limitType)return Pa(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map(e=>{const t="desc"===e.dir?"asc":"desc";return new ua(e.field,t)});const r=e.endAt?new la(e.endAt.position,e.endAt.inclusive):null,a=e.startAt?new la(e.startAt.position,e.startAt.inclusive):null;return Pa(e.path,e.collectionGroup,t,e.filters,e.limit,r,a)}}function Ya(e,t){const r=e.filters.concat([t]);return new za(e.path,e.collectionGroup,e.explicitOrderBy.slice(),r,e.limit,e.limitType,e.startAt,e.endAt)}function Xa(e,t,r){return new za(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,r,e.startAt,e.endAt)}function Ja(e,t){return La(Wa(e),Wa(t))&&e.limitType===t.limitType}function Za(e){return"".concat(Fa(Wa(e)),"|lt:").concat(e.limitType)}function $a(e){return"Query(target=".concat(function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=", filters: [".concat(e.filters.map(e=>Na(e)).join(", "),"]")),Ve(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=", orderBy: [".concat(e.orderBy.map(e=>function(e){return"".concat(e.field.canonicalString()," (").concat(e.dir,")")}(e)).join(", "),"]")),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(e=>Vr(e)).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(e=>Vr(e)).join(",")),"Target(".concat(t,")")}(Wa(e)),"; limitType=").concat(e.limitType,")")}function en(e,t){return t.isFoundDocument()&&function(e,t){const r=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(r):Y.isDocumentKey(e.path)?e.path.isEqual(r):e.path.isImmediateParentOf(r)}(e,t)&&function(e,t){for(const r of Ga(e))if(!r.field.isKeyField()&&null===t.data.field(r.field))return!1;return!0}(e,t)&&function(e,t){for(const r of e.filters)if(!r.matches(t))return!1;return!0}(e,t)&&function(e,t){return!(e.startAt&&!function(e,t,r){const a=ca(e,t,r);return e.inclusive?a<=0:a<0}(e.startAt,Ga(e),t))&&!(e.endAt&&!function(e,t,r){const a=ca(e,t,r);return e.inclusive?a>=0:a>0}(e.endAt,Ga(e),t))}(e,t)}function tn(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function rn(e){return(t,r)=>{let a=!1;for(const n of Ga(e)){const e=an(n,t,r);if(0!==e)return e;a=a||n.field.isKeyField()}return 0}}function an(e,t,r){const a=e.field.isKeyField()?Y.comparator(t.key,r.key):function(e,t,r){const a=t.data.field(e),n=r.data.field(e);return null!==a&&null!==n?Br(a,n):b(42886)}(e.field,t,r);switch(e.dir){case"asc":return a;case"desc":return-1*a;default:return b(19790,{direction:e.dir})}}class nn{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(void 0!==r)for(const[a,n]of r)if(this.equalsFn(a,e))return n}has(e){return void 0!==this.get(e)}set(e,t){const r=this.mapKeyFn(e),a=this.inner[r];if(void 0===a)return this.inner[r]=[[e,t]],void this.innerSize++;for(let n=0;n<a.length;n++)if(this.equalsFn(a[n][0],e))return void(a[n]=[e,t]);a.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(void 0===r)return!1;for(let a=0;a<r.length;a++)if(this.equalsFn(r[a][0],e))return 1===r.length?delete this.inner[t]:r.splice(a,1),this.innerSize--,!0;return!1}forEach(e){nr(this.inner,(t,r)=>{for(const[a,n]of r)e(a,n)})}isEmpty(){return ir(this.inner)}size(){return this.innerSize}}const sn=new or(Y.comparator);function on(){return sn}const ln=new or(Y.comparator);function cn(){let e=ln;for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];for(const n of r)e=e.insert(n.key,n);return e}function dn(e){let t=ln;return e.forEach((e,r)=>t=t.insert(e,r.overlayedDocument)),t}function un(){return mn()}function hn(){return mn()}function mn(){return new nn(e=>e.toString(),(e,t)=>e.isEqual(t))}const fn=new or(Y.comparator),gn=new dr(Y.comparator);function pn(){let e=gn;for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];for(const n of r)e=e.add(n);return e}const xn=new dr(R);function yn(){return xn}function vn(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:qe(t)?"-0":t}}function bn(e){return{integerValue:""+e}}function wn(e,t){return He(t)?bn(t):vn(e,t)}class kn{constructor(){this._=void 0}}function Nn(e,t,r){return e instanceof _n?function(e,t){const r={fields:{[wr]:{stringValue:br},[Nr]:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&jr(t)&&(t=Sr(t)),t&&(r.fields[kr]=t),{mapValue:r}}(r,t):e instanceof En?An(e,t):e instanceof Cn?In(e,t):function(e,t){const r=Sn(e,t),a=Dn(r)+Dn(e.Ae);return Wr(r)&&Wr(e.Ae)?bn(a):vn(e.serializer,a)}(e,t)}function jn(e,t,r){return e instanceof En?An(e,t):e instanceof Cn?In(e,t):r}function Sn(e,t){return e instanceof Tn?function(e){return Wr(e)||function(e){return!!e&&"doubleValue"in e}(e)}(t)?t:{integerValue:0}:null}class _n extends kn{}class En extends kn{constructor(e){super(),this.elements=e}}function An(e,t){const r=Pn(t);for(const a of e.elements)r.some(e=>Rr(e,a))||r.push(a);return{arrayValue:{values:r}}}class Cn extends kn{constructor(e){super(),this.elements=e}}function In(e,t){let r=Pn(t);for(const a of e.elements)r=r.filter(e=>!Rr(e,a));return{arrayValue:{values:r}}}class Tn extends kn{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function Dn(e){return yr(e.integerValue||e.doubleValue)}function Pn(e){return Kr(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}class Fn{constructor(e,t){this.field=e,this.transform=t}}class Ln{constructor(e,t){this.version=e,this.transformResults=t}}class Mn{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Mn}static exists(e){return new Mn(void 0,e)}static updateTime(e){return new Mn(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Rn(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class On{}function Bn(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new Yn(e.key,Mn.none()):new Hn(e.key,e.data,Mn.none());{const r=e.data,a=sa.empty();let n=new dr(Q.comparator);for(let e of t.fields)if(!n.has(e)){let t=r.field(e);null===t&&e.length>1&&(e=e.popLast(),t=r.field(e)),null===t?a.delete(e):a.set(e,t),n=n.add(e)}return new Gn(e.key,a,new mr(n.toArray()),Mn.none())}}function zn(e,t,r){e instanceof Hn?function(e,t,r){const a=e.value.clone(),n=Kn(e.fieldTransforms,t,r.transformResults);a.setAll(n),t.convertToFoundDocument(r.version,a).setHasCommittedMutations()}(e,t,r):e instanceof Gn?function(e,t,r){if(!Rn(e.precondition,t))return void t.convertToUnknownDocument(r.version);const a=Kn(e.fieldTransforms,t,r.transformResults),n=t.data;n.setAll(Wn(e)),n.setAll(a),t.convertToFoundDocument(r.version,n).setHasCommittedMutations()}(e,t,r):function(e,t,r){t.convertToNoDocument(r.version).setHasCommittedMutations()}(0,t,r)}function Un(e,t,r,a){return e instanceof Hn?function(e,t,r,a){if(!Rn(e.precondition,t))return r;const n=e.value.clone(),s=Qn(e.fieldTransforms,a,t);return n.setAll(s),t.convertToFoundDocument(t.version,n).setHasLocalMutations(),null}(e,t,r,a):e instanceof Gn?function(e,t,r,a){if(!Rn(e.precondition,t))return r;const n=Qn(e.fieldTransforms,a,t),s=t.data;return s.setAll(Wn(e)),s.setAll(n),t.convertToFoundDocument(t.version,s).setHasLocalMutations(),null===r?null:r.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map(e=>e.field))}(e,t,r,a):function(e,t,r){return Rn(e.precondition,t)?(t.convertToNoDocument(t.version).setHasLocalMutations(),null):r}(e,t,r)}function Vn(e,t){let r=null;for(const a of e.fieldTransforms){const e=t.data.field(a.field),n=Sn(a.transform,e||null);null!=n&&(null===r&&(r=sa.empty()),r.set(a.field,n))}return r||null}function qn(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(e,t){return void 0===e&&void 0===t||!(!e||!t)&&V(e,t,(e,t)=>function(e,t){return e.field.isEqual(t.field)&&function(e,t){return e instanceof En&&t instanceof En||e instanceof Cn&&t instanceof Cn?V(e.elements,t.elements,Rr):e instanceof Tn&&t instanceof Tn?Rr(e.Ae,t.Ae):e instanceof _n&&t instanceof _n}(e.transform,t.transform)}(e,t))}(e.fieldTransforms,t.fieldTransforms)&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class Hn extends On{constructor(e,t,r){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=a,this.type=0}getFieldMask(){return null}}class Gn extends On{constructor(e,t,r,a){let n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=a,this.fieldTransforms=n,this.type=1}getFieldMask(){return this.fieldMask}}function Wn(e){const t=new Map;return e.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const a=e.data.field(r);t.set(r,a)}}),t}function Kn(e,t,r){const a=new Map;k(e.length===r.length,32656,{Re:r.length,Ve:e.length});for(let n=0;n<r.length;n++){const s=e[n],i=s.transform,o=t.data.field(s.field);a.set(s.field,jn(i,o,r[n]))}return a}function Qn(e,t,r){const a=new Map;for(const n of e){const e=n.transform,s=r.data.field(n.field);a.set(n.field,Nn(e,s,t))}return a}class Yn extends On{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Xn extends On{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class Jn{constructor(e,t,r,a){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=a}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let a=0;a<this.mutations.length;a++){const t=this.mutations[a];t.key.isEqual(e.key)&&zn(t,e,r[a])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=Un(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=Un(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=hn();return this.mutations.forEach(a=>{const n=e.get(a.key),s=n.overlayedDocument;let i=this.applyToLocalView(s,n.mutatedFields);i=t.has(a.key)?null:i;const o=Bn(s,i);null!==o&&r.set(a.key,o),s.isValidDocument()||s.convertToNoDocument(ce.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),pn())}isEqual(e){return this.batchId===e.batchId&&V(this.mutations,e.mutations,(e,t)=>qn(e,t))&&V(this.baseMutations,e.baseMutations,(e,t)=>qn(e,t))}}class Zn{constructor(e,t,r,a){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=a}static from(e,t,r){k(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let a=fn;const n=e.mutations;for(let s=0;s<n.length;s++)a=a.insert(n[s].key,r[s].version);return new Zn(e,t,r,a)}}class $n{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return"Overlay{\n      largestBatchId: ".concat(this.largestBatchId,",\n      mutation: ").concat(this.mutation.toString(),"\n    }")}}class es{constructor(e,t,r){this.alias=e,this.aggregateType=t,this.fieldPath=r}}class ts{constructor(e,t){this.count=e,this.unchangedNames=t}}var rs,as;function ns(e){switch(e){case j.OK:return b(64938);case j.CANCELLED:case j.UNKNOWN:case j.DEADLINE_EXCEEDED:case j.RESOURCE_EXHAUSTED:case j.INTERNAL:case j.UNAVAILABLE:case j.UNAUTHENTICATED:return!1;case j.INVALID_ARGUMENT:case j.NOT_FOUND:case j.ALREADY_EXISTS:case j.PERMISSION_DENIED:case j.FAILED_PRECONDITION:case j.ABORTED:case j.OUT_OF_RANGE:case j.UNIMPLEMENTED:case j.DATA_LOSS:return!0;default:return b(15467,{code:e})}}function ss(e){if(void 0===e)return x("GRPC error has no .code"),j.UNKNOWN;switch(e){case rs.OK:return j.OK;case rs.CANCELLED:return j.CANCELLED;case rs.UNKNOWN:return j.UNKNOWN;case rs.DEADLINE_EXCEEDED:return j.DEADLINE_EXCEEDED;case rs.RESOURCE_EXHAUSTED:return j.RESOURCE_EXHAUSTED;case rs.INTERNAL:return j.INTERNAL;case rs.UNAVAILABLE:return j.UNAVAILABLE;case rs.UNAUTHENTICATED:return j.UNAUTHENTICATED;case rs.INVALID_ARGUMENT:return j.INVALID_ARGUMENT;case rs.NOT_FOUND:return j.NOT_FOUND;case rs.ALREADY_EXISTS:return j.ALREADY_EXISTS;case rs.PERMISSION_DENIED:return j.PERMISSION_DENIED;case rs.FAILED_PRECONDITION:return j.FAILED_PRECONDITION;case rs.ABORTED:return j.ABORTED;case rs.OUT_OF_RANGE:return j.OUT_OF_RANGE;case rs.UNIMPLEMENTED:return j.UNIMPLEMENTED;case rs.DATA_LOSS:return j.DATA_LOSS;default:return b(39323,{code:e})}}(as=rs||(rs={}))[as.OK=0]="OK",as[as.CANCELLED=1]="CANCELLED",as[as.UNKNOWN=2]="UNKNOWN",as[as.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",as[as.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",as[as.NOT_FOUND=5]="NOT_FOUND",as[as.ALREADY_EXISTS=6]="ALREADY_EXISTS",as[as.PERMISSION_DENIED=7]="PERMISSION_DENIED",as[as.UNAUTHENTICATED=16]="UNAUTHENTICATED",as[as.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",as[as.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",as[as.ABORTED=10]="ABORTED",as[as.OUT_OF_RANGE=11]="OUT_OF_RANGE",as[as.UNIMPLEMENTED=12]="UNIMPLEMENTED",as[as.INTERNAL=13]="INTERNAL",as[as.UNAVAILABLE=14]="UNAVAILABLE",as[as.DATA_LOSS=15]="DATA_LOSS";let is=null;function os(){return new TextEncoder}const ls=new l.Integer([4294967295,4294967295],0);function cs(e){const t=os().encode(e),r=new l.Md5;return r.update(t),new Uint8Array(r.digest())}function ds(e){const t=new DataView(e.buffer),r=t.getUint32(0,!0),a=t.getUint32(4,!0),n=t.getUint32(8,!0),s=t.getUint32(12,!0);return[new l.Integer([r,a],0),new l.Integer([n,s],0)]}class us{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new hs("Invalid padding: ".concat(t));if(r<0)throw new hs("Invalid hash count: ".concat(r));if(e.length>0&&0===this.hashCount)throw new hs("Invalid hash count: ".concat(r));if(0===e.length&&0!==t)throw new hs("Invalid padding when bitmap length is 0: ".concat(t));this.ge=8*e.length-t,this.pe=l.Integer.fromNumber(this.ge)}ye(e,t,r){let a=e.add(t.multiply(l.Integer.fromNumber(r)));return 1===a.compare(ls)&&(a=new l.Integer([a.getBits(0),a.getBits(1)],0)),a.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(0===this.ge)return!1;const t=cs(e),[r,a]=ds(t);for(let n=0;n<this.hashCount;n++){const e=this.ye(r,a,n);if(!this.we(e))return!1}return!0}static create(e,t,r){const a=e%8==0?0:8-e%8,n=new Uint8Array(Math.ceil(e/8)),s=new us(n,a,t);return r.forEach(e=>s.insert(e)),s}insert(e){if(0===this.ge)return;const t=cs(e),[r,a]=ds(t);for(let n=0;n<this.hashCount;n++){const e=this.ye(r,a,n);this.Se(e)}}Se(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class hs extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class ms{constructor(e,t,r,a,n){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=a,this.resolvedLimboDocuments=n}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const a=new Map;return a.set(e,fs.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new ms(ce.min(),a,new or(R),on(),pn())}}class fs{constructor(e,t,r,a,n){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=a,this.removedDocuments=n}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new fs(r,t,pn(),pn(),pn())}}class gs{constructor(e,t,r,a){this.be=e,this.removedTargetIds=t,this.key=r,this.De=a}}class ps{constructor(e,t){this.targetId=e,this.Ce=t}}class xs{constructor(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:gr.EMPTY_BYTE_STRING,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=a}}class ys{constructor(){this.ve=0,this.Fe=ws(),this.Me=gr.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return 0!==this.ve}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=pn(),t=pn(),r=pn();return this.Fe.forEach((a,n)=>{switch(n){case 0:e=e.add(a);break;case 2:t=t.add(a);break;case 1:r=r.add(a);break;default:b(38017,{changeType:n})}}),new fs(this.Me,this.xe,e,t,r)}qe(){this.Oe=!1,this.Fe=ws()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,k(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class vs{constructor(e){this.Ge=e,this.ze=new Map,this.je=on(),this.Je=bs(),this.He=bs(),this.Ye=new or(R)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,t=>{const r=this.nt(t);switch(e.state){case 0:this.rt(t)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),r.Le(e.resumeToken));break;default:b(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach((e,r)=>{this.rt(r)&&t(r)})}st(e){const t=e.targetId,r=e.Ce.count,a=this.ot(t);if(a){const s=a.target;if(Ma(s))if(0===r){const e=new Y(s.path);this.et(t,e,oa.newNoDocument(e,ce.min()))}else k(1===r,20013,{expectedCount:r});else{const a=this._t(t);if(a!==r){var n;const r=this.ut(e),s=r?this.ct(r,e,a):1;if(0!==s){this.it(t);const e=2===s?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,e)}null===(n=is)||void 0===n||n.lt(function(e,t,r,a,n,s,i,o,l,c){const d={localCacheCount:e,existenceFilterCount:t.count,databaseId:r.database,projectId:r.projectId},u=t.unchangedNames;return u&&(d.bloomFilter={applied:0===n,hashCount:null!==(s=null===u||void 0===u?void 0:u.hashCount)&&void 0!==s?s:0,bitmapLength:null!==(i=null===u||void 0===u||null===(o=u.bits)||void 0===o||null===(o=o.bitmap)||void 0===o?void 0:o.length)&&void 0!==i?i:0,padding:null!==(l=null===u||void 0===u||null===(c=u.bits)||void 0===c?void 0:c.padding)&&void 0!==l?l:0,mightContain:e=>{var t;return null!==(t=null===a||void 0===a?void 0:a.mightContain(e))&&void 0!==t&&t}}),d}(a,e.Ce,this.Ge.ht(),r,s))}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:a=0},hashCount:n=0}=t;let s,i;try{s=vr(r).toUint8Array()}catch(e){if(e instanceof fr)return y("Decoding the base64 bloom filter in existence filter failed ("+e.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw e}try{i=new us(s,a,n)}catch(e){return y(e instanceof hs?"BloomFilter error: ":"Applying bloom filter failed: ",e),null}return 0===i.ge?null:i}ct(e,t,r){return t.Ce.count===r-this.Pt(e,t.targetId)?0:2}Pt(e,t){const r=this.Ge.getRemoteKeysForTarget(t);let a=0;return r.forEach(r=>{const n=this.Ge.ht(),s="projects/".concat(n.projectId,"/databases/").concat(n.database,"/documents/").concat(r.path.canonicalString());e.mightContain(s)||(this.et(t,r,null),a++)}),a}Tt(e){const t=new Map;this.ze.forEach((r,a)=>{const n=this.ot(a);if(n){if(r.current&&Ma(n.target)){const t=new Y(n.target.path);this.It(t).has(a)||this.Et(a,t)||this.et(a,t,oa.newNoDocument(t,e))}r.Be&&(t.set(a,r.ke()),r.qe())}});let r=pn();this.He.forEach((e,t)=>{let a=!0;t.forEachWhile(e=>{const t=this.ot(e);return!t||"TargetPurposeLimboResolution"===t.purpose||(a=!1,!1)}),a&&(r=r.add(e))}),this.je.forEach((t,r)=>r.setReadTime(e));const a=new ms(e,t,this.Ye,this.je,r);return this.je=on(),this.Je=bs(),this.He=bs(),this.Ye=new or(R),a}Xe(e,t){if(!this.rt(e))return;const r=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,r),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,r){if(!this.rt(e))return;const a=this.nt(e);this.Et(e,t)?a.Qe(t,1):a.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),r&&(this.je=this.je.insert(t,r))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new ys,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new dr(R),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new dr(R),this.Je=this.Je.insert(e,t)),t}rt(e){const t=null!==this.ot(e);return t||p("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new ys),this.Ge.getRemoteKeysForTarget(e).forEach(t=>{this.et(e,t,null)})}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function bs(){return new or(Y.comparator)}function ws(){return new or(Y.comparator)}const ks={asc:"ASCENDING",desc:"DESCENDING"},Ns={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},js={and:"AND",or:"OR"};class Ss{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function _s(e,t){return e.useProto3Json||Ve(t)?t:{value:t}}function Es(e,t){return e.useProto3Json?"".concat(new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z",""),".").concat(("000000000"+t.nanoseconds).slice(-9),"Z"):{seconds:""+t.seconds,nanos:t.nanoseconds}}function As(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function Cs(e,t){return Es(e,t.toTimestamp())}function Is(e){return k(!!e,49232),ce.fromTimestamp(function(e){const t=xr(e);return new le(t.seconds,t.nanos)}(e))}function Ts(e,t){return Ds(e,t).canonicalString()}function Ds(e,t){const r=function(e){return new W(["projects",e.projectId,"databases",e.database])}(e).child("documents");return void 0===t?r:r.child(t)}function Ps(e){const t=W.fromString(e);return k(ri(t),10190,{key:t.toString()}),t}function Fs(e,t){return Ts(e.databaseId,t.path)}function Ls(e,t){const r=Ps(t);if(r.get(1)!==e.databaseId.projectId)throw new S(j.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+e.databaseId.projectId);if(r.get(3)!==e.databaseId.database)throw new S(j.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+e.databaseId.database);return new Y(Bs(r))}function Ms(e,t){return Ts(e.databaseId,t)}function Rs(e){const t=Ps(e);return 4===t.length?W.emptyPath():Bs(t)}function Os(e){return new W(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function Bs(e){return k(e.length>4&&"documents"===e.get(4),29091,{key:e.toString()}),e.popFirst(5)}function zs(e,t,r){return{name:Fs(e,t),fields:r.value.mapValue.fields}}function Us(e,t,r){const a=Ls(e,t.name),n=Is(t.updateTime),s=t.createTime?Is(t.createTime):ce.min(),i=new sa({mapValue:{fields:t.fields}}),o=oa.newFoundDocument(a,n,s,i);return r&&o.setHasCommittedMutations(),r?o.setHasCommittedMutations():o}function Vs(e,t){let r;if(t instanceof Hn)r={update:zs(e,t.key,t.value)};else if(t instanceof Yn)r={delete:Fs(e,t.key)};else if(t instanceof Gn)r={update:zs(e,t.key,t.data),updateMask:ti(t.fieldMask)};else{if(!(t instanceof Xn))return b(16599,{Vt:t.type});r={verify:Fs(e,t.key)}}return t.fieldTransforms.length>0&&(r.updateTransforms=t.fieldTransforms.map(e=>function(e,t){const r=t.transform;if(r instanceof _n)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(r instanceof En)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:r.elements}};if(r instanceof Cn)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:r.elements}};if(r instanceof Tn)return{fieldPath:t.field.canonicalString(),increment:r.Ae};throw b(20930,{transform:t.transform})}(0,e))),t.precondition.isNone||(r.currentDocument=function(e,t){return void 0!==t.updateTime?{updateTime:Cs(e,t.updateTime)}:void 0!==t.exists?{exists:t.exists}:b(27497)}(e,t.precondition)),r}function qs(e,t){const r=t.currentDocument?function(e){return void 0!==e.updateTime?Mn.updateTime(Is(e.updateTime)):void 0!==e.exists?Mn.exists(e.exists):Mn.none()}(t.currentDocument):Mn.none(),a=t.updateTransforms?t.updateTransforms.map(t=>function(e,t){let r=null;if("setToServerValue"in t)k("REQUEST_TIME"===t.setToServerValue,16630,{proto:t}),r=new _n;else if("appendMissingElements"in t){const e=t.appendMissingElements.values||[];r=new En(e)}else if("removeAllFromArray"in t){const e=t.removeAllFromArray.values||[];r=new Cn(e)}else"increment"in t?r=new Tn(e,t.increment):b(16584,{proto:t});const a=Q.fromServerFormat(t.fieldPath);return new Fn(a,r)}(e,t)):[];if(t.update){t.update.name;const n=Ls(e,t.update.name),s=new sa({mapValue:{fields:t.update.fields}});if(t.updateMask){const e=function(e){const t=e.fieldPaths||[];return new mr(t.map(e=>Q.fromServerFormat(e)))}(t.updateMask);return new Gn(n,s,e,r,a)}return new Hn(n,s,r,a)}if(t.delete){const a=Ls(e,t.delete);return new Yn(a,r)}if(t.verify){const a=Ls(e,t.verify);return new Xn(a,r)}return b(1463,{proto:t})}function Hs(e,t){return{documents:[Ms(e,t.path)]}}function Gs(e,t){const r={structuredQuery:{}},a=t.path;let n;null!==t.collectionGroup?(n=a,r.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(n=a.popLast(),r.structuredQuery.from=[{collectionId:a.lastSegment()}]),r.parent=Ms(e,n);const s=function(e){if(0!==e.length)return ei(ga.create(e,"and"))}(t.filters);s&&(r.structuredQuery.where=s);const i=function(e){if(0!==e.length)return e.map(e=>function(e){return{field:Zs(e.field),direction:Ys(e.dir)}}(e))}(t.orderBy);i&&(r.structuredQuery.orderBy=i);const o=_s(e,t.limit);return null!==o&&(r.structuredQuery.limit=o),t.startAt&&(r.structuredQuery.startAt=function(e){return{before:e.inclusive,values:e.position}}(t.startAt)),t.endAt&&(r.structuredQuery.endAt=function(e){return{before:!e.inclusive,values:e.position}}(t.endAt)),{ft:r,parent:n}}function Ws(e,t,r,a){const{ft:n,parent:s}=Gs(e,t),i={},o=[];let l=0;return r.forEach(e=>{const t=a?e.alias:"aggregate_"+l++;i[t]=e.alias,"count"===e.aggregateType?o.push({alias:t,count:{}}):"avg"===e.aggregateType?o.push({alias:t,avg:{field:Zs(e.fieldPath)}}):"sum"===e.aggregateType&&o.push({alias:t,sum:{field:Zs(e.fieldPath)}})}),{request:{structuredAggregationQuery:{aggregations:o,structuredQuery:n.structuredQuery},parent:n.parent},gt:i,parent:s}}function Ks(e){let t=Rs(e.parent);const r=e.structuredQuery,a=r.from?r.from.length:0;let n=null;if(a>0){k(1===a,65062);const e=r.from[0];e.allDescendants?n=e.collectionId:t=t.child(e.collectionId)}let s=[];r.where&&(s=function(e){const t=Qs(e);return t instanceof ga&&ya(t)?t.getFilters():[t]}(r.where));let i=[];r.orderBy&&(i=function(e){return e.map(e=>function(e){return new ua($s(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))}(e))}(r.orderBy));let o=null;r.limit&&(o=function(e){let t;return t="object"==typeof e?e.value:e,Ve(t)?null:t}(r.limit));let l=null;r.startAt&&(l=function(e){const t=!!e.before,r=e.values||[];return new la(r,t)}(r.startAt));let c=null;return r.endAt&&(c=function(e){const t=!e.before,r=e.values||[];return new la(r,t)}(r.endAt)),Ua(t,n,i,s,o,"F",l,c)}function Qs(e){return void 0!==e.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":const t=$s(e.unaryFilter.field);return fa.create(t,"==",{doubleValue:NaN});case"IS_NULL":const r=$s(e.unaryFilter.field);return fa.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const a=$s(e.unaryFilter.field);return fa.create(a,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const n=$s(e.unaryFilter.field);return fa.create(n,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return b(61313);default:return b(60726)}}(e):void 0!==e.fieldFilter?function(e){return fa.create($s(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return b(58110);default:return b(50506)}}(e.fieldFilter.op),e.fieldFilter.value)}(e):void 0!==e.compositeFilter?function(e){return ga.create(e.compositeFilter.filters.map(e=>Qs(e)),function(e){switch(e){case"AND":return"and";case"OR":return"or";default:return b(1026)}}(e.compositeFilter.op))}(e):b(30097,{filter:e})}function Ys(e){return ks[e]}function Xs(e){return Ns[e]}function Js(e){return js[e]}function Zs(e){return{fieldPath:e.canonicalString()}}function $s(e){return Q.fromServerFormat(e.fieldPath)}function ei(e){return e instanceof fa?function(e){if("=="===e.op){if(Yr(e.value))return{unaryFilter:{field:Zs(e.field),op:"IS_NAN"}};if(Qr(e.value))return{unaryFilter:{field:Zs(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(Yr(e.value))return{unaryFilter:{field:Zs(e.field),op:"IS_NOT_NAN"}};if(Qr(e.value))return{unaryFilter:{field:Zs(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Zs(e.field),op:Xs(e.op),value:e.value}}}(e):e instanceof ga?function(e){const t=e.getFilters().map(e=>ei(e));return 1===t.length?t[0]:{compositeFilter:{op:Js(e.op),filters:t}}}(e):b(54877,{filter:e})}function ti(e){const t=[];return e.fields.forEach(e=>t.push(e.canonicalString())),{fieldPaths:t}}function ri(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}class ai{constructor(e,t,r,a){let n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:ce.min(),s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:ce.min(),i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:gr.EMPTY_BYTE_STRING,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=a,this.snapshotVersion=n,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=i,this.expectedCount=o}withSequenceNumber(e){return new ai(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new ai(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new ai(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new ai(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class ni{constructor(e){this.yt=e}}function si(e,t){const r=t.key,a={prefixPath:r.getCollectionPath().popLast().toArray(),collectionGroup:r.collectionGroup,documentId:r.path.lastSegment(),readTime:ii(t.readTime),hasCommittedMutations:t.hasCommittedMutations};if(t.isFoundDocument())a.document=function(e,t){return{name:Fs(e,t.key),fields:t.data.value.mapValue.fields,updateTime:Es(e,t.version.toTimestamp()),createTime:Es(e,t.createTime.toTimestamp())}}(e.yt,t);else if(t.isNoDocument())a.noDocument={path:r.path.toArray(),readTime:oi(t.version)};else{if(!t.isUnknownDocument())return b(57904,{document:t});a.unknownDocument={path:r.path.toArray(),version:oi(t.version)}}return a}function ii(e){const t=e.toTimestamp();return[t.seconds,t.nanoseconds]}function oi(e){const t=e.toTimestamp();return{seconds:t.seconds,nanoseconds:t.nanoseconds}}function li(e){const t=new le(e.seconds,e.nanoseconds);return ce.fromTimestamp(t)}function ci(e,t){const r=(t.baseMutations||[]).map(t=>qs(e.yt,t));for(let s=0;s<t.mutations.length-1;++s){const e=t.mutations[s];if(s+1<t.mutations.length&&void 0!==t.mutations[s+1].transform){const r=t.mutations[s+1];e.updateTransforms=r.transform.fieldTransforms,t.mutations.splice(s+1,1),++s}}const a=t.mutations.map(t=>qs(e.yt,t)),n=le.fromMillis(t.localWriteTimeMs);return new Jn(t.batchId,n,r,a)}function di(e){const t=li(e.readTime),r=void 0!==e.lastLimboFreeSnapshotVersion?li(e.lastLimboFreeSnapshotVersion):ce.min();let a;return a=function(e){return void 0!==e.documents}(e.query)?function(e){const t=e.documents.length;return k(1===t,1966,{count:t}),Wa(Va(Rs(e.documents[0])))}(e.query):function(e){return Wa(Ks(e))}(e.query),new ai(a,e.targetId,"TargetPurposeListen",e.lastListenSequenceNumber,t,r,gr.fromBase64String(e.resumeToken))}function ui(e,t){const r=oi(t.snapshotVersion),a=oi(t.lastLimboFreeSnapshotVersion);let n;n=Ma(t.target)?Hs(e.yt,t.target):Gs(e.yt,t.target).ft;const s=t.resumeToken.toBase64();return{targetId:t.targetId,canonicalId:Fa(t.target),readTime:r,resumeToken:s,lastListenSequenceNumber:t.sequenceNumber,lastLimboFreeSnapshotVersion:a,query:n}}function hi(e){const t=Ks({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?Xa(t,t.limit,"L"):t}function mi(e,t){return new $n(t.largestBatchId,qs(e.yt,t.overlayMutation))}function fi(e,t){const r=t.path.lastSegment();return[e,We(t.path.popLast()),r]}function gi(e,t,r,a){return{indexId:e,uid:t,sequenceNumber:r,readTime:oi(a.readTime),documentKey:We(a.documentKey.path),largestBatchId:a.largestBatchId}}class pi{getBundleMetadata(e,t){return xi(e).get(t).next(e=>{if(e)return function(e){return{id:e.bundleId,createTime:li(e.createTime),version:e.version}}(e)})}saveBundleMetadata(e,t){return xi(e).put(function(e){return{bundleId:e.id,createTime:oi(Is(e.createTime)),version:e.version}}(t))}getNamedQuery(e,t){return yi(e).get(t).next(e=>{if(e)return function(e){return{name:e.name,query:hi(e.bundledQuery),readTime:li(e.readTime)}}(e)})}saveNamedQuery(e,t){return yi(e).put(function(e){return{name:e.name,readTime:oi(Is(e.readTime)),bundledQuery:e.bundledQuery}}(t))}}function xi(e){return rr(e,At)}function yi(e){return rr(e,Ct)}class vi{constructor(e,t){this.serializer=e,this.userId=t}static wt(e,t){const r=t.uid||"";return new vi(e,r)}getOverlay(e,t){return bi(e).get(fi(this.userId,t)).next(e=>e?mi(this.serializer,e):null)}getOverlays(e,t){const r=un();return Se.forEach(t,t=>this.getOverlay(e,t).next(e=>{null!==e&&r.set(t,e)})).next(()=>r)}saveOverlays(e,t,r){const a=[];return r.forEach((r,n)=>{const s=new $n(t,n);a.push(this.St(e,s))}),Se.waitFor(a)}removeOverlaysForBatchId(e,t,r){const a=new Set;t.forEach(e=>a.add(We(e.getCollectionPath())));const n=[];return a.forEach(t=>{const a=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,r+1],!1,!0);n.push(bi(e).Z(Vt,a))}),Se.waitFor(n)}getOverlaysForCollection(e,t,r){const a=un(),n=We(t),s=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return bi(e).J(Vt,s).next(e=>{for(const t of e){const e=mi(this.serializer,t);a.set(e.getKey(),e)}return a})}getOverlaysForCollectionGroup(e,t,r,a){const n=un();let s;const i=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return bi(e).ee({index:Ht,range:i},(e,t,r)=>{const i=mi(this.serializer,t);n.size()<a||i.largestBatchId===s?(n.set(i.getKey(),i),s=i.largestBatchId):r.done()}).next(()=>n)}St(e,t){return bi(e).put(function(e,t,r){const[a,n,s]=fi(t,r.mutation.key);return{userId:t,collectionPath:n,documentId:s,collectionGroup:r.mutation.key.getCollectionGroup(),largestBatchId:r.largestBatchId,overlayMutation:Vs(e.yt,r.mutation)}}(this.serializer,this.userId,t))}}function bi(e){return rr(e,zt)}class wi{bt(e){return rr(e,Wt)}getSessionToken(e){return this.bt(e).get("sessionToken").next(e=>{const t=null===e||void 0===e?void 0:e.value;return t?gr.fromUint8Array(t):gr.EMPTY_BYTE_STRING})}setSessionToken(e,t){return this.bt(e).put({name:"sessionToken",value:t.toUint8Array()})}}class ki{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(yr(e.integerValue));else if("doubleValue"in e){const r=yr(e.doubleValue);isNaN(r)?this.Ft(t,13):(this.Ft(t,15),qe(r)?t.Mt(0):t.Mt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Ft(t,20),"string"==typeof r&&(r=xr(r)),t.xt("".concat(r.seconds||"")),t.Mt(r.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(vr(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){const r=e.geoPointValue;this.Ft(t,45),t.Mt(r.latitude||0),t.Mt(r.longitude||0)}else"mapValue"in e?$r(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):Jr(e)?this.kt(e.mapValue,t):(this.qt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.Qt(e.arrayValue,t),this.Nt(t)):b(19022,{$t:e})}Ot(e,t){this.Ft(t,25),this.Ut(e,t)}Ut(e,t){t.xt(e)}qt(e,t){const r=e.fields||{};this.Ft(t,55);for(const a of Object.keys(r))this.Ot(a,t),this.Ct(r[a],t)}kt(e,t){var r;const a=e.fields||{};this.Ft(t,53);const n=Fr,s=(null===(r=a[n].arrayValue)||void 0===r||null===(r=r.values)||void 0===r?void 0:r.length)||0;this.Ft(t,15),t.Mt(yr(s)),this.Ot(n,t),this.Ct(a[n],t)}Qt(e,t){const r=e.values||[];this.Ft(t,50);for(const a of r)this.Ct(a,t)}Lt(e,t){this.Ft(t,37),Y.fromName(e).path.forEach(e=>{this.Ft(t,60),this.Ut(e,t)})}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}ki.Kt=new ki;const Ni=255;function ji(e){if(0===e)return 8;let t=0;return e>>4||(t+=4,e<<=4),e>>6||(t+=2,e<<=2),e>>7||(t+=1),t}function Si(e){const t=64-function(e){let t=0;for(let r=0;r<8;++r){const a=ji(255&e[r]);if(t+=a,8!==a)break}return t}(e);return Math.ceil(t/8)}class _i{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Gt(r.value),r=t.next();this.zt()}jt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Jt(r.value),r=t.next();this.Ht()}Yt(e){for(const t of e){const e=t.charCodeAt(0);if(e<128)this.Gt(e);else if(e<2048)this.Gt(960|e>>>6),this.Gt(128|63&e);else if(t<"\ud800"||"\udbff"<t)this.Gt(480|e>>>12),this.Gt(128|63&e>>>6),this.Gt(128|63&e);else{const e=t.codePointAt(0);this.Gt(240|e>>>18),this.Gt(128|63&e>>>12),this.Gt(128|63&e>>>6),this.Gt(128|63&e)}}this.zt()}Zt(e){for(const t of e){const e=t.charCodeAt(0);if(e<128)this.Jt(e);else if(e<2048)this.Jt(960|e>>>6),this.Jt(128|63&e);else if(t<"\ud800"||"\udbff"<t)this.Jt(480|e>>>12),this.Jt(128|63&e>>>6),this.Jt(128|63&e);else{const e=t.codePointAt(0);this.Jt(240|e>>>18),this.Jt(128|63&e>>>12),this.Jt(128|63&e>>>6),this.Jt(128|63&e)}}this.Ht()}Xt(e){const t=this.en(e),r=Si(t);this.tn(1+r),this.buffer[this.position++]=255&r;for(let a=t.length-r;a<t.length;++a)this.buffer[this.position++]=255&t[a]}nn(e){const t=this.en(e),r=Si(t);this.tn(1+r),this.buffer[this.position++]=~(255&r);for(let a=t.length-r;a<t.length;++a)this.buffer[this.position++]=~(255&t[a])}rn(){this.sn(Ni),this.sn(255)}_n(){this.an(Ni),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){const t=function(e){const t=new DataView(new ArrayBuffer(8));return t.setFloat64(0,e,!1),new Uint8Array(t.buffer)}(e),r=!!(128&t[0]);t[0]^=r?255:128;for(let a=1;a<t.length;++a)t[a]^=r?255:0;return t}Gt(e){const t=255&e;0===t?(this.sn(0),this.sn(255)):t===Ni?(this.sn(Ni),this.sn(0)):this.sn(t)}Jt(e){const t=255&e;0===t?(this.an(0),this.an(255)):t===Ni?(this.an(Ni),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){const t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);const a=new Uint8Array(r);a.set(this.buffer),this.buffer=a}}class Ei{constructor(e){this.cn=e}Bt(e){this.cn.Wt(e)}xt(e){this.cn.Yt(e)}Mt(e){this.cn.Xt(e)}vt(){this.cn.rn()}}class Ai{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}}class Ci{constructor(){this.cn=new _i,this.ln=new Ei(this.cn),this.hn=new Ai(this.cn)}seed(e){this.cn.seed(e)}Pn(e){return 0===e?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}}class Ii{constructor(e,t,r,a){this.Tn=e,this.In=t,this.En=r,this.dn=a}An(){const e=this.dn.length,t=0===e||255===this.dn[e-1]?e+1:e,r=new Uint8Array(t);return r.set(this.dn,0),t!==e?r.set([0],this.dn.length):++r[r.length-1],new Ii(this.Tn,this.In,this.En,r)}Rn(e,t,r){return{indexId:this.Tn,uid:e,arrayValue:Pi(this.En),directionalValue:Pi(this.dn),orderedDocumentKey:Pi(t),documentKey:r.path.toArray()}}Vn(e,t,r){const a=this.Rn(e,t,r);return[a.indexId,a.uid,a.arrayValue,a.directionalValue,a.orderedDocumentKey,a.documentKey]}}function Ti(e,t){let r=e.Tn-t.Tn;return 0!==r?r:(r=Di(e.En,t.En),0!==r?r:(r=Di(e.dn,t.dn),0!==r?r:Y.comparator(e.In,t.In)))}function Di(e,t){for(let r=0;r<e.length&&r<t.length;++r){const a=e[r]-t[r];if(0!==a)return a}return e.length-t.length}function Pi(e){return o.isSafariOrWebkit()?function(e){let t="";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t}(e):e}function Fi(e){return"string"!=typeof e?e:function(e){const t=new Uint8Array(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}(e)}class Li{constructor(e){this.mn=new dr((e,t)=>Q.comparator(e.field,t.field)),this.collectionId=null!=e.collectionGroup?e.collectionGroup:e.path.lastSegment(),this.fn=e.orderBy,this.gn=[];for(const t of e.filters){const e=t;e.isInequality()?this.mn=this.mn.add(e):this.gn.push(e)}}get pn(){return this.mn.size>1}yn(e){if(k(e.collectionGroup===this.collectionId,49279),this.pn)return!1;const t=he(e);if(void 0!==t&&!this.wn(t))return!1;const r=me(e);let a=new Set,n=0,s=0;for(;n<r.length&&this.wn(r[n]);++n)a=a.add(r[n].fieldPath.canonicalString());if(n===r.length)return!0;if(this.mn.size>0){const e=this.mn.getIterator().getNext();if(!a.has(e.field.canonicalString())){const t=r[n];if(!this.Sn(e,t)||!this.bn(this.fn[s++],t))return!1}++n}for(;n<r.length;++n){const e=r[n];if(s>=this.fn.length||!this.bn(this.fn[s++],e))return!1}return!0}Dn(){if(this.pn)return null;let e=new dr(Q.comparator);const t=[];for(const r of this.gn)if(!r.field.isKeyField())if("array-contains"===r.op||"array-contains-any"===r.op)t.push(new ge(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new ge(r.field,0))}for(const r of this.fn)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new ge(r.field,"asc"===r.dir?0:1)));return new ue(ue.UNKNOWN_ID,this.collectionId,t,xe.empty())}wn(e){for(const t of this.gn)if(this.Sn(t,e))return!0;return!1}Sn(e,t){if(void 0===e||!e.field.isEqual(t.fieldPath))return!1;const r="array-contains"===e.op||"array-contains-any"===e.op;return 2===t.kind===r}bn(e,t){return!!e.field.isEqual(t.fieldPath)&&(0===t.kind&&"asc"===e.dir||1===t.kind&&"desc"===e.dir)}}function Mi(e){if(k(e instanceof fa||e instanceof ga,20012),e instanceof fa){if(e instanceof Ca){var t;const r=(null===(t=e.value.arrayValue)||void 0===t||null===(t=t.values)||void 0===t?void 0:t.map(t=>fa.create(e.field,"==",t)))||[];return ga.create(r,"or")}return e}const r=e.filters.map(e=>Mi(e));return ga.create(r,e.op)}function Ri(e){if(0===e.getFilters().length)return[];const t=Ui(Mi(e));return k(zi(t),7391),Oi(t)||Bi(t)?[t]:t.getFilters()}function Oi(e){return e instanceof fa}function Bi(e){return e instanceof ga&&ya(e)}function zi(e){return Oi(e)||Bi(e)||function(e){if(e instanceof ga&&xa(e)){for(const t of e.getFilters())if(!Oi(t)&&!Bi(t))return!1;return!0}return!1}(e)}function Ui(e){if(k(e instanceof fa||e instanceof ga,34018),e instanceof fa)return e;if(1===e.filters.length)return Ui(e.filters[0]);const t=e.filters.map(e=>Ui(e));let r=ga.create(t,e.op);return r=Hi(r),zi(r)?r:(k(r instanceof ga,64498),k(pa(r),40251),k(r.filters.length>1,57927),r.filters.reduce((e,t)=>Vi(e,t)))}function Vi(e,t){let r;return k(e instanceof fa||e instanceof ga,38388),k(t instanceof fa||t instanceof ga,25473),r=e instanceof fa?t instanceof fa?function(e,t){return ga.create([e,t],"and")}(e,t):qi(e,t):t instanceof fa?qi(t,e):function(e,t){if(k(e.filters.length>0&&t.filters.length>0,48005),pa(e)&&pa(t))return ka(e,t.getFilters());const r=xa(e)?e:t,a=xa(e)?t:e,n=r.filters.map(e=>Vi(e,a));return ga.create(n,"or")}(e,t),Hi(r)}function qi(e,t){if(pa(t))return ka(t,e.getFilters());{const r=t.filters.map(t=>Vi(e,t));return ga.create(r,"or")}}function Hi(e){if(k(e instanceof fa||e instanceof ga,11850),e instanceof fa)return e;const t=e.getFilters();if(1===t.length)return Hi(t[0]);if(va(e))return e;const r=t.map(e=>Hi(e)),a=[];return r.forEach(t=>{t instanceof fa?a.push(t):t instanceof ga&&(t.op===e.op?a.push(...t.filters):a.push(t))}),1===a.length?a[0]:ga.create(a,e.op)}class Gi{constructor(){this.Cn=new Wi}addToCollectionParentIndex(e,t){return this.Cn.add(t),Se.resolve()}getCollectionParents(e,t){return Se.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return Se.resolve()}deleteFieldIndex(e,t){return Se.resolve()}deleteAllFieldIndexes(e){return Se.resolve()}createTargetIndexes(e,t){return Se.resolve()}getDocumentsMatchingTarget(e,t){return Se.resolve(null)}getIndexType(e,t){return Se.resolve(0)}getFieldIndexes(e,t){return Se.resolve([])}getNextCollectionGroupToUpdate(e){return Se.resolve(null)}getMinOffset(e,t){return Se.resolve(be.min())}getMinOffsetFromCollectionGroup(e,t){return Se.resolve(be.min())}updateCollectionGroup(e,t,r){return Se.resolve()}updateIndexEntries(e,t){return Se.resolve()}}class Wi{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),a=this.index[t]||new dr(W.comparator),n=!a.has(r);return this.index[t]=a.add(r),n}has(e){const t=e.lastSegment(),r=e.popLast(),a=this.index[t];return a&&a.has(r)}getEntries(e){return(this.index[e]||new dr(W.comparator)).toArray()}}const Ki="IndexedDbIndexManager",Qi=new Uint8Array(0);class Yi{constructor(e,t){this.databaseId=t,this.vn=new Wi,this.Fn=new nn(e=>Fa(e),(e,t)=>La(e,t)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.vn.has(t)){const r=t.lastSegment(),a=t.popLast();e.addOnCommittedListener(()=>{this.vn.add(t)});const n={collectionId:r,parent:We(a)};return Xi(e).put(n)}return Se.resolve()}getCollectionParents(e,t){const r=[],a=IDBKeyRange.bound([t,""],[q(t),""],!1,!0);return Xi(e).J(a).next(e=>{for(const a of e){if(a.collectionId!==t)break;r.push(Ye(a.parent))}return r})}addFieldIndex(e,t){const r=Zi(e),a=function(e){return{indexId:e.indexId,collectionGroup:e.collectionGroup,fields:e.fields.map(e=>[e.fieldPath.canonicalString(),e.kind])}}(t);delete a.indexId;const n=r.add(a);if(t.indexState){const r=$i(e);return n.next(e=>{r.put(gi(e,this.uid,t.indexState.sequenceNumber,t.indexState.offset))})}return n.next()}deleteFieldIndex(e,t){const r=Zi(e),a=$i(e),n=Ji(e);return r.delete(t.indexId).next(()=>a.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>n.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const t=Zi(e),r=Ji(e),a=$i(e);return t.Z().next(()=>r.Z()).next(()=>a.Z())}createTargetIndexes(e,t){return Se.forEach(this.Mn(t),t=>this.getIndexType(e,t).next(r=>{if(0===r||1===r){const r=new Li(t).Dn();if(null!=r)return this.addFieldIndex(e,r)}}))}getDocumentsMatchingTarget(e,t){const r=Ji(e);let a=!0;const n=new Map;return Se.forEach(this.Mn(t),t=>this.xn(e,t).next(e=>{a&&(a=!!e),n.set(t,e)})).next(()=>{if(a){let e=pn();const a=[];return Se.forEach(n,(n,s)=>{p(Ki,"Using index ".concat(function(e){return"id=".concat(e.indexId,"|cg=").concat(e.collectionGroup,"|f=").concat(e.fields.map(e=>"".concat(e.fieldPath,":").concat(e.kind)).join(","))}(n)," to execute ").concat(Fa(t)));const i=function(e,t){const r=he(t);if(void 0===r)return null;for(const a of Ra(e,r.fieldPath))switch(a.op){case"array-contains-any":return a.value.arrayValue.values||[];case"array-contains":return[a.value]}return null}(s,n),o=function(e,t){const r=new Map;for(const a of me(t))for(const t of Ra(e,a.fieldPath))switch(t.op){case"==":case"in":r.set(a.fieldPath.canonicalString(),t.value);break;case"not-in":case"!=":return r.set(a.fieldPath.canonicalString(),t.value),Array.from(r.values())}return null}(s,n),l=function(e,t){const r=[];let a=!0;for(const n of me(t)){const t=0===n.kind?Oa(e,n.fieldPath,e.startAt):Ba(e,n.fieldPath,e.startAt);r.push(t.value),a&&(a=t.inclusive)}return new la(r,a)}(s,n),c=function(e,t){const r=[];let a=!0;for(const n of me(t)){const t=0===n.kind?Ba(e,n.fieldPath,e.endAt):Oa(e,n.fieldPath,e.endAt);r.push(t.value),a&&(a=t.inclusive)}return new la(r,a)}(s,n),d=this.On(n,s,l),u=this.On(n,s,c),h=this.Nn(n,s,o),m=this.Bn(n.indexId,i,d,l.inclusive,u,c.inclusive,h);return Se.forEach(m,n=>r.Y(n,t.limit).next(t=>{t.forEach(t=>{const r=Y.fromSegments(t.documentKey);e.has(r)||(e=e.add(r),a.push(r))})}))}).next(()=>a)}return Se.resolve(null)})}Mn(e){let t=this.Fn.get(e);return t||(t=0===e.filters.length?[e]:Ri(ga.create(e.filters,"and")).map(t=>Pa(e.path,e.collectionGroup,e.orderBy,t.getFilters(),e.limit,e.startAt,e.endAt)),this.Fn.set(e,t),t)}Bn(e,t,r,a,n,s,i){const o=(null!=t?t.length:1)*Math.max(r.length,n.length),l=o/(null!=t?t.length:1),c=[];for(let d=0;d<o;++d){const o=t?this.Ln(t[d/l]):Qi,u=this.kn(e,o,r[d%l],a),h=this.qn(e,o,n[d%l],s),m=i.map(t=>this.kn(e,o,t,!0));c.push(...this.createRange(u,h,m))}return c}kn(e,t,r,a){const n=new Ii(e,Y.empty(),t,r);return a?n:n.An()}qn(e,t,r,a){const n=new Ii(e,Y.empty(),t,r);return a?n.An():n}xn(e,t){const r=new Li(t),a=null!=t.collectionGroup?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,a).next(e=>{let t=null;for(const a of e)r.yn(a)&&(!t||a.fields.length>t.fields.length)&&(t=a);return t})}getIndexType(e,t){let r=2;const a=this.Mn(t);return Se.forEach(a,t=>this.xn(e,t).next(e=>{e?0!==r&&e.fields.length<function(e){let t=new dr(Q.comparator),r=!1;for(const a of e.filters)for(const e of a.getFlattenedFilters())e.field.isKeyField()||("array-contains"===e.op||"array-contains-any"===e.op?r=!0:t=t.add(e.field));for(const a of e.orderBy)a.field.isKeyField()||(t=t.add(a.field));return t.size+(r?1:0)}(t)&&(r=1):r=0})).next(()=>function(e){return null!==e.limit}(t)&&a.length>1&&2===r?1:r)}Qn(e,t){const r=new Ci;for(const a of me(e)){const e=t.data.field(a.fieldPath);if(null==e)return null;const n=r.Pn(a.kind);ki.Kt.Dt(e,n)}return r.un()}Ln(e){const t=new Ci;return ki.Kt.Dt(e,t.Pn(0)),t.un()}$n(e,t){const r=new Ci;return ki.Kt.Dt(Gr(this.databaseId,t),r.Pn(function(e){const t=me(e);return 0===t.length?0:t[t.length-1].kind}(e))),r.un()}Nn(e,t,r){if(null===r)return[];let a=[];a.push(new Ci);let n=0;for(const s of me(e)){const e=r[n++];for(const r of a)if(this.Un(t,s.fieldPath)&&Kr(e))a=this.Kn(a,s,e);else{const t=r.Pn(s.kind);ki.Kt.Dt(e,t)}}return this.Wn(a)}On(e,t,r){return this.Nn(e,t,r.position)}Wn(e){const t=[];for(let r=0;r<e.length;++r)t[r]=e[r].un();return t}Kn(e,t,r){const a=[...e],n=[];for(const s of r.arrayValue.values||[])for(const e of a){const r=new Ci;r.seed(e.un()),ki.Kt.Dt(s,r.Pn(t.kind)),n.push(r)}return n}Un(e,t){return!!e.filters.find(e=>e instanceof fa&&e.field.isEqual(t)&&("in"===e.op||"not-in"===e.op))}getFieldIndexes(e,t){const r=Zi(e),a=$i(e);return(t?r.J(Tt,IDBKeyRange.bound(t,t)):r.J()).next(e=>{const t=[];return Se.forEach(e,e=>a.get([e.indexId,this.uid]).next(r=>{t.push(function(e,t){const r=t?new xe(t.sequenceNumber,new be(li(t.readTime),new Y(Ye(t.documentKey)),t.largestBatchId)):xe.empty(),a=e.fields.map(e=>{let[t,r]=e;return new ge(Q.fromServerFormat(t),r)});return new ue(e.indexId,e.collectionGroup,a,r)}(e,r))})).next(()=>t)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(e=>0===e.length?null:(e.sort((e,t)=>{const r=e.indexState.sequenceNumber-t.indexState.sequenceNumber;return 0!==r?r:R(e.collectionGroup,t.collectionGroup)}),e[0].collectionGroup))}updateCollectionGroup(e,t,r){const a=Zi(e),n=$i(e);return this.Gn(e).next(e=>a.J(Tt,IDBKeyRange.bound(t,t)).next(t=>Se.forEach(t,t=>n.put(gi(t.indexId,this.uid,e,r)))))}updateIndexEntries(e,t){const r=new Map;return Se.forEach(t,(t,a)=>{const n=r.get(t.collectionGroup);return(n?Se.resolve(n):this.getFieldIndexes(e,t.collectionGroup)).next(n=>(r.set(t.collectionGroup,n),Se.forEach(n,r=>this.zn(e,t,r).next(t=>{const n=this.jn(a,r);return t.isEqual(n)?Se.resolve():this.Jn(e,a,r,t,n)}))))})}Hn(e,t,r,a){return Ji(e).put(a.Rn(this.uid,this.$n(r,t.key),t.key))}Yn(e,t,r,a){return Ji(e).delete(a.Vn(this.uid,this.$n(r,t.key),t.key))}zn(e,t,r){const a=Ji(e);let n=new dr(Ti);return a.ee({index:Ot,range:IDBKeyRange.only([r.indexId,this.uid,Pi(this.$n(r,t))])},(e,a)=>{n=n.add(new Ii(r.indexId,t,Fi(a.arrayValue),Fi(a.directionalValue)))}).next(()=>n)}jn(e,t){let r=new dr(Ti);const a=this.Qn(t,e);if(null==a)return r;const n=he(t);if(null!=n){const s=e.data.field(n.fieldPath);if(Kr(s))for(const n of s.arrayValue.values||[])r=r.add(new Ii(t.indexId,e.key,this.Ln(n),a))}else r=r.add(new Ii(t.indexId,e.key,Qi,a));return r}Jn(e,t,r,a,n){p(Ki,"Updating index entries for document '%s'",t.key);const s=[];return function(e,t,r,a,n){const s=e.getIterator(),i=t.getIterator();let o=hr(s),l=hr(i);for(;o||l;){let e=!1,t=!1;if(o&&l){const a=r(o,l);a<0?t=!0:a>0&&(e=!0)}else null!=o?t=!0:e=!0;e?(a(l),l=hr(i)):t?(n(o),o=hr(s)):(o=hr(s),l=hr(i))}}(a,n,Ti,a=>{s.push(this.Hn(e,t,r,a))},a=>{s.push(this.Yn(e,t,r,a))}),Se.waitFor(s)}Gn(e){let t=1;return $i(e).ee({index:Ft,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(e,r,a)=>{a.done(),t=r.sequenceNumber+1}).next(()=>t)}createRange(e,t,r){r=r.sort((e,t)=>Ti(e,t)).filter((e,t,r)=>!t||0!==Ti(e,r[t-1]));const a=[];a.push(e);for(const s of r){const r=Ti(s,e),n=Ti(s,t);if(0===r)a[0]=e.An();else if(r>0&&n<0)a.push(s),a.push(s.An());else if(n>0)break}a.push(t);const n=[];for(let s=0;s<a.length;s+=2){if(this.Zn(a[s],a[s+1]))return[];const e=a[s].Vn(this.uid,Qi,Y.empty()),t=a[s+1].Vn(this.uid,Qi,Y.empty());n.push(IDBKeyRange.bound(e,t))}return n}Zn(e,t){return Ti(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(eo)}getMinOffset(e,t){return Se.mapArray(this.Mn(t),t=>this.xn(e,t).next(e=>e||b(44426))).next(eo)}}function Xi(e){return rr(e,St)}function Ji(e){return rr(e,Mt)}function Zi(e){return rr(e,It)}function $i(e){return rr(e,Dt)}function eo(e){k(0!==e.length,28825);let t=e[0].indexState.offset,r=t.largestBatchId;for(let a=1;a<e.length;a++){const n=e[a].indexState.offset;we(n,t)<0&&(t=n),r<n.largestBatchId&&(r=n.largestBatchId)}return new be(t.readTime,t.documentKey,r)}const to={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},ro=41943040;class ao{static withCacheSize(e){return new ao(e,ao.DEFAULT_COLLECTION_PERCENTILE,ao.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}}function no(e,t,r){const a=e.store(et),n=e.store(ot),s=[],i=IDBKeyRange.only(r.batchId);let o=0;const l=a.ee({range:i},(e,t,r)=>(o++,r.delete()));s.push(l.next(()=>{k(1===o,47070,{batchId:r.batchId})}));const c=[];for(const d of r.mutations){const e=st(t,d.key.path,r.batchId);s.push(n.delete(e)),c.push(d.key)}return Se.waitFor(s).next(()=>c)}function so(e){if(!e)return 0;let t;if(e.document)t=e.document;else if(e.unknownDocument)t=e.unknownDocument;else{if(!e.noDocument)throw b(14731);t=e.noDocument}return JSON.stringify(t).length}ao.DEFAULT_COLLECTION_PERCENTILE=10,ao.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,ao.DEFAULT=new ao(ro,ao.DEFAULT_COLLECTION_PERCENTILE,ao.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),ao.DISABLED=new ao(-1,0,0);class io{constructor(e,t,r,a){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=a,this.Xn={}}static wt(e,t,r,a){k(""!==e.uid,64387);const n=e.isAuthenticated()?e.uid:"";return new io(n,t,r,a)}checkEmpty(e){let t=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return lo(e).ee({index:rt,range:r},(e,r,a)=>{t=!1,a.done()}).next(()=>t)}addMutationBatch(e,t,r,a){const n=co(e),s=lo(e);return s.add({}).next(i=>{k("number"==typeof i,49019);const o=new Jn(i,t,r,a),l=function(e,t,r){const a=r.baseMutations.map(t=>Vs(e.yt,t)),n=r.mutations.map(t=>Vs(e.yt,t));return{userId:t,batchId:r.batchId,localWriteTimeMs:r.localWriteTime.toMillis(),baseMutations:a,mutations:n}}(this.serializer,this.userId,o),c=[];let d=new dr((e,t)=>R(e.canonicalString(),t.canonicalString()));for(const e of a){const t=st(this.userId,e.key.path,i);d=d.add(e.key.path.popLast()),c.push(s.put(l)),c.push(n.put(t,it))}return d.forEach(t=>{c.push(this.indexManager.addToCollectionParentIndex(e,t))}),e.addOnCommittedListener(()=>{this.Xn[i]=o.keys()}),Se.waitFor(c).next(()=>o)})}lookupMutationBatch(e,t){return lo(e).get(t).next(e=>e?(k(e.userId===this.userId,48,"Unexpected user for mutation batch",{userId:e.userId,batchId:t}),ci(this.serializer,e)):null)}er(e,t){return this.Xn[t]?Se.resolve(this.Xn[t]):this.lookupMutationBatch(e,t).next(e=>{if(e){const r=e.keys();return this.Xn[t]=r,r}return null})}getNextMutationBatchAfterBatchId(e,t){const r=t+1,a=IDBKeyRange.lowerBound([this.userId,r]);let n=null;return lo(e).ee({index:rt,range:a},(e,t,a)=>{t.userId===this.userId&&(k(t.batchId>=r,47524,{tr:r}),n=ci(this.serializer,t)),a.done()}).next(()=>n)}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=Ue;return lo(e).ee({index:rt,range:t,reverse:!0},(e,t,a)=>{r=t.batchId,a.done()}).next(()=>r)}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,Ue],[this.userId,Number.POSITIVE_INFINITY]);return lo(e).J(rt,t).next(e=>e.map(e=>ci(this.serializer,e)))}getAllMutationBatchesAffectingDocumentKey(e,t){const r=nt(this.userId,t.path),a=IDBKeyRange.lowerBound(r),n=[];return co(e).ee({range:a},(r,a,s)=>{const[i,o,l]=r,c=Ye(o);if(i===this.userId&&t.path.isEqual(c))return lo(e).get(l).next(e=>{if(!e)throw b(61480,{nr:r,batchId:l});k(e.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:e.userId,batchId:l}),n.push(ci(this.serializer,e))});s.done()}).next(()=>n)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new dr(R);const a=[];return t.forEach(t=>{const n=nt(this.userId,t.path),s=IDBKeyRange.lowerBound(n),i=co(e).ee({range:s},(e,a,n)=>{const[s,i,o]=e,l=Ye(i);s===this.userId&&t.path.isEqual(l)?r=r.add(o):n.done()});a.push(i)}),Se.waitFor(a).next(()=>this.rr(e,r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,a=r.length+1,n=nt(this.userId,r),s=IDBKeyRange.lowerBound(n);let i=new dr(R);return co(e).ee({range:s},(e,t,n)=>{const[s,o,l]=e,c=Ye(o);s===this.userId&&r.isPrefixOf(c)?c.length===a&&(i=i.add(l)):n.done()}).next(()=>this.rr(e,i))}rr(e,t){const r=[],a=[];return t.forEach(t=>{a.push(lo(e).get(t).next(e=>{if(null===e)throw b(35274,{batchId:t});k(e.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:e.userId,batchId:t}),r.push(ci(this.serializer,e))}))}),Se.waitFor(a).next(()=>r)}removeMutationBatch(e,t){return no(e.le,this.userId,t).next(r=>(e.addOnCommittedListener(()=>{this.ir(t.batchId)}),Se.forEach(r,t=>this.referenceDelegate.markPotentiallyOrphaned(e,t))))}ir(e){delete this.Xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return Se.resolve();const r=IDBKeyRange.lowerBound(function(e){return[e]}(this.userId)),a=[];return co(e).ee({range:r},(e,t,r)=>{if(e[0]===this.userId){const t=Ye(e[1]);a.push(t)}else r.done()}).next(()=>{k(0===a.length,56720,{sr:a.map(e=>e.canonicalString())})})})}containsKey(e,t){return oo(e,this.userId,t)}_r(e){return uo(e).get(this.userId).next(e=>e||{userId:this.userId,lastAcknowledgedBatchId:Ue,lastStreamToken:""})}}function oo(e,t,r){const a=nt(t,r.path),n=a[1],s=IDBKeyRange.lowerBound(a);let i=!1;return co(e).ee({range:s,X:!0},(e,r,a)=>{const[s,o,l]=e;s===t&&o===n&&(i=!0),a.done()}).next(()=>i)}function lo(e){return rr(e,et)}function co(e){return rr(e,ot)}function uo(e){return rr(e,$e)}class ho{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new ho(0)}static cr(){return new ho(-1)}}class mo{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.lr(e).next(t=>{const r=new ho(t.highestTargetId);return t.highestTargetId=r.next(),this.hr(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.lr(e).next(e=>ce.fromTimestamp(new le(e.lastRemoteSnapshotVersion.seconds,e.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.lr(e).next(e=>e.highestListenSequenceNumber)}setTargetsMetadata(e,t,r){return this.lr(e).next(a=>(a.highestListenSequenceNumber=t,r&&(a.lastRemoteSnapshotVersion=r.toTimestamp()),t>a.highestListenSequenceNumber&&(a.highestListenSequenceNumber=t),this.hr(e,a)))}addTargetData(e,t){return this.Pr(e,t).next(()=>this.lr(e).next(r=>(r.targetCount+=1,this.Tr(t,r),this.hr(e,r))))}updateTargetData(e,t){return this.Pr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>fo(e).delete(t.targetId)).next(()=>this.lr(e)).next(t=>(k(t.targetCount>0,8065),t.targetCount-=1,this.hr(e,t)))}removeTargets(e,t,r){let a=0;const n=[];return fo(e).ee((s,i)=>{const o=di(i);o.sequenceNumber<=t&&null===r.get(o.targetId)&&(a++,n.push(this.removeTargetData(e,o)))}).next(()=>Se.waitFor(n)).next(()=>a)}forEachTarget(e,t){return fo(e).ee((e,r)=>{const a=di(r);t(a)})}lr(e){return go(e).get(Nt).next(e=>(k(null!==e,2888),e))}hr(e,t){return go(e).put(Nt,t)}Pr(e,t){return fo(e).put(ui(this.serializer,t))}Tr(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.lr(e).next(e=>e.targetCount)}getTargetData(e,t){const r=Fa(t),a=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let n=null;return fo(e).ee({range:a,index:xt},(e,r,a)=>{const s=di(r);La(t,s.target)&&(n=s,a.done())}).next(()=>n)}addMatchingKeys(e,t,r){const a=[],n=po(e);return t.forEach(t=>{const s=We(t.path);a.push(n.put({targetId:r,path:s})),a.push(this.referenceDelegate.addReference(e,r,t))}),Se.waitFor(a)}removeMatchingKeys(e,t,r){const a=po(e);return Se.forEach(t,t=>{const n=We(t.path);return Se.waitFor([a.delete([r,n]),this.referenceDelegate.removeReference(e,r,t)])})}removeMatchingKeysForTargetId(e,t){const r=po(e),a=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(a)}getMatchingKeysForTargetId(e,t){const r=IDBKeyRange.bound([t],[t+1],!1,!0),a=po(e);let n=pn();return a.ee({range:r,X:!0},(e,t,r)=>{const a=Ye(e[1]),s=new Y(a);n=n.add(s)}).next(()=>n)}containsKey(e,t){const r=We(t.path),a=IDBKeyRange.bound([r],[q(r)],!1,!0);let n=0;return po(e).ee({index:wt,X:!0,range:a},(e,t,r)=>{let[a,s]=e;0!==a&&(n++,r.done())}).next(()=>n>0)}At(e,t){return fo(e).get(t).next(e=>e?di(e):null)}}function fo(e){return rr(e,pt)}function go(e){return rr(e,jt)}function po(e){return rr(e,vt)}const xo="LruGarbageCollector",yo=1048576;function vo(e,t){let[r,a]=e,[n,s]=t;const i=R(r,n);return 0===i?R(a,s):i}class bo{constructor(e){this.Ir=e,this.buffer=new dr(vo),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const e=this.buffer.last();vo(t,e)<0&&(this.buffer=this.buffer.delete(e).add(t))}}get maxValue(){return this.buffer.last()[0]}}class wo{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Rr=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return null!==this.Rr}Vr(e){p(xo,"Garbage collection scheduled in ".concat(e,"ms")),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(e){De(e)?p(xo,"Ignoring IndexedDB error during garbage collection: ",e):await je(e)}await this.Vr(3e5)})}}class ko{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next(e=>Math.floor(t/100*e))}nthSequenceNumber(e,t){if(0===t)return Se.resolve(ze.ce);const r=new bo(t);return this.mr.forEachTarget(e,e=>r.Ar(e.sequenceNumber)).next(()=>this.mr.pr(e,e=>r.Ar(e))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.mr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return-1===this.params.cacheSizeCollectionThreshold?(p("LruGarbageCollector","Garbage collection skipped; disabled"),Se.resolve(to)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(p("LruGarbageCollector","Garbage collection skipped; Cache size ".concat(r," is lower than threshold ").concat(this.params.cacheSizeCollectionThreshold)),to):this.yr(e,t))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let r,a,n,s,o,l,c;const d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(t=>(t>this.params.maximumSequenceNumbersToCollect?(p("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of ".concat(this.params.maximumSequenceNumbersToCollect," from ").concat(t)),a=this.params.maximumSequenceNumbersToCollect):a=t,s=Date.now(),this.nthSequenceNumber(e,a))).next(a=>(r=a,o=Date.now(),this.removeTargets(e,r,t))).next(t=>(n=t,l=Date.now(),this.removeOrphanedDocuments(e,r))).next(e=>(c=Date.now(),g()<=i.LogLevel.DEBUG&&p("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in ".concat(s-d,"ms\n\tDetermined least recently used ").concat(a," in ")+(o-s)+"ms\n"+"\tRemoved ".concat(n," targets in ")+(l-o)+"ms\n"+"\tRemoved ".concat(e," documents in ")+(c-l)+"ms\n"+"Total Duration: ".concat(c-d,"ms")),Se.resolve({didRun:!0,sequenceNumbersCollected:a,targetsRemoved:n,documentsRemoved:e})))}}function No(e,t){return new ko(e,t)}class jo{constructor(e,t){this.db=e,this.garbageCollector=No(this,t)}gr(e){const t=this.wr(e);return this.db.getTargetCache().getTargetCount(e).next(e=>t.next(t=>e+t))}wr(e){let t=0;return this.pr(e,e=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}pr(e,t){return this.Sr(e,(e,r)=>t(r))}addReference(e,t,r){return So(e,r)}removeReference(e,t,r){return So(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return So(e,t)}br(e,t){return function(e,t){let r=!1;return uo(e).te(a=>oo(e,a,t).next(e=>(e&&(r=!0),Se.resolve(!e)))).next(()=>r)}(e,t)}removeOrphanedDocuments(e,t){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),a=[];let n=0;return this.Sr(e,(s,i)=>{if(i<=t){const t=this.br(e,s).next(t=>{if(!t)return n++,r.getEntry(e,s).next(()=>(r.removeEntry(s,ce.min()),po(e).delete(function(e){return[0,We(e.path)]}(s))))});a.push(t)}}).next(()=>Se.waitFor(a)).next(()=>r.apply(e)).next(()=>n)}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return So(e,t)}Sr(e,t){const r=po(e);let a,n=ze.ce;return r.ee({index:wt},(e,r)=>{let[s,i]=e,{path:o,sequenceNumber:l}=r;0===s?(n!==ze.ce&&t(new Y(Ye(a)),n),n=l,a=o):n=ze.ce}).next(()=>{n!==ze.ce&&t(new Y(Ye(a)),n)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function So(e,t){return po(e).put(function(e,t){return{targetId:0,path:We(e.path),sequenceNumber:t}}(t,e.currentSequenceNumber))}class _o{constructor(){this.changes=new nn(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,oa.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return void 0!==r?Se.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class Eo{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return To(e).put(r)}removeEntry(e,t,r){return To(e).delete(function(e,t){const r=e.path.toArray();return[r.slice(0,r.length-2),r[r.length-2],ii(t),r[r.length-1]]}(t,r))}updateMetadata(e,t){return this.getMetadata(e).next(r=>(r.byteSize+=t,this.Dr(e,r)))}getEntry(e,t){let r=oa.newInvalidDocument(t);return To(e).ee({index:dt,range:IDBKeyRange.only(Do(t))},(e,a)=>{r=this.Cr(t,a)}).next(()=>r)}vr(e,t){let r={size:0,document:oa.newInvalidDocument(t)};return To(e).ee({index:dt,range:IDBKeyRange.only(Do(t))},(e,a)=>{r={document:this.Cr(t,a),size:so(a)}}).next(()=>r)}getEntries(e,t){let r=on();return this.Fr(e,t,(e,t)=>{const a=this.Cr(e,t);r=r.insert(e,a)}).next(()=>r)}Mr(e,t){let r=on(),a=new or(Y.comparator);return this.Fr(e,t,(e,t)=>{const n=this.Cr(e,t);r=r.insert(e,n),a=a.insert(e,so(t))}).next(()=>({documents:r,Or:a}))}Fr(e,t,r){if(t.isEmpty())return Se.resolve();let a=new dr(Fo);t.forEach(e=>a=a.add(e));const n=IDBKeyRange.bound(Do(a.first()),Do(a.last())),s=a.getIterator();let i=s.getNext();return To(e).ee({index:dt,range:n},(e,t,a)=>{const n=Y.fromSegments([...t.prefixPath,t.collectionGroup,t.documentId]);for(;i&&Fo(i,n)<0;)r(i,null),i=s.getNext();i&&i.isEqual(n)&&(r(i,t),i=s.hasNext()?s.getNext():null),i?a.j(Do(i)):a.done()}).next(()=>{for(;i;)r(i,null),i=s.hasNext()?s.getNext():null})}getDocumentsMatchingQuery(e,t,r,a,n){const s=t.path,i=[s.popLast().toArray(),s.lastSegment(),ii(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],o=[s.popLast().toArray(),s.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return To(e).J(IDBKeyRange.bound(i,o,!0)).next(e=>{null===n||void 0===n||n.incrementDocumentReadCount(e.length);let r=on();for(const n of e){const e=this.Cr(Y.fromSegments(n.prefixPath.concat(n.collectionGroup,n.documentId)),n);e.isFoundDocument()&&(en(t,e)||a.has(e.key))&&(r=r.insert(e.key,e))}return r})}getAllFromCollectionGroup(e,t,r,a){let n=on();const s=Po(t,r),i=Po(t,be.max());return To(e).ee({index:ht,range:IDBKeyRange.bound(s,i,!0)},(e,t,r)=>{const s=this.Cr(Y.fromSegments(t.prefixPath.concat(t.collectionGroup,t.documentId)),t);n=n.insert(s.key,s),n.size===a&&r.done()}).next(()=>n)}newChangeBuffer(e){return new Co(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(e=>e.byteSize)}getMetadata(e){return Io(e).get(gt).next(e=>(k(!!e,20021),e))}Dr(e,t){return Io(e).put(gt,t)}Cr(e,t){if(t){const e=function(e,t){let r;if(t.document)r=Us(e.yt,t.document,!!t.hasCommittedMutations);else if(t.noDocument){const e=Y.fromSegments(t.noDocument.path),a=li(t.noDocument.readTime);r=oa.newNoDocument(e,a),t.hasCommittedMutations&&r.setHasCommittedMutations()}else{if(!t.unknownDocument)return b(56709);{const e=Y.fromSegments(t.unknownDocument.path),a=li(t.unknownDocument.version);r=oa.newUnknownDocument(e,a)}}return t.readTime&&r.setReadTime(function(e){const t=new le(e[0],e[1]);return ce.fromTimestamp(t)}(t.readTime)),r}(this.serializer,t);if(!e.isNoDocument()||!e.version.isEqual(ce.min()))return e}return oa.newInvalidDocument(e)}}function Ao(e){return new Eo(e)}class Co extends _o{constructor(e,t){super(),this.Nr=e,this.trackRemovals=t,this.Br=new nn(e=>e.toString(),(e,t)=>e.isEqual(t))}applyChanges(e){const t=[];let r=0,a=new dr((e,t)=>R(e.canonicalString(),t.canonicalString()));return this.changes.forEach((n,s)=>{const i=this.Br.get(n);if(t.push(this.Nr.removeEntry(e,n,i.readTime)),s.isValidDocument()){const o=si(this.Nr.serializer,s);a=a.add(n.path.popLast());const l=so(o);r+=l-i.size,t.push(this.Nr.addEntry(e,n,o))}else if(r-=i.size,this.trackRemovals){const r=si(this.Nr.serializer,s.convertToNoDocument(ce.min()));t.push(this.Nr.addEntry(e,n,r))}}),a.forEach(r=>{t.push(this.Nr.indexManager.addToCollectionParentIndex(e,r))}),t.push(this.Nr.updateMetadata(e,r)),Se.waitFor(t)}getFromCache(e,t){return this.Nr.vr(e,t).next(e=>(this.Br.set(t,{size:e.size,readTime:e.document.readTime}),e.document))}getAllFromCache(e,t){return this.Nr.Mr(e,t).next(e=>{let{documents:t,Or:r}=e;return r.forEach((e,r)=>{this.Br.set(e,{size:r,readTime:t.get(e).readTime})}),t})}}function Io(e){return rr(e,ft)}function To(e){return rr(e,lt)}function Do(e){const t=e.path.toArray();return[t.slice(0,t.length-2),t[t.length-2],t[t.length-1]]}function Po(e,t){const r=t.documentKey.path.toArray();return[e,ii(t.readTime),r.slice(0,r.length-2),r.length>0?r[r.length-1]:""]}function Fo(e,t){const r=e.path.toArray(),a=t.path.toArray();let n=0;for(let s=0;s<r.length-2&&s<a.length-2;++s)if(n=R(r[s],a[s]),n)return n;return n=R(r.length,a.length),n||(n=R(r[r.length-2],a[a.length-2]),n||R(r[r.length-1],a[a.length-1]))}class Lo{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class Mo{constructor(e,t,r,a){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=a}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(a=>(r=a,this.remoteDocumentCache.getEntry(e,t))).next(e=>(null!==r&&Un(r.mutation,e,mr.empty(),le.now()),e))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.getLocalViewOfDocuments(e,t,pn()).next(()=>t))}getLocalViewOfDocuments(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:pn();const a=un();return this.populateOverlays(e,a,t).next(()=>this.computeViews(e,t,a,r).next(e=>{let t=cn();return e.forEach((e,r)=>{t=t.insert(e,r.overlayedDocument)}),t}))}getOverlayedDocuments(e,t){const r=un();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,pn()))}populateOverlays(e,t,r){const a=[];return r.forEach(e=>{t.has(e)||a.push(e)}),this.documentOverlayCache.getOverlays(e,a).next(e=>{e.forEach((e,r)=>{t.set(e,r)})})}computeViews(e,t,r,a){let n=on();const s=mn(),i=mn();return t.forEach((e,t)=>{const i=r.get(t.key);a.has(t.key)&&(void 0===i||i.mutation instanceof Gn)?n=n.insert(t.key,t):void 0!==i?(s.set(t.key,i.mutation.getFieldMask()),Un(i.mutation,t,i.mutation.getFieldMask(),le.now())):s.set(t.key,mr.empty())}),this.recalculateAndSaveOverlays(e,n).next(e=>(e.forEach((e,t)=>s.set(e,t)),t.forEach((e,t)=>{var r;return i.set(e,new Lo(t,null!==(r=s.get(e))&&void 0!==r?r:null))}),i))}recalculateAndSaveOverlays(e,t){const r=mn();let a=new or((e,t)=>e-t),n=pn();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(e=>{for(const n of e)n.keys().forEach(e=>{const s=t.get(e);if(null===s)return;let i=r.get(e)||mr.empty();i=n.applyToLocalView(s,i),r.set(e,i);const o=(a.get(n.batchId)||pn()).add(e);a=a.insert(n.batchId,o)})}).next(()=>{const s=[],i=a.getReverseIterator();for(;i.hasNext();){const a=i.getNext(),o=a.key,l=a.value,c=hn();l.forEach(e=>{if(!n.has(e)){const a=Bn(t.get(e),r.get(e));null!==a&&c.set(e,a),n=n.add(e)}}),s.push(this.documentOverlayCache.saveOverlays(e,o,c))}return Se.waitFor(s)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.recalculateAndSaveOverlays(e,t))}getDocumentsMatchingQuery(e,t,r,a){return function(e){return Y.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Ha(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,a):this.getDocumentsMatchingCollectionQuery(e,t,r,a)}getNextDocuments(e,t,r,a){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,a).next(n=>{const s=a-n.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,a-n.size):Se.resolve(un());let i=de,o=n;return s.next(t=>Se.forEach(t,(t,r)=>(i<r.largestBatchId&&(i=r.largestBatchId),n.get(t)?Se.resolve():this.remoteDocumentCache.getEntry(e,t).next(e=>{o=o.insert(t,e)}))).next(()=>this.populateOverlays(e,t,n)).next(()=>this.computeViews(e,o,t,pn())).next(e=>({batchId:i,changes:dn(e)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Y(t)).next(e=>{let t=cn();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t})}getDocumentsMatchingCollectionGroupQuery(e,t,r,a){const n=t.collectionGroup;let s=cn();return this.indexManager.getCollectionParents(e,n).next(i=>Se.forEach(i,i=>{const o=function(e,t){return new za(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(t,i.child(n));return this.getDocumentsMatchingCollectionQuery(e,o,r,a).next(e=>{e.forEach((e,t)=>{s=s.insert(e,t)})})}).next(()=>s))}getDocumentsMatchingCollectionQuery(e,t,r,a){let n;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(s=>(n=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,n,a))).next(e=>{n.forEach((t,r)=>{const a=r.getKey();null===e.get(a)&&(e=e.insert(a,oa.newInvalidDocument(a)))});let r=cn();return e.forEach((e,a)=>{const s=n.get(e);void 0!==s&&Un(s.mutation,a,mr.empty(),le.now()),en(t,a)&&(r=r.insert(e,a))}),r})}}class Ro{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return Se.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,function(e){return{id:e.id,version:e.version,createTime:Is(e.createTime)}}(t)),Se.resolve()}getNamedQuery(e,t){return Se.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,function(e){return{name:e.name,query:hi(e.bundledQuery),readTime:Is(e.readTime)}}(t)),Se.resolve()}}class Oo{constructor(){this.overlays=new or(Y.comparator),this.qr=new Map}getOverlay(e,t){return Se.resolve(this.overlays.get(t))}getOverlays(e,t){const r=un();return Se.forEach(t,t=>this.getOverlay(e,t).next(e=>{null!==e&&r.set(t,e)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((r,a)=>{this.St(e,t,a)}),Se.resolve()}removeOverlaysForBatchId(e,t,r){const a=this.qr.get(r);return void 0!==a&&(a.forEach(e=>this.overlays=this.overlays.remove(e)),this.qr.delete(r)),Se.resolve()}getOverlaysForCollection(e,t,r){const a=un(),n=t.length+1,s=new Y(t.child("")),i=this.overlays.getIteratorFrom(s);for(;i.hasNext();){const e=i.getNext().value,s=e.getKey();if(!t.isPrefixOf(s.path))break;s.path.length===n&&e.largestBatchId>r&&a.set(e.getKey(),e)}return Se.resolve(a)}getOverlaysForCollectionGroup(e,t,r,a){let n=new or((e,t)=>e-t);const s=this.overlays.getIterator();for(;s.hasNext();){const e=s.getNext().value;if(e.getKey().getCollectionGroup()===t&&e.largestBatchId>r){let t=n.get(e.largestBatchId);null===t&&(t=un(),n=n.insert(e.largestBatchId,t)),t.set(e.getKey(),e)}}const i=un(),o=n.getIterator();for(;o.hasNext()&&(o.getNext().value.forEach((e,t)=>i.set(e,t)),!(i.size()>=a)););return Se.resolve(i)}St(e,t,r){const a=this.overlays.get(r.key);if(null!==a){const e=this.qr.get(a.largestBatchId).delete(r.key);this.qr.set(a.largestBatchId,e)}this.overlays=this.overlays.insert(r.key,new $n(t,r));let n=this.qr.get(t);void 0===n&&(n=pn(),this.qr.set(t,n)),this.qr.set(t,n.add(r.key))}}class Bo{constructor(){this.sessionToken=gr.EMPTY_BYTE_STRING}getSessionToken(e){return Se.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,Se.resolve()}}class zo{constructor(){this.Qr=new dr(Uo.$r),this.Ur=new dr(Uo.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const r=new Uo(e,t);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,t){e.forEach(e=>this.addReference(e,t))}removeReference(e,t){this.Gr(new Uo(e,t))}zr(e,t){e.forEach(e=>this.removeReference(e,t))}jr(e){const t=new Y(new W([])),r=new Uo(t,e),a=new Uo(t,e+1),n=[];return this.Ur.forEachInRange([r,a],e=>{this.Gr(e),n.push(e.key)}),n}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new Y(new W([])),r=new Uo(t,e),a=new Uo(t,e+1);let n=pn();return this.Ur.forEachInRange([r,a],e=>{n=n.add(e.key)}),n}containsKey(e){const t=new Uo(e,0),r=this.Qr.firstAfterOrEqual(t);return null!==r&&e.isEqual(r.key)}}class Uo{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return Y.comparator(e.key,t.key)||R(e.Yr,t.Yr)}static Kr(e,t){return R(e.Yr,t.Yr)||Y.comparator(e.key,t.key)}}class Vo{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new dr(Uo.$r)}checkEmpty(e){return Se.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,r,a){const n=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const s=new Jn(n,t,r,a);this.mutationQueue.push(s);for(const i of a)this.Zr=this.Zr.add(new Uo(i.key,n)),this.indexManager.addToCollectionParentIndex(e,i.key.path.popLast());return Se.resolve(s)}lookupMutationBatch(e,t){return Se.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,a=this.ei(r),n=a<0?0:a;return Se.resolve(this.mutationQueue.length>n?this.mutationQueue[n]:null)}getHighestUnacknowledgedBatchId(){return Se.resolve(0===this.mutationQueue.length?Ue:this.tr-1)}getAllMutationBatches(e){return Se.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new Uo(t,0),a=new Uo(t,Number.POSITIVE_INFINITY),n=[];return this.Zr.forEachInRange([r,a],e=>{const t=this.Xr(e.Yr);n.push(t)}),Se.resolve(n)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new dr(R);return t.forEach(e=>{const t=new Uo(e,0),a=new Uo(e,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([t,a],e=>{r=r.add(e.Yr)})}),Se.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,a=r.length+1;let n=r;Y.isDocumentKey(n)||(n=n.child(""));const s=new Uo(new Y(n),0);let i=new dr(R);return this.Zr.forEachWhile(e=>{const t=e.key.path;return!!r.isPrefixOf(t)&&(t.length===a&&(i=i.add(e.Yr)),!0)},s),Se.resolve(this.ti(i))}ti(e){const t=[];return e.forEach(e=>{const r=this.Xr(e);null!==r&&t.push(r)}),t}removeMutationBatch(e,t){k(0===this.ni(t.batchId,"removed"),55003),this.mutationQueue.shift();let r=this.Zr;return Se.forEach(t.mutations,a=>{const n=new Uo(a.key,t.batchId);return r=r.delete(n),this.referenceDelegate.markPotentiallyOrphaned(e,a.key)}).next(()=>{this.Zr=r})}ir(e){}containsKey(e,t){const r=new Uo(t,0),a=this.Zr.firstAfterOrEqual(r);return Se.resolve(t.isEqual(a&&a.key))}performConsistencyCheck(e){return this.mutationQueue.length,Se.resolve()}ni(e,t){return this.ei(e)}ei(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class qo{constructor(e){this.ri=e,this.docs=new or(Y.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,a=this.docs.get(r),n=a?a.size:0,s=this.ri(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:s}),this.size+=s-n,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return Se.resolve(r?r.document.mutableCopy():oa.newInvalidDocument(t))}getEntries(e,t){let r=on();return t.forEach(e=>{const t=this.docs.get(e);r=r.insert(e,t?t.document.mutableCopy():oa.newInvalidDocument(e))}),Se.resolve(r)}getDocumentsMatchingQuery(e,t,r,a){let n=on();const s=t.path,i=new Y(s.child("__id-9223372036854775808__")),o=this.docs.getIteratorFrom(i);for(;o.hasNext();){const{key:e,value:{document:i}}=o.getNext();if(!s.isPrefixOf(e.path))break;e.path.length>s.length+1||we(ve(i),r)<=0||(a.has(i.key)||en(t,i))&&(n=n.insert(i.key,i.mutableCopy()))}return Se.resolve(n)}getAllFromCollectionGroup(e,t,r,a){b(9500)}ii(e,t){return Se.forEach(this.docs,e=>t(e))}newChangeBuffer(e){return new Ho(this)}getSize(e){return Se.resolve(this.size)}}class Ho extends _o{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach((r,a)=>{a.isValidDocument()?t.push(this.Nr.addEntry(e,a)):this.Nr.removeEntry(r)}),Se.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}class Go{constructor(e){this.persistence=e,this.si=new nn(e=>Fa(e),La),this.lastRemoteSnapshotVersion=ce.min(),this.highestTargetId=0,this.oi=0,this._i=new zo,this.targetCount=0,this.ai=ho.ur()}forEachTarget(e,t){return this.si.forEach((e,r)=>t(r)),Se.resolve()}getLastRemoteSnapshotVersion(e){return Se.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Se.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),Se.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.oi&&(this.oi=t),Se.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new ho(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,Se.resolve()}updateTargetData(e,t){return this.Pr(t),Se.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,Se.resolve()}removeTargets(e,t,r){let a=0;const n=[];return this.si.forEach((s,i)=>{i.sequenceNumber<=t&&null===r.get(i.targetId)&&(this.si.delete(s),n.push(this.removeMatchingKeysForTargetId(e,i.targetId)),a++)}),Se.waitFor(n).next(()=>a)}getTargetCount(e){return Se.resolve(this.targetCount)}getTargetData(e,t){const r=this.si.get(t)||null;return Se.resolve(r)}addMatchingKeys(e,t,r){return this._i.Wr(t,r),Se.resolve()}removeMatchingKeys(e,t,r){this._i.zr(t,r);const a=this.persistence.referenceDelegate,n=[];return a&&t.forEach(t=>{n.push(a.markPotentiallyOrphaned(e,t))}),Se.waitFor(n)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),Se.resolve()}getMatchingKeysForTargetId(e,t){const r=this._i.Hr(t);return Se.resolve(r)}containsKey(e,t){return Se.resolve(this._i.containsKey(t))}}class Wo{constructor(e,t){this.ui={},this.overlays={},this.ci=new ze(0),this.li=!1,this.li=!0,this.hi=new Bo,this.referenceDelegate=e(this),this.Pi=new Go(this),this.indexManager=new Gi,this.remoteDocumentCache=function(e){return new qo(e)}(e=>this.referenceDelegate.Ti(e)),this.serializer=new ni(t),this.Ii=new Ro(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Oo,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.ui[e.toKey()];return r||(r=new Vo(t,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,r){p("MemoryPersistence","Starting transaction:",e);const a=new Ko(this.ci.next());return this.referenceDelegate.Ei(),r(a).next(e=>this.referenceDelegate.di(a).next(()=>e)).toPromise().then(e=>(a.raiseOnCommittedEvent(),e))}Ai(e,t){return Se.or(Object.values(this.ui).map(r=>()=>r.containsKey(e,t)))}}class Ko extends Ne{constructor(e){super(),this.currentSequenceNumber=e}}class Qo{constructor(e){this.persistence=e,this.Ri=new zo,this.Vi=null}static mi(e){return new Qo(e)}get fi(){if(this.Vi)return this.Vi;throw b(60996)}addReference(e,t,r){return this.Ri.addReference(r,t),this.fi.delete(r.toString()),Se.resolve()}removeReference(e,t,r){return this.Ri.removeReference(r,t),this.fi.add(r.toString()),Se.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),Se.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach(e=>this.fi.add(e.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(e=>{e.forEach(e=>this.fi.add(e.toString()))}).next(()=>r.removeTargetData(e,t))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Se.forEach(this.fi,r=>{const a=Y.fromPath(r);return this.gi(e,a).next(e=>{e||t.removeEntry(a,ce.min())})}).next(()=>(this.Vi=null,t.apply(e)))}updateLimboDocument(e,t){return this.gi(e,t).next(e=>{e?this.fi.delete(t.toString()):this.fi.add(t.toString())})}Ti(e){return 0}gi(e,t){return Se.or([()=>Se.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class Yo{constructor(e,t){this.persistence=e,this.pi=new nn(e=>We(e.path),(e,t)=>e.isEqual(t)),this.garbageCollector=No(this,t)}static mi(e,t){return new Yo(e,t)}Ei(){}di(e){return Se.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(e=>t.next(t=>e+t))}wr(e){let t=0;return this.pr(e,e=>{t++}).next(()=>t)}pr(e,t){return Se.forEach(this.pi,(r,a)=>this.br(e,r,a).next(e=>e?Se.resolve():t(a)))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0;const a=this.persistence.getRemoteDocumentCache(),n=a.newChangeBuffer();return a.ii(e,a=>this.br(e,a,t).next(e=>{e||(r++,n.removeEntry(a,ce.min()))})).next(()=>n.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),Se.resolve()}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),Se.resolve()}removeReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),Se.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),Se.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Hr(e.data.value)),t}br(e,t,r){return Se.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const e=this.pi.get(t);return Se.resolve(void 0!==e&&e>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class Xo{constructor(e){this.serializer=e}k(e,t,r,a){const n=new Ee("createOrUpgrade",t);r<1&&a>=1&&(function(e){e.createObjectStore(Je)}(e),function(e){e.createObjectStore($e,{keyPath:"userId"});e.createObjectStore(et,{keyPath:tt,autoIncrement:!0}).createIndex(rt,at,{unique:!0}),e.createObjectStore(ot)}(e),Jo(e),function(e){e.createObjectStore(Xe)}(e));let s=Se.resolve();return r<3&&a>=3&&(0!==r&&(function(e){e.deleteObjectStore(vt),e.deleteObjectStore(pt),e.deleteObjectStore(jt)}(e),Jo(e)),s=s.next(()=>function(e){const t=e.store(jt),r={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:ce.min().toTimestamp(),targetCount:0};return t.put(Nt,r)}(n))),r<4&&a>=4&&(0!==r&&(s=s.next(()=>function(e,t){return t.store(et).J().next(r=>{e.deleteObjectStore(et),e.createObjectStore(et,{keyPath:tt,autoIncrement:!0}).createIndex(rt,at,{unique:!0});const a=t.store(et),n=r.map(e=>a.put(e));return Se.waitFor(n)})}(e,n))),s=s.next(()=>{!function(e){e.createObjectStore(Et,{keyPath:"clientId"})}(e)})),r<5&&a>=5&&(s=s.next(()=>this.yi(n))),r<6&&a>=6&&(s=s.next(()=>(function(e){e.createObjectStore(ft)}(e),this.wi(n)))),r<7&&a>=7&&(s=s.next(()=>this.Si(n))),r<8&&a>=8&&(s=s.next(()=>this.bi(e,n))),r<9&&a>=9&&(s=s.next(()=>{!function(e){e.objectStoreNames.contains("remoteDocumentChanges")&&e.deleteObjectStore("remoteDocumentChanges")}(e)})),r<10&&a>=10&&(s=s.next(()=>this.Di(n))),r<11&&a>=11&&(s=s.next(()=>{!function(e){e.createObjectStore(At,{keyPath:"bundleId"})}(e),function(e){e.createObjectStore(Ct,{keyPath:"name"})}(e)})),r<12&&a>=12&&(s=s.next(()=>{!function(e){const t=e.createObjectStore(zt,{keyPath:Ut});t.createIndex(Vt,qt,{unique:!1}),t.createIndex(Ht,Gt,{unique:!1})}(e)})),r<13&&a>=13&&(s=s.next(()=>function(e){const t=e.createObjectStore(lt,{keyPath:ct});t.createIndex(dt,ut),t.createIndex(ht,mt)}(e)).next(()=>this.Ci(e,n)).next(()=>e.deleteObjectStore(Xe))),r<14&&a>=14&&(s=s.next(()=>this.Fi(e,n))),r<15&&a>=15&&(s=s.next(()=>function(e){e.createObjectStore(It,{keyPath:"indexId",autoIncrement:!0}).createIndex(Tt,"collectionGroup",{unique:!1});e.createObjectStore(Dt,{keyPath:Pt}).createIndex(Ft,Lt,{unique:!1});e.createObjectStore(Mt,{keyPath:Rt}).createIndex(Ot,Bt,{unique:!1})}(e))),r<16&&a>=16&&(s=s.next(()=>{t.objectStore(Dt).clear()}).next(()=>{t.objectStore(Mt).clear()})),r<17&&a>=17&&(s=s.next(()=>{!function(e){e.createObjectStore(Wt,{keyPath:"name"})}(e)})),r<18&&a>=18&&o.isSafariOrWebkit()&&(s=s.next(()=>{t.objectStore(Dt).clear()}).next(()=>{t.objectStore(Mt).clear()})),s}wi(e){let t=0;return e.store(Xe).ee((e,r)=>{t+=so(r)}).next(()=>{const r={byteSize:t};return e.store(ft).put(gt,r)})}yi(e){const t=e.store($e),r=e.store(et);return t.J().next(t=>Se.forEach(t,t=>{const a=IDBKeyRange.bound([t.userId,Ue],[t.userId,t.lastAcknowledgedBatchId]);return r.J(rt,a).next(r=>Se.forEach(r,r=>{k(r.userId===t.userId,18650,"Cannot process batch from unexpected user",{batchId:r.batchId});const a=ci(this.serializer,r);return no(e,t.userId,a).next(()=>{})}))}))}Si(e){const t=e.store(vt),r=e.store(Xe);return e.store(jt).get(Nt).next(e=>{const a=[];return r.ee((r,n)=>{const s=new W(r),i=function(e){return[0,We(e)]}(s);a.push(t.get(i).next(r=>r?Se.resolve():(r=>t.put({targetId:0,path:We(r),sequenceNumber:e.highestListenSequenceNumber}))(s)))}).next(()=>Se.waitFor(a))})}bi(e,t){e.createObjectStore(St,{keyPath:_t});const r=t.store(St),a=new Wi,n=e=>{if(a.add(e)){const t=e.lastSegment(),a=e.popLast();return r.put({collectionId:t,parent:We(a)})}};return t.store(Xe).ee({X:!0},(e,t)=>{const r=new W(e);return n(r.popLast())}).next(()=>t.store(ot).ee({X:!0},(e,t)=>{let[r,a,s]=e;const i=Ye(a);return n(i.popLast())}))}Di(e){const t=e.store(pt);return t.ee((e,r)=>{const a=di(r),n=ui(this.serializer,a);return t.put(n)})}Ci(e,t){const r=t.store(Xe),a=[];return r.ee((e,r)=>{const n=t.store(lt),s=function(e){return e.document?new Y(W.fromString(e.document.name).popFirst(5)):e.noDocument?Y.fromSegments(e.noDocument.path):e.unknownDocument?Y.fromSegments(e.unknownDocument.path):b(36783)}(r).path.toArray(),i={prefixPath:s.slice(0,s.length-2),collectionGroup:s[s.length-2],documentId:s[s.length-1],readTime:r.readTime||[0,0],unknownDocument:r.unknownDocument,noDocument:r.noDocument,document:r.document,hasCommittedMutations:!!r.hasCommittedMutations};a.push(n.put(i))}).next(()=>Se.waitFor(a))}Fi(e,t){const r=t.store(et),a=Ao(this.serializer),n=new Wo(Qo.mi,this.serializer.yt);return r.J().next(e=>{const r=new Map;return e.forEach(e=>{var t;let a=null!==(t=r.get(e.userId))&&void 0!==t?t:pn();ci(this.serializer,e).keys().forEach(e=>a=a.add(e)),r.set(e.userId,a)}),Se.forEach(r,(e,r)=>{const s=new h(r),i=vi.wt(this.serializer,s),o=n.getIndexManager(s),l=io.wt(s,this.serializer,o,n.referenceDelegate);return new Mo(a,l,i,o).recalculateAndSaveOverlaysForDocumentKeys(new tr(t,ze.ce),e).next()})})}}function Jo(e){e.createObjectStore(vt,{keyPath:bt}).createIndex(wt,kt,{unique:!0}),e.createObjectStore(pt,{keyPath:"targetId"}).createIndex(xt,yt,{unique:!0}),e.createObjectStore(jt)}const Zo="IndexedDbPersistence",$o=18e5,el=5e3,tl="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",rl="main";class al{constructor(e,t,r,a,n,s,i,o,l,c){let d=arguments.length>10&&void 0!==arguments[10]?arguments[10]:18;if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.Mi=n,this.window=s,this.document=i,this.xi=l,this.Oi=c,this.Ni=d,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=e=>Promise.resolve(),!al.v())throw new S(j.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new jo(this,a),this.$i=t+rl,this.serializer=new ni(o),this.Ui=new Ae(this.$i,this.Ni,new Xo(this.serializer)),this.hi=new wi,this.Pi=new mo(this.referenceDelegate,this.serializer),this.remoteDocumentCache=Ao(this.serializer),this.Ii=new pi,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,!1===c&&x(Zo,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new S(j.FAILED_PRECONDITION,tl);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Pi.getHighestSequenceNumber(e))}).then(e=>{this.ci=new ze(e,this.xi)}).then(()=>{this.li=!0}).catch(e=>(this.Ui&&this.Ui.close(),Promise.reject(e)))}Ji(e){return this.Qi=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ui.$(async t=>{null===t.newVersion&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Mi.enqueueAndForget(async()=>{this.started&&await this.Wi()}))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>sl(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.Hi(e).next(e=>{e||(this.isPrimary=!1,this.Mi.enqueueRetryable(()=>this.Qi(!1)))})}).next(()=>this.Yi(e)).next(t=>this.isPrimary&&!t?this.Zi(e).next(()=>!1):!!t&&this.Xi(e).next(()=>!0))).catch(e=>{if(De(e))return p(Zo,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return p(Zo,"Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.Mi.enqueueRetryable(()=>this.Qi(e)),this.isPrimary=e})}Hi(e){return nl(e).get(Ze).next(e=>Se.resolve(this.es(e)))}ts(e){return sl(e).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.rs(this.qi,$o)){this.qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",e=>{const t=rr(e,Et);return t.J().next(e=>{const r=this.ss(e,$o),a=e.filter(e=>-1===r.indexOf(e));return Se.forEach(a,e=>t.delete(e.clientId)).next(()=>a)})}).catch(()=>[]);if(this.Ki)for(const t of e)this.Ki.removeItem(this._s(t.clientId))}}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.Wi().then(()=>this.ns()).then(()=>this.ji()))}es(e){return!!e&&e.ownerId===this.clientId}Yi(e){return this.Oi?Se.resolve(!0):nl(e).get(Ze).next(t=>{if(null!==t&&this.rs(t.leaseTimestampMs,el)&&!this.us(t.ownerId)){if(this.es(t)&&this.networkEnabled)return!0;if(!this.es(t)){if(!t.allowTabSynchronization)throw new S(j.FAILED_PRECONDITION,tl);return!1}}return!(!this.networkEnabled||!this.inForeground)||sl(e).J().next(e=>void 0===this.ss(e,el).find(e=>{if(this.clientId!==e.clientId){const t=!this.networkEnabled&&e.networkEnabled,r=!this.inForeground&&e.inForeground,a=this.networkEnabled===e.networkEnabled;if(t||r&&a)return!0}return!1}))}).next(e=>(this.isPrimary!==e&&p(Zo,"Client ".concat(e?"is":"is not"," eligible for a primary lease.")),e))}async shutdown(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),await this.Ui.runTransaction("shutdown","readwrite",[Je,Et],e=>{const t=new tr(e,ze.ce);return this.Zi(t).next(()=>this.ts(t))}),this.Ui.close(),this.Ps()}ss(e,t){return e.filter(e=>this.rs(e.updateTimeMs,t)&&!this.us(e.clientId))}Ts(){return this.runTransaction("getActiveClients","readonly",e=>sl(e).J().next(e=>this.ss(e,$o).map(e=>e.clientId)))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(e,t){return io.wt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new Yi(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return vi.wt(this.serializer,e)}getBundleCache(){return this.Ii}runTransaction(e,t,r){p(Zo,"Starting transaction:",e);const a="readonly"===t?"readonly":"readwrite",n=function(e){return 18===e?er:17===e?$t:16===e?Zt:15===e?Jt:14===e?Xt:13===e?Yt:12===e?Qt:11===e?Kt:void b(60245)}(this.Ni);let s;return this.Ui.runTransaction(e,a,n,a=>(s=new tr(a,this.ci?this.ci.next():ze.ce),"readwrite-primary"===t?this.Hi(s).next(e=>!!e||this.Yi(s)).next(t=>{if(!t)throw x("Failed to obtain primary lease for action '".concat(e,"'.")),this.isPrimary=!1,this.Mi.enqueueRetryable(()=>this.Qi(!1)),new S(j.FAILED_PRECONDITION,ke);return r(s)}).next(e=>this.Xi(s).next(()=>e)):this.Is(s).next(()=>r(s)))).then(e=>(s.raiseOnCommittedEvent(),e))}Is(e){return nl(e).get(Ze).next(e=>{if(null!==e&&this.rs(e.leaseTimestampMs,el)&&!this.us(e.ownerId)&&!this.es(e)&&!(this.Oi||this.allowTabSynchronization&&e.allowTabSynchronization))throw new S(j.FAILED_PRECONDITION,tl)})}Xi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return nl(e).put(Ze,t)}static v(){return Ae.v()}Zi(e){const t=nl(e);return t.get(Ze).next(e=>this.es(e)?(p(Zo,"Releasing primary lease."),t.delete(Ze)):Se.resolve())}rs(e,t){const r=Date.now();return!(e<r-t)&&(!(e>r)||(x("Detected an update time that is in the future: ".concat(e," > ").concat(r)),!1))}Gi(){null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Li=()=>{this.Mi.enqueueAndForget(()=>(this.inForeground="visible"===this.document.visibilityState,this.Wi()))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground="visible"===this.document.visibilityState)}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){var e;"function"==typeof(null===(e=this.window)||void 0===e?void 0:e.addEventListener)&&(this.Bi=()=>{this.cs();const e=/(?:Version|Mobile)\/1[456]/;o.isSafari()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(e){try{var t;const r=null!==(null===(t=this.Ki)||void 0===t?void 0:t.getItem(this._s(e)));return p(Zo,"Client '".concat(e,"' ").concat(r?"is":"is not"," zombied in LocalStorage")),r}catch(e){return x(Zo,"Failed to get zombied client id.",e),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(e){x("Failed to set zombie client id.",e)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch(e){}}_s(e){return"firestore_zombie_".concat(this.persistenceKey,"_").concat(e)}}function nl(e){return rr(e,Je)}function sl(e){return rr(e,Et)}function il(e,t){let r=e.projectId;return e.isDefaultDatabase||(r+="."+e.database),"firestore/"+t+"/"+r+"/"}class ol{constructor(e,t,r,a){this.targetId=e,this.fromCache=t,this.Es=r,this.ds=a}static As(e,t){let r=pn(),a=pn();for(const n of t.docChanges)switch(n.type){case 0:r=r.add(n.doc.key);break;case 1:a=a.add(n.doc.key)}return new ol(e,t.fromCache,r,a)}}class ll{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class cl{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=o.isSafari()?8:Ce(o.getUA())>0?6:4}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,r,a){const n={result:null};return this.ys(e,t).next(e=>{n.result=e}).next(()=>{if(!n.result)return this.ws(e,t,a,r).next(e=>{n.result=e})}).next(()=>{if(n.result)return;const r=new ll;return this.Ss(e,t,r).next(a=>{if(n.result=a,this.Vs)return this.bs(e,t,r,a.size)})}).next(()=>n.result)}bs(e,t,r,a){return r.documentReadCount<this.fs?(g()<=i.LogLevel.DEBUG&&p("QueryEngine","SDK will not create cache indexes for query:",$a(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),Se.resolve()):(g()<=i.LogLevel.DEBUG&&p("QueryEngine","Query:",$a(t),"scans",r.documentReadCount,"local documents and returns",a,"documents as results."),r.documentReadCount>this.gs*a?(g()<=i.LogLevel.DEBUG&&p("QueryEngine","The SDK decides to create cache indexes for query:",$a(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Wa(t))):Se.resolve())}ys(e,t){if(qa(t))return Se.resolve(null);let r=Wa(t);return this.indexManager.getIndexType(e,r).next(a=>0===a?null:(null!==t.limit&&1===a&&(t=Xa(t,null,"F"),r=Wa(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(a=>{const n=pn(...a);return this.ps.getDocuments(e,n).next(a=>this.indexManager.getMinOffset(e,r).next(r=>{const s=this.Ds(t,a);return this.Cs(t,s,n,r.readTime)?this.ys(e,Xa(t,null,"F")):this.vs(e,s,t,r)}))})))}ws(e,t,r,a){return qa(t)||a.isEqual(ce.min())?Se.resolve(null):this.ps.getDocuments(e,r).next(n=>{const s=this.Ds(t,n);return this.Cs(t,s,r,a)?Se.resolve(null):(g()<=i.LogLevel.DEBUG&&p("QueryEngine","Re-using previous result from %s to execute query: %s",a.toString(),$a(t)),this.vs(e,s,t,ye(a,de)).next(e=>e))})}Ds(e,t){let r=new dr(rn(e));return t.forEach((t,a)=>{en(e,a)&&(r=r.add(a))}),r}Cs(e,t,r,a){if(null===e.limit)return!1;if(r.size!==t.size)return!0;const n="F"===e.limitType?t.last():t.first();return!!n&&(n.hasPendingWrites||n.version.compareTo(a)>0)}Ss(e,t,r){return g()<=i.LogLevel.DEBUG&&p("QueryEngine","Using full collection scan to execute query:",$a(t)),this.ps.getDocumentsMatchingQuery(e,t,be.min(),r)}vs(e,t,r,a){return this.ps.getDocumentsMatchingQuery(e,r,a).next(e=>(t.forEach(t=>{e=e.insert(t.key,t)}),e))}}const dl="LocalStore";class ul{constructor(e,t,r,a){this.persistence=e,this.Fs=t,this.serializer=a,this.Ms=new or(R),this.xs=new nn(e=>Fa(e),La),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Mo(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Ms))}}function hl(e,t,r,a){return new ul(e,t,r,a)}async function ml(e,t){const r=N(e);return await r.persistence.runTransaction("Handle user change","readonly",e=>{let a;return r.mutationQueue.getAllMutationBatches(e).next(n=>(a=n,r.Bs(t),r.mutationQueue.getAllMutationBatches(e))).next(t=>{const n=[],s=[];let i=pn();for(const e of a){n.push(e.batchId);for(const t of e.mutations)i=i.add(t.key)}for(const e of t){s.push(e.batchId);for(const t of e.mutations)i=i.add(t.key)}return r.localDocuments.getDocuments(e,i).next(e=>({Ls:e,removedBatchIds:n,addedBatchIds:s}))})})}function fl(e){const t=N(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",e=>t.Pi.getLastRemoteSnapshotVersion(e))}function gl(e,t,r){let a=pn(),n=pn();return r.forEach(e=>a=a.add(e)),t.getEntries(e,a).next(e=>{let a=on();return r.forEach((r,s)=>{const i=e.get(r);s.isFoundDocument()!==i.isFoundDocument()&&(n=n.add(r)),s.isNoDocument()&&s.version.isEqual(ce.min())?(t.removeEntry(r,s.readTime),a=a.insert(r,s)):!i.isValidDocument()||s.version.compareTo(i.version)>0||0===s.version.compareTo(i.version)&&i.hasPendingWrites?(t.addEntry(s),a=a.insert(r,s)):p(dl,"Ignoring outdated watch update for ",r,". Current version:",i.version," Watch version:",s.version)}),{ks:a,qs:n}})}function pl(e,t){const r=N(e);return r.persistence.runTransaction("Get next mutation batch","readonly",e=>(void 0===t&&(t=Ue),r.mutationQueue.getNextMutationBatchAfterBatchId(e,t)))}function xl(e,t){const r=N(e);return r.persistence.runTransaction("Allocate target","readwrite",e=>{let a;return r.Pi.getTargetData(e,t).next(n=>n?(a=n,Se.resolve(a)):r.Pi.allocateTargetId(e).next(n=>(a=new ai(t,n,"TargetPurposeListen",e.currentSequenceNumber),r.Pi.addTargetData(e,a).next(()=>a))))}).then(e=>{const a=r.Ms.get(e.targetId);return(null===a||e.snapshotVersion.compareTo(a.snapshotVersion)>0)&&(r.Ms=r.Ms.insert(e.targetId,e),r.xs.set(t,e.targetId)),e})}async function yl(e,t,r){const a=N(e),n=a.Ms.get(t),s=r?"readwrite":"readwrite-primary";try{r||await a.persistence.runTransaction("Release target",s,e=>a.persistence.referenceDelegate.removeTarget(e,n))}catch(e){if(!De(e))throw e;p(dl,"Failed to update sequence numbers for target ".concat(t,": ").concat(e))}a.Ms=a.Ms.remove(t),a.xs.delete(n.target)}function vl(e,t,r){const a=N(e);let n=ce.min(),s=pn();return a.persistence.runTransaction("Execute query","readwrite",e=>function(e,t,r){const a=N(e),n=a.xs.get(r);return void 0!==n?Se.resolve(a.Ms.get(n)):a.Pi.getTargetData(t,r)}(a,e,Wa(t)).next(t=>{if(t)return n=t.lastLimboFreeSnapshotVersion,a.Pi.getMatchingKeysForTargetId(e,t.targetId).next(e=>{s=e})}).next(()=>a.Fs.getDocumentsMatchingQuery(e,t,r?n:ce.min(),r?s:pn())).next(e=>(kl(a,tn(t),e),{documents:e,Qs:s})))}function bl(e,t){const r=N(e),a=N(r.Pi),n=r.Ms.get(t);return n?Promise.resolve(n.target):r.persistence.runTransaction("Get target data","readonly",e=>a.At(e,t).next(e=>e?e.target:null))}function wl(e,t){const r=N(e),a=r.Os.get(t)||ce.min();return r.persistence.runTransaction("Get new document changes","readonly",e=>r.Ns.getAllFromCollectionGroup(e,t,ye(a,de),Number.MAX_SAFE_INTEGER)).then(e=>(kl(r,t,e),e))}function kl(e,t,r){let a=e.Os.get(t)||ce.min();r.forEach((e,t)=>{t.readTime.compareTo(a)>0&&(a=t.readTime)}),e.Os.set(t,a)}async function Nl(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:pn();const a=await xl(e,Wa(hi(t.bundledQuery))),n=N(e);return n.persistence.runTransaction("Save named query","readwrite",e=>{const s=Is(t.readTime);if(a.snapshotVersion.compareTo(s)>=0)return n.Ii.saveNamedQuery(e,t);const i=a.withResumeToken(gr.EMPTY_BYTE_STRING,s);return n.Ms=n.Ms.insert(i.targetId,i),n.Pi.updateTargetData(e,i).next(()=>n.Pi.removeMatchingKeysForTargetId(e,a.targetId)).next(()=>n.Pi.addMatchingKeys(e,r,a.targetId)).next(()=>n.Ii.saveNamedQuery(e,t))})}const jl="firestore_clients";function Sl(e,t){return"".concat(jl,"_").concat(e,"_").concat(t)}const _l="firestore_mutations";function El(e,t,r){let a="".concat(_l,"_").concat(e,"_").concat(r);return t.isAuthenticated()&&(a+="_".concat(t.uid)),a}const Al="firestore_targets";function Cl(e,t){return"".concat(Al,"_").concat(e,"_").concat(t)}const Il="SharedClientState";class Tl{constructor(e,t,r,a){this.user=e,this.batchId=t,this.state=r,this.error=a}static Ws(e,t,r){const a=JSON.parse(r);let n,s="object"==typeof a&&-1!==["pending","acknowledged","rejected"].indexOf(a.state)&&(void 0===a.error||"object"==typeof a.error);return s&&a.error&&(s="string"==typeof a.error.message&&"string"==typeof a.error.code,s&&(n=new S(a.error.code,a.error.message))),s?new Tl(e,t,a.state,n):(x(Il,"Failed to parse mutation state for ID '".concat(t,"': ").concat(r)),null)}Gs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Dl{constructor(e,t,r){this.targetId=e,this.state=t,this.error=r}static Ws(e,t){const r=JSON.parse(t);let a,n="object"==typeof r&&-1!==["not-current","current","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error);return n&&r.error&&(n="string"==typeof r.error.message&&"string"==typeof r.error.code,n&&(a=new S(r.error.code,r.error.message))),n?new Dl(e,r.state,a):(x(Il,"Failed to parse target state for ID '".concat(e,"': ").concat(t)),null)}Gs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Pl{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Ws(e,t){const r=JSON.parse(t);let a="object"==typeof r&&r.activeTargetIds instanceof Array,n=yn();for(let s=0;a&&s<r.activeTargetIds.length;++s)a=He(r.activeTargetIds[s]),n=n.add(r.activeTargetIds[s]);return a?new Pl(e,n):(x(Il,"Failed to parse client data for instance '".concat(e,"': ").concat(t)),null)}}class Fl{constructor(e,t){this.clientId=e,this.onlineState=t}static Ws(e){const t=JSON.parse(e);return"object"==typeof t&&-1!==["Unknown","Online","Offline"].indexOf(t.onlineState)&&"string"==typeof t.clientId?new Fl(t.clientId,t.onlineState):(x(Il,"Failed to parse online state: ".concat(e)),null)}}class Ll{constructor(){this.activeTargetIds=yn()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Ml{constructor(e,t,r,a,n){this.window=e,this.Mi=t,this.persistenceKey=r,this.Js=a,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.Hs=this.Ys.bind(this),this.Zs=new or(R),this.started=!1,this.Xs=[];const s=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=n,this.eo=Sl(this.persistenceKey,this.Js),this.no=function(e){return"firestore_sequence_number_".concat(e)}(this.persistenceKey),this.Zs=this.Zs.insert(this.Js,new Ll),this.ro=new RegExp("^".concat(jl,"_").concat(s,"_([^_]*)$")),this.io=new RegExp("^".concat(_l,"_").concat(s,"_(\\d+)(?:_(.*))?$")),this.so=new RegExp("^".concat(Al,"_").concat(s,"_(\\d+)$")),this.oo=function(e){return"firestore_online_state_".concat(e)}(this.persistenceKey),this._o=function(e){return"firestore_bundle_loaded_v2_".concat(e)}(this.persistenceKey),this.window.addEventListener("storage",this.Hs)}static v(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Ts();for(const r of e){if(r===this.Js)continue;const e=this.getItem(Sl(this.persistenceKey,r));if(e){const t=Pl.Ws(r,e);t&&(this.Zs=this.Zs.insert(t.clientId,t))}}this.ao();const t=this.storage.getItem(this.oo);if(t){const e=this.uo(t);e&&this.co(e)}for(const r of this.Xs)this.Ys(r);this.Xs=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(e){this.setItem(this.no,JSON.stringify(e))}getAllActiveQueryTargets(){return this.lo(this.Zs)}isActiveQueryTarget(e){let t=!1;return this.Zs.forEach((r,a)=>{a.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.ho(e,"pending")}updateMutationState(e,t,r){this.ho(e,t,r),this.Po(e)}addLocalQueryTarget(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r="not-current";if(this.isActiveQueryTarget(e)){const t=this.storage.getItem(Cl(this.persistenceKey,e));if(t){const a=Dl.Ws(e,t);a&&(r=a.state)}}return t&&this.To.zs(e),this.ao(),r}removeLocalQueryTarget(e){this.To.js(e),this.ao()}isLocalQueryTarget(e){return this.To.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(Cl(this.persistenceKey,e))}updateQueryState(e,t,r){this.Io(e,t,r)}handleUserChange(e,t,r){t.forEach(e=>{this.Po(e)}),this.currentUser=e,r.forEach(e=>{this.addPendingMutation(e)})}setOnlineState(e){this.Eo(e)}notifyBundleLoaded(e){this.Ao(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.Hs),this.removeItem(this.eo),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return p(Il,"READ",e,t),t}setItem(e,t){p(Il,"SET",e,t),this.storage.setItem(e,t)}removeItem(e){p(Il,"REMOVE",e),this.storage.removeItem(e)}Ys(e){const t=e;if(t.storageArea===this.storage){if(p(Il,"EVENT",t.key,t.newValue),t.key===this.eo)return void x("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Mi.enqueueRetryable(async()=>{if(this.started){if(null!==t.key)if(this.ro.test(t.key)){if(null==t.newValue){const e=this.Ro(t.key);return this.Vo(e,null)}{const e=this.mo(t.key,t.newValue);if(e)return this.Vo(e.clientId,e)}}else if(this.io.test(t.key)){if(null!==t.newValue){const e=this.fo(t.key,t.newValue);if(e)return this.po(e)}}else if(this.so.test(t.key)){if(null!==t.newValue){const e=this.yo(t.key,t.newValue);if(e)return this.wo(e)}}else if(t.key===this.oo){if(null!==t.newValue){const e=this.uo(t.newValue);if(e)return this.co(e)}}else if(t.key===this.no){const e=function(e){let t=ze.ce;if(null!=e)try{const r=JSON.parse(e);k("number"==typeof r,30636,{So:e}),t=r}catch(e){x(Il,"Failed to read sequence number from WebStorage",e)}return t}(t.newValue);e!==ze.ce&&this.sequenceNumberHandler(e)}else if(t.key===this._o){const e=this.bo(t.newValue);await Promise.all(e.map(e=>this.syncEngine.Do(e)))}}else this.Xs.push(t)})}}get To(){return this.Zs.get(this.Js)}ao(){this.setItem(this.eo,this.To.Gs())}ho(e,t,r){const a=new Tl(this.currentUser,e,t,r),n=El(this.persistenceKey,this.currentUser,e);this.setItem(n,a.Gs())}Po(e){const t=El(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Eo(e){const t={clientId:this.Js,onlineState:e};this.storage.setItem(this.oo,JSON.stringify(t))}Io(e,t,r){const a=Cl(this.persistenceKey,e),n=new Dl(e,t,r);this.setItem(a,n.Gs())}Ao(e){const t=JSON.stringify(Array.from(e));this.setItem(this._o,t)}Ro(e){const t=this.ro.exec(e);return t?t[1]:null}mo(e,t){const r=this.Ro(e);return Pl.Ws(r,t)}fo(e,t){const r=this.io.exec(e),a=Number(r[1]),n=void 0!==r[2]?r[2]:null;return Tl.Ws(new h(n),a,t)}yo(e,t){const r=this.so.exec(e),a=Number(r[1]);return Dl.Ws(a,t)}uo(e){return Fl.Ws(e)}bo(e){return JSON.parse(e)}async po(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.Co(e.batchId,e.state,e.error);p(Il,"Ignoring mutation for non-active user ".concat(e.user.uid))}wo(e){return this.syncEngine.vo(e.targetId,e.state,e.error)}Vo(e,t){const r=t?this.Zs.insert(e,t):this.Zs.remove(e),a=this.lo(this.Zs),n=this.lo(r),s=[],i=[];return n.forEach(e=>{a.has(e)||s.push(e)}),a.forEach(e=>{n.has(e)||i.push(e)}),this.syncEngine.Fo(s,i).then(()=>{this.Zs=r})}co(e){this.Zs.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}lo(e){let t=yn();return e.forEach((e,r)=>{t=t.unionWith(r.activeTargetIds)}),t}}class Rl{constructor(){this.Mo=new Ll,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e){return(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,r){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new Ll,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class Ol{Oo(e){}shutdown(){}}const Bl="ConnectivityMonitor";class zl{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){p(Bl,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){p(Bl,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let Ul=null;function Vl(){return null===Ul?Ul=268435456+Math.round(2147483648*Math.random()):Ul++,"0x"+Ul.toString(16)}const ql="RestConnection",Hl={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Gl{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),a=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko="projects/".concat(r,"/databases/").concat(a),this.Wo=this.databaseId.database===Ar?"project_id=".concat(r):"project_id=".concat(r,"&database_id=").concat(a)}Go(e,t,r,a,n){const s=Vl(),i=this.zo(e,t.toUriEncodedString());p(ql,"Sending RPC '".concat(e,"' ").concat(s,":"),i,r);const l={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(l,a,n);const{host:c}=new URL(i),d=o.isCloudWorkstation(c);return this.Jo(e,i,l,r,d).then(t=>(p(ql,"Received RPC '".concat(e,"' ").concat(s,": "),t),t),t=>{throw y(ql,"RPC '".concat(e,"' ").concat(s," failed with error: "),t,"url: ",i,"request:",r),t})}Ho(e,t,r,a,n,s){return this.Go(e,t,r,a,n)}jo(e,t,r){e["X-Goog-Api-Client"]="gl-js/ fire/"+m,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((t,r)=>e[r]=t),r&&r.headers.forEach((t,r)=>e[r]=t)}zo(e,t){const r=Hl[e];return"".concat(this.Uo,"/v1/").concat(t,":").concat(r)}terminate(){}}class Wl{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const Kl="WebChannelConnection";class Ql extends Gl{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,r,a,n){const s=Vl();return new Promise((n,i)=>{const o=new c.XhrIo;o.setWithCredentials(!0),o.listenOnce(c.EventType.COMPLETE,()=>{try{switch(o.getLastErrorCode()){case c.ErrorCode.NO_ERROR:const r=o.getResponseJson();p(Kl,"XHR for RPC '".concat(e,"' ").concat(s," received:"),JSON.stringify(r)),n(r);break;case c.ErrorCode.TIMEOUT:p(Kl,"RPC '".concat(e,"' ").concat(s," timed out")),i(new S(j.DEADLINE_EXCEEDED,"Request time out"));break;case c.ErrorCode.HTTP_ERROR:const a=o.getStatus();if(p(Kl,"RPC '".concat(e,"' ").concat(s," failed with status:"),a,"response text:",o.getResponseText()),a>0){var t;let e=o.getResponseJson();Array.isArray(e)&&(e=e[0]);const r=null===(t=e)||void 0===t?void 0:t.error;if(r&&r.status&&r.message){const e=function(e){const t=e.toLowerCase().replace(/_/g,"-");return Object.values(j).indexOf(t)>=0?t:j.UNKNOWN}(r.status);i(new S(e,r.message))}else i(new S(j.UNKNOWN,"Server responded with status "+o.getStatus()))}else i(new S(j.UNAVAILABLE,"Connection failed."));break;default:b(9055,{l_:e,streamId:s,h_:o.getLastErrorCode(),P_:o.getLastError()})}}finally{p(Kl,"RPC '".concat(e,"' ").concat(s," completed."))}});const l=JSON.stringify(a);p(Kl,"RPC '".concat(e,"' ").concat(s," sending request:"),a),o.send(t,"POST",l,r,15)})}T_(e,t,r){const a=Vl(),n=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=c.createWebChannelTransport(),i=c.getStatEventTarget(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/".concat(this.databaseId.projectId,"/databases/").concat(this.databaseId.database)},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;void 0!==l&&(o.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(o.useFetchStreams=!0),this.jo(o.initMessageHeaders,t,r),o.encodeInitMessageHeaders=!0;const d=n.join("");p(Kl,"Creating RPC '".concat(e,"' stream ").concat(a,": ").concat(d),o);const u=s.createWebChannel(d,o);this.I_(u);let h=!1,m=!1;const f=new Wl({Yo:t=>{m?p(Kl,"Not sending because RPC '".concat(e,"' stream ").concat(a," is closed:"),t):(h||(p(Kl,"Opening RPC '".concat(e,"' stream ").concat(a," transport.")),u.open(),h=!0),p(Kl,"RPC '".concat(e,"' stream ").concat(a," sending:"),t),u.send(t))},Zo:()=>u.close()}),g=(e,t,r)=>{e.listen(t,e=>{try{r(e)}catch(e){setTimeout(()=>{throw e},0)}})};return g(u,c.WebChannel.EventType.OPEN,()=>{m||(p(Kl,"RPC '".concat(e,"' stream ").concat(a," transport opened.")),f.o_())}),g(u,c.WebChannel.EventType.CLOSE,()=>{m||(m=!0,p(Kl,"RPC '".concat(e,"' stream ").concat(a," transport closed")),f.a_(),this.E_(u))}),g(u,c.WebChannel.EventType.ERROR,t=>{m||(m=!0,y(Kl,"RPC '".concat(e,"' stream ").concat(a," transport errored. Name:"),t.name,"Message:",t.message),f.a_(new S(j.UNAVAILABLE,"The operation could not be completed")))}),g(u,c.WebChannel.EventType.MESSAGE,t=>{if(!m){var r;const n=t.data[0];k(!!n,16349);const s=n,i=(null===s||void 0===s?void 0:s.error)||(null===(r=s[0])||void 0===r?void 0:r.error);if(i){p(Kl,"RPC '".concat(e,"' stream ").concat(a," received error:"),i);const t=i.status;let r=function(e){const t=rs[e];if(void 0!==t)return ss(t)}(t),n=i.message;void 0===r&&(r=j.INTERNAL,n="Unknown error status: "+t+" with message "+i.message),m=!0,f.a_(new S(r,n)),u.close()}else p(Kl,"RPC '".concat(e,"' stream ").concat(a," received:"),n),f.u_(n)}}),g(i,c.Event.STAT_EVENT,t=>{t.stat===c.Stat.PROXY?p(Kl,"RPC '".concat(e,"' stream ").concat(a," detected buffering proxy")):t.stat===c.Stat.NOPROXY&&p(Kl,"RPC '".concat(e,"' stream ").concat(a," detected no buffering proxy"))}),setTimeout(()=>{f.__()},0),f}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(t=>t===e)}}function Yl(){return"undefined"!=typeof window?window:null}function Xl(){return"undefined"!=typeof document?document:null}function Jl(e){return new Ss(e,!0)}class Zl{constructor(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1.5,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:6e4;this.Mi=e,this.timerId=t,this.d_=r,this.A_=a,this.R_=n,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),a=Math.max(0,t-r);a>0&&p("ExponentialBackoff","Backing off for ".concat(a," ms (base delay: ").concat(this.V_," ms, delay with jitter: ").concat(t," ms, last attempt: ").concat(r," ms ago)")),this.m_=this.Mi.enqueueAfterDelay(this.timerId,a,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){null!==this.m_&&(this.m_.skipDelay(),this.m_=null)}cancel(){null!==this.m_&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const $l="PersistentStream";class ec{constructor(e,t,r,a,n,s,i,o){this.Mi=e,this.S_=r,this.b_=a,this.connection=n,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=i,this.listener=o,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new Zl(e,t)}x_(){return 1===this.state||5===this.state||this.O_()}O_(){return 2===this.state||3===this.state}start(){this.F_=0,4!==this.state?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&null===this.C_&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,4!==e?this.M_.reset():t&&t.code===j.RESOURCE_EXHAUSTED?(x(t.toString()),x("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===j.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(e=>{let[r,a]=e;this.D_===t&&this.G_(r,a)},t=>{e(()=>{const e=new S(j.UNKNOWN,"Fetching auth token failed: "+t.message);return this.z_(e)})})}G_(e,t){const r=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo(()=>{r(()=>this.listener.Xo())}),this.stream.t_(()=>{r(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(e=>{r(()=>this.z_(e))}),this.stream.onMessage(e=>{r(()=>1==++this.F_?this.J_(e):this.onNext(e))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return p($l,"close with error: ".concat(e)),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget(()=>this.D_===e?t():(p($l,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class tc extends ec{constructor(e,t,r,a,n,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,a,s),this.serializer=n}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=function(e,t){let r;if("targetChange"in t){t.targetChange;const a=function(e){return"NO_CHANGE"===e?0:"ADD"===e?1:"REMOVE"===e?2:"CURRENT"===e?3:"RESET"===e?4:b(39313,{state:e})}(t.targetChange.targetChangeType||"NO_CHANGE"),n=t.targetChange.targetIds||[],s=function(e,t){return e.useProto3Json?(k(void 0===t||"string"==typeof t,58123),gr.fromBase64String(t||"")):(k(void 0===t||t instanceof Buffer||t instanceof Uint8Array,16193),gr.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),i=t.targetChange.cause,o=i&&function(e){const t=void 0===e.code?j.UNKNOWN:ss(e.code);return new S(t,e.message||"")}(i);r=new xs(a,n,s,o||null)}else if("documentChange"in t){t.documentChange;const a=t.documentChange;a.document,a.document.name,a.document.updateTime;const n=Ls(e,a.document.name),s=Is(a.document.updateTime),i=a.document.createTime?Is(a.document.createTime):ce.min(),o=new sa({mapValue:{fields:a.document.fields}}),l=oa.newFoundDocument(n,s,i,o),c=a.targetIds||[],d=a.removedTargetIds||[];r=new gs(c,d,l.key,l)}else if("documentDelete"in t){t.documentDelete;const a=t.documentDelete;a.document;const n=Ls(e,a.document),s=a.readTime?Is(a.readTime):ce.min(),i=oa.newNoDocument(n,s),o=a.removedTargetIds||[];r=new gs([],o,i.key,i)}else if("documentRemove"in t){t.documentRemove;const a=t.documentRemove;a.document;const n=Ls(e,a.document),s=a.removedTargetIds||[];r=new gs([],s,n,null)}else{if(!("filter"in t))return b(11601,{Rt:t});{t.filter;const e=t.filter;e.targetId;const{count:a=0,unchangedNames:n}=e,s=new ts(a,n),i=e.targetId;r=new ps(i,s)}}return r}(this.serializer,e),r=function(e){if(!("targetChange"in e))return ce.min();const t=e.targetChange;return t.targetIds&&t.targetIds.length?ce.min():t.readTime?Is(t.readTime):ce.min()}(e);return this.listener.H_(t,r)}Y_(e){const t={};t.database=Os(this.serializer),t.addTarget=function(e,t){let r;const a=t.target;if(r=Ma(a)?{documents:Hs(e,a)}:{query:Gs(e,a).ft},r.targetId=t.targetId,t.resumeToken.approximateByteSize()>0){r.resumeToken=As(e,t.resumeToken);const a=_s(e,t.expectedCount);null!==a&&(r.expectedCount=a)}else if(t.snapshotVersion.compareTo(ce.min())>0){r.readTime=Es(e,t.snapshotVersion.toTimestamp());const a=_s(e,t.expectedCount);null!==a&&(r.expectedCount=a)}return r}(this.serializer,e);const r=function(e,t){const r=function(e){switch(e){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return b(28987,{purpose:e})}}(t.purpose);return null==r?null:{"goog-listen-tags":r}}(this.serializer,e);r&&(t.labels=r),this.q_(t)}Z_(e){const t={};t.database=Os(this.serializer),t.removeTarget=e,this.q_(t)}}class rc extends ec{constructor(e,t,r,a,n,s){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,a,s),this.serializer=n}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return k(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,k(!e.writeResults||0===e.writeResults.length,55816),this.listener.ta()}onNext(e){k(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=function(e,t){return e&&e.length>0?(k(void 0!==t,14353),e.map(e=>function(e,t){let r=e.updateTime?Is(e.updateTime):Is(t);return r.isEqual(ce.min())&&(r=Is(t)),new Ln(r,e.transformResults||[])}(e,t))):[]}(e.writeResults,e.commitTime),r=Is(e.commitTime);return this.listener.na(r,t)}ra(){const e={};e.database=Os(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map(e=>Vs(this.serializer,e))};this.q_(t)}}class ac{}class nc extends ac{constructor(e,t,r,a){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=a,this.ia=!1}sa(){if(this.ia)throw new S(j.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,r,a){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(n=>{let[s,i]=n;return this.connection.Go(e,Ds(t,r),a,s,i)}).catch(e=>{throw"FirebaseError"===e.name?(e.code===j.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new S(j.UNKNOWN,e.toString())})}Ho(e,t,r,a,n){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(s=>{let[i,o]=s;return this.connection.Ho(e,Ds(t,r),a,i,o,n)}).catch(e=>{throw"FirebaseError"===e.name?(e.code===j.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new S(j.UNKNOWN,e.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class sc{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){0===this.oa&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){"Online"===this.state?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la("Connection failed 1 times. Most recent error: ".concat(e.toString())),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,"Online"===e&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t="Could not reach Cloud Firestore backend. ".concat(e,"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.");this.aa?(x(t),this.aa=!1):p("OnlineStateTracker",t)}Pa(){null!==this._a&&(this._a.cancel(),this._a=null)}}const ic="RemoteStore";class oc{constructor(e,t,r,a,n){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=n,this.Aa.Oo(e=>{r.enqueueAndForget(async()=>{pc(this)&&(p(ic,"Restarting streams for network reachability change."),await async function(e){const t=N(e);t.Ea.add(4),await cc(t),t.Ra.set("Unknown"),t.Ea.delete(4),await lc(t)}(this))})}),this.Ra=new sc(r,a)}}async function lc(e){if(pc(e))for(const t of e.da)await t(!0)}async function cc(e){for(const t of e.da)await t(!1)}function dc(e,t){const r=N(e);r.Ia.has(t.targetId)||(r.Ia.set(t.targetId,t),gc(r)?fc(r):Lc(r).O_()&&hc(r,t))}function uc(e,t){const r=N(e),a=Lc(r);r.Ia.delete(t),a.O_()&&mc(r,t),0===r.Ia.size&&(a.O_()?a.L_():pc(r)&&r.Ra.set("Unknown"))}function hc(e,t){if(e.Va.Ue(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(ce.min())>0){const r=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(r)}Lc(e).Y_(t)}function mc(e,t){e.Va.Ue(t),Lc(e).Z_(t)}function fc(e){e.Va=new vs({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),At:t=>e.Ia.get(t)||null,ht:()=>e.datastore.serializer.databaseId}),Lc(e).start(),e.Ra.ua()}function gc(e){return pc(e)&&!Lc(e).x_()&&e.Ia.size>0}function pc(e){return 0===N(e).Ea.size}function xc(e){e.Va=void 0}async function yc(e){e.Ra.set("Online")}async function vc(e){e.Ia.forEach((t,r)=>{hc(e,t)})}async function bc(e,t){xc(e),gc(e)?(e.Ra.ha(t),fc(e)):e.Ra.set("Unknown")}async function wc(e,t,r){if(e.Ra.set("Online"),t instanceof xs&&2===t.state&&t.cause)try{await async function(e,t){const r=t.cause;for(const a of t.targetIds)e.Ia.has(a)&&(await e.remoteSyncer.rejectListen(a,r),e.Ia.delete(a),e.Va.removeTarget(a))}(e,t)}catch(r){p(ic,"Failed to remove targets %s: %s ",t.targetIds.join(","),r),await kc(e,r)}else if(t instanceof gs?e.Va.Ze(t):t instanceof ps?e.Va.st(t):e.Va.tt(t),!r.isEqual(ce.min()))try{const t=await fl(e.localStore);r.compareTo(t)>=0&&await function(e,t){const r=e.Va.Tt(t);return r.targetChanges.forEach((r,a)=>{if(r.resumeToken.approximateByteSize()>0){const n=e.Ia.get(a);n&&e.Ia.set(a,n.withResumeToken(r.resumeToken,t))}}),r.targetMismatches.forEach((t,r)=>{const a=e.Ia.get(t);if(!a)return;e.Ia.set(t,a.withResumeToken(gr.EMPTY_BYTE_STRING,a.snapshotVersion)),mc(e,t);const n=new ai(a.target,t,r,a.sequenceNumber);hc(e,n)}),e.remoteSyncer.applyRemoteEvent(r)}(e,r)}catch(t){p(ic,"Failed to raise snapshot:",t),await kc(e,t)}}async function kc(e,t,r){if(!De(t))throw t;e.Ea.add(1),await cc(e),e.Ra.set("Offline"),r||(r=()=>fl(e.localStore)),e.asyncQueue.enqueueRetryable(async()=>{p(ic,"Retrying IndexedDB access"),await r(),e.Ea.delete(1),await lc(e)})}function Nc(e,t){return t().catch(r=>kc(e,r,t))}async function jc(e){const t=N(e),r=Mc(t);let a=t.Ta.length>0?t.Ta[t.Ta.length-1].batchId:Ue;for(;Sc(t);)try{const e=await pl(t.localStore,a);if(null===e){0===t.Ta.length&&r.L_();break}a=e.batchId,_c(t,e)}catch(e){await kc(t,e)}Ec(t)&&Ac(t)}function Sc(e){return pc(e)&&e.Ta.length<10}function _c(e,t){e.Ta.push(t);const r=Mc(e);r.O_()&&r.X_&&r.ea(t.mutations)}function Ec(e){return pc(e)&&!Mc(e).x_()&&e.Ta.length>0}function Ac(e){Mc(e).start()}async function Cc(e){Mc(e).ra()}async function Ic(e){const t=Mc(e);for(const r of e.Ta)t.ea(r.mutations)}async function Tc(e,t,r){const a=e.Ta.shift(),n=Zn.from(a,t,r);await Nc(e,()=>e.remoteSyncer.applySuccessfulWrite(n)),await jc(e)}async function Dc(e,t){t&&Mc(e).X_&&await async function(e,t){if(function(e){return ns(e)&&e!==j.ABORTED}(t.code)){const r=e.Ta.shift();Mc(e).B_(),await Nc(e,()=>e.remoteSyncer.rejectFailedWrite(r.batchId,t)),await jc(e)}}(e,t),Ec(e)&&Ac(e)}async function Pc(e,t){const r=N(e);r.asyncQueue.verifyOperationInProgress(),p(ic,"RemoteStore received new credentials");const a=pc(r);r.Ea.add(3),await cc(r),a&&r.Ra.set("Unknown"),await r.remoteSyncer.handleCredentialChange(t),r.Ea.delete(3),await lc(r)}async function Fc(e,t){const r=N(e);t?(r.Ea.delete(2),await lc(r)):t||(r.Ea.add(2),await cc(r),r.Ra.set("Unknown"))}function Lc(e){return e.ma||(e.ma=function(e,t,r){const a=N(e);return a.sa(),new tc(t,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,r)}(e.datastore,e.asyncQueue,{Xo:yc.bind(null,e),t_:vc.bind(null,e),r_:bc.bind(null,e),H_:wc.bind(null,e)}),e.da.push(async t=>{t?(e.ma.B_(),gc(e)?fc(e):e.Ra.set("Unknown")):(await e.ma.stop(),xc(e))})),e.ma}function Mc(e){return e.fa||(e.fa=function(e,t,r){const a=N(e);return a.sa(),new rc(t,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,r)}(e.datastore,e.asyncQueue,{Xo:()=>Promise.resolve(),t_:Cc.bind(null,e),r_:Dc.bind(null,e),ta:Ic.bind(null,e),na:Tc.bind(null,e)}),e.da.push(async t=>{t?(e.fa.B_(),await jc(e)):(await e.fa.stop(),e.Ta.length>0&&(p(ic,"Stopping write stream with ".concat(e.Ta.length," pending writes")),e.Ta=[]))})),e.fa}class Rc{constructor(e,t,r,a,n){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=a,this.removalCallback=n,this.deferred=new _,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(e=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,a,n){const s=Date.now()+r,i=new Rc(e,t,s,a,n);return i.start(r),i}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new S(j.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Oc(e,t){if(x("AsyncQueue","".concat(t,": ").concat(e)),De(e))return new S(j.UNAVAILABLE,"".concat(t,": ").concat(e));throw e}class Bc{static emptySet(e){return new Bc(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||Y.comparator(t.key,r.key):(e,t)=>Y.comparator(e.key,t.key),this.keyedMap=cn(),this.sortedSet=new or(this.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Bc))return!1;if(this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const e=t.getNext().key,a=r.getNext().key;if(!e.isEqual(a))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const r=new Bc;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}class zc{constructor(){this.ga=new or(Y.comparator)}track(e){const t=e.doc.key,r=this.ga.get(t);r?0!==e.type&&3===r.type?this.ga=this.ga.insert(t,e):3===e.type&&1!==r.type?this.ga=this.ga.insert(t,{type:r.type,doc:e.doc}):2===e.type&&2===r.type?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):2===e.type&&0===r.type?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):1===e.type&&0===r.type?this.ga=this.ga.remove(t):1===e.type&&2===r.type?this.ga=this.ga.insert(t,{type:1,doc:r.doc}):0===e.type&&1===r.type?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):b(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal((t,r)=>{e.push(r)}),e}}class Uc{constructor(e,t,r,a,n,s,i,o,l){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=a,this.mutatedKeys=n,this.fromCache=s,this.syncStateChanged=i,this.excludesMetadataChanges=o,this.hasCachedResults=l}static fromInitialDocuments(e,t,r,a,n){const s=[];return t.forEach(e=>{s.push({type:0,doc:e})}),new Uc(e,t,Bc.emptySet(t),s,r,a,!0,!1,n)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Ja(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let a=0;a<t.length;a++)if(t[a].type!==r[a].type||!t[a].doc.isEqual(r[a].doc))return!1;return!0}}class Vc{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class qc{constructor(){this.queries=Hc(),this.onlineState="Unknown",this.Ca=new Set}terminate(){!function(e,t){const r=N(e),a=r.queries;r.queries=Hc(),a.forEach((e,r)=>{for(const a of r.Sa)a.onError(t)})}(this,new S(j.ABORTED,"Firestore shutting down"))}}function Hc(){return new nn(e=>Za(e),Ja)}async function Gc(e,t){const r=N(e);let a=3;const n=t.query;let s=r.queries.get(n);s?!s.ba()&&t.Da()&&(a=2):(s=new Vc,a=t.Da()?0:1);try{switch(a){case 0:s.wa=await r.onListen(n,!0);break;case 1:s.wa=await r.onListen(n,!1);break;case 2:await r.onFirstRemoteStoreListen(n)}}catch(e){const r=Oc(e,"Initialization of query '".concat($a(t.query),"' failed"));return void t.onError(r)}r.queries.set(n,s),s.Sa.push(t),t.va(r.onlineState),s.wa&&t.Fa(s.wa)&&Yc(r)}async function Wc(e,t){const r=N(e),a=t.query;let n=3;const s=r.queries.get(a);if(s){const e=s.Sa.indexOf(t);e>=0&&(s.Sa.splice(e,1),0===s.Sa.length?n=t.Da()?0:1:!s.ba()&&t.Da()&&(n=2))}switch(n){case 0:return r.queries.delete(a),r.onUnlisten(a,!0);case 1:return r.queries.delete(a),r.onUnlisten(a,!1);case 2:return r.onLastRemoteStoreUnlisten(a);default:return}}function Kc(e,t){const r=N(e);let a=!1;for(const n of t){const e=n.query,t=r.queries.get(e);if(t){for(const e of t.Sa)e.Fa(n)&&(a=!0);t.wa=n}}a&&Yc(r)}function Qc(e,t,r){const a=N(e),n=a.queries.get(t);if(n)for(const s of n.Sa)s.onError(r);a.queries.delete(t)}function Yc(e){e.Ca.forEach(e=>{e.next()})}var Xc,Jc;(Jc=Xc||(Xc={})).Ma="default",Jc.Cache="cache";class Zc{constructor(e,t,r){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){const t=[];for(const r of e.docChanges)3!==r.type&&t.push(r);e=new Uc(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache)return!0;if(!this.Da())return!0;const r="Offline"!==t;return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}ka(e){e=Uc.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Xc.Cache}}class $c{constructor(e,t){this.Qa=e,this.byteLength=t}$a(){return"metadata"in this.Qa}}class ed{constructor(e){this.serializer=e}$s(e){return Ls(this.serializer,e)}Us(e){return e.metadata.exists?Us(this.serializer,e.document,!1):oa.newNoDocument(this.$s(e.metadata.name),this.Ks(e.metadata.readTime))}Ks(e){return Is(e)}}class td{constructor(e,t){this.Ua=e,this.serializer=t,this.Ka=[],this.Wa=[],this.collectionGroups=new Set,this.progress=rd(e)}get queries(){return this.Ka}get documents(){return this.Wa}Ga(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.Qa.namedQuery)this.Ka.push(e.Qa.namedQuery);else if(e.Qa.documentMetadata){this.Wa.push({metadata:e.Qa.documentMetadata}),e.Qa.documentMetadata.exists||++t;const r=W.fromString(e.Qa.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.Qa.document&&(this.Wa[this.Wa.length-1].document=e.Qa.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,a({},this.progress)):null}za(e){const t=new Map,r=new ed(this.serializer);for(const a of e)if(a.metadata.queries){const e=r.$s(a.metadata.name);for(const r of a.metadata.queries){const a=(t.get(r)||pn()).add(e);t.set(r,a)}}return t}async ja(e){const t=await async function(e,t,r,a){const n=N(e);let s=pn(),i=on();for(const c of r){const e=t.$s(c.metadata.name);c.document&&(s=s.add(e));const r=t.Us(c);r.setReadTime(t.Ks(c.metadata.readTime)),i=i.insert(e,r)}const o=n.Ns.newChangeBuffer({trackRemovals:!0}),l=await xl(n,function(e){return Wa(Va(W.fromString("__bundle__/docs/".concat(e))))}(a));return n.persistence.runTransaction("Apply bundle documents","readwrite",e=>gl(e,o,i).next(t=>(o.apply(e),t)).next(t=>n.Pi.removeMatchingKeysForTargetId(e,l.targetId).next(()=>n.Pi.addMatchingKeys(e,s,l.targetId)).next(()=>n.localDocuments.getLocalViewOfDocuments(e,t.ks,t.qs)).next(()=>t.ks)))}(e,new ed(this.serializer),this.Wa,this.Ua.id),r=this.za(this.documents);for(const a of this.Ka)await Nl(e,a,r.get(a.name));return this.progress.taskState="Success",{progress:this.progress,Ja:this.collectionGroups,Ha:t}}}function rd(e){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:e.totalDocuments,totalBytes:e.totalBytes}}class ad{constructor(e){this.key=e}}class nd{constructor(e){this.key=e}}class sd{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=pn(),this.mutatedKeys=pn(),this.eu=rn(e),this.tu=new Bc(this.eu)}get nu(){return this.Ya}ru(e,t){const r=t?t.iu:new zc,a=t?t.tu:this.tu;let n=t?t.mutatedKeys:this.mutatedKeys,s=a,i=!1;const o="F"===this.query.limitType&&a.size===this.query.limit?a.last():null,l="L"===this.query.limitType&&a.size===this.query.limit?a.first():null;if(e.inorderTraversal((e,t)=>{const c=a.get(e),d=en(this.query,t)?t:null,u=!!c&&this.mutatedKeys.has(c.key),h=!!d&&(d.hasLocalMutations||this.mutatedKeys.has(d.key)&&d.hasCommittedMutations);let m=!1;c&&d?c.data.isEqual(d.data)?u!==h&&(r.track({type:3,doc:d}),m=!0):this.su(c,d)||(r.track({type:2,doc:d}),m=!0,(o&&this.eu(d,o)>0||l&&this.eu(d,l)<0)&&(i=!0)):!c&&d?(r.track({type:0,doc:d}),m=!0):c&&!d&&(r.track({type:1,doc:c}),m=!0,(o||l)&&(i=!0)),m&&(d?(s=s.add(d),n=h?n.add(e):n.delete(e)):(s=s.delete(e),n=n.delete(e)))}),null!==this.query.limit)for(;s.size>this.query.limit;){const e="F"===this.query.limitType?s.last():s.first();s=s.delete(e.key),n=n.delete(e.key),r.track({type:1,doc:e})}return{tu:s,iu:r,Cs:i,mutatedKeys:n}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,a){const n=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const s=e.iu.ya();s.sort((e,t)=>function(e,t){const r=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return b(20277,{Rt:e})}};return r(e)-r(t)}(e.type,t.type)||this.eu(e.doc,t.doc)),this.ou(r),a=null!==a&&void 0!==a&&a;const i=t&&!a?this._u():[],o=0===this.Xa.size&&this.current&&!a?1:0,l=o!==this.Za;return this.Za=o,0!==s.length||l?{snapshot:new Uc(this.query,e.tu,n,s,e.mutatedKeys,0===o,l,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:i}:{au:i}}va(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({tu:this.tu,iu:new zc,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(e=>this.Ya=this.Ya.add(e)),e.modifiedDocuments.forEach(e=>{}),e.removedDocuments.forEach(e=>this.Ya=this.Ya.delete(e)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=pn(),this.tu.forEach(e=>{this.uu(e.key)&&(this.Xa=this.Xa.add(e.key))});const t=[];return e.forEach(e=>{this.Xa.has(e)||t.push(new nd(e))}),this.Xa.forEach(r=>{e.has(r)||t.push(new ad(r))}),t}cu(e){this.Ya=e.Qs,this.Xa=pn();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return Uc.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,0===this.Za,this.hasCachedResults)}}const id="SyncEngine";class od{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class ld{constructor(e){this.key=e,this.hu=!1}}class cd{constructor(e,t,r,a,n,s){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=a,this.currentUser=n,this.maxConcurrentLimboResolutions=s,this.Pu={},this.Tu=new nn(e=>Za(e),Ja),this.Iu=new Map,this.Eu=new Set,this.du=new or(Y.comparator),this.Au=new Map,this.Ru=new zo,this.Vu={},this.mu=new Map,this.fu=ho.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return!0===this.gu}}async function dd(e,t){let r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const a=Bd(e);let n;const s=a.Tu.get(t);return s?(a.sharedClientState.addLocalQueryTarget(s.targetId),n=s.view.lu()):n=await hd(a,t,r,!0),n}async function ud(e,t){const r=Bd(e);await hd(r,t,!0,!1)}async function hd(e,t,r,a){const n=await xl(e.localStore,Wa(t)),s=n.targetId,i=e.sharedClientState.addLocalQueryTarget(s,r);let o;return a&&(o=await md(e,t,s,"current"===i,n.resumeToken)),e.isPrimaryClient&&r&&dc(e.remoteStore,n),o}async function md(e,t,r,a,n){e.pu=(t,r,a)=>async function(e,t,r,a){let n=t.view.ru(r);n.Cs&&(n=await vl(e.localStore,t.query,!1).then(e=>{let{documents:r}=e;return t.view.ru(r,n)}));const s=a&&a.targetChanges.get(t.targetId),i=a&&null!=a.targetMismatches.get(t.targetId),o=t.view.applyChanges(n,e.isPrimaryClient,s,i);return Sd(e,t.targetId,o.au),o.snapshot}(e,t,r,a);const s=await vl(e.localStore,t,!0),i=new sd(t,s.Qs),o=i.ru(s.documents),l=fs.createSynthesizedTargetChangeForCurrentChange(r,a&&"Offline"!==e.onlineState,n),c=i.applyChanges(o,e.isPrimaryClient,l);Sd(e,r,c.au);const d=new od(t,r,i);return e.Tu.set(t,d),e.Iu.has(r)?e.Iu.get(r).push(t):e.Iu.set(r,[t]),c.snapshot}async function fd(e,t,r){const a=N(e),n=a.Tu.get(t),s=a.Iu.get(n.targetId);if(s.length>1)return a.Iu.set(n.targetId,s.filter(e=>!Ja(e,t))),void a.Tu.delete(t);a.isPrimaryClient?(a.sharedClientState.removeLocalQueryTarget(n.targetId),a.sharedClientState.isActiveQueryTarget(n.targetId)||await yl(a.localStore,n.targetId,!1).then(()=>{a.sharedClientState.clearQueryState(n.targetId),r&&uc(a.remoteStore,n.targetId),Nd(a,n.targetId)}).catch(je)):(Nd(a,n.targetId),await yl(a.localStore,n.targetId,!0))}async function gd(e,t){const r=N(e),a=r.Tu.get(t),n=r.Iu.get(a.targetId);r.isPrimaryClient&&1===n.length&&(r.sharedClientState.removeLocalQueryTarget(a.targetId),uc(r.remoteStore,a.targetId))}async function pd(e,t){const r=N(e);try{const e=await function(e,t){const r=N(e),a=t.snapshotVersion;let n=r.Ms;return r.persistence.runTransaction("Apply remote event","readwrite-primary",e=>{const s=r.Ns.newChangeBuffer({trackRemovals:!0});n=r.Ms;const i=[];t.targetChanges.forEach((s,o)=>{const l=n.get(o);if(!l)return;i.push(r.Pi.removeMatchingKeys(e,s.removedDocuments,o).next(()=>r.Pi.addMatchingKeys(e,s.addedDocuments,o)));let c=l.withSequenceNumber(e.currentSequenceNumber);null!==t.targetMismatches.get(o)?c=c.withResumeToken(gr.EMPTY_BYTE_STRING,ce.min()).withLastLimboFreeSnapshotVersion(ce.min()):s.resumeToken.approximateByteSize()>0&&(c=c.withResumeToken(s.resumeToken,a)),n=n.insert(o,c),function(e,t,r){return 0===e.resumeToken.approximateByteSize()||(t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=3e8||r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size>0)}(l,c,s)&&i.push(r.Pi.updateTargetData(e,c))});let o=on(),l=pn();if(t.documentUpdates.forEach(a=>{t.resolvedLimboDocuments.has(a)&&i.push(r.persistence.referenceDelegate.updateLimboDocument(e,a))}),i.push(gl(e,s,t.documentUpdates).next(e=>{o=e.ks,l=e.qs})),!a.isEqual(ce.min())){const t=r.Pi.getLastRemoteSnapshotVersion(e).next(t=>r.Pi.setTargetsMetadata(e,e.currentSequenceNumber,a));i.push(t)}return Se.waitFor(i).next(()=>s.apply(e)).next(()=>r.localDocuments.getLocalViewOfDocuments(e,o,l)).next(()=>o)}).then(e=>(r.Ms=n,e))}(r.localStore,t);t.targetChanges.forEach((e,t)=>{const a=r.Au.get(t);a&&(k(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1,22616),e.addedDocuments.size>0?a.hu=!0:e.modifiedDocuments.size>0?k(a.hu,14607):e.removedDocuments.size>0&&(k(a.hu,42227),a.hu=!1))}),await Ad(r,e,t)}catch(e){await je(e)}}function xd(e,t,r){const a=N(e);if(a.isPrimaryClient&&0===r||!a.isPrimaryClient&&1===r){const e=[];a.Tu.forEach((r,a)=>{const n=a.view.va(t);n.snapshot&&e.push(n.snapshot)}),function(e,t){const r=N(e);r.onlineState=t;let a=!1;r.queries.forEach((e,r)=>{for(const n of r.Sa)n.va(t)&&(a=!0)}),a&&Yc(r)}(a.eventManager,t),e.length&&a.Pu.H_(e),a.onlineState=t,a.isPrimaryClient&&a.sharedClientState.setOnlineState(t)}}async function yd(e,t,r){const a=N(e);a.sharedClientState.updateQueryState(t,"rejected",r);const n=a.Au.get(t),s=n&&n.key;if(s){let e=new or(Y.comparator);e=e.insert(s,oa.newNoDocument(s,ce.min()));const r=pn().add(s),n=new ms(ce.min(),new Map,new or(R),e,r);await pd(a,n),a.du=a.du.remove(s),a.Au.delete(t),Ed(a)}else await yl(a.localStore,t,!1).then(()=>Nd(a,t,r)).catch(je)}async function vd(e,t){const r=N(e),a=t.batch.batchId;try{const e=await function(e,t){const r=N(e);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",e=>{const a=t.batch.keys(),n=r.Ns.newChangeBuffer({trackRemovals:!0});return function(e,t,r,a){const n=r.batch,s=n.keys();let i=Se.resolve();return s.forEach(e=>{i=i.next(()=>a.getEntry(t,e)).next(t=>{const s=r.docVersions.get(e);k(null!==s,48541),t.version.compareTo(s)<0&&(n.applyToRemoteDocument(t,r),t.isValidDocument()&&(t.setReadTime(r.commitVersion),a.addEntry(t)))})}),i.next(()=>e.mutationQueue.removeMutationBatch(t,n))}(r,e,t,n).next(()=>n.apply(e)).next(()=>r.mutationQueue.performConsistencyCheck(e)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(e,a,t.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){let t=pn();for(let r=0;r<e.mutationResults.length;++r)e.mutationResults[r].transformResults.length>0&&(t=t.add(e.batch.mutations[r].key));return t}(t))).next(()=>r.localDocuments.getDocuments(e,a))})}(r.localStore,t);kd(r,a,null),wd(r,a),r.sharedClientState.updateMutationState(a,"acknowledged"),await Ad(r,e)}catch(e){await je(e)}}async function bd(e,t,r){const a=N(e);try{const e=await function(e,t){const r=N(e);return r.persistence.runTransaction("Reject batch","readwrite-primary",e=>{let a;return r.mutationQueue.lookupMutationBatch(e,t).next(t=>(k(null!==t,37113),a=t.keys(),r.mutationQueue.removeMutationBatch(e,t))).next(()=>r.mutationQueue.performConsistencyCheck(e)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(e,a,t)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,a)).next(()=>r.localDocuments.getDocuments(e,a))})}(a.localStore,t);kd(a,t,r),wd(a,t),a.sharedClientState.updateMutationState(t,"rejected",r),await Ad(a,e)}catch(r){await je(r)}}function wd(e,t){(e.mu.get(t)||[]).forEach(e=>{e.resolve()}),e.mu.delete(t)}function kd(e,t,r){const a=N(e);let n=a.Vu[a.currentUser.toKey()];if(n){const e=n.get(t);e&&(r?e.reject(r):e.resolve(),n=n.remove(t)),a.Vu[a.currentUser.toKey()]=n}}function Nd(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e.sharedClientState.removeLocalQueryTarget(t);for(const a of e.Iu.get(t))e.Tu.delete(a),r&&e.Pu.yu(a,r);e.Iu.delete(t),e.isPrimaryClient&&e.Ru.jr(t).forEach(t=>{e.Ru.containsKey(t)||jd(e,t)})}function jd(e,t){e.Eu.delete(t.path.canonicalString());const r=e.du.get(t);null!==r&&(uc(e.remoteStore,r),e.du=e.du.remove(t),e.Au.delete(r),Ed(e))}function Sd(e,t,r){for(const a of r)a instanceof ad?(e.Ru.addReference(a.key,t),_d(e,a)):a instanceof nd?(p(id,"Document no longer in limbo: "+a.key),e.Ru.removeReference(a.key,t),e.Ru.containsKey(a.key)||jd(e,a.key)):b(19791,{wu:a})}function _d(e,t){const r=t.key,a=r.path.canonicalString();e.du.get(r)||e.Eu.has(a)||(p(id,"New document in limbo: "+r),e.Eu.add(a),Ed(e))}function Ed(e){for(;e.Eu.size>0&&e.du.size<e.maxConcurrentLimboResolutions;){const t=e.Eu.values().next().value;e.Eu.delete(t);const r=new Y(W.fromString(t)),a=e.fu.next();e.Au.set(a,new ld(r)),e.du=e.du.insert(r,a),dc(e.remoteStore,new ai(Wa(Va(r.path)),a,"TargetPurposeLimboResolution",ze.ce))}}async function Ad(e,t,r){const a=N(e),n=[],s=[],i=[];a.Tu.isEmpty()||(a.Tu.forEach((e,o)=>{i.push(a.pu(o,t,r).then(e=>{if((e||r)&&a.isPrimaryClient){var t;const n=e?!e.fromCache:null===r||void 0===r||null===(t=r.targetChanges.get(o.targetId))||void 0===t?void 0:t.current;a.sharedClientState.updateQueryState(o.targetId,n?"current":"not-current")}if(e){n.push(e);const t=ol.As(o.targetId,e);s.push(t)}}))}),await Promise.all(i),a.Pu.H_(n),await async function(e,t){const r=N(e);try{await r.persistence.runTransaction("notifyLocalViewChanges","readwrite",e=>Se.forEach(t,t=>Se.forEach(t.Es,a=>r.persistence.referenceDelegate.addReference(e,t.targetId,a)).next(()=>Se.forEach(t.ds,a=>r.persistence.referenceDelegate.removeReference(e,t.targetId,a)))))}catch(e){if(!De(e))throw e;p(dl,"Failed to update sequence numbers: "+e)}for(const a of t){const e=a.targetId;if(!a.fromCache){const t=r.Ms.get(e),a=t.snapshotVersion,n=t.withLastLimboFreeSnapshotVersion(a);r.Ms=r.Ms.insert(e,n)}}}(a.localStore,s))}async function Cd(e,t){const r=N(e);if(!r.currentUser.isEqual(t)){p(id,"User change. New user:",t.toKey());const e=await ml(r.localStore,t);r.currentUser=t,function(e,t){e.mu.forEach(e=>{e.forEach(e=>{e.reject(new S(j.CANCELLED,t))})}),e.mu.clear()}(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(t,e.removedBatchIds,e.addedBatchIds),await Ad(r,e.Ls)}}function Id(e,t){const r=N(e),a=r.Au.get(t);if(a&&a.hu)return pn().add(a.key);{let e=pn();const a=r.Iu.get(t);if(!a)return e;for(const t of a){const a=r.Tu.get(t);e=e.unionWith(a.view.nu)}return e}}async function Td(e,t){const r=N(e),a=await vl(r.localStore,t.query,!0),n=t.view.cu(a);return r.isPrimaryClient&&Sd(r,t.targetId,n.au),n}async function Dd(e,t){const r=N(e);return wl(r.localStore,t).then(e=>Ad(r,e))}async function Pd(e,t,r,a){const n=N(e),s=await function(e,t){const r=N(e),a=N(r.mutationQueue);return r.persistence.runTransaction("Lookup mutation documents","readonly",e=>a.er(e,t).next(t=>t?r.localDocuments.getDocuments(e,t):Se.resolve(null)))}(n.localStore,t);null!==s?("pending"===r?await jc(n.remoteStore):"acknowledged"===r||"rejected"===r?(kd(n,t,a||null),wd(n,t),function(e,t){N(N(e).mutationQueue).ir(t)}(n.localStore,t)):b(6720,"Unknown batchState",{Su:r}),await Ad(n,s)):p(id,"Cannot apply mutation batch with id: "+t)}async function Fd(e,t,r){const a=N(e),n=[],s=[];for(const i of t){let e;const t=a.Iu.get(i);if(t&&0!==t.length){e=await xl(a.localStore,Wa(t[0]));for(const e of t){const t=a.Tu.get(e),r=await Td(a,t);r.snapshot&&s.push(r.snapshot)}}else{const t=await bl(a.localStore,i);e=await xl(a.localStore,t),await md(a,Ld(t),i,!1,e.resumeToken)}n.push(e)}return a.Pu.H_(s),n}function Ld(e){return Ua(e.path,e.collectionGroup,e.orderBy,e.filters,e.limit,"F",e.startAt,e.endAt)}function Md(e){return function(e){return N(N(e).persistence).Ts()}(N(e).localStore)}async function Rd(e,t,r,a){const n=N(e);if(n.gu)return void p(id,"Ignoring unexpected query state notification.");const s=n.Iu.get(t);if(s&&s.length>0)switch(r){case"current":case"not-current":{const e=await wl(n.localStore,tn(s[0])),a=ms.createSynthesizedRemoteEventForCurrentChange(t,"current"===r,gr.EMPTY_BYTE_STRING);await Ad(n,e,a);break}case"rejected":await yl(n.localStore,t,!0),Nd(n,t,a);break;default:b(64155,r)}}async function Od(e,t,r){const a=Bd(e);if(a.gu){for(const e of t){if(a.Iu.has(e)&&a.sharedClientState.isActiveQueryTarget(e)){p(id,"Adding an already active target "+e);continue}const t=await bl(a.localStore,e),r=await xl(a.localStore,t);await md(a,Ld(t),r.targetId,!1,r.resumeToken),dc(a.remoteStore,r)}for(const e of r)a.Iu.has(e)&&await yl(a.localStore,e,!1).then(()=>{uc(a.remoteStore,e),Nd(a,e)}).catch(je)}}function Bd(e){const t=N(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=pd.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=Id.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=yd.bind(null,t),t.Pu.H_=Kc.bind(null,t.eventManager),t.Pu.yu=Qc.bind(null,t.eventManager),t}function zd(e){const t=N(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=vd.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=bd.bind(null,t),t}class Ud{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Jl(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return hl(this.persistence,new cl,e.initialUser,this.serializer)}Cu(e){return new Wo(Qo.mi,this.serializer)}Du(e){return new Rl}async terminate(){var e,t;null!==(e=this.gcScheduler)&&void 0!==e&&e.stop(),null!==(t=this.indexBackfillerScheduler)&&void 0!==t&&t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Ud.provider={build:()=>new Ud};class Vd extends Ud{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){k(this.persistence.referenceDelegate instanceof Yo,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new wo(r,e.asyncQueue,t)}Cu(e){const t=void 0!==this.cacheSizeBytes?ao.withCacheSize(this.cacheSizeBytes):ao.DEFAULT;return new Wo(e=>Yo.mi(e,t),this.serializer)}}class qd extends Ud{constructor(e,t,r){super(),this.xu=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await zd(this.xu.syncEngine),await jc(this.xu.remoteStore),await this.persistence.Ji(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}vu(e){return hl(this.persistence,new cl,e.initialUser,this.serializer)}Fu(e,t){const r=this.persistence.referenceDelegate.garbageCollector;return new wo(r,e.asyncQueue,t)}Mu(e,t){const r=new Be(t,this.persistence);return new Oe(e.asyncQueue,r)}Cu(e){const t=il(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=void 0!==this.cacheSizeBytes?ao.withCacheSize(this.cacheSizeBytes):ao.DEFAULT;return new al(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,Yl(),Xl(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new Rl}}class Hd extends qd{constructor(e,t){super(e,t,!1),this.xu=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const t=this.xu.syncEngine;this.sharedClientState instanceof Ml&&(this.sharedClientState.syncEngine={Co:Pd.bind(null,t),vo:Rd.bind(null,t),Fo:Od.bind(null,t),Ts:Md.bind(null,t),Do:Dd.bind(null,t)},await this.sharedClientState.start()),await this.persistence.Ji(async e=>{await async function(e,t){const r=N(e);if(Bd(r),zd(r),!0===t&&!0!==r.gu){const e=r.sharedClientState.getAllActiveQueryTargets(),t=await Fd(r,e.toArray());r.gu=!0,await Fc(r.remoteStore,!0);for(const a of t)dc(r.remoteStore,a)}else if(!1===t&&!1!==r.gu){const e=[];let t=Promise.resolve();r.Iu.forEach((a,n)=>{r.sharedClientState.isLocalQueryTarget(n)?e.push(n):t=t.then(()=>(Nd(r,n),yl(r.localStore,n,!0))),uc(r.remoteStore,n)}),await t,await Fd(r,e),function(e){const t=N(e);t.Au.forEach((e,r)=>{uc(t.remoteStore,r)}),t.Ru.Jr(),t.Au=new Map,t.du=new or(Y.comparator)}(r),r.gu=!1,await Fc(r.remoteStore,!1)}}(this.xu.syncEngine,e),this.gcScheduler&&(e&&!this.gcScheduler.started?this.gcScheduler.start():e||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(e&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():e||this.indexBackfillerScheduler.stop())})}Du(e){const t=Yl();if(!Ml.v(t))throw new S(j.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=il(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Ml(t,e.asyncQueue,r,e.clientId,e.initialUser)}}class Gd{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>xd(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=Cd.bind(null,this.syncEngine),await Fc(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new qc}createDatastore(e){const t=Jl(e.databaseInfo.databaseId),r=function(e){return new Ql(e)}(e.databaseInfo);return function(e,t,r,a){return new nc(e,t,r,a)}(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return function(e,t,r,a,n){return new oc(e,t,r,a,n)}(this.localStore,this.datastore,e.asyncQueue,e=>xd(this.syncEngine,e,0),zl.v()?new zl:new Ol)}createSyncEngine(e,t){return function(e,t,r,a,n,s,i){const o=new cd(e,t,r,a,n,s);return i&&(o.gu=!0),o}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(e){const t=N(e);p(ic,"RemoteStore shutting down."),t.Ea.add(5),await cc(t),t.Aa.shutdown(),t.Ra.set("Unknown")}(this.remoteStore),null!==(e=this.datastore)&&void 0!==e&&e.terminate(),null===(t=this.eventManager)||void 0===t||t.terminate()}}function Wd(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10240,r=0;return{async read(){if(r<e.byteLength){const a={value:e.slice(r,r+t),done:!1};return r+=t,a}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}Gd.provider={build:()=>new Gd};class Kd{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):x("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout(()=>{this.muted||e(t)},0)}}class Qd{constructor(e,t){this.Bu=e,this.serializer=t,this.metadata=new _,this.buffer=new Uint8Array,this.Lu=new TextDecoder("utf-8"),this.ku().then(e=>{e&&e.$a()?this.metadata.resolve(e.Qa.metadata):this.metadata.reject(new Error("The first element of the bundle is not a metadata, it is\n             ".concat(JSON.stringify(null===e||void 0===e?void 0:e.Qa))))},e=>this.metadata.reject(e))}close(){return this.Bu.cancel()}async getMetadata(){return this.metadata.promise}async bu(){return await this.getMetadata(),this.ku()}async ku(){const e=await this.qu();if(null===e)return null;const t=this.Lu.decode(e),r=Number(t);isNaN(r)&&this.Qu("length string (".concat(t,") is not valid number"));const a=await this.$u(r);return new $c(JSON.parse(a),e.length+r)}Uu(){return this.buffer.findIndex(e=>e==="{".charCodeAt(0))}async qu(){for(;this.Uu()<0&&!await this.Ku(););if(0===this.buffer.length)return null;const e=this.Uu();e<0&&this.Qu("Reached the end of bundle when a length string is expected.");const t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t}async $u(e){for(;this.buffer.length<e;)await this.Ku()&&this.Qu("Reached the end of bundle when more is expected.");const t=this.Lu.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t}Qu(e){throw this.Bu.cancel(),new Error("Invalid bundle format: ".concat(e))}async Ku(){const e=await this.Bu.read();if(!e.done){const t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done}}class Yd{constructor(e,t){var r;this.bundleData=e,this.serializer=t,this.cursor=0,this.elements=[];let a=this.bu();if(!a||!a.$a())throw new Error("The first element of the bundle is not a metadata object, it is\n         ".concat(JSON.stringify(null===(r=a)||void 0===r?void 0:r.Qa)));this.metadata=a;do{a=this.bu(),null!==a&&this.elements.push(a)}while(null!==a)}getMetadata(){return this.metadata}Wu(){return this.elements}bu(){if(this.cursor===this.bundleData.length)return null;const e=this.qu(),t=this.$u(e);return new $c(JSON.parse(t),e)}$u(e){if(this.cursor+e>this.bundleData.length)throw new S(j.INTERNAL,"Reached the end of bundle when more is expected.");return this.bundleData.slice(this.cursor,this.cursor+=e)}qu(){const e=this.cursor;let t=this.cursor;for(;t<this.bundleData.length;){if("{"===this.bundleData[t]){if(t===e)throw new Error("First character is a bracket and not a number");return this.cursor=t,Number(this.bundleData.slice(e,t))}t++}throw new Error("Reached the end of bundle when more is expected.")}}class Xd{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new S(j.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const t=await async function(e,t){const r=N(e),a={documents:t.map(e=>Fs(r.serializer,e))},n=await r.Ho("BatchGetDocuments",r.serializer.databaseId,W.emptyPath(),a,t.length),s=new Map;n.forEach(e=>{const t=function(e,t){return"found"in t?function(e,t){k(!!t.found,43571),t.found.name,t.found.updateTime;const r=Ls(e,t.found.name),a=Is(t.found.updateTime),n=t.found.createTime?Is(t.found.createTime):ce.min(),s=new sa({mapValue:{fields:t.found.fields}});return oa.newFoundDocument(r,a,n,s)}(e,t):"missing"in t?function(e,t){k(!!t.missing,3894),k(!!t.readTime,22933);const r=Ls(e,t.missing),a=Is(t.readTime);return oa.newNoDocument(r,a)}(e,t):b(7234,{result:t})}(r.serializer,e);s.set(t.key.toString(),t)});const i=[];return t.forEach(e=>{const t=s.get(e.toString());k(!!t,55234,{key:e}),i.push(t)}),i}(this.datastore,e);return t.forEach(e=>this.recordVersion(e)),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(e){this.lastTransactionError=e}this.writtenDocs.add(e.toString())}delete(e){this.write(new Yn(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((e,t)=>{const r=Y.fromPath(t);this.mutations.push(new Xn(r,this.precondition(r)))}),await async function(e,t){const r=N(e),a={writes:t.map(e=>Vs(r.serializer,e))};await r.Go("Commit",r.serializer.databaseId,W.emptyPath(),a)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw b(50498,{Gu:e.constructor.name});t=ce.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new S(j.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(ce.min())?Mn.exists(!1):Mn.updateTime(t):Mn.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(ce.min()))throw new S(j.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Mn.updateTime(t)}return Mn.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}class Jd{constructor(e,t,r,a,n){this.asyncQueue=e,this.datastore=t,this.options=r,this.updateFunction=a,this.deferred=n,this.zu=r.maxAttempts,this.M_=new Zl(this.asyncQueue,"transaction_retry")}ju(){this.zu-=1,this.Ju()}Ju(){this.M_.p_(async()=>{const e=new Xd(this.datastore),t=this.Hu(e);t&&t.then(t=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(t)}).catch(e=>{this.Yu(e)}))}).catch(e=>{this.Yu(e)})})}Hu(e){try{const t=this.updateFunction(e);return!Ve(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(e){return this.deferred.reject(e),null}}Yu(e){this.zu>0&&this.Zu(e)?(this.zu-=1,this.asyncQueue.enqueueAndForget(()=>(this.Ju(),Promise.resolve()))):this.deferred.reject(e)}Zu(e){if("FirebaseError"===(null===e||void 0===e?void 0:e.name)){const t=e.code;return"aborted"===t||"failed-precondition"===t||"already-exists"===t||!ns(t)}return!1}}const Zd="FirestoreClient";class $d{constructor(e,t,r,a,n){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=a,this.user=h.UNAUTHENTICATED,this.clientId=M.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=n,this.authCredentials.start(r,async e=>{p(Zd,"Received user=",e.uid),await this.authCredentialListener(e),this.user=e}),this.appCheckCredentials.start(r,e=>(p(Zd,"Received new app check token=",e),this.appCheckCredentialListener(e,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new _;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=Oc(t,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function eu(e,t){e.asyncQueue.verifyOperationInProgress(),p(Zd,"Initializing OfflineComponentProvider");const r=e.configuration;await t.initialize(r);let a=r.initialUser;e.setCredentialChangeListener(async e=>{a.isEqual(e)||(await ml(t.localStore,e),a=e)}),t.persistence.setDatabaseDeletedListener(()=>e.terminate()),e._offlineComponents=t}async function tu(e,t){e.asyncQueue.verifyOperationInProgress();const r=await ru(e);p(Zd,"Initializing OnlineComponentProvider"),await t.initialize(r,e.configuration),e.setCredentialChangeListener(e=>Pc(t.remoteStore,e)),e.setAppCheckTokenChangeListener((e,r)=>Pc(t.remoteStore,r)),e._onlineComponents=t}async function ru(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){p(Zd,"Using user provided OfflineComponentProvider");try{await eu(e,e._uninitializedComponentsProvider._offline)}catch(t){const r=t;if(!function(e){return"FirebaseError"===e.name?e.code===j.FAILED_PRECONDITION||e.code===j.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||22===e.code||20===e.code||11===e.code}(r))throw r;y("Error using user provided cache. Falling back to memory cache: "+r),await eu(e,new Ud)}}else p(Zd,"Using default OfflineComponentProvider"),await eu(e,new Vd(void 0));return e._offlineComponents}async function au(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(p(Zd,"Using user provided OnlineComponentProvider"),await tu(e,e._uninitializedComponentsProvider._online)):(p(Zd,"Using default OnlineComponentProvider"),await tu(e,new Gd))),e._onlineComponents}function nu(e){return ru(e).then(e=>e.persistence)}function su(e){return ru(e).then(e=>e.localStore)}function iu(e){return au(e).then(e=>e.remoteStore)}function ou(e){return au(e).then(e=>e.syncEngine)}function lu(e){return au(e).then(e=>e.datastore)}async function cu(e){const t=await au(e),r=t.eventManager;return r.onListen=dd.bind(null,t.syncEngine),r.onUnlisten=fd.bind(null,t.syncEngine),r.onFirstRemoteStoreListen=ud.bind(null,t.syncEngine),r.onLastRemoteStoreUnlisten=gd.bind(null,t.syncEngine),r}function du(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const a=new _;return e.asyncQueue.enqueueAndForget(async()=>function(e,t,r,a,n){const s=new Kd({next:o=>{s.Nu(),t.enqueueAndForget(()=>Wc(e,i));const l=o.docs.has(r);!l&&o.fromCache?n.reject(new S(j.UNAVAILABLE,"Failed to get document because the client is offline.")):l&&o.fromCache&&a&&"server"===a.source?n.reject(new S(j.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):n.resolve(o)},error:e=>n.reject(e)}),i=new Zc(Va(r.path),s,{includeMetadataChanges:!0,qa:!0});return Gc(e,i)}(await cu(e),e.asyncQueue,t,r,a)),a.promise}function uu(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const a=new _;return e.asyncQueue.enqueueAndForget(async()=>function(e,t,r,a,n){const s=new Kd({next:r=>{s.Nu(),t.enqueueAndForget(()=>Wc(e,i)),r.fromCache&&"server"===a.source?n.reject(new S(j.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):n.resolve(r)},error:e=>n.reject(e)}),i=new Zc(r,s,{includeMetadataChanges:!0,qa:!0});return Gc(e,i)}(await cu(e),e.asyncQueue,t,r,a)),a.promise}function hu(e,t,r,a){const n=function(e,t){let r;return r="string"==typeof e?os().encode(e):e,function(e,t){return new Qd(e,t)}(function(e,t){if(e instanceof Uint8Array)return Wd(e,t);if(e instanceof ArrayBuffer)return Wd(new Uint8Array(e),t);if(e instanceof ReadableStream)return e.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(r),t)}(r,Jl(t));e.asyncQueue.enqueueAndForget(async()=>{!function(e,t,r){const a=N(e);(async function(e,t,r){try{const a=await t.getMetadata();if(await function(e,t){const r=N(e),a=Is(t.createTime);return r.persistence.runTransaction("hasNewerBundle","readonly",e=>r.Ii.getBundleMetadata(e,t.id)).then(e=>!!e&&e.createTime.compareTo(a)>=0)}(e.localStore,a))return await t.close(),r._completeWith(function(e){return{taskState:"Success",documentsLoaded:e.totalDocuments,bytesLoaded:e.totalBytes,totalDocuments:e.totalDocuments,totalBytes:e.totalBytes}}(a)),Promise.resolve(new Set);r._updateProgress(rd(a));const n=new td(a,t.serializer);let s=await t.bu();for(;s;){const e=await n.Ga(s);e&&r._updateProgress(e),s=await t.bu()}const i=await n.ja(e.localStore);return await Ad(e,i.Ha,void 0),await function(e,t){const r=N(e);return r.persistence.runTransaction("Save bundle","readwrite",e=>r.Ii.saveBundleMetadata(e,t))}(e.localStore,a),r._completeWith(i.progress),Promise.resolve(i.Ja)}catch(e){return y(id,"Loading bundle failed with ".concat(e)),r._failWith(e),Promise.resolve(new Set)}})(a,t,r).then(e=>{a.sharedClientState.notifyBundleLoaded(e)})}(await ou(e),n,a)})}function mu(e,t){return function(e,t){return new Yd(e,t)}(e,t)}function fu(e){const t={};return void 0!==e.timeoutSeconds&&(t.timeoutSeconds=e.timeoutSeconds),t}const gu=new Map,pu="firestore.googleapis.com",xu=!0;class yu{constructor(e){var t,r;if(void 0===e.host){if(void 0!==e.ssl)throw new S(j.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=pu,this.ssl=xu}else this.host=e.host,this.ssl=null!==(t=e.ssl)&&void 0!==t?t:xu;if(this.isUsingEmulator=void 0!==e.emulatorOptions,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=ro;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<yo)throw new S(j.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}J("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===e.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=fu(null!==(r=e.experimentalLongPollingOptions)&&void 0!==r?r:{}),function(e){if(void 0!==e.timeoutSeconds){if(isNaN(e.timeoutSeconds))throw new S(j.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(e.timeoutSeconds," (must not be NaN)"));if(e.timeoutSeconds<5)throw new S(j.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(e.timeoutSeconds," (minimum allowed value is 5)"));if(e.timeoutSeconds>30)throw new S(j.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(e.timeoutSeconds," (maximum allowed value is 30)"))}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(e,t){return e.timeoutSeconds===t.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class vu{constructor(e,t,r,a){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=a,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new yu({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new S(j.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return"notTerminated"!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new S(j.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new yu(e),this._emulatorOptions=e.emulatorOptions||{},void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new A;switch(e.type){case"firstParty":return new D(e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new S(j.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return"notTerminated"===this._terminateTask&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){"notTerminated"===this._terminateTask?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=gu.get(e);t&&(p("ComponentProvider","Removing Datastore"),gu.delete(e),t.terminate())}(this),Promise.resolve()}}function bu(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};e=re(e,vu);const s=o.isCloudWorkstation(t),i=e._getSettings(),l=a(a({},i),{},{emulatorOptions:e._getEmulatorOptions()}),c="".concat(t,":").concat(r);s&&(o.pingServer("https://".concat(c)),o.updateEmulatorBanner("Firestore",!0)),i.host!==pu&&i.host!==c&&y("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const d=a(a({},i),{},{host:c,ssl:s,emulatorOptions:n});if(!o.deepEqual(d,l)&&(e._setSettings(d),n.mockUserToken)){let t,r;if("string"==typeof n.mockUserToken)t=n.mockUserToken,r=h.MOCK_USER;else{var u;t=o.createMockUserToken(n.mockUserToken,null===(u=e._app)||void 0===u?void 0:u.options.projectId);const a=n.mockUserToken.sub||n.mockUserToken.user_id;if(!a)throw new S(j.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");r=new h(a)}e._authCredentials=new C(new E(t,r))}}class wu{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new wu(this.firestore,e,this._query)}}class ku{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Nu(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new ku(this.firestore,e,this._key)}toJSON(){return{type:ku._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if(se(t,ku._jsonSchema))return new ku(e,r||null,new Y(W.fromString(t.referencePath)))}}ku._jsonSchemaVersion="firestore/documentReference/1.0",ku._jsonSchema={type:ne("string",ku._jsonSchemaVersion),referencePath:ne("string")};class Nu extends wu{constructor(e,t,r){super(e,t,Va(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new ku(this.firestore,null,new Y(e))}withConverter(e){return new Nu(this.firestore,e,this._path)}}function ju(e,t){for(var r=arguments.length,a=new Array(r>2?r-2:0),n=2;n<r;n++)a[n-2]=arguments[n];if(e=o.getModularInstance(e),1===arguments.length&&(t=M.newId()),X("doc","path",t),e instanceof vu){const r=W.fromString(t,...a);return Z(r),new ku(e,null,new Y(r))}{if(!(e instanceof ku||e instanceof Nu))throw new S(j.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=e._path.child(W.fromString(t,...a));return Z(r),new ku(e.firestore,e instanceof Nu?e.converter:null,new Y(r))}}function Su(e,t){return e=o.getModularInstance(e),t=o.getModularInstance(t),e instanceof wu&&t instanceof wu&&e.firestore===t.firestore&&Ja(e._query,t._query)&&e.converter===t.converter}const _u="AsyncQueue";class Eu{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Promise.resolve();this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new Zl(this,"async_queue_retry"),this._c=()=>{const e=Xl();e&&p(_u,"Visibility state changed to "+e.visibilityState),this.M_.w_()},this.ac=e;const t=Xl();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=Xl();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const t=new _;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(0!==this.Xu.length){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!De(e))throw e;p(_u,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const t=this.ac.then(()=>(this.rc=!0,e().catch(e=>{throw this.nc=e,this.rc=!1,x("INTERNAL UNHANDLED ERROR: ",Au(e)),e}).then(e=>(this.rc=!1,e))));return this.ac=t,t}enqueueAfterDelay(e,t,r){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const a=Rc.createAndSchedule(this,e,t,r,e=>this.hc(e));return this.tc.push(a),a}uc(){this.nc&&b(47125,{Pc:Au(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do{e=this.ac,await e}while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((e,t)=>e.targetTimeMs-t.targetTimeMs);for(const t of this.tc)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function Au(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}function Cu(e){return function(e,t){if("object"!=typeof e||null===e)return!1;const r=e;for(const a of t)if(a in r&&"function"==typeof r[a])return!0;return!1}(e,["next","error","complete"])}class Iu{constructor(){this._progressObserver={},this._taskCompletionResolver=new _,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,r){this._progressObserver={next:e,error:t,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}class Tu extends vu{constructor(e,t,r,a){super(e,t,r,a),this.type="firestore",this._queue=new Eu,this._persistenceKey=(null===a||void 0===a?void 0:a.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Eu(e),this._firestoreClient=void 0,await e}}}function Du(e){if(e._terminated)throw new S(j.FAILED_PRECONDITION,"The client has already been terminated.");return e._firestoreClient||Pu(e),e._firestoreClient}function Pu(e){var t,r,a;const n=e._freezeSettings(),s=function(e,t,r,a){return new Er(e,t,r,a.host,a.ssl,a.experimentalForceLongPolling,a.experimentalAutoDetectLongPolling,fu(a.experimentalLongPollingOptions),a.useFetchStreams,a.isUsingEmulator)}(e._databaseId,(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",e._persistenceKey,n);e._componentsProvider||null!==(r=n.localCache)&&void 0!==r&&r._offlineComponentProvider&&null!==(a=n.localCache)&&void 0!==a&&a._onlineComponentProvider&&(e._componentsProvider={_offline:n.localCache._offlineComponentProvider,_online:n.localCache._onlineComponentProvider}),e._firestoreClient=new $d(e._authCredentials,e._appCheckCredentials,e._queue,s,e._componentsProvider&&function(e){const t=null===e||void 0===e?void 0:e._online.build();return{_offline:null===e||void 0===e?void 0:e._offline.build(t),_online:t}}(e._componentsProvider))}function Fu(e,t,r){if((e=re(e,Tu))._firestoreClient||e._terminated)throw new S(j.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(e._componentsProvider||e._getSettings().localCache)throw new S(j.FAILED_PRECONDITION,"SDK cache is already specified.");e._componentsProvider={_online:t,_offline:r},Pu(e)}function Lu(e,t){const r=Du(e=re(e,Tu)),a=new Iu;return hu(r,e._databaseId,t,a),a}function Mu(e,t){return function(e,t){return e.asyncQueue.enqueue(async()=>function(e,t){const r=N(e);return r.persistence.runTransaction("Get named query","readonly",e=>r.Ii.getNamedQuery(e,t))}(await su(e),t))}(Du(e=re(e,Tu)),t).then(t=>t?new wu(e,null,t.query):null)}class Ru{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"count",t=arguments.length>1?arguments[1]:void 0;this._internalFieldPath=t,this.type="AggregateField",this.aggregateType=e}}class Ou{constructor(e,t,r){this._userDataWriter=t,this._data=r,this.type="AggregateQuerySnapshot",this.query=e}data(){return this._userDataWriter.convertObjectMap(this._data)}}class Bu{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Bu(gr.fromBase64String(e))}catch(e){throw new S(j.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(e){return new Bu(gr.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Bu._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(se(e,Bu._jsonSchema))return Bu.fromBase64String(e.bytes)}}Bu._jsonSchemaVersion="firestore/bytes/1.0",Bu._jsonSchema={type:ne("string",Bu._jsonSchemaVersion),bytes:ne("string")};class zu{constructor(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];for(let a=0;a<t.length;++a)if(0===t[a].length)throw new S(j.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Q(t)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Uu{constructor(e){this._methodName=e}}class Vu{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new S(j.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new S(j.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return R(this._lat,e._lat)||R(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Vu._jsonSchemaVersion}}static fromJSON(e){if(se(e,Vu._jsonSchema))return new Vu(e.latitude,e.longitude)}}Vu._jsonSchemaVersion="firestore/geoPoint/1.0",Vu._jsonSchema={type:ne("string",Vu._jsonSchemaVersion),latitude:ne("number"),longitude:ne("number")};class qu{constructor(e){this._values=(e||[]).map(e=>e)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;++r)if(e[r]!==t[r])return!1;return!0}(this._values,e._values)}toJSON(){return{type:qu._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(se(e,qu._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(e=>"number"==typeof e))return new qu(e.vectorValues);throw new S(j.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}qu._jsonSchemaVersion="firestore/vectorValue/1.0",qu._jsonSchema={type:ne("string",qu._jsonSchemaVersion),vectorValues:ne("object")};const Hu=/^__.*__$/;class Gu{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return null!==this.fieldMask?new Gn(e,this.data,this.fieldMask,t,this.fieldTransforms):new Hn(e,this.data,t,this.fieldTransforms)}}class Wu{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new Gn(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function Ku(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw b(40011,{Ac:e})}}class Qu{constructor(e,t,r,a,n,s){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=a,void 0===n&&this.Rc(),this.fieldTransforms=n||[],this.fieldMask=s||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new Qu(a(a({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){var t;const r=null===(t=this.path)||void 0===t?void 0:t.child(e),a=this.Vc({path:r,fc:!1});return a.gc(e),a}yc(e){var t;const r=null===(t=this.path)||void 0===t?void 0:t.child(e),a=this.Vc({path:r,fc:!1});return a.Rc(),a}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return fh(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return void 0!==this.fieldMask.find(t=>e.isPrefixOf(t))||void 0!==this.fieldTransforms.find(t=>e.isPrefixOf(t.field))}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(0===e.length)throw this.Sc("Document fields must not be empty");if(Ku(this.Ac)&&Hu.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class Yu{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||Jl(e)}Cc(e,t,r){let a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return new Qu({Ac:e,methodName:t,Dc:r,path:Q.emptyPath(),fc:!1,bc:a},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Xu(e){const t=e._freezeSettings(),r=Jl(e._databaseId);return new Yu(e._databaseId,!!t.ignoreUndefinedProperties,r)}function Ju(e,t,r,a,n){let s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};const i=e.Cc(s.merge||s.mergeFields?2:0,t,r,n);dh("Data must be an object, but it was:",i,a);const o=lh(a,i);let l,c;if(s.merge)l=new mr(i.fieldMask),c=i.fieldTransforms;else if(s.mergeFields){const e=[];for(const a of s.mergeFields){const n=uh(t,a,r);if(!i.contains(n))throw new S(j.INVALID_ARGUMENT,"Field '".concat(n,"' is specified in your field mask but missing from your input data."));gh(e,n)||e.push(n)}l=new mr(e),c=i.fieldTransforms.filter(e=>l.covers(e.field))}else l=null,c=i.fieldTransforms;return new Gu(new sa(o),l,c)}class Zu extends Uu{_toFieldTransform(e){if(2!==e.Ac)throw 1===e.Ac?e.Sc("".concat(this._methodName,"() can only appear at the top level of your update data")):e.Sc("".concat(this._methodName,"() cannot be used with set() unless you pass {merge:true}"));return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Zu}}function $u(e,t,r){return new Qu({Ac:3,Dc:t.settings.Dc,methodName:e._methodName,fc:r},t.databaseId,t.serializer,t.ignoreUndefinedProperties)}class eh extends Uu{_toFieldTransform(e){return new Fn(e.path,new _n)}isEqual(e){return e instanceof eh}}class th extends Uu{constructor(e,t){super(e),this.vc=t}_toFieldTransform(e){const t=$u(this,e,!0),r=this.vc.map(e=>oh(e,t)),a=new En(r);return new Fn(e.path,a)}isEqual(e){return e instanceof th&&o.deepEqual(this.vc,e.vc)}}class rh extends Uu{constructor(e,t){super(e),this.vc=t}_toFieldTransform(e){const t=$u(this,e,!0),r=this.vc.map(e=>oh(e,t)),a=new Cn(r);return new Fn(e.path,a)}isEqual(e){return e instanceof rh&&o.deepEqual(this.vc,e.vc)}}class ah extends Uu{constructor(e,t){super(e),this.Fc=t}_toFieldTransform(e){const t=new Tn(e.serializer,wn(e.serializer,this.Fc));return new Fn(e.path,t)}isEqual(e){return e instanceof ah&&this.Fc===e.Fc}}function nh(e,t,r,a){const n=e.Cc(1,t,r);dh("Data must be an object, but it was:",n,a);const s=[],i=sa.empty();nr(a,(e,a)=>{const l=mh(t,e,r);a=o.getModularInstance(a);const c=n.yc(l);if(a instanceof Zu)s.push(l);else{const e=oh(a,c);null!=e&&(s.push(l),i.set(l,e))}});const l=new mr(s);return new Wu(i,l,n.fieldTransforms)}function sh(e,t,r,a,n,s){const i=e.Cc(1,t,r),l=[uh(t,a,r)],c=[n];if(s.length%2!=0)throw new S(j.INVALID_ARGUMENT,"Function ".concat(t,"() needs to be called with an even number of arguments that alternate between field names and values."));for(let o=0;o<s.length;o+=2)l.push(uh(t,s[o])),c.push(s[o+1]);const d=[],u=sa.empty();for(let m=l.length-1;m>=0;--m)if(!gh(d,l[m])){const e=l[m];let t=c[m];t=o.getModularInstance(t);const r=i.yc(e);if(t instanceof Zu)d.push(e);else{const a=oh(t,r);null!=a&&(d.push(e),u.set(e,a))}}const h=new mr(d);return new Wu(u,h,i.fieldTransforms)}function ih(e,t,r){let a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return oh(r,e.Cc(a?4:3,t))}function oh(e,t){if(ch(e=o.getModularInstance(e)))return dh("Unsupported field value:",t,e),lh(e,t);if(e instanceof Uu)return function(e,t){if(!Ku(t.Ac))throw t.Sc("".concat(e._methodName,"() can only be used with update() and set()"));if(!t.path)throw t.Sc("".concat(e._methodName,"() is not currently supported inside arrays"));const r=e._toFieldTransform(t);r&&t.fieldTransforms.push(r)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.fc&&4!==t.Ac)throw t.Sc("Nested arrays are not supported");return function(e,t){const r=[];let a=0;for(const n of e){let e=oh(n,t.wc(a));null==e&&(e={nullValue:"NULL_VALUE"}),r.push(e),a++}return{arrayValue:{values:r}}}(e,t)}return function(e,t){if(null===(e=o.getModularInstance(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return wn(t.serializer,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){const r=le.fromDate(e);return{timestampValue:Es(t.serializer,r)}}if(e instanceof le){const r=new le(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:Es(t.serializer,r)}}if(e instanceof Vu)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof Bu)return{bytesValue:As(t.serializer,e._byteString)};if(e instanceof ku){const r=t.databaseId,a=e.firestore._databaseId;if(!a.isEqual(r))throw t.Sc("Document reference is for database ".concat(a.projectId,"/").concat(a.database," but should be for database ").concat(r.projectId,"/").concat(r.database));return{referenceValue:Ts(e.firestore._databaseId||t.databaseId,e._key.path)}}if(e instanceof qu)return function(e,t){return{mapValue:{fields:{[Ir]:{stringValue:Pr},[Fr]:{arrayValue:{values:e.toArray().map(e=>{if("number"!=typeof e)throw t.Sc("VectorValues must only contain numeric values.");return vn(t.serializer,e)})}}}}}}(e,t);throw t.Sc("Unsupported field value: ".concat(te(e)))}(e,t)}function lh(e,t){const r={};return ir(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):nr(e,(e,a)=>{const n=oh(a,t.mc(e));null!=n&&(r[e]=n)}),{mapValue:{fields:r}}}function ch(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof le||e instanceof Vu||e instanceof Bu||e instanceof ku||e instanceof Uu||e instanceof qu)}function dh(e,t,r){if(!ch(r)||!ee(r)){const a=te(r);throw"an object"===a?t.Sc(e+" a custom object"):t.Sc(e+" "+a)}}function uh(e,t,r){if((t=o.getModularInstance(t))instanceof zu)return t._internalPath;if("string"==typeof t)return mh(e,t);throw fh("Field path arguments must be of type string or ",e,!1,void 0,r)}const hh=new RegExp("[~\\*/\\[\\]]");function mh(e,t,r){if(t.search(hh)>=0)throw fh("Invalid field path (".concat(t,"). Paths must not contain '~', '*', '/', '[', or ']'"),e,!1,void 0,r);try{return new zu(...t.split("."))._internalPath}catch(a){throw fh("Invalid field path (".concat(t,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"),e,!1,void 0,r)}}function fh(e,t,r,a,n){const s=a&&!a.isEmpty(),i=void 0!==n;let o="Function ".concat(t,"() called with invalid data");r&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(s||i)&&(l+=" (found",s&&(l+=" in field ".concat(a)),i&&(l+=" in document ".concat(n)),l+=")"),new S(j.INVALID_ARGUMENT,o+e+l)}function gh(e,t){return e.some(e=>e.isEqual(t))}class ph{constructor(e,t,r,a,n){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=a,this._converter=n}get id(){return this._key.path.lastSegment()}get ref(){return new ku(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new xh(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(yh("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class xh extends ph{data(){return super.data()}}function yh(e,t){return"string"==typeof t?mh(e,t):t instanceof zu?t._internalPath:t._delegate._internalPath}function vh(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new S(j.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class bh{}class wh extends bh{}class kh extends wh{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new kh(e,t,r)}_apply(e){const t=this._parse(e);return Th(e._query,t),new wu(e.firestore,e.converter,Ya(e._query,t))}_parse(e){const t=Xu(e.firestore),r=function(e,t,r,a,n,s,i){let o;if(n.isKeyField()){if("array-contains"===s||"array-contains-any"===s)throw new S(j.INVALID_ARGUMENT,"Invalid Query. You can't perform '".concat(s,"' queries on documentId()."));if("in"===s||"not-in"===s){Ih(i,s);const t=[];for(const r of i)t.push(Ch(a,e,r));o={arrayValue:{values:t}}}else o=Ch(a,e,i)}else"in"!==s&&"not-in"!==s&&"array-contains-any"!==s||Ih(i,s),o=ih(r,t,i,"in"===s||"not-in"===s);return fa.create(n,s,o)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value);return r}}class Nh extends bh{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Nh(e,t)}_parse(e){const t=this._queryConstraints.map(t=>t._parse(e)).filter(e=>e.getFilters().length>0);return 1===t.length?t[0]:ga.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return 0===t.getFilters().length?e:(function(e,t){let r=e;const a=t.getFlattenedFilters();for(const n of a)Th(r,n),r=Ya(r,n)}(e._query,t),new wu(e.firestore,e.converter,Ya(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class jh extends wh{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new jh(e,t)}_apply(e){const t=function(e,t,r){if(null!==e.startAt)throw new S(j.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new S(j.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new ua(t,r)}(e._query,this._field,this._direction);return new wu(e.firestore,e.converter,function(e,t){const r=e.explicitOrderBy.concat([t]);return new za(e.path,e.collectionGroup,r,e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(e._query,t))}}class Sh extends wh{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new Sh(e,t,r)}_apply(e){return new wu(e.firestore,e.converter,Xa(e._query,this._limit,this._limitType))}}class _h extends wh{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new _h(e,t,r)}_apply(e){const t=Ah(e,this.type,this._docOrFields,this._inclusive);return new wu(e.firestore,e.converter,function(e,t){return new za(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,t,e.endAt)}(e._query,t))}}class Eh extends wh{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new Eh(e,t,r)}_apply(e){const t=Ah(e,this.type,this._docOrFields,this._inclusive);return new wu(e.firestore,e.converter,function(e,t){return new za(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,t)}(e._query,t))}}function Ah(e,t,r,a){if(r[0]=o.getModularInstance(r[0]),r[0]instanceof ph)return function(e,t,r,a,n){if(!a)throw new S(j.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for ".concat(r,"()."));const s=[];for(const i of Ga(e))if(i.field.isKeyField())s.push(Gr(t,a.key));else{const e=a.data.field(i.field);if(jr(e))throw new S(j.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+i.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===e){const e=i.field.canonicalString();throw new S(j.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '".concat(e,"' (used as the orderBy) does not exist."))}s.push(e)}return new la(s,n)}(e._query,e.firestore._databaseId,t,r[0]._document,a);{const n=Xu(e.firestore);return function(e,t,r,a,n,s){const i=e.explicitOrderBy;if(n.length>i.length)throw new S(j.INVALID_ARGUMENT,"Too many arguments provided to ".concat(a,"(). The number of arguments must be less than or equal to the number of orderBy() clauses"));const o=[];for(let l=0;l<n.length;l++){const s=n[l];if(i[l].field.isKeyField()){if("string"!=typeof s)throw new S(j.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in ".concat(a,"(), but got a ").concat(typeof s));if(!Ha(e)&&-1!==s.indexOf("/"))throw new S(j.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by documentId(), the value passed to ".concat(a,"() must be a plain document ID, but '").concat(s,"' contains a slash."));const r=e.path.child(W.fromString(s));if(!Y.isDocumentKey(r))throw new S(j.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by documentId(), the value passed to ".concat(a,"() must result in a valid document path, but '").concat(r,"' is not because it contains an odd number of segments."));const n=new Y(r);o.push(Gr(t,n))}else{const e=ih(r,a,s);o.push(e)}}return new la(o,s)}(e._query,e.firestore._databaseId,n,t,r,a)}}function Ch(e,t,r){if("string"==typeof(r=o.getModularInstance(r))){if(""===r)throw new S(j.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Ha(t)&&-1!==r.indexOf("/"))throw new S(j.INVALID_ARGUMENT,"Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '".concat(r,"' contains a '/' character."));const a=t.path.child(W.fromString(r));if(!Y.isDocumentKey(a))throw new S(j.INVALID_ARGUMENT,"Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '".concat(a,"' is not because it has an odd number of segments (").concat(a.length,")."));return Gr(e,new Y(a))}if(r instanceof ku)return Gr(e,r._key);throw new S(j.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ".concat(te(r),"."))}function Ih(e,t){if(!Array.isArray(e)||0===e.length)throw new S(j.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '".concat(t.toString(),"' filters."))}function Th(e,t){const r=function(e,t){for(const r of e)for(const e of r.getFlattenedFilters())if(t.indexOf(e.op)>=0)return e.op;return null}(e.filters,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==r)throw r===t.op?new S(j.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '".concat(t.op.toString(),"' filter.")):new S(j.INVALID_ARGUMENT,"Invalid query. You cannot use '".concat(t.op.toString(),"' filters with '").concat(r.toString(),"' filters."))}function Dh(e,t){if(!(t instanceof kh||t instanceof Nh))throw new S(j.INVALID_ARGUMENT,"Function ".concat(e,"() requires AppliableConstraints created with a call to 'where(...)', 'or(...)', or 'and(...)'."))}class Ph{convertValue(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";switch(Mr(e)){case 0:return null;case 1:return e.booleanValue;case 2:return yr(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(vr(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw b(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";const r={};return nr(e,(e,a)=>{r[e]=this.convertValue(a,t)}),r}convertVectorValue(e){var t;const r=null===(t=e.fields)||void 0===t||null===(t=t[Fr].arrayValue)||void 0===t||null===(t=t.values)||void 0===t?void 0:t.map(e=>yr(e.doubleValue));return new qu(r)}convertGeoPoint(e){return new Vu(yr(e.latitude),yr(e.longitude))}convertArray(e,t){return(e.values||[]).map(e=>this.convertValue(e,t))}convertServerTimestamp(e,t){switch(t){case"previous":const r=Sr(e);return null==r?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(_r(e));default:return null}}convertTimestamp(e){const t=xr(e);return new le(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=W.fromString(e);k(ri(r),9688,{name:e});const a=new Cr(r.get(1),r.get(3)),n=new Y(r.popFirst(5));return a.isEqual(t)||x("Document ".concat(n," contains a document reference within a different database (").concat(a.projectId,"/").concat(a.database,") which is not supported. It will be treated as a reference in the current database (").concat(t.projectId,"/").concat(t.database,") instead.")),n}}function Fh(e,t,r){let a;return a=e?r&&(r.merge||r.mergeFields)?e.toFirestore(t,r):e.toFirestore(t):t,a}class Lh extends Ph{constructor(e){super(),this.firestore=e}convertBytes(e){return new Bu(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new ku(this.firestore,null,t)}}function Mh(){return new Ru("count")}const Rh="NOT SUPPORTED";class Oh{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Bh extends ph{constructor(e,t,r,a,n,s){super(e,t,r,a,s),this._firestore=e,this._firestoreImpl=e,this.metadata=n}exists(){return super.exists()}data(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._document){if(this._converter){const t=new zh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._document){const r=this._document.data.field(yh("DocumentSnapshot.get",e));if(null!==r)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new S(j.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=Bh._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),e&&e.isValidDocument()&&e.isFoundDocument()?(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t):t}}Bh._jsonSchemaVersion="firestore/documentSnapshot/1.0",Bh._jsonSchema={type:ne("string",Bh._jsonSchemaVersion),bundleSource:ne("string","DocumentSnapshot"),bundleName:ne("string"),bundle:ne("string")};class zh extends Bh{data(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return super.data(e)}}class Uh{constructor(e,t,r,a){this._firestore=e,this._userDataWriter=t,this._snapshot=a,this.metadata=new Oh(a.hasPendingWrites,a.fromCache),this.query=r}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new zh(this._firestore,this._userDataWriter,r.key,r,new Oh(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(){const e=!!(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new S(j.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){let t=0;return e._snapshot.docChanges.map(r=>{const a=new zh(e._firestore,e._userDataWriter,r.doc.key,r.doc,new Oh(e._snapshot.mutatedKeys.has(r.doc.key),e._snapshot.fromCache),e.query.converter);return r.doc,{type:"added",doc:a,oldIndex:-1,newIndex:t++}})}{let r=e._snapshot.oldDocs;return e._snapshot.docChanges.filter(e=>t||3!==e.type).map(t=>{const a=new zh(e._firestore,e._userDataWriter,t.doc.key,t.doc,new Oh(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter);let n=-1,s=-1;return 0!==t.type&&(n=r.indexOf(t.doc.key),r=r.delete(t.doc.key)),1!==t.type&&(r=r.add(t.doc),s=r.indexOf(t.doc.key)),{type:Vh(t.type),doc:a,oldIndex:n,newIndex:s}})}}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new S(j.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Uh._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=M.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],r=[],a=[];return this.docs.forEach(e=>{null!==e._document&&(t.push(e._document),r.push(this._userDataWriter.convertObjectMap(e._document.data.value.mapValue.fields,"previous")),a.push(e.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function Vh(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return b(61501,{type:e})}}Uh._jsonSchemaVersion="firestore/querySnapshot/1.0",Uh._jsonSchema={type:ne("string",Uh._jsonSchemaVersion),bundleSource:ne("string","QuerySnapshot"),bundleName:ne("string"),bundle:ne("string")};class qh extends Ph{constructor(e){super(),this.firestore=e}convertBytes(e){return new Bu(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new ku(this.firestore,null,t)}}function Hh(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];e=o.getModularInstance(e);let n={includeMetadataChanges:!1,source:"default"},s=0;"object"!=typeof r[s]||Cu(r[s])||(n=r[s++]);const i={includeMetadataChanges:n.includeMetadataChanges,source:n.source};if(Cu(r[s])){var l,c,d;const e=r[s];r[s]=null===(l=e.next)||void 0===l?void 0:l.bind(e),r[s+1]=null===(c=e.error)||void 0===c?void 0:c.bind(e),r[s+2]=null===(d=e.complete)||void 0===d?void 0:d.bind(e)}let u,h,m;if(e instanceof ku)h=re(e.firestore,Tu),m=Va(e._key.path),u={next:t=>{r[s]&&r[s](Wh(h,e,t))},error:r[s+1],complete:r[s+2]};else{const t=re(e,wu);h=re(t.firestore,Tu),m=t._query;const a=new qh(h);u={next:e=>{r[s]&&r[s](new Uh(h,a,t,e))},error:r[s+1],complete:r[s+2]},vh(e._query)}return function(e,t,r,a){const n=new Kd(a),s=new Zc(t,n,r);return e.asyncQueue.enqueueAndForget(async()=>Gc(await cu(e),s)),()=>{n.Nu(),e.asyncQueue.enqueueAndForget(async()=>Wc(await cu(e),s))}}(Du(h),m,i,u)}function Gh(e,t){return function(e,t){const r=new _;return e.asyncQueue.enqueueAndForget(async()=>async function(e,t,r){const a=zd(e);try{const e=await function(e,t){const r=N(e),a=le.now(),n=t.reduce((e,t)=>e.add(t.key),pn());let s,i;return r.persistence.runTransaction("Locally write mutations","readwrite",e=>{let o=on(),l=pn();return r.Ns.getEntries(e,n).next(e=>{o=e,o.forEach((e,t)=>{t.isValidDocument()||(l=l.add(e))})}).next(()=>r.localDocuments.getOverlayedDocuments(e,o)).next(n=>{s=n;const i=[];for(const e of t){const t=Vn(e,s.get(e.key).overlayedDocument);null!=t&&i.push(new Gn(e.key,t,ia(t.value.mapValue),Mn.exists(!0)))}return r.mutationQueue.addMutationBatch(e,a,i,t)}).next(t=>{i=t;const a=t.applyToLocalDocumentSet(s,l);return r.documentOverlayCache.saveOverlays(e,t.batchId,a)})}).then(()=>({batchId:i.batchId,changes:dn(s)}))}(a.localStore,t);a.sharedClientState.addPendingMutation(e.batchId),function(e,t,r){let a=e.Vu[e.currentUser.toKey()];a||(a=new or(R)),a=a.insert(t,r),e.Vu[e.currentUser.toKey()]=a}(a,e.batchId,r),await Ad(a,e.changes),await jc(a.remoteStore)}catch(e){const t=Oc(e,"Failed to persist write");r.reject(t)}}(await ou(e),t,r)),r.promise}(Du(e),t)}function Wh(e,t,r){const a=r.docs.get(t._key),n=new qh(e);return new Bh(e,n,t._key,a,new Oh(r.hasPendingWrites,r.fromCache),t.converter)}function Kh(e,t){const r=re(e.firestore,Tu),a=Du(r),n=sr(t,(e,t)=>new es(t,e.aggregateType,e._internalFieldPath));return function(e,t,r){const a=new _;return e.asyncQueue.enqueueAndForget(async()=>{try{const n=await lu(e);a.resolve(async function(e,t,r,a){const n=N(e),{request:s,gt:i,parent:o}=Ws(n.serializer,Ka(t),r);n.connection.$o||delete s.parent;const l=(await n.Ho("RunAggregationQuery",n.serializer.databaseId,o,s,1)).filter(e=>!!e.result);k(1===l.length,64727);const c=null===(a=l[0].result)||void 0===a?void 0:a.aggregateFields;return Object.keys(c).reduce((e,t)=>(e[i[t]]=c[t],e),{})}(n,t,r))}catch(e){a.reject(e)}}),a.promise}(a,e._query,n).then(t=>function(e,t,r){const a=new qh(e);return new Ou(t,a,r)}(r,e,t))}class Qh{constructor(e){this.kind="memory",this._onlineComponentProvider=Gd.provider,this._offlineComponentProvider=null!==e&&void 0!==e&&e.garbageCollector?e.garbageCollector._offlineComponentProvider:{build:()=>new Vd(void 0)}}toJSON(){return{kind:this.kind}}}class Yh{constructor(e){let t;this.kind="persistent",null!==e&&void 0!==e&&e.tabManager?(e.tabManager._initialize(e),t=e.tabManager):(t=em(void 0),t._initialize(e)),this._onlineComponentProvider=t._onlineComponentProvider,this._offlineComponentProvider=t._offlineComponentProvider}toJSON(){return{kind:this.kind}}}class Xh{constructor(){this.kind="memoryEager",this._offlineComponentProvider=Ud.provider}toJSON(){return{kind:this.kind}}}class Jh{constructor(e){this.kind="memoryLru",this._offlineComponentProvider={build:()=>new Vd(e)}}toJSON(){return{kind:this.kind}}}class Zh{constructor(e){this.forceOwnership=e,this.kind="persistentSingleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=Gd.provider,this._offlineComponentProvider={build:t=>new qd(t,null===e||void 0===e?void 0:e.cacheSizeBytes,this.forceOwnership)}}}class $h{constructor(){this.kind="PersistentMultipleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=Gd.provider,this._offlineComponentProvider={build:t=>new Hd(t,null===e||void 0===e?void 0:e.cacheSizeBytes)}}}function em(e){return new Zh(null===e||void 0===e?void 0:e.forceOwnership)}const tm={maxAttempts:5};class rm{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Xu(e)}set(e,t,r){this._verifyNotCommitted();const a=am(e,this._firestore),n=Fh(a.converter,t,r),s=Ju(this._dataReader,"WriteBatch.set",a._key,n,null!==a.converter,r);return this._mutations.push(s.toMutation(a._key,Mn.none())),this}update(e,t,r){this._verifyNotCommitted();const a=am(e,this._firestore);let n;for(var s=arguments.length,i=new Array(s>3?s-3:0),l=3;l<s;l++)i[l-3]=arguments[l];return n="string"==typeof(t=o.getModularInstance(t))||t instanceof zu?sh(this._dataReader,"WriteBatch.update",a._key,t,r,i):nh(this._dataReader,"WriteBatch.update",a._key,t),this._mutations.push(n.toMutation(a._key,Mn.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=am(e,this._firestore);return this._mutations=this._mutations.concat(new Yn(t._key,Mn.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new S(j.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function am(e,t){if((e=o.getModularInstance(e)).firestore!==t)throw new S(j.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}class nm{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=Xu(e)}get(e){const t=am(e,this._firestore),r=new Lh(this._firestore);return this._transaction.lookup([t._key]).then(e=>{if(!e||1!==e.length)return b(24041);const a=e[0];if(a.isFoundDocument())return new ph(this._firestore,r,a.key,a,t.converter);if(a.isNoDocument())return new ph(this._firestore,r,t._key,null,t.converter);throw b(18433,{doc:a})})}set(e,t,r){const a=am(e,this._firestore),n=Fh(a.converter,t,r),s=Ju(this._dataReader,"Transaction.set",a._key,n,null!==a.converter,r);return this._transaction.set(a._key,s),this}update(e,t,r){const a=am(e,this._firestore);let n;for(var s=arguments.length,i=new Array(s>3?s-3:0),l=3;l<s;l++)i[l-3]=arguments[l];return n="string"==typeof(t=o.getModularInstance(t))||t instanceof zu?sh(this._dataReader,"Transaction.update",a._key,t,r,i):nh(this._dataReader,"Transaction.update",a._key,t),this._transaction.update(a._key,n),this}delete(e){const t=am(e,this._firestore);return this._transaction.delete(t._key),this}}class sm extends nm{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=am(e,this._firestore),r=new qh(this._firestore);return super.get(e).then(e=>new Bh(this._firestore,r,t._key,e._document,new Oh(!1,!1),t.converter))}}function im(e,t){if("string"!=typeof e[t])throw new S(j.INVALID_ARGUMENT,"Missing string value for: "+t);return e[t]}class om{constructor(e){this._firestore=e,this.type="PersistentCacheIndexManager"}}function lm(e,t){(function(e,t){return e.asyncQueue.enqueue(async()=>function(e,t){N(e).Fs.Vs=t}(await su(e),t))})(Du(e._firestore),t).then(e=>p("setting persistent cache index auto creation isEnabled=".concat(t," succeeded"))).catch(e=>y("setting persistent cache index auto creation isEnabled=".concat(t," failed"),e))}const cm=new WeakMap;class dm{constructor(){this.Mc=new Map}static get instance(){return um||(um=new dm,function(e){if(is)throw new Error("a TestingHooksSpi instance is already set");is=e}(um)),um}lt(e){this.Mc.forEach(t=>t(e))}onExistenceFilterMismatch(e){const t=Symbol(),r=this.Mc;return r.set(t,e),()=>r.delete(t)}}let um=null;!function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];!function(e){m=e}(n.SDK_VERSION),n._registerComponent(new s.Component("firestore",(e,r)=>{let{instanceIdentifier:n,options:s}=r;const i=e.getProvider("app").getImmediate(),o=new Tu(new I(e.getProvider("auth-internal")),new F(i,e.getProvider("app-check-internal")),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new S(j.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Cr(e.options.projectId,t)}(i,n),i);return s=a({useFetchStreams:t},s),o._setSettings(s),o},"PUBLIC").setMultipleInstances(!0)),n.registerVersion(d,u,e),n.registerVersion(d,u,"cjs2020")}(),t.AbstractUserDataWriter=Ph,t.AggregateField=Ru,t.AggregateQuerySnapshot=Ou,t.Bytes=Bu,t.CACHE_SIZE_UNLIMITED=-1,t.CollectionReference=Nu,t.DocumentReference=ku,t.DocumentSnapshot=Bh,t.FieldPath=zu,t.FieldValue=Uu,t.Firestore=Tu,t.FirestoreError=S,t.GeoPoint=Vu,t.LoadBundleTask=Iu,t.PersistentCacheIndexManager=om,t.Query=wu,t.QueryCompositeFilterConstraint=Nh,t.QueryConstraint=wh,t.QueryDocumentSnapshot=zh,t.QueryEndAtConstraint=Eh,t.QueryFieldFilterConstraint=kh,t.QueryLimitConstraint=Sh,t.QueryOrderByConstraint=jh,t.QuerySnapshot=Uh,t.QueryStartAtConstraint=_h,t.SnapshotMetadata=Oh,t.Timestamp=le,t.Transaction=sm,t.VectorValue=qu,t.WriteBatch=rm,t._AutoId=M,t._ByteString=gr,t._DatabaseId=Cr,t._DocumentKey=Y,t._EmptyAppCheckTokenProvider=class{getToken(){return Promise.resolve(new P(""))}invalidateToken(){}start(e,t){}shutdown(){}},t._EmptyAuthCredentialsProvider=A,t._FieldPath=Q,t._TestingHooks=class{constructor(){throw new Error("instances of this class should not be created")}static onExistenceFilterMismatch(e){return dm.instance.onExistenceFilterMismatch(e)}},t._cast=re,t._debugAssert=function(e,t){e||b(57014,t)},t._internalAggregationQueryToProtoRunAggregationQueryRequest=function(e,t){var r;const a=sr(t,(e,t)=>new es(t,e.aggregateType,e._internalFieldPath)),n=null===(r=Du(re(e.firestore,Tu))._onlineComponents)||void 0===r?void 0:r.datastore.serializer;return void 0===n?null:Ws(n,Ka(e._query),a,!0).request},t._internalQueryToProtoQueryTarget=function(e){var t;const r=null===(t=Du(re(e.firestore,Tu))._onlineComponents)||void 0===t?void 0:t.datastore.serializer;return void 0===r?null:Gs(r,Wa(e._query)).ft},t._isBase64Available=function(){return"undefined"!=typeof atob},t._logWarn=y,t._validateIsNotUsedTogether=J,t.addDoc=function(e,t){const r=re(e.firestore,Tu),a=ju(e),n=Fh(e.converter,t);return Gh(r,[Ju(Xu(e.firestore),"addDoc",a._key,n,null!==e.converter,{}).toMutation(a._key,Mn.exists(!1))]).then(()=>a)},t.aggregateFieldEqual=function(e,t){var r,a;return e instanceof Ru&&t instanceof Ru&&e.aggregateType===t.aggregateType&&(null===(r=e._internalFieldPath)||void 0===r?void 0:r.canonicalString())===(null===(a=t._internalFieldPath)||void 0===a?void 0:a.canonicalString())},t.aggregateQuerySnapshotEqual=function(e,t){return Su(e.query,t.query)&&o.deepEqual(e.data(),t.data())},t.and=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.forEach(e=>Dh("and",e)),Nh._create("and",t)},t.arrayRemove=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return new rh("arrayRemove",t)},t.arrayUnion=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return new th("arrayUnion",t)},t.average=function(e){return new Ru("avg",uh("average",e))},t.clearIndexedDbPersistence=function(e){if(e._initialized&&!e._terminated)throw new S(j.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const t=new _;return e._queue.enqueueAndForgetEvenWhileRestricted(async()=>{try{await async function(e){if(!Ae.v())return Promise.resolve();const t=e+rl;await Ae.delete(t)}(il(e._databaseId,e._persistenceKey)),t.resolve()}catch(e){t.reject(e)}}),t.promise},t.collection=function(e,t){for(var r=arguments.length,a=new Array(r>2?r-2:0),n=2;n<r;n++)a[n-2]=arguments[n];if(e=o.getModularInstance(e),X("collection","path",t),e instanceof vu){const r=W.fromString(t,...a);return $(r),new Nu(e,null,r)}{if(!(e instanceof ku||e instanceof Nu))throw new S(j.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=e._path.child(W.fromString(t,...a));return $(r),new Nu(e.firestore,null,r)}},t.collectionGroup=function(e,t){if(e=re(e,vu),X("collectionGroup","collection id",t),t.indexOf("/")>=0)throw new S(j.INVALID_ARGUMENT,"Invalid collection ID '".concat(t,"' passed to function collectionGroup(). Collection IDs must not contain '/'."));return new wu(e,null,function(e){return new za(W.emptyPath(),e)}(t))},t.connectFirestoreEmulator=bu,t.count=Mh,t.deleteAllPersistentCacheIndexes=function(e){(function(e){return e.asyncQueue.enqueue(async()=>function(e){const t=N(e),r=t.indexManager;return t.persistence.runTransaction("Delete All Indexes","readwrite",e=>r.deleteAllFieldIndexes(e))}(await su(e)))})(Du(e._firestore)).then(e=>p("deleting all persistent cache indexes succeeded")).catch(e=>y("deleting all persistent cache indexes failed",e))},t.deleteDoc=function(e){return Gh(re(e.firestore,Tu),[new Yn(e._key,Mn.none())])},t.deleteField=function(){return new Zu("deleteField")},t.disableNetwork=function(e){return function(e){return e.asyncQueue.enqueue(async()=>{const t=await nu(e),r=await iu(e);return t.setNetworkEnabled(!1),async function(e){const t=N(e);t.Ea.add(0),await cc(t),t.Ra.set("Offline")}(r)})}(Du(e=re(e,Tu)))},t.disablePersistentCacheIndexAutoCreation=function(e){lm(e,!1)},t.doc=ju,t.documentId=function(){return new zu(H)},t.documentSnapshotFromJSON=function(e,t,r){if(se(t,Bh._jsonSchema)){if(t.bundle===Rh)throw new S(j.INVALID_ARGUMENT,"The provided JSON object was created in a client environment, which is not supported.");const a=Jl(e._databaseId),n=mu(t.bundle,a),s=n.Wu(),i=new td(n.getMetadata(),a);for(const e of s)i.Ga(e);const o=i.documents;if(1!==o.length)throw new S(j.INVALID_ARGUMENT,"Expected bundle data to contain 1 document, but it contains ".concat(o.length," documents."));const l=Us(a,o[0].document),c=new Y(W.fromString(t.bundleName));return new Bh(e,new Lh(e),c,l,new Oh(!1,!1),r||null)}},t.enableIndexedDbPersistence=function(e,t){y("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const r=e._freezeSettings();return Fu(e,Gd.provider,{build:e=>new qd(e,r.cacheSizeBytes,null===t||void 0===t?void 0:t.forceOwnership)}),Promise.resolve()},t.enableMultiTabIndexedDbPersistence=async function(e){y("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=e._freezeSettings();Fu(e,Gd.provider,{build:e=>new Hd(e,t.cacheSizeBytes)})},t.enableNetwork=function(e){return function(e){return e.asyncQueue.enqueue(async()=>{const t=await nu(e),r=await iu(e);return t.setNetworkEnabled(!0),function(e){const t=N(e);return t.Ea.delete(0),lc(t)}(r)})}(Du(e=re(e,Tu)))},t.enablePersistentCacheIndexAutoCreation=function(e){lm(e,!0)},t.endAt=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return Eh._create("endAt",t,!0)},t.endBefore=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return Eh._create("endBefore",t,!1)},t.ensureFirestoreConfigured=Du,t.executeWrite=Gh,t.getAggregateFromServer=Kh,t.getCountFromServer=function(e){return Kh(e,{count:Mh()})},t.getDoc=function(e){e=re(e,ku);const t=re(e.firestore,Tu);return du(Du(t),e._key).then(r=>Wh(t,e,r))},t.getDocFromCache=function(e){e=re(e,ku);const t=re(e.firestore,Tu),r=Du(t),a=new qh(t);return function(e,t){const r=new _;return e.asyncQueue.enqueueAndForget(async()=>async function(e,t,r){try{const a=await function(e,t){const r=N(e);return r.persistence.runTransaction("read document","readonly",e=>r.localDocuments.getDocument(e,t))}(e,t);a.isFoundDocument()?r.resolve(a):a.isNoDocument()?r.resolve(null):r.reject(new S(j.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(e){const a=Oc(e,"Failed to get document '".concat(t," from cache"));r.reject(a)}}(await su(e),t,r)),r.promise}(r,e._key).then(r=>new Bh(t,a,e._key,r,new Oh(null!==r&&r.hasLocalMutations,!0),e.converter))},t.getDocFromServer=function(e){e=re(e,ku);const t=re(e.firestore,Tu);return du(Du(t),e._key,{source:"server"}).then(r=>Wh(t,e,r))},t.getDocs=function(e){e=re(e,wu);const t=re(e.firestore,Tu),r=Du(t),a=new qh(t);return vh(e._query),uu(r,e._query).then(r=>new Uh(t,a,e,r))},t.getDocsFromCache=function(e){e=re(e,wu);const t=re(e.firestore,Tu),r=Du(t),a=new qh(t);return function(e,t){const r=new _;return e.asyncQueue.enqueueAndForget(async()=>async function(e,t,r){try{const a=await vl(e,t,!0),n=new sd(t,a.Qs),s=n.ru(a.documents),i=n.applyChanges(s,!1);r.resolve(i.snapshot)}catch(e){const a=Oc(e,"Failed to execute query '".concat(t," against cache"));r.reject(a)}}(await su(e),t,r)),r.promise}(r,e._query).then(r=>new Uh(t,a,e,r))},t.getDocsFromServer=function(e){e=re(e,wu);const t=re(e.firestore,Tu),r=Du(t),a=new qh(t);return uu(r,e._query,{source:"server"}).then(r=>new Uh(t,a,e,r))},t.getFirestore=function(e,t){const r="object"==typeof e?e:n.getApp(),a="string"==typeof e?e:t||Ar,s=n._getProvider(r,"firestore").getImmediate({identifier:a});if(!s._initialized){const e=o.getDefaultEmulatorHostnameAndPort("firestore");e&&bu(s,...e)}return s},t.getPersistentCacheIndexManager=function(e){var t;e=re(e,Tu);const r=cm.get(e);if(r)return r;if("persistent"!==(null===(t=Du(e)._uninitializedComponentsProvider)||void 0===t?void 0:t._offline.kind))return null;const a=new om(e);return cm.set(e,a),a},t.increment=function(e){return new ah("increment",e)},t.initializeFirestore=function(e,t,r){r||(r=Ar);const a=n._getProvider(e,"firestore");if(a.isInitialized(r)){const e=a.getImmediate({identifier:r}),n=a.getOptions(r);if(o.deepEqual(n,t))return e;throw new S(j.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(void 0!==t.cacheSizeBytes&&void 0!==t.localCache)throw new S(j.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(void 0!==t.cacheSizeBytes&&-1!==t.cacheSizeBytes&&t.cacheSizeBytes<yo)throw new S(j.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return t.host&&o.isCloudWorkstation(t.host)&&o.pingServer(t.host),a.initialize({options:t,instanceIdentifier:r})},t.limit=function(e){return ae("limit",e),Sh._create("limit",e,"F")},t.limitToLast=function(e){return ae("limitToLast",e),Sh._create("limitToLast",e,"L")},t.loadBundle=Lu,t.memoryEagerGarbageCollector=function(){return new Xh},t.memoryLocalCache=function(e){return new Qh(e)},t.memoryLruGarbageCollector=function(e){return new Jh(null===e||void 0===e?void 0:e.cacheSizeBytes)},t.namedQuery=Mu,t.onSnapshot=Hh,t.onSnapshotResume=function(e,t){const r=o.getModularInstance(e),a=function(e){const t={bundle:"",bundleName:"",bundleSource:""},r=["bundle","bundleName","bundleSource"];for(const a of r){if(!(a in e)){t.error="snapshotJson missing required field: ".concat(a);break}const r=e[a];if("string"!=typeof r){t.error="snapshotJson field '".concat(a,"' must be a string.");break}if(0===r.length){t.error="snapshotJson field '".concat(a,"' cannot be an empty string.");break}"bundle"===a?t.bundle=r:"bundleName"===a?t.bundleName=r:"bundleSource"===a&&(t.bundleSource=r)}return t}(t);if(a.error)throw new S(j.INVALID_ARGUMENT,a.error);let n,s=0;for(var i=arguments.length,l=new Array(i>2?i-2:0),c=2;c<i;c++)l[c-2]=arguments[c];if("object"!=typeof l[s]||Cu(l[s])||(n=l[s++]),"QuerySnapshot"===a.bundleSource){let e=null;if("object"==typeof l[s]&&Cu(l[s])){const t=l[s++];e={next:t.next,error:t.error,complete:t.complete}}else e={next:l[s++],error:l[s++],complete:l[s++]};return function(e,t,r,a,n){let s,i=!1;return Lu(e,t.bundle).then(()=>Mu(e,t.bundleName)).then(e=>{e&&!i&&(n&&e.withConverter(n),s=Hh(e,r||{},a))}).catch(e=>(a.error&&a.error(e),()=>{})),()=>{i||(i=!0,s&&s())}}(r,a,n,e,l[s])}if("DocumentSnapshot"===a.bundleSource){let e=null;if("object"==typeof l[s]&&Cu(l[s])){const t=l[s++];e={next:t.next,error:t.error,complete:t.complete}}else e={next:l[s++],error:l[s++],complete:l[s++]};return function(e,t,r,a,n){let s,i=!1;return Lu(e,t.bundle).then(()=>{if(!i){const i=new ku(e,n||null,Y.fromPath(t.bundleName));s=Hh(i,r||{},a)}}).catch(e=>(a.error&&a.error(e),()=>{})),()=>{i||(i=!0,s&&s())}}(r,a,n,e,l[s])}throw new S(j.INVALID_ARGUMENT,"unsupported bundle source: ".concat(a.bundleSource))},t.onSnapshotsInSync=function(e,t){return function(e,t){const r=new Kd(t);return e.asyncQueue.enqueueAndForget(async()=>function(e,t){N(e).Ca.add(t),t.next()}(await cu(e),r)),()=>{r.Nu(),e.asyncQueue.enqueueAndForget(async()=>function(e,t){N(e).Ca.delete(t)}(await cu(e),r))}}(Du(e=re(e,Tu)),Cu(t)?t:{next:t})},t.or=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.forEach(e=>Dh("or",e)),Nh._create("or",t)},t.orderBy=function(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc",r=yh("orderBy",e);return jh._create(r,t)},t.persistentLocalCache=function(e){return new Yh(e)},t.persistentMultipleTabManager=function(){return new $h},t.persistentSingleTabManager=em,t.query=function(e,t){let r=[];for(var a=arguments.length,n=new Array(a>2?a-2:0),s=2;s<a;s++)n[s-2]=arguments[s];t instanceof bh&&r.push(t),r=r.concat(n),function(e){const t=e.filter(e=>e instanceof Nh).length,r=e.filter(e=>e instanceof kh).length;if(t>1||t>0&&r>0)throw new S(j.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)e=i._apply(e);return e},t.queryEqual=Su,t.querySnapshotFromJSON=function(e,t,r){if(se(t,Uh._jsonSchema)){if(t.bundle===Rh)throw new S(j.INVALID_ARGUMENT,"The provided JSON object was created in a client environment, which is not supported.");const a=Jl(e._databaseId),n=mu(t.bundle,a),s=n.Wu(),i=new td(n.getMetadata(),a);for(const e of s)i.Ga(e);if(1!==i.queries.length)throw new S(j.INVALID_ARGUMENT,"Snapshot data expected 1 query but found ".concat(i.queries.length," queries."));const o=hi(i.queries[0].bundledQuery),l=i.documents;let c=new Bc;l.map(e=>{const t=Us(a,e.document);c=c.add(t)});const d=Uc.fromInitialDocuments(o,c,pn(),!1,!1),u=new wu(e,r||null,o);return new Uh(e,new Lh(e),u,d)}},t.refEqual=function(e,t){return e=o.getModularInstance(e),t=o.getModularInstance(t),(e instanceof ku||e instanceof Nu)&&(t instanceof ku||t instanceof Nu)&&e.firestore===t.firestore&&e.path===t.path&&e.converter===t.converter},t.runTransaction=function(e,t,r){e=re(e,Tu);const n=a(a({},tm),r);return function(e){if(e.maxAttempts<1)throw new S(j.INVALID_ARGUMENT,"Max attempts must be at least 1")}(n),function(e,t,r){const a=new _;return e.asyncQueue.enqueueAndForget(async()=>{const n=await lu(e);new Jd(e.asyncQueue,n,r,t,a).ju()}),a.promise}(Du(e),r=>t(new sm(e,r)),n)},t.serverTimestamp=function(){return new eh("serverTimestamp")},t.setDoc=function(e,t,r){e=re(e,ku);const a=re(e.firestore,Tu),n=Fh(e.converter,t,r);return Gh(a,[Ju(Xu(a),"setDoc",e._key,n,null!==e.converter,r).toMutation(e._key,Mn.none())])},t.setIndexConfiguration=function(e,t){const r=Du(e=re(e,Tu));if(!r._uninitializedComponentsProvider||"memory"===r._uninitializedComponentsProvider._offline.kind)return y("Cannot enable indexes when persistence is disabled"),Promise.resolve();const a=function(e){const t="string"==typeof e?function(e){try{return JSON.parse(e)}catch(e){throw new S(j.INVALID_ARGUMENT,"Failed to parse JSON: "+(null===e||void 0===e?void 0:e.message))}}(e):e,r=[];if(Array.isArray(t.indexes))for(const a of t.indexes){const e=im(a,"collectionGroup"),t=[];if(Array.isArray(a.fields))for(const r of a.fields){const e=mh("setIndexConfiguration",im(r,"fieldPath"));"CONTAINS"===r.arrayConfig?t.push(new ge(e,2)):"ASCENDING"===r.order?t.push(new ge(e,0)):"DESCENDING"===r.order&&t.push(new ge(e,1))}r.push(new ue(ue.UNKNOWN_ID,e,t,xe.empty()))}return r}(t);return function(e,t){return e.asyncQueue.enqueue(async()=>async function(e,t){const r=N(e),a=r.indexManager,n=[];return r.persistence.runTransaction("Configure indexes","readwrite",e=>a.getFieldIndexes(e).next(r=>function(e,t,r,a,n){e=[...e],t=[...t],e.sort(r),t.sort(r);const s=e.length,i=t.length;let o=0,l=0;for(;o<i&&l<s;){const s=r(e[l],t[o]);s<0?n(e[l++]):s>0?a(t[o++]):(o++,l++)}for(;o<i;)a(t[o++]);for(;l<s;)n(e[l++])}(r,t,fe,t=>{n.push(a.addFieldIndex(e,t))},t=>{n.push(a.deleteFieldIndex(e,t))})).next(()=>Se.waitFor(n)))}(await su(e),t))}(r,a)},t.setLogLevel=function(e){f.setLogLevel(e)},t.snapshotEqual=function(e,t){return e instanceof Bh&&t instanceof Bh?e._firestore===t._firestore&&e._key.isEqual(t._key)&&(null===e._document?null===t._document:e._document.isEqual(t._document))&&e._converter===t._converter:e instanceof Uh&&t instanceof Uh&&e._firestore===t._firestore&&Su(e.query,t.query)&&e.metadata.isEqual(t.metadata)&&e._snapshot.isEqual(t._snapshot)},t.startAfter=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return _h._create("startAfter",t,!1)},t.startAt=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return _h._create("startAt",t,!0)},t.sum=function(e){return new Ru("sum",uh("sum",e))},t.terminate=function(e){return n._removeServiceInstance(e.app,"firestore",e._databaseId.database),e._delete()},t.updateDoc=function(e,t,r){e=re(e,ku);const a=re(e.firestore,Tu),n=Xu(a);let s;for(var i=arguments.length,l=new Array(i>3?i-3:0),c=3;c<i;c++)l[c-3]=arguments[c];return s="string"==typeof(t=o.getModularInstance(t))||t instanceof zu?sh(n,"updateDoc",e._key,t,r,l):nh(n,"updateDoc",e._key,t),Gh(a,[s.toMutation(e._key,Mn.exists(!0))])},t.vector=function(e){return new qu(e)},t.waitForPendingWrites=function(e){return function(e){const t=new _;return e.asyncQueue.enqueueAndForget(async()=>async function(e,t){const r=N(e);pc(r.remoteStore)||p(id,"The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const e=await function(e){const t=N(e);return t.persistence.runTransaction("Get highest unacknowledged batch id","readonly",e=>t.mutationQueue.getHighestUnacknowledgedBatchId(e))}(r.localStore);if(e===Ue)return void t.resolve();const a=r.mu.get(e)||[];a.push(t),r.mu.set(e,a)}catch(e){const r=Oc(e,"Initialization of waitForPendingWrites() operation failed");t.reject(r)}}(await ou(e),t)),t.promise}(Du(e=re(e,Tu)))},t.where=function(e,t,r){const a=t,n=yh("where",e);return kh._create(n,a,r)},t.writeBatch=function(e){return Du(e=re(e,Tu)),new rm(e,t=>Gh(e,t))}},7736:(e,t,r)=>{var a=r(3738).default,n=r(9045);e.exports=function(e){var t=n(e,"string");return"symbol"==a(t)?t:t+""},e.exports.__esModule=!0,e.exports.default=e.exports},7755:function(e,t,r){e.exports=function(e){e.lib.Cipher||function(t){var r=e,a=r.lib,n=a.Base,s=a.WordArray,i=a.BufferedBlockAlgorithm,o=r.enc,l=(o.Utf8,o.Base64),c=r.algo.EvpKDF,d=a.Cipher=i.extend({cfg:n.extend(),createEncryptor:function(e,t){return this.create(this._ENC_XFORM_MODE,e,t)},createDecryptor:function(e,t){return this.create(this._DEC_XFORM_MODE,e,t)},init:function(e,t,r){this.cfg=this.cfg.extend(r),this._xformMode=e,this._key=t,this.reset()},reset:function(){i.reset.call(this),this._doReset()},process:function(e){return this._append(e),this._process()},finalize:function(e){return e&&this._append(e),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function e(e){return"string"==typeof e?v:x}return function(t){return{encrypt:function(r,a,n){return e(a).encrypt(t,r,a,n)},decrypt:function(r,a,n){return e(a).decrypt(t,r,a,n)}}}}()}),u=(a.StreamCipher=d.extend({_doFinalize:function(){return this._process(!0)},blockSize:1}),r.mode={}),h=a.BlockCipherMode=n.extend({createEncryptor:function(e,t){return this.Encryptor.create(e,t)},createDecryptor:function(e,t){return this.Decryptor.create(e,t)},init:function(e,t){this._cipher=e,this._iv=t}}),m=u.CBC=function(){var e=h.extend();function r(e,r,a){var n,s=this._iv;s?(n=s,this._iv=t):n=this._prevBlock;for(var i=0;i<a;i++)e[r+i]^=n[i]}return e.Encryptor=e.extend({processBlock:function(e,t){var a=this._cipher,n=a.blockSize;r.call(this,e,t,n),a.encryptBlock(e,t),this._prevBlock=e.slice(t,t+n)}}),e.Decryptor=e.extend({processBlock:function(e,t){var a=this._cipher,n=a.blockSize,s=e.slice(t,t+n);a.decryptBlock(e,t),r.call(this,e,t,n),this._prevBlock=s}}),e}(),f=(r.pad={}).Pkcs7={pad:function(e,t){for(var r=4*t,a=r-e.sigBytes%r,n=a<<24|a<<16|a<<8|a,i=[],o=0;o<a;o+=4)i.push(n);var l=s.create(i,a);e.concat(l)},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},g=(a.BlockCipher=d.extend({cfg:d.cfg.extend({mode:m,padding:f}),reset:function(){var e;d.reset.call(this);var t=this.cfg,r=t.iv,a=t.mode;this._xformMode==this._ENC_XFORM_MODE?e=a.createEncryptor:(e=a.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==e?this._mode.init(this,r&&r.words):(this._mode=e.call(a,this,r&&r.words),this._mode.__creator=e)},_doProcessBlock:function(e,t){this._mode.processBlock(e,t)},_doFinalize:function(){var e,t=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(t.pad(this._data,this.blockSize),e=this._process(!0)):(e=this._process(!0),t.unpad(e)),e},blockSize:4}),a.CipherParams=n.extend({init:function(e){this.mixIn(e)},toString:function(e){return(e||this.formatter).stringify(this)}})),p=(r.format={}).OpenSSL={stringify:function(e){var t=e.ciphertext,r=e.salt;return(r?s.create([1398893684,1701076831]).concat(r).concat(t):t).toString(l)},parse:function(e){var t,r=l.parse(e),a=r.words;return 1398893684==a[0]&&1701076831==a[1]&&(t=s.create(a.slice(2,4)),a.splice(0,4),r.sigBytes-=16),g.create({ciphertext:r,salt:t})}},x=a.SerializableCipher=n.extend({cfg:n.extend({format:p}),encrypt:function(e,t,r,a){a=this.cfg.extend(a);var n=e.createEncryptor(r,a),s=n.finalize(t),i=n.cfg;return g.create({ciphertext:s,key:r,iv:i.iv,algorithm:e,mode:i.mode,padding:i.padding,blockSize:e.blockSize,formatter:a.format})},decrypt:function(e,t,r,a){return a=this.cfg.extend(a),t=this._parse(t,a.format),e.createDecryptor(r,a).finalize(t.ciphertext)},_parse:function(e,t){return"string"==typeof e?t.parse(e,this):e}}),y=(r.kdf={}).OpenSSL={execute:function(e,t,r,a,n){if(a||(a=s.random(8)),n)i=c.create({keySize:t+r,hasher:n}).compute(e,a);else var i=c.create({keySize:t+r}).compute(e,a);var o=s.create(i.words.slice(t),4*r);return i.sigBytes=4*t,g.create({key:i,iv:o,salt:a})}},v=a.PasswordBasedCipher=x.extend({cfg:x.cfg.extend({kdf:y}),encrypt:function(e,t,r,a){var n=(a=this.cfg.extend(a)).kdf.execute(r,e.keySize,e.ivSize,a.salt,a.hasher);a.iv=n.iv;var s=x.encrypt.call(this,e,t,n.key,a);return s.mixIn(n),s},decrypt:function(e,t,r,a){a=this.cfg.extend(a),t=this._parse(t,a.format);var n=a.kdf.execute(r,e.keySize,e.ivSize,t.salt,a.hasher);return a.iv=n.iv,x.decrypt.call(this,e,t,n.key,a)}})}()}(r(4703),r(7020))},7766:function(e,t,r){e.exports=function(e){return function(t){var r=e,a=r.lib,n=a.WordArray,s=a.Hasher,i=r.algo,o=[];!function(){for(var e=0;e<64;e++)o[e]=4294967296*t.abs(t.sin(e+1))|0}();var l=i.MD5=s.extend({_doReset:function(){this._hash=new n.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(e,t){for(var r=0;r<16;r++){var a=t+r,n=e[a];e[a]=16711935&(n<<8|n>>>24)|4278255360&(n<<24|n>>>8)}var s=this._hash.words,i=e[t+0],l=e[t+1],m=e[t+2],f=e[t+3],g=e[t+4],p=e[t+5],x=e[t+6],y=e[t+7],v=e[t+8],b=e[t+9],w=e[t+10],k=e[t+11],N=e[t+12],j=e[t+13],S=e[t+14],_=e[t+15],E=s[0],A=s[1],C=s[2],I=s[3];E=c(E,A,C,I,i,7,o[0]),I=c(I,E,A,C,l,12,o[1]),C=c(C,I,E,A,m,17,o[2]),A=c(A,C,I,E,f,22,o[3]),E=c(E,A,C,I,g,7,o[4]),I=c(I,E,A,C,p,12,o[5]),C=c(C,I,E,A,x,17,o[6]),A=c(A,C,I,E,y,22,o[7]),E=c(E,A,C,I,v,7,o[8]),I=c(I,E,A,C,b,12,o[9]),C=c(C,I,E,A,w,17,o[10]),A=c(A,C,I,E,k,22,o[11]),E=c(E,A,C,I,N,7,o[12]),I=c(I,E,A,C,j,12,o[13]),C=c(C,I,E,A,S,17,o[14]),E=d(E,A=c(A,C,I,E,_,22,o[15]),C,I,l,5,o[16]),I=d(I,E,A,C,x,9,o[17]),C=d(C,I,E,A,k,14,o[18]),A=d(A,C,I,E,i,20,o[19]),E=d(E,A,C,I,p,5,o[20]),I=d(I,E,A,C,w,9,o[21]),C=d(C,I,E,A,_,14,o[22]),A=d(A,C,I,E,g,20,o[23]),E=d(E,A,C,I,b,5,o[24]),I=d(I,E,A,C,S,9,o[25]),C=d(C,I,E,A,f,14,o[26]),A=d(A,C,I,E,v,20,o[27]),E=d(E,A,C,I,j,5,o[28]),I=d(I,E,A,C,m,9,o[29]),C=d(C,I,E,A,y,14,o[30]),E=u(E,A=d(A,C,I,E,N,20,o[31]),C,I,p,4,o[32]),I=u(I,E,A,C,v,11,o[33]),C=u(C,I,E,A,k,16,o[34]),A=u(A,C,I,E,S,23,o[35]),E=u(E,A,C,I,l,4,o[36]),I=u(I,E,A,C,g,11,o[37]),C=u(C,I,E,A,y,16,o[38]),A=u(A,C,I,E,w,23,o[39]),E=u(E,A,C,I,j,4,o[40]),I=u(I,E,A,C,i,11,o[41]),C=u(C,I,E,A,f,16,o[42]),A=u(A,C,I,E,x,23,o[43]),E=u(E,A,C,I,b,4,o[44]),I=u(I,E,A,C,N,11,o[45]),C=u(C,I,E,A,_,16,o[46]),E=h(E,A=u(A,C,I,E,m,23,o[47]),C,I,i,6,o[48]),I=h(I,E,A,C,y,10,o[49]),C=h(C,I,E,A,S,15,o[50]),A=h(A,C,I,E,p,21,o[51]),E=h(E,A,C,I,N,6,o[52]),I=h(I,E,A,C,f,10,o[53]),C=h(C,I,E,A,w,15,o[54]),A=h(A,C,I,E,l,21,o[55]),E=h(E,A,C,I,v,6,o[56]),I=h(I,E,A,C,_,10,o[57]),C=h(C,I,E,A,x,15,o[58]),A=h(A,C,I,E,j,21,o[59]),E=h(E,A,C,I,g,6,o[60]),I=h(I,E,A,C,k,10,o[61]),C=h(C,I,E,A,m,15,o[62]),A=h(A,C,I,E,b,21,o[63]),s[0]=s[0]+E|0,s[1]=s[1]+A|0,s[2]=s[2]+C|0,s[3]=s[3]+I|0},_doFinalize:function(){var e=this._data,r=e.words,a=8*this._nDataBytes,n=8*e.sigBytes;r[n>>>5]|=128<<24-n%32;var s=t.floor(a/4294967296),i=a;r[15+(n+64>>>9<<4)]=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),r[14+(n+64>>>9<<4)]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8),e.sigBytes=4*(r.length+1),this._process();for(var o=this._hash,l=o.words,c=0;c<4;c++){var d=l[c];l[c]=16711935&(d<<8|d>>>24)|4278255360&(d<<24|d>>>8)}return o},clone:function(){var e=s.clone.call(this);return e._hash=this._hash.clone(),e}});function c(e,t,r,a,n,s,i){var o=e+(t&r|~t&a)+n+i;return(o<<s|o>>>32-s)+t}function d(e,t,r,a,n,s,i){var o=e+(t&a|r&~a)+n+i;return(o<<s|o>>>32-s)+t}function u(e,t,r,a,n,s,i){var o=e+(t^r^a)+n+i;return(o<<s|o>>>32-s)+t}function h(e,t,r,a,n,s,i){var o=e+(r^(t|~a))+n+i;return(o<<s|o>>>32-s)+t}r.MD5=s._createHelper(l),r.HmacMD5=s._createHmacHelper(l)}(Math),e.MD5}(r(4703))},8345:(e,t,r)=>{"use strict";var a=r(9950),n=r(5340);function s(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var i=new Set,o={};function l(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(o[e]=t,e=0;e<t.length;e++)i.add(t[e])}var d=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),u=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,m={},f={};function g(e,t,r,a,n,s,i){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=a,this.attributeNamespace=n,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=i}var p={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){p[e]=new g(e,0,!1,e,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];p[t]=new g(t,1,!1,e[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){p[e]=new g(e,2,!1,e.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){p[e]=new g(e,2,!1,e,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){p[e]=new g(e,3,!1,e.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(e){p[e]=new g(e,3,!0,e,null,!1,!1)}),["capture","download"].forEach(function(e){p[e]=new g(e,4,!1,e,null,!1,!1)}),["cols","rows","size","span"].forEach(function(e){p[e]=new g(e,6,!1,e,null,!1,!1)}),["rowSpan","start"].forEach(function(e){p[e]=new g(e,5,!1,e.toLowerCase(),null,!1,!1)});var x=/[\-:]([a-z])/g;function y(e){return e[1].toUpperCase()}function v(e,t,r,a){var n=p.hasOwnProperty(t)?p[t]:null;(null!==n?0!==n.type:a||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,r,a){if(null===t||"undefined"===typeof t||function(e,t,r,a){if(null!==r&&0===r.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!a&&(null!==r?!r.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,r,a))return!0;if(a)return!1;if(null!==r)switch(r.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,r,n,a)&&(r=null),a||null===n?function(e){return!!u.call(f,e)||!u.call(m,e)&&(h.test(e)?f[e]=!0:(m[e]=!0,!1))}(t)&&(null===r?e.removeAttribute(t):e.setAttribute(t,""+r)):n.mustUseProperty?e[n.propertyName]=null===r?3!==n.type&&"":r:(t=n.attributeName,a=n.attributeNamespace,null===r?e.removeAttribute(t):(r=3===(n=n.type)||4===n&&!0===r?"":""+r,a?e.setAttributeNS(a,t,r):e.setAttribute(t,r))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(x,y);p[t]=new g(t,1,!1,e,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(x,y);p[t]=new g(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(x,y);p[t]=new g(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(e){p[e]=new g(e,1,!1,e.toLowerCase(),null,!1,!1)}),p.xlinkHref=new g("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(e){p[e]=new g(e,1,!1,e.toLowerCase(),null,!0,!0)});var b=a.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,w=Symbol.for("react.element"),k=Symbol.for("react.portal"),N=Symbol.for("react.fragment"),j=Symbol.for("react.strict_mode"),S=Symbol.for("react.profiler"),_=Symbol.for("react.provider"),E=Symbol.for("react.context"),A=Symbol.for("react.forward_ref"),C=Symbol.for("react.suspense"),I=Symbol.for("react.suspense_list"),T=Symbol.for("react.memo"),D=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var P=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var F=Symbol.iterator;function L(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=F&&e[F]||e["@@iterator"])?e:null}var M,R=Object.assign;function O(e){if(void 0===M)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);M=t&&t[1]||""}return"\n"+M+e}var B=!1;function z(e,t){if(!e||B)return"";B=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var a=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){a=c}e.call(t.prototype)}else{try{throw Error()}catch(c){a=c}e()}}catch(c){if(c&&a&&"string"===typeof c.stack){for(var n=c.stack.split("\n"),s=a.stack.split("\n"),i=n.length-1,o=s.length-1;1<=i&&0<=o&&n[i]!==s[o];)o--;for(;1<=i&&0<=o;i--,o--)if(n[i]!==s[o]){if(1!==i||1!==o)do{if(i--,0>--o||n[i]!==s[o]){var l="\n"+n[i].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=i&&0<=o);break}}}finally{B=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?O(e):""}function U(e){switch(e.tag){case 5:return O(e.type);case 16:return O("Lazy");case 13:return O("Suspense");case 19:return O("SuspenseList");case 0:case 2:case 15:return e=z(e.type,!1);case 11:return e=z(e.type.render,!1);case 1:return e=z(e.type,!0);default:return""}}function V(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case N:return"Fragment";case k:return"Portal";case S:return"Profiler";case j:return"StrictMode";case C:return"Suspense";case I:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case E:return(e.displayName||"Context")+".Consumer";case _:return(e._context.displayName||"Context")+".Provider";case A:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case T:return null!==(t=e.displayName||null)?t:V(e.type)||"Memo";case D:t=e._payload,e=e._init;try{return V(e(t))}catch(r){}}return null}function q(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return V(t);case 8:return t===j?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function H(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function G(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function W(e){e._valueTracker||(e._valueTracker=function(e){var t=G(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),a=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof r&&"function"===typeof r.get&&"function"===typeof r.set){var n=r.get,s=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return n.call(this)},set:function(e){a=""+e,s.call(this,e)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return a},setValue:function(e){a=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function K(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),a="";return e&&(a=G(e)?e.checked?"true":"false":e.value),(e=a)!==r&&(t.setValue(e),!0)}function Q(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function Y(e,t){var r=t.checked;return R({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=r?r:e._wrapperState.initialChecked})}function X(e,t){var r=null==t.defaultValue?"":t.defaultValue,a=null!=t.checked?t.checked:t.defaultChecked;r=H(null!=t.value?t.value:r),e._wrapperState={initialChecked:a,initialValue:r,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function J(e,t){null!=(t=t.checked)&&v(e,"checked",t,!1)}function Z(e,t){J(e,t);var r=H(t.value),a=t.type;if(null!=r)"number"===a?(0===r&&""===e.value||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if("submit"===a||"reset"===a)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,r):t.hasOwnProperty("defaultValue")&&ee(e,t.type,H(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function $(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var a=t.type;if(!("submit"!==a&&"reset"!==a||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}""!==(r=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==r&&(e.name=r)}function ee(e,t,r){"number"===t&&Q(e.ownerDocument)===e||(null==r?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var te=Array.isArray;function re(e,t,r,a){if(e=e.options,t){t={};for(var n=0;n<r.length;n++)t["$"+r[n]]=!0;for(r=0;r<e.length;r++)n=t.hasOwnProperty("$"+e[r].value),e[r].selected!==n&&(e[r].selected=n),n&&a&&(e[r].defaultSelected=!0)}else{for(r=""+H(r),t=null,n=0;n<e.length;n++){if(e[n].value===r)return e[n].selected=!0,void(a&&(e[n].defaultSelected=!0));null!==t||e[n].disabled||(t=e[n])}null!==t&&(t.selected=!0)}}function ae(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(s(91));return R({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ne(e,t){var r=t.value;if(null==r){if(r=t.children,t=t.defaultValue,null!=r){if(null!=t)throw Error(s(92));if(te(r)){if(1<r.length)throw Error(s(93));r=r[0]}t=r}null==t&&(t=""),r=t}e._wrapperState={initialValue:H(r)}}function se(e,t){var r=H(t.value),a=H(t.defaultValue);null!=r&&((r=""+r)!==e.value&&(e.value=r),null==t.defaultValue&&e.defaultValue!==r&&(e.defaultValue=r)),null!=a&&(e.defaultValue=""+a)}function ie(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function oe(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?oe(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,de,ue=(de=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,r,a){MSApp.execUnsafeLocalFunction(function(){return de(e,t)})}:de);function he(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&3===r.nodeType)return void(r.nodeValue=t)}e.textContent=t}var me={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},fe=["Webkit","ms","Moz","O"];function ge(e,t,r){return null==t||"boolean"===typeof t||""===t?"":r||"number"!==typeof t||0===t||me.hasOwnProperty(e)&&me[e]?(""+t).trim():t+"px"}function pe(e,t){for(var r in e=e.style,t)if(t.hasOwnProperty(r)){var a=0===r.indexOf("--"),n=ge(r,t[r],a);"float"===r&&(r="cssFloat"),a?e.setProperty(r,n):e[r]=n}}Object.keys(me).forEach(function(e){fe.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),me[t]=me[e]})});var xe=R({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ye(e,t){if(t){if(xe[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(s(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(s(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(s(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(s(62))}}function ve(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var be=null;function we(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var ke=null,Ne=null,je=null;function Se(e){if(e=vn(e)){if("function"!==typeof ke)throw Error(s(280));var t=e.stateNode;t&&(t=wn(t),ke(e.stateNode,e.type,t))}}function _e(e){Ne?je?je.push(e):je=[e]:Ne=e}function Ee(){if(Ne){var e=Ne,t=je;if(je=Ne=null,Se(e),t)for(e=0;e<t.length;e++)Se(t[e])}}function Ae(e,t){return e(t)}function Ce(){}var Ie=!1;function Te(e,t,r){if(Ie)return e(t,r);Ie=!0;try{return Ae(e,t,r)}finally{Ie=!1,(null!==Ne||null!==je)&&(Ce(),Ee())}}function De(e,t){var r=e.stateNode;if(null===r)return null;var a=wn(r);if(null===a)return null;r=a[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(a=!a.disabled)||(a=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!a;break e;default:e=!1}if(e)return null;if(r&&"function"!==typeof r)throw Error(s(231,t,typeof r));return r}var Pe=!1;if(d)try{var Fe={};Object.defineProperty(Fe,"passive",{get:function(){Pe=!0}}),window.addEventListener("test",Fe,Fe),window.removeEventListener("test",Fe,Fe)}catch(de){Pe=!1}function Le(e,t,r,a,n,s,i,o,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(r,c)}catch(d){this.onError(d)}}var Me=!1,Re=null,Oe=!1,Be=null,ze={onError:function(e){Me=!0,Re=e}};function Ue(e,t,r,a,n,s,i,o,l){Me=!1,Re=null,Le.apply(ze,arguments)}function Ve(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(r=t.return),e=t.return}while(e)}return 3===t.tag?r:null}function qe(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function He(e){if(Ve(e)!==e)throw Error(s(188))}function Ge(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=Ve(e)))throw Error(s(188));return t!==e?null:e}for(var r=e,a=t;;){var n=r.return;if(null===n)break;var i=n.alternate;if(null===i){if(null!==(a=n.return)){r=a;continue}break}if(n.child===i.child){for(i=n.child;i;){if(i===r)return He(n),e;if(i===a)return He(n),t;i=i.sibling}throw Error(s(188))}if(r.return!==a.return)r=n,a=i;else{for(var o=!1,l=n.child;l;){if(l===r){o=!0,r=n,a=i;break}if(l===a){o=!0,a=n,r=i;break}l=l.sibling}if(!o){for(l=i.child;l;){if(l===r){o=!0,r=i,a=n;break}if(l===a){o=!0,a=i,r=n;break}l=l.sibling}if(!o)throw Error(s(189))}}if(r.alternate!==a)throw Error(s(190))}if(3!==r.tag)throw Error(s(188));return r.stateNode.current===r?e:t}(e))?We(e):null}function We(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=We(e);if(null!==t)return t;e=e.sibling}return null}var Ke=n.unstable_scheduleCallback,Qe=n.unstable_cancelCallback,Ye=n.unstable_shouldYield,Xe=n.unstable_requestPaint,Je=n.unstable_now,Ze=n.unstable_getCurrentPriorityLevel,$e=n.unstable_ImmediatePriority,et=n.unstable_UserBlockingPriority,tt=n.unstable_NormalPriority,rt=n.unstable_LowPriority,at=n.unstable_IdlePriority,nt=null,st=null;var it=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(ot(e)/lt|0)|0},ot=Math.log,lt=Math.LN2;var ct=64,dt=4194304;function ut(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ht(e,t){var r=e.pendingLanes;if(0===r)return 0;var a=0,n=e.suspendedLanes,s=e.pingedLanes,i=268435455&r;if(0!==i){var o=i&~n;0!==o?a=ut(o):0!==(s&=i)&&(a=ut(s))}else 0!==(i=r&~n)?a=ut(i):0!==s&&(a=ut(s));if(0===a)return 0;if(0!==t&&t!==a&&0===(t&n)&&((n=a&-a)>=(s=t&-t)||16===n&&0!==(4194240&s)))return t;if(0!==(4&a)&&(a|=16&r),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=a;0<t;)n=1<<(r=31-it(t)),a|=e[r],t&=~n;return a}function mt(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function ft(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function gt(){var e=ct;return 0===(4194240&(ct<<=1))&&(ct=64),e}function pt(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function xt(e,t,r){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-it(t)]=r}function yt(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var a=31-it(r),n=1<<a;n&t|e[a]&t&&(e[a]|=t),r&=~n}}var vt=0;function bt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var wt,kt,Nt,jt,St,_t=!1,Et=[],At=null,Ct=null,It=null,Tt=new Map,Dt=new Map,Pt=[],Ft="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Lt(e,t){switch(e){case"focusin":case"focusout":At=null;break;case"dragenter":case"dragleave":Ct=null;break;case"mouseover":case"mouseout":It=null;break;case"pointerover":case"pointerout":Tt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Dt.delete(t.pointerId)}}function Mt(e,t,r,a,n,s){return null===e||e.nativeEvent!==s?(e={blockedOn:t,domEventName:r,eventSystemFlags:a,nativeEvent:s,targetContainers:[n]},null!==t&&(null!==(t=vn(t))&&kt(t)),e):(e.eventSystemFlags|=a,t=e.targetContainers,null!==n&&-1===t.indexOf(n)&&t.push(n),e)}function Rt(e){var t=yn(e.target);if(null!==t){var r=Ve(t);if(null!==r)if(13===(t=r.tag)){if(null!==(t=qe(r)))return e.blockedOn=t,void St(e.priority,function(){Nt(r)})}else if(3===t&&r.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===r.tag?r.stateNode.containerInfo:null)}e.blockedOn=null}function Ot(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var r=Yt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==r)return null!==(t=vn(r))&&kt(t),e.blockedOn=r,!1;var a=new(r=e.nativeEvent).constructor(r.type,r);be=a,r.target.dispatchEvent(a),be=null,t.shift()}return!0}function Bt(e,t,r){Ot(e)&&r.delete(t)}function zt(){_t=!1,null!==At&&Ot(At)&&(At=null),null!==Ct&&Ot(Ct)&&(Ct=null),null!==It&&Ot(It)&&(It=null),Tt.forEach(Bt),Dt.forEach(Bt)}function Ut(e,t){e.blockedOn===t&&(e.blockedOn=null,_t||(_t=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,zt)))}function Vt(e){function t(t){return Ut(t,e)}if(0<Et.length){Ut(Et[0],e);for(var r=1;r<Et.length;r++){var a=Et[r];a.blockedOn===e&&(a.blockedOn=null)}}for(null!==At&&Ut(At,e),null!==Ct&&Ut(Ct,e),null!==It&&Ut(It,e),Tt.forEach(t),Dt.forEach(t),r=0;r<Pt.length;r++)(a=Pt[r]).blockedOn===e&&(a.blockedOn=null);for(;0<Pt.length&&null===(r=Pt[0]).blockedOn;)Rt(r),null===r.blockedOn&&Pt.shift()}var qt=b.ReactCurrentBatchConfig,Ht=!0;function Gt(e,t,r,a){var n=vt,s=qt.transition;qt.transition=null;try{vt=1,Kt(e,t,r,a)}finally{vt=n,qt.transition=s}}function Wt(e,t,r,a){var n=vt,s=qt.transition;qt.transition=null;try{vt=4,Kt(e,t,r,a)}finally{vt=n,qt.transition=s}}function Kt(e,t,r,a){if(Ht){var n=Yt(e,t,r,a);if(null===n)qa(e,t,a,Qt,r),Lt(e,a);else if(function(e,t,r,a,n){switch(t){case"focusin":return At=Mt(At,e,t,r,a,n),!0;case"dragenter":return Ct=Mt(Ct,e,t,r,a,n),!0;case"mouseover":return It=Mt(It,e,t,r,a,n),!0;case"pointerover":var s=n.pointerId;return Tt.set(s,Mt(Tt.get(s)||null,e,t,r,a,n)),!0;case"gotpointercapture":return s=n.pointerId,Dt.set(s,Mt(Dt.get(s)||null,e,t,r,a,n)),!0}return!1}(n,e,t,r,a))a.stopPropagation();else if(Lt(e,a),4&t&&-1<Ft.indexOf(e)){for(;null!==n;){var s=vn(n);if(null!==s&&wt(s),null===(s=Yt(e,t,r,a))&&qa(e,t,a,Qt,r),s===n)break;n=s}null!==n&&a.stopPropagation()}else qa(e,t,a,null,r)}}var Qt=null;function Yt(e,t,r,a){if(Qt=null,null!==(e=yn(e=we(a))))if(null===(t=Ve(e)))e=null;else if(13===(r=t.tag)){if(null!==(e=qe(t)))return e;e=null}else if(3===r){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Qt=e,null}function Xt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Ze()){case $e:return 1;case et:return 4;case tt:case rt:return 16;case at:return 536870912;default:return 16}default:return 16}}var Jt=null,Zt=null,$t=null;function er(){if($t)return $t;var e,t,r=Zt,a=r.length,n="value"in Jt?Jt.value:Jt.textContent,s=n.length;for(e=0;e<a&&r[e]===n[e];e++);var i=a-e;for(t=1;t<=i&&r[a-t]===n[s-t];t++);return $t=n.slice(e,1<t?1-t:void 0)}function tr(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function rr(){return!0}function ar(){return!1}function nr(e){function t(t,r,a,n,s){for(var i in this._reactName=t,this._targetInst=a,this.type=r,this.nativeEvent=n,this.target=s,this.currentTarget=null,e)e.hasOwnProperty(i)&&(t=e[i],this[i]=t?t(n):n[i]);return this.isDefaultPrevented=(null!=n.defaultPrevented?n.defaultPrevented:!1===n.returnValue)?rr:ar,this.isPropagationStopped=ar,this}return R(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=rr)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=rr)},persist:function(){},isPersistent:rr}),t}var sr,ir,or,lr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},cr=nr(lr),dr=R({},lr,{view:0,detail:0}),ur=nr(dr),hr=R({},dr,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:jr,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==or&&(or&&"mousemove"===e.type?(sr=e.screenX-or.screenX,ir=e.screenY-or.screenY):ir=sr=0,or=e),sr)},movementY:function(e){return"movementY"in e?e.movementY:ir}}),mr=nr(hr),fr=nr(R({},hr,{dataTransfer:0})),gr=nr(R({},dr,{relatedTarget:0})),pr=nr(R({},lr,{animationName:0,elapsedTime:0,pseudoElement:0})),xr=R({},lr,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),yr=nr(xr),vr=nr(R({},lr,{data:0})),br={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},wr={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},kr={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Nr(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=kr[e])&&!!t[e]}function jr(){return Nr}var Sr=R({},dr,{key:function(e){if(e.key){var t=br[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tr(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?wr[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:jr,charCode:function(e){return"keypress"===e.type?tr(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tr(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),_r=nr(Sr),Er=nr(R({},hr,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Ar=nr(R({},dr,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:jr})),Cr=nr(R({},lr,{propertyName:0,elapsedTime:0,pseudoElement:0})),Ir=R({},hr,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Tr=nr(Ir),Dr=[9,13,27,32],Pr=d&&"CompositionEvent"in window,Fr=null;d&&"documentMode"in document&&(Fr=document.documentMode);var Lr=d&&"TextEvent"in window&&!Fr,Mr=d&&(!Pr||Fr&&8<Fr&&11>=Fr),Rr=String.fromCharCode(32),Or=!1;function Br(e,t){switch(e){case"keyup":return-1!==Dr.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function zr(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Ur=!1;var Vr={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function qr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Vr[e.type]:"textarea"===t}function Hr(e,t,r,a){_e(a),0<(t=Ga(t,"onChange")).length&&(r=new cr("onChange","change",null,r,a),e.push({event:r,listeners:t}))}var Gr=null,Wr=null;function Kr(e){Ra(e,0)}function Qr(e){if(K(bn(e)))return e}function Yr(e,t){if("change"===e)return t}var Xr=!1;if(d){var Jr;if(d){var Zr="oninput"in document;if(!Zr){var $r=document.createElement("div");$r.setAttribute("oninput","return;"),Zr="function"===typeof $r.oninput}Jr=Zr}else Jr=!1;Xr=Jr&&(!document.documentMode||9<document.documentMode)}function ea(){Gr&&(Gr.detachEvent("onpropertychange",ta),Wr=Gr=null)}function ta(e){if("value"===e.propertyName&&Qr(Wr)){var t=[];Hr(t,Wr,e,we(e)),Te(Kr,t)}}function ra(e,t,r){"focusin"===e?(ea(),Wr=r,(Gr=t).attachEvent("onpropertychange",ta)):"focusout"===e&&ea()}function aa(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Qr(Wr)}function na(e,t){if("click"===e)return Qr(t)}function sa(e,t){if("input"===e||"change"===e)return Qr(t)}var ia="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function oa(e,t){if(ia(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var r=Object.keys(e),a=Object.keys(t);if(r.length!==a.length)return!1;for(a=0;a<r.length;a++){var n=r[a];if(!u.call(t,n)||!ia(e[n],t[n]))return!1}return!0}function la(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ca(e,t){var r,a=la(e);for(e=0;a;){if(3===a.nodeType){if(r=e+a.textContent.length,e<=t&&r>=t)return{node:a,offset:t-e};e=r}e:{for(;a;){if(a.nextSibling){a=a.nextSibling;break e}a=a.parentNode}a=void 0}a=la(a)}}function da(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?da(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function ua(){for(var e=window,t=Q();t instanceof e.HTMLIFrameElement;){try{var r="string"===typeof t.contentWindow.location.href}catch(a){r=!1}if(!r)break;t=Q((e=t.contentWindow).document)}return t}function ha(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function ma(e){var t=ua(),r=e.focusedElem,a=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&da(r.ownerDocument.documentElement,r)){if(null!==a&&ha(r))if(t=a.start,void 0===(e=a.end)&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if((e=(t=r.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var n=r.textContent.length,s=Math.min(a.start,n);a=void 0===a.end?s:Math.min(a.end,n),!e.extend&&s>a&&(n=a,a=s,s=n),n=ca(r,s);var i=ca(r,a);n&&i&&(1!==e.rangeCount||e.anchorNode!==n.node||e.anchorOffset!==n.offset||e.focusNode!==i.node||e.focusOffset!==i.offset)&&((t=t.createRange()).setStart(n.node,n.offset),e.removeAllRanges(),s>a?(e.addRange(t),e.extend(i.node,i.offset)):(t.setEnd(i.node,i.offset),e.addRange(t)))}for(t=[],e=r;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof r.focus&&r.focus(),r=0;r<t.length;r++)(e=t[r]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var fa=d&&"documentMode"in document&&11>=document.documentMode,ga=null,pa=null,xa=null,ya=!1;function va(e,t,r){var a=r.window===r?r.document:9===r.nodeType?r:r.ownerDocument;ya||null==ga||ga!==Q(a)||("selectionStart"in(a=ga)&&ha(a)?a={start:a.selectionStart,end:a.selectionEnd}:a={anchorNode:(a=(a.ownerDocument&&a.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:a.anchorOffset,focusNode:a.focusNode,focusOffset:a.focusOffset},xa&&oa(xa,a)||(xa=a,0<(a=Ga(pa,"onSelect")).length&&(t=new cr("onSelect","select",null,t,r),e.push({event:t,listeners:a}),t.target=ga)))}function ba(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var wa={animationend:ba("Animation","AnimationEnd"),animationiteration:ba("Animation","AnimationIteration"),animationstart:ba("Animation","AnimationStart"),transitionend:ba("Transition","TransitionEnd")},ka={},Na={};function ja(e){if(ka[e])return ka[e];if(!wa[e])return e;var t,r=wa[e];for(t in r)if(r.hasOwnProperty(t)&&t in Na)return ka[e]=r[t];return e}d&&(Na=document.createElement("div").style,"AnimationEvent"in window||(delete wa.animationend.animation,delete wa.animationiteration.animation,delete wa.animationstart.animation),"TransitionEvent"in window||delete wa.transitionend.transition);var Sa=ja("animationend"),_a=ja("animationiteration"),Ea=ja("animationstart"),Aa=ja("transitionend"),Ca=new Map,Ia="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ta(e,t){Ca.set(e,t),l(t,[e])}for(var Da=0;Da<Ia.length;Da++){var Pa=Ia[Da];Ta(Pa.toLowerCase(),"on"+(Pa[0].toUpperCase()+Pa.slice(1)))}Ta(Sa,"onAnimationEnd"),Ta(_a,"onAnimationIteration"),Ta(Ea,"onAnimationStart"),Ta("dblclick","onDoubleClick"),Ta("focusin","onFocus"),Ta("focusout","onBlur"),Ta(Aa,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Fa="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),La=new Set("cancel close invalid load scroll toggle".split(" ").concat(Fa));function Ma(e,t,r){var a=e.type||"unknown-event";e.currentTarget=r,function(e,t,r,a,n,i,o,l,c){if(Ue.apply(this,arguments),Me){if(!Me)throw Error(s(198));var d=Re;Me=!1,Re=null,Oe||(Oe=!0,Be=d)}}(a,t,void 0,e),e.currentTarget=null}function Ra(e,t){t=0!==(4&t);for(var r=0;r<e.length;r++){var a=e[r],n=a.event;a=a.listeners;e:{var s=void 0;if(t)for(var i=a.length-1;0<=i;i--){var o=a[i],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==s&&n.isPropagationStopped())break e;Ma(n,o,c),s=l}else for(i=0;i<a.length;i++){if(l=(o=a[i]).instance,c=o.currentTarget,o=o.listener,l!==s&&n.isPropagationStopped())break e;Ma(n,o,c),s=l}}}if(Oe)throw e=Be,Oe=!1,Be=null,e}function Oa(e,t){var r=t[gn];void 0===r&&(r=t[gn]=new Set);var a=e+"__bubble";r.has(a)||(Va(t,e,2,!1),r.add(a))}function Ba(e,t,r){var a=0;t&&(a|=4),Va(r,e,a,t)}var za="_reactListening"+Math.random().toString(36).slice(2);function Ua(e){if(!e[za]){e[za]=!0,i.forEach(function(t){"selectionchange"!==t&&(La.has(t)||Ba(t,!1,e),Ba(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[za]||(t[za]=!0,Ba("selectionchange",!1,t))}}function Va(e,t,r,a){switch(Xt(t)){case 1:var n=Gt;break;case 4:n=Wt;break;default:n=Kt}r=n.bind(null,t,r,e),n=void 0,!Pe||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(n=!0),a?void 0!==n?e.addEventListener(t,r,{capture:!0,passive:n}):e.addEventListener(t,r,!0):void 0!==n?e.addEventListener(t,r,{passive:n}):e.addEventListener(t,r,!1)}function qa(e,t,r,a,n){var s=a;if(0===(1&t)&&0===(2&t)&&null!==a)e:for(;;){if(null===a)return;var i=a.tag;if(3===i||4===i){var o=a.stateNode.containerInfo;if(o===n||8===o.nodeType&&o.parentNode===n)break;if(4===i)for(i=a.return;null!==i;){var l=i.tag;if((3===l||4===l)&&((l=i.stateNode.containerInfo)===n||8===l.nodeType&&l.parentNode===n))return;i=i.return}for(;null!==o;){if(null===(i=yn(o)))return;if(5===(l=i.tag)||6===l){a=s=i;continue e}o=o.parentNode}}a=a.return}Te(function(){var a=s,n=we(r),i=[];e:{var o=Ca.get(e);if(void 0!==o){var l=cr,c=e;switch(e){case"keypress":if(0===tr(r))break e;case"keydown":case"keyup":l=_r;break;case"focusin":c="focus",l=gr;break;case"focusout":c="blur",l=gr;break;case"beforeblur":case"afterblur":l=gr;break;case"click":if(2===r.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=mr;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=fr;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=Ar;break;case Sa:case _a:case Ea:l=pr;break;case Aa:l=Cr;break;case"scroll":l=ur;break;case"wheel":l=Tr;break;case"copy":case"cut":case"paste":l=yr;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=Er}var d=0!==(4&t),u=!d&&"scroll"===e,h=d?null!==o?o+"Capture":null:o;d=[];for(var m,f=a;null!==f;){var g=(m=f).stateNode;if(5===m.tag&&null!==g&&(m=g,null!==h&&(null!=(g=De(f,h))&&d.push(Ha(f,g,m)))),u)break;f=f.return}0<d.length&&(o=new l(o,c,null,r,n),i.push({event:o,listeners:d}))}}if(0===(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(o="mouseover"===e||"pointerover"===e)||r===be||!(c=r.relatedTarget||r.fromElement)||!yn(c)&&!c[fn])&&(l||o)&&(o=n.window===n?n:(o=n.ownerDocument)?o.defaultView||o.parentWindow:window,l?(l=a,null!==(c=(c=r.relatedTarget||r.toElement)?yn(c):null)&&(c!==(u=Ve(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=a),l!==c)){if(d=mr,g="onMouseLeave",h="onMouseEnter",f="mouse","pointerout"!==e&&"pointerover"!==e||(d=Er,g="onPointerLeave",h="onPointerEnter",f="pointer"),u=null==l?o:bn(l),m=null==c?o:bn(c),(o=new d(g,f+"leave",l,r,n)).target=u,o.relatedTarget=m,g=null,yn(n)===a&&((d=new d(h,f+"enter",c,r,n)).target=m,d.relatedTarget=u,g=d),u=g,l&&c)e:{for(h=c,f=0,m=d=l;m;m=Wa(m))f++;for(m=0,g=h;g;g=Wa(g))m++;for(;0<f-m;)d=Wa(d),f--;for(;0<m-f;)h=Wa(h),m--;for(;f--;){if(d===h||null!==h&&d===h.alternate)break e;d=Wa(d),h=Wa(h)}d=null}else d=null;null!==l&&Ka(i,o,l,d,!1),null!==c&&null!==u&&Ka(i,u,c,d,!0)}if("select"===(l=(o=a?bn(a):window).nodeName&&o.nodeName.toLowerCase())||"input"===l&&"file"===o.type)var p=Yr;else if(qr(o))if(Xr)p=sa;else{p=aa;var x=ra}else(l=o.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===o.type||"radio"===o.type)&&(p=na);switch(p&&(p=p(e,a))?Hr(i,p,r,n):(x&&x(e,o,a),"focusout"===e&&(x=o._wrapperState)&&x.controlled&&"number"===o.type&&ee(o,"number",o.value)),x=a?bn(a):window,e){case"focusin":(qr(x)||"true"===x.contentEditable)&&(ga=x,pa=a,xa=null);break;case"focusout":xa=pa=ga=null;break;case"mousedown":ya=!0;break;case"contextmenu":case"mouseup":case"dragend":ya=!1,va(i,r,n);break;case"selectionchange":if(fa)break;case"keydown":case"keyup":va(i,r,n)}var y;if(Pr)e:{switch(e){case"compositionstart":var v="onCompositionStart";break e;case"compositionend":v="onCompositionEnd";break e;case"compositionupdate":v="onCompositionUpdate";break e}v=void 0}else Ur?Br(e,r)&&(v="onCompositionEnd"):"keydown"===e&&229===r.keyCode&&(v="onCompositionStart");v&&(Mr&&"ko"!==r.locale&&(Ur||"onCompositionStart"!==v?"onCompositionEnd"===v&&Ur&&(y=er()):(Zt="value"in(Jt=n)?Jt.value:Jt.textContent,Ur=!0)),0<(x=Ga(a,v)).length&&(v=new vr(v,e,null,r,n),i.push({event:v,listeners:x}),y?v.data=y:null!==(y=zr(r))&&(v.data=y))),(y=Lr?function(e,t){switch(e){case"compositionend":return zr(t);case"keypress":return 32!==t.which?null:(Or=!0,Rr);case"textInput":return(e=t.data)===Rr&&Or?null:e;default:return null}}(e,r):function(e,t){if(Ur)return"compositionend"===e||!Pr&&Br(e,t)?(e=er(),$t=Zt=Jt=null,Ur=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Mr&&"ko"!==t.locale?null:t.data}}(e,r))&&(0<(a=Ga(a,"onBeforeInput")).length&&(n=new vr("onBeforeInput","beforeinput",null,r,n),i.push({event:n,listeners:a}),n.data=y))}Ra(i,t)})}function Ha(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Ga(e,t){for(var r=t+"Capture",a=[];null!==e;){var n=e,s=n.stateNode;5===n.tag&&null!==s&&(n=s,null!=(s=De(e,r))&&a.unshift(Ha(e,s,n)),null!=(s=De(e,t))&&a.push(Ha(e,s,n))),e=e.return}return a}function Wa(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Ka(e,t,r,a,n){for(var s=t._reactName,i=[];null!==r&&r!==a;){var o=r,l=o.alternate,c=o.stateNode;if(null!==l&&l===a)break;5===o.tag&&null!==c&&(o=c,n?null!=(l=De(r,s))&&i.unshift(Ha(r,l,o)):n||null!=(l=De(r,s))&&i.push(Ha(r,l,o))),r=r.return}0!==i.length&&e.push({event:t,listeners:i})}var Qa=/\r\n?/g,Ya=/\u0000|\uFFFD/g;function Xa(e){return("string"===typeof e?e:""+e).replace(Qa,"\n").replace(Ya,"")}function Ja(e,t,r){if(t=Xa(t),Xa(e)!==t&&r)throw Error(s(425))}function Za(){}var $a=null,en=null;function tn(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var rn="function"===typeof setTimeout?setTimeout:void 0,an="function"===typeof clearTimeout?clearTimeout:void 0,nn="function"===typeof Promise?Promise:void 0,sn="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof nn?function(e){return nn.resolve(null).then(e).catch(on)}:rn;function on(e){setTimeout(function(){throw e})}function ln(e,t){var r=t,a=0;do{var n=r.nextSibling;if(e.removeChild(r),n&&8===n.nodeType)if("/$"===(r=n.data)){if(0===a)return e.removeChild(n),void Vt(t);a--}else"$"!==r&&"$?"!==r&&"$!"!==r||a++;r=n}while(r);Vt(t)}function cn(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function dn(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var r=e.data;if("$"===r||"$!"===r||"$?"===r){if(0===t)return e;t--}else"/$"===r&&t++}e=e.previousSibling}return null}var un=Math.random().toString(36).slice(2),hn="__reactFiber$"+un,mn="__reactProps$"+un,fn="__reactContainer$"+un,gn="__reactEvents$"+un,pn="__reactListeners$"+un,xn="__reactHandles$"+un;function yn(e){var t=e[hn];if(t)return t;for(var r=e.parentNode;r;){if(t=r[fn]||r[hn]){if(r=t.alternate,null!==t.child||null!==r&&null!==r.child)for(e=dn(e);null!==e;){if(r=e[hn])return r;e=dn(e)}return t}r=(e=r).parentNode}return null}function vn(e){return!(e=e[hn]||e[fn])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function bn(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(s(33))}function wn(e){return e[mn]||null}var kn=[],Nn=-1;function jn(e){return{current:e}}function Sn(e){0>Nn||(e.current=kn[Nn],kn[Nn]=null,Nn--)}function _n(e,t){Nn++,kn[Nn]=e.current,e.current=t}var En={},An=jn(En),Cn=jn(!1),In=En;function Tn(e,t){var r=e.type.contextTypes;if(!r)return En;var a=e.stateNode;if(a&&a.__reactInternalMemoizedUnmaskedChildContext===t)return a.__reactInternalMemoizedMaskedChildContext;var n,s={};for(n in r)s[n]=t[n];return a&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function Dn(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Pn(){Sn(Cn),Sn(An)}function Fn(e,t,r){if(An.current!==En)throw Error(s(168));_n(An,t),_n(Cn,r)}function Ln(e,t,r){var a=e.stateNode;if(t=t.childContextTypes,"function"!==typeof a.getChildContext)return r;for(var n in a=a.getChildContext())if(!(n in t))throw Error(s(108,q(e)||"Unknown",n));return R({},r,a)}function Mn(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||En,In=An.current,_n(An,e),_n(Cn,Cn.current),!0}function Rn(e,t,r){var a=e.stateNode;if(!a)throw Error(s(169));r?(e=Ln(e,t,In),a.__reactInternalMemoizedMergedChildContext=e,Sn(Cn),Sn(An),_n(An,e)):Sn(Cn),_n(Cn,r)}var On=null,Bn=!1,zn=!1;function Un(e){null===On?On=[e]:On.push(e)}function Vn(){if(!zn&&null!==On){zn=!0;var e=0,t=vt;try{var r=On;for(vt=1;e<r.length;e++){var a=r[e];do{a=a(!0)}while(null!==a)}On=null,Bn=!1}catch(n){throw null!==On&&(On=On.slice(e+1)),Ke($e,Vn),n}finally{vt=t,zn=!1}}return null}var qn=[],Hn=0,Gn=null,Wn=0,Kn=[],Qn=0,Yn=null,Xn=1,Jn="";function Zn(e,t){qn[Hn++]=Wn,qn[Hn++]=Gn,Gn=e,Wn=t}function $n(e,t,r){Kn[Qn++]=Xn,Kn[Qn++]=Jn,Kn[Qn++]=Yn,Yn=e;var a=Xn;e=Jn;var n=32-it(a)-1;a&=~(1<<n),r+=1;var s=32-it(t)+n;if(30<s){var i=n-n%5;s=(a&(1<<i)-1).toString(32),a>>=i,n-=i,Xn=1<<32-it(t)+n|r<<n|a,Jn=s+e}else Xn=1<<s|r<<n|a,Jn=e}function es(e){null!==e.return&&(Zn(e,1),$n(e,1,0))}function ts(e){for(;e===Gn;)Gn=qn[--Hn],qn[Hn]=null,Wn=qn[--Hn],qn[Hn]=null;for(;e===Yn;)Yn=Kn[--Qn],Kn[Qn]=null,Jn=Kn[--Qn],Kn[Qn]=null,Xn=Kn[--Qn],Kn[Qn]=null}var rs=null,as=null,ns=!1,ss=null;function is(e,t){var r=Tc(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,null===(t=e.deletions)?(e.deletions=[r],e.flags|=16):t.push(r)}function os(e,t){switch(e.tag){case 5:var r=e.type;return null!==(t=1!==t.nodeType||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,rs=e,as=cn(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,rs=e,as=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(r=null!==Yn?{id:Xn,overflow:Jn}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},(r=Tc(18,null,null,0)).stateNode=t,r.return=e,e.child=r,rs=e,as=null,!0);default:return!1}}function ls(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function cs(e){if(ns){var t=as;if(t){var r=t;if(!os(e,t)){if(ls(e))throw Error(s(418));t=cn(r.nextSibling);var a=rs;t&&os(e,t)?is(a,r):(e.flags=-4097&e.flags|2,ns=!1,rs=e)}}else{if(ls(e))throw Error(s(418));e.flags=-4097&e.flags|2,ns=!1,rs=e}}}function ds(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;rs=e}function us(e){if(e!==rs)return!1;if(!ns)return ds(e),ns=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!tn(e.type,e.memoizedProps)),t&&(t=as)){if(ls(e))throw hs(),Error(s(418));for(;t;)is(e,t),t=cn(t.nextSibling)}if(ds(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(s(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var r=e.data;if("/$"===r){if(0===t){as=cn(e.nextSibling);break e}t--}else"$"!==r&&"$!"!==r&&"$?"!==r||t++}e=e.nextSibling}as=null}}else as=rs?cn(e.stateNode.nextSibling):null;return!0}function hs(){for(var e=as;e;)e=cn(e.nextSibling)}function ms(){as=rs=null,ns=!1}function fs(e){null===ss?ss=[e]:ss.push(e)}var gs=b.ReactCurrentBatchConfig;function ps(e,t,r){if(null!==(e=r.ref)&&"function"!==typeof e&&"object"!==typeof e){if(r._owner){if(r=r._owner){if(1!==r.tag)throw Error(s(309));var a=r.stateNode}if(!a)throw Error(s(147,e));var n=a,i=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===i?t.ref:(t=function(e){var t=n.refs;null===e?delete t[i]:t[i]=e},t._stringRef=i,t)}if("string"!==typeof e)throw Error(s(284));if(!r._owner)throw Error(s(290,e))}return e}function xs(e,t){throw e=Object.prototype.toString.call(t),Error(s(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function ys(e){return(0,e._init)(e._payload)}function vs(e){function t(t,r){if(e){var a=t.deletions;null===a?(t.deletions=[r],t.flags|=16):a.push(r)}}function r(r,a){if(!e)return null;for(;null!==a;)t(r,a),a=a.sibling;return null}function a(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function n(e,t){return(e=Pc(e,t)).index=0,e.sibling=null,e}function i(t,r,a){return t.index=a,e?null!==(a=t.alternate)?(a=a.index)<r?(t.flags|=2,r):a:(t.flags|=2,r):(t.flags|=1048576,r)}function o(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,r,a){return null===t||6!==t.tag?((t=Rc(r,e.mode,a)).return=e,t):((t=n(t,r)).return=e,t)}function c(e,t,r,a){var s=r.type;return s===N?u(e,t,r.props.children,a,r.key):null!==t&&(t.elementType===s||"object"===typeof s&&null!==s&&s.$$typeof===D&&ys(s)===t.type)?((a=n(t,r.props)).ref=ps(e,t,r),a.return=e,a):((a=Fc(r.type,r.key,r.props,null,e.mode,a)).ref=ps(e,t,r),a.return=e,a)}function d(e,t,r,a){return null===t||4!==t.tag||t.stateNode.containerInfo!==r.containerInfo||t.stateNode.implementation!==r.implementation?((t=Oc(r,e.mode,a)).return=e,t):((t=n(t,r.children||[])).return=e,t)}function u(e,t,r,a,s){return null===t||7!==t.tag?((t=Lc(r,e.mode,a,s)).return=e,t):((t=n(t,r)).return=e,t)}function h(e,t,r){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Rc(""+t,e.mode,r)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case w:return(r=Fc(t.type,t.key,t.props,null,e.mode,r)).ref=ps(e,null,t),r.return=e,r;case k:return(t=Oc(t,e.mode,r)).return=e,t;case D:return h(e,(0,t._init)(t._payload),r)}if(te(t)||L(t))return(t=Lc(t,e.mode,r,null)).return=e,t;xs(e,t)}return null}function m(e,t,r,a){var n=null!==t?t.key:null;if("string"===typeof r&&""!==r||"number"===typeof r)return null!==n?null:l(e,t,""+r,a);if("object"===typeof r&&null!==r){switch(r.$$typeof){case w:return r.key===n?c(e,t,r,a):null;case k:return r.key===n?d(e,t,r,a):null;case D:return m(e,t,(n=r._init)(r._payload),a)}if(te(r)||L(r))return null!==n?null:u(e,t,r,a,null);xs(e,r)}return null}function f(e,t,r,a,n){if("string"===typeof a&&""!==a||"number"===typeof a)return l(t,e=e.get(r)||null,""+a,n);if("object"===typeof a&&null!==a){switch(a.$$typeof){case w:return c(t,e=e.get(null===a.key?r:a.key)||null,a,n);case k:return d(t,e=e.get(null===a.key?r:a.key)||null,a,n);case D:return f(e,t,r,(0,a._init)(a._payload),n)}if(te(a)||L(a))return u(t,e=e.get(r)||null,a,n,null);xs(t,a)}return null}function g(n,s,o,l){for(var c=null,d=null,u=s,g=s=0,p=null;null!==u&&g<o.length;g++){u.index>g?(p=u,u=null):p=u.sibling;var x=m(n,u,o[g],l);if(null===x){null===u&&(u=p);break}e&&u&&null===x.alternate&&t(n,u),s=i(x,s,g),null===d?c=x:d.sibling=x,d=x,u=p}if(g===o.length)return r(n,u),ns&&Zn(n,g),c;if(null===u){for(;g<o.length;g++)null!==(u=h(n,o[g],l))&&(s=i(u,s,g),null===d?c=u:d.sibling=u,d=u);return ns&&Zn(n,g),c}for(u=a(n,u);g<o.length;g++)null!==(p=f(u,n,g,o[g],l))&&(e&&null!==p.alternate&&u.delete(null===p.key?g:p.key),s=i(p,s,g),null===d?c=p:d.sibling=p,d=p);return e&&u.forEach(function(e){return t(n,e)}),ns&&Zn(n,g),c}function p(n,o,l,c){var d=L(l);if("function"!==typeof d)throw Error(s(150));if(null==(l=d.call(l)))throw Error(s(151));for(var u=d=null,g=o,p=o=0,x=null,y=l.next();null!==g&&!y.done;p++,y=l.next()){g.index>p?(x=g,g=null):x=g.sibling;var v=m(n,g,y.value,c);if(null===v){null===g&&(g=x);break}e&&g&&null===v.alternate&&t(n,g),o=i(v,o,p),null===u?d=v:u.sibling=v,u=v,g=x}if(y.done)return r(n,g),ns&&Zn(n,p),d;if(null===g){for(;!y.done;p++,y=l.next())null!==(y=h(n,y.value,c))&&(o=i(y,o,p),null===u?d=y:u.sibling=y,u=y);return ns&&Zn(n,p),d}for(g=a(n,g);!y.done;p++,y=l.next())null!==(y=f(g,n,p,y.value,c))&&(e&&null!==y.alternate&&g.delete(null===y.key?p:y.key),o=i(y,o,p),null===u?d=y:u.sibling=y,u=y);return e&&g.forEach(function(e){return t(n,e)}),ns&&Zn(n,p),d}return function e(a,s,i,l){if("object"===typeof i&&null!==i&&i.type===N&&null===i.key&&(i=i.props.children),"object"===typeof i&&null!==i){switch(i.$$typeof){case w:e:{for(var c=i.key,d=s;null!==d;){if(d.key===c){if((c=i.type)===N){if(7===d.tag){r(a,d.sibling),(s=n(d,i.props.children)).return=a,a=s;break e}}else if(d.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===D&&ys(c)===d.type){r(a,d.sibling),(s=n(d,i.props)).ref=ps(a,d,i),s.return=a,a=s;break e}r(a,d);break}t(a,d),d=d.sibling}i.type===N?((s=Lc(i.props.children,a.mode,l,i.key)).return=a,a=s):((l=Fc(i.type,i.key,i.props,null,a.mode,l)).ref=ps(a,s,i),l.return=a,a=l)}return o(a);case k:e:{for(d=i.key;null!==s;){if(s.key===d){if(4===s.tag&&s.stateNode.containerInfo===i.containerInfo&&s.stateNode.implementation===i.implementation){r(a,s.sibling),(s=n(s,i.children||[])).return=a,a=s;break e}r(a,s);break}t(a,s),s=s.sibling}(s=Oc(i,a.mode,l)).return=a,a=s}return o(a);case D:return e(a,s,(d=i._init)(i._payload),l)}if(te(i))return g(a,s,i,l);if(L(i))return p(a,s,i,l);xs(a,i)}return"string"===typeof i&&""!==i||"number"===typeof i?(i=""+i,null!==s&&6===s.tag?(r(a,s.sibling),(s=n(s,i)).return=a,a=s):(r(a,s),(s=Rc(i,a.mode,l)).return=a,a=s),o(a)):r(a,s)}}var bs=vs(!0),ws=vs(!1),ks=jn(null),Ns=null,js=null,Ss=null;function _s(){Ss=js=Ns=null}function Es(e){var t=ks.current;Sn(ks),e._currentValue=t}function As(e,t,r){for(;null!==e;){var a=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==a&&(a.childLanes|=t)):null!==a&&(a.childLanes&t)!==t&&(a.childLanes|=t),e===r)break;e=e.return}}function Cs(e,t){Ns=e,Ss=js=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(vo=!0),e.firstContext=null)}function Is(e){var t=e._currentValue;if(Ss!==e)if(e={context:e,memoizedValue:t,next:null},null===js){if(null===Ns)throw Error(s(308));js=e,Ns.dependencies={lanes:0,firstContext:e}}else js=js.next=e;return t}var Ts=null;function Ds(e){null===Ts?Ts=[e]:Ts.push(e)}function Ps(e,t,r,a){var n=t.interleaved;return null===n?(r.next=r,Ds(t)):(r.next=n.next,n.next=r),t.interleaved=r,Fs(e,a)}function Fs(e,t){e.lanes|=t;var r=e.alternate;for(null!==r&&(r.lanes|=t),r=e,e=e.return;null!==e;)e.childLanes|=t,null!==(r=e.alternate)&&(r.childLanes|=t),r=e,e=e.return;return 3===r.tag?r.stateNode:null}var Ls=!1;function Ms(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Rs(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Os(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Bs(e,t,r){var a=e.updateQueue;if(null===a)return null;if(a=a.shared,0!==(2&Al)){var n=a.pending;return null===n?t.next=t:(t.next=n.next,n.next=t),a.pending=t,Fs(e,r)}return null===(n=a.interleaved)?(t.next=t,Ds(a)):(t.next=n.next,n.next=t),a.interleaved=t,Fs(e,r)}function zs(e,t,r){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&r))){var a=t.lanes;r|=a&=e.pendingLanes,t.lanes=r,yt(e,r)}}function Us(e,t){var r=e.updateQueue,a=e.alternate;if(null!==a&&r===(a=a.updateQueue)){var n=null,s=null;if(null!==(r=r.firstBaseUpdate)){do{var i={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};null===s?n=s=i:s=s.next=i,r=r.next}while(null!==r);null===s?n=s=t:s=s.next=t}else n=s=t;return r={baseState:a.baseState,firstBaseUpdate:n,lastBaseUpdate:s,shared:a.shared,effects:a.effects},void(e.updateQueue=r)}null===(e=r.lastBaseUpdate)?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function Vs(e,t,r,a){var n=e.updateQueue;Ls=!1;var s=n.firstBaseUpdate,i=n.lastBaseUpdate,o=n.shared.pending;if(null!==o){n.shared.pending=null;var l=o,c=l.next;l.next=null,null===i?s=c:i.next=c,i=l;var d=e.alternate;null!==d&&((o=(d=d.updateQueue).lastBaseUpdate)!==i&&(null===o?d.firstBaseUpdate=c:o.next=c,d.lastBaseUpdate=l))}if(null!==s){var u=n.baseState;for(i=0,d=c=l=null,o=s;;){var h=o.lane,m=o.eventTime;if((a&h)===h){null!==d&&(d=d.next={eventTime:m,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var f=e,g=o;switch(h=t,m=r,g.tag){case 1:if("function"===typeof(f=g.payload)){u=f.call(m,u,h);break e}u=f;break e;case 3:f.flags=-65537&f.flags|128;case 0:if(null===(h="function"===typeof(f=g.payload)?f.call(m,u,h):f)||void 0===h)break e;u=R({},u,h);break e;case 2:Ls=!0}}null!==o.callback&&0!==o.lane&&(e.flags|=64,null===(h=n.effects)?n.effects=[o]:h.push(o))}else m={eventTime:m,lane:h,tag:o.tag,payload:o.payload,callback:o.callback,next:null},null===d?(c=d=m,l=u):d=d.next=m,i|=h;if(null===(o=o.next)){if(null===(o=n.shared.pending))break;o=(h=o).next,h.next=null,n.lastBaseUpdate=h,n.shared.pending=null}}if(null===d&&(l=u),n.baseState=l,n.firstBaseUpdate=c,n.lastBaseUpdate=d,null!==(t=n.shared.interleaved)){n=t;do{i|=n.lane,n=n.next}while(n!==t)}else null===s&&(n.shared.lanes=0);Ml|=i,e.lanes=i,e.memoizedState=u}}function qs(e,t,r){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var a=e[t],n=a.callback;if(null!==n){if(a.callback=null,a=r,"function"!==typeof n)throw Error(s(191,n));n.call(a)}}}var Hs={},Gs=jn(Hs),Ws=jn(Hs),Ks=jn(Hs);function Qs(e){if(e===Hs)throw Error(s(174));return e}function Ys(e,t){switch(_n(Ks,t),_n(Ws,e),_n(Gs,Hs),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Sn(Gs),_n(Gs,t)}function Xs(){Sn(Gs),Sn(Ws),Sn(Ks)}function Js(e){Qs(Ks.current);var t=Qs(Gs.current),r=le(t,e.type);t!==r&&(_n(Ws,e),_n(Gs,r))}function Zs(e){Ws.current===e&&(Sn(Gs),Sn(Ws))}var $s=jn(0);function ei(e){for(var t=e;null!==t;){if(13===t.tag){var r=t.memoizedState;if(null!==r&&(null===(r=r.dehydrated)||"$?"===r.data||"$!"===r.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var ti=[];function ri(){for(var e=0;e<ti.length;e++)ti[e]._workInProgressVersionPrimary=null;ti.length=0}var ai=b.ReactCurrentDispatcher,ni=b.ReactCurrentBatchConfig,si=0,ii=null,oi=null,li=null,ci=!1,di=!1,ui=0,hi=0;function mi(){throw Error(s(321))}function fi(e,t){if(null===t)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!ia(e[r],t[r]))return!1;return!0}function gi(e,t,r,a,n,i){if(si=i,ii=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ai.current=null===e||null===e.memoizedState?Zi:$i,e=r(a,n),di){i=0;do{if(di=!1,ui=0,25<=i)throw Error(s(301));i+=1,li=oi=null,t.updateQueue=null,ai.current=eo,e=r(a,n)}while(di)}if(ai.current=Ji,t=null!==oi&&null!==oi.next,si=0,li=oi=ii=null,ci=!1,t)throw Error(s(300));return e}function pi(){var e=0!==ui;return ui=0,e}function xi(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===li?ii.memoizedState=li=e:li=li.next=e,li}function yi(){if(null===oi){var e=ii.alternate;e=null!==e?e.memoizedState:null}else e=oi.next;var t=null===li?ii.memoizedState:li.next;if(null!==t)li=t,oi=e;else{if(null===e)throw Error(s(310));e={memoizedState:(oi=e).memoizedState,baseState:oi.baseState,baseQueue:oi.baseQueue,queue:oi.queue,next:null},null===li?ii.memoizedState=li=e:li=li.next=e}return li}function vi(e,t){return"function"===typeof t?t(e):t}function bi(e){var t=yi(),r=t.queue;if(null===r)throw Error(s(311));r.lastRenderedReducer=e;var a=oi,n=a.baseQueue,i=r.pending;if(null!==i){if(null!==n){var o=n.next;n.next=i.next,i.next=o}a.baseQueue=n=i,r.pending=null}if(null!==n){i=n.next,a=a.baseState;var l=o=null,c=null,d=i;do{var u=d.lane;if((si&u)===u)null!==c&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),a=d.hasEagerState?d.eagerState:e(a,d.action);else{var h={lane:u,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};null===c?(l=c=h,o=a):c=c.next=h,ii.lanes|=u,Ml|=u}d=d.next}while(null!==d&&d!==i);null===c?o=a:c.next=l,ia(a,t.memoizedState)||(vo=!0),t.memoizedState=a,t.baseState=o,t.baseQueue=c,r.lastRenderedState=a}if(null!==(e=r.interleaved)){n=e;do{i=n.lane,ii.lanes|=i,Ml|=i,n=n.next}while(n!==e)}else null===n&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function wi(e){var t=yi(),r=t.queue;if(null===r)throw Error(s(311));r.lastRenderedReducer=e;var a=r.dispatch,n=r.pending,i=t.memoizedState;if(null!==n){r.pending=null;var o=n=n.next;do{i=e(i,o.action),o=o.next}while(o!==n);ia(i,t.memoizedState)||(vo=!0),t.memoizedState=i,null===t.baseQueue&&(t.baseState=i),r.lastRenderedState=i}return[i,a]}function ki(){}function Ni(e,t){var r=ii,a=yi(),n=t(),i=!ia(a.memoizedState,n);if(i&&(a.memoizedState=n,vo=!0),a=a.queue,Li(_i.bind(null,r,a,e),[e]),a.getSnapshot!==t||i||null!==li&&1&li.memoizedState.tag){if(r.flags|=2048,Ii(9,Si.bind(null,r,a,n,t),void 0,null),null===Cl)throw Error(s(349));0!==(30&si)||ji(r,t,n)}return n}function ji(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},null===(t=ii.updateQueue)?(t={lastEffect:null,stores:null},ii.updateQueue=t,t.stores=[e]):null===(r=t.stores)?t.stores=[e]:r.push(e)}function Si(e,t,r,a){t.value=r,t.getSnapshot=a,Ei(t)&&Ai(e)}function _i(e,t,r){return r(function(){Ei(t)&&Ai(e)})}function Ei(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!ia(e,r)}catch(a){return!0}}function Ai(e){var t=Fs(e,1);null!==t&&rc(t,e,1,-1)}function Ci(e){var t=xi();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:vi,lastRenderedState:e},t.queue=e,e=e.dispatch=Ki.bind(null,ii,e),[t.memoizedState,e]}function Ii(e,t,r,a){return e={tag:e,create:t,destroy:r,deps:a,next:null},null===(t=ii.updateQueue)?(t={lastEffect:null,stores:null},ii.updateQueue=t,t.lastEffect=e.next=e):null===(r=t.lastEffect)?t.lastEffect=e.next=e:(a=r.next,r.next=e,e.next=a,t.lastEffect=e),e}function Ti(){return yi().memoizedState}function Di(e,t,r,a){var n=xi();ii.flags|=e,n.memoizedState=Ii(1|t,r,void 0,void 0===a?null:a)}function Pi(e,t,r,a){var n=yi();a=void 0===a?null:a;var s=void 0;if(null!==oi){var i=oi.memoizedState;if(s=i.destroy,null!==a&&fi(a,i.deps))return void(n.memoizedState=Ii(t,r,s,a))}ii.flags|=e,n.memoizedState=Ii(1|t,r,s,a)}function Fi(e,t){return Di(8390656,8,e,t)}function Li(e,t){return Pi(2048,8,e,t)}function Mi(e,t){return Pi(4,2,e,t)}function Ri(e,t){return Pi(4,4,e,t)}function Oi(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Bi(e,t,r){return r=null!==r&&void 0!==r?r.concat([e]):null,Pi(4,4,Oi.bind(null,t,e),r)}function zi(){}function Ui(e,t){var r=yi();t=void 0===t?null:t;var a=r.memoizedState;return null!==a&&null!==t&&fi(t,a[1])?a[0]:(r.memoizedState=[e,t],e)}function Vi(e,t){var r=yi();t=void 0===t?null:t;var a=r.memoizedState;return null!==a&&null!==t&&fi(t,a[1])?a[0]:(e=e(),r.memoizedState=[e,t],e)}function qi(e,t,r){return 0===(21&si)?(e.baseState&&(e.baseState=!1,vo=!0),e.memoizedState=r):(ia(r,t)||(r=gt(),ii.lanes|=r,Ml|=r,e.baseState=!0),t)}function Hi(e,t){var r=vt;vt=0!==r&&4>r?r:4,e(!0);var a=ni.transition;ni.transition={};try{e(!1),t()}finally{vt=r,ni.transition=a}}function Gi(){return yi().memoizedState}function Wi(e,t,r){var a=tc(e);if(r={lane:a,action:r,hasEagerState:!1,eagerState:null,next:null},Qi(e))Yi(t,r);else if(null!==(r=Ps(e,t,r,a))){rc(r,e,a,ec()),Xi(r,t,a)}}function Ki(e,t,r){var a=tc(e),n={lane:a,action:r,hasEagerState:!1,eagerState:null,next:null};if(Qi(e))Yi(t,n);else{var s=e.alternate;if(0===e.lanes&&(null===s||0===s.lanes)&&null!==(s=t.lastRenderedReducer))try{var i=t.lastRenderedState,o=s(i,r);if(n.hasEagerState=!0,n.eagerState=o,ia(o,i)){var l=t.interleaved;return null===l?(n.next=n,Ds(t)):(n.next=l.next,l.next=n),void(t.interleaved=n)}}catch(c){}null!==(r=Ps(e,t,n,a))&&(rc(r,e,a,n=ec()),Xi(r,t,a))}}function Qi(e){var t=e.alternate;return e===ii||null!==t&&t===ii}function Yi(e,t){di=ci=!0;var r=e.pending;null===r?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function Xi(e,t,r){if(0!==(4194240&r)){var a=t.lanes;r|=a&=e.pendingLanes,t.lanes=r,yt(e,r)}}var Ji={readContext:Is,useCallback:mi,useContext:mi,useEffect:mi,useImperativeHandle:mi,useInsertionEffect:mi,useLayoutEffect:mi,useMemo:mi,useReducer:mi,useRef:mi,useState:mi,useDebugValue:mi,useDeferredValue:mi,useTransition:mi,useMutableSource:mi,useSyncExternalStore:mi,useId:mi,unstable_isNewReconciler:!1},Zi={readContext:Is,useCallback:function(e,t){return xi().memoizedState=[e,void 0===t?null:t],e},useContext:Is,useEffect:Fi,useImperativeHandle:function(e,t,r){return r=null!==r&&void 0!==r?r.concat([e]):null,Di(4194308,4,Oi.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Di(4194308,4,e,t)},useInsertionEffect:function(e,t){return Di(4,2,e,t)},useMemo:function(e,t){var r=xi();return t=void 0===t?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var a=xi();return t=void 0!==r?r(t):t,a.memoizedState=a.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},a.queue=e,e=e.dispatch=Wi.bind(null,ii,e),[a.memoizedState,e]},useRef:function(e){return e={current:e},xi().memoizedState=e},useState:Ci,useDebugValue:zi,useDeferredValue:function(e){return xi().memoizedState=e},useTransition:function(){var e=Ci(!1),t=e[0];return e=Hi.bind(null,e[1]),xi().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var a=ii,n=xi();if(ns){if(void 0===r)throw Error(s(407));r=r()}else{if(r=t(),null===Cl)throw Error(s(349));0!==(30&si)||ji(a,t,r)}n.memoizedState=r;var i={value:r,getSnapshot:t};return n.queue=i,Fi(_i.bind(null,a,i,e),[e]),a.flags|=2048,Ii(9,Si.bind(null,a,i,r,t),void 0,null),r},useId:function(){var e=xi(),t=Cl.identifierPrefix;if(ns){var r=Jn;t=":"+t+"R"+(r=(Xn&~(1<<32-it(Xn)-1)).toString(32)+r),0<(r=ui++)&&(t+="H"+r.toString(32)),t+=":"}else t=":"+t+"r"+(r=hi++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},$i={readContext:Is,useCallback:Ui,useContext:Is,useEffect:Li,useImperativeHandle:Bi,useInsertionEffect:Mi,useLayoutEffect:Ri,useMemo:Vi,useReducer:bi,useRef:Ti,useState:function(){return bi(vi)},useDebugValue:zi,useDeferredValue:function(e){return qi(yi(),oi.memoizedState,e)},useTransition:function(){return[bi(vi)[0],yi().memoizedState]},useMutableSource:ki,useSyncExternalStore:Ni,useId:Gi,unstable_isNewReconciler:!1},eo={readContext:Is,useCallback:Ui,useContext:Is,useEffect:Li,useImperativeHandle:Bi,useInsertionEffect:Mi,useLayoutEffect:Ri,useMemo:Vi,useReducer:wi,useRef:Ti,useState:function(){return wi(vi)},useDebugValue:zi,useDeferredValue:function(e){var t=yi();return null===oi?t.memoizedState=e:qi(t,oi.memoizedState,e)},useTransition:function(){return[wi(vi)[0],yi().memoizedState]},useMutableSource:ki,useSyncExternalStore:Ni,useId:Gi,unstable_isNewReconciler:!1};function to(e,t){if(e&&e.defaultProps){for(var r in t=R({},t),e=e.defaultProps)void 0===t[r]&&(t[r]=e[r]);return t}return t}function ro(e,t,r,a){r=null===(r=r(a,t=e.memoizedState))||void 0===r?t:R({},t,r),e.memoizedState=r,0===e.lanes&&(e.updateQueue.baseState=r)}var ao={isMounted:function(e){return!!(e=e._reactInternals)&&Ve(e)===e},enqueueSetState:function(e,t,r){e=e._reactInternals;var a=ec(),n=tc(e),s=Os(a,n);s.payload=t,void 0!==r&&null!==r&&(s.callback=r),null!==(t=Bs(e,s,n))&&(rc(t,e,n,a),zs(t,e,n))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var a=ec(),n=tc(e),s=Os(a,n);s.tag=1,s.payload=t,void 0!==r&&null!==r&&(s.callback=r),null!==(t=Bs(e,s,n))&&(rc(t,e,n,a),zs(t,e,n))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=ec(),a=tc(e),n=Os(r,a);n.tag=2,void 0!==t&&null!==t&&(n.callback=t),null!==(t=Bs(e,n,a))&&(rc(t,e,a,r),zs(t,e,a))}};function no(e,t,r,a,n,s,i){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(a,s,i):!t.prototype||!t.prototype.isPureReactComponent||(!oa(r,a)||!oa(n,s))}function so(e,t,r){var a=!1,n=En,s=t.contextType;return"object"===typeof s&&null!==s?s=Is(s):(n=Dn(t)?In:An.current,s=(a=null!==(a=t.contextTypes)&&void 0!==a)?Tn(e,n):En),t=new t(r,s),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=ao,e.stateNode=t,t._reactInternals=e,a&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=n,e.__reactInternalMemoizedMaskedChildContext=s),t}function io(e,t,r,a){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(r,a),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(r,a),t.state!==e&&ao.enqueueReplaceState(t,t.state,null)}function oo(e,t,r,a){var n=e.stateNode;n.props=r,n.state=e.memoizedState,n.refs={},Ms(e);var s=t.contextType;"object"===typeof s&&null!==s?n.context=Is(s):(s=Dn(t)?In:An.current,n.context=Tn(e,s)),n.state=e.memoizedState,"function"===typeof(s=t.getDerivedStateFromProps)&&(ro(e,t,s,r),n.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof n.getSnapshotBeforeUpdate||"function"!==typeof n.UNSAFE_componentWillMount&&"function"!==typeof n.componentWillMount||(t=n.state,"function"===typeof n.componentWillMount&&n.componentWillMount(),"function"===typeof n.UNSAFE_componentWillMount&&n.UNSAFE_componentWillMount(),t!==n.state&&ao.enqueueReplaceState(n,n.state,null),Vs(e,r,n,a),n.state=e.memoizedState),"function"===typeof n.componentDidMount&&(e.flags|=4194308)}function lo(e,t){try{var r="",a=t;do{r+=U(a),a=a.return}while(a);var n=r}catch(s){n="\nError generating stack: "+s.message+"\n"+s.stack}return{value:e,source:t,stack:n,digest:null}}function co(e,t,r){return{value:e,source:null,stack:null!=r?r:null,digest:null!=t?t:null}}function uo(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var ho="function"===typeof WeakMap?WeakMap:Map;function mo(e,t,r){(r=Os(-1,r)).tag=3,r.payload={element:null};var a=t.value;return r.callback=function(){Hl||(Hl=!0,Gl=a),uo(0,t)},r}function fo(e,t,r){(r=Os(-1,r)).tag=3;var a=e.type.getDerivedStateFromError;if("function"===typeof a){var n=t.value;r.payload=function(){return a(n)},r.callback=function(){uo(0,t)}}var s=e.stateNode;return null!==s&&"function"===typeof s.componentDidCatch&&(r.callback=function(){uo(0,t),"function"!==typeof a&&(null===Wl?Wl=new Set([this]):Wl.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),r}function go(e,t,r){var a=e.pingCache;if(null===a){a=e.pingCache=new ho;var n=new Set;a.set(t,n)}else void 0===(n=a.get(t))&&(n=new Set,a.set(t,n));n.has(r)||(n.add(r),e=Sc.bind(null,e,t,r),t.then(e,e))}function po(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function xo(e,t,r,a,n){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,1===r.tag&&(null===r.alternate?r.tag=17:((t=Os(-1,1)).tag=2,Bs(r,t,1))),r.lanes|=1),e):(e.flags|=65536,e.lanes=n,e)}var yo=b.ReactCurrentOwner,vo=!1;function bo(e,t,r,a){t.child=null===e?ws(t,null,r,a):bs(t,e.child,r,a)}function wo(e,t,r,a,n){r=r.render;var s=t.ref;return Cs(t,n),a=gi(e,t,r,a,s,n),r=pi(),null===e||vo?(ns&&r&&es(t),t.flags|=1,bo(e,t,a,n),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n,Ho(e,t,n))}function ko(e,t,r,a,n){if(null===e){var s=r.type;return"function"!==typeof s||Dc(s)||void 0!==s.defaultProps||null!==r.compare||void 0!==r.defaultProps?((e=Fc(r.type,null,a,t,t.mode,n)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=s,No(e,t,s,a,n))}if(s=e.child,0===(e.lanes&n)){var i=s.memoizedProps;if((r=null!==(r=r.compare)?r:oa)(i,a)&&e.ref===t.ref)return Ho(e,t,n)}return t.flags|=1,(e=Pc(s,a)).ref=t.ref,e.return=t,t.child=e}function No(e,t,r,a,n){if(null!==e){var s=e.memoizedProps;if(oa(s,a)&&e.ref===t.ref){if(vo=!1,t.pendingProps=a=s,0===(e.lanes&n))return t.lanes=e.lanes,Ho(e,t,n);0!==(131072&e.flags)&&(vo=!0)}}return _o(e,t,r,a,n)}function jo(e,t,r){var a=t.pendingProps,n=a.children,s=null!==e?e.memoizedState:null;if("hidden"===a.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},_n(Pl,Dl),Dl|=r;else{if(0===(1073741824&r))return e=null!==s?s.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,_n(Pl,Dl),Dl|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},a=null!==s?s.baseLanes:r,_n(Pl,Dl),Dl|=a}else null!==s?(a=s.baseLanes|r,t.memoizedState=null):a=r,_n(Pl,Dl),Dl|=a;return bo(e,t,n,r),t.child}function So(e,t){var r=t.ref;(null===e&&null!==r||null!==e&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function _o(e,t,r,a,n){var s=Dn(r)?In:An.current;return s=Tn(t,s),Cs(t,n),r=gi(e,t,r,a,s,n),a=pi(),null===e||vo?(ns&&a&&es(t),t.flags|=1,bo(e,t,r,n),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n,Ho(e,t,n))}function Eo(e,t,r,a,n){if(Dn(r)){var s=!0;Mn(t)}else s=!1;if(Cs(t,n),null===t.stateNode)qo(e,t),so(t,r,a),oo(t,r,a,n),a=!0;else if(null===e){var i=t.stateNode,o=t.memoizedProps;i.props=o;var l=i.context,c=r.contextType;"object"===typeof c&&null!==c?c=Is(c):c=Tn(t,c=Dn(r)?In:An.current);var d=r.getDerivedStateFromProps,u="function"===typeof d||"function"===typeof i.getSnapshotBeforeUpdate;u||"function"!==typeof i.UNSAFE_componentWillReceiveProps&&"function"!==typeof i.componentWillReceiveProps||(o!==a||l!==c)&&io(t,i,a,c),Ls=!1;var h=t.memoizedState;i.state=h,Vs(t,a,i,n),l=t.memoizedState,o!==a||h!==l||Cn.current||Ls?("function"===typeof d&&(ro(t,r,d,a),l=t.memoizedState),(o=Ls||no(t,r,o,a,h,l,c))?(u||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||("function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount()),"function"===typeof i.componentDidMount&&(t.flags|=4194308)):("function"===typeof i.componentDidMount&&(t.flags|=4194308),t.memoizedProps=a,t.memoizedState=l),i.props=a,i.state=l,i.context=c,a=o):("function"===typeof i.componentDidMount&&(t.flags|=4194308),a=!1)}else{i=t.stateNode,Rs(e,t),o=t.memoizedProps,c=t.type===t.elementType?o:to(t.type,o),i.props=c,u=t.pendingProps,h=i.context,"object"===typeof(l=r.contextType)&&null!==l?l=Is(l):l=Tn(t,l=Dn(r)?In:An.current);var m=r.getDerivedStateFromProps;(d="function"===typeof m||"function"===typeof i.getSnapshotBeforeUpdate)||"function"!==typeof i.UNSAFE_componentWillReceiveProps&&"function"!==typeof i.componentWillReceiveProps||(o!==u||h!==l)&&io(t,i,a,l),Ls=!1,h=t.memoizedState,i.state=h,Vs(t,a,i,n);var f=t.memoizedState;o!==u||h!==f||Cn.current||Ls?("function"===typeof m&&(ro(t,r,m,a),f=t.memoizedState),(c=Ls||no(t,r,c,a,h,f,l)||!1)?(d||"function"!==typeof i.UNSAFE_componentWillUpdate&&"function"!==typeof i.componentWillUpdate||("function"===typeof i.componentWillUpdate&&i.componentWillUpdate(a,f,l),"function"===typeof i.UNSAFE_componentWillUpdate&&i.UNSAFE_componentWillUpdate(a,f,l)),"function"===typeof i.componentDidUpdate&&(t.flags|=4),"function"===typeof i.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof i.componentDidUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof i.getSnapshotBeforeUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=a,t.memoizedState=f),i.props=a,i.state=f,i.context=l,a=c):("function"!==typeof i.componentDidUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof i.getSnapshotBeforeUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),a=!1)}return Ao(e,t,r,a,s,n)}function Ao(e,t,r,a,n,s){So(e,t);var i=0!==(128&t.flags);if(!a&&!i)return n&&Rn(t,r,!1),Ho(e,t,s);a=t.stateNode,yo.current=t;var o=i&&"function"!==typeof r.getDerivedStateFromError?null:a.render();return t.flags|=1,null!==e&&i?(t.child=bs(t,e.child,null,s),t.child=bs(t,null,o,s)):bo(e,t,o,s),t.memoizedState=a.state,n&&Rn(t,r,!0),t.child}function Co(e){var t=e.stateNode;t.pendingContext?Fn(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Fn(0,t.context,!1),Ys(e,t.containerInfo)}function Io(e,t,r,a,n){return ms(),fs(n),t.flags|=256,bo(e,t,r,a),t.child}var To,Do,Po,Fo,Lo={dehydrated:null,treeContext:null,retryLane:0};function Mo(e){return{baseLanes:e,cachePool:null,transitions:null}}function Ro(e,t,r){var a,n=t.pendingProps,i=$s.current,o=!1,l=0!==(128&t.flags);if((a=l)||(a=(null===e||null!==e.memoizedState)&&0!==(2&i)),a?(o=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(i|=1),_n($s,1&i),null===e)return cs(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(l=n.children,e=n.fallback,o?(n=t.mode,o=t.child,l={mode:"hidden",children:l},0===(1&n)&&null!==o?(o.childLanes=0,o.pendingProps=l):o=Mc(l,n,0,null),e=Lc(e,n,r,null),o.return=t,e.return=t,o.sibling=e,t.child=o,t.child.memoizedState=Mo(r),t.memoizedState=Lo,e):Oo(t,l));if(null!==(i=e.memoizedState)&&null!==(a=i.dehydrated))return function(e,t,r,a,n,i,o){if(r)return 256&t.flags?(t.flags&=-257,Bo(e,t,o,a=co(Error(s(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(i=a.fallback,n=t.mode,a=Mc({mode:"visible",children:a.children},n,0,null),(i=Lc(i,n,o,null)).flags|=2,a.return=t,i.return=t,a.sibling=i,t.child=a,0!==(1&t.mode)&&bs(t,e.child,null,o),t.child.memoizedState=Mo(o),t.memoizedState=Lo,i);if(0===(1&t.mode))return Bo(e,t,o,null);if("$!"===n.data){if(a=n.nextSibling&&n.nextSibling.dataset)var l=a.dgst;return a=l,Bo(e,t,o,a=co(i=Error(s(419)),a,void 0))}if(l=0!==(o&e.childLanes),vo||l){if(null!==(a=Cl)){switch(o&-o){case 4:n=2;break;case 16:n=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:n=32;break;case 536870912:n=268435456;break;default:n=0}0!==(n=0!==(n&(a.suspendedLanes|o))?0:n)&&n!==i.retryLane&&(i.retryLane=n,Fs(e,n),rc(a,e,n,-1))}return gc(),Bo(e,t,o,a=co(Error(s(421))))}return"$?"===n.data?(t.flags|=128,t.child=e.child,t=Ec.bind(null,e),n._reactRetry=t,null):(e=i.treeContext,as=cn(n.nextSibling),rs=t,ns=!0,ss=null,null!==e&&(Kn[Qn++]=Xn,Kn[Qn++]=Jn,Kn[Qn++]=Yn,Xn=e.id,Jn=e.overflow,Yn=t),t=Oo(t,a.children),t.flags|=4096,t)}(e,t,l,n,a,i,r);if(o){o=n.fallback,l=t.mode,a=(i=e.child).sibling;var c={mode:"hidden",children:n.children};return 0===(1&l)&&t.child!==i?((n=t.child).childLanes=0,n.pendingProps=c,t.deletions=null):(n=Pc(i,c)).subtreeFlags=14680064&i.subtreeFlags,null!==a?o=Pc(a,o):(o=Lc(o,l,r,null)).flags|=2,o.return=t,n.return=t,n.sibling=o,t.child=n,n=o,o=t.child,l=null===(l=e.child.memoizedState)?Mo(r):{baseLanes:l.baseLanes|r,cachePool:null,transitions:l.transitions},o.memoizedState=l,o.childLanes=e.childLanes&~r,t.memoizedState=Lo,n}return e=(o=e.child).sibling,n=Pc(o,{mode:"visible",children:n.children}),0===(1&t.mode)&&(n.lanes=r),n.return=t,n.sibling=null,null!==e&&(null===(r=t.deletions)?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function Oo(e,t){return(t=Mc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Bo(e,t,r,a){return null!==a&&fs(a),bs(t,e.child,null,r),(e=Oo(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function zo(e,t,r){e.lanes|=t;var a=e.alternate;null!==a&&(a.lanes|=t),As(e.return,t,r)}function Uo(e,t,r,a,n){var s=e.memoizedState;null===s?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:a,tail:r,tailMode:n}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=a,s.tail=r,s.tailMode=n)}function Vo(e,t,r){var a=t.pendingProps,n=a.revealOrder,s=a.tail;if(bo(e,t,a.children,r),0!==(2&(a=$s.current)))a=1&a|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&zo(e,r,t);else if(19===e.tag)zo(e,r,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}a&=1}if(_n($s,a),0===(1&t.mode))t.memoizedState=null;else switch(n){case"forwards":for(r=t.child,n=null;null!==r;)null!==(e=r.alternate)&&null===ei(e)&&(n=r),r=r.sibling;null===(r=n)?(n=t.child,t.child=null):(n=r.sibling,r.sibling=null),Uo(t,!1,n,r,s);break;case"backwards":for(r=null,n=t.child,t.child=null;null!==n;){if(null!==(e=n.alternate)&&null===ei(e)){t.child=n;break}e=n.sibling,n.sibling=r,r=n,n=e}Uo(t,!0,r,null,s);break;case"together":Uo(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function qo(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Ho(e,t,r){if(null!==e&&(t.dependencies=e.dependencies),Ml|=t.lanes,0===(r&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(s(153));if(null!==t.child){for(r=Pc(e=t.child,e.pendingProps),t.child=r,r.return=t;null!==e.sibling;)e=e.sibling,(r=r.sibling=Pc(e,e.pendingProps)).return=t;r.sibling=null}return t.child}function Go(e,t){if(!ns)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;null!==t;)null!==t.alternate&&(r=t),t=t.sibling;null===r?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var a=null;null!==r;)null!==r.alternate&&(a=r),r=r.sibling;null===a?t||null===e.tail?e.tail=null:e.tail.sibling=null:a.sibling=null}}function Wo(e){var t=null!==e.alternate&&e.alternate.child===e.child,r=0,a=0;if(t)for(var n=e.child;null!==n;)r|=n.lanes|n.childLanes,a|=14680064&n.subtreeFlags,a|=14680064&n.flags,n.return=e,n=n.sibling;else for(n=e.child;null!==n;)r|=n.lanes|n.childLanes,a|=n.subtreeFlags,a|=n.flags,n.return=e,n=n.sibling;return e.subtreeFlags|=a,e.childLanes=r,t}function Ko(e,t,r){var a=t.pendingProps;switch(ts(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Wo(t),null;case 1:case 17:return Dn(t.type)&&Pn(),Wo(t),null;case 3:return a=t.stateNode,Xs(),Sn(Cn),Sn(An),ri(),a.pendingContext&&(a.context=a.pendingContext,a.pendingContext=null),null!==e&&null!==e.child||(us(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==ss&&(ic(ss),ss=null))),Do(e,t),Wo(t),null;case 5:Zs(t);var n=Qs(Ks.current);if(r=t.type,null!==e&&null!=t.stateNode)Po(e,t,r,a,n),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!a){if(null===t.stateNode)throw Error(s(166));return Wo(t),null}if(e=Qs(Gs.current),us(t)){a=t.stateNode,r=t.type;var i=t.memoizedProps;switch(a[hn]=t,a[mn]=i,e=0!==(1&t.mode),r){case"dialog":Oa("cancel",a),Oa("close",a);break;case"iframe":case"object":case"embed":Oa("load",a);break;case"video":case"audio":for(n=0;n<Fa.length;n++)Oa(Fa[n],a);break;case"source":Oa("error",a);break;case"img":case"image":case"link":Oa("error",a),Oa("load",a);break;case"details":Oa("toggle",a);break;case"input":X(a,i),Oa("invalid",a);break;case"select":a._wrapperState={wasMultiple:!!i.multiple},Oa("invalid",a);break;case"textarea":ne(a,i),Oa("invalid",a)}for(var l in ye(r,i),n=null,i)if(i.hasOwnProperty(l)){var c=i[l];"children"===l?"string"===typeof c?a.textContent!==c&&(!0!==i.suppressHydrationWarning&&Ja(a.textContent,c,e),n=["children",c]):"number"===typeof c&&a.textContent!==""+c&&(!0!==i.suppressHydrationWarning&&Ja(a.textContent,c,e),n=["children",""+c]):o.hasOwnProperty(l)&&null!=c&&"onScroll"===l&&Oa("scroll",a)}switch(r){case"input":W(a),$(a,i,!0);break;case"textarea":W(a),ie(a);break;case"select":case"option":break;default:"function"===typeof i.onClick&&(a.onclick=Za)}a=n,t.updateQueue=a,null!==a&&(t.flags|=4)}else{l=9===n.nodeType?n:n.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=oe(r)),"http://www.w3.org/1999/xhtml"===e?"script"===r?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof a.is?e=l.createElement(r,{is:a.is}):(e=l.createElement(r),"select"===r&&(l=e,a.multiple?l.multiple=!0:a.size&&(l.size=a.size))):e=l.createElementNS(e,r),e[hn]=t,e[mn]=a,To(e,t,!1,!1),t.stateNode=e;e:{switch(l=ve(r,a),r){case"dialog":Oa("cancel",e),Oa("close",e),n=a;break;case"iframe":case"object":case"embed":Oa("load",e),n=a;break;case"video":case"audio":for(n=0;n<Fa.length;n++)Oa(Fa[n],e);n=a;break;case"source":Oa("error",e),n=a;break;case"img":case"image":case"link":Oa("error",e),Oa("load",e),n=a;break;case"details":Oa("toggle",e),n=a;break;case"input":X(e,a),n=Y(e,a),Oa("invalid",e);break;case"option":default:n=a;break;case"select":e._wrapperState={wasMultiple:!!a.multiple},n=R({},a,{value:void 0}),Oa("invalid",e);break;case"textarea":ne(e,a),n=ae(e,a),Oa("invalid",e)}for(i in ye(r,n),c=n)if(c.hasOwnProperty(i)){var d=c[i];"style"===i?pe(e,d):"dangerouslySetInnerHTML"===i?null!=(d=d?d.__html:void 0)&&ue(e,d):"children"===i?"string"===typeof d?("textarea"!==r||""!==d)&&he(e,d):"number"===typeof d&&he(e,""+d):"suppressContentEditableWarning"!==i&&"suppressHydrationWarning"!==i&&"autoFocus"!==i&&(o.hasOwnProperty(i)?null!=d&&"onScroll"===i&&Oa("scroll",e):null!=d&&v(e,i,d,l))}switch(r){case"input":W(e),$(e,a,!1);break;case"textarea":W(e),ie(e);break;case"option":null!=a.value&&e.setAttribute("value",""+H(a.value));break;case"select":e.multiple=!!a.multiple,null!=(i=a.value)?re(e,!!a.multiple,i,!1):null!=a.defaultValue&&re(e,!!a.multiple,a.defaultValue,!0);break;default:"function"===typeof n.onClick&&(e.onclick=Za)}switch(r){case"button":case"input":case"select":case"textarea":a=!!a.autoFocus;break e;case"img":a=!0;break e;default:a=!1}}a&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Wo(t),null;case 6:if(e&&null!=t.stateNode)Fo(e,t,e.memoizedProps,a);else{if("string"!==typeof a&&null===t.stateNode)throw Error(s(166));if(r=Qs(Ks.current),Qs(Gs.current),us(t)){if(a=t.stateNode,r=t.memoizedProps,a[hn]=t,(i=a.nodeValue!==r)&&null!==(e=rs))switch(e.tag){case 3:Ja(a.nodeValue,r,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Ja(a.nodeValue,r,0!==(1&e.mode))}i&&(t.flags|=4)}else(a=(9===r.nodeType?r:r.ownerDocument).createTextNode(a))[hn]=t,t.stateNode=a}return Wo(t),null;case 13:if(Sn($s),a=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(ns&&null!==as&&0!==(1&t.mode)&&0===(128&t.flags))hs(),ms(),t.flags|=98560,i=!1;else if(i=us(t),null!==a&&null!==a.dehydrated){if(null===e){if(!i)throw Error(s(318));if(!(i=null!==(i=t.memoizedState)?i.dehydrated:null))throw Error(s(317));i[hn]=t}else ms(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Wo(t),i=!1}else null!==ss&&(ic(ss),ss=null),i=!0;if(!i)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=r,t):((a=null!==a)!==(null!==e&&null!==e.memoizedState)&&a&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&$s.current)?0===Fl&&(Fl=3):gc())),null!==t.updateQueue&&(t.flags|=4),Wo(t),null);case 4:return Xs(),Do(e,t),null===e&&Ua(t.stateNode.containerInfo),Wo(t),null;case 10:return Es(t.type._context),Wo(t),null;case 19:if(Sn($s),null===(i=t.memoizedState))return Wo(t),null;if(a=0!==(128&t.flags),null===(l=i.rendering))if(a)Go(i,!1);else{if(0!==Fl||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(l=ei(e))){for(t.flags|=128,Go(i,!1),null!==(a=l.updateQueue)&&(t.updateQueue=a,t.flags|=4),t.subtreeFlags=0,a=r,r=t.child;null!==r;)e=a,(i=r).flags&=14680066,null===(l=i.alternate)?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=l.childLanes,i.lanes=l.lanes,i.child=l.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=l.memoizedProps,i.memoizedState=l.memoizedState,i.updateQueue=l.updateQueue,i.type=l.type,e=l.dependencies,i.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return _n($s,1&$s.current|2),t.child}e=e.sibling}null!==i.tail&&Je()>Vl&&(t.flags|=128,a=!0,Go(i,!1),t.lanes=4194304)}else{if(!a)if(null!==(e=ei(l))){if(t.flags|=128,a=!0,null!==(r=e.updateQueue)&&(t.updateQueue=r,t.flags|=4),Go(i,!0),null===i.tail&&"hidden"===i.tailMode&&!l.alternate&&!ns)return Wo(t),null}else 2*Je()-i.renderingStartTime>Vl&&1073741824!==r&&(t.flags|=128,a=!0,Go(i,!1),t.lanes=4194304);i.isBackwards?(l.sibling=t.child,t.child=l):(null!==(r=i.last)?r.sibling=l:t.child=l,i.last=l)}return null!==i.tail?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=Je(),t.sibling=null,r=$s.current,_n($s,a?1&r|2:1&r),t):(Wo(t),null);case 22:case 23:return uc(),a=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==a&&(t.flags|=8192),a&&0!==(1&t.mode)?0!==(1073741824&Dl)&&(Wo(t),6&t.subtreeFlags&&(t.flags|=8192)):Wo(t),null;case 24:case 25:return null}throw Error(s(156,t.tag))}function Qo(e,t){switch(ts(t),t.tag){case 1:return Dn(t.type)&&Pn(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Xs(),Sn(Cn),Sn(An),ri(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return Zs(t),null;case 13:if(Sn($s),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(s(340));ms()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Sn($s),null;case 4:return Xs(),null;case 10:return Es(t.type._context),null;case 22:case 23:return uc(),null;default:return null}}To=function(e,t){for(var r=t.child;null!==r;){if(5===r.tag||6===r.tag)e.appendChild(r.stateNode);else if(4!==r.tag&&null!==r.child){r.child.return=r,r=r.child;continue}if(r===t)break;for(;null===r.sibling;){if(null===r.return||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}},Do=function(){},Po=function(e,t,r,a){var n=e.memoizedProps;if(n!==a){e=t.stateNode,Qs(Gs.current);var s,i=null;switch(r){case"input":n=Y(e,n),a=Y(e,a),i=[];break;case"select":n=R({},n,{value:void 0}),a=R({},a,{value:void 0}),i=[];break;case"textarea":n=ae(e,n),a=ae(e,a),i=[];break;default:"function"!==typeof n.onClick&&"function"===typeof a.onClick&&(e.onclick=Za)}for(d in ye(r,a),r=null,n)if(!a.hasOwnProperty(d)&&n.hasOwnProperty(d)&&null!=n[d])if("style"===d){var l=n[d];for(s in l)l.hasOwnProperty(s)&&(r||(r={}),r[s]="")}else"dangerouslySetInnerHTML"!==d&&"children"!==d&&"suppressContentEditableWarning"!==d&&"suppressHydrationWarning"!==d&&"autoFocus"!==d&&(o.hasOwnProperty(d)?i||(i=[]):(i=i||[]).push(d,null));for(d in a){var c=a[d];if(l=null!=n?n[d]:void 0,a.hasOwnProperty(d)&&c!==l&&(null!=c||null!=l))if("style"===d)if(l){for(s in l)!l.hasOwnProperty(s)||c&&c.hasOwnProperty(s)||(r||(r={}),r[s]="");for(s in c)c.hasOwnProperty(s)&&l[s]!==c[s]&&(r||(r={}),r[s]=c[s])}else r||(i||(i=[]),i.push(d,r)),r=c;else"dangerouslySetInnerHTML"===d?(c=c?c.__html:void 0,l=l?l.__html:void 0,null!=c&&l!==c&&(i=i||[]).push(d,c)):"children"===d?"string"!==typeof c&&"number"!==typeof c||(i=i||[]).push(d,""+c):"suppressContentEditableWarning"!==d&&"suppressHydrationWarning"!==d&&(o.hasOwnProperty(d)?(null!=c&&"onScroll"===d&&Oa("scroll",e),i||l===c||(i=[])):(i=i||[]).push(d,c))}r&&(i=i||[]).push("style",r);var d=i;(t.updateQueue=d)&&(t.flags|=4)}},Fo=function(e,t,r,a){r!==a&&(t.flags|=4)};var Yo=!1,Xo=!1,Jo="function"===typeof WeakSet?WeakSet:Set,Zo=null;function $o(e,t){var r=e.ref;if(null!==r)if("function"===typeof r)try{r(null)}catch(a){jc(e,t,a)}else r.current=null}function el(e,t,r){try{r()}catch(a){jc(e,t,a)}}var tl=!1;function rl(e,t,r){var a=t.updateQueue;if(null!==(a=null!==a?a.lastEffect:null)){var n=a=a.next;do{if((n.tag&e)===e){var s=n.destroy;n.destroy=void 0,void 0!==s&&el(t,r,s)}n=n.next}while(n!==a)}}function al(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var r=t=t.next;do{if((r.tag&e)===e){var a=r.create;r.destroy=a()}r=r.next}while(r!==t)}}function nl(e){var t=e.ref;if(null!==t){var r=e.stateNode;e.tag,e=r,"function"===typeof t?t(e):t.current=e}}function sl(e){var t=e.alternate;null!==t&&(e.alternate=null,sl(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[hn],delete t[mn],delete t[gn],delete t[pn],delete t[xn])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function il(e){return 5===e.tag||3===e.tag||4===e.tag}function ol(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||il(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function ll(e,t,r){var a=e.tag;if(5===a||6===a)e=e.stateNode,t?8===r.nodeType?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(8===r.nodeType?(t=r.parentNode).insertBefore(e,r):(t=r).appendChild(e),null!==(r=r._reactRootContainer)&&void 0!==r||null!==t.onclick||(t.onclick=Za));else if(4!==a&&null!==(e=e.child))for(ll(e,t,r),e=e.sibling;null!==e;)ll(e,t,r),e=e.sibling}function cl(e,t,r){var a=e.tag;if(5===a||6===a)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(4!==a&&null!==(e=e.child))for(cl(e,t,r),e=e.sibling;null!==e;)cl(e,t,r),e=e.sibling}var dl=null,ul=!1;function hl(e,t,r){for(r=r.child;null!==r;)ml(e,t,r),r=r.sibling}function ml(e,t,r){if(st&&"function"===typeof st.onCommitFiberUnmount)try{st.onCommitFiberUnmount(nt,r)}catch(o){}switch(r.tag){case 5:Xo||$o(r,t);case 6:var a=dl,n=ul;dl=null,hl(e,t,r),ul=n,null!==(dl=a)&&(ul?(e=dl,r=r.stateNode,8===e.nodeType?e.parentNode.removeChild(r):e.removeChild(r)):dl.removeChild(r.stateNode));break;case 18:null!==dl&&(ul?(e=dl,r=r.stateNode,8===e.nodeType?ln(e.parentNode,r):1===e.nodeType&&ln(e,r),Vt(e)):ln(dl,r.stateNode));break;case 4:a=dl,n=ul,dl=r.stateNode.containerInfo,ul=!0,hl(e,t,r),dl=a,ul=n;break;case 0:case 11:case 14:case 15:if(!Xo&&(null!==(a=r.updateQueue)&&null!==(a=a.lastEffect))){n=a=a.next;do{var s=n,i=s.destroy;s=s.tag,void 0!==i&&(0!==(2&s)||0!==(4&s))&&el(r,t,i),n=n.next}while(n!==a)}hl(e,t,r);break;case 1:if(!Xo&&($o(r,t),"function"===typeof(a=r.stateNode).componentWillUnmount))try{a.props=r.memoizedProps,a.state=r.memoizedState,a.componentWillUnmount()}catch(o){jc(r,t,o)}hl(e,t,r);break;case 21:hl(e,t,r);break;case 22:1&r.mode?(Xo=(a=Xo)||null!==r.memoizedState,hl(e,t,r),Xo=a):hl(e,t,r);break;default:hl(e,t,r)}}function fl(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var r=e.stateNode;null===r&&(r=e.stateNode=new Jo),t.forEach(function(t){var a=Ac.bind(null,e,t);r.has(t)||(r.add(t),t.then(a,a))})}}function gl(e,t){var r=t.deletions;if(null!==r)for(var a=0;a<r.length;a++){var n=r[a];try{var i=e,o=t,l=o;e:for(;null!==l;){switch(l.tag){case 5:dl=l.stateNode,ul=!1;break e;case 3:case 4:dl=l.stateNode.containerInfo,ul=!0;break e}l=l.return}if(null===dl)throw Error(s(160));ml(i,o,n),dl=null,ul=!1;var c=n.alternate;null!==c&&(c.return=null),n.return=null}catch(d){jc(n,t,d)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)pl(t,e),t=t.sibling}function pl(e,t){var r=e.alternate,a=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(gl(t,e),xl(e),4&a){try{rl(3,e,e.return),al(3,e)}catch(p){jc(e,e.return,p)}try{rl(5,e,e.return)}catch(p){jc(e,e.return,p)}}break;case 1:gl(t,e),xl(e),512&a&&null!==r&&$o(r,r.return);break;case 5:if(gl(t,e),xl(e),512&a&&null!==r&&$o(r,r.return),32&e.flags){var n=e.stateNode;try{he(n,"")}catch(p){jc(e,e.return,p)}}if(4&a&&null!=(n=e.stateNode)){var i=e.memoizedProps,o=null!==r?r.memoizedProps:i,l=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===l&&"radio"===i.type&&null!=i.name&&J(n,i),ve(l,o);var d=ve(l,i);for(o=0;o<c.length;o+=2){var u=c[o],h=c[o+1];"style"===u?pe(n,h):"dangerouslySetInnerHTML"===u?ue(n,h):"children"===u?he(n,h):v(n,u,h,d)}switch(l){case"input":Z(n,i);break;case"textarea":se(n,i);break;case"select":var m=n._wrapperState.wasMultiple;n._wrapperState.wasMultiple=!!i.multiple;var f=i.value;null!=f?re(n,!!i.multiple,f,!1):m!==!!i.multiple&&(null!=i.defaultValue?re(n,!!i.multiple,i.defaultValue,!0):re(n,!!i.multiple,i.multiple?[]:"",!1))}n[mn]=i}catch(p){jc(e,e.return,p)}}break;case 6:if(gl(t,e),xl(e),4&a){if(null===e.stateNode)throw Error(s(162));n=e.stateNode,i=e.memoizedProps;try{n.nodeValue=i}catch(p){jc(e,e.return,p)}}break;case 3:if(gl(t,e),xl(e),4&a&&null!==r&&r.memoizedState.isDehydrated)try{Vt(t.containerInfo)}catch(p){jc(e,e.return,p)}break;case 4:default:gl(t,e),xl(e);break;case 13:gl(t,e),xl(e),8192&(n=e.child).flags&&(i=null!==n.memoizedState,n.stateNode.isHidden=i,!i||null!==n.alternate&&null!==n.alternate.memoizedState||(Ul=Je())),4&a&&fl(e);break;case 22:if(u=null!==r&&null!==r.memoizedState,1&e.mode?(Xo=(d=Xo)||u,gl(t,e),Xo=d):gl(t,e),xl(e),8192&a){if(d=null!==e.memoizedState,(e.stateNode.isHidden=d)&&!u&&0!==(1&e.mode))for(Zo=e,u=e.child;null!==u;){for(h=Zo=u;null!==Zo;){switch(f=(m=Zo).child,m.tag){case 0:case 11:case 14:case 15:rl(4,m,m.return);break;case 1:$o(m,m.return);var g=m.stateNode;if("function"===typeof g.componentWillUnmount){a=m,r=m.return;try{t=a,g.props=t.memoizedProps,g.state=t.memoizedState,g.componentWillUnmount()}catch(p){jc(a,r,p)}}break;case 5:$o(m,m.return);break;case 22:if(null!==m.memoizedState){wl(h);continue}}null!==f?(f.return=m,Zo=f):wl(h)}u=u.sibling}e:for(u=null,h=e;;){if(5===h.tag){if(null===u){u=h;try{n=h.stateNode,d?"function"===typeof(i=n.style).setProperty?i.setProperty("display","none","important"):i.display="none":(l=h.stateNode,o=void 0!==(c=h.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,l.style.display=ge("display",o))}catch(p){jc(e,e.return,p)}}}else if(6===h.tag){if(null===u)try{h.stateNode.nodeValue=d?"":h.memoizedProps}catch(p){jc(e,e.return,p)}}else if((22!==h.tag&&23!==h.tag||null===h.memoizedState||h===e)&&null!==h.child){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;null===h.sibling;){if(null===h.return||h.return===e)break e;u===h&&(u=null),h=h.return}u===h&&(u=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:gl(t,e),xl(e),4&a&&fl(e);case 21:}}function xl(e){var t=e.flags;if(2&t){try{e:{for(var r=e.return;null!==r;){if(il(r)){var a=r;break e}r=r.return}throw Error(s(160))}switch(a.tag){case 5:var n=a.stateNode;32&a.flags&&(he(n,""),a.flags&=-33),cl(e,ol(e),n);break;case 3:case 4:var i=a.stateNode.containerInfo;ll(e,ol(e),i);break;default:throw Error(s(161))}}catch(o){jc(e,e.return,o)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function yl(e,t,r){Zo=e,vl(e,t,r)}function vl(e,t,r){for(var a=0!==(1&e.mode);null!==Zo;){var n=Zo,s=n.child;if(22===n.tag&&a){var i=null!==n.memoizedState||Yo;if(!i){var o=n.alternate,l=null!==o&&null!==o.memoizedState||Xo;o=Yo;var c=Xo;if(Yo=i,(Xo=l)&&!c)for(Zo=n;null!==Zo;)l=(i=Zo).child,22===i.tag&&null!==i.memoizedState?kl(n):null!==l?(l.return=i,Zo=l):kl(n);for(;null!==s;)Zo=s,vl(s,t,r),s=s.sibling;Zo=n,Yo=o,Xo=c}bl(e)}else 0!==(8772&n.subtreeFlags)&&null!==s?(s.return=n,Zo=s):bl(e)}}function bl(e){for(;null!==Zo;){var t=Zo;if(0!==(8772&t.flags)){var r=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Xo||al(5,t);break;case 1:var a=t.stateNode;if(4&t.flags&&!Xo)if(null===r)a.componentDidMount();else{var n=t.elementType===t.type?r.memoizedProps:to(t.type,r.memoizedProps);a.componentDidUpdate(n,r.memoizedState,a.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;null!==i&&qs(t,i,a);break;case 3:var o=t.updateQueue;if(null!==o){if(r=null,null!==t.child)switch(t.child.tag){case 5:case 1:r=t.child.stateNode}qs(t,o,r)}break;case 5:var l=t.stateNode;if(null===r&&4&t.flags){r=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var d=t.alternate;if(null!==d){var u=d.memoizedState;if(null!==u){var h=u.dehydrated;null!==h&&Vt(h)}}}break;default:throw Error(s(163))}Xo||512&t.flags&&nl(t)}catch(m){jc(t,t.return,m)}}if(t===e){Zo=null;break}if(null!==(r=t.sibling)){r.return=t.return,Zo=r;break}Zo=t.return}}function wl(e){for(;null!==Zo;){var t=Zo;if(t===e){Zo=null;break}var r=t.sibling;if(null!==r){r.return=t.return,Zo=r;break}Zo=t.return}}function kl(e){for(;null!==Zo;){var t=Zo;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{al(4,t)}catch(l){jc(t,r,l)}break;case 1:var a=t.stateNode;if("function"===typeof a.componentDidMount){var n=t.return;try{a.componentDidMount()}catch(l){jc(t,n,l)}}var s=t.return;try{nl(t)}catch(l){jc(t,s,l)}break;case 5:var i=t.return;try{nl(t)}catch(l){jc(t,i,l)}}}catch(l){jc(t,t.return,l)}if(t===e){Zo=null;break}var o=t.sibling;if(null!==o){o.return=t.return,Zo=o;break}Zo=t.return}}var Nl,jl=Math.ceil,Sl=b.ReactCurrentDispatcher,_l=b.ReactCurrentOwner,El=b.ReactCurrentBatchConfig,Al=0,Cl=null,Il=null,Tl=0,Dl=0,Pl=jn(0),Fl=0,Ll=null,Ml=0,Rl=0,Ol=0,Bl=null,zl=null,Ul=0,Vl=1/0,ql=null,Hl=!1,Gl=null,Wl=null,Kl=!1,Ql=null,Yl=0,Xl=0,Jl=null,Zl=-1,$l=0;function ec(){return 0!==(6&Al)?Je():-1!==Zl?Zl:Zl=Je()}function tc(e){return 0===(1&e.mode)?1:0!==(2&Al)&&0!==Tl?Tl&-Tl:null!==gs.transition?(0===$l&&($l=gt()),$l):0!==(e=vt)?e:e=void 0===(e=window.event)?16:Xt(e.type)}function rc(e,t,r,a){if(50<Xl)throw Xl=0,Jl=null,Error(s(185));xt(e,r,a),0!==(2&Al)&&e===Cl||(e===Cl&&(0===(2&Al)&&(Rl|=r),4===Fl&&oc(e,Tl)),ac(e,a),1===r&&0===Al&&0===(1&t.mode)&&(Vl=Je()+500,Bn&&Vn()))}function ac(e,t){var r=e.callbackNode;!function(e,t){for(var r=e.suspendedLanes,a=e.pingedLanes,n=e.expirationTimes,s=e.pendingLanes;0<s;){var i=31-it(s),o=1<<i,l=n[i];-1===l?0!==(o&r)&&0===(o&a)||(n[i]=mt(o,t)):l<=t&&(e.expiredLanes|=o),s&=~o}}(e,t);var a=ht(e,e===Cl?Tl:0);if(0===a)null!==r&&Qe(r),e.callbackNode=null,e.callbackPriority=0;else if(t=a&-a,e.callbackPriority!==t){if(null!=r&&Qe(r),1===t)0===e.tag?function(e){Bn=!0,Un(e)}(lc.bind(null,e)):Un(lc.bind(null,e)),sn(function(){0===(6&Al)&&Vn()}),r=null;else{switch(bt(a)){case 1:r=$e;break;case 4:r=et;break;case 16:default:r=tt;break;case 536870912:r=at}r=Cc(r,nc.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function nc(e,t){if(Zl=-1,$l=0,0!==(6&Al))throw Error(s(327));var r=e.callbackNode;if(kc()&&e.callbackNode!==r)return null;var a=ht(e,e===Cl?Tl:0);if(0===a)return null;if(0!==(30&a)||0!==(a&e.expiredLanes)||t)t=pc(e,a);else{t=a;var n=Al;Al|=2;var i=fc();for(Cl===e&&Tl===t||(ql=null,Vl=Je()+500,hc(e,t));;)try{yc();break}catch(l){mc(e,l)}_s(),Sl.current=i,Al=n,null!==Il?t=0:(Cl=null,Tl=0,t=Fl)}if(0!==t){if(2===t&&(0!==(n=ft(e))&&(a=n,t=sc(e,n))),1===t)throw r=Ll,hc(e,0),oc(e,a),ac(e,Je()),r;if(6===t)oc(e,a);else{if(n=e.current.alternate,0===(30&a)&&!function(e){for(var t=e;;){if(16384&t.flags){var r=t.updateQueue;if(null!==r&&null!==(r=r.stores))for(var a=0;a<r.length;a++){var n=r[a],s=n.getSnapshot;n=n.value;try{if(!ia(s(),n))return!1}catch(o){return!1}}}if(r=t.child,16384&t.subtreeFlags&&null!==r)r.return=t,t=r;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(n)&&(2===(t=pc(e,a))&&(0!==(i=ft(e))&&(a=i,t=sc(e,i))),1===t))throw r=Ll,hc(e,0),oc(e,a),ac(e,Je()),r;switch(e.finishedWork=n,e.finishedLanes=a,t){case 0:case 1:throw Error(s(345));case 2:case 5:wc(e,zl,ql);break;case 3:if(oc(e,a),(130023424&a)===a&&10<(t=Ul+500-Je())){if(0!==ht(e,0))break;if(((n=e.suspendedLanes)&a)!==a){ec(),e.pingedLanes|=e.suspendedLanes&n;break}e.timeoutHandle=rn(wc.bind(null,e,zl,ql),t);break}wc(e,zl,ql);break;case 4:if(oc(e,a),(4194240&a)===a)break;for(t=e.eventTimes,n=-1;0<a;){var o=31-it(a);i=1<<o,(o=t[o])>n&&(n=o),a&=~i}if(a=n,10<(a=(120>(a=Je()-a)?120:480>a?480:1080>a?1080:1920>a?1920:3e3>a?3e3:4320>a?4320:1960*jl(a/1960))-a)){e.timeoutHandle=rn(wc.bind(null,e,zl,ql),a);break}wc(e,zl,ql);break;default:throw Error(s(329))}}}return ac(e,Je()),e.callbackNode===r?nc.bind(null,e):null}function sc(e,t){var r=Bl;return e.current.memoizedState.isDehydrated&&(hc(e,t).flags|=256),2!==(e=pc(e,t))&&(t=zl,zl=r,null!==t&&ic(t)),e}function ic(e){null===zl?zl=e:zl.push.apply(zl,e)}function oc(e,t){for(t&=~Ol,t&=~Rl,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-it(t),a=1<<r;e[r]=-1,t&=~a}}function lc(e){if(0!==(6&Al))throw Error(s(327));kc();var t=ht(e,0);if(0===(1&t))return ac(e,Je()),null;var r=pc(e,t);if(0!==e.tag&&2===r){var a=ft(e);0!==a&&(t=a,r=sc(e,a))}if(1===r)throw r=Ll,hc(e,0),oc(e,t),ac(e,Je()),r;if(6===r)throw Error(s(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,wc(e,zl,ql),ac(e,Je()),null}function cc(e,t){var r=Al;Al|=1;try{return e(t)}finally{0===(Al=r)&&(Vl=Je()+500,Bn&&Vn())}}function dc(e){null!==Ql&&0===Ql.tag&&0===(6&Al)&&kc();var t=Al;Al|=1;var r=El.transition,a=vt;try{if(El.transition=null,vt=1,e)return e()}finally{vt=a,El.transition=r,0===(6&(Al=t))&&Vn()}}function uc(){Dl=Pl.current,Sn(Pl)}function hc(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(-1!==r&&(e.timeoutHandle=-1,an(r)),null!==Il)for(r=Il.return;null!==r;){var a=r;switch(ts(a),a.tag){case 1:null!==(a=a.type.childContextTypes)&&void 0!==a&&Pn();break;case 3:Xs(),Sn(Cn),Sn(An),ri();break;case 5:Zs(a);break;case 4:Xs();break;case 13:case 19:Sn($s);break;case 10:Es(a.type._context);break;case 22:case 23:uc()}r=r.return}if(Cl=e,Il=e=Pc(e.current,null),Tl=Dl=t,Fl=0,Ll=null,Ol=Rl=Ml=0,zl=Bl=null,null!==Ts){for(t=0;t<Ts.length;t++)if(null!==(a=(r=Ts[t]).interleaved)){r.interleaved=null;var n=a.next,s=r.pending;if(null!==s){var i=s.next;s.next=n,a.next=i}r.pending=a}Ts=null}return e}function mc(e,t){for(;;){var r=Il;try{if(_s(),ai.current=Ji,ci){for(var a=ii.memoizedState;null!==a;){var n=a.queue;null!==n&&(n.pending=null),a=a.next}ci=!1}if(si=0,li=oi=ii=null,di=!1,ui=0,_l.current=null,null===r||null===r.return){Fl=1,Ll=t,Il=null;break}e:{var i=e,o=r.return,l=r,c=t;if(t=Tl,l.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var d=c,u=l,h=u.tag;if(0===(1&u.mode)&&(0===h||11===h||15===h)){var m=u.alternate;m?(u.updateQueue=m.updateQueue,u.memoizedState=m.memoizedState,u.lanes=m.lanes):(u.updateQueue=null,u.memoizedState=null)}var f=po(o);if(null!==f){f.flags&=-257,xo(f,o,l,0,t),1&f.mode&&go(i,d,t),c=d;var g=(t=f).updateQueue;if(null===g){var p=new Set;p.add(c),t.updateQueue=p}else g.add(c);break e}if(0===(1&t)){go(i,d,t),gc();break e}c=Error(s(426))}else if(ns&&1&l.mode){var x=po(o);if(null!==x){0===(65536&x.flags)&&(x.flags|=256),xo(x,o,l,0,t),fs(lo(c,l));break e}}i=c=lo(c,l),4!==Fl&&(Fl=2),null===Bl?Bl=[i]:Bl.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t,Us(i,mo(0,c,t));break e;case 1:l=c;var y=i.type,v=i.stateNode;if(0===(128&i.flags)&&("function"===typeof y.getDerivedStateFromError||null!==v&&"function"===typeof v.componentDidCatch&&(null===Wl||!Wl.has(v)))){i.flags|=65536,t&=-t,i.lanes|=t,Us(i,fo(i,l,t));break e}}i=i.return}while(null!==i)}bc(r)}catch(b){t=b,Il===r&&null!==r&&(Il=r=r.return);continue}break}}function fc(){var e=Sl.current;return Sl.current=Ji,null===e?Ji:e}function gc(){0!==Fl&&3!==Fl&&2!==Fl||(Fl=4),null===Cl||0===(268435455&Ml)&&0===(268435455&Rl)||oc(Cl,Tl)}function pc(e,t){var r=Al;Al|=2;var a=fc();for(Cl===e&&Tl===t||(ql=null,hc(e,t));;)try{xc();break}catch(n){mc(e,n)}if(_s(),Al=r,Sl.current=a,null!==Il)throw Error(s(261));return Cl=null,Tl=0,Fl}function xc(){for(;null!==Il;)vc(Il)}function yc(){for(;null!==Il&&!Ye();)vc(Il)}function vc(e){var t=Nl(e.alternate,e,Dl);e.memoizedProps=e.pendingProps,null===t?bc(e):Il=t,_l.current=null}function bc(e){var t=e;do{var r=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(r=Ko(r,t,Dl)))return void(Il=r)}else{if(null!==(r=Qo(r,t)))return r.flags&=32767,void(Il=r);if(null===e)return Fl=6,void(Il=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Il=t);Il=t=e}while(null!==t);0===Fl&&(Fl=5)}function wc(e,t,r){var a=vt,n=El.transition;try{El.transition=null,vt=1,function(e,t,r,a){do{kc()}while(null!==Ql);if(0!==(6&Al))throw Error(s(327));r=e.finishedWork;var n=e.finishedLanes;if(null===r)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(s(177));e.callbackNode=null,e.callbackPriority=0;var i=r.lanes|r.childLanes;if(function(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var a=e.eventTimes;for(e=e.expirationTimes;0<r;){var n=31-it(r),s=1<<n;t[n]=0,a[n]=-1,e[n]=-1,r&=~s}}(e,i),e===Cl&&(Il=Cl=null,Tl=0),0===(2064&r.subtreeFlags)&&0===(2064&r.flags)||Kl||(Kl=!0,Cc(tt,function(){return kc(),null})),i=0!==(15990&r.flags),0!==(15990&r.subtreeFlags)||i){i=El.transition,El.transition=null;var o=vt;vt=1;var l=Al;Al|=4,_l.current=null,function(e,t){if($a=Ht,ha(e=ua())){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{var a=(r=(r=e.ownerDocument)&&r.defaultView||window).getSelection&&r.getSelection();if(a&&0!==a.rangeCount){r=a.anchorNode;var n=a.anchorOffset,i=a.focusNode;a=a.focusOffset;try{r.nodeType,i.nodeType}catch(w){r=null;break e}var o=0,l=-1,c=-1,d=0,u=0,h=e,m=null;t:for(;;){for(var f;h!==r||0!==n&&3!==h.nodeType||(l=o+n),h!==i||0!==a&&3!==h.nodeType||(c=o+a),3===h.nodeType&&(o+=h.nodeValue.length),null!==(f=h.firstChild);)m=h,h=f;for(;;){if(h===e)break t;if(m===r&&++d===n&&(l=o),m===i&&++u===a&&(c=o),null!==(f=h.nextSibling))break;m=(h=m).parentNode}h=f}r=-1===l||-1===c?null:{start:l,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(en={focusedElem:e,selectionRange:r},Ht=!1,Zo=t;null!==Zo;)if(e=(t=Zo).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Zo=e;else for(;null!==Zo;){t=Zo;try{var g=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==g){var p=g.memoizedProps,x=g.memoizedState,y=t.stateNode,v=y.getSnapshotBeforeUpdate(t.elementType===t.type?p:to(t.type,p),x);y.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var b=t.stateNode.containerInfo;1===b.nodeType?b.textContent="":9===b.nodeType&&b.documentElement&&b.removeChild(b.documentElement);break;default:throw Error(s(163))}}catch(w){jc(t,t.return,w)}if(null!==(e=t.sibling)){e.return=t.return,Zo=e;break}Zo=t.return}g=tl,tl=!1}(e,r),pl(r,e),ma(en),Ht=!!$a,en=$a=null,e.current=r,yl(r,e,n),Xe(),Al=l,vt=o,El.transition=i}else e.current=r;if(Kl&&(Kl=!1,Ql=e,Yl=n),i=e.pendingLanes,0===i&&(Wl=null),function(e){if(st&&"function"===typeof st.onCommitFiberRoot)try{st.onCommitFiberRoot(nt,e,void 0,128===(128&e.current.flags))}catch(t){}}(r.stateNode),ac(e,Je()),null!==t)for(a=e.onRecoverableError,r=0;r<t.length;r++)n=t[r],a(n.value,{componentStack:n.stack,digest:n.digest});if(Hl)throw Hl=!1,e=Gl,Gl=null,e;0!==(1&Yl)&&0!==e.tag&&kc(),i=e.pendingLanes,0!==(1&i)?e===Jl?Xl++:(Xl=0,Jl=e):Xl=0,Vn()}(e,t,r,a)}finally{El.transition=n,vt=a}return null}function kc(){if(null!==Ql){var e=bt(Yl),t=El.transition,r=vt;try{if(El.transition=null,vt=16>e?16:e,null===Ql)var a=!1;else{if(e=Ql,Ql=null,Yl=0,0!==(6&Al))throw Error(s(331));var n=Al;for(Al|=4,Zo=e.current;null!==Zo;){var i=Zo,o=i.child;if(0!==(16&Zo.flags)){var l=i.deletions;if(null!==l){for(var c=0;c<l.length;c++){var d=l[c];for(Zo=d;null!==Zo;){var u=Zo;switch(u.tag){case 0:case 11:case 15:rl(8,u,i)}var h=u.child;if(null!==h)h.return=u,Zo=h;else for(;null!==Zo;){var m=(u=Zo).sibling,f=u.return;if(sl(u),u===d){Zo=null;break}if(null!==m){m.return=f,Zo=m;break}Zo=f}}}var g=i.alternate;if(null!==g){var p=g.child;if(null!==p){g.child=null;do{var x=p.sibling;p.sibling=null,p=x}while(null!==p)}}Zo=i}}if(0!==(2064&i.subtreeFlags)&&null!==o)o.return=i,Zo=o;else e:for(;null!==Zo;){if(0!==(2048&(i=Zo).flags))switch(i.tag){case 0:case 11:case 15:rl(9,i,i.return)}var y=i.sibling;if(null!==y){y.return=i.return,Zo=y;break e}Zo=i.return}}var v=e.current;for(Zo=v;null!==Zo;){var b=(o=Zo).child;if(0!==(2064&o.subtreeFlags)&&null!==b)b.return=o,Zo=b;else e:for(o=v;null!==Zo;){if(0!==(2048&(l=Zo).flags))try{switch(l.tag){case 0:case 11:case 15:al(9,l)}}catch(k){jc(l,l.return,k)}if(l===o){Zo=null;break e}var w=l.sibling;if(null!==w){w.return=l.return,Zo=w;break e}Zo=l.return}}if(Al=n,Vn(),st&&"function"===typeof st.onPostCommitFiberRoot)try{st.onPostCommitFiberRoot(nt,e)}catch(k){}a=!0}return a}finally{vt=r,El.transition=t}}return!1}function Nc(e,t,r){e=Bs(e,t=mo(0,t=lo(r,t),1),1),t=ec(),null!==e&&(xt(e,1,t),ac(e,t))}function jc(e,t,r){if(3===e.tag)Nc(e,e,r);else for(;null!==t;){if(3===t.tag){Nc(t,e,r);break}if(1===t.tag){var a=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof a.componentDidCatch&&(null===Wl||!Wl.has(a))){t=Bs(t,e=fo(t,e=lo(r,e),1),1),e=ec(),null!==t&&(xt(t,1,e),ac(t,e));break}}t=t.return}}function Sc(e,t,r){var a=e.pingCache;null!==a&&a.delete(t),t=ec(),e.pingedLanes|=e.suspendedLanes&r,Cl===e&&(Tl&r)===r&&(4===Fl||3===Fl&&(130023424&Tl)===Tl&&500>Je()-Ul?hc(e,0):Ol|=r),ac(e,t)}function _c(e,t){0===t&&(0===(1&e.mode)?t=1:(t=dt,0===(130023424&(dt<<=1))&&(dt=4194304)));var r=ec();null!==(e=Fs(e,t))&&(xt(e,t,r),ac(e,r))}function Ec(e){var t=e.memoizedState,r=0;null!==t&&(r=t.retryLane),_c(e,r)}function Ac(e,t){var r=0;switch(e.tag){case 13:var a=e.stateNode,n=e.memoizedState;null!==n&&(r=n.retryLane);break;case 19:a=e.stateNode;break;default:throw Error(s(314))}null!==a&&a.delete(t),_c(e,r)}function Cc(e,t){return Ke(e,t)}function Ic(e,t,r,a){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=a,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Tc(e,t,r,a){return new Ic(e,t,r,a)}function Dc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Pc(e,t){var r=e.alternate;return null===r?((r=Tc(e.tag,t,e.key,e.mode)).elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=14680064&e.flags,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Fc(e,t,r,a,n,i){var o=2;if(a=e,"function"===typeof e)Dc(e)&&(o=1);else if("string"===typeof e)o=5;else e:switch(e){case N:return Lc(r.children,n,i,t);case j:o=8,n|=8;break;case S:return(e=Tc(12,r,t,2|n)).elementType=S,e.lanes=i,e;case C:return(e=Tc(13,r,t,n)).elementType=C,e.lanes=i,e;case I:return(e=Tc(19,r,t,n)).elementType=I,e.lanes=i,e;case P:return Mc(r,n,i,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case _:o=10;break e;case E:o=9;break e;case A:o=11;break e;case T:o=14;break e;case D:o=16,a=null;break e}throw Error(s(130,null==e?e:typeof e,""))}return(t=Tc(o,r,t,n)).elementType=e,t.type=a,t.lanes=i,t}function Lc(e,t,r,a){return(e=Tc(7,e,a,t)).lanes=r,e}function Mc(e,t,r,a){return(e=Tc(22,e,a,t)).elementType=P,e.lanes=r,e.stateNode={isHidden:!1},e}function Rc(e,t,r){return(e=Tc(6,e,null,t)).lanes=r,e}function Oc(e,t,r){return(t=Tc(4,null!==e.children?e.children:[],e.key,t)).lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Bc(e,t,r,a,n){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=pt(0),this.expirationTimes=pt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=pt(0),this.identifierPrefix=a,this.onRecoverableError=n,this.mutableSourceEagerHydrationData=null}function zc(e,t,r,a,n,s,i,o,l){return e=new Bc(e,t,r,o,l),1===t?(t=1,!0===s&&(t|=8)):t=0,s=Tc(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:a,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ms(s),e}function Uc(e){if(!e)return En;e:{if(Ve(e=e._reactInternals)!==e||1!==e.tag)throw Error(s(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Dn(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(s(171))}if(1===e.tag){var r=e.type;if(Dn(r))return Ln(e,r,t)}return t}function Vc(e,t,r,a,n,s,i,o,l){return(e=zc(r,a,!0,e,0,s,0,o,l)).context=Uc(null),r=e.current,(s=Os(a=ec(),n=tc(r))).callback=void 0!==t&&null!==t?t:null,Bs(r,s,n),e.current.lanes=n,xt(e,n,a),ac(e,a),e}function qc(e,t,r,a){var n=t.current,s=ec(),i=tc(n);return r=Uc(r),null===t.context?t.context=r:t.pendingContext=r,(t=Os(s,i)).payload={element:e},null!==(a=void 0===a?null:a)&&(t.callback=a),null!==(e=Bs(n,t,i))&&(rc(e,n,i,s),zs(e,n,i)),i}function Hc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Gc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var r=e.retryLane;e.retryLane=0!==r&&r<t?r:t}}function Wc(e,t){Gc(e,t),(e=e.alternate)&&Gc(e,t)}Nl=function(e,t,r){if(null!==e)if(e.memoizedProps!==t.pendingProps||Cn.current)vo=!0;else{if(0===(e.lanes&r)&&0===(128&t.flags))return vo=!1,function(e,t,r){switch(t.tag){case 3:Co(t),ms();break;case 5:Js(t);break;case 1:Dn(t.type)&&Mn(t);break;case 4:Ys(t,t.stateNode.containerInfo);break;case 10:var a=t.type._context,n=t.memoizedProps.value;_n(ks,a._currentValue),a._currentValue=n;break;case 13:if(null!==(a=t.memoizedState))return null!==a.dehydrated?(_n($s,1&$s.current),t.flags|=128,null):0!==(r&t.child.childLanes)?Ro(e,t,r):(_n($s,1&$s.current),null!==(e=Ho(e,t,r))?e.sibling:null);_n($s,1&$s.current);break;case 19:if(a=0!==(r&t.childLanes),0!==(128&e.flags)){if(a)return Vo(e,t,r);t.flags|=128}if(null!==(n=t.memoizedState)&&(n.rendering=null,n.tail=null,n.lastEffect=null),_n($s,$s.current),a)break;return null;case 22:case 23:return t.lanes=0,jo(e,t,r)}return Ho(e,t,r)}(e,t,r);vo=0!==(131072&e.flags)}else vo=!1,ns&&0!==(1048576&t.flags)&&$n(t,Wn,t.index);switch(t.lanes=0,t.tag){case 2:var a=t.type;qo(e,t),e=t.pendingProps;var n=Tn(t,An.current);Cs(t,r),n=gi(null,t,a,e,n,r);var i=pi();return t.flags|=1,"object"===typeof n&&null!==n&&"function"===typeof n.render&&void 0===n.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Dn(a)?(i=!0,Mn(t)):i=!1,t.memoizedState=null!==n.state&&void 0!==n.state?n.state:null,Ms(t),n.updater=ao,t.stateNode=n,n._reactInternals=t,oo(t,a,e,r),t=Ao(null,t,a,!0,i,r)):(t.tag=0,ns&&i&&es(t),bo(null,t,n,r),t=t.child),t;case 16:a=t.elementType;e:{switch(qo(e,t),e=t.pendingProps,a=(n=a._init)(a._payload),t.type=a,n=t.tag=function(e){if("function"===typeof e)return Dc(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===A)return 11;if(e===T)return 14}return 2}(a),e=to(a,e),n){case 0:t=_o(null,t,a,e,r);break e;case 1:t=Eo(null,t,a,e,r);break e;case 11:t=wo(null,t,a,e,r);break e;case 14:t=ko(null,t,a,to(a.type,e),r);break e}throw Error(s(306,a,""))}return t;case 0:return a=t.type,n=t.pendingProps,_o(e,t,a,n=t.elementType===a?n:to(a,n),r);case 1:return a=t.type,n=t.pendingProps,Eo(e,t,a,n=t.elementType===a?n:to(a,n),r);case 3:e:{if(Co(t),null===e)throw Error(s(387));a=t.pendingProps,n=(i=t.memoizedState).element,Rs(e,t),Vs(t,a,null,r);var o=t.memoizedState;if(a=o.element,i.isDehydrated){if(i={element:a,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=i,t.memoizedState=i,256&t.flags){t=Io(e,t,a,r,n=lo(Error(s(423)),t));break e}if(a!==n){t=Io(e,t,a,r,n=lo(Error(s(424)),t));break e}for(as=cn(t.stateNode.containerInfo.firstChild),rs=t,ns=!0,ss=null,r=ws(t,null,a,r),t.child=r;r;)r.flags=-3&r.flags|4096,r=r.sibling}else{if(ms(),a===n){t=Ho(e,t,r);break e}bo(e,t,a,r)}t=t.child}return t;case 5:return Js(t),null===e&&cs(t),a=t.type,n=t.pendingProps,i=null!==e?e.memoizedProps:null,o=n.children,tn(a,n)?o=null:null!==i&&tn(a,i)&&(t.flags|=32),So(e,t),bo(e,t,o,r),t.child;case 6:return null===e&&cs(t),null;case 13:return Ro(e,t,r);case 4:return Ys(t,t.stateNode.containerInfo),a=t.pendingProps,null===e?t.child=bs(t,null,a,r):bo(e,t,a,r),t.child;case 11:return a=t.type,n=t.pendingProps,wo(e,t,a,n=t.elementType===a?n:to(a,n),r);case 7:return bo(e,t,t.pendingProps,r),t.child;case 8:case 12:return bo(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(a=t.type._context,n=t.pendingProps,i=t.memoizedProps,o=n.value,_n(ks,a._currentValue),a._currentValue=o,null!==i)if(ia(i.value,o)){if(i.children===n.children&&!Cn.current){t=Ho(e,t,r);break e}}else for(null!==(i=t.child)&&(i.return=t);null!==i;){var l=i.dependencies;if(null!==l){o=i.child;for(var c=l.firstContext;null!==c;){if(c.context===a){if(1===i.tag){(c=Os(-1,r&-r)).tag=2;var d=i.updateQueue;if(null!==d){var u=(d=d.shared).pending;null===u?c.next=c:(c.next=u.next,u.next=c),d.pending=c}}i.lanes|=r,null!==(c=i.alternate)&&(c.lanes|=r),As(i.return,r,t),l.lanes|=r;break}c=c.next}}else if(10===i.tag)o=i.type===t.type?null:i.child;else if(18===i.tag){if(null===(o=i.return))throw Error(s(341));o.lanes|=r,null!==(l=o.alternate)&&(l.lanes|=r),As(o,r,t),o=i.sibling}else o=i.child;if(null!==o)o.return=i;else for(o=i;null!==o;){if(o===t){o=null;break}if(null!==(i=o.sibling)){i.return=o.return,o=i;break}o=o.return}i=o}bo(e,t,n.children,r),t=t.child}return t;case 9:return n=t.type,a=t.pendingProps.children,Cs(t,r),a=a(n=Is(n)),t.flags|=1,bo(e,t,a,r),t.child;case 14:return n=to(a=t.type,t.pendingProps),ko(e,t,a,n=to(a.type,n),r);case 15:return No(e,t,t.type,t.pendingProps,r);case 17:return a=t.type,n=t.pendingProps,n=t.elementType===a?n:to(a,n),qo(e,t),t.tag=1,Dn(a)?(e=!0,Mn(t)):e=!1,Cs(t,r),so(t,a,n),oo(t,a,n,r),Ao(null,t,a,!0,e,r);case 19:return Vo(e,t,r);case 22:return jo(e,t,r)}throw Error(s(156,t.tag))};var Kc="function"===typeof reportError?reportError:function(e){console.error(e)};function Qc(e){this._internalRoot=e}function Yc(e){this._internalRoot=e}function Xc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Jc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Zc(){}function $c(e,t,r,a,n){var s=r._reactRootContainer;if(s){var i=s;if("function"===typeof n){var o=n;n=function(){var e=Hc(i);o.call(e)}}qc(t,i,e,n)}else i=function(e,t,r,a,n){if(n){if("function"===typeof a){var s=a;a=function(){var e=Hc(i);s.call(e)}}var i=Vc(t,a,e,0,null,!1,0,"",Zc);return e._reactRootContainer=i,e[fn]=i.current,Ua(8===e.nodeType?e.parentNode:e),dc(),i}for(;n=e.lastChild;)e.removeChild(n);if("function"===typeof a){var o=a;a=function(){var e=Hc(l);o.call(e)}}var l=zc(e,0,!1,null,0,!1,0,"",Zc);return e._reactRootContainer=l,e[fn]=l.current,Ua(8===e.nodeType?e.parentNode:e),dc(function(){qc(t,l,r,a)}),l}(r,t,e,n,a);return Hc(i)}Yc.prototype.render=Qc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(s(409));qc(e,t,null,null)},Yc.prototype.unmount=Qc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;dc(function(){qc(null,e,null,null)}),t[fn]=null}},Yc.prototype.unstable_scheduleHydration=function(e){if(e){var t=jt();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Pt.length&&0!==t&&t<Pt[r].priority;r++);Pt.splice(r,0,e),0===r&&Rt(e)}},wt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=ut(t.pendingLanes);0!==r&&(yt(t,1|r),ac(t,Je()),0===(6&Al)&&(Vl=Je()+500,Vn()))}break;case 13:dc(function(){var t=Fs(e,1);if(null!==t){var r=ec();rc(t,e,1,r)}}),Wc(e,1)}},kt=function(e){if(13===e.tag){var t=Fs(e,134217728);if(null!==t)rc(t,e,134217728,ec());Wc(e,134217728)}},Nt=function(e){if(13===e.tag){var t=tc(e),r=Fs(e,t);if(null!==r)rc(r,e,t,ec());Wc(e,t)}},jt=function(){return vt},St=function(e,t){var r=vt;try{return vt=e,t()}finally{vt=r}},ke=function(e,t,r){switch(t){case"input":if(Z(e,r),t=r.name,"radio"===r.type&&null!=t){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var a=r[t];if(a!==e&&a.form===e.form){var n=wn(a);if(!n)throw Error(s(90));K(a),Z(a,n)}}}break;case"textarea":se(e,r);break;case"select":null!=(t=r.value)&&re(e,!!r.multiple,t,!1)}},Ae=cc,Ce=dc;var ed={usingClientEntryPoint:!1,Events:[vn,bn,wn,_e,Ee,cc]},td={findFiberByHostInstance:yn,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},rd={bundleType:td.bundleType,version:td.version,rendererPackageName:td.rendererPackageName,rendererConfig:td.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:b.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=Ge(e))?null:e.stateNode},findFiberByHostInstance:td.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var ad=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ad.isDisabled&&ad.supportsFiber)try{nt=ad.inject(rd),st=ad}catch(de){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ed,t.createPortal=function(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Xc(t))throw Error(s(200));return function(e,t,r){var a=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:k,key:null==a?null:""+a,children:e,containerInfo:t,implementation:r}}(e,t,null,r)},t.createRoot=function(e,t){if(!Xc(e))throw Error(s(299));var r=!1,a="",n=Kc;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(r=!0),void 0!==t.identifierPrefix&&(a=t.identifierPrefix),void 0!==t.onRecoverableError&&(n=t.onRecoverableError)),t=zc(e,1,!1,null,0,r,0,a,n),e[fn]=t.current,Ua(8===e.nodeType?e.parentNode:e),new Qc(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(s(188));throw e=Object.keys(e).join(","),Error(s(268,e))}return e=null===(e=Ge(t))?null:e.stateNode},t.flushSync=function(e){return dc(e)},t.hydrate=function(e,t,r){if(!Jc(t))throw Error(s(200));return $c(null,e,t,!0,r)},t.hydrateRoot=function(e,t,r){if(!Xc(e))throw Error(s(405));var a=null!=r&&r.hydratedSources||null,n=!1,i="",o=Kc;if(null!==r&&void 0!==r&&(!0===r.unstable_strictMode&&(n=!0),void 0!==r.identifierPrefix&&(i=r.identifierPrefix),void 0!==r.onRecoverableError&&(o=r.onRecoverableError)),t=Vc(t,null,e,1,null!=r?r:null,n,0,i,o),e[fn]=t.current,Ua(e),a)for(e=0;e<a.length;e++)n=(n=(r=a[e])._getVersion)(r._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[r,n]:t.mutableSourceEagerHydrationData.push(r,n);return new Yc(t)},t.render=function(e,t,r){if(!Jc(t))throw Error(s(200));return $c(null,e,t,!1,r)},t.unmountComponentAtNode=function(e){if(!Jc(e))throw Error(s(40));return!!e._reactRootContainer&&(dc(function(){$c(null,null,e,!1,function(){e._reactRootContainer=null,e[fn]=null})}),!0)},t.unstable_batchedUpdates=cc,t.unstable_renderSubtreeIntoContainer=function(e,t,r,a){if(!Jc(r))throw Error(s(200));if(null==e||void 0===e._reactInternals)throw Error(s(38));return $c(e,t,r,!1,a)},t.version="18.3.1-next-f1338f8080-20240426"},8406:function(e,t,r){e.exports=function(e){return e.pad.NoPadding={pad:function(){},unpad:function(){}},e.pad.NoPadding}(r(4703),r(7755))},8791:(e,t,r)=>{"use strict";r.d(t,{KO:()=>$,MF:()=>X,Sx:()=>Z,Wp:()=>J,j6:()=>G,om:()=>H,xZ:()=>W});var a=r(9379),n=r(6863),s=r(2226),i=r(498),o=r(4272);class l{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(function(e){const t=e.getComponent();return"VERSION"===(null===t||void 0===t?void 0:t.type)}(e)){const t=e.getImmediate();return"".concat(t.library,"/").concat(t.version)}return null}).filter(e=>e).join(" ")}}const c="@firebase/app",d="0.14.2",u=new s.Vy("@firebase/app"),h="@firebase/app-compat",m="@firebase/analytics-compat",f="@firebase/analytics",g="@firebase/app-check-compat",p="@firebase/app-check",x="@firebase/auth",y="@firebase/auth-compat",v="@firebase/database",b="@firebase/data-connect",w="@firebase/database-compat",k="@firebase/functions",N="@firebase/functions-compat",j="@firebase/installations",S="@firebase/installations-compat",_="@firebase/messaging",E="@firebase/messaging-compat",A="@firebase/performance",C="@firebase/performance-compat",I="@firebase/remote-config",T="@firebase/remote-config-compat",D="@firebase/storage",P="@firebase/storage-compat",F="@firebase/firestore",L="@firebase/ai",M="@firebase/firestore-compat",R="firebase",O="[DEFAULT]",B={[c]:"fire-core",[h]:"fire-core-compat",[f]:"fire-analytics",[m]:"fire-analytics-compat",[p]:"fire-app-check",[g]:"fire-app-check-compat",[x]:"fire-auth",[y]:"fire-auth-compat",[v]:"fire-rtdb",[b]:"fire-data-connect",[w]:"fire-rtdb-compat",[k]:"fire-fn",[N]:"fire-fn-compat",[j]:"fire-iid",[S]:"fire-iid-compat",[_]:"fire-fcm",[E]:"fire-fcm-compat",[A]:"fire-perf",[C]:"fire-perf-compat",[I]:"fire-rc",[T]:"fire-rc-compat",[D]:"fire-gcs",[P]:"fire-gcs-compat",[F]:"fire-fst",[M]:"fire-fst-compat",[L]:"fire-vertex","fire-js":"fire-js",[R]:"fire-js-all"},z=new Map,U=new Map,V=new Map;function q(e,t){try{e.container.addComponent(t)}catch(r){u.debug("Component ".concat(t.name," failed to register with FirebaseApp ").concat(e.name),r)}}function H(e){const t=e.name;if(V.has(t))return u.debug("There were multiple attempts to register component ".concat(t,".")),!1;V.set(t,e);for(const r of z.values())q(r,e);for(const r of U.values())q(r,e);return!0}function G(e,t){const r=e.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),e.container.getProvider(t)}function W(e){return null!==e&&void 0!==e&&void 0!==e.settings}const K={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Q=new i.FA("app","Firebase",K);class Y{constructor(e,t,r){this._isDeleted=!1,this._options=(0,a.A)({},e),this._config=(0,a.A)({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new n.uA("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Q.create("app-deleted",{appName:this._name})}}const X="12.2.0";function J(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e;if("object"!==typeof t){t={name:t}}const s=(0,a.A)({name:O,automaticDataCollectionEnabled:!0},t),o=s.name;if("string"!==typeof o||!o)throw Q.create("bad-app-name",{appName:String(o)});if(r||(r=(0,i.T9)()),!r)throw Q.create("no-options");const l=z.get(o);if(l){if((0,i.bD)(r,l.options)&&(0,i.bD)(s,l.config))return l;throw Q.create("duplicate-app",{appName:o})}const c=new n.h1(o);for(const a of V.values())c.addComponent(a);const d=new Y(r,s,c);return z.set(o,d),d}function Z(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:O;const t=z.get(e);if(!t&&e===O&&(0,i.T9)())return J();if(!t)throw Q.create("no-app",{appName:e});return t}function $(e,t,r){var a;let s=null!==(a=B[e])&&void 0!==a?a:e;r&&(s+="-".concat(r));const i=s.match(/\s|\//),o=t.match(/\s|\//);if(i||o){const e=['Unable to register library "'.concat(s,'" with version "').concat(t,'":')];return i&&e.push('library name "'.concat(s,'" contains illegal characters (whitespace or "/")')),i&&o&&e.push("and"),o&&e.push('version name "'.concat(t,'" contains illegal characters (whitespace or "/")')),void u.warn(e.join(" "))}H(new n.uA("".concat(s,"-version"),()=>({library:s,version:t}),"VERSION"))}const ee="firebase-heartbeat-store";let te=null;function re(){return te||(te=(0,o.openDB)("firebase-heartbeat-database",1,{upgrade:(e,t)=>{if(0===t)try{e.createObjectStore(ee)}catch(r){console.warn(r)}}}).catch(e=>{throw Q.create("idb-open",{originalErrorMessage:e.message})})),te}async function ae(e,t){try{const r=(await re()).transaction(ee,"readwrite"),a=r.objectStore(ee);await a.put(t,ne(e)),await r.done}catch(r){if(r instanceof i.g)u.warn(r.message);else{const e=Q.create("idb-set",{originalErrorMessage:null===r||void 0===r?void 0:r.message});u.warn(e.message)}}}function ne(e){return"".concat(e.name,"!").concat(e.options.appId)}class se{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new oe(t),this._heartbeatsCachePromise=this._storage.read().then(e=>(this._heartbeatsCache=e,e))}async triggerHeartbeat(){try{var e;const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),a=ie();var t;if(null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats))if(this._heartbeatsCache=await this._heartbeatsCachePromise,null==(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats))return;if(this._heartbeatsCache.lastSentHeartbeatDate===a||this._heartbeatsCache.heartbeats.some(e=>e.date===a))return;if(this._heartbeatsCache.heartbeats.push({date:a,agent:r}),this._heartbeatsCache.heartbeats.length>30){const e=function(e){if(0===e.length)return-1;let t=0,r=e[0].date;for(let a=1;a<e.length;a++)e[a].date<r&&(r=e[a].date,t=a);return t}(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(e,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){u.warn(r)}}async getHeartbeatsHeader(){try{var e;if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)||0===this._heartbeatsCache.heartbeats.length)return"";const t=ie(),{heartbeatsToSend:r,unsentEntries:a}=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024;const r=[];let a=e.slice();for(const n of e){const e=r.find(e=>e.agent===n.agent);if(e){if(e.dates.push(n.date),le(r)>t){e.dates.pop();break}}else if(r.push({agent:n.agent,dates:[n.date]}),le(r)>t){r.pop();break}a=a.slice(1)}return{heartbeatsToSend:r,unsentEntries:a}}(this._heartbeatsCache.heartbeats),n=(0,i.Uj)(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,a.length>0?(this._heartbeatsCache.heartbeats=a,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),n}catch(t){return u.warn(t),""}}}function ie(){return(new Date).toISOString().substring(0,10)}class oe{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!(0,i.zW)()&&(0,i.eX)().then(()=>!0).catch(()=>!1)}async read(){if(await this._canUseIndexedDBPromise){const e=await async function(e){try{const t=(await re()).transaction(ee),r=await t.objectStore(ee).get(ne(e));return await t.done,r}catch(t){if(t instanceof i.g)u.warn(t.message);else{const e=Q.create("idb-get",{originalErrorMessage:null===t||void 0===t?void 0:t.message});u.warn(e.message)}}}(this.app);return null!==e&&void 0!==e&&e.heartbeats?e:{heartbeats:[]}}return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){var t;const r=await this.read();return ae(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){if(await this._canUseIndexedDBPromise){var t;const r=await this.read();return ae(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}}}function le(e){return(0,i.Uj)(JSON.stringify({version:2,heartbeats:e})).length}var ce;ce="",H(new n.uA("platform-logger",e=>new l(e),"PRIVATE")),H(new n.uA("heartbeat",e=>new se(e),"PRIVATE")),$(c,d,ce),$(c,d,"esm2020"),$("fire-js","")},9034:(e,t,r)=>{"use strict";r.d(t,{default:()=>i});var a=r(9379);const n="pending-operations",s="cached-data";const i=new class{constructor(){this.db=null,this.isOnline=navigator.onLine,this.syncInProgress=!1,this.listeners=new Set,this.initDatabase(),this.setupOnlineListener()}async initDatabase(){return new Promise((e,t)=>{const r=indexedDB.open("workflow-offline-db",1);r.onerror=()=>{console.error("\u274c Erro ao abrir IndexedDB:",r.error),t(r.error)},r.onsuccess=()=>{this.db=r.result,console.log("\u2705 IndexedDB inicializado"),e(this.db)},r.onupgradeneeded=e=>{const t=e.target.result;if(!t.objectStoreNames.contains(n)){const e=t.createObjectStore(n,{keyPath:"id",autoIncrement:!0});e.createIndex("timestamp","timestamp",{unique:!1}),e.createIndex("type","type",{unique:!1})}if(!t.objectStoreNames.contains(s)){t.createObjectStore(s,{keyPath:"key"}).createIndex("timestamp","timestamp",{unique:!1})}console.log("\ud83d\udce6 Stores do IndexedDB criados")}})}setupOnlineListener(){window.addEventListener("online",()=>{console.log("\ud83c\udf10 Conex\xe3o restaurada!"),this.isOnline=!0,this.notifyListeners("online"),this.syncPendingOperations()}),window.addEventListener("offline",()=>{console.log("\ud83d\udcf4 Sem conex\xe3o! Modo offline ativado."),this.isOnline=!1,this.notifyListeners("offline")})}addStatusListener(e){return this.listeners.add(e),()=>this.listeners.delete(e)}notifyListeners(e){this.listeners.forEach(t=>{try{t(e,this.isOnline)}catch(r){console.error("Erro ao notificar listener:",r)}})}async savePendingOperation(e){return this.db||await this.initDatabase(),new Promise((t,s)=>{const i=this.db.transaction([n],"readwrite").objectStore(n),o=(0,a.A)((0,a.A)({},e),{},{timestamp:Date.now(),synced:!1}),l=i.add(o);l.onsuccess=async()=>{console.log("\ud83d\udcbe Opera\xe7\xe3o salva para sincroniza\xe7\xe3o:",e.type);try{const{default:e}=await r.e(142).then(r.bind(r,5142));e.isConnected&&(console.log("\ud83d\udce1 Tentando sincronizar via Bluetooth..."),await e.syncWithPeer())}catch(a){console.log("\u2139\ufe0f Bluetooth n\xe3o dispon\xedvel para sincroniza\xe7\xe3o")}t(l.result)},l.onerror=()=>{console.error("\u274c Erro ao salvar opera\xe7\xe3o:",l.error),s(l.error)}})}async getPendingOperations(){return this.db||await this.initDatabase(),new Promise((e,t)=>{const r=this.db.transaction([n],"readonly").objectStore(n).getAll();r.onsuccess=()=>{const t=r.result.filter(e=>!e.synced);e(t)},r.onerror=()=>{t(r.error)}})}async markOperationSynced(e){return this.db||await this.initDatabase(),new Promise((t,r)=>{const a=this.db.transaction([n],"readwrite").objectStore(n),s=a.get(e);s.onsuccess=()=>{const n=s.result;if(n){n.synced=!0,n.syncedAt=Date.now();const s=a.put(n);s.onsuccess=()=>{console.log("\u2705 Opera\xe7\xe3o marcada como sincronizada:",e),t()},s.onerror=()=>{r(s.error)}}else t()},s.onerror=()=>{r(s.error)}})}async deleteOperation(e){return this.db||await this.initDatabase(),new Promise((t,r)=>{const a=this.db.transaction([n],"readwrite").objectStore(n).delete(e);a.onsuccess=()=>{t()},a.onerror=()=>{r(a.error)}})}async syncPendingOperations(){if(this.isOnline&&!this.syncInProgress){this.syncInProgress=!0,console.log("\ud83d\udd04 Iniciando sincroniza\xe7\xe3o de opera\xe7\xf5es pendentes...");try{const t=await this.getPendingOperations();if(0===t.length)return console.log("\u2705 Nenhuma opera\xe7\xe3o pendente para sincronizar"),void(this.syncInProgress=!1);console.log("\ud83d\udce4 Sincronizando ".concat(t.length," opera\xe7\xf5es..."));let r=0,a=0;for(const n of t)try{await this.executeOperation(n),await this.markOperationSynced(n.id),r++}catch(e){console.error("\u274c Erro ao sincronizar opera\xe7\xe3o:",e),a++}console.log("\u2705 Sincroniza\xe7\xe3o completa: ".concat(r," sucesso, ").concat(a," erros")),this.notifyListeners("synced",{syncedCount:r,errorCount:a})}catch(e){console.error("\u274c Erro na sincroniza\xe7\xe3o:",e)}finally{this.syncInProgress=!1}}}async executeOperation(e){const{type:t,data:a,collection:n,id:s}=e,{db:i}=await Promise.resolve().then(r.bind(r,2410)),{doc:o,setDoc:l,updateDoc:c,deleteDoc:d,collection:u}=await Promise.resolve().then(r.bind(r,306));switch(t){case"create":await l(o(u(i,n),s),a);break;case"update":await c(o(i,n,s),a);break;case"delete":await d(o(i,n,s));break;default:console.warn("Tipo de opera\xe7\xe3o desconhecido:",t)}}async cacheData(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:36e5;return this.db||await this.initDatabase(),new Promise((a,n)=>{const i=this.db.transaction([s],"readwrite").objectStore(s),o={key:e,data:t,timestamp:Date.now(),expiresAt:Date.now()+r},l=i.put(o);l.onsuccess=()=>{a()},l.onerror=()=>{n(l.error)}})}async getCachedData(e){return this.db||await this.initDatabase(),new Promise((t,r)=>{const a=this.db.transaction([s],"readonly").objectStore(s).get(e);a.onsuccess=()=>{const r=a.result;if(r)return Date.now()>r.expiresAt?(console.log("\u23f0 Cache expirado:",e),void t(null)):void t(r.data);t(null)},a.onerror=()=>{r(a.error)}})}async clearExpiredCache(){return this.db||await this.initDatabase(),new Promise((e,t)=>{const r=this.db.transaction([s],"readwrite").objectStore(s).openCursor();let a=0;r.onsuccess=t=>{const r=t.target.result;if(r){const e=r.value;Date.now()>e.expiresAt&&(r.delete(),a++),r.continue()}else console.log("\ud83e\uddf9 ".concat(a," itens de cache expirados removidos")),e(a)},r.onerror=()=>{t(r.error)}})}async getPendingCount(){return(await this.getPendingOperations()).length}checkOnlineStatus(){return this.isOnline}}},9045:(e,t,r)=>{var a=r(3738).default;e.exports=function(e,t){if("object"!=a(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=a(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)},e.exports.__esModule=!0,e.exports.default=e.exports},9210:function(e,t,r){e.exports=function(e){return e}(r(4703),r(4654),r(6810),r(7353),r(3988),r(9367),r(7766),r(2689),r(7427),r(4798),r(4290),r(6883),r(7055),r(6290),r(9787),r(5425),r(7020),r(7755),r(167),r(1045),r(7118),r(9907),r(2768),r(7279),r(4239),r(6008),r(9321),r(8406),r(1115),r(3137),r(4774),r(5003),r(676),r(4278),r(6722))},9321:function(e,t,r){e.exports=function(e){return e.pad.ZeroPadding={pad:function(e,t){var r=4*t;e.clamp(),e.sigBytes+=r-(e.sigBytes%r||r)},unpad:function(e){var t=e.words,r=e.sigBytes-1;for(r=e.sigBytes-1;r>=0;r--)if(t[r>>>2]>>>24-r%4*8&255){e.sigBytes=r+1;break}}},e.pad.ZeroPadding}(r(4703),r(7755))},9329:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(7511);Object.keys(a).forEach(function(e){"default"===e||t.hasOwnProperty(e)||Object.defineProperty(t,e,{enumerable:!0,get:function(){return a[e]}})})},9367:function(e,t,r){e.exports=function(e){return function(){var t=e,r=t.lib.WordArray;function a(e,t,a){for(var n=[],s=0,i=0;i<t;i++)if(i%4){var o=a[e.charCodeAt(i-1)]<<i%4*2|a[e.charCodeAt(i)]>>>6-i%4*2;n[s>>>2]|=o<<24-s%4*8,s++}return r.create(n,s)}t.enc.Base64url={stringify:function(e,t){void 0===t&&(t=!0);var r=e.words,a=e.sigBytes,n=t?this._safe_map:this._map;e.clamp();for(var s=[],i=0;i<a;i+=3)for(var o=(r[i>>>2]>>>24-i%4*8&255)<<16|(r[i+1>>>2]>>>24-(i+1)%4*8&255)<<8|r[i+2>>>2]>>>24-(i+2)%4*8&255,l=0;l<4&&i+.75*l<a;l++)s.push(n.charAt(o>>>6*(3-l)&63));var c=n.charAt(64);if(c)for(;s.length%4;)s.push(c);return s.join("")},parse:function(e,t){void 0===t&&(t=!0);var r=e.length,n=t?this._safe_map:this._map,s=this._reverseMap;if(!s){s=this._reverseMap=[];for(var i=0;i<n.length;i++)s[n.charCodeAt(i)]=i}var o=n.charAt(64);if(o){var l=e.indexOf(o);-1!==l&&(r=l)}return a(e,r,s)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",_safe_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_"}}(),e.enc.Base64url}(r(4703))},9379:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});var a=r(4980);function n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,a)}return r}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?n(Object(r),!0).forEach(function(t){(0,a.A)(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}},9661:(e,t,r)=>{"use strict";r.d(t,{Yc:()=>a});const a=e=>{try{const t={NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_ENV:"production"}.REACT_APP_FIREBASE_API_KEY||"",r=atob(e);let a="";for(let e=0;e<r.length;e++)a+=String.fromCharCode(r.charCodeAt(e)^t.charCodeAt(e%t.length));return a}catch(t){return e}}},9787:function(e,t,r){e.exports=function(e){!function(){var t=e,r=t.lib.Base,a=t.enc.Utf8;t.algo.HMAC=r.extend({init:function(e,t){e=this._hasher=new e.init,"string"==typeof t&&(t=a.parse(t));var r=e.blockSize,n=4*r;t.sigBytes>n&&(t=e.finalize(t)),t.clamp();for(var s=this._oKey=t.clone(),i=this._iKey=t.clone(),o=s.words,l=i.words,c=0;c<r;c++)o[c]^=1549556828,l[c]^=909522486;s.sigBytes=i.sigBytes=n,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher,r=t.finalize(e);return t.reset(),t.finalize(this._oKey.clone().concat(r))}})}()}(r(4703))},9907:function(e,t,r){e.exports=function(e){return e.mode.OFB=function(){var t=e.lib.BlockCipherMode.extend(),r=t.Encryptor=t.extend({processBlock:function(e,t){var r=this._cipher,a=r.blockSize,n=this._iv,s=this._keystream;n&&(s=this._keystream=n.slice(0),this._iv=void 0),r.encryptBlock(s,0);for(var i=0;i<a;i++)e[t+i]^=s[i]}});return t.Decryptor=r,t}(),e.mode.OFB}(r(4703),r(7755))},9950:(e,t,r)=>{"use strict";e.exports=r(2049)},9976:()=>{}},t={};function r(a){var n=t[a];if(void 0!==n)return n.exports;var s=t[a]={exports:{}};return e[a].call(s.exports,s,s.exports,r),s.exports}r.m=e,r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;r.t=function(a,n){if(1&n&&(a=this(a)),8&n)return a;if("object"===typeof a&&a){if(4&n&&a.__esModule)return a;if(16&n&&"function"===typeof a.then)return a}var s=Object.create(null);r.r(s);var i={};e=e||[null,t({}),t([]),t(t)];for(var o=2&n&&a;("object"==typeof o||"function"==typeof o)&&!~e.indexOf(o);o=t(o))Object.getOwnPropertyNames(o).forEach(e=>i[e]=()=>a[e]);return i.default=()=>a,r.d(s,i),s}})(),r.d=(e,t)=>{for(var a in t)r.o(t,a)&&!r.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},r.f={},r.e=e=>Promise.all(Object.keys(r.f).reduce((t,a)=>(r.f[a](e,t),t),[])),r.u=e=>"static/js/"+e+"."+{52:"4b0f1ba7",82:"c3721bc9",142:"ba4a3a25",239:"aa75864e",344:"05800c68",914:"347610bb"}[e]+".chunk.js",r.miniCssF=e=>{},r.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={},t="workflow-control:";r.l=(a,n,s,i)=>{if(e[a])e[a].push(n);else{var o,l;if(void 0!==s)for(var c=document.getElementsByTagName("script"),d=0;d<c.length;d++){var u=c[d];if(u.getAttribute("src")==a||u.getAttribute("data-webpack")==t+s){o=u;break}}o||(l=!0,(o=document.createElement("script")).charset="utf-8",o.timeout=120,r.nc&&o.setAttribute("nonce",r.nc),o.setAttribute("data-webpack",t+s),o.src=a),e[a]=[n];var h=(t,r)=>{o.onerror=o.onload=null,clearTimeout(m);var n=e[a];if(delete e[a],o.parentNode&&o.parentNode.removeChild(o),n&&n.forEach(e=>e(r)),t)return t(r)},m=setTimeout(h.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=h.bind(null,o.onerror),o.onload=h.bind(null,o.onload),l&&document.head.appendChild(o)}}})(),r.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.p="./",(()=>{var e={792:0};r.f.j=(t,a)=>{var n=r.o(e,t)?e[t]:void 0;if(0!==n)if(n)a.push(n[2]);else{var s=new Promise((r,a)=>n=e[t]=[r,a]);a.push(n[2]=s);var i=r.p+r.u(t),o=new Error;r.l(i,a=>{if(r.o(e,t)&&(0!==(n=e[t])&&(e[t]=void 0),n)){var s=a&&("load"===a.type?"missing":a.type),i=a&&a.target&&a.target.src;o.message="Loading chunk "+t+" failed.\n("+s+": "+i+")",o.name="ChunkLoadError",o.type=s,o.request=i,n[1](o)}},"chunk-"+t,t)}};var t=(t,a)=>{var n,s,i=a[0],o=a[1],l=a[2],c=0;if(i.some(t=>0!==e[t])){for(n in o)r.o(o,n)&&(r.m[n]=o[n]);if(l)l(r)}for(t&&t(a);c<i.length;c++)s=i[c],r.o(e,s)&&e[s]&&e[s][0](),e[s]=0},a=self.webpackChunkworkflow_control=self.webpackChunkworkflow_control||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))})(),(()=>{"use strict";var e=r(9950),t=r(1352),a=r(3986),n=r(9379),s=r(306),i=r(815),o=r(2644);const l=e=>{try{return btoa(encodeURIComponent(e)).split("").reverse().join("")}catch(t){return e}},c=()=>"_"+Math.random().toString(36).slice(2),d={enabled:!0,preventInspect:!0,preventConsole:!0,preventSourceMap:!0,clearDataOnDetection:!0,checkInterval:1e3,sizeThreshold:160},u=(c(),c(),c(),c(),c(),c(),c(),c(),"\n      default-src 'self';\n      script-src 'self' https://apis.google.com;\n      style-src 'self' 'unsafe-inline';\n      img-src 'self' data: https:;\n      font-src 'self';\n      object-src 'none';\n      base-uri 'self';\n      form-action 'self';\n      frame-ancestors 'none';\n    ".replace(/\s+/g," ").trim(),()=>{const[t,r]=(0,e.useState)(!1);return(0,e.useEffect)(()=>{if(!d.enabled)return;const e=(0,n.A)({},console);if(d.preventConsole){const e=()=>{};Object.keys(console).forEach(t=>{try{console[t]=e}catch(r){}})}window.addEventListener("error",e=>{e.error&&e.error.stack&&(e.error.stack=l(e.error.stack)),e.message&&(e.message=l(e.message))}),d.preventInspect&&(document.addEventListener("contextmenu",e=>e.preventDefault()),document.addEventListener("keydown",e=>{(e.ctrlKey&&e.shiftKey&&("I"===e.key||"J"===e.key||"C"===e.key)||e.ctrlKey&&"U"===e.key||"F12"===e.key)&&e.preventDefault()}));let t=!1;const a=new Image;Object.defineProperty(a,"id",{get:function(){return t=!0,"devtools-detector"}});const s=()=>[(()=>{const e=window.outerWidth-window.innerWidth>300,t=window.outerHeight-window.innerHeight>300;return e||t})(),window.outerHeight-window.innerHeight>300||window.outerWidth-window.innerWidth>300,t,window.Firebug&&window.Firebug.chrome&&window.Firebug.chrome.isInitialized].filter(Boolean).length>=2||(requestAnimationFrame(()=>{console.log("%c",a)}),!1),i=setInterval(()=>{s()&&(clearInterval(i),(()=>{console.log("\ud83d\udea8 DevTools detectado - Sistema bloqueado"),r(!0),document.body.innerHTML="";const e=document.createElement("div");e.style.cssText="\n        position: fixed;\n        top: 0;\n        left: 0;\n        width: 100vw;\n        height: 100vh;\n        background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%);\n        display: flex;\n        flex-direction: column;\n        align-items: center;\n        justify-content: center;\n        z-index: 999999;\n        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\n      ",e.innerHTML='\n        <div style="text-align: center; color: white; max-width: 600px; padding: 40px;">\n          <div style="font-size: 80px; margin-bottom: 20px;">\ud83d\udee1\ufe0f</div>\n          <h1 style="font-size: 32px; margin-bottom: 20px; color: #ef4444;">Acesso Bloqueado</h1>\n          <p style="font-size: 18px; color: #cbd5e1; margin-bottom: 30px;">\n            Ferramentas de desenvolvedor foram detectadas.\n          </p>\n          <p style="font-size: 14px; color: #94a3b8; margin-bottom: 20px;">\n            Este sistema possui prote\xe7\xe3o ativa contra inspe\xe7\xe3o n\xe3o autorizada.\n          </p>\n          <div style="background: rgba(239, 68, 68, 0.1); border: 1px solid rgba(239, 68, 68, 0.3); border-radius: 8px; padding: 20px; margin-top: 30px;">\n            <p style="font-size: 13px; color: #fca5a5; margin: 0;">\n              \u26a0\ufe0f Feche as ferramentas de desenvolvedor e recarregue a p\xe1gina para continuar.\n            </p>\n          </div>\n          <button onclick="location.reload()" style="\n            margin-top: 30px;\n            padding: 12px 24px;\n            background: #3b82f6;\n            color: white;\n            border: none;\n            border-radius: 6px;\n            font-size: 16px;\n            cursor: pointer;\n            transition: background 0.2s;\n          " onmouseover="this.style.background=\'#2563eb\'" onmouseout="this.style.background=\'#3b82f6\'">\n            Recarregar P\xe1gina\n          </button>\n        </div>\n      ',document.body.appendChild(e),document.addEventListener("DOMContentLoaded",e=>e.stopImmediatePropagation(),!0),window.addEventListener("load",e=>e.stopImmediatePropagation(),!0);const t=document.getElementsByTagName("script");for(let r of t)r.remove();const a=document.getElementById("root");throw a&&(a.innerHTML=""),new Error("DevTools detected - System blocked")})())},1e3);return["fetch","setTimeout","setInterval"].forEach(e=>{try{window[e]=(e=>{try{const t="_"+Math.random().toString(36).slice(2);return Object.defineProperty(e,"name",{value:t}),e}catch(t){return e}})(window[e])}catch(t){}}),()=>{clearInterval(i),d.preventConsole&&Object.keys(e).forEach(t=>{try{console[t]=e[t]}catch(r){}})}},[]),t}),h=e=>{const t=(e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase()))(e);return t.charAt(0).toUpperCase()+t.slice(1)},m=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.filter((e,t,r)=>Boolean(e)&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim()};var f={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const g=["color","size","strokeWidth","absoluteStrokeWidth","className","children","iconNode"],p=(0,e.forwardRef)((t,r)=>{let{color:s="currentColor",size:i=24,strokeWidth:o=2,absoluteStrokeWidth:l,className:c="",children:d,iconNode:u}=t,h=(0,a.A)(t,g);return(0,e.createElement)("svg",(0,n.A)((0,n.A)((0,n.A)({ref:r},f),{},{width:i,height:i,stroke:s,strokeWidth:l?24*Number(o)/Number(i):o,className:m("lucide",c)},!d&&!(e=>{for(const t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0})(h)&&{"aria-hidden":"true"}),h),[...u.map(t=>{let[r,a]=t;return(0,e.createElement)(r,a)}),...Array.isArray(d)?d:[d]])}),x=["className"],y=(t,r)=>{const s=(0,e.forwardRef)((s,i)=>{let{className:o}=s,l=(0,a.A)(s,x);return(0,e.createElement)(p,(0,n.A)({ref:i,iconNode:r,className:m("lucide-".concat((c=h(t),c.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase())),"lucide-".concat(t),o)},l));var c});return s.displayName=h(t),s},v=y("circle-check",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),b=y("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),w=y("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);var k=r(4414);const N={success:{icon:v,bgColor:"bg-green-50",textColor:"text-green-800",borderColor:"border-green-200",iconColor:"text-green-600"},error:{icon:b,bgColor:"bg-red-50",textColor:"text-red-800",borderColor:"border-red-200",iconColor:"text-red-600"},warning:{icon:w,bgColor:"bg-yellow-50",textColor:"text-yellow-800",borderColor:"border-yellow-200",iconColor:"text-yellow-600"},info:{icon:w,bgColor:"bg-blue-50",textColor:"text-blue-800",borderColor:"border-blue-200",iconColor:"text-blue-600"}},j=t=>{let{message:r,variant:a="success",onClose:n}=t;const[s,i]=(0,e.useState)(!0),[o,l]=(0,e.useState)(!1);(0,e.useEffect)(()=>{const e=setTimeout(()=>{l(!0),setTimeout(()=>{i(!1),null===n||void 0===n||n()},300)},5e3);return()=>clearTimeout(e)},[n]);const c=N[a],d=c.icon;return(0,e.useEffect)(()=>{const e=setTimeout(()=>{l(!0),setTimeout(()=>{i(!1),n&&n()},300)},5e3);return()=>clearTimeout(e)},[n]),s?(0,k.jsxs)("div",{className:"\n      fixed top-4 right-4 z-50 flex items-center gap-2 px-4 py-3 rounded-lg border shadow-lg\n      transform transition-all duration-300 ease-in-out\n      ".concat(o?"opacity-0 translate-x-2":"opacity-100 translate-x-0","\n      transition-all duration-300 transform\n      ").concat(o?"opacity-0 translate-x-full":"opacity-100 translate-x-0","\n      ").concat(c.bgColor," ").concat(c.textColor," ").concat(c.borderColor,"\n    "),children:[(0,k.jsx)(d,{className:"w-5 h-5 ".concat(c.iconColor," ").concat(o?"":"animate-bounce")}),(0,k.jsx)("p",{className:"text-sm font-medium",children:r})]}):null},S=(0,e.createContext)(null),_=()=>{const t=(0,e.useContext)(S);if(!t)throw new Error("useToast must be used within a ToastProvider");return t},E=t=>{let{children:r}=t;const[a,n]=(0,e.useState)([]),s=(0,e.useCallback)(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success";const r=Date.now();n(a=>[...a,{id:r,message:e,variant:t}])},[]),i=(0,e.useCallback)(e=>{n(t=>t.filter(t=>t.id!==e))},[]);return(0,k.jsxs)(S.Provider,{value:{showToast:s},children:[r,(0,k.jsx)("div",{className:"fixed top-0 right-0 z-50 p-4 space-y-4",children:a.map(e=>(0,k.jsx)(j,{message:e.message,variant:e.variant,onClose:()=>i(e.id)},e.id))})]})},A=y("file-text",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]),C=y("book",[["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20",key:"k3hazp"}]]),I=y("shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]),T=y("user-check",[["path",{d:"m16 11 2 2 4-4",key:"9rsbq5"}],["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]]),D=y("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);var P=r(2410),F=r(9210),L=r.n(F);const M={NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_ENV:"production"}.REACT_APP_CRYPTO_SECRET;console.log("\ud83d\udd11 Crypto: APP_SECRET configurado:",M?"SIM \u2705":"N\xc3O \u274c"),console.log("\ud83c\udf0d Crypto: Environment:","production"),M||(console.error("\u274c ERRO CR\xcdTICO: REACT_APP_CRYPTO_SECRET n\xe3o est\xe1 definido no Vercel!"),console.error("\u26a0\ufe0f As senhas SHA-512 N\xc3O funcionar\xe3o sem esta vari\xe1vel!"),console.error("\ud83d\udccb Solu\xe7\xe3o: Configure REACT_APP_CRYPTO_SECRET=workflow-garden-secure-key-2025 no Vercel"));const R=()=>L().lib.WordArray.random(16).toString(),O=function(){const e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"")||R();return((e,t)=>L().PBKDF2(e,t,{keySize:8,iterations:1e4}))(M,e).toString()},B=e=>{const t=R();return{hash:L().SHA512(e+t+M).toString(),salt:t,version:2,algorithm:"SHA-512"}},z=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";try{const r=O(t),a={data:JSON.stringify(e),timestamp:Date.now(),appSignature:L().SHA512(M).toString().slice(0,32)};return{content:L().AES.encrypt(JSON.stringify(a),r).toString(),salt:t,timestamp:Date.now()}}catch(r){throw console.error("Erro ao encriptar dados:",r),new Error("Falha na encripta\xe7\xe3o dos dados")}},U=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";try{const{content:r,timestamp:a}=e,n=O(t),s=L().AES.decrypt(r,n).toString(L().enc.Utf8),i=JSON.parse(s),o=L().SHA512(M).toString().slice(0,32);if(i.appSignature!==o)throw new Error("Assinatura do aplicativo inv\xe1lida");if(Date.now()-i.timestamp>864e5)throw new Error("Dados expirados");return JSON.parse(i.data)}catch(r){throw console.error("Erro ao decriptar dados:",r),new Error("Falha na decripta\xe7\xe3o dos dados")}},V=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";const t=Date.now(),r=Math.random().toString(),a=(n="".concat(t,"-").concat(r,"-").concat(M),L().SHA512(n.toString()).toString());var n;return"".concat(e).concat(a.slice(0,16))};var q=r(8791),H=r(2226),G=r(498),W=r(6863),K=r(4272);const Q="@firebase/installations",Y="0.6.19",J=1e4,Z="w:".concat(Y),$="FIS_v2",ee=36e5,te={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},re=new G.FA("installations","Installations",te);function ae(e){return e instanceof G.g&&e.code.includes("request-failed")}function ne(e){let{projectId:t}=e;return"".concat("https://firebaseinstallations.googleapis.com/v1","/projects/").concat(t,"/installations")}function se(e){return{token:e.token,requestStatus:2,expiresIn:(t=e.expiresIn,Number(t.replace("s","000"))),creationTime:Date.now()};var t}async function ie(e,t){const r=(await t.json()).error;return re.create("request-failed",{requestName:e,serverCode:r.code,serverMessage:r.message,serverStatus:r.status})}function oe(e){let{apiKey:t}=e;return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function le(e,t){let{refreshToken:r}=t;const a=oe(e);return a.append("Authorization",function(e){return"".concat($," ").concat(e)}(r)),a}async function ce(e){const t=await e();return t.status>=500&&t.status<600?e():t}function de(e){return new Promise(t=>{setTimeout(t,e)})}const ue=/^[cdef][\w-]{21}$/;function he(){try{const e=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(e),e[0]=112+e[0]%16;const t=function(e){const t=(r=e,btoa(String.fromCharCode(...r)).replace(/\+/g,"-").replace(/\//g,"_"));var r;return t.substr(0,22)}(e);return ue.test(t)?t:""}catch(e){return""}}function me(e){return"".concat(e.appName,"!").concat(e.appId)}const fe=new Map;function ge(e,t){const r=me(e);pe(r,t),function(e,t){const r=ye();r&&r.postMessage({key:e,fid:t});ve()}(r,t)}function pe(e,t){const r=fe.get(e);if(r)for(const a of r)a(t)}let xe=null;function ye(){return!xe&&"BroadcastChannel"in self&&(xe=new BroadcastChannel("[Firebase] FID Change"),xe.onmessage=e=>{pe(e.data.key,e.data.fid)}),xe}function ve(){0===fe.size&&xe&&(xe.close(),xe=null)}const be="firebase-installations-store";let we=null;function ke(){return we||(we=(0,K.openDB)("firebase-installations-database",1,{upgrade:(e,t)=>{if(0===t)e.createObjectStore(be)}})),we}async function Ne(e,t){const r=me(e),a=(await ke()).transaction(be,"readwrite"),n=a.objectStore(be),s=await n.get(r);return await n.put(t,r),await a.done,s&&s.fid===t.fid||ge(e,t.fid),t}async function je(e){const t=me(e),r=(await ke()).transaction(be,"readwrite");await r.objectStore(be).delete(t),await r.done}async function Se(e,t){const r=me(e),a=(await ke()).transaction(be,"readwrite"),n=a.objectStore(be),s=await n.get(r),i=t(s);return void 0===i?await n.delete(r):await n.put(i,r),await a.done,!i||s&&s.fid===i.fid||ge(e,i.fid),i}async function _e(e){let t;const r=await Se(e.appConfig,r=>{const a=function(e){const t=e||{fid:he(),registrationStatus:0};return Ce(t)}(r),n=function(e,t){if(0===t.registrationStatus){if(!navigator.onLine){return{installationEntry:t,registrationPromise:Promise.reject(re.create("app-offline"))}}const r={fid:t.fid,registrationStatus:1,registrationTime:Date.now()},a=async function(e,t){try{const r=await async function(e,t){let{appConfig:r,heartbeatServiceProvider:a}=e,{fid:n}=t;const s=ne(r),i=oe(r),o=a.getImmediate({optional:!0});if(o){const e=await o.getHeartbeatsHeader();e&&i.append("x-firebase-client",e)}const l={fid:n,authVersion:$,appId:r.appId,sdkVersion:Z},c={method:"POST",headers:i,body:JSON.stringify(l)},d=await ce(()=>fetch(s,c));if(d.ok){const e=await d.json();return{fid:e.fid||n,registrationStatus:2,refreshToken:e.refreshToken,authToken:se(e.authToken)}}throw await ie("Create Installation",d)}(e,t);return Ne(e.appConfig,r)}catch(r){throw ae(r)&&409===r.customData.serverCode?await je(e.appConfig):await Ne(e.appConfig,{fid:t.fid,registrationStatus:0}),r}}(e,r);return{installationEntry:r,registrationPromise:a}}return 1===t.registrationStatus?{installationEntry:t,registrationPromise:Ee(e)}:{installationEntry:t}}(e,a);return t=n.registrationPromise,n.installationEntry});return""===r.fid?{installationEntry:await t}:{installationEntry:r,registrationPromise:t}}async function Ee(e){let t=await Ae(e.appConfig);for(;1===t.registrationStatus;)await de(100),t=await Ae(e.appConfig);if(0===t.registrationStatus){const{installationEntry:t,registrationPromise:r}=await _e(e);return r||t}return t}function Ae(e){return Se(e,e=>{if(!e)throw re.create("installation-not-found");return Ce(e)})}function Ce(e){return 1===(t=e).registrationStatus&&t.registrationTime+J<Date.now()?{fid:e.fid,registrationStatus:0}:e;var t}async function Ie(e,t){let{appConfig:r,heartbeatServiceProvider:a}=e;const n=function(e,t){let{fid:r}=t;return"".concat(ne(e),"/").concat(r,"/authTokens:generate")}(r,t),s=le(r,t),i=a.getImmediate({optional:!0});if(i){const e=await i.getHeartbeatsHeader();e&&s.append("x-firebase-client",e)}const o={installation:{sdkVersion:Z,appId:r.appId}},l={method:"POST",headers:s,body:JSON.stringify(o)},c=await ce(()=>fetch(n,l));if(c.ok){return se(await c.json())}throw await ie("Generate Auth Token",c)}async function Te(e){let t,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const a=await Se(e.appConfig,a=>{if(!Pe(a))throw re.create("not-registered");const s=a.authToken;if(!r&&function(e){return 2===e.requestStatus&&!function(e){const t=Date.now();return t<e.creationTime||e.creationTime+e.expiresIn<t+ee}(e)}(s))return a;if(1===s.requestStatus)return t=async function(e,t){let r=await De(e.appConfig);for(;1===r.authToken.requestStatus;)await de(100),r=await De(e.appConfig);const a=r.authToken;return 0===a.requestStatus?Te(e,t):a}(e,r),a;{if(!navigator.onLine)throw re.create("app-offline");const r=function(e){const t={requestStatus:1,requestTime:Date.now()};return(0,n.A)((0,n.A)({},e),{},{authToken:t})}(a);return t=async function(e,t){try{const r=await Ie(e,t),a=(0,n.A)((0,n.A)({},t),{},{authToken:r});return await Ne(e.appConfig,a),r}catch(r){if(!ae(r)||401!==r.customData.serverCode&&404!==r.customData.serverCode){const r=(0,n.A)((0,n.A)({},t),{},{authToken:{requestStatus:0}});await Ne(e.appConfig,r)}else await je(e.appConfig);throw r}}(e,r),r}});return t?await t:a.authToken}function De(e){return Se(e,e=>{if(!Pe(e))throw re.create("not-registered");const t=e.authToken;return 1===(r=t).requestStatus&&r.requestTime+J<Date.now()?(0,n.A)((0,n.A)({},e),{},{authToken:{requestStatus:0}}):e;var r})}function Pe(e){return void 0!==e&&2===e.registrationStatus}async function Fe(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const r=e;await async function(e){const{registrationPromise:t}=await _e(e);t&&await t}(r);return(await Te(r,t)).token}function Le(e){return re.create("missing-app-config-values",{valueName:e})}const Me="installations",Re=e=>{const t=e.getProvider("app").getImmediate(),r=function(e){if(!e||!e.options)throw Le("App Configuration");if(!e.name)throw Le("App Name");const t=["projectId","apiKey","appId"];for(const r of t)if(!e.options[r])throw Le(r);return{appName:e.name,projectId:e.options.projectId,apiKey:e.options.apiKey,appId:e.options.appId}}(t);return{app:t,appConfig:r,heartbeatServiceProvider:(0,q.j6)(t,"heartbeat"),_delete:()=>Promise.resolve()}},Oe=e=>{const t=e.getProvider("app").getImmediate(),r=(0,q.j6)(t,Me).getImmediate();return{getId:()=>async function(e){const t=e,{installationEntry:r,registrationPromise:a}=await _e(t);return a?a.catch(console.error):Te(t).catch(console.error),r.fid}(r),getToken:e=>Fe(r,e)}};(0,q.om)(new W.uA(Me,Re,"PUBLIC")),(0,q.om)(new W.uA("installations-internal",Oe,"PRIVATE")),(0,q.KO)(Q,Y),(0,q.KO)(Q,Y,"esm2020");const Be="analytics",ze="https://www.googletagmanager.com/gtag/js",Ue=new H.Vy("@firebase/analytics"),Ve={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},qe=new G.FA("analytics","Analytics",Ve);function He(e){if(!e.startsWith(ze)){const t=qe.create("invalid-gtag-resource",{gtagURL:e});return Ue.warn(t.message),""}return e}function Ge(e){return Promise.all(e.map(e=>e.catch(e=>e)))}function We(e,t){const r=function(e,t){let r;return window.trustedTypes&&(r=window.trustedTypes.createPolicy(e,t)),r}("firebase-js-sdk-policy",{createScriptURL:He}),a=document.createElement("script"),n="".concat(ze,"?l=").concat(e,"&id=").concat(t);a.src=r?null===r||void 0===r?void 0:r.createScriptURL(n):n,a.async=!0,document.head.appendChild(a)}function Ke(e,t,r,a){return async function(n){try{for(var s=arguments.length,i=new Array(s>1?s-1:0),o=1;o<s;o++)i[o-1]=arguments[o];if("event"===n){const[a,n]=i;await async function(e,t,r,a,n){try{let s=[];if(n&&n.send_to){let e=n.send_to;Array.isArray(e)||(e=[e]);const a=await Ge(r);for(const r of e){const e=a.find(e=>e.measurementId===r),n=e&&t[e.appId];if(!n){s=[];break}s.push(n)}}0===s.length&&(s=Object.values(t)),await Promise.all(s),e("event",a,n||{})}catch(s){Ue.error(s)}}(e,t,r,a,n)}else if("config"===n){const[n,s]=i;await async function(e,t,r,a,n,s){const i=a[n];try{if(i)await t[i];else{const e=(await Ge(r)).find(e=>e.measurementId===n);e&&await t[e.appId]}}catch(o){Ue.error(o)}e("config",n,s)}(e,t,r,a,n,s)}else if("consent"===n){const[t,r]=i;e("consent",t,r)}else if("get"===n){const[t,r,a]=i;e("get",t,r,a)}else if("set"===n){const[t]=i;e("set",t)}else e(n,...i)}catch(l){Ue.error(l)}}}const Qe=new class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}};function Ye(e){return new Headers({Accept:"application/json","x-goog-api-key":e})}async function Xe(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Qe,r=arguments.length>2?arguments[2]:void 0;const{appId:a,apiKey:n,measurementId:s}=e.options;if(!a)throw qe.create("no-app-id");if(!n){if(s)return{measurementId:s,appId:a};throw qe.create("no-api-key")}const i=t.getThrottleMetadata(a)||{backoffCount:0,throttleEndTimeMillis:Date.now()},o=new Ze;return setTimeout(async()=>{o.abort()},void 0!==r?r:6e4),Je({appId:a,apiKey:n,measurementId:s},i,o,t)}async function Je(e,t,r){let{throttleEndTimeMillis:a,backoffCount:n}=t,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Qe;const{appId:i,measurementId:o}=e;try{await function(e,t){return new Promise((r,a)=>{const n=Math.max(t-Date.now(),0),s=setTimeout(r,n);e.addEventListener(()=>{clearTimeout(s),a(qe.create("fetch-throttle",{throttleEndTimeMillis:t}))})})}(r,a)}catch(c){if(o)return Ue.warn("Timed out fetching this Firebase app's measurement ID from the server."+" Falling back to the measurement ID ".concat(o)+' provided in the "measurementId" field in the local Firebase config. ['.concat(null===c||void 0===c?void 0:c.message,"]")),{appId:i,measurementId:o};throw c}try{const t=await async function(e){const{appId:t,apiKey:r}=e,a={method:"GET",headers:Ye(r)},n="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig".replace("{app-id}",t),s=await fetch(n,a);if(200!==s.status&&304!==s.status){let e="";try{var i;const t=await s.json();null!==(i=t.error)&&void 0!==i&&i.message&&(e=t.error.message)}catch(o){}throw qe.create("config-fetch-failed",{httpStatus:s.status,responseMessage:e})}return s.json()}(e);return s.deleteThrottleMetadata(i),t}catch(c){var l;const t=c;if(!function(e){if(!(e instanceof G.g)||!e.customData)return!1;const t=Number(e.customData.httpStatus);return 429===t||500===t||503===t||504===t}(t)){if(s.deleteThrottleMetadata(i),o)return Ue.warn("Failed to fetch this Firebase app's measurement ID from the server."+" Falling back to the measurement ID ".concat(o)+' provided in the "measurementId" field in the local Firebase config. ['.concat(null===t||void 0===t?void 0:t.message,"]")),{appId:i,measurementId:o};throw c}const a=503===Number(null===t||void 0===t||null===(l=t.customData)||void 0===l?void 0:l.httpStatus)?(0,G.p9)(n,s.intervalMillis,30):(0,G.p9)(n,s.intervalMillis),d={throttleEndTimeMillis:Date.now()+a,backoffCount:n+1};return s.setThrottleMetadata(i,d),Ue.debug("Calling attemptFetch again in ".concat(a," millis")),Je(e,d,r,s)}}class Ze{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}let $e,et;function tt(e){et=e}function rt(e){$e=e}async function at(e,t,r,a,n,s,i){var o;const l=Xe(e);l.then(t=>{r[t.measurementId]=t.appId,e.options.measurementId&&t.measurementId!==e.options.measurementId&&Ue.warn("The measurement ID in the local Firebase config (".concat(e.options.measurementId,")")+" does not match the measurement ID fetched from the server (".concat(t.measurementId,").")+" To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.")}).catch(e=>Ue.error(e)),t.push(l);const c=async function(){if(!(0,G.zW)())return Ue.warn(qe.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{await(0,G.eX)()}catch(e){return Ue.warn(qe.create("indexeddb-unavailable",{errorInfo:null===e||void 0===e?void 0:e.toString()}).message),!1}return!0}().then(e=>e?a.getId():void 0),[d,u]=await Promise.all([l,c]);(function(e){const t=window.document.getElementsByTagName("script");for(const r of Object.values(t))if(r.src&&r.src.includes(ze)&&r.src.includes(e))return r;return null})(s)||We(s,d.measurementId),et&&(n("consent","default",et),tt(void 0)),n("js",new Date);const h=null!==(o=null===i||void 0===i?void 0:i.config)&&void 0!==o?o:{};return h.origin="firebase",h.update=!0,null!=u&&(h.firebase_id=u),n("config",d.measurementId,h),$e&&(n("set",$e),rt(void 0)),d.measurementId}class nt{constructor(e){this.app=e}_delete(){return delete st[this.app.options.appId],Promise.resolve()}}let st={},it=[];const ot={};let lt,ct,dt="dataLayer",ut="gtag",ht=!1;function mt(e,t,r){!function(){const e=[];if((0,G.sr)()&&e.push("This is a browser extension environment."),(0,G.dM)()||e.push("Cookies are not available."),e.length>0){const t=e.map((e,t)=>"(".concat(t+1,") ").concat(e)).join(" "),r=qe.create("invalid-analytics-context",{errorInfo:t});Ue.warn(r.message)}}();const a=e.options.appId;if(!a)throw qe.create("no-app-id");if(!e.options.apiKey){if(!e.options.measurementId)throw qe.create("no-api-key");Ue.warn('The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest'+" measurement ID for this Firebase app. Falling back to the measurement ID ".concat(e.options.measurementId)+' provided in the "measurementId" field in the local Firebase config.')}if(null!=st[a])throw qe.create("already-exists",{id:a});if(!ht){!function(e){let t=[];Array.isArray(window[e])?t=window[e]:window[e]=t}(dt);const{wrappedGtag:e,gtagCore:t}=function(e,t,r,a,n){let s=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];window[a].push(arguments)};return window[n]&&"function"===typeof window[n]&&(s=window[n]),window[n]=Ke(s,e,t,r),{gtagCore:s,wrappedGtag:window[n]}}(st,it,ot,dt,ut);ct=e,lt=t,ht=!0}st[a]=at(e,it,ot,t,lt,dt,r);return new nt(e)}function ft(e,t,r,a){e=(0,G.Ku)(e),async function(e,t,r,a,s){if(s&&s.global)e("event",r,a);else{const s=await t;e("event",r,(0,n.A)((0,n.A)({},a),{},{send_to:s}))}}(ct,st[e.app.options.appId],t,r,a).catch(e=>Ue.error(e))}const gt="@firebase/analytics",pt="0.10.18";(0,q.om)(new W.uA(Be,(e,t)=>{let{options:r}=t;return mt(e.getProvider("app").getImmediate(),e.getProvider("installations-internal").getImmediate(),r)},"PUBLIC")),(0,q.om)(new W.uA("analytics-internal",function(e){try{const t=e.getProvider(Be).getImmediate();return{logEvent:(e,r,a)=>ft(t,e,r,a)}}catch(t){throw qe.create("interop-component-reg-failed",{reason:t})}},"PRIVATE")),(0,q.KO)(gt,pt),(0,q.KO)(gt,pt,"esm2020");var xt=r(2423);const yt=(0,i.Wp)({apiKey:"AIzaSyC6IoQBbNZ1QCMNZAM79KRUJ-TRvWlnliY",authDomain:"workflowbr1.firebaseapp.com",projectId:"workflowbr1",storageBucket:"workflowbr1.firebasestorage.app",messagingSenderId:"207274549565",appId:"1:207274549565:web:4d7755e8424b74c6712554",measurementId:"G-TYRLWERZMS"},"workflowbr1"),vt=(0,s.aU)(yt),bt=(0,xt.c7)(yt);let wt=null;"undefined"!==typeof window&&(wt=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,q.Sx)();e=(0,G.Ku)(e);const t=(0,q.j6)(e,Be);return t.isInitialized()?t.getImmediate():function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r=(0,q.j6)(e,Be);if(r.isInitialized()){const e=r.getImmediate();if((0,G.bD)(t,r.getOptions()))return e;throw qe.create("already-initialized")}return r.initialize({options:t})}(e)}(yt));const kt=(0,e.createContext)({usuario:null,usuarios:[],loading:!0,login:()=>{},logout:()=>{},cadastrarUsuario:()=>{},atualizarUsuario:()=>{},excluirUsuario:()=>{}}),Nt=()=>{const t=(0,e.useContext)(kt);if(!t)throw new Error("useAuth deve ser usado dentro de um AuthProvider");return t},jt={ADMIN:0,FUNCIONARIO:1,SUPERVISOR:2,GERENTE_SETOR:3,GERENTE_GERAL:4,RH:5,CEO:6},St={[jt.ADMIN]:"Administrador",[jt.FUNCIONARIO]:"Funcion\xe1rio",[jt.SUPERVISOR]:"Supervisor",[jt.GERENTE_SETOR]:"Gerente de Setor",[jt.GERENTE_GERAL]:"Gerente Geral",[jt.RH]:"RH",[jt.CEO]:"CEO"},_t=e=>e===jt.ADMIN,Et={[jt.ADMIN]:"\ud83d\udc51",[jt.FUNCIONARIO]:"\ud83d\udc64",[jt.SUPERVISOR]:"\ud83d\udc54",[jt.GERENTE_SETOR]:"\ud83d\udcca",[jt.GERENTE_GERAL]:"\ud83c\udfaf",[jt.RH]:"\ud83d\udcbc",[jt.CEO]:"\ud83c\udfc6"},At=e=>e===jt.ADMIN,Ct=e=>e<=jt.SUPERVISOR,It=e=>e<=jt.GERENTE_SETOR,Tt=e=>e<=jt.SUPERVISOR,Dt={canView:e=>!!_t(e)||void 0!==e&&null!==e,canEditUser:(e,t,r,a)=>!!At(e)||(t===r||e<a),canManageOperational:e=>Tt(e),canManageEmployees:e=>It(e),canManageUsers:e=>At(e)||e<=jt.SUPERVISOR,canDelete:e=>It(e),canViewSensitiveInfo:e=>Ct(e),canPerformAdminActions:e=>At(e),canViewAllSectors:e=>Ct(e),itemBelongsToUserSector:(e,t)=>!(!e||!t)&&e===t,filterBySector:(e,t)=>Dt.canViewAllSectors(t.nivel)?e:t.setorId?e.filter(e=>e.setorId?e.setorId===t.setorId:e.funcionarioSetorId?e.funcionarioSetorId===t.setorId:!(!e.funcionarioId||!e.funcionario)&&e.funcionario.setorId===t.setorId):(console.warn("Usu\xe1rio sem setorId definido:",t),[]),canManageItem:(e,t,r)=>!!Ct(e)||!(e=>e===jt.FUNCIONARIO)(e)&&(!!Tt(e)&&t===r),canCreateInSector:(e,t,r)=>!!Ct(e)||!!Tt(e)&&t===r},Pt=()=>{const{usuario:t}=Nt(),{showToast:r}=_(),[a,i]=(0,e.useState)("termos"),[o,l]=(0,e.useState)([]),[c,d]=(0,e.useState)(!1),[u,h]=(0,e.useState)(0),[m,f]=(0,e.useState)({titulo:"",conteudo:"",tipo:"termo",dataPublicacao:(new Date).toISOString(),versao:"1.0",status:"ativo",versoes:[]}),g=(null===t||void 0===t?void 0:t.nivel)===jt.LEGAL,p=[{id:"termos",label:"Termos de Uso",icon:A},{id:"politicas",label:"Pol\xedticas",icon:C},{id:"lgpd",label:"LGPD",icon:I},{id:"conformidade",label:"Conformidade",icon:T}];null===t||void 0===t||t.nivel;(0,e.useEffect)(()=>{(async()=>{try{const e=(0,s.P)((0,s.collection)(P.db,"legal"),(0,s._M)("status","==","ativo")),t=(await(0,s.GG)(e)).docs.map(e=>(0,n.A)({id:e.id},e.data()));l(t)}catch(e){console.error("Erro ao buscar documentos:",e),r("Erro ao carregar documentos legais","error")}})()},[r,u]);return(0,k.jsx)("div",{className:"space-y-6",children:(0,k.jsxs)("form",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg border border-gray-200 dark:border-gray-600 dark:border-gray-600",children:[(0,k.jsx)("div",{className:"flex justify-between items-center mb-6",children:(0,k.jsx)("div",{className:"flex space-x-4",children:g&&(0,k.jsxs)(k.Fragment,{children:[(0,k.jsxs)("button",{type:"button",onClick:()=>d(!0),className:"px-4 py-2 bg-blue-500 dark:bg-[#1D9BF0] text-gray-900 dark:text-white rounded-md hover:bg-blue-600 dark:hover:bg-[#1a8cd8] focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-[#1D9BF0] flex items-center space-x-2",children:[(0,k.jsx)(D,{className:"w-4 h-4"}),(0,k.jsx)("span",{children:"Novo texto legal"})]}),(0,k.jsxs)("button",{type:"button",onClick:()=>{},className:"px-4 py-2 bg-[#2C3C4C] text-gray-900 dark:text-white rounded-md hover:bg-[#38444D] focus:outline-none focus:ring-2 focus:ring-[#38444D] flex items-center space-x-2",children:[(0,k.jsx)(A,{className:"w-4 h-4"}),(0,k.jsx)("span",{children:"Adicionar documentos padr\xe3o"})]})]})})}),(0,k.jsx)("div",{className:"w-full overflow-x-auto mt-6",children:(0,k.jsx)("div",{className:"flex flex-nowrap min-w-max border-b border-gray-200 dark:border-gray-600 dark:border-gray-600",children:p.map(e=>(0,k.jsxs)("button",{type:"button",onClick:()=>i(e.id),className:"flex shrink-0 items-center px-4 py-2 ".concat(a===e.id?"text-blue-500 dark:text-[#1D9BF0] border-b-2 border-blue-500 dark:border-[#1D9BF0]":"text-gray-500 dark:text-gray-400 hover:text-white"),children:[(0,k.jsx)(e.icon,{className:"w-4 h-4 mr-2 shrink-0"}),(0,k.jsx)("span",{className:"whitespace-nowrap",children:e.label})]},e.id))})}),(0,k.jsx)("div",{className:"mt-6",children:(0,k.jsx)("div",{className:"space-y-4",children:o.filter(e=>{switch(a){case"termos":return"termo"===e.tipo;case"politicas":return"politica"===e.tipo;case"lgpd":return"lgpd"===e.tipo;case"conformidade":return"conformidade"===e.tipo;default:return!1}}).map(e=>(0,k.jsxs)("div",{className:"bg-white dark:bg-gray-700 p-4 rounded-lg border border-gray-200 dark:border-gray-600 dark:border-gray-600",children:[(0,k.jsxs)("div",{className:"flex justify-between items-start",children:[(0,k.jsxs)("div",{children:[(0,k.jsx)("h4",{className:"text-white font-medium",children:e.titulo}),(0,k.jsxs)("p",{className:"text-gray-500 dark:text-gray-400 text-sm mt-1",children:["Vers\xe3o atual: ",e.versao]})]}),(0,k.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,k.jsx)("div",{className:"text-gray-500 dark:text-gray-400 text-sm",children:new Date(e.dataCriacao).toLocaleDateString()}),g&&(0,k.jsx)("button",{type:"button",onClick:()=>(e=>{f((0,n.A)((0,n.A)({},e),{},{versao:"".concat(parseFloat(e.versao)+.1,".0"),versoes:[...e.versoes||[],{versao:e.versao,conteudo:e.conteudo,dataCriacao:e.dataCriacao,criadoPor:e.criadoPor}]})),d(!0)})(e),className:"px-2 py-1 bg-[#2C3C4C] text-gray-900 dark:text-white text-sm rounded hover:bg-[#38444D] focus:outline-none focus:ring-2 focus:ring-[#38444D]",children:"Nova vers\xe3o"})]})]}),(0,k.jsx)("div",{className:"mt-3 text-gray-900 dark:text-white whitespace-pre-wrap",children:e.conteudo})]},e.id))})})]})})},Ft=y("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]),Lt=y("chevron-up",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]),Mt=y("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),Rt=y("circle-question-mark",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),Ot=()=>{const[t,r]=(0,e.useState)(""),[a,n]=(0,e.useState)(null),s=[{id:"inventario",title:"Invent\xe1rio",description:"Gerenciamento completo do invent\xe1rio de ferramentas",features:[{name:"Listagem de Ferramentas",description:"Visualize todas as ferramentas dispon\xedveis no sistema",permission:jt.FUNCIONARIO,howTo:'Acesse a aba "Invent\xe1rio" no menu principal para ver a lista completa de ferramentas.'},{name:"Adi\xe7\xe3o de Ferramentas",description:"Adicione novas ferramentas ao invent\xe1rio",permission:jt.SUPERVISOR,howTo:'Na aba de invent\xe1rio, clique no bot\xe3o "+" para adicionar uma nova ferramenta. Preencha os dados necess\xe1rios no formul\xe1rio.'},{name:"Edi\xe7\xe3o de Ferramentas",description:"Atualize informa\xe7\xf5es de ferramentas existentes",permission:jt.SUPERVISOR,howTo:"Clique no \xedcone de edi\xe7\xe3o ao lado da ferramenta que deseja modificar."}]},{id:"emprestimos",title:"Empr\xe9stimos",description:"Sistema de controle de empr\xe9stimos de ferramentas",features:[{name:"Realizar Empr\xe9stimo",description:"Registre empr\xe9stimos de ferramentas para funcion\xe1rios",permission:jt.SUPERVISOR,howTo:'Na aba "Empr\xe9stimos", clique em "Novo Empr\xe9stimo", selecione o funcion\xe1rio e as ferramentas desejadas.'},{name:"Devolu\xe7\xe3o",description:"Registre a devolu\xe7\xe3o de ferramentas emprestadas",permission:jt.SUPERVISOR,howTo:'Localize o empr\xe9stimo ativo e clique em "Devolver". Confirme as ferramentas devolvidas.'},{name:"Hist\xf3rico",description:"Visualize o hist\xf3rico completo de empr\xe9stimos",permission:jt.FUNCIONARIO,howTo:'Acesse a aba "Hist\xf3rico de Empr\xe9stimos" para ver todos os registros.'}]},{id:"funcionarios",title:"Funcion\xe1rios",description:"Gerenciamento de funcion\xe1rios e suas permiss\xf5es",features:[{name:"Cadastro de Funcion\xe1rios",description:"Adicione novos funcion\xe1rios ao sistema",permission:jt.SUPERVISOR,howTo:'Na aba "Funcion\xe1rios", clique em "Novo Funcion\xe1rio" e preencha os dados necess\xe1rios.'},{name:"Edi\xe7\xe3o de Dados",description:"Atualize informa\xe7\xf5es dos funcion\xe1rios",permission:jt.SUPERVISOR,howTo:"Utilize o bot\xe3o de edi\xe7\xe3o ao lado do funcion\xe1rio para modificar seus dados."},{name:"Gest\xe3o de Permiss\xf5es",description:"Configure n\xedveis de acesso dos funcion\xe1rios",permission:jt.GERENTE_SETOR,howTo:"Acesse a \xe1rea de edi\xe7\xe3o do funcion\xe1rio e ajuste seu n\xedvel de permiss\xe3o."}]},{id:"compras",title:"Compras",description:"Sistema de gest\xe3o de compras e requisi\xe7\xf5es",features:[{name:"Nova Requisi\xe7\xe3o",description:"Crie requisi\xe7\xf5es de compra de ferramentas",permission:jt.SUPERVISOR,howTo:'Na aba "Compras", clique em "Nova Requisi\xe7\xe3o" e preencha os itens necess\xe1rios.'},{name:"Aprova\xe7\xe3o",description:"Aprove ou rejeite requisi\xe7\xf5es de compra",permission:jt.GERENTE_SETOR,howTo:"Revise as requisi\xe7\xf5es pendentes e utilize os bot\xf5es de aprova\xe7\xe3o ou rejei\xe7\xe3o."},{name:"Hist\xf3rico de Compras",description:"Visualize todas as compras realizadas",permission:jt.SUPERVISOR,howTo:"Acesse o hist\xf3rico completo de compras na aba correspondente."}]},{id:"danificadas",title:"Ferramentas Danificadas",description:"Controle de ferramentas danificadas ou em manuten\xe7\xe3o",features:[{name:"Registro de Danos",description:"Registre ferramentas danificadas",permission:jt.SUPERVISOR,howTo:'Na aba "Danificadas", registre a ferramenta e o tipo de dano ocorrido.'},{name:"Acompanhamento",description:"Acompanhe o status de reparos",permission:jt.SUPERVISOR,howTo:"Verifique e atualize o status das ferramentas em manuten\xe7\xe3o."}]},{id:"perdidas",title:"Ferramentas Perdidas",description:"Gest\xe3o de ferramentas perdidas ou extraviadas",features:[{name:"Registro de Perdas",description:"Registre ferramentas perdidas ou extraviadas",permission:jt.SUPERVISOR,howTo:'Na aba "Perdidas", registre a ferramenta perdida com detalhes sobre o ocorrido.'},{name:"Investiga\xe7\xe3o",description:"Acompanhe processos de investiga\xe7\xe3o de perdas",permission:jt.SUPERVISOR,howTo:"Mantenha registros atualizados sobre o processo de investiga\xe7\xe3o de cada item."}]},{id:"dashboard",title:"Dashboard",description:"Painel de controle com indicadores e estat\xedsticas",features:[{name:"Vis\xe3o Geral",description:"Visualize estat\xedsticas e m\xe9tricas principais",permission:jt.GERENTE_SETOR,howTo:"Acesse o Dashboard para ver gr\xe1ficos e estat\xedsticas atualizadas do sistema."},{name:"An\xe1lise de Dados",description:"Explore dados detalhados sobre o uso do sistema",permission:jt.GERENTE_SETOR,howTo:"Utilize os filtros e gr\xe1ficos interativos para analisar diferentes aspectos."}]},{id:"analytics",title:"Analytics",description:"An\xe1lises avan\xe7adas e relat\xf3rios detalhados",features:[{name:"Relat\xf3rios Personalizados",description:"Crie e exporte relat\xf3rios espec\xedficos",permission:jt.GERENTE_SETOR,howTo:"Em Analytics, selecione os par\xe2metros desejados e gere relat\xf3rios personalizados."},{name:"M\xe9tricas Avan\xe7adas",description:"Acesse m\xe9tricas detalhadas de uso e efici\xeancia",permission:jt.GERENTE_SETOR,howTo:"Explore as diferentes se\xe7\xf5es de m\xe9tricas para an\xe1lises aprofundadas."}]},{id:"transferencias",title:"Transfer\xeancias",description:"Sistema de transfer\xeancias entre setores",features:[{name:"Nova Transfer\xeancia",description:"Realize transfer\xeancias de ferramentas entre setores",permission:jt.SUPERVISOR,howTo:"Na aba Transfer\xeancias, selecione as ferramentas e o setor de destino."},{name:"Hist\xf3rico",description:"Acompanhe o hist\xf3rico de transfer\xeancias",permission:jt.SUPERVISOR,howTo:"Visualize todas as transfer\xeancias realizadas e seus detalhes."}]},{id:"tarefas",title:"Tarefas",description:"Gest\xe3o de tarefas e atividades",features:[{name:"Cria\xe7\xe3o de Tarefas",description:"Crie e atribua tarefas para a equipe",permission:jt.SUPERVISOR,howTo:'Na aba Tarefas, clique em "Nova Tarefa" e preencha os detalhes necess\xe1rios.'},{name:"Acompanhamento",description:"Monitore o progresso das tarefas",permission:jt.SUPERVISOR,howTo:"Visualize e atualize o status das tarefas em andamento."}]},{id:"configuracoes",title:"Configura\xe7\xf5es",description:"Configura\xe7\xf5es e personaliza\xe7\xe3o do sistema",features:[{name:"Prefer\xeancias",description:"Ajuste as configura\xe7\xf5es do sistema",permission:jt.ADMIN,howTo:"Em Configura\xe7\xf5es, personalize as op\xe7\xf5es conforme necess\xe1rio."},{name:"Notifica\xe7\xf5es",description:"Configure alertas e notifica\xe7\xf5es",permission:jt.SUPERVISOR,howTo:"Ajuste suas prefer\xeancias de notifica\xe7\xe3o para diferentes eventos."}]}].filter(e=>{const r=e.title.toLowerCase().includes(t.toLowerCase())||e.description.toLowerCase().includes(t.toLowerCase()),a=e.features.some(e=>e.name.toLowerCase().includes(t.toLowerCase())||e.description.toLowerCase().includes(t.toLowerCase())||e.howTo.toLowerCase().includes(t.toLowerCase()));return r||a}),i=[{question:"Como fa\xe7o para emprestar uma ferramenta?",answer:'Para emprestar uma ferramenta, acesse a aba "Empr\xe9stimos", clique em "Novo Empr\xe9stimo", selecione o funcion\xe1rio e as ferramentas desejadas. Confirme os detalhes e finalize o empr\xe9stimo.'},{question:"O que fazer se uma ferramenta for danificada?",answer:'Em caso de dano, registre imediatamente na aba "Ferramentas Danificadas". Inclua detalhes sobre o dano e, se poss\xedvel, anexe fotos. A equipe respons\xe1vel ser\xe1 notificada.'},{question:"Como verificar a disponibilidade de uma ferramenta?",answer:'No "Invent\xe1rio", voc\xea pode ver a quantidade dispon\xedvel de cada ferramenta. Ferramentas emprestadas aparecem com status "Em uso" e sua quantidade dispon\xedvel \xe9 atualizada automaticamente.'},{question:"Como solicitar a compra de novas ferramentas?",answer:'Acesse a aba "Compras", clique em "Nova Requisi\xe7\xe3o", preencha os detalhes dos itens necess\xe1rios e envie para aprova\xe7\xe3o. O status da solicita\xe7\xe3o pode ser acompanhado na mesma \xe1rea.'},{question:"Como alterar minhas informa\xe7\xf5es de perfil?",answer:'Clique no seu nome/foto no menu lateral e selecione "Editar Perfil". Voc\xea pode atualizar suas informa\xe7\xf5es b\xe1sicas e prefer\xeancias do sistema.'},{question:"Como fa\xe7o para transferir ferramentas entre setores?",answer:'Na aba "Transfer\xeancias", inicie uma nova transfer\xeancia, selecione as ferramentas a serem transferidas e o setor de destino. A transfer\xeancia precisa ser aprovada pelo supervisor do setor de destino.'},{question:"O que fazer se uma ferramenta for perdida?",answer:'Registre imediatamente na aba "Ferramentas Perdidas". Forne\xe7a todas as informa\xe7\xf5es poss\xedveis sobre quando e onde a ferramenta foi vista pela \xfaltima vez. Um processo de investiga\xe7\xe3o ser\xe1 iniciado.'},{question:"Como acessar relat\xf3rios e an\xe1lises?",answer:'Acesse a aba "Analytics" para relat\xf3rios detalhados ou "Dashboard" para uma vis\xe3o geral. Voc\xea pode personalizar os relat\xf3rios e export\xe1-los conforme necess\xe1rio.'},{question:"Como criar e atribuir tarefas?",answer:'Na aba "Tarefas", clique em "Nova Tarefa", defina o t\xedtulo, descri\xe7\xe3o, respons\xe1vel e prazo. Voc\xea pode acompanhar o progresso e receber notifica\xe7\xf5es sobre atualiza\xe7\xf5es.'},{question:"Como configurar minhas notifica\xe7\xf5es?",answer:'Em "Configura\xe7\xf5es", acesse a se\xe7\xe3o de notifica\xe7\xf5es. Voc\xea pode personalizar quais tipos de alertas deseja receber e como (email, notifica\xe7\xf5es no sistema, etc).'},{question:"Como funciona o sistema de n\xedveis de acesso?",answer:"O sistema possui diferentes n\xedveis: Funcion\xe1rio (acesso b\xe1sico), Supervisor (gerenciamento operacional), Gerente (acesso avan\xe7ado) e Admin (acesso total). Cada n\xedvel tem permiss\xf5es espec\xedficas."},{question:"Como verificar o hist\xf3rico de uma ferramenta?",answer:"No Invent\xe1rio, clique na ferramenta desejada para ver seu hist\xf3rico completo, incluindo empr\xe9stimos, transfer\xeancias, manuten\xe7\xf5es e outros eventos relacionados."},{question:"Posso usar o sistema em dispositivos m\xf3veis?",answer:"Sim, o sistema \xe9 totalmente responsivo e pode ser acessado de qualquer dispositivo com navegador web. Tamb\xe9m oferecemos um PWA para instala\xe7\xe3o no seu celular ou tablet."},{question:"Como reportar um problema no sistema?",answer:"Use o bot\xe3o de suporte no canto inferior direito ou envie um email para suporte@workflow.com. Inclua o m\xe1ximo de detalhes poss\xedvel sobre o problema encontrado."},{question:"Como funciona a verifica\xe7\xe3o mensal do invent\xe1rio?",answer:"Todo m\xeas \xe9 necess\xe1rio realizar uma verifica\xe7\xe3o f\xedsica do invent\xe1rio. O sistema guia voc\xea pelo processo, permitindo confirmar a localiza\xe7\xe3o e estado de cada ferramenta."}].filter(e=>e.question.toLowerCase().includes(t.toLowerCase())||e.answer.toLowerCase().includes(t.toLowerCase()));return(0,k.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,k.jsxs)("div",{className:"mb-8",children:[(0,k.jsx)("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:"Central de Suporte"}),(0,k.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"Encontre ajuda e documenta\xe7\xe3o sobre todas as funcionalidades do sistema"})]}),(0,k.jsxs)("div",{className:"relative mb-8",children:[(0,k.jsx)("input",{type:"text",placeholder:"Pesquisar funcionalidades, tutoriais ou FAQs...",value:t,onChange:e=>r(e.target.value),className:"w-full px-4 py-3 pl-12 rounded-lg border border-gray-200 dark:border-gray-600 dark:border-gray-600 bg-white dark:bg-gray-800 dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),(0,k.jsx)(Ft,{className:"w-5 h-5 absolute left-4 top-3.5 text-gray-400"})]}),(0,k.jsxs)("div",{className:"space-y-6 mb-12",children:[(0,k.jsx)("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4",children:"Funcionalidades do Sistema"}),s.map(e=>(0,k.jsxs)("div",{className:"border dark:border-gray-700 rounded-lg overflow-hidden",children:[(0,k.jsxs)("button",{onClick:()=>n(a===e.id?null:e.id),className:"w-full px-6 py-4 flex items-center justify-between bg-gray-50 dark:bg-gray-800",children:[(0,k.jsxs)("div",{children:[(0,k.jsx)("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:e.title}),(0,k.jsx)("p",{className:"text-gray-600 dark:text-gray-400 text-sm",children:e.description})]}),a===e.id?(0,k.jsx)(Lt,{className:"w-5 h-5 text-gray-400"}):(0,k.jsx)(Mt,{className:"w-5 h-5 text-gray-400"})]}),a===e.id&&(0,k.jsx)("div",{className:"px-6 py-4 bg-white dark:bg-gray-800 dark:bg-gray-900",children:(0,k.jsx)("div",{className:"space-y-6",children:e.features.map((e,t)=>{var r;return(0,k.jsxs)("div",{className:"border-b dark:border-gray-700 last:border-0 pb-6 last:pb-0",children:[(0,k.jsx)("h4",{className:"font-medium text-gray-900 dark:text-white mb-2",children:e.name}),(0,k.jsx)("p",{className:"text-gray-600 dark:text-gray-400 text-sm mb-2",children:e.description}),(0,k.jsxs)("div",{className:"text-sm",children:[(0,k.jsx)("span",{className:"text-blue-600 dark:text-blue-400 font-medium",children:"N\xedvel de Acesso:"}),(0,k.jsx)("span",{className:"ml-2 text-gray-600 dark:text-gray-400",children:(null===(r=Object.entries(jt).find(t=>{let[r,a]=t;return a===e.permission}))||void 0===r?void 0:r[0])||"N/A"})]}),(0,k.jsxs)("div",{className:"mt-2 text-sm",children:[(0,k.jsx)("span",{className:"text-blue-600 dark:text-blue-400 font-medium",children:"Como fazer:"}),(0,k.jsx)("p",{className:"mt-1 text-gray-600 dark:text-gray-400",children:e.howTo})]})]},t)})})})]},e.id))]}),(0,k.jsxs)("div",{className:"space-y-6",children:[(0,k.jsx)("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4",children:"Perguntas Frequentes"}),i.map((e,t)=>(0,k.jsxs)("div",{className:"border dark:border-gray-700 rounded-lg overflow-hidden",children:[(0,k.jsxs)("button",{onClick:()=>n(a==="faq-".concat(t)?null:"faq-".concat(t)),className:"w-full px-6 py-4 flex items-center justify-between bg-white dark:bg-gray-800 dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-700",children:[(0,k.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,k.jsx)(Rt,{className:"w-5 h-5 text-blue-500"}),(0,k.jsx)("span",{className:"text-gray-900 dark:text-white font-medium",children:e.question})]}),a==="faq-".concat(t)?(0,k.jsx)(Lt,{className:"w-5 h-5 text-gray-400"}):(0,k.jsx)(Mt,{className:"w-5 h-5 text-gray-400"})]}),a==="faq-".concat(t)&&(0,k.jsx)("div",{className:"px-6 py-4 bg-gray-50 dark:bg-gray-900",children:(0,k.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:e.answer})})]},t))]}),(0,k.jsxs)("div",{className:"space-y-6 mb-12",children:[(0,k.jsx)("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4",children:"Dicas R\xe1pidas"}),(0,k.jsx)("div",{className:"grid grid-cols-1 gap-4",children:(0,k.jsx)("div",{className:"border dark:border-gray-700 rounded-lg p-4",children:(0,k.jsxs)("ul",{className:"space-y-2 text-sm text-gray-600 dark:text-gray-400",children:[(0,k.jsx)("li",{children:"\u2022 Use filtros para encontrar itens rapidamente"}),(0,k.jsx)("li",{children:"\u2022 Mantenha o mouse sobre \xedcones para ver dicas"}),(0,k.jsx)("li",{children:"\u2022 Clique duplo em itens para edi\xe7\xe3o r\xe1pida"}),(0,k.jsx)("li",{children:"\u2022 Arraste colunas para reorganizar tabelas"}),(0,k.jsx)("li",{children:"\u2022 Use o modo escuro para trabalhar \xe0 noite"})]})})})]}),(0,k.jsxs)("div",{className:"space-y-6 mb-12",children:[(0,k.jsx)("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4",children:"Resolu\xe7\xe3o de Problemas Comuns"}),(0,k.jsxs)("div",{className:"space-y-4",children:[(0,k.jsxs)("div",{className:"border dark:border-gray-700 rounded-lg p-4",children:[(0,k.jsx)("h3",{className:"font-medium text-gray-900 dark:text-white mb-3",children:"Problemas de Login"}),(0,k.jsxs)("ul",{className:"space-y-3 text-sm text-gray-600 dark:text-gray-400",children:[(0,k.jsxs)("li",{children:[(0,k.jsx)("strong",{children:"Esqueceu a senha?"}),(0,k.jsx)("p",{children:'Clique em "Esqueci minha senha" na tela de login ou contate o administrador do sistema para redefini\xe7\xe3o.'})]}),(0,k.jsxs)("li",{children:[(0,k.jsx)("strong",{children:"Conta bloqueada?"}),(0,k.jsx)("p",{children:"Ap\xf3s 5 tentativas incorretas de senha, a conta \xe9 bloqueada por seguran\xe7a. Aguarde 15 minutos ou contate o suporte."})]}),(0,k.jsxs)("li",{children:[(0,k.jsx)("strong",{children:"Erro de autentica\xe7\xe3o?"}),(0,k.jsx)("p",{children:"Verifique sua conex\xe3o com a internet e limpe o cache do navegador. Se o problema persistir, contate o suporte."})]})]})]}),(0,k.jsxs)("div",{className:"border dark:border-gray-700 rounded-lg p-4",children:[(0,k.jsx)("h3",{className:"font-medium text-gray-900 dark:text-white mb-3",children:"Problemas com Empr\xe9stimos"}),(0,k.jsxs)("ul",{className:"space-y-3 text-sm text-gray-600 dark:text-gray-400",children:[(0,k.jsxs)("li",{children:[(0,k.jsx)("strong",{children:"N\xe3o consegue emprestar uma ferramenta?"}),(0,k.jsx)("p",{children:"Verifique se a ferramenta est\xe1 dispon\xedvel e se voc\xea tem as permiss\xf5es necess\xe1rias."})]}),(0,k.jsxs)("li",{children:[(0,k.jsx)("strong",{children:"Erro na devolu\xe7\xe3o?"}),(0,k.jsx)("p",{children:"Certifique-se de que todas as informa\xe7\xf5es est\xe3o corretas e que o sistema est\xe1 online."})]}),(0,k.jsxs)("li",{children:[(0,k.jsx)("strong",{children:"Diverg\xeancia no invent\xe1rio?"}),(0,k.jsx)("p",{children:"Reporte a diverg\xeancia ao supervisor para corre\xe7\xe3o manual do estoque."})]})]})]}),(0,k.jsxs)("div",{className:"border dark:border-gray-700 rounded-lg p-4",children:[(0,k.jsx)("h3",{className:"font-medium text-gray-900 dark:text-white mb-3",children:"Problemas T\xe9cnicos"}),(0,k.jsxs)("ul",{className:"space-y-3 text-sm text-gray-600 dark:text-gray-400",children:[(0,k.jsxs)("li",{children:[(0,k.jsx)("strong",{children:"Sistema lento?"}),(0,k.jsx)("p",{children:"Limpe o cache do navegador, verifique sua conex\xe3o e feche abas desnecess\xe1rias."})]}),(0,k.jsxs)("li",{children:[(0,k.jsx)("strong",{children:"Erro ao gerar relat\xf3rio?"}),(0,k.jsx)("p",{children:"Tente reduzir o per\xedodo de dados ou filtrar menos informa\xe7\xf5es. Se persistir, use a exporta\xe7\xe3o em partes."})]}),(0,k.jsxs)("li",{children:[(0,k.jsx)("strong",{children:"Notifica\xe7\xf5es n\xe3o aparecem?"}),(0,k.jsx)("p",{children:"Verifique as permiss\xf5es do navegador e suas configura\xe7\xf5es de notifica\xe7\xe3o no sistema."})]})]})]}),(0,k.jsxs)("div",{className:"border dark:border-gray-700 rounded-lg p-4",children:[(0,k.jsx)("h3",{className:"font-medium text-gray-900 dark:text-white mb-3",children:"Dicas de Preven\xe7\xe3o"}),(0,k.jsxs)("ul",{className:"space-y-2 text-sm text-gray-600 dark:text-gray-400",children:[(0,k.jsx)("li",{children:"\u2022 Mantenha seu navegador atualizado"}),(0,k.jsx)("li",{children:"\u2022 Fa\xe7a logout ao final do expediente"}),(0,k.jsx)("li",{children:"\u2022 N\xe3o compartilhe suas credenciais"}),(0,k.jsx)("li",{children:"\u2022 Reporte problemas imediatamente"}),(0,k.jsx)("li",{children:"\u2022 Fa\xe7a backup de relat\xf3rios importantes"})]})]})]})]}),(0,k.jsxs)("div",{className:"space-y-6 mb-12",children:[(0,k.jsx)("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4",children:"Links Importantes"}),(0,k.jsx)("div",{className:"border dark:border-gray-700 rounded-lg p-6",children:(0,k.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:(0,k.jsx)("div",{children:(0,k.jsxs)("ul",{className:"space-y-2 text-sm",children:[(0,k.jsx)("li",{children:(0,k.jsx)("a",{href:"#",className:"text-blue-600 dark:text-blue-400 hover:underline",children:"Manual do Usu\xe1rio"})}),(0,k.jsx)("li",{children:(0,k.jsx)("a",{href:"#",className:"text-blue-600 dark:text-blue-400 hover:underline",children:"Pol\xedtica de Seguran\xe7a"})}),(0,k.jsx)("li",{children:(0,k.jsx)("a",{href:"#",className:"text-blue-600 dark:text-blue-400 hover:underline",children:"Termos de Uso"})}),(0,k.jsx)("li",{children:(0,k.jsx)("a",{href:"#",className:"text-blue-600 dark:text-blue-400 hover:underline",children:"Tutoriais em V\xeddeo"})})]})})})})]})]})};var Bt=r(9661);const zt="WlpoYVN5QW5MbXRsaE9VVUFidFJjT2c2NGRYZENMYmx0dl9pRTRF",Ut="Z2FyZGVuLWMwYjUwLmZpcmViYXNlYXBwLmNvbQ==",Vt="Z2FyZGVuLWMwYjUw",qt="Z2FyZGVuLWMwYjUwLmZpcmViYXNlc3RvcmFnZS5hcHA=",Ht="NDY3MzQ0MzU0OTk3",Gt="MTo0NjczNDQzNTQ5OTc6d2ViOjNjMzM5N2UwMTc2MDYwYmIwYzk4ZmM=",Wt="Ry03TE1MOTNRRFRGCg==",Kt={apiKey:"AIzaSyCPTELyhRUn4qByU68pOZsZUrkR1ZeyROo",authDomain:"garden-backup.firebaseapp.com",projectId:"garden-backup",storageBucket:"garden-backup.firebasestorage.app",messagingSenderId:"842077125369",appId:"1:842077125369:web:ea3bafe1cedb92cd350028",measurementId:"G-WJHEL52L9L"};let Qt,Yt,Xt,Jt,Zt,$t,er,tr;(()=>{try{return Qt=(0,i.Wp)({apiKey:{NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_ENV:"production"}.REACT_APP_FIREBASE_API_KEY||(0,Bt.Yc)(zt),authDomain:{NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_ENV:"production"}.REACT_APP_FIREBASE_AUTH_DOMAIN||(0,Bt.Yc)(Ut),projectId:{NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_ENV:"production"}.REACT_APP_FIREBASE_PROJECT_ID||(0,Bt.Yc)(Vt),storageBucket:{NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_ENV:"production"}.REACT_APP_FIREBASE_STORAGE_BUCKET||(0,Bt.Yc)(qt),messagingSenderId:{NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_ENV:"production"}.REACT_APP_FIREBASE_MESSAGING_SENDER_ID||(0,Bt.Yc)(Ht),appId:{NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_ENV:"production"}.REACT_APP_FIREBASE_APP_ID||(0,Bt.Yc)(Gt),measurementId:{NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_ENV:"production"}.REACT_APP_FIREBASE_MEASUREMENT_ID||(0,Bt.Yc)(Wt)},"primary"),Xt=(0,s.aU)(Qt),Zt=(0,o.xI)(Qt),er=(0,xt.c7)(Qt),(0,s.ol)(Xt).catch(e=>{"failed-precondition"===e.code?console.warn("\u26a0\ufe0f M\xfaltiplas abas abertas, persist\xeancia habilitada em apenas uma."):"unimplemented"===e.code&&console.warn("\u26a0\ufe0f Navegador n\xe3o suporta persist\xeancia offline.")}),Yt=(0,i.Wp)(Kt,"backup"),Jt=(0,s.aU)(Yt),$t=(0,o.xI)(Yt),tr=(0,xt.c7)(Yt),console.log("\u2705 Firebase Principal e Backup inicializados"),{primaryApp:Qt,backupApp:Yt,primaryDb:Xt,backupDb:Jt,primaryAuth:Zt,backupAuth:$t,primaryStorage:er,backupStorage:tr}}catch(e){throw console.error("\u274c Erro ao inicializar Firebase:",e),e}})();const rr=new class{constructor(){this.activeDatabase=this.loadActiveDatabase(),this.lastRotation=this.loadLastRotation(),this.listeners=[]}loadActiveDatabase(){return localStorage.getItem("activeDatabase")||"primary"}saveActiveDatabase(e){localStorage.setItem("activeDatabase",e),this.activeDatabase=e,this.notifyListeners()}loadLastRotation(){const e=localStorage.getItem("lastDatabaseRotation");return e?new Date(e):new Date}saveLastRotation(){const e=new Date;localStorage.setItem("lastDatabaseRotation",e.toISOString()),this.lastRotation=e}getActiveDb(){return"primary"===this.activeDatabase?Xt:Jt}getInactiveDb(){return"primary"===this.activeDatabase?Jt:Xt}getActiveAuth(){return"primary"===this.activeDatabase?Zt:$t}getActiveStorage(){return"primary"===this.activeDatabase?er:tr}switchDatabase(){const e="primary"===this.activeDatabase?"backup":"primary";return console.log("\ud83d\udd04 Alternando database: ".concat(this.activeDatabase," \u2192 ").concat(e)),this.saveActiveDatabase(e),this.saveLastRotation(),e}needsRotation(){return(new Date-this.lastRotation)/36e5>=24}addListener(e){return this.listeners.push(e),()=>{this.listeners=this.listeners.filter(t=>t!==e)}}notifyListeners(){this.listeners.forEach(e=>{try{e(this.activeDatabase)}catch(t){console.error("Erro ao notificar listener:",t)}})}getInfo(){return{activeDatabase:this.activeDatabase,lastRotation:this.lastRotation,needsRotation:this.needsRotation(),hoursUntilRotation:24-(new Date-this.lastRotation)/36e5,primaryDb:Xt,backupDb:Jt,activeDb:this.getActiveDb(),inactiveDb:this.getInactiveDb()}}},ar=new Proxy({},{get:(e,t)=>rr.getActiveDb()[t]}),nr=(new Proxy({},{get:(e,t)=>rr.getActiveAuth()[t]}),new Proxy({},{get:(e,t)=>rr.getActiveStorage()[t]}),new Proxy({},{get:(e,t)=>("primary"===rr.activeDatabase?Qt:Yt)[t]}),rr),sr=(0,e.createContext)(),ir=t=>{let{children:r}=t;const[a,i]=(0,e.useState)([]);return(0,e.useEffect)(()=>{const e=[],t=(0,s.aQ)((0,s.collection)(P.db,"funcionarios"),e=>{const t=e.docs.map(e=>(0,n.A)((0,n.A)({id:e.id},e.data()),{},{origem:"funcionarios"})).filter(e=>!e.demitido);console.log('\ud83d\udccb Funcion\xe1rios carregados da cole\xe7\xe3o "funcionarios":',t.length),i(e=>{const r=e.filter(e=>"usuarios"===e.origem);return[...t,...r]})},e=>{console.error("\u274c Erro ao carregar funcion\xe1rios:",e)});e.push(t);const r=(0,s.aQ)((0,s.collection)(P.db,"usuario"),e=>{const t=e.docs.map(e=>{const t=e.data();return{id:e.id,nome:t.nome,email:t.email,username:t.email,cargo:t.cargo||"Funcion\xe1rio",empresaId:t.empresaId,empresaNome:t.empresaNome,setorId:t.setorId,setorNome:t.setorNome,nivel:t.nivel,ativo:!1!==t.ativo,origem:"usuarios",photoURL:t.photoURL||null}}).filter(e=>e.ativo);console.log('\ud83d\udc65 Usu\xe1rios carregados da cole\xe7\xe3o "usuarios":',t.length),i(e=>{const r=e.filter(e=>"funcionarios"===e.origem),a=t.filter(e=>!r.some(t=>t.email===e.email||t.id===e.id)),n=[...r,...a];return console.log("\u2705 Total mesclado (funcionarios + usuarios):",n.length),console.log('   - Da cole\xe7\xe3o "funcionarios":',r.length),console.log('   - Da cole\xe7\xe3o "usuarios":',a.length),n})},e=>{console.error("\u274c Erro ao carregar usu\xe1rios:",e)});return e.push(r),()=>{e.forEach(e=>e())}},[]),(0,k.jsx)(sr.Provider,{value:{funcionarios:a},children:r})},or=()=>{const t=(0,e.useContext)(sr);if(!t)throw new Error("useFuncionarios deve ser usado dentro de um FuncionariosProvider");return t},lr={light:{name:"light",colors:{background:"#FFFFFF",backgroundSecondary:"#F8FAFC",backgroundTertiary:"#F1F5F9",card:"#FFFFFF",header:"#FFFFFF",sidebar:"#FFFFFF",modal:"#FFFFFF",dropdown:"#FFFFFF",surface:"#FFFFFF",surfaceHover:"#F8FAFC",surfaceActive:"#F1F5F9",surfaceDisabled:"#F1F5F9",primary:"#1D9BF0",primaryHover:"#1A8CD8",primaryActive:"#1B7DC0",primaryLight:"#E1F5FE",primaryDark:"#0D47A1",secondary:"#64748B",secondaryHover:"#475569",secondaryActive:"#334155",secondaryLight:"#F1F5F9",success:"#10B981",successHover:"#059669",successLight:"#D1FAE5",warning:"#F59E0B",warningHover:"#D97706",warningLight:"#FEF3C7",danger:"#EF4444",dangerHover:"#DC2626",dangerLight:"#FEE2E2",info:"#3B82F6",infoHover:"#2563EB",infoLight:"#DBEAFE",text:"#111827",textSecondary:"#6B7280",textMuted:"#9CA3AF",textLight:"#D1D5DB",textInverted:"#FFFFFF",border:"#E5E7EB",borderSecondary:"#D1D5DB",borderMuted:"#F3F4F6",borderFocus:"#1D9BF0",shadow:"rgba(0, 0, 0, 0.1)",shadowMedium:"rgba(0, 0, 0, 0.15)",shadowLarge:"rgba(0, 0, 0, 0.2)",navActive:"#1D9BF0",navHover:"#F1F5F9",navText:"#374151",navIcon:"#6B7280"}},dark:{name:"dark",colors:{background:"#000000",backgroundSecondary:"#16181C",backgroundTertiary:"#1D1F23",card:"#16181C",header:"#000000",sidebar:"#000000",modal:"#16181C",dropdown:"#16181C",surface:"#16181C",surfaceHover:"#1D1F23",surfaceActive:"#22252A",surfaceDisabled:"#1D1F23",primary:"#1D9BF0",primaryHover:"#1A8CD8",primaryActive:"#1B7DC0",primaryLight:"#1D9BF01A",primaryDark:"#0D84C4",secondary:"#8B949E",secondaryHover:"#B1BAC4",secondaryActive:"#C9D1D9",secondaryLight:"#21262D",success:"#238636",successHover:"#2EA043",successLight:"#23863610",warning:"#D29922",warningHover:"#E2B72B",warningLight:"#D2992210",danger:"#DA3633",dangerHover:"#E5484D",dangerLight:"#DA363310",info:"#1D9BF0",infoHover:"#1A8CD8",infoLight:"#1D9BF010",text:"#E7E9EA",textSecondary:"#71767B",textMuted:"#536471",textLight:"#8B949E",textInverted:"#000000",border:"#2F3336",borderSecondary:"#3E4347",borderMuted:"#22252A",borderFocus:"#1D9BF0",shadow:"rgba(255, 255, 255, 0.05)",shadowMedium:"rgba(255, 255, 255, 0.1)",shadowLarge:"rgba(255, 255, 255, 0.15)",navActive:"#1D9BF0",navHover:"#1D1F23",navText:"#E7E9EA",navIcon:"#71767B"}}},cr=(0,e.createContext)(),dr=t=>{let{children:r}=t;const[a,n]=(0,e.useState)("dark");(0,e.useEffect)(()=>{const e=localStorage.getItem("workflow-theme");if(e&&lr[e])n(e);else{const e=window.matchMedia("(prefers-color-scheme: dark)").matches;n(e?"dark":"light")}},[]),(0,e.useEffect)(()=>{const e=document.documentElement,t=lr[a];e.classList.remove("light","dark"),e.classList.add(a),Object.entries(t.colors).forEach(t=>{let[r,a]=t;e.style.setProperty("--color-".concat(r),a)}),localStorage.setItem("workflow-theme",a)},[a]);const s={currentTheme:a,theme:lr[a],themes:lr,toggleTheme:()=>{n(e=>"light"===e?"dark":"light")},setTheme:e=>{lr[e]&&n(e)},isLight:"light"===a,isDark:"dark"===a};return(0,k.jsx)(cr.Provider,{value:s,children:r})},ur=y("sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]),hr=y("moon",[["path",{d:"M20.985 12.486a9 9 0 1 1-9.473-9.472c.405-.022.617.46.402.803a6 6 0 0 0 8.268 8.268c.344-.215.825-.004.803.401",key:"kfwtm"}]]),mr=t=>{let{isActive:r,fromTheme:a,toTheme:n,onTransitionComplete:s,buttonPosition:i={x:0,y:0}}=t;const[o,l]=(0,e.useState)(""),c="light"===a&&"dark"===n?"desaturate":"saturate";return(0,e.useEffect)(()=>{if(!r)return void l("");l("start");const e=setTimeout(()=>{l("middle")},100),t=setTimeout(()=>{l("end")},600),a=setTimeout(()=>{l("fade-out"),s&&s()},1e3),n=setTimeout(()=>{l("")},1200);return()=>{clearTimeout(e),clearTimeout(t),clearTimeout(a),clearTimeout(n)}},[r,s]),r&&o?(0,k.jsxs)("div",{className:"theme-transition-overlay ".concat(c," ").concat(o),style:{"--button-x":"".concat(i.x,"px"),"--button-y":"".concat(i.y,"px")},children:["desaturate"===c&&(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)("div",{className:"desaturate-wave"}),(0,k.jsx)("div",{className:"desaturate-ripple"}),(0,k.jsx)("div",{className:"color-drain"})]}),"saturate"===c&&(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)("div",{className:"saturate-burst"}),(0,k.jsx)("div",{className:"color-bloom"}),(0,k.jsx)("div",{className:"color-waves",children:[...Array(8)].map((e,t)=>(0,k.jsx)("div",{className:"color-wave wave-".concat(t+1)},t))})]}),(0,k.jsx)("div",{className:"transition-overlay"})]}):null},fr=t=>{let{size:r="md",showLabel:a=!1,className:n=""}=t;const{currentTheme:s,toggleTheme:i,isLight:o,isDark:l}=(()=>{const t=(0,e.useContext)(cr);if(!t)throw new Error("useTheme deve ser usado dentro de um ThemeProvider");return t})(),[c,d]=(0,e.useState)(!1),[u,h]=(0,e.useState)({x:0,y:0}),m=(0,e.useRef)(null),f={sm:"w-4 h-4",md:"w-5 h-5",lg:"w-6 h-6"};return(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(mr,{isActive:c,fromTheme:s,toTheme:o?"dark":"light",onTransitionComplete:()=>{d(!1)},buttonPosition:u}),(0,k.jsxs)("div",{className:"flex items-center gap-2 ".concat(n),children:[a&&(0,k.jsx)("span",{className:"text-sm font-medium ".concat(l?"text-white":"text-gray-700"),children:"Tema"}),(0,k.jsxs)("button",{ref:m,onClick:e=>{if(m.current){const e=m.current.getBoundingClientRect(),t=e.left+e.width/2,r=e.top+e.height/2;h({x:t,y:r})}d(!0),setTimeout(()=>{i()},200)},disabled:c,className:"\n            ".concat({sm:"w-8 h-8",md:"w-10 h-10",lg:"w-12 h-12"}[r]," rounded-lg\n            flex items-center justify-center\n            transition-all duration-300 ease-in-out\n            ").concat(l?"bg-[#16181C] hover:bg-[#1D1F23] border border-[#2F3336] text-yellow-400":"bg-white hover:bg-gray-50 border border-gray-200 text-orange-500","\n            ").concat(c?"opacity-75 cursor-not-allowed":"hover:scale-105 active:scale-95","\n            group relative overflow-hidden\n          "),title:"Trocar para tema ".concat(o?"escuro":"claro"),"aria-label":"Trocar para tema ".concat(o?"escuro":"claro"),children:[(0,k.jsx)("div",{className:"\n            absolute inset-0 opacity-0 group-hover:opacity-10 \n            transition-opacity duration-300\n            ".concat(o?"bg-orange-500":"bg-yellow-400","\n          ")}),(0,k.jsx)("div",{className:"relative z-10 flex items-center justify-center",children:o?(0,k.jsx)(ur,{className:"".concat(f[r]," transition-all duration-300 \n                  ").concat(c?"animate-pulse":"group-hover:rotate-180 group-hover:scale-110")}):(0,k.jsx)(hr,{className:"".concat(f[r]," transition-all duration-300 \n                  ").concat(c?"animate-pulse":"group-hover:-rotate-12 group-hover:scale-110")})}),(0,k.jsx)("div",{className:"\n            absolute top-1 right-1 w-2 h-2 rounded-full\n            transition-all duration-300\n            ".concat(o?"bg-orange-400":"bg-yellow-400","\n            ").concat(c?"animate-ping":"opacity-60 group-hover:opacity-100","\n          ")})]})]})]})},gr=y("eye-off",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]),pr=y("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),xr=y("database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]),yr=(0,e.createContext)({});function vr(t){const r=(0,e.useRef)(null);return null===r.current&&(r.current=t()),r.current}const br="undefined"!==typeof window,wr=br?e.useLayoutEffect:e.useEffect,kr=(0,e.createContext)(null);function Nr(e){return"object"===typeof e&&null!==e}function jr(e){return Nr(e)&&"offsetHeight"in e}const Sr=(0,e.createContext)({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"});class _r extends e.Component{getSnapshotBeforeUpdate(e){const t=this.props.childRef.current;if(t&&e.isPresent&&!this.props.isPresent){const e=t.offsetParent,r=jr(e)&&e.offsetWidth||0,a=this.props.sizeRef.current;a.height=t.offsetHeight||0,a.width=t.offsetWidth||0,a.top=t.offsetTop,a.left=t.offsetLeft,a.right=r-a.width-a.left}return null}componentDidUpdate(){}render(){return this.props.children}}function Er(t){let{children:r,isPresent:a,anchorX:n,root:s}=t;const i=(0,e.useId)(),o=(0,e.useRef)(null),l=(0,e.useRef)({width:0,height:0,top:0,left:0,right:0}),{nonce:c}=(0,e.useContext)(Sr);return(0,e.useInsertionEffect)(()=>{const{width:e,height:t,top:r,left:d,right:u}=l.current;if(a||!o.current||!e||!t)return;const h="left"===n?"left: ".concat(d):"right: ".concat(u);o.current.dataset.motionPopId=i;const m=document.createElement("style");c&&(m.nonce=c);const f=null!==s&&void 0!==s?s:document.head;return f.appendChild(m),m.sheet&&m.sheet.insertRule('\n          [data-motion-pop-id="'.concat(i,'"] {\n            position: absolute !important;\n            width: ').concat(e,"px !important;\n            height: ").concat(t,"px !important;\n            ").concat(h,"px !important;\n            top: ").concat(r,"px !important;\n          }\n        ")),()=>{f.contains(m)&&f.removeChild(m)}},[a]),(0,k.jsx)(_r,{isPresent:a,childRef:o,sizeRef:l,children:e.cloneElement(r,{ref:o})})}const Ar=t=>{let{children:r,initial:a,isPresent:s,onExitComplete:i,custom:o,presenceAffectsLayout:l,mode:c,anchorX:d,root:u}=t;const h=vr(Cr),m=(0,e.useId)();let f=!0,g=(0,e.useMemo)(()=>(f=!1,{id:m,initial:a,isPresent:s,custom:o,onExitComplete:e=>{h.set(e,!0);for(const t of h.values())if(!t)return;i&&i()},register:e=>(h.set(e,!1),()=>h.delete(e))}),[s,h,i]);return l&&f&&(g=(0,n.A)({},g)),(0,e.useMemo)(()=>{h.forEach((e,t)=>h.set(t,!1))},[s]),e.useEffect(()=>{!s&&!h.size&&i&&i()},[s]),"popLayout"===c&&(r=(0,k.jsx)(Er,{isPresent:s,anchorX:d,root:u,children:r})),(0,k.jsx)(kr.Provider,{value:g,children:r})};function Cr(){return new Map}function Ir(){let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];const r=(0,e.useContext)(kr);if(null===r)return[!0,null];const{isPresent:a,onExitComplete:n,register:s}=r,i=(0,e.useId)();(0,e.useEffect)(()=>{if(t)return s(i)},[t]);const o=(0,e.useCallback)(()=>t&&n&&n(i),[i,n,t]);return!a&&n?[!1,o]:[!0]}const Tr=e=>e.key||"";function Dr(t){const r=[];return e.Children.forEach(t,t=>{(0,e.isValidElement)(t)&&r.push(t)}),r}const Pr=t=>{let{children:r,custom:a,initial:n=!0,onExitComplete:s,presenceAffectsLayout:i=!0,mode:o="sync",propagate:l=!1,anchorX:c="left",root:d}=t;const[u,h]=Ir(l),m=(0,e.useMemo)(()=>Dr(r),[r]),f=l&&!u?[]:m.map(Tr),g=(0,e.useRef)(!0),p=(0,e.useRef)(m),x=vr(()=>new Map),[y,v]=(0,e.useState)(m),[b,w]=(0,e.useState)(m);wr(()=>{g.current=!1,p.current=m;for(let e=0;e<b.length;e++){const t=Tr(b[e]);f.includes(t)?x.delete(t):!0!==x.get(t)&&x.set(t,!1)}},[b,f.length,f.join("-")]);const N=[];if(m!==y){let e=[...m];for(let t=0;t<b.length;t++){const r=b[t],a=Tr(r);f.includes(a)||(e.splice(t,0,r),N.push(r))}return"wait"===o&&N.length&&(e=N),w(Dr(e)),v(m),null}const{forceRender:j}=(0,e.useContext)(yr);return(0,k.jsx)(k.Fragment,{children:b.map(e=>{const t=Tr(e),r=!(l&&!u)&&(m===b||f.includes(t));return(0,k.jsx)(Ar,{isPresent:r,initial:!(g.current&&!n)&&void 0,custom:a,presenceAffectsLayout:i,mode:o,root:d,onExitComplete:r?void 0:()=>{if(!x.has(t))return;x.set(t,!0);let e=!0;x.forEach(t=>{t||(e=!1)}),e&&(null===j||void 0===j||j(),w(p.current),l&&(null===h||void 0===h||h()),s&&s())},anchorX:c,children:e},t)})})},Fr=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Lr=(()=>new Set(Fr))(),Mr=e=>180*e/Math.PI,Rr=e=>{const t=Mr(Math.atan2(e[1],e[0]));return Br(t)},Or={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:e=>(Math.abs(e[0])+Math.abs(e[3]))/2,rotate:Rr,rotateZ:Rr,skewX:e=>Mr(Math.atan(e[1])),skewY:e=>Mr(Math.atan(e[2])),skew:e=>(Math.abs(e[1])+Math.abs(e[2]))/2},Br=e=>((e%=360)<0&&(e+=360),e),zr=e=>Math.sqrt(e[0]*e[0]+e[1]*e[1]),Ur=e=>Math.sqrt(e[4]*e[4]+e[5]*e[5]),Vr={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:zr,scaleY:Ur,scale:e=>(zr(e)+Ur(e))/2,rotateX:e=>Br(Mr(Math.atan2(e[6],e[5]))),rotateY:e=>Br(Mr(Math.atan2(-e[2],e[0]))),rotateZ:Rr,rotate:Rr,skewX:e=>Mr(Math.atan(e[4])),skewY:e=>Mr(Math.atan(e[1])),skew:e=>(Math.abs(e[1])+Math.abs(e[4]))/2};function qr(e){return e.includes("scale")?1:0}function Hr(e,t){if(!e||"none"===e)return qr(t);const r=e.match(/^matrix3d\(([\t-\r ,-\.0-9e\xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+)\)$/);let a,n;if(r)a=Vr,n=r;else{const t=e.match(/^matrix\(([\t-\r ,-\.0-9e\xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+)\)$/);a=Or,n=t}if(!n)return qr(t);const s=a[t],i=n[1].split(",").map(Gr);return"function"===typeof s?s(i):i[s]}function Gr(e){return parseFloat(e.trim())}const Wr=e=>t=>"string"===typeof t&&t.startsWith(e),Kr=Wr("--"),Qr=Wr("var(--"),Yr=e=>!!Qr(e)&&Xr.test(e.split("/*")[0].trim()),Xr=/var\(--(?:[\x2D0-9A-Z_a-z\u017F\u212A]+[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*|[\x2D0-9A-Z_a-z\u017F\u212A]+[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*,(?:[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*(?:(?![\t-\r \(\)\xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uD800-\uDFFF\uFEFF])[^]|[\uD800-\uDBFF][\uDC00-\uDFFF])|[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*\((?:(?:(?![\(\)\uD800-\uDFFF])[^]|[\uD800-\uDBFF][\uDC00-\uDFFF])|\((?:(?![\(\)\uD800-\uDFFF])[^]|[\uD800-\uDBFF][\uDC00-\uDFFF])*\))*\))+[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*)\)$/i;function Jr(e){let{top:t,left:r,right:a,bottom:n}=e;return{x:{min:r,max:a},y:{min:t,max:n}}}const Zr=(e,t,r)=>e+(t-e)*r;function $r(e){return void 0===e||1===e}function ea(e){let{scale:t,scaleX:r,scaleY:a}=e;return!$r(t)||!$r(r)||!$r(a)}function ta(e){return ea(e)||ra(e)||e.z||e.rotate||e.rotateX||e.rotateY||e.skewX||e.skewY}function ra(e){return aa(e.x)||aa(e.y)}function aa(e){return e&&"0%"!==e}function na(e,t,r){return r+t*(e-r)}function sa(e,t,r,a,n){return void 0!==n&&(e=na(e,n,a)),na(e,r,a)+t}function ia(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3?arguments[3]:void 0,n=arguments.length>4?arguments[4]:void 0;e.min=sa(e.min,t,r,a,n),e.max=sa(e.max,t,r,a,n)}function oa(e,t){let{x:r,y:a}=t;ia(e.x,r.translate,r.scale,r.originPoint),ia(e.y,a.translate,a.scale,a.originPoint)}const la=.999999999999,ca=1.0000000000001;function da(e,t){e.min=e.min+t,e.max=e.max+t}function ua(e,t,r,a){let n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.5;ia(e,t,r,Zr(e.min,e.max,n),a)}function ha(e,t){ua(e.x,t.x,t.scaleX,t.scale,t.originX),ua(e.y,t.y,t.scaleY,t.scale,t.originY)}function ma(e,t){return Jr(function(e,t){if(!t)return e;const r=t({x:e.left,y:e.top}),a=t({x:e.right,y:e.bottom});return{top:r.y,left:r.x,bottom:a.y,right:a.x}}(e.getBoundingClientRect(),t))}const fa=new Set(["width","height","top","left","right","bottom",...Fr]),ga=(e,t,r)=>r>t?t:r<e?e:r,pa={test:e=>"number"===typeof e,parse:parseFloat,transform:e=>e},xa=(0,n.A)((0,n.A)({},pa),{},{transform:e=>ga(0,1,e)}),ya=(0,n.A)((0,n.A)({},pa),{},{default:1}),va=e=>({test:t=>"string"===typeof t&&t.endsWith(e)&&1===t.split(" ").length,parse:parseFloat,transform:t=>"".concat(t).concat(e)}),ba=va("deg"),wa=va("%"),ka=va("px"),Na=va("vh"),ja=va("vw"),Sa=(()=>(0,n.A)((0,n.A)({},wa),{},{parse:e=>wa.parse(e)/100,transform:e=>wa.transform(100*e)}))(),_a=e=>t=>t.test(e),Ea=[pa,ka,wa,ba,ja,Na,{test:e=>"auto"===e,parse:e=>e}],Aa=e=>Ea.find(_a(e));const Ca=e=>/^-?(?:[0-9]+(?:\.[0-9]+)?|\.[0-9]+)$/.test(e),Ia=/^var\(--(?:([\x2D0-9A-Z_a-z]+)|([\x2D0-9A-Z_a-z]+), ?([ #%\(\),-\.0-9A-Za-z]+))\)/;function Ta(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;'Max CSS variable fallback depth detected in property "'.concat(e,'". This may indicate a circular fallback dependency.');const[a,n]=function(e){const t=Ia.exec(e);if(!t)return[,];const[,r,a,n]=t;return["--".concat(null!==r&&void 0!==r?r:a),n]}(e);if(!a)return;const s=window.getComputedStyle(t).getPropertyValue(a);if(s){const e=s.trim();return Ca(e)?parseFloat(e):e}return Yr(n)?Ta(n,t,r+1):n}const Da=e=>e===pa||e===ka,Pa=new Set(["x","y","z"]),Fa=Fr.filter(e=>!Pa.has(e));const La={width:(e,t)=>{let{x:r}=e,{paddingLeft:a="0",paddingRight:n="0"}=t;return r.max-r.min-parseFloat(a)-parseFloat(n)},height:(e,t)=>{let{y:r}=e,{paddingTop:a="0",paddingBottom:n="0"}=t;return r.max-r.min-parseFloat(a)-parseFloat(n)},top:(e,t)=>{let{top:r}=t;return parseFloat(r)},left:(e,t)=>{let{left:r}=t;return parseFloat(r)},bottom:(e,t)=>{let{y:r}=e,{top:a}=t;return parseFloat(a)+(r.max-r.min)},right:(e,t)=>{let{x:r}=e,{left:a}=t;return parseFloat(a)+(r.max-r.min)},x:(e,t)=>{let{transform:r}=t;return Hr(r,"x")},y:(e,t)=>{let{transform:r}=t;return Hr(r,"y")}};La.translateX=La.x,La.translateY=La.y;const Ma=e=>e,Ra={},Oa=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"],Ba={value:null,addProjectionMetrics:null};function za(e,t){let r=!1,a=!0;const n={delta:0,timestamp:0,isProcessing:!1},s=()=>r=!0,i=Oa.reduce((e,r)=>(e[r]=function(e,t){let r=new Set,a=new Set,n=!1,s=!1;const i=new WeakSet;let o={delta:0,timestamp:0,isProcessing:!1},l=0;function c(t){i.has(t)&&(d.schedule(t),e()),l++,t(o)}const d={schedule:function(e){const t=arguments.length>2&&void 0!==arguments[2]&&arguments[2]&&n?r:a;return arguments.length>1&&void 0!==arguments[1]&&arguments[1]&&i.add(e),t.has(e)||t.add(e),e},cancel:e=>{a.delete(e),i.delete(e)},process:e=>{o=e,n?s=!0:(n=!0,[r,a]=[a,r],r.forEach(c),t&&Ba.value&&Ba.value.frameloop[t].push(l),l=0,r.clear(),n=!1,s&&(s=!1,d.process(e)))}};return d}(s,t?r:void 0),e),{}),{setup:o,read:l,resolveKeyframes:c,preUpdate:d,update:u,preRender:h,render:m,postRender:f}=i,g=()=>{const s=Ra.useManualTiming?n.timestamp:performance.now();r=!1,Ra.useManualTiming||(n.delta=a?1e3/60:Math.max(Math.min(s-n.timestamp,40),1)),n.timestamp=s,n.isProcessing=!0,o.process(n),l.process(n),c.process(n),d.process(n),u.process(n),h.process(n),m.process(n),f.process(n),n.isProcessing=!1,r&&t&&(a=!1,e(g))},p=Oa.reduce((t,s)=>{const o=i[s];return t[s]=function(t){let s=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return r||(r=!0,a=!0,n.isProcessing||e(g)),o.schedule(t,s,i)},t},{});return{schedule:p,cancel:e=>{for(let t=0;t<Oa.length;t++)i[Oa[t]].cancel(e)},state:n,steps:i}}const{schedule:Ua,cancel:Va,state:qa,steps:Ha}=za("undefined"!==typeof requestAnimationFrame?requestAnimationFrame:Ma,!0),Ga=new Set;let Wa=!1,Ka=!1,Qa=!1;function Ya(){if(Ka){const e=Array.from(Ga).filter(e=>e.needsMeasurement),t=new Set(e.map(e=>e.element)),r=new Map;t.forEach(e=>{const t=function(e){const t=[];return Fa.forEach(r=>{const a=e.getValue(r);void 0!==a&&(t.push([r,a.get()]),a.set(r.startsWith("scale")?1:0))}),t}(e);t.length&&(r.set(e,t),e.render())}),e.forEach(e=>e.measureInitialState()),t.forEach(e=>{e.render();const t=r.get(e);t&&t.forEach(t=>{var r;let[a,n]=t;null===(r=e.getValue(a))||void 0===r||r.set(n)})}),e.forEach(e=>e.measureEndState()),e.forEach(e=>{void 0!==e.suspendedScrollY&&window.scrollTo(0,e.suspendedScrollY)})}Ka=!1,Wa=!1,Ga.forEach(e=>e.complete(Qa)),Ga.clear()}function Xa(){Ga.forEach(e=>{e.readKeyframes(),e.needsMeasurement&&(Ka=!0)})}class Ja{constructor(e,t,r,a,n){let s=arguments.length>5&&void 0!==arguments[5]&&arguments[5];this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...e],this.onComplete=t,this.name=r,this.motionValue=a,this.element=n,this.isAsync=s}scheduleResolve(){this.state="scheduled",this.isAsync?(Ga.add(this),Wa||(Wa=!0,Ua.read(Xa),Ua.resolveKeyframes(Ya))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:t,element:r,motionValue:a}=this;if(null===e[0]){const n=null===a||void 0===a?void 0:a.get(),s=e[e.length-1];if(void 0!==n)e[0]=n;else if(r&&t){const a=r.readValue(t,s);void 0!==a&&null!==a&&(e[0]=a)}void 0===e[0]&&(e[0]=s),a&&void 0===n&&a.set(e[0])}!function(e){for(let r=1;r<e.length;r++){var t;null!==(t=e[r])&&void 0!==t||(e[r]=e[r-1])}}(e)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,e),Ga.delete(this)}cancel(){"scheduled"===this.state&&(Ga.delete(this),this.state="pending")}resume(){"pending"===this.state&&this.scheduleResolve()}}const Za=e=>/^0(?:[\0-\x08\x0E-\x1F!-\x2D\/-\x9F\xA1-\u167F\u1681-\u1FFF\u200B-\u2027\u202A-\u202E\u2030-\u205E\u2060-\u2FFF\u3001-\uD7FF\uE000-\uFEFE\uFF00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+$/.test(e);function $a(e){return"number"===typeof e?0===e:null===e||("none"===e||"0"===e||Za(e))}const en=e=>Math.round(1e5*e)/1e5,tn=/-?(?:[0-9]+(?:\.[0-9]+)?|\.[0-9]+)/g;const rn=/^(?:#[0-9a-f]{3,8}|(?:rgb|h[s\u017F]l)a?\((?:-?[\.0-9]+%?[\t-\r ,\xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+){2}-?[\.0-9]+%?[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*(?:[,\/][\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*)?(?:\b[0-9]+(?:\.[0-9]+)?|\.[0-9]+)?%?\))$/i,an=(e,t)=>r=>Boolean("string"===typeof r&&rn.test(r)&&r.startsWith(e)||t&&!function(e){return null==e}(r)&&Object.prototype.hasOwnProperty.call(r,t)),nn=(e,t,r)=>a=>{if("string"!==typeof a)return a;const[n,s,i,o]=a.match(tn);return{[e]:parseFloat(n),[t]:parseFloat(s),[r]:parseFloat(i),alpha:void 0!==o?parseFloat(o):1}},sn=(0,n.A)((0,n.A)({},pa),{},{transform:e=>Math.round((e=>ga(0,255,e))(e))}),on={test:an("rgb","red"),parse:nn("red","green","blue"),transform:e=>{let{red:t,green:r,blue:a,alpha:n=1}=e;return"rgba("+sn.transform(t)+", "+sn.transform(r)+", "+sn.transform(a)+", "+en(xa.transform(n))+")"}};const ln={test:an("#"),parse:function(e){let t="",r="",a="",n="";return e.length>5?(t=e.substring(1,3),r=e.substring(3,5),a=e.substring(5,7),n=e.substring(7,9)):(t=e.substring(1,2),r=e.substring(2,3),a=e.substring(3,4),n=e.substring(4,5),t+=t,r+=r,a+=a,n+=n),{red:parseInt(t,16),green:parseInt(r,16),blue:parseInt(a,16),alpha:n?parseInt(n,16)/255:1}},transform:on.transform},cn={test:an("hsl","hue"),parse:nn("hue","saturation","lightness"),transform:e=>{let{hue:t,saturation:r,lightness:a,alpha:n=1}=e;return"hsla("+Math.round(t)+", "+wa.transform(en(r))+", "+wa.transform(en(a))+", "+en(xa.transform(n))+")"}},dn={test:e=>on.test(e)||ln.test(e)||cn.test(e),parse:e=>on.test(e)?on.parse(e):cn.test(e)?cn.parse(e):ln.parse(e),transform:e=>"string"===typeof e?e:e.hasOwnProperty("red")?on.transform(e):cn.transform(e),getAnimatableNone:e=>{const t=dn.parse(e);return t.alpha=0,dn.transform(t)}},un=/(?:#[0-9a-f]{3,8}|(?:rgb|h[s\u017F]l)a?\((?:-?[\.0-9]+%?[\t-\r ,\xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+){2}-?[\.0-9]+%?[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*(?:[,\/][\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*)?(?:\b[0-9]+(?:\.[0-9]+)?|\.[0-9]+)?%?\))/gi;const hn="number",mn="color",fn=/var[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*\([\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*--(?:[\x2D0-9A-Z_a-z\u017F\u212A]+[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*|[\x2D0-9A-Z_a-z\u017F\u212A]+[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*,(?:[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*(?:(?![\t-\r \(\)\xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uD800-\uDFFF\uFEFF])[^]|[\uD800-\uDBFF][\uDC00-\uDFFF])|[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*\((?:(?:(?![\(\)\uD800-\uDFFF])[^]|[\uD800-\uDBFF][\uDC00-\uDFFF])|\((?:(?![\(\)\uD800-\uDFFF])[^]|[\uD800-\uDBFF][\uDC00-\uDFFF])*\))*\))+[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*)\)|#[0-9a-f]{3,8}|(?:rgb|h[s\u017F]l)a?\((?:-?[\.0-9]+%?[\t-\r ,\xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+){2}-?[\.0-9]+%?[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*(?:[,\/][\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*)?(?:\b[0-9]+(?:\.[0-9]+)?|\.[0-9]+)?%?\)|-?(?:[0-9]+(?:\.[0-9]+)?|\.[0-9]+)/gi;function gn(e){const t=e.toString(),r=[],a={color:[],number:[],var:[]},n=[];let s=0;const i=t.replace(fn,e=>(dn.test(e)?(a.color.push(s),n.push(mn),r.push(dn.parse(e))):e.startsWith("var(")?(a.var.push(s),n.push("var"),r.push(e)):(a.number.push(s),n.push(hn),r.push(parseFloat(e))),++s,"${}")).split("${}");return{values:r,split:i,indexes:a,types:n}}function pn(e){return gn(e).values}function xn(e){const{split:t,types:r}=gn(e),a=t.length;return e=>{let n="";for(let s=0;s<a;s++)if(n+=t[s],void 0!==e[s]){const t=r[s];n+=t===hn?en(e[s]):t===mn?dn.transform(e[s]):e[s]}return n}}const yn=e=>"number"===typeof e?0:dn.test(e)?dn.getAnimatableNone(e):e;const vn={test:function(e){var t,r;return isNaN(e)&&"string"===typeof e&&((null===(t=e.match(tn))||void 0===t?void 0:t.length)||0)+((null===(r=e.match(un))||void 0===r?void 0:r.length)||0)>0},parse:pn,createTransformer:xn,getAnimatableNone:function(e){const t=pn(e);return xn(e)(t.map(yn))}},bn=new Set(["brightness","contrast","saturate","opacity"]);function wn(e){const[t,r]=e.slice(0,-1).split("(");if("drop-shadow"===t)return e;const[a]=r.match(tn)||[];if(!a)return e;const n=r.replace(a,"");let s=bn.has(t)?1:0;return a!==r&&(s*=100),t+"("+s+n+")"}const kn=/\b([\x2Da-z]*)\((?:[\0-\t\x0B\f\x0E-\u2027\u202A-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*?\)/g,Nn=(0,n.A)((0,n.A)({},vn),{},{getAnimatableNone:e=>{const t=e.match(kn);return t?t.map(wn).join(" "):e}}),jn=(0,n.A)((0,n.A)({},pa),{},{transform:Math.round}),Sn={rotate:ba,rotateX:ba,rotateY:ba,rotateZ:ba,scale:ya,scaleX:ya,scaleY:ya,scaleZ:ya,skew:ba,skewX:ba,skewY:ba,distance:ka,translateX:ka,translateY:ka,translateZ:ka,x:ka,y:ka,z:ka,perspective:ka,transformPerspective:ka,opacity:xa,originX:Sa,originY:Sa,originZ:ka},_n=(0,n.A)((0,n.A)({borderWidth:ka,borderTopWidth:ka,borderRightWidth:ka,borderBottomWidth:ka,borderLeftWidth:ka,borderRadius:ka,radius:ka,borderTopLeftRadius:ka,borderTopRightRadius:ka,borderBottomRightRadius:ka,borderBottomLeftRadius:ka,width:ka,maxWidth:ka,height:ka,maxHeight:ka,top:ka,right:ka,bottom:ka,left:ka,padding:ka,paddingTop:ka,paddingRight:ka,paddingBottom:ka,paddingLeft:ka,margin:ka,marginTop:ka,marginRight:ka,marginBottom:ka,marginLeft:ka,backgroundPositionX:ka,backgroundPositionY:ka},Sn),{},{zIndex:jn,fillOpacity:xa,strokeOpacity:xa,numOctaves:jn}),En=(0,n.A)((0,n.A)({},_n),{},{color:dn,backgroundColor:dn,outlineColor:dn,fill:dn,stroke:dn,borderColor:dn,borderTopColor:dn,borderRightColor:dn,borderBottomColor:dn,borderLeftColor:dn,filter:Nn,WebkitFilter:Nn}),An=e=>En[e];function Cn(e,t){let r=An(e);return r!==Nn&&(r=vn),r.getAnimatableNone?r.getAnimatableNone(t):void 0}const In=new Set(["auto","none","0"]);class Tn extends Ja{constructor(e,t,r,a,n){super(e,t,r,a,n,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:t,name:r}=this;if(!t||!t.current)return;super.readKeyframes();for(let o=0;o<e.length;o++){let r=e[o];if("string"===typeof r&&(r=r.trim(),Yr(r))){const a=Ta(r,t.current);void 0!==a&&(e[o]=a),o===e.length-1&&(this.finalKeyframe=r)}}if(this.resolveNoneKeyframes(),!fa.has(r)||2!==e.length)return;const[a,n]=e,s=Aa(a),i=Aa(n);if(s!==i)if(Da(s)&&Da(i))for(let o=0;o<e.length;o++){const t=e[o];"string"===typeof t&&(e[o]=parseFloat(t))}else La[r]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:t}=this,r=[];for(let a=0;a<e.length;a++)(null===e[a]||$a(e[a]))&&r.push(a);r.length&&function(e,t,r){let a,n=0;for(;n<e.length&&!a;){const t=e[n];"string"===typeof t&&!In.has(t)&&gn(t).values.length&&(a=e[n]),n++}if(a&&r)for(const s of t)e[s]=Cn(r,a)}(e,r,t)}measureInitialState(){const{element:e,unresolvedKeyframes:t,name:r}=this;if(!e||!e.current)return;"height"===r&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=La[r](e.measureViewportBox(),window.getComputedStyle(e.current)),t[0]=this.measuredOrigin;const a=t[t.length-1];void 0!==a&&e.getValue(r,a).jump(a,!1)}measureEndState(){var e;const{element:t,name:r,unresolvedKeyframes:a}=this;if(!t||!t.current)return;const n=t.getValue(r);n&&n.jump(this.measuredOrigin,!1);const s=a.length-1,i=a[s];a[s]=La[r](t.measureViewportBox(),window.getComputedStyle(t.current)),null!==i&&void 0===this.finalKeyframe&&(this.finalKeyframe=i),null!==(e=this.removedTransforms)&&void 0!==e&&e.length&&this.removedTransforms.forEach(e=>{let[r,a]=e;t.getValue(r).set(a)}),this.resolveNoneKeyframes()}}const Dn=e=>Boolean(e&&e.getVelocity);let Pn;function Fn(){Pn=void 0}const Ln={now:()=>(void 0===Pn&&Ln.set(qa.isProcessing||Ra.useManualTiming?qa.timestamp:performance.now()),Pn),set:e=>{Pn=e,queueMicrotask(Fn)}};function Mn(e,t){-1===e.indexOf(t)&&e.push(t)}function Rn(e,t){const r=e.indexOf(t);r>-1&&e.splice(r,1)}class On{constructor(){this.subscriptions=[]}add(e){return Mn(this.subscriptions,e),()=>Rn(this.subscriptions,e)}notify(e,t,r){const a=this.subscriptions.length;if(a)if(1===a)this.subscriptions[0](e,t,r);else for(let n=0;n<a;n++){const a=this.subscriptions[n];a&&a(e,t,r)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}function Bn(e,t){return t?e*(1e3/t):0}const zn={current:void 0};class Un{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.canTrackVelocity=null,this.events={},this.updateAndNotify=e=>{const t=Ln.now();var r;if((this.updatedAt!==t&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(e),this.current!==this.prev)&&(null===(r=this.events.change)||void 0===r||r.notify(this.current),this.dependents))for(const a of this.dependents)a.dirty()},this.hasAnimated=!1,this.setCurrent(e),this.owner=t.owner}setCurrent(e){var t;this.current=e,this.updatedAt=Ln.now(),null===this.canTrackVelocity&&void 0!==e&&(this.canTrackVelocity=(t=this.current,!isNaN(parseFloat(t))))}setPrevFrameValue(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.current;this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,t){this.events[e]||(this.events[e]=new On);const r=this.events[e].add(t);return"change"===e?()=>{r(),Ua.read(()=>{this.events.change.getSize()||this.stop()})}:r}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,t){this.passiveEffect=e,this.stopPassiveEffect=t}set(e){this.passiveEffect?this.passiveEffect(e,this.updateAndNotify):this.updateAndNotify(e)}setWithVelocity(e,t,r){this.set(t),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-r}jump(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,t&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){var e;null===(e=this.events.change)||void 0===e||e.notify(this.current)}addDependent(e){this.dependents||(this.dependents=new Set),this.dependents.add(e)}removeDependent(e){this.dependents&&this.dependents.delete(e)}get(){return zn.current&&zn.current.push(this),this.current}getPrevious(){return this.prev}getVelocity(){const e=Ln.now();if(!this.canTrackVelocity||void 0===this.prevFrameValue||e-this.updatedAt>30)return 0;const t=Math.min(this.updatedAt-this.prevUpdatedAt,30);return Bn(parseFloat(this.current)-parseFloat(this.prevFrameValue),t)}start(e){return this.stop(),new Promise(t=>{this.hasAnimated=!0,this.animation=e(t),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){var e,t;null===(e=this.dependents)||void 0===e||e.clear(),null===(t=this.events.destroy)||void 0===t||t.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Vn(e,t){return new Un(e,t)}const qn=[...Ea,dn,vn],{schedule:Hn,cancel:Gn}=za(queueMicrotask,!1),Wn={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Kn={};for(const r in Wn)Kn[r]={isEnabled:e=>Wn[r].some(t=>!!e[t])};const Qn=()=>({x:{min:0,max:0},y:{min:0,max:0}}),Yn={current:null},Xn={current:!1};const Jn=new WeakMap;function Zn(e){return null!==e&&"object"===typeof e&&"function"===typeof e.start}function $n(e){return"string"===typeof e||Array.isArray(e)}const es=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],ts=["initial",...es];function rs(e){return Zn(e.animate)||ts.some(t=>$n(e[t]))}function as(e){return Boolean(rs(e)||e.variants)}function ns(e){const t=[{},{}];return null===e||void 0===e||e.values.forEach((e,r)=>{t[0][r]=e.get(),t[1][r]=e.getVelocity()}),t}function ss(e,t,r,a){if("function"===typeof t){const[n,s]=ns(a);t=t(void 0!==r?r:e.custom,n,s)}if("string"===typeof t&&(t=e.variants&&e.variants[t]),"function"===typeof t){const[n,s]=ns(a);t=t(void 0!==r?r:e.custom,n,s)}return t}const is=["willChange"],os=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class ls{scrapeMotionValuesFromProps(e,t,r){return{}}constructor(e){let{parent:t,props:r,presenceContext:s,reducedMotionConfig:i,blockInitialAnimation:o,visualState:l}=e,c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=Ja,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const e=Ln.now();this.renderScheduledAt<e&&(this.renderScheduledAt=e,Ua.render(this.render,!1,!0))};const{latestValues:d,renderState:u}=l;this.latestValues=d,this.baseTarget=(0,n.A)({},d),this.initialValues=r.initial?(0,n.A)({},d):{},this.renderState=u,this.parent=t,this.props=r,this.presenceContext=s,this.depth=t?t.depth+1:0,this.reducedMotionConfig=i,this.options=c,this.blockInitialAnimation=Boolean(o),this.isControllingVariants=rs(r),this.isVariantNode=as(r),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=Boolean(t&&t.current);const h=this.scrapeMotionValuesFromProps(r,{},this),{willChange:m}=h,f=(0,a.A)(h,is);for(const a in f){const e=f[a];void 0!==d[a]&&Dn(e)&&e.set(d[a])}}mount(e){var t;this.current=e,Jn.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((e,t)=>this.bindToMotionValue(t,e)),Xn.current||function(){if(Xn.current=!0,br)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>Yn.current=e.matches;e.addEventListener("change",t),t()}else Yn.current=!1}(),this.shouldReduceMotion="never"!==this.reducedMotionConfig&&("always"===this.reducedMotionConfig||Yn.current),null===(t=this.parent)||void 0===t||t.addChild(this),this.update(this.props,this.presenceContext)}unmount(){var e;this.projection&&this.projection.unmount(),Va(this.notifyUpdate),Va(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),null===(e=this.parent)||void 0===e||e.removeChild(this);for(const t in this.events)this.events[t].clear();for(const t in this.features){const e=this.features[t];e&&(e.unmount(),e.isMounted=!1)}this.current=null}addChild(e){var t;this.children.add(e),null!==(t=this.enteringChildren)&&void 0!==t||(this.enteringChildren=new Set),this.enteringChildren.add(e)}removeChild(e){this.children.delete(e),this.enteringChildren&&this.enteringChildren.delete(e)}bindToMotionValue(e,t){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const r=Lr.has(e);r&&this.onBindTransform&&this.onBindTransform();const a=t.on("change",t=>{this.latestValues[e]=t,this.props.onUpdate&&Ua.preRender(this.notifyUpdate),r&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let n;window.MotionCheckAppearSync&&(n=window.MotionCheckAppearSync(this,e,t)),this.valueSubscriptions.set(e,()=>{a(),n&&n(),t.owner&&t.stop()})}sortNodePosition(e){return this.current&&this.sortInstanceNodePosition&&this.type===e.type?this.sortInstanceNodePosition(this.current,e.current):0}updateFeatures(){let e="animation";for(e in Kn){const t=Kn[e];if(!t)continue;const{isEnabled:r,Feature:a}=t;if(!this.features[e]&&a&&r(this.props)&&(this.features[e]=new a(this)),this.features[e]){const t=this.features[e];t.isMounted?t.update():(t.mount(),t.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):{x:{min:0,max:0},y:{min:0,max:0}}}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,t){this.latestValues[e]=t}update(e,t){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=t;for(let r=0;r<os.length;r++){const t=os[r];this.propEventSubscriptions[t]&&(this.propEventSubscriptions[t](),delete this.propEventSubscriptions[t]);const a=e["on"+t];a&&(this.propEventSubscriptions[t]=this.on(t,a))}this.prevMotionValues=function(e,t,r){for(const a in t){const n=t[a],s=r[a];if(Dn(n))e.addValue(a,n);else if(Dn(s))e.addValue(a,Vn(n,{owner:e}));else if(s!==n)if(e.hasValue(a)){const t=e.getValue(a);!0===t.liveStyle?t.jump(n):t.hasAnimated||t.set(n)}else{const t=e.getStaticValue(a);e.addValue(a,Vn(void 0!==t?t:n,{owner:e}))}}for(const a in r)void 0===t[a]&&e.removeValue(a);return t}(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const t=this.getClosestVariantNode();if(t)return t.variantChildren&&t.variantChildren.add(e),()=>t.variantChildren.delete(e)}addValue(e,t){const r=this.values.get(e);t!==r&&(r&&this.removeValue(e),this.bindToMotionValue(e,t),this.values.set(e,t),this.latestValues[e]=t.get())}removeValue(e){this.values.delete(e);const t=this.valueSubscriptions.get(e);t&&(t(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,t){if(this.props.values&&this.props.values[e])return this.props.values[e];let r=this.values.get(e);return void 0===r&&void 0!==t&&(r=Vn(null===t?void 0:t,{owner:this}),this.addValue(e,r)),r}readValue(e,t){var r;let a=void 0===this.latestValues[e]&&this.current?null!==(r=this.getBaseTargetFromProps(this.props,e))&&void 0!==r?r:this.readValueFromInstance(this.current,e,this.options):this.latestValues[e];return void 0!==a&&null!==a&&("string"===typeof a&&(Ca(a)||Za(a))?a=parseFloat(a):!(e=>qn.find(_a(e)))(a)&&vn.test(t)&&(a=Cn(e,t)),this.setBaseTarget(e,Dn(a)?a.get():a)),Dn(a)?a.get():a}setBaseTarget(e,t){this.baseTarget[e]=t}getBaseTarget(e){const{initial:t}=this.props;let r;if("string"===typeof t||"object"===typeof t){var a;const n=ss(this.props,t,null===(a=this.presenceContext)||void 0===a?void 0:a.custom);n&&(r=n[e])}if(t&&void 0!==r)return r;const n=this.getBaseTargetFromProps(this.props,e);return void 0===n||Dn(n)?void 0!==this.initialValues[e]&&void 0===r?void 0:this.baseTarget[e]:n}on(e,t){return this.events[e]||(this.events[e]=new On),this.events[e].add(t)}notify(e){if(this.events[e]){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];this.events[e].notify(...r)}}scheduleRenderMicrotask(){Hn.render(this.render)}}class cs extends ls{constructor(){super(...arguments),this.KeyframeResolver=Tn}sortInstanceNodePosition(e,t){return 2&e.compareDocumentPosition(t)?1:-1}getBaseTargetFromProps(e,t){return e.style?e.style[t]:void 0}removeValueFromRenderState(e,t){let{vars:r,style:a}=t;delete r[e],delete a[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;Dn(e)&&(this.childSubscription=e.on("change",e=>{this.current&&(this.current.textContent="".concat(e))}))}}const ds=(e,t)=>t&&"number"===typeof e?t.transform(e):e,us={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},hs=Fr.length;function ms(e,t,r){const{style:a,vars:n,transformOrigin:s}=e;let i=!1,o=!1;for(const l in t){const e=t[l];if(Lr.has(l))i=!0;else if(Kr(l))n[l]=e;else{const t=ds(e,_n[l]);l.startsWith("origin")?(o=!0,s[l]=t):a[l]=t}}if(t.transform||(i||r?a.transform=function(e,t,r){let a="",n=!0;for(let s=0;s<hs;s++){const i=Fr[s],o=e[i];if(void 0===o)continue;let l=!0;if(l="number"===typeof o?o===(i.startsWith("scale")?1:0):0===parseFloat(o),!l||r){const e=ds(o,_n[i]);l||(n=!1,a+="".concat(us[i]||i,"(").concat(e,") ")),r&&(t[i]=e)}}return a=a.trim(),r?a=r(t,n?"":a):n&&(a="none"),a}(t,e.transform,r):a.transform&&(a.transform="none")),o){const{originX:e="50%",originY:t="50%",originZ:r=0}=s;a.transformOrigin="".concat(e," ").concat(t," ").concat(r)}}function fs(e,t,r,a){let{style:n,vars:s}=t;const i=e.style;let o;for(o in n)i[o]=n[o];for(o in null===a||void 0===a||a.applyProjectionStyles(i,r),s)i.setProperty(o,s[o])}const gs={};function ps(e,t){let{layout:r,layoutId:a}=t;return Lr.has(e)||e.startsWith("origin")||(r||void 0!==a)&&(!!gs[e]||"opacity"===e)}function xs(e,t,r){const{style:a}=e,n={};for(const i in a){var s;(Dn(a[i])||t.style&&Dn(t.style[i])||ps(i,e)||void 0!==(null===r||void 0===r||null===(s=r.getValue(i))||void 0===s?void 0:s.liveStyle))&&(n[i]=a[i])}return n}class ys extends cs{constructor(){super(...arguments),this.type="html",this.renderInstance=fs}readValueFromInstance(e,t){var r,a;if(Lr.has(t))return null!==(r=this.projection)&&void 0!==r&&r.isProjecting?qr(t):((e,t)=>{const{transform:r="none"}=getComputedStyle(e);return Hr(r,t)})(e,t);{const r=(a=e,window.getComputedStyle(a)),n=(Kr(t)?r.getPropertyValue(t):r[t])||0;return"string"===typeof n?n.trim():n}}measureInstanceViewportBox(e,t){let{transformPagePoint:r}=t;return ma(e,r)}build(e,t,r){ms(e,t,r.transformTemplate)}scrapeMotionValuesFromProps(e,t,r){return xs(e,t,r)}}const vs=e=>e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),bs={offset:"stroke-dashoffset",array:"stroke-dasharray"},ws={offset:"strokeDashoffset",array:"strokeDasharray"};const ks=["attrX","attrY","attrScale","pathLength","pathSpacing","pathOffset"];function Ns(e,t,r,n,s){let{attrX:i,attrY:o,attrScale:l,pathLength:c,pathSpacing:d=1,pathOffset:u=0}=t;if(ms(e,(0,a.A)(t,ks),n),r)return void(e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox));e.attrs=e.style,e.style={};const{attrs:h,style:m}=e;var f,g;(h.transform&&(m.transform=h.transform,delete h.transform),m.transform||h.transformOrigin)&&(m.transformOrigin=null!==(f=h.transformOrigin)&&void 0!==f?f:"50% 50%",delete h.transformOrigin);m.transform&&(m.transformBox=null!==(g=null===s||void 0===s?void 0:s.transformBox)&&void 0!==g?g:"fill-box",delete h.transformBox);void 0!==i&&(h.x=i),void 0!==o&&(h.y=o),void 0!==l&&(h.scale=l),void 0!==c&&function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,n=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];e.pathLength=1;const s=n?bs:ws;e[s.offset]=ka.transform(-a);const i=ka.transform(t),o=ka.transform(r);e[s.array]="".concat(i," ").concat(o)}(h,c,d,u,!1)}const js=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]),Ss=e=>"string"===typeof e&&"svg"===e.toLowerCase();function _s(e,t,r){const a=xs(e,t,r);for(const n in e)if(Dn(e[n])||Dn(t[n])){a[-1!==Fr.indexOf(n)?"attr"+n.charAt(0).toUpperCase()+n.substring(1):n]=e[n]}return a}class Es extends cs{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=Qn}getBaseTargetFromProps(e,t){return e[t]}readValueFromInstance(e,t){if(Lr.has(t)){const e=An(t);return e&&e.default||0}return t=js.has(t)?t:vs(t),e.getAttribute(t)}scrapeMotionValuesFromProps(e,t,r){return _s(e,t,r)}build(e,t,r){Ns(e,t,this.isSVGTag,r.transformTemplate,r.style)}renderInstance(e,t,r,a){!function(e,t,r,a){fs(e,t,void 0,a);for(const n in t.attrs)e.setAttribute(js.has(n)?n:vs(n),t.attrs[n])}(e,t,0,a)}mount(e){this.isSVGTag=Ss(e.tagName),super.mount(e)}}const As=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function Cs(e){return"string"===typeof e&&!e.includes("-")&&!!(As.indexOf(e)>-1||/[A-Z]/.test(e))}const Is=(t,r)=>Cs(t)?new Es(r):new ys(r,{allowProjection:t!==e.Fragment}),Ts=(0,e.createContext)({strict:!1}),Ds=(0,e.createContext)({});function Ps(t){const{initial:r,animate:a}=function(e,t){if(rs(e)){const{initial:t,animate:r}=e;return{initial:!1===t||$n(t)?t:void 0,animate:$n(r)?r:void 0}}return!1!==e.inherit?t:{}}(t,(0,e.useContext)(Ds));return(0,e.useMemo)(()=>({initial:r,animate:a}),[Fs(r),Fs(a)])}function Fs(e){return Array.isArray(e)?e.join(" "):e}const Ls=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function Ms(e,t,r){for(const a in t)Dn(t[a])||ps(a,r)||(e[a]=t[a])}function Rs(t,r){const a={};return Ms(a,t.style||{},t),Object.assign(a,function(t,r){let{transformTemplate:a}=t;return(0,e.useMemo)(()=>{const e={style:{},transform:{},transformOrigin:{},vars:{}};return ms(e,r,a),Object.assign({},e.vars,e.style)},[r])}(t,r)),a}function Os(e,t){const r={},a=Rs(e,t);return e.drag&&!1!==e.dragListener&&(r.draggable=!1,a.userSelect=a.WebkitUserSelect=a.WebkitTouchCallout="none",a.touchAction=!0===e.drag?"none":"pan-".concat("x"===e.drag?"y":"x")),void 0===e.tabIndex&&(e.onTap||e.onTapStart||e.whileTap)&&(r.tabIndex=0),r.style=a,r}const Bs=()=>(0,n.A)((0,n.A)({},{style:{},transform:{},transformOrigin:{},vars:{}}),{},{attrs:{}});function zs(t,r,a,s){const i=(0,e.useMemo)(()=>{const e=Bs();return Ns(e,r,Ss(s),t.transformTemplate,t.style),(0,n.A)((0,n.A)({},e.attrs),{},{style:(0,n.A)({},e.style)})},[r]);if(t.style){const e={};Ms(e,t.style,t),i.style=(0,n.A)((0,n.A)({},e),i.style)}return i}const Us=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function Vs(e){return e.startsWith("while")||e.startsWith("drag")&&"draggable"!==e||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||Us.has(e)}let qs=e=>!Vs(e);try{"function"===typeof(Hs=require("@emotion/is-prop-valid").default)&&(qs=e=>e.startsWith("on")?!Vs(e):Hs(e))}catch(Z_){}var Hs;function Gs(t,r,a,s,i){let{latestValues:o}=s,l=arguments.length>5&&void 0!==arguments[5]&&arguments[5];const c=(Cs(t)?zs:Os)(r,o,i,t),d=function(e,t,r){const a={};for(const n in e)"values"===n&&"object"===typeof e.values||(qs(n)||!0===r&&Vs(n)||!t&&!Vs(n)||e.draggable&&n.startsWith("onDrag"))&&(a[n]=e[n]);return a}(r,"string"===typeof t,l),u=t!==e.Fragment?(0,n.A)((0,n.A)((0,n.A)({},d),c),{},{ref:a}):{},{children:h}=r,m=(0,e.useMemo)(()=>Dn(h)?h.get():h,[h]);return(0,e.createElement)(t,(0,n.A)((0,n.A)({},u),{},{children:m}))}function Ws(e){return Dn(e)?e.get():e}const Ks=["transitionEnd","transition"];function Qs(e,t,r,n){const s={},i=n(e,{});for(const a in i)s[a]=Ws(i[a]);let{initial:o,animate:l}=e;const c=rs(e),d=as(e);t&&d&&!c&&!1!==e.inherit&&(void 0===o&&(o=t.initial),void 0===l&&(l=t.animate));let u=!!r&&!1===r.initial;u=u||!1===o;const h=u?l:o;if(h&&"boolean"!==typeof h&&!Zn(h)){const t=Array.isArray(h)?h:[h];for(let r=0;r<t.length;r++){const n=ss(e,t[r]);if(n){const{transitionEnd:e,transition:t}=n,r=(0,a.A)(n,Ks);for(const a in r){let e=r[a];if(Array.isArray(e)){e=e[u?e.length-1:0]}null!==e&&(s[a]=e)}for(const a in e)s[a]=e[a]}}}return s}const Ys=t=>(r,a)=>{const n=(0,e.useContext)(Ds),s=(0,e.useContext)(kr),i=()=>function(e,t,r,a){let{scrapeMotionValuesFromProps:n,createRenderState:s}=e;return{latestValues:Qs(t,r,a,n),renderState:s()}}(t,r,n,s);return a?i():vr(i)},Xs=Ys({scrapeMotionValuesFromProps:xs,createRenderState:Ls}),Js=Ys({scrapeMotionValuesFromProps:_s,createRenderState:Bs});const Zs=Symbol.for("motionComponentSymbol");function $s(e){return e&&"object"===typeof e&&Object.prototype.hasOwnProperty.call(e,"current")}function ei(t,r,a){return(0,e.useCallback)(e=>{e&&t.onMount&&t.onMount(e),r&&(e?r.mount(e):r.unmount()),a&&("function"===typeof a?a(e):$s(a)&&(a.current=e))},[r,a])}const ti="data-"+vs("framerAppearId"),ri=(0,e.createContext)({});function ai(t,r,a,n,s){var i,o,l,c;const{visualElement:d}=(0,e.useContext)(Ds),u=(0,e.useContext)(Ts),h=(0,e.useContext)(kr),m=(0,e.useContext)(Sr).reducedMotion,f=(0,e.useRef)(null);n=n||u.renderer,!f.current&&n&&(f.current=n(t,{visualState:r,parent:d,props:a,presenceContext:h,blockInitialAnimation:!!h&&!1===h.initial,reducedMotionConfig:m}));const g=f.current,p=(0,e.useContext)(ri);!g||g.projection||!s||"html"!==g.type&&"svg"!==g.type||function(e,t,r,a){const{layoutId:n,layout:s,drag:i,dragConstraints:o,layoutScroll:l,layoutRoot:c,layoutCrossfade:d}=t;e.projection=new r(e.latestValues,t["data-framer-portal-id"]?void 0:ni(e.parent)),e.projection.setOptions({layoutId:n,layout:s,alwaysMeasureLayout:Boolean(i)||o&&$s(o),visualElement:e,animationType:"string"===typeof s?s:"both",initialPromotionConfig:a,crossfade:d,layoutScroll:l,layoutRoot:c})}(f.current,a,s,p);const x=(0,e.useRef)(!1);(0,e.useInsertionEffect)(()=>{g&&x.current&&g.update(a,h)});const y=a[ti],v=(0,e.useRef)(Boolean(y)&&!(null!==(i=(o=window).MotionHandoffIsComplete)&&void 0!==i&&i.call(o,y))&&(null===(l=(c=window).MotionHasOptimisedAnimation)||void 0===l?void 0:l.call(c,y)));return wr(()=>{g&&(x.current=!0,window.MotionIsMounted=!0,g.updateFeatures(),g.scheduleRenderMicrotask(),v.current&&g.animationState&&g.animationState.animateChanges())}),(0,e.useEffect)(()=>{g&&(!v.current&&g.animationState&&g.animationState.animateChanges(),v.current&&(queueMicrotask(()=>{var e,t;null===(e=(t=window).MotionHandoffMarkAsComplete)||void 0===e||e.call(t,y)}),v.current=!1),g.enteringChildren=void 0)}),g}function ni(e){if(e)return!1!==e.options.allowProjection?e.projection:ni(e.parent)}function si(t){var r,a;let{forwardMotionProps:s=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2?arguments[2]:void 0,o=arguments.length>3?arguments[3]:void 0;i&&function(e){for(const t in e)Kn[t]=(0,n.A)((0,n.A)({},Kn[t]),e[t])}(i);const l=Cs(t)?Js:Xs;function c(r,a){let i;const c=(0,n.A)((0,n.A)((0,n.A)({},(0,e.useContext)(Sr)),r),{},{layoutId:ii(r)}),{isStatic:d}=c,u=Ps(r),h=l(r,d);if(!d&&br){!function(){(0,e.useContext)(Ts).strict;0}();const r=function(e){const{drag:t,layout:r}=Kn;if(!t&&!r)return{};const a=(0,n.A)((0,n.A)({},t),r);return{MeasureLayout:null!==t&&void 0!==t&&t.isEnabled(e)||null!==r&&void 0!==r&&r.isEnabled(e)?a.MeasureLayout:void 0,ProjectionNode:a.ProjectionNode}}(c);i=r.MeasureLayout,u.visualElement=ai(t,h,c,o,r.ProjectionNode)}return(0,k.jsxs)(Ds.Provider,{value:u,children:[i&&u.visualElement?(0,k.jsx)(i,(0,n.A)({visualElement:u.visualElement},c)):null,Gs(t,r,ei(h,u.visualElement,a),h,d,s)]})}c.displayName="motion.".concat("string"===typeof t?t:"create(".concat(null!==(r=null!==(a=t.displayName)&&void 0!==a?a:t.name)&&void 0!==r?r:"",")"));const d=(0,e.forwardRef)(c);return d[Zs]=t,d}function ii(t){let{layoutId:r}=t;const a=(0,e.useContext)(yr).id;return a&&void 0!==r?a+"-"+r:r}function oi(e,t){if("undefined"===typeof Proxy)return si;const r=new Map,a=(r,a)=>si(r,a,e,t);return new Proxy((e,t)=>a(e,t),{get:(n,s)=>"create"===s?a:(r.has(s)||r.set(s,si(s,void 0,e,t)),r.get(s))})}function li(e,t,r){const a=e.getProps();return ss(a,t,void 0!==r?r:a.custom,e)}function ci(e,t){var r,a;return null!==(r=null!==(a=null===e||void 0===e?void 0:e[t])&&void 0!==a?a:null===e||void 0===e?void 0:e.default)&&void 0!==r?r:e}const di=e=>Array.isArray(e),ui=["transitionEnd","transition"];function hi(e,t,r){e.hasValue(t)?e.getValue(t).set(r):e.addValue(t,Vn(r))}function mi(e){return di(e)?e[e.length-1]||0:e}function fi(e,t){const r=e.getValue("willChange");if(a=r,Boolean(Dn(a)&&a.add))return r.add(t);if(!r&&Ra.WillChange){const r=new Ra.WillChange("auto");e.addValue("willChange",r),r.add(t)}var a}function gi(e){return e.props[ti]}function pi(e){e.duration=0,e.type}const xi=(e,t)=>r=>t(e(r)),yi=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.reduce(xi)},vi=e=>1e3*e,bi=e=>e/1e3,wi={layout:0,mainThread:0,waapi:0};function ki(e,t,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?e+6*(t-e)*r:r<.5?t:r<2/3?e+(t-e)*(2/3-r)*6:e}function Ni(e,t){return r=>r>0?t:e}const ji=(e,t,r)=>{const a=e*e,n=r*(t*t-a)+a;return n<0?0:Math.sqrt(n)},Si=[ln,on,cn];function _i(e){const t=(e=>Si.find(t=>t.test(e)))(e);if(Boolean(t),"'".concat(e,"' is not an animatable color. Use the equivalent color code instead."),!Boolean(t))return!1;let r=t.parse(e);return t===cn&&(r=function(e){let{hue:t,saturation:r,lightness:a,alpha:n}=e;t/=360,r/=100,a/=100;let s=0,i=0,o=0;if(r){const e=a<.5?a*(1+r):a+r-a*r,n=2*a-e;s=ki(n,e,t+1/3),i=ki(n,e,t),o=ki(n,e,t-1/3)}else s=i=o=a;return{red:Math.round(255*s),green:Math.round(255*i),blue:Math.round(255*o),alpha:n}}(r)),r}const Ei=(e,t)=>{const r=_i(e),a=_i(t);if(!r||!a)return Ni(e,t);const s=(0,n.A)({},r);return e=>(s.red=ji(r.red,a.red,e),s.green=ji(r.green,a.green,e),s.blue=ji(r.blue,a.blue,e),s.alpha=Zr(r.alpha,a.alpha,e),on.transform(s))},Ai=new Set(["none","hidden"]);function Ci(e,t){return r=>Zr(e,t,r)}function Ii(e){return"number"===typeof e?Ci:"string"===typeof e?Yr(e)?Ni:dn.test(e)?Ei:Pi:Array.isArray(e)?Ti:"object"===typeof e?dn.test(e)?Ei:Di:Ni}function Ti(e,t){const r=[...e],a=r.length,n=e.map((e,r)=>Ii(e)(e,t[r]));return e=>{for(let t=0;t<a;t++)r[t]=n[t](e);return r}}function Di(e,t){const r=(0,n.A)((0,n.A)({},e),t),a={};for(const n in r)void 0!==e[n]&&void 0!==t[n]&&(a[n]=Ii(e[n])(e[n],t[n]));return e=>{for(const t in a)r[t]=a[t](e);return r}}const Pi=(e,t)=>{const r=vn.createTransformer(t),a=gn(e),n=gn(t);return a.indexes.var.length===n.indexes.var.length&&a.indexes.color.length===n.indexes.color.length&&a.indexes.number.length>=n.indexes.number.length?Ai.has(e)&&!n.values.length||Ai.has(t)&&!a.values.length?function(e,t){return Ai.has(e)?r=>r<=0?e:t:r=>r>=1?t:e}(e,t):yi(Ti(function(e,t){const r=[],a={color:0,var:0,number:0};for(let s=0;s<t.values.length;s++){var n;const i=t.types[s],o=e.indexes[i][a[i]],l=null!==(n=e.values[o])&&void 0!==n?n:0;r[s]=l,a[i]++}return r}(a,n),n.values),r):("Complex values '".concat(e,"' and '").concat(t,"' too different to mix. Ensure all colors are of the same type, and that each contains the same quantity of number and color values. Falling back to instant transition."),Ni(e,t))};function Fi(e,t,r){if("number"===typeof e&&"number"===typeof t&&"number"===typeof r)return Zr(e,t,r);return Ii(e)(e,t)}const Li=e=>{const t=t=>{let{timestamp:r}=t;return e(r)};return{start:function(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return Ua.update(t,e)},stop:()=>Va(t),now:()=>qa.isProcessing?qa.timestamp:Ln.now()}},Mi=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,a="";const n=Math.max(Math.round(t/r),2);for(let s=0;s<n;s++)a+=Math.round(1e4*e(s/(n-1)))/1e4+", ";return"linear(".concat(a.substring(0,a.length-2),")")},Ri=2e4;function Oi(e){let t=0;let r=e.next(t);for(;!r.done&&t<Ri;)t+=50,r=e.next(t);return t>=Ri?1/0:t}function Bi(e,t,r){const a=Math.max(t-5,0);return Bn(r-e(a),t-a)}const zi={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},Ui=.001;function Vi(e){let t,r,{duration:a=zi.duration,bounce:n=zi.bounce,velocity:s=zi.velocity,mass:i=zi.mass}=e;vi(zi.maxDuration);let o=1-n;o=ga(zi.minDamping,zi.maxDamping,o),a=ga(zi.minDuration,zi.maxDuration,bi(a)),o<1?(t=e=>{const t=e*o,r=t*a,n=t-s,i=Hi(e,o),l=Math.exp(-r);return Ui-n/i*l},r=e=>{const r=e*o*a,n=r*s+s,i=Math.pow(o,2)*Math.pow(e,2)*a,l=Math.exp(-r),c=Hi(Math.pow(e,2),o);return(-t(e)+Ui>0?-1:1)*((n-i)*l)/c}):(t=e=>Math.exp(-e*a)*((e-s)*a+1)-.001,r=e=>Math.exp(-e*a)*(a*a*(s-e)));const l=function(e,t,r){let a=r;for(let n=1;n<qi;n++)a-=e(a)/t(a);return a}(t,r,5/a);if(a=vi(a),isNaN(l))return{stiffness:zi.stiffness,damping:zi.damping,duration:a};{const e=Math.pow(l,2)*i;return{stiffness:e,damping:2*o*Math.sqrt(i*e),duration:a}}}const qi=12;function Hi(e,t){return e*Math.sqrt(1-t*t)}const Gi=["duration","bounce"],Wi=["stiffness","damping","mass"];function Ki(e,t){return t.some(t=>void 0!==e[t])}function Qi(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:zi.visualDuration,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:zi.bounce;const r="object"!==typeof e?{visualDuration:e,keyframes:[0,1],bounce:t}:e;let{restSpeed:a,restDelta:s}=r;const i=r.keyframes[0],o=r.keyframes[r.keyframes.length-1],l={done:!1,value:i},{stiffness:c,damping:d,mass:u,duration:h,velocity:m,isResolvedFromDuration:f}=function(e){let t=(0,n.A)({velocity:zi.velocity,stiffness:zi.stiffness,damping:zi.damping,mass:zi.mass,isResolvedFromDuration:!1},e);if(!Ki(e,Wi)&&Ki(e,Gi))if(e.visualDuration){const r=e.visualDuration,a=2*Math.PI/(1.2*r),s=a*a,i=2*ga(.05,1,1-(e.bounce||0))*Math.sqrt(s);t=(0,n.A)((0,n.A)({},t),{},{mass:zi.mass,stiffness:s,damping:i})}else{const r=Vi(e);t=(0,n.A)((0,n.A)((0,n.A)({},t),r),{},{mass:zi.mass}),t.isResolvedFromDuration=!0}return t}((0,n.A)((0,n.A)({},r),{},{velocity:-bi(r.velocity||0)})),g=m||0,p=d/(2*Math.sqrt(c*u)),x=o-i,y=bi(Math.sqrt(c/u)),v=Math.abs(x)<5;let b;if(a||(a=v?zi.restSpeed.granular:zi.restSpeed.default),s||(s=v?zi.restDelta.granular:zi.restDelta.default),p<1){const e=Hi(y,p);b=t=>{const r=Math.exp(-p*y*t);return o-r*((g+p*y*x)/e*Math.sin(e*t)+x*Math.cos(e*t))}}else if(1===p)b=e=>o-Math.exp(-y*e)*(x+(g+y*x)*e);else{const e=y*Math.sqrt(p*p-1);b=t=>{const r=Math.exp(-p*y*t),a=Math.min(e*t,300);return o-r*((g+p*y*x)*Math.sinh(a)+e*x*Math.cosh(a))/e}}const w={calculatedDuration:f&&h||null,next:e=>{const t=b(e);if(f)l.done=e>=h;else{let r=0===e?g:0;p<1&&(r=0===e?vi(g):Bi(b,e,t));const n=Math.abs(r)<=a,i=Math.abs(o-t)<=s;l.done=n&&i}return l.value=l.done?o:t,l},toString:()=>{const e=Math.min(Oi(w),Ri),t=Mi(t=>w.next(e*t).value,e,30);return e+"ms "+t},toTransition:()=>{}};return w}function Yi(e){let{keyframes:t,velocity:r=0,power:a=.8,timeConstant:n=325,bounceDamping:s=10,bounceStiffness:i=500,modifyTarget:o,min:l,max:c,restDelta:d=.5,restSpeed:u}=e;const h=t[0],m={done:!1,value:h},f=e=>void 0===l?c:void 0===c||Math.abs(l-e)<Math.abs(c-e)?l:c;let g=a*r;const p=h+g,x=void 0===o?p:o(p);x!==p&&(g=x-h);const y=e=>-g*Math.exp(-e/n),v=e=>x+y(e),b=e=>{const t=y(e),r=v(e);m.done=Math.abs(t)<=d,m.value=m.done?x:r};let w,k;const N=e=>{(e=>void 0!==l&&e<l||void 0!==c&&e>c)(m.value)&&(w=e,k=Qi({keyframes:[m.value,f(m.value)],velocity:Bi(v,e,m.value),damping:s,stiffness:i,restDelta:d,restSpeed:u}))};return N(0),{calculatedDuration:null,next:e=>{let t=!1;return k||void 0!==w||(t=!0,b(e),N(e)),void 0!==w&&e>=w?k.next(e-w):(!t&&b(e),m)}}}Qi.applyToOptions=e=>{const t=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;const r=(arguments.length>2?arguments[2]:void 0)((0,n.A)((0,n.A)({},e),{},{keyframes:[0,t]})),a=Math.min(Oi(r),Ri);return{type:"keyframes",ease:e=>r.next(a*e).value/t,duration:bi(a)}}(e,100,Qi);return e.ease=t.ease,e.duration=vi(t.duration),e.type="keyframes",e};const Xi=(e,t,r)=>(((1-3*r+3*t)*e+(3*r-6*t))*e+3*t)*e;function Ji(e,t,r,a){if(e===t&&r===a)return Ma;const n=t=>function(e,t,r,a,n){let s,i,o=0;do{i=t+(r-t)/2,s=Xi(i,a,n)-e,s>0?r=i:t=i}while(Math.abs(s)>1e-7&&++o<12);return i}(t,0,1,e,r);return e=>0===e||1===e?e:Xi(n(e),t,a)}const Zi=Ji(.42,0,1,1),$i=Ji(0,0,.58,1),eo=Ji(.42,0,.58,1),to=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,ro=e=>t=>1-e(1-t),ao=Ji(.33,1.53,.69,.99),no=ro(ao),so=to(no),io=e=>(e*=2)<1?.5*no(e):.5*(2-Math.pow(2,-10*(e-1))),oo=e=>1-Math.sin(Math.acos(e)),lo=ro(oo),co=to(oo),uo=e=>Array.isArray(e)&&"number"===typeof e[0],ho={linear:Ma,easeIn:Zi,easeInOut:eo,easeOut:$i,circIn:oo,circInOut:co,circOut:lo,backIn:no,backInOut:so,backOut:ao,anticipate:io},mo=e=>{if(uo(e)){e.length;const[t,r,a,n]=e;return Ji(t,r,a,n)}return"string"===typeof e?("Invalid easing type '".concat(e,"'"),ho[e]):e},fo=(e,t,r)=>{const a=t-e;return 0===a?1:(r-e)/a};function go(e,t){let{clamp:r=!0,ease:a,mixer:n}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const s=e.length;if(t.length,1===s)return()=>t[0];if(2===s&&t[0]===t[1])return()=>t[1];const i=e[0]===e[1];e[0]>e[s-1]&&(e=[...e].reverse(),t=[...t].reverse());const o=function(e,t,r){const a=[],n=r||Ra.mix||Fi,s=e.length-1;for(let i=0;i<s;i++){let r=n(e[i],e[i+1]);if(t){const e=Array.isArray(t)?t[i]||Ma:t;r=yi(e,r)}a.push(r)}return a}(t,a,n),l=o.length,c=r=>{if(i&&r<e[0])return t[0];let a=0;if(l>1)for(;a<e.length-2&&!(r<e[a+1]);a++);const n=fo(e[a],e[a+1],r);return o[a](n)};return r?t=>c(ga(e[0],e[s-1],t)):c}function po(e){const t=[0];return function(e,t){const r=e[e.length-1];for(let a=1;a<=t;a++){const n=fo(0,t,a);e.push(Zr(r,1,n))}}(t,e.length-1),t}function xo(e){let{duration:t=300,keyframes:r,times:a,ease:n="easeInOut"}=e;const s=(e=>Array.isArray(e)&&"number"!==typeof e[0])(n)?n.map(mo):mo(n),i={done:!1,value:r[0]},o=function(e,t){return e.map(e=>e*t)}(a&&a.length===r.length?a:po(r),t),l=go(o,r,{ease:Array.isArray(s)?s:(c=r,d=s,c.map(()=>d||eo).splice(0,c.length-1))});var c,d;return{calculatedDuration:t,next:e=>(i.value=l(e),i.done=e>=t,i)}}const yo=e=>null!==e;function vo(e,t,r){let{repeat:a,repeatType:n="loop"}=t,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;const i=e.filter(yo),o=s<0||a&&"loop"!==n&&a%2===1?0:i.length-1;return o&&void 0!==r?r:i[o]}const bo={decay:Yi,inertia:Yi,tween:xo,keyframes:xo,spring:Qi};function wo(e){"string"===typeof e.type&&(e.type=bo[e.type])}class ko{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(e=>{this.resolve=e})}notifyFinished(){this.resolve()}then(e,t){return this.finished.then(e,t)}}const No=e=>e/100;class jo extends ko{constructor(e){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{var e,t;const{motionValue:r}=this.options;r&&r.updatedAt!==Ln.now()&&this.tick(Ln.now()),this.isStopped=!0,"idle"!==this.state&&(this.teardown(),null===(e=(t=this.options).onStop)||void 0===e||e.call(t))},wi.mainThread++,this.options=e,this.initAnimation(),this.play(),!1===e.autoplay&&this.pause()}initAnimation(){const{options:e}=this;wo(e);const{type:t=xo,repeat:r=0,repeatDelay:a=0,repeatType:s,velocity:i=0}=e;let{keyframes:o}=e;const l=t||xo;l!==xo&&"number"!==typeof o[0]&&(this.mixKeyframes=yi(No,Fi(o[0],o[1])),o=[0,100]);const c=l((0,n.A)((0,n.A)({},e),{},{keyframes:o}));"mirror"===s&&(this.mirroredGenerator=l((0,n.A)((0,n.A)({},e),{},{keyframes:[...o].reverse(),velocity:-i}))),null===c.calculatedDuration&&(c.calculatedDuration=Oi(c));const{calculatedDuration:d}=c;this.calculatedDuration=d,this.resolvedDuration=d+a,this.totalDuration=this.resolvedDuration*(r+1)-a,this.generator=c}updateTime(e){const t=Math.round(e-this.startTime)*this.playbackSpeed;null!==this.holdTime?this.currentTime=this.holdTime:this.currentTime=t}tick(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const{generator:r,totalDuration:a,mixKeyframes:n,mirroredGenerator:s,resolvedDuration:i,calculatedDuration:o}=this;if(null===this.startTime)return r.next(0);const{delay:l=0,keyframes:c,repeat:d,repeatType:u,repeatDelay:h,type:m,onUpdate:f,finalKeyframe:g}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-a/this.speed,this.startTime)),t?this.currentTime=e:this.updateTime(e);const p=this.currentTime-l*(this.playbackSpeed>=0?1:-1),x=this.playbackSpeed>=0?p<0:p>a;this.currentTime=Math.max(p,0),"finished"===this.state&&null===this.holdTime&&(this.currentTime=a);let y=this.currentTime,v=r;if(d){const e=Math.min(this.currentTime,a)/i;let t=Math.floor(e),r=e%1;!r&&e>=1&&(r=1),1===r&&t--,t=Math.min(t,d+1);Boolean(t%2)&&("reverse"===u?(r=1-r,h&&(r-=h/i)):"mirror"===u&&(v=s)),y=ga(0,1,r)*i}const b=x?{done:!1,value:c[0]}:v.next(y);n&&(b.value=n(b.value));let{done:w}=b;x||null===o||(w=this.playbackSpeed>=0?this.currentTime>=a:this.currentTime<=0);const k=null===this.holdTime&&("finished"===this.state||"running"===this.state&&w);return k&&m!==Yi&&(b.value=vo(c,this.options,g,this.speed)),f&&f(b.value),k&&this.finish(),b}then(e,t){return this.finished.then(e,t)}get duration(){return bi(this.calculatedDuration)}get time(){return bi(this.currentTime)}set time(e){var t;e=vi(e),this.currentTime=e,null===this.startTime||null!==this.holdTime||0===this.playbackSpeed?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.playbackSpeed),null===(t=this.driver)||void 0===t||t.start(!1)}get speed(){return this.playbackSpeed}set speed(e){this.updateTime(Ln.now());const t=this.playbackSpeed!==e;this.playbackSpeed=e,t&&(this.time=bi(this.currentTime))}play(){var e,t;if(this.isStopped)return;const{driver:r=Li,startTime:a}=this.options;this.driver||(this.driver=r(e=>this.tick(e))),null===(e=(t=this.options).onPlay)||void 0===e||e.call(t);const n=this.driver.now();"finished"===this.state?(this.updateFinished(),this.startTime=n):null!==this.holdTime?this.startTime=n-this.holdTime:this.startTime||(this.startTime=null!==a&&void 0!==a?a:n),"finished"===this.state&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(Ln.now()),this.holdTime=this.currentTime}complete(){"running"!==this.state&&this.play(),this.state="finished",this.holdTime=null}finish(){var e,t;this.notifyFinished(),this.teardown(),this.state="finished",null===(e=(t=this.options).onComplete)||void 0===e||e.call(t)}cancel(){var e,t;this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),null===(e=(t=this.options).onCancel)||void 0===e||e.call(t)}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null,wi.mainThread--}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}attachTimeline(e){var t;return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),null===(t=this.driver)||void 0===t||t.stop(),e.observe(this)}}function So(e){let t;return()=>(void 0===t&&(t=e()),t)}const _o=So(()=>void 0!==window.ScrollTimeline),Eo={};function Ao(e,t){const r=So(e);return()=>{var e;return null!==(e=Eo[t])&&void 0!==e?e:r()}}const Co=Ao(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch(e){return!1}return!0},"linearEasing"),Io=e=>{let[t,r,a,n]=e;return"cubic-bezier(".concat(t,", ").concat(r,", ").concat(a,", ").concat(n,")")},To={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Io([0,.65,.55,1]),circOut:Io([.55,0,1,.45]),backIn:Io([.31,.01,.66,-.59]),backOut:Io([.33,1.53,.69,.99])};function Do(e,t){return e?"function"===typeof e?Co()?Mi(e,t):"ease-out":uo(e)?Io(e):Array.isArray(e)?e.map(e=>Do(e,t)||To.easeOut):To[e]:void 0}function Po(e,t,r){let{delay:a=0,duration:n=300,repeat:s=0,repeatType:i="loop",ease:o="easeOut",times:l}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:void 0;const d={[t]:r};l&&(d.offset=l);const u=Do(o,n);Array.isArray(u)&&(d.easing=u),Ba.value&&wi.waapi++;const h={delay:a,duration:n,easing:Array.isArray(u)?"linear":u,fill:"both",iterations:s+1,direction:"reverse"===i?"alternate":"normal"};c&&(h.pseudoElement=c);const m=e.animate(d,h);return Ba.value&&m.finished.finally(()=>{wi.waapi--}),m}function Fo(e){return"function"===typeof e&&"applyToOptions"in e}const Lo=["type"];class Mo extends ko{constructor(e){if(super(),this.finishedTime=null,this.isStopped=!1,!e)return;const{element:t,name:r,keyframes:n,pseudoElement:s,allowFlatten:i=!1,finalKeyframe:o,onComplete:l}=e;this.isPseudoElement=Boolean(s),this.allowFlatten=i,this.options=e,e.type;const c=function(e){let{type:t}=e,r=(0,a.A)(e,Lo);return Fo(t)&&Co()?t.applyToOptions(r):(null!==(n=r.duration)&&void 0!==n||(r.duration=300),null!==(s=r.ease)&&void 0!==s||(r.ease="easeOut"),r);var n,s}(e);this.animation=Po(t,r,n,c,s),!1===c.autoplay&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!s){const e=vo(n,this.options,o,this.speed);this.updateMotionValue?this.updateMotionValue(e):function(e,t,r){(e=>e.startsWith("--"))(t)?e.style.setProperty(t,r):e.style[t]=r}(t,r,e),this.animation.cancel()}null===l||void 0===l||l(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),"finished"===this.state&&this.updateFinished())}pause(){this.animation.pause()}complete(){var e,t;null===(e=(t=this.animation).finish)||void 0===e||e.call(t)}cancel(){try{this.animation.cancel()}catch(e){}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:e}=this;"idle"!==e&&"finished"!==e&&(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){var e,t;this.isPseudoElement||(null===(e=(t=this.animation).commitStyles)||void 0===e||e.call(t))}get duration(){var e,t;const r=(null===(e=this.animation.effect)||void 0===e||null===(t=e.getComputedTiming)||void 0===t?void 0:t.call(e).duration)||0;return bi(Number(r))}get time(){return bi(Number(this.animation.currentTime)||0)}set time(e){this.finishedTime=null,this.animation.currentTime=vi(e)}get speed(){return this.animation.playbackRate}set speed(e){e<0&&(this.finishedTime=null),this.animation.playbackRate=e}get state(){return null!==this.finishedTime?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(e){this.animation.startTime=e}attachTimeline(e){let{timeline:t,observe:r}=e;var a;this.allowFlatten&&(null===(a=this.animation.effect)||void 0===a||a.updateTiming({easing:"linear"}));return this.animation.onfinish=null,t&&_o()?(this.animation.timeline=t,Ma):r(this)}}const Ro={anticipate:io,backInOut:so,circInOut:co};function Oo(e){"string"===typeof e.ease&&e.ease in Ro&&(e.ease=Ro[e.ease])}const Bo=["motionValue","onUpdate","onComplete","element"];class zo extends Mo{constructor(e){Oo(e),wo(e),super(e),e.startTime&&(this.startTime=e.startTime),this.options=e}updateMotionValue(e){var t;const r=this.options,{motionValue:s,onUpdate:i,onComplete:o,element:l}=r,c=(0,a.A)(r,Bo);if(!s)return;if(void 0!==e)return void s.set(e);const d=new jo((0,n.A)((0,n.A)({},c),{},{autoplay:!1})),u=vi(null!==(t=this.finishedTime)&&void 0!==t?t:this.time);s.setWithVelocity(d.sample(u-10).value,d.sample(u).value,10),d.stop()}}const Uo=(e,t)=>"zIndex"!==t&&(!("number"!==typeof e&&!Array.isArray(e))||!("string"!==typeof e||!vn.test(e)&&"0"!==e||e.startsWith("url(")));const Vo=new Set(["opacity","clipPath","filter","transform"]),qo=So(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));const Ho=["autoplay","delay","type","repeat","repeatDelay","repeatType","keyframes","name","motionValue","element"];class Go extends ko{constructor(e){var t;let{autoplay:r=!0,delay:s=0,type:i="keyframes",repeat:o=0,repeatDelay:l=0,repeatType:c="loop",keyframes:d,name:u,motionValue:h,element:m}=e,f=(0,a.A)(e,Ho);super(),this.stop=()=>{var e,t;this._animation&&(this._animation.stop(),null===(t=this.stopTimeline)||void 0===t||t.call(this));null===(e=this.keyframeResolver)||void 0===e||e.cancel()},this.createdAt=Ln.now();const g=(0,n.A)({autoplay:r,delay:s,type:i,repeat:o,repeatDelay:l,repeatType:c,name:u,motionValue:h,element:m},f),p=(null===m||void 0===m?void 0:m.KeyframeResolver)||Ja;this.keyframeResolver=new p(d,(e,t,r)=>this.onKeyframesResolved(e,t,g,!r),u,h,m),null===(t=this.keyframeResolver)||void 0===t||t.scheduleResolve()}onKeyframesResolved(e,t,r,a){this.keyframeResolver=void 0;const{name:s,type:i,velocity:o,delay:l,isHandoff:c,onUpdate:d}=r;this.resolvedAt=Ln.now(),function(e,t,r,a){const n=e[0];if(null===n)return!1;if("display"===t||"visibility"===t)return!0;const s=e[e.length-1],i=Uo(n,t),o=Uo(s,t);return"You are trying to animate ".concat(t,' from "').concat(n,'" to "').concat(s,'". "').concat(i?s:n,'" is not an animatable value.'),!(!i||!o)&&(function(e){const t=e[0];if(1===e.length)return!0;for(let r=0;r<e.length;r++)if(e[r]!==t)return!0}(e)||("spring"===r||Fo(r))&&a)}(e,s,i,o)||(!Ra.instantAnimations&&l||null===d||void 0===d||d(vo(e,r,t)),e[0]=e[e.length-1],pi(r),r.repeat=0);const u=a?this.resolvedAt&&this.resolvedAt-this.createdAt>40?this.resolvedAt:this.createdAt:void 0,h=(0,n.A)((0,n.A)({startTime:u,finalKeyframe:t},r),{},{keyframes:e}),m=!c&&function(e){var t;const{motionValue:r,name:a,repeatDelay:n,repeatType:s,damping:i,type:o}=e;if(!((null===r||void 0===r||null===(t=r.owner)||void 0===t?void 0:t.current)instanceof HTMLElement))return!1;const{onUpdate:l,transformTemplate:c}=r.owner.getProps();return qo()&&a&&Vo.has(a)&&("transform"!==a||!c)&&!l&&!n&&"mirror"!==s&&0!==i&&"inertia"!==o}(h)?new zo((0,n.A)((0,n.A)({},h),{},{element:h.motionValue.owner.current})):new jo(h);m.finished.then(()=>this.notifyFinished()).catch(Ma),this.pendingTimeline&&(this.stopTimeline=m.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=m}get finished(){return this._animation?this.animation.finished:this._finished}then(e,t){return this.finished.finally(e).then(()=>{})}get animation(){var e;this._animation||(null===(e=this.keyframeResolver)||void 0===e||e.resume(),Qa=!0,Xa(),Ya(),Qa=!1);return this._animation}get duration(){return this.animation.duration}get time(){return this.animation.time}set time(e){this.animation.time=e}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(e){this.animation.speed=e}get startTime(){return this.animation.startTime}attachTimeline(e){return this._animation?this.stopTimeline=this.animation.attachTimeline(e):this.pendingTimeline=e,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){var e;this._animation&&this.animation.cancel(),null===(e=this.keyframeResolver)||void 0===e||e.cancel()}}const Wo=e=>null!==e;const Ko={type:"spring",stiffness:500,damping:25,restSpeed:10},Qo={type:"keyframes",duration:.8},Yo={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},Xo=(e,t)=>{let{keyframes:r}=t;return r.length>2?Qo:Lr.has(e)?e.startsWith("scale")?{type:"spring",stiffness:550,damping:0===r[1]?2*Math.sqrt(550):30,restSpeed:10}:Ko:Yo},Jo=["when","delay","delayChildren","staggerChildren","staggerDirection","repeat","repeatType","repeatDelay","from","elapsed"];const Zo=function(e,t,r){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=arguments.length>4?arguments[4]:void 0,o=arguments.length>5?arguments[5]:void 0;return l=>{const c=ci(s,e)||{},d=c.delay||s.delay||0;let{elapsed:u=0}=s;u-=vi(d);const h=(0,n.A)((0,n.A)({keyframes:Array.isArray(r)?r:[null,r],ease:"easeOut",velocity:t.getVelocity()},c),{},{delay:-u,onUpdate:e=>{t.set(e),c.onUpdate&&c.onUpdate(e)},onComplete:()=>{l(),c.onComplete&&c.onComplete()},name:e,motionValue:t,element:o?void 0:i});(function(e){let{when:t,delay:r,delayChildren:n,staggerChildren:s,staggerDirection:i,repeat:o,repeatType:l,repeatDelay:c,from:d,elapsed:u}=e,h=(0,a.A)(e,Jo);return!!Object.keys(h).length})(c)||Object.assign(h,Xo(e,h)),h.duration&&(h.duration=vi(h.duration)),h.repeatDelay&&(h.repeatDelay=vi(h.repeatDelay)),void 0!==h.from&&(h.keyframes[0]=h.from);let m=!1;if((!1===h.type||0===h.duration&&!h.repeatDelay)&&(pi(h),0===h.delay&&(m=!0)),(Ra.instantAnimations||Ra.skipAnimations)&&(m=!0,pi(h),h.delay=0),h.allowFlatten=!c.type&&!c.ease,m&&!o&&void 0!==t.get()){const e=function(e,t,r){let{repeat:a,repeatType:n="loop"}=t;const s=e.filter(Wo),i=a&&"loop"!==n&&a%2===1?0:s.length-1;return i&&void 0!==r?r:s[i]}(h.keyframes,c);if(void 0!==e)return void Ua.update(()=>{h.onUpdate(e),h.onComplete()})}return c.isSync?new jo(h):new Go(h)}},$o=["transition","transitionEnd"];function el(e,t){let{protectedKeys:r,needsAnimating:a}=e;const n=r.hasOwnProperty(t)&&!0!==a[t];return a[t]=!1,n}function tl(e,t){let{delay:r=0,transitionOverride:s,type:i}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{transition:o=e.getDefaultTransition(),transitionEnd:l}=t,c=(0,a.A)(t,$o);s&&(o=s);const d=[],u=i&&e.animationState&&e.animationState.getState()[i];for(const a in c){var h;const t=e.getValue(a,null!==(h=e.latestValues[a])&&void 0!==h?h:null),s=c[a];if(void 0===s||u&&el(u,a))continue;const i=(0,n.A)({delay:r},ci(o||{},a)),l=t.get();if(void 0!==l&&!t.isAnimating&&!Array.isArray(s)&&s===l&&!i.velocity)continue;let m=!1;if(window.MotionHandoffAnimation){const t=gi(e);if(t){const e=window.MotionHandoffAnimation(t,a,Ua);null!==e&&(i.startTime=e,m=!0)}}fi(e,a),t.start(Zo(a,t,s,e.shouldReduceMotion&&fa.has(a)?{type:!1}:i,e,m));const f=t.animation;f&&d.push(f)}return l&&Promise.all(d).then(()=>{Ua.update(()=>{l&&function(e,t){let r=li(e,t)||{},{transitionEnd:s={},transition:i={}}=r,o=(0,a.A)(r,ui);o=(0,n.A)((0,n.A)({},o),s);for(const a in o)hi(e,a,mi(o[a]))}(e,l)})}),d}function rl(e,t,r){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;const s=Array.from(e).sort((e,t)=>e.sortNodePosition(t)).indexOf(t),i=e.size,o=(i-1)*a;return"function"===typeof r?r(s,i):1===n?s*a:o-s*a}function al(e,t){var r;let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const s=li(e,t,"exit"===a.type?null===(r=e.presenceContext)||void 0===r?void 0:r.custom:void 0);let{transition:i=e.getDefaultTransition()||{}}=s||{};a.transitionOverride&&(i=a.transitionOverride);const o=s?()=>Promise.all(tl(e,s,a)):()=>Promise.resolve(),l=e.variantChildren&&e.variantChildren.size?function(){let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;const{delayChildren:s=0,staggerChildren:o,staggerDirection:l}=i;return function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,o=arguments.length>6?arguments[6]:void 0;const l=[];for(const c of e.variantChildren)c.notify("AnimationStart",t),l.push(al(c,t,(0,n.A)((0,n.A)({},o),{},{delay:r+("function"===typeof a?0:a)+rl(e.variantChildren,c,a,s,i)})).then(()=>c.notify("AnimationComplete",t)));return Promise.all(l)}(e,t,r,s,o,l,a)}:()=>Promise.resolve(),{when:c}=i;if(c){const[e,t]="beforeChildren"===c?[o,l]:[l,o];return e().then(()=>t())}return Promise.all([o(),l(a.delay)])}function nl(e,t){if(!Array.isArray(t))return!1;const r=t.length;if(r!==e.length)return!1;for(let a=0;a<r;a++)if(t[a]!==e[a])return!1;return!0}const sl=ts.length;function il(e){if(!e)return;if(!e.isControllingVariants){const t=e.parent&&il(e.parent)||{};return void 0!==e.props.initial&&(t.initial=e.props.initial),t}const t={};for(let r=0;r<sl;r++){const a=ts[r],n=e.props[a];($n(n)||!1===n)&&(t[a]=n)}return t}const ol=["transition","transitionEnd"],ll=[...es].reverse(),cl=es.length;function dl(e){return t=>Promise.all(t.map(t=>{let{animation:r,options:a}=t;return function(e,t){let r,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(e.notify("AnimationStart",t),Array.isArray(t)){const n=t.map(t=>al(e,t,a));r=Promise.all(n)}else if("string"===typeof t)r=al(e,t,a);else{const n="function"===typeof t?li(e,t,a.custom):t;r=Promise.all(tl(e,n,a))}return r.then(()=>{e.notify("AnimationComplete",t)})}(e,r,a)}))}function ul(e){let t=dl(e),r=fl(),s=!0;const i=t=>(r,s)=>{var i;const o=li(e,s,"exit"===t?null===(i=e.presenceContext)||void 0===i?void 0:i.custom:void 0);if(o){const{transition:e,transitionEnd:t}=o,s=(0,a.A)(o,ol);r=(0,n.A)((0,n.A)((0,n.A)({},r),s),t)}return r};function o(a){const{props:o}=e,l=il(e.parent)||{},c=[],d=new Set;let u={},h=1/0;for(let t=0;t<cl;t++){const m=ll[t],f=r[m],g=void 0!==o[m]?o[m]:l[m],p=$n(g),x=m===a?f.isActive:null;!1===x&&(h=t);let y=g===l[m]&&g!==o[m]&&p;if(y&&s&&e.manuallyAnimateOnMount&&(y=!1),f.protectedKeys=(0,n.A)({},u),!f.isActive&&null===x||!g&&!f.prevProp||Zn(g)||"boolean"===typeof g)continue;const v=hl(f.prevProp,g);let b=v||m===a&&f.isActive&&!y&&p||t>h&&p,w=!1;const k=Array.isArray(g)?g:[g];let N=k.reduce(i(m),{});!1===x&&(N={});const{prevResolvedValues:j={}}=f,S=(0,n.A)((0,n.A)({},j),N),_=t=>{b=!0,d.has(t)&&(w=!0,d.delete(t)),f.needsAnimating[t]=!0;const r=e.getValue(t);r&&(r.liveStyle=!1)};for(const e in S){const t=N[e],r=j[e];if(u.hasOwnProperty(e))continue;let a=!1;a=di(t)&&di(r)?!nl(t,r):t!==r,a?void 0!==t&&null!==t?_(e):d.add(e):void 0!==t&&d.has(e)?_(e):f.protectedKeys[e]=!0}f.prevProp=g,f.prevResolvedValues=N,f.isActive&&(u=(0,n.A)((0,n.A)({},u),N)),s&&e.blockInitialAnimation&&(b=!1);const E=y&&v;b&&(!E||w)&&c.push(...k.map(t=>{const r={type:m};if("string"===typeof t&&s&&!E&&e.manuallyAnimateOnMount&&e.parent){const{parent:a}=e,n=li(a,t);if(a.enteringChildren&&n){const{delayChildren:t}=n.transition||{};r.delay=rl(a.enteringChildren,e,t)}}return{animation:t,options:r}}))}if(d.size){const t={};if("boolean"!==typeof o.initial){const r=li(e,Array.isArray(o.initial)?o.initial[0]:o.initial);r&&r.transition&&(t.transition=r.transition)}d.forEach(r=>{const a=e.getBaseTarget(r),n=e.getValue(r);n&&(n.liveStyle=!0),t[r]=null!==a&&void 0!==a?a:null}),c.push({animation:t})}let m=Boolean(c.length);return!s||!1!==o.initial&&o.initial!==o.animate||e.manuallyAnimateOnMount||(m=!1),s=!1,m?t(c):Promise.resolve()}return{animateChanges:o,setActive:function(t,a){var n;if(r[t].isActive===a)return Promise.resolve();null===(n=e.variantChildren)||void 0===n||n.forEach(e=>{var r;return null===(r=e.animationState)||void 0===r?void 0:r.setActive(t,a)}),r[t].isActive=a;const s=o(t);for(const e in r)r[e].protectedKeys={};return s},setAnimateFunction:function(r){t=r(e)},getState:()=>r,reset:()=>{r=fl(),s=!0}}}function hl(e,t){return"string"===typeof t?t!==e:!!Array.isArray(t)&&!nl(t,e)}function ml(){return{isActive:arguments.length>0&&void 0!==arguments[0]&&arguments[0],protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function fl(){return{animate:ml(!0),whileInView:ml(),whileHover:ml(),whileTap:ml(),whileDrag:ml(),whileFocus:ml(),exit:ml()}}class gl{constructor(e){this.isMounted=!1,this.node=e}update(){}}let pl=0;const xl={animation:{Feature:class extends gl{constructor(e){super(e),e.animationState||(e.animationState=ul(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();Zn(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:t}=this.node.prevProps||{};e!==t&&this.updateAnimationControlsSubscription()}unmount(){var e;this.node.animationState.reset(),null===(e=this.unmountControls)||void 0===e||e.call(this)}}},exit:{Feature:class extends gl{constructor(){super(...arguments),this.id=pl++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:t}=this.node.presenceContext,{isPresent:r}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===r)return;const a=this.node.animationState.setActive("exit",!e);t&&!e&&a.then(()=>{t(this.id)})}mount(){const{register:e,onExitComplete:t}=this.node.presenceContext||{};t&&t(this.id),e&&(this.unmount=e(this.id))}unmount(){}}}},yl={x:!1,y:!1};function vl(){return yl.x||yl.y}function bl(e,t,r){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{passive:!0};return e.addEventListener(t,r,a),()=>e.removeEventListener(t,r)}const wl=e=>"mouse"===e.pointerType?"number"!==typeof e.button||e.button<=0:!1!==e.isPrimary;function kl(e){return{point:{x:e.pageX,y:e.pageY}}}function Nl(e,t,r,a){return bl(e,t,(e=>t=>wl(t)&&e(t,kl(t)))(r),a)}function jl(e){return e.max-e.min}function Sl(e,t,r){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5;e.origin=a,e.originPoint=Zr(t.min,t.max,e.origin),e.scale=jl(r)/jl(t),e.translate=Zr(r.min,r.max,e.origin)-e.originPoint,(e.scale>=.9999&&e.scale<=1.0001||isNaN(e.scale))&&(e.scale=1),(e.translate>=-.01&&e.translate<=.01||isNaN(e.translate))&&(e.translate=0)}function _l(e,t,r,a){Sl(e.x,t.x,r.x,a?a.originX:void 0),Sl(e.y,t.y,r.y,a?a.originY:void 0)}function El(e,t,r){e.min=r.min+t.min,e.max=e.min+jl(t)}function Al(e,t,r){e.min=t.min-r.min,e.max=e.min+jl(t)}function Cl(e,t,r){Al(e.x,t.x,r.x),Al(e.y,t.y,r.y)}function Il(e){return[e("x"),e("y")]}const Tl=e=>{let{current:t}=e;return t?t.ownerDocument.defaultView:null},Dl=(e,t)=>Math.abs(e-t);class Pl{constructor(e,t){let{transformPagePoint:r,contextWindow:a=window,dragSnapToOrigin:s=!1,distanceThreshold:i=3}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!this.lastMoveEvent||!this.lastMoveEventInfo)return;const e=Ml(this.lastMoveEventInfo,this.history),t=null!==this.startEvent,r=function(e,t){const r=Dl(e.x,t.x),a=Dl(e.y,t.y);return Math.sqrt(r**2+a**2)}(e.offset,{x:0,y:0})>=this.distanceThreshold;if(!t&&!r)return;const{point:a}=e,{timestamp:s}=qa;this.history.push((0,n.A)((0,n.A)({},a),{},{timestamp:s}));const{onStart:i,onMove:o}=this.handlers;t||(i&&i(this.lastMoveEvent,e),this.startEvent=this.lastMoveEvent),o&&o(this.lastMoveEvent,e)},this.handlePointerMove=(e,t)=>{this.lastMoveEvent=e,this.lastMoveEventInfo=Fl(t,this.transformPagePoint),Ua.update(this.updatePoint,!0)},this.handlePointerUp=(e,t)=>{this.end();const{onEnd:r,onSessionEnd:a,resumeAnimation:n}=this.handlers;if(this.dragSnapToOrigin&&n&&n(),!this.lastMoveEvent||!this.lastMoveEventInfo)return;const s=Ml("pointercancel"===e.type?this.lastMoveEventInfo:Fl(t,this.transformPagePoint),this.history);this.startEvent&&r&&r(e,s),a&&a(e,s)},!wl(e))return;this.dragSnapToOrigin=s,this.handlers=t,this.transformPagePoint=r,this.distanceThreshold=i,this.contextWindow=a||window;const o=Fl(kl(e),this.transformPagePoint),{point:l}=o,{timestamp:c}=qa;this.history=[(0,n.A)((0,n.A)({},l),{},{timestamp:c})];const{onSessionStart:d}=t;d&&d(e,Ml(o,this.history)),this.removeListeners=yi(Nl(this.contextWindow,"pointermove",this.handlePointerMove),Nl(this.contextWindow,"pointerup",this.handlePointerUp),Nl(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),Va(this.updatePoint)}}function Fl(e,t){return t?{point:t(e.point)}:e}function Ll(e,t){return{x:e.x-t.x,y:e.y-t.y}}function Ml(e,t){let{point:r}=e;return{point:r,delta:Ll(r,Ol(t)),offset:Ll(r,Rl(t)),velocity:Bl(t,.1)}}function Rl(e){return e[0]}function Ol(e){return e[e.length-1]}function Bl(e,t){if(e.length<2)return{x:0,y:0};let r=e.length-1,a=null;const n=Ol(e);for(;r>=0&&(a=e[r],!(n.timestamp-a.timestamp>vi(t)));)r--;if(!a)return{x:0,y:0};const s=bi(n.timestamp-a.timestamp);if(0===s)return{x:0,y:0};const i={x:(n.x-a.x)/s,y:(n.y-a.y)/s};return i.x===1/0&&(i.x=0),i.y===1/0&&(i.y=0),i}function zl(e,t,r){return{min:void 0!==t?e.min+t:void 0,max:void 0!==r?e.max+r-(e.max-e.min):void 0}}function Ul(e,t){let r=t.min-e.min,a=t.max-e.max;return t.max-t.min<e.max-e.min&&([r,a]=[a,r]),{min:r,max:a}}const Vl=.35;function ql(e,t,r){return{min:Hl(e,t),max:Hl(e,r)}}function Hl(e,t){return"number"===typeof e?e:e[t]||0}const Gl=new WeakMap;class Wl{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic={x:{min:0,max:0},y:{min:0,max:0}},this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=e}start(e){let{snapToCursor:t=!1,distanceThreshold:r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{presenceContext:a}=this.visualElement;if(a&&!1===a.isPresent)return;const{dragSnapToOrigin:n}=this.getProps();this.panSession=new Pl(e,{onSessionStart:e=>{const{dragSnapToOrigin:r}=this.getProps();r?this.pauseAnimation():this.stopAnimation(),t&&this.snapToCursor(kl(e).point)},onStart:(e,t)=>{const{drag:r,dragPropagation:a,onDragStart:n}=this.getProps();if(r&&!a&&(this.openDragLock&&this.openDragLock(),this.openDragLock="x"===(s=r)||"y"===s?yl[s]?null:(yl[s]=!0,()=>{yl[s]=!1}):yl.x||yl.y?null:(yl.x=yl.y=!0,()=>{yl.x=yl.y=!1}),!this.openDragLock))return;var s;this.latestPointerEvent=e,this.latestPanInfo=t,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Il(e=>{let t=this.getAxisMotionValue(e).get()||0;if(wa.test(t)){const{projection:r}=this.visualElement;if(r&&r.layout){const a=r.layout.layoutBox[e];if(a){t=jl(a)*(parseFloat(t)/100)}}}this.originPoint[e]=t}),n&&Ua.postRender(()=>n(e,t)),fi(this.visualElement,"transform");const{animationState:i}=this.visualElement;i&&i.setActive("whileDrag",!0)},onMove:(e,t)=>{this.latestPointerEvent=e,this.latestPanInfo=t;const{dragPropagation:r,dragDirectionLock:a,onDirectionLock:n,onDrag:s}=this.getProps();if(!r&&!this.openDragLock)return;const{offset:i}=t;if(a&&null===this.currentDirection)return this.currentDirection=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,r=null;Math.abs(e.y)>t?r="y":Math.abs(e.x)>t&&(r="x");return r}(i),void(null!==this.currentDirection&&n&&n(this.currentDirection));this.updateAxis("x",t.point,i),this.updateAxis("y",t.point,i),this.visualElement.render(),s&&s(e,t)},onSessionEnd:(e,t)=>{this.latestPointerEvent=e,this.latestPanInfo=t,this.stop(e,t),this.latestPointerEvent=null,this.latestPanInfo=null},resumeAnimation:()=>Il(e=>{var t;return"paused"===this.getAnimationState(e)&&(null===(t=this.getAxisMotionValue(e).animation)||void 0===t?void 0:t.play())})},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:n,distanceThreshold:r,contextWindow:Tl(this.visualElement)})}stop(e,t){const r=e||this.latestPointerEvent,a=t||this.latestPanInfo,n=this.isDragging;if(this.cancel(),!n||!a||!r)return;const{velocity:s}=a;this.startAnimation(s);const{onDragEnd:i}=this.getProps();i&&Ua.postRender(()=>i(r,a))}cancel(){this.isDragging=!1;const{projection:e,animationState:t}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:r}=this.getProps();!r&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),t&&t.setActive("whileDrag",!1)}updateAxis(e,t,r){const{drag:a}=this.getProps();if(!r||!Kl(e,a,this.currentDirection))return;const n=this.getAxisMotionValue(e);let s=this.originPoint[e]+r[e];this.constraints&&this.constraints[e]&&(s=function(e,t,r){let{min:a,max:n}=t;return void 0!==a&&e<a?e=r?Zr(a,e,r.min):Math.max(e,a):void 0!==n&&e>n&&(e=r?Zr(n,e,r.max):Math.min(e,n)),e}(s,this.constraints[e],this.elastic[e])),n.set(s)}resolveConstraints(){var e;const{dragConstraints:t,dragElastic:r}=this.getProps(),a=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):null===(e=this.visualElement.projection)||void 0===e?void 0:e.layout,n=this.constraints;t&&$s(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):this.constraints=!(!t||!a)&&function(e,t){let{top:r,left:a,bottom:n,right:s}=t;return{x:zl(e.x,a,s),y:zl(e.y,r,n)}}(a.layoutBox,t),this.elastic=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Vl;return!1===e?e=0:!0===e&&(e=Vl),{x:ql(e,"left","right"),y:ql(e,"top","bottom")}}(r),n!==this.constraints&&a&&this.constraints&&!this.hasMutatedConstraints&&Il(e=>{!1!==this.constraints&&this.getAxisMotionValue(e)&&(this.constraints[e]=function(e,t){const r={};return void 0!==t.min&&(r.min=t.min-e.min),void 0!==t.max&&(r.max=t.max-e.min),r}(a.layoutBox[e],this.constraints[e]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:t}=this.getProps();if(!e||!$s(e))return!1;const r=e.current,{projection:a}=this.visualElement;if(!a||!a.layout)return!1;const n=function(e,t,r){const a=ma(e,r),{scroll:n}=t;return n&&(da(a.x,n.offset.x),da(a.y,n.offset.y)),a}(r,a.root,this.visualElement.getTransformPagePoint());let s=function(e,t){return{x:Ul(e.x,t.x),y:Ul(e.y,t.y)}}(a.layout.layoutBox,n);if(t){const e=t(function(e){let{x:t,y:r}=e;return{top:r.min,right:t.max,bottom:r.max,left:t.min}}(s));this.hasMutatedConstraints=!!e,e&&(s=Jr(e))}return s}startAnimation(e){const{drag:t,dragMomentum:r,dragElastic:a,dragTransition:s,dragSnapToOrigin:i,onDragTransitionEnd:o}=this.getProps(),l=this.constraints||{},c=Il(o=>{if(!Kl(o,t,this.currentDirection))return;let c=l&&l[o]||{};i&&(c={min:0,max:0});const d=a?200:1e6,u=a?40:1e7,h=(0,n.A)((0,n.A)({type:"inertia",velocity:r?e[o]:0,bounceStiffness:d,bounceDamping:u,timeConstant:750,restDelta:1,restSpeed:10},s),c);return this.startAxisValueAnimation(o,h)});return Promise.all(c).then(o)}startAxisValueAnimation(e,t){const r=this.getAxisMotionValue(e);return fi(this.visualElement,e),r.start(Zo(e,r,0,t,this.visualElement,!1))}stopAnimation(){Il(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){Il(e=>{var t;return null===(t=this.getAxisMotionValue(e).animation)||void 0===t?void 0:t.pause()})}getAnimationState(e){var t;return null===(t=this.getAxisMotionValue(e).animation)||void 0===t?void 0:t.state}getAxisMotionValue(e){const t="_drag".concat(e.toUpperCase()),r=this.visualElement.getProps(),a=r[t];return a||this.visualElement.getValue(e,(r.initial?r.initial[e]:void 0)||0)}snapToCursor(e){Il(t=>{const{drag:r}=this.getProps();if(!Kl(t,r,this.currentDirection))return;const{projection:a}=this.visualElement,n=this.getAxisMotionValue(t);if(a&&a.layout){const{min:r,max:s}=a.layout.layoutBox[t];n.set(e[t]-Zr(r,s,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:t}=this.getProps(),{projection:r}=this.visualElement;if(!$s(t)||!r||!this.constraints)return;this.stopAnimation();const a={x:0,y:0};Il(e=>{const t=this.getAxisMotionValue(e);if(t&&!1!==this.constraints){const r=t.get();a[e]=function(e,t){let r=.5;const a=jl(e),n=jl(t);return n>a?r=fo(t.min,t.max-a,e.min):a>n&&(r=fo(e.min,e.max-n,t.min)),ga(0,1,r)}({min:r,max:r},this.constraints[e])}});const{transformTemplate:n}=this.visualElement.getProps();this.visualElement.current.style.transform=n?n({},""):"none",r.root&&r.root.updateScroll(),r.updateLayout(),this.resolveConstraints(),Il(t=>{if(!Kl(t,e,null))return;const r=this.getAxisMotionValue(t),{min:n,max:s}=this.constraints[t];r.set(Zr(n,s,a[t]))})}addListeners(){if(!this.visualElement.current)return;Gl.set(this.visualElement,this);const e=Nl(this.visualElement.current,"pointerdown",e=>{const{drag:t,dragListener:r=!0}=this.getProps();t&&r&&this.start(e)}),t=()=>{const{dragConstraints:e}=this.getProps();$s(e)&&e.current&&(this.constraints=this.resolveRefConstraints())},{projection:r}=this.visualElement,a=r.addEventListener("measure",t);r&&!r.layout&&(r.root&&r.root.updateScroll(),r.updateLayout()),Ua.read(t);const n=bl(window,"resize",()=>this.scalePositionWithinConstraints()),s=r.addEventListener("didUpdate",e=>{let{delta:t,hasLayoutChanged:r}=e;this.isDragging&&r&&(Il(e=>{const r=this.getAxisMotionValue(e);r&&(this.originPoint[e]+=t[e].translate,r.set(r.get()+t[e].translate))}),this.visualElement.render())});return()=>{n(),e(),a(),s&&s()}}getProps(){const e=this.visualElement.getProps(),{drag:t=!1,dragDirectionLock:r=!1,dragPropagation:a=!1,dragConstraints:s=!1,dragElastic:i=Vl,dragMomentum:o=!0}=e;return(0,n.A)((0,n.A)({},e),{},{drag:t,dragDirectionLock:r,dragPropagation:a,dragConstraints:s,dragElastic:i,dragMomentum:o})}}function Kl(e,t,r){return(!0===t||t===e)&&(null===r||r===e)}const Ql=e=>(t,r)=>{e&&Ua.postRender(()=>e(t,r))};const Yl={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function Xl(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const Jl={correct:(e,t)=>{if(!t.target)return e;if("string"===typeof e){if(!ka.test(e))return e;e=parseFloat(e)}const r=Xl(e,t.target.x),a=Xl(e,t.target.y);return"".concat(r,"% ").concat(a,"%")}},Zl={correct:(e,t)=>{let{treeScale:r,projectionDelta:a}=t;const n=e,s=vn.parse(e);if(s.length>5)return n;const i=vn.createTransformer(e),o="number"!==typeof s[0]?1:0,l=a.x.scale*r.x,c=a.y.scale*r.y;s[0+o]/=l,s[1+o]/=c;const d=Zr(l,c,.5);return"number"===typeof s[2+o]&&(s[2+o]/=d),"number"===typeof s[3+o]&&(s[3+o]/=d),i(s)}};let $l=!1;class ec extends e.Component{componentDidMount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:r,layoutId:a}=this.props,{projection:s}=e;!function(e){for(const t in e)gs[t]=e[t],Kr(t)&&(gs[t].isCSSVariable=!0)}(rc),s&&(t.group&&t.group.add(s),r&&r.register&&a&&r.register(s),$l&&s.root.didUpdate(),s.addEventListener("animationComplete",()=>{this.safeToRemove()}),s.setOptions((0,n.A)((0,n.A)({},s.options),{},{onExitComplete:()=>this.safeToRemove()}))),Yl.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:t,visualElement:r,drag:a,isPresent:n}=this.props,{projection:s}=r;return s?(s.isPresent=n,$l=!0,a||e.layoutDependency!==t||void 0===t||e.isPresent!==n?s.willUpdate():this.safeToRemove(),e.isPresent!==n&&(n?s.promote():s.relegate()||Ua.postRender(()=>{const e=s.getStack();e&&e.members.length||this.safeToRemove()})),null):null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),Hn.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:t,switchLayoutGroup:r}=this.props,{projection:a}=e;$l=!0,a&&(a.scheduleCheckAfterUnmount(),t&&t.group&&t.group.remove(a),r&&r.deregister&&r.deregister(a))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function tc(t){const[r,a]=Ir(),s=(0,e.useContext)(yr);return(0,k.jsx)(ec,(0,n.A)((0,n.A)({},t),{},{layoutGroup:s,switchLayoutGroup:(0,e.useContext)(ri),isPresent:r,safeToRemove:a}))}const rc={borderRadius:(0,n.A)((0,n.A)({},Jl),{},{applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]}),borderTopLeftRadius:Jl,borderTopRightRadius:Jl,borderBottomLeftRadius:Jl,borderBottomRightRadius:Jl,boxShadow:Zl};function ac(e){return Nr(e)&&"ownerSVGElement"in e}const nc=(e,t)=>e.depth-t.depth;class sc{constructor(){this.children=[],this.isDirty=!1}add(e){Mn(this.children,e),this.isDirty=!0}remove(e){Rn(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(nc),this.isDirty=!1,this.children.forEach(e)}}function ic(e,t){const r=Ln.now(),a=n=>{let{timestamp:s}=n;const i=s-r;i>=t&&(Va(a),e(i-t))};return Ua.setup(a,!0),()=>Va(a)}const oc=["TopLeft","TopRight","BottomLeft","BottomRight"],lc=oc.length,cc=e=>"string"===typeof e?parseFloat(e):e,dc=e=>"number"===typeof e||ka.test(e);function uc(e,t){return void 0!==e[t]?e[t]:e.borderRadius}const hc=fc(0,.5,lo),mc=fc(.5,.95,Ma);function fc(e,t,r){return a=>a<e?0:a>t?1:r(fo(e,t,a))}function gc(e,t){e.min=t.min,e.max=t.max}function pc(e,t){gc(e.x,t.x),gc(e.y,t.y)}function xc(e,t){e.translate=t.translate,e.scale=t.scale,e.originPoint=t.originPoint,e.origin=t.origin}function yc(e,t,r,a,n){return e=na(e-=t,1/r,a),void 0!==n&&(e=na(e,1/n,a)),e}function vc(e,t,r,a,n){let[s,i,o]=r;!function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,n=arguments.length>4?arguments[4]:void 0,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:e,i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:e;wa.test(t)&&(t=parseFloat(t),t=Zr(i.min,i.max,t/100)-i.min);if("number"!==typeof t)return;let o=Zr(s.min,s.max,a);e===s&&(o-=t),e.min=yc(e.min,t,r,o,n),e.max=yc(e.max,t,r,o,n)}(e,t[s],t[i],t[o],t.scale,a,n)}const bc=["x","scaleX","originX"],wc=["y","scaleY","originY"];function kc(e,t,r,a){vc(e.x,t,bc,r?r.x:void 0,a?a.x:void 0),vc(e.y,t,wc,r?r.y:void 0,a?a.y:void 0)}function Nc(e){return 0===e.translate&&1===e.scale}function jc(e){return Nc(e.x)&&Nc(e.y)}function Sc(e,t){return e.min===t.min&&e.max===t.max}function _c(e,t){return Math.round(e.min)===Math.round(t.min)&&Math.round(e.max)===Math.round(t.max)}function Ec(e,t){return _c(e.x,t.x)&&_c(e.y,t.y)}function Ac(e){return jl(e.x)/jl(e.y)}function Cc(e,t){return e.translate===t.translate&&e.scale===t.scale&&e.originPoint===t.originPoint}class Ic{constructor(){this.members=[]}add(e){Mn(this.members,e),e.scheduleRender()}remove(e){if(Rn(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const e=this.members[this.members.length-1];e&&this.promote(e)}}relegate(e){const t=this.members.findIndex(t=>e===t);if(0===t)return!1;let r;for(let a=t;a>=0;a--){const e=this.members[a];if(!1!==e.isPresent){r=e;break}}return!!r&&(this.promote(r),!0)}promote(e,t){const r=this.lead;if(e!==r&&(this.prevLead=r,this.lead=e,e.show(),r)){r.instance&&r.scheduleRender(),e.scheduleRender(),e.resumeFrom=r,t&&(e.resumeFrom.preserveOpacity=!0),r.snapshot&&(e.snapshot=r.snapshot,e.snapshot.latestValues=r.animationValues||r.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:a}=e.options;!1===a&&r.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:t,resumingFrom:r}=e;t.onExitComplete&&t.onExitComplete(),r&&r.options.onExitComplete&&r.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}const Tc={nodes:0,calculatedTargetDeltas:0,calculatedProjections:0},Dc=["","X","Y","Z"];let Pc=0;function Fc(e,t,r,a){const{latestValues:n}=t;n[e]&&(r[e]=n[e],t.setStaticValue(e,0),a&&(a[e]=0))}function Lc(e){if(e.hasCheckedOptimisedAppear=!0,e.root===e)return;const{visualElement:t}=e.options;if(!t)return;const r=gi(t);if(window.MotionHasOptimisedAnimation(r,"transform")){const{layout:t,layoutId:a}=e.options;window.MotionCancelOptimisedAnimation(r,"transform",Ua,!(t||a))}const{parent:a}=e;a&&!a.hasCheckedOptimisedAppear&&Lc(a)}function Mc(e){let{attachResizeListener:t,defaultParent:r,measureScroll:a,checkIsScrollRoot:s,resetTransform:i}=e;return class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null===r||void 0===r?void 0:r();this.id=Pc++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,Ba.value&&(Tc.nodes=Tc.calculatedTargetDeltas=Tc.calculatedProjections=0),this.nodes.forEach(Bc),this.nodes.forEach(Wc),this.nodes.forEach(Kc),this.nodes.forEach(zc),Ba.addProjectionMetrics&&Ba.addProjectionMetrics(Tc)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=e,this.root=t?t.root||t:this,this.path=t?[...t.path,t]:[],this.parent=t,this.depth=t?t.depth+1:0;for(let r=0;r<this.path.length;r++)this.path[r].shouldResetTransform=!0;this.root===this&&(this.nodes=new sc)}addEventListener(e,t){return this.eventHandlers.has(e)||this.eventHandlers.set(e,new On),this.eventHandlers.get(e).add(t)}notifyListeners(e){const t=this.eventHandlers.get(e);for(var r=arguments.length,a=new Array(r>1?r-1:0),n=1;n<r;n++)a[n-1]=arguments[n];t&&t.notify(...a)}hasListeners(e){return this.eventHandlers.has(e)}mount(e){if(this.instance)return;var r;this.isSVG=ac(e)&&!(ac(r=e)&&"svg"===r.tagName),this.instance=e;const{layoutId:a,layout:s,visualElement:i}=this.options;if(i&&!i.current&&i.mount(e),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(s||a)&&(this.isLayoutDirty=!0),t){let r,a=0;const n=()=>this.root.updateBlockedByResize=!1;Ua.read(()=>{a=window.innerWidth}),t(e,()=>{const e=window.innerWidth;e!==a&&(a=e,this.root.updateBlockedByResize=!0,r&&r(),r=ic(n,250),Yl.hasAnimatedSinceResize&&(Yl.hasAnimatedSinceResize=!1,this.nodes.forEach(Gc)))})}a&&this.root.registerSharedNode(a,this),!1!==this.options.animate&&i&&(a||s)&&this.addEventListener("didUpdate",e=>{let{delta:t,hasLayoutChanged:r,hasRelativeLayoutChanged:a,layout:s}=e;if(this.isTreeAnimationBlocked())return this.target=void 0,void(this.relativeTarget=void 0);const o=this.options.transition||i.getDefaultTransition()||$c,{onLayoutAnimationStart:l,onLayoutAnimationComplete:c}=i.getProps(),d=!this.targetLayout||!Ec(this.targetLayout,s),u=!r&&a;if(this.options.layoutRoot||this.resumeFrom||u||r&&(d||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const e=(0,n.A)((0,n.A)({},ci(o,"layout")),{},{onPlay:l,onComplete:c});(i.shouldReduceMotion||this.options.layoutRoot)&&(e.delay=0,e.type=!1),this.startAnimation(e),this.setAnimationOrigin(t,u)}else r||Gc(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=s})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const e=this.getStack();e&&e.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),Va(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(Qc),this.animationId++)}getTransformTemplate(){const{visualElement:e}=this.options;return e&&e.getProps().transformTemplate}willUpdate(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked())return void(this.options.onExitComplete&&this.options.onExitComplete());if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&Lc(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let n=0;n<this.path.length;n++){const e=this.path[n];e.shouldResetTransform=!0,e.updateScroll("snapshot"),e.options.layoutRoot&&e.willUpdate(!1)}const{layoutId:t,layout:r}=this.options;if(void 0===t&&!r)return;const a=this.getTransformTemplate();this.prevTransformTemplateValue=a?a(this.latestValues,""):void 0,this.updateSnapshot(),e&&this.notifyListeners("willUpdate")}update(){this.updateScheduled=!1;if(this.isUpdateBlocked())return this.unblockUpdate(),this.clearAllSnapshots(),void this.nodes.forEach(Vc);if(this.animationId<=this.animationCommitId)return void this.nodes.forEach(qc);this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(Hc),this.nodes.forEach(Rc),this.nodes.forEach(Oc)):this.nodes.forEach(qc),this.clearAllSnapshots();const e=Ln.now();qa.delta=ga(0,1e3/60,e-qa.timestamp),qa.timestamp=e,qa.isProcessing=!0,Ha.update.process(qa),Ha.preRender.process(qa),Ha.render.process(qa),qa.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,Hn.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(Uc),this.sharedNodes.forEach(Yc)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,Ua.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){Ua.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){!this.snapshot&&this.instance&&(this.snapshot=this.measure(),!this.snapshot||jl(this.snapshot.measuredBox.x)||jl(this.snapshot.measuredBox.y)||(this.snapshot=void 0))}updateLayout(){if(!this.instance)return;if(this.updateScroll(),(!this.options.alwaysMeasureLayout||!this.isLead())&&!this.isLayoutDirty)return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let r=0;r<this.path.length;r++){this.path[r].updateScroll()}const e=this.layout;this.layout=this.measure(!1),this.layoutCorrected={x:{min:0,max:0},y:{min:0,max:0}},this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:t}=this.options;t&&t.notify("LayoutMeasure",this.layout.layoutBox,e?e.layoutBox:void 0)}updateScroll(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"measure",t=Boolean(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===e&&(t=!1),t&&this.instance){const t=s(this.instance);this.scroll={animationId:this.root.animationId,phase:e,isRoot:t,offset:a(this.instance),wasRoot:this.scroll?this.scroll.isRoot:t}}}resetTransform(){if(!i)return;const e=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,t=this.projectionDelta&&!jc(this.projectionDelta),r=this.getTransformTemplate(),a=r?r(this.latestValues,""):void 0,n=a!==this.prevTransformTemplateValue;e&&this.instance&&(t||ta(this.latestValues)||n)&&(i(this.instance,a),this.shouldResetTransform=!1,this.scheduleRender())}measure(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];const t=this.measurePageBox();let r=this.removeElementScroll(t);var a;return e&&(r=this.removeTransform(r)),rd((a=r).x),rd(a.y),{animationId:this.root.animationId,measuredBox:t,layoutBox:r,latestValues:{},source:this.id}}measurePageBox(){var e;const{visualElement:t}=this.options;if(!t)return{x:{min:0,max:0},y:{min:0,max:0}};const r=t.measureViewportBox();if(!((null===(e=this.scroll)||void 0===e?void 0:e.wasRoot)||this.path.some(nd))){const{scroll:e}=this.root;e&&(da(r.x,e.offset.x),da(r.y,e.offset.y))}return r}removeElementScroll(e){var t;const r={x:{min:0,max:0},y:{min:0,max:0}};if(pc(r,e),null!==(t=this.scroll)&&void 0!==t&&t.wasRoot)return r;for(let a=0;a<this.path.length;a++){const t=this.path[a],{scroll:n,options:s}=t;t!==this.root&&n&&s.layoutScroll&&(n.wasRoot&&pc(r,e),da(r.x,n.offset.x),da(r.y,n.offset.y))}return r}applyTransform(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const r={x:{min:0,max:0},y:{min:0,max:0}};pc(r,e);for(let a=0;a<this.path.length;a++){const e=this.path[a];!t&&e.options.layoutScroll&&e.scroll&&e!==e.root&&ha(r,{x:-e.scroll.offset.x,y:-e.scroll.offset.y}),ta(e.latestValues)&&ha(r,e.latestValues)}return ta(this.latestValues)&&ha(r,this.latestValues),r}removeTransform(e){const t={x:{min:0,max:0},y:{min:0,max:0}};pc(t,e);for(let r=0;r<this.path.length;r++){const e=this.path[r];if(!e.instance)continue;if(!ta(e.latestValues))continue;ea(e.latestValues)&&e.updateSnapshot();const a=Qn();pc(a,e.measurePageBox()),kc(t,e.latestValues,e.snapshot?e.snapshot.layoutBox:void 0,a)}return ta(this.latestValues)&&kc(t,this.latestValues),t}setTargetDelta(e){this.targetDelta=e,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(e){this.options=(0,n.A)((0,n.A)((0,n.A)({},this.options),e),{},{crossfade:void 0===e.crossfade||e.crossfade})}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==qa.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(){var e;let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const r=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=r.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=r.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=r.isSharedProjectionDirty);const a=Boolean(this.resumingFrom)||this!==r;if(!(t||a&&this.isSharedProjectionDirty||this.isProjectionDirty||null!==(e=this.parent)&&void 0!==e&&e.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:n,layoutId:s}=this.options;if(this.layout&&(n||s)){if(this.resolvedRelativeTargetAt=qa.timestamp,!this.targetDelta&&!this.relativeTarget){const e=this.getClosestProjectingParent();e&&e.layout&&1!==this.animationProgress?(this.relativeParent=e,this.forceRelativeParentToResolveTarget(),this.relativeTarget={x:{min:0,max:0},y:{min:0,max:0}},this.relativeTargetOrigin={x:{min:0,max:0},y:{min:0,max:0}},Cl(this.relativeTargetOrigin,this.layout.layoutBox,e.layout.layoutBox),pc(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(this.relativeTarget||this.targetDelta){var i,o,l;if(this.target||(this.target={x:{min:0,max:0},y:{min:0,max:0}},this.targetWithTransforms={x:{min:0,max:0},y:{min:0,max:0}}),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),i=this.target,o=this.relativeTarget,l=this.relativeParent.target,El(i.x,o.x,l.x),El(i.y,o.y,l.y)):this.targetDelta?(Boolean(this.resumingFrom)?this.target=this.applyTransform(this.layout.layoutBox):pc(this.target,this.layout.layoutBox),oa(this.target,this.targetDelta)):pc(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const e=this.getClosestProjectingParent();e&&Boolean(e.resumingFrom)===Boolean(this.resumingFrom)&&!e.options.layoutScroll&&e.target&&1!==this.animationProgress?(this.relativeParent=e,this.forceRelativeParentToResolveTarget(),this.relativeTarget={x:{min:0,max:0},y:{min:0,max:0}},this.relativeTargetOrigin={x:{min:0,max:0},y:{min:0,max:0}},Cl(this.relativeTargetOrigin,this.target,e.target),pc(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}Ba.value&&Tc.calculatedTargetDeltas++}}}getClosestProjectingParent(){if(this.parent&&!ea(this.parent.latestValues)&&!ra(this.parent.latestValues))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return Boolean((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var e;const t=this.getLead(),r=Boolean(this.resumingFrom)||this!==t;let a=!0;if((this.isProjectionDirty||null!==(e=this.parent)&&void 0!==e&&e.isProjectionDirty)&&(a=!1),r&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(a=!1),this.resolvedRelativeTargetAt===qa.timestamp&&(a=!1),a)return;const{layout:n,layoutId:s}=this.options;if(this.isTreeAnimating=Boolean(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!n&&!s)return;pc(this.layoutCorrected,this.layout.layoutBox);const i=this.treeScale.x,o=this.treeScale.y;!function(e,t,r){let a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const n=r.length;if(!n)return;let s,i;t.x=t.y=1;for(let o=0;o<n;o++){s=r[o],i=s.projectionDelta;const{visualElement:n}=s.options;n&&n.props.style&&"contents"===n.props.style.display||(a&&s.options.layoutScroll&&s.scroll&&s!==s.root&&ha(e,{x:-s.scroll.offset.x,y:-s.scroll.offset.y}),i&&(t.x*=i.x.scale,t.y*=i.y.scale,oa(e,i)),a&&ta(s.latestValues)&&ha(e,s.latestValues))}t.x<ca&&t.x>la&&(t.x=1),t.y<ca&&t.y>la&&(t.y=1)}(this.layoutCorrected,this.treeScale,this.path,r),!t.layout||t.target||1===this.treeScale.x&&1===this.treeScale.y||(t.target=t.layout.layoutBox,t.targetWithTransforms={x:{min:0,max:0},y:{min:0,max:0}});const{target:l}=t;l?(this.projectionDelta&&this.prevProjectionDelta?(xc(this.prevProjectionDelta.x,this.projectionDelta.x),xc(this.prevProjectionDelta.y,this.projectionDelta.y)):this.createProjectionDeltas(),_l(this.projectionDelta,this.layoutCorrected,l,this.latestValues),this.treeScale.x===i&&this.treeScale.y===o&&Cc(this.projectionDelta.x,this.prevProjectionDelta.x)&&Cc(this.projectionDelta.y,this.prevProjectionDelta.y)||(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",l)),Ba.value&&Tc.calculatedProjections++):this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender())}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(){var e;let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(null===(e=this.options.visualElement)||void 0===e||e.scheduleRender(),t){const e=this.getStack();e&&e.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta={x:{translate:0,scale:1,origin:0,originPoint:0},y:{translate:0,scale:1,origin:0,originPoint:0}},this.projectionDelta={x:{translate:0,scale:1,origin:0,originPoint:0},y:{translate:0,scale:1,origin:0,originPoint:0}},this.projectionDeltaWithTransform={x:{translate:0,scale:1,origin:0,originPoint:0},y:{translate:0,scale:1,origin:0,originPoint:0}}}setAnimationOrigin(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const r=this.snapshot,a=r?r.latestValues:{},s=(0,n.A)({},this.latestValues),i={x:{translate:0,scale:1,origin:0,originPoint:0},y:{translate:0,scale:1,origin:0,originPoint:0}};this.relativeParent&&this.relativeParent.options.layoutRoot||(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!t;const o={x:{min:0,max:0},y:{min:0,max:0}},l=(r?r.source:void 0)!==(this.layout?this.layout.source:void 0),c=this.getStack(),d=!c||c.members.length<=1,u=Boolean(l&&!d&&!0===this.options.crossfade&&!this.path.some(Zc));let h;this.animationProgress=0,this.mixTargetDelta=t=>{const r=t/1e3;Xc(i.x,e.x,r),Xc(i.y,e.y,r),this.setTargetDelta(i),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Cl(o,this.layout.layoutBox,this.relativeParent.layout.layoutBox),function(e,t,r,a){Jc(e.x,t.x,r.x,a),Jc(e.y,t.y,r.y,a)}(this.relativeTarget,this.relativeTargetOrigin,o,r),h&&function(e,t){return Sc(e.x,t.x)&&Sc(e.y,t.y)}(this.relativeTarget,h)&&(this.isProjectionDirty=!1),h||(h={x:{min:0,max:0},y:{min:0,max:0}}),pc(h,this.relativeTarget)),l&&(this.animationValues=s,function(e,t,r,a,n,s){var i,o;if(n)e.opacity=Zr(0,null!==(i=r.opacity)&&void 0!==i?i:1,hc(a)),e.opacityExit=Zr(null!==(o=t.opacity)&&void 0!==o?o:1,0,mc(a));else if(s){var l,c;e.opacity=Zr(null!==(l=t.opacity)&&void 0!==l?l:1,null!==(c=r.opacity)&&void 0!==c?c:1,a)}for(let d=0;d<lc;d++){const n="border".concat(oc[d],"Radius");let s=uc(t,n),i=uc(r,n);void 0===s&&void 0===i||(s||(s=0),i||(i=0),0===s||0===i||dc(s)===dc(i)?(e[n]=Math.max(Zr(cc(s),cc(i),a),0),(wa.test(i)||wa.test(s))&&(e[n]+="%")):e[n]=i)}(t.rotate||r.rotate)&&(e.rotate=Zr(t.rotate||0,r.rotate||0,a))}(s,a,this.latestValues,r,u,d)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=r},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(e){var t,r;this.notifyListeners("animationStart"),null===(t=this.currentAnimation)||void 0===t||t.stop(),null===(r=this.resumingFrom)||void 0===r||null===(r=r.currentAnimation)||void 0===r||r.stop(),this.pendingAnimation&&(Va(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=Ua.update(()=>{Yl.hasAnimatedSinceResize=!0,wi.layout++,this.motionValue||(this.motionValue=Vn(0)),this.currentAnimation=function(e,t,r){const a=Dn(e)?e:Vn(e);return a.start(Zo("",a,t,r)),a.animation}(this.motionValue,[0,1e3],(0,n.A)((0,n.A)({},e),{},{velocity:0,isSync:!0,onUpdate:t=>{this.mixTargetDelta(t),e.onUpdate&&e.onUpdate(t)},onStop:()=>{wi.layout--},onComplete:()=>{wi.layout--,e.onComplete&&e.onComplete(),this.completeAnimation()}})),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const e=this.getStack();e&&e.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(1e3),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const e=this.getLead();let{targetWithTransforms:t,target:r,layout:a,latestValues:n}=e;if(t&&r&&a){if(this!==e&&this.layout&&a&&ad(this.options.animationType,this.layout.layoutBox,a.layoutBox)){r=this.target||{x:{min:0,max:0},y:{min:0,max:0}};const t=jl(this.layout.layoutBox.x);r.x.min=e.target.x.min,r.x.max=r.x.min+t;const a=jl(this.layout.layoutBox.y);r.y.min=e.target.y.min,r.y.max=r.y.min+a}pc(t,r),ha(t,n),_l(this.projectionDeltaWithTransform,this.layoutCorrected,t,n)}}registerSharedNode(e,t){this.sharedNodes.has(e)||this.sharedNodes.set(e,new Ic);this.sharedNodes.get(e).add(t);const r=t.options.initialPromotionConfig;t.promote({transition:r?r.transition:void 0,preserveFollowOpacity:r&&r.shouldPreserveFollowOpacity?r.shouldPreserveFollowOpacity(t):void 0})}isLead(){const e=this.getStack();return!e||e.lead===this}getLead(){var e;const{layoutId:t}=this.options;return t&&(null===(e=this.getStack())||void 0===e?void 0:e.lead)||this}getPrevLead(){var e;const{layoutId:t}=this.options;return t?null===(e=this.getStack())||void 0===e?void 0:e.prevLead:void 0}getStack(){const{layoutId:e}=this.options;if(e)return this.root.sharedNodes.get(e)}promote(){let{needsReset:e,transition:t,preserveFollowOpacity:r}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const a=this.getStack();a&&a.promote(this,r),e&&(this.projectionDelta=void 0,this.needsReset=!0),t&&this.setOptions({transition:t})}relegate(){const e=this.getStack();return!!e&&e.relegate(this)}resetSkewAndRotation(){const{visualElement:e}=this.options;if(!e)return;let t=!1;const{latestValues:r}=e;if((r.z||r.rotate||r.rotateX||r.rotateY||r.rotateZ||r.skewX||r.skewY)&&(t=!0),!t)return;const a={};r.z&&Fc("z",e,a,this.animationValues);for(let n=0;n<Dc.length;n++)Fc("rotate".concat(Dc[n]),e,a,this.animationValues),Fc("skew".concat(Dc[n]),e,a,this.animationValues);e.render();for(const n in a)e.setStaticValue(n,a[n]),this.animationValues&&(this.animationValues[n]=a[n]);e.scheduleRender()}applyProjectionStyles(e,t){if(!this.instance||this.isSVG)return;if(!this.isVisible)return void(e.visibility="hidden");const r=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,e.visibility="",e.opacity="",e.pointerEvents=Ws(null===t||void 0===t?void 0:t.pointerEvents)||"",void(e.transform=r?r(this.latestValues,""):"none");const a=this.getLead();if(!this.projectionDelta||!this.layout||!a.target)return this.options.layoutId&&(e.opacity=void 0!==this.latestValues.opacity?this.latestValues.opacity:1,e.pointerEvents=Ws(null===t||void 0===t?void 0:t.pointerEvents)||""),void(this.hasProjected&&!ta(this.latestValues)&&(e.transform=r?r({},""):"none",this.hasProjected=!1));e.visibility="";const n=a.animationValues||a.latestValues;this.applyTransformsToTarget();let s=function(e,t,r){let a="";const n=e.x.translate/t.x,s=e.y.translate/t.y,i=(null===r||void 0===r?void 0:r.z)||0;if((n||s||i)&&(a="translate3d(".concat(n,"px, ").concat(s,"px, ").concat(i,"px) ")),1===t.x&&1===t.y||(a+="scale(".concat(1/t.x,", ").concat(1/t.y,") ")),r){const{transformPerspective:e,rotate:t,rotateX:n,rotateY:s,skewX:i,skewY:o}=r;e&&(a="perspective(".concat(e,"px) ").concat(a)),t&&(a+="rotate(".concat(t,"deg) ")),n&&(a+="rotateX(".concat(n,"deg) ")),s&&(a+="rotateY(".concat(s,"deg) ")),i&&(a+="skewX(".concat(i,"deg) ")),o&&(a+="skewY(".concat(o,"deg) "))}const o=e.x.scale*t.x,l=e.y.scale*t.y;return 1===o&&1===l||(a+="scale(".concat(o,", ").concat(l,")")),a||"none"}(this.projectionDeltaWithTransform,this.treeScale,n);r&&(s=r(n,s)),e.transform=s;const{x:i,y:o}=this.projectionDelta;var l,c;(e.transformOrigin="".concat(100*i.origin,"% ").concat(100*o.origin,"% 0"),a.animationValues)?e.opacity=a===this?null!==(l=null!==(c=n.opacity)&&void 0!==c?c:this.latestValues.opacity)&&void 0!==l?l:1:this.preserveOpacity?this.latestValues.opacity:n.opacityExit:e.opacity=a===this?void 0!==n.opacity?n.opacity:"":void 0!==n.opacityExit?n.opacityExit:0;for(const d in gs){if(void 0===n[d])continue;const{correct:t,applyTo:r,isCSSVariable:i}=gs[d],o="none"===s?n[d]:t(n[d],a);if(r){const t=r.length;for(let a=0;a<t;a++)e[r[a]]=o}else i?this.options.visualElement.renderState.vars[d]=o:e[d]=o}this.options.layoutId&&(e.pointerEvents=a===this?Ws(null===t||void 0===t?void 0:t.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(e=>{var t;return null===(t=e.currentAnimation)||void 0===t?void 0:t.stop()}),this.root.nodes.forEach(Vc),this.root.sharedNodes.clear()}}}function Rc(e){e.updateLayout()}function Oc(e){var t;const r=(null===(t=e.resumeFrom)||void 0===t?void 0:t.snapshot)||e.snapshot;if(e.isLead()&&e.layout&&r&&e.hasListeners("didUpdate")){const{layoutBox:t,measuredBox:a}=e.layout,{animationType:n}=e.options,s=r.source!==e.layout.source;"size"===n?Il(e=>{const a=s?r.measuredBox[e]:r.layoutBox[e],n=jl(a);a.min=t[e].min,a.max=a.min+n}):ad(n,r.layoutBox,t)&&Il(a=>{const n=s?r.measuredBox[a]:r.layoutBox[a],i=jl(t[a]);n.max=n.min+i,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[a].max=e.relativeTarget[a].min+i)});const i={x:{translate:0,scale:1,origin:0,originPoint:0},y:{translate:0,scale:1,origin:0,originPoint:0}};_l(i,t,r.layoutBox);const o={x:{translate:0,scale:1,origin:0,originPoint:0},y:{translate:0,scale:1,origin:0,originPoint:0}};s?_l(o,e.applyTransform(a,!0),r.measuredBox):_l(o,t,r.layoutBox);const l=!jc(i);let c=!1;if(!e.resumeFrom){const a=e.getClosestProjectingParent();if(a&&!a.resumeFrom){const{snapshot:n,layout:s}=a;if(n&&s){const i={x:{min:0,max:0},y:{min:0,max:0}};Cl(i,r.layoutBox,n.layoutBox);const o={x:{min:0,max:0},y:{min:0,max:0}};Cl(o,t,s.layoutBox),Ec(i,o)||(c=!0),a.options.layoutRoot&&(e.relativeTarget=o,e.relativeTargetOrigin=i,e.relativeParent=a)}}}e.notifyListeners("didUpdate",{layout:t,snapshot:r,delta:o,layoutDelta:i,hasLayoutChanged:l,hasRelativeLayoutChanged:c})}else if(e.isLead()){const{onExitComplete:t}=e.options;t&&t()}e.options.transition=void 0}function Bc(e){Ba.value&&Tc.nodes++,e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=Boolean(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function zc(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function Uc(e){e.clearSnapshot()}function Vc(e){e.clearMeasurements()}function qc(e){e.isLayoutDirty=!1}function Hc(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function Gc(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function Wc(e){e.resolveTargetDelta()}function Kc(e){e.calcProjection()}function Qc(e){e.resetSkewAndRotation()}function Yc(e){e.removeLeadSnapshot()}function Xc(e,t,r){e.translate=Zr(t.translate,0,r),e.scale=Zr(t.scale,1,r),e.origin=t.origin,e.originPoint=t.originPoint}function Jc(e,t,r,a){e.min=Zr(t.min,r.min,a),e.max=Zr(t.max,r.max,a)}function Zc(e){return e.animationValues&&void 0!==e.animationValues.opacityExit}const $c={duration:.45,ease:[.4,0,.1,1]},ed=e=>"undefined"!==typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(e),td=ed("applewebkit/")&&!ed("chrome/")?Math.round:Ma;function rd(e){e.min=td(e.min),e.max=td(e.max)}function ad(e,t,r){return"position"===e||"preserve-aspect"===e&&(a=Ac(t),n=Ac(r),s=.2,!(Math.abs(a-n)<=s));var a,n,s}function nd(e){var t;return e!==e.root&&(null===(t=e.scroll)||void 0===t?void 0:t.wasRoot)}const sd=Mc({attachResizeListener:(e,t)=>bl(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),id={current:void 0},od=Mc({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!id.current){const e=new sd({});e.mount(window),e.setOptions({layoutScroll:!0}),id.current=e}return id.current},resetTransform:(e,t)=>{e.style.transform=void 0!==t?t:"none"},checkIsScrollRoot:e=>Boolean("fixed"===window.getComputedStyle(e).position)}),ld={pan:{Feature:class extends gl{constructor(){super(...arguments),this.removePointerDownListener=Ma}onPointerDown(e){this.session=new Pl(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:Tl(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:t,onPan:r,onPanEnd:a}=this.node.getProps();return{onSessionStart:Ql(e),onStart:Ql(t),onMove:r,onEnd:(e,t)=>{delete this.session,a&&Ua.postRender(()=>a(e,t))}}}mount(){this.removePointerDownListener=Nl(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}},drag:{Feature:class extends gl{constructor(e){super(e),this.removeGroupControls=Ma,this.removeListeners=Ma,this.controls=new Wl(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Ma}unmount(){this.removeGroupControls(),this.removeListeners()}},ProjectionNode:od,MeasureLayout:tc}};function cd(e,t){const r=function(e,t,r){if(e instanceof EventTarget)return[e];if("string"===typeof e){var a;let n=document;t&&(n=t.current);const s=null!==(a=null===r||void 0===r?void 0:r[e])&&void 0!==a?a:n.querySelectorAll(e);return s?Array.from(s):[]}return Array.from(e)}(e),a=new AbortController;return[r,(0,n.A)((0,n.A)({passive:!0},t),{},{signal:a.signal}),()=>a.abort()]}function dd(e){return!("touch"===e.pointerType||vl())}function ud(e,t,r){const{props:a}=e;e.animationState&&a.whileHover&&e.animationState.setActive("whileHover","Start"===r);const n=a["onHover"+r];n&&Ua.postRender(()=>n(t,kl(t)))}const hd=(e,t)=>!!t&&(e===t||hd(e,t.parentElement)),md=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);const fd=new WeakSet;function gd(e){return t=>{"Enter"===t.key&&e(t)}}function pd(e,t){e.dispatchEvent(new PointerEvent("pointer"+t,{isPrimary:!0,bubbles:!0}))}function xd(e){return wl(e)&&!vl()}function yd(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const[a,n,s]=cd(e,r),i=e=>{const a=e.currentTarget;if(!xd(e))return;fd.add(a);const s=t(a,e),i=(e,t)=>{window.removeEventListener("pointerup",o),window.removeEventListener("pointercancel",l),fd.has(a)&&fd.delete(a),xd(e)&&"function"===typeof s&&s(e,{success:t})},o=e=>{i(e,a===window||a===document||r.useGlobalTarget||hd(a,e.target))},l=e=>{i(e,!1)};window.addEventListener("pointerup",o,n),window.addEventListener("pointercancel",l,n)};return a.forEach(e=>{var t;(r.useGlobalTarget?window:e).addEventListener("pointerdown",i,n),jr(e)&&(e.addEventListener("focus",e=>((e,t)=>{const r=e.currentTarget;if(!r)return;const a=gd(()=>{if(fd.has(r))return;pd(r,"down");const e=gd(()=>{pd(r,"up")});r.addEventListener("keyup",e,t),r.addEventListener("blur",()=>pd(r,"cancel"),t)});r.addEventListener("keydown",a,t),r.addEventListener("blur",()=>r.removeEventListener("keydown",a),t)})(e,n)),t=e,md.has(t.tagName)||-1!==t.tabIndex||e.hasAttribute("tabindex")||(e.tabIndex=0))}),s}function vd(e,t,r){const{props:a}=e;if(e.current instanceof HTMLButtonElement&&e.current.disabled)return;e.animationState&&a.whileTap&&e.animationState.setActive("whileTap","Start"===r);const n=a["onTap"+("End"===r?"":r)];n&&Ua.postRender(()=>n(t,kl(t)))}const bd=["root"],wd=new WeakMap,kd=new WeakMap,Nd=e=>{const t=wd.get(e.target);t&&t(e)},jd=e=>{e.forEach(Nd)};function Sd(e,t,r){const s=function(e){let{root:t}=e,r=(0,a.A)(e,bd);const s=t||document;kd.has(s)||kd.set(s,{});const i=kd.get(s),o=JSON.stringify(r);return i[o]||(i[o]=new IntersectionObserver(jd,(0,n.A)({root:t},r))),i[o]}(t);return wd.set(e,r),s.observe(e),()=>{wd.delete(e),s.unobserve(e)}}const _d={some:0,all:1};const Ed={inView:{Feature:class extends gl{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:t,margin:r,amount:a="some",once:n}=e,s={root:t?t.current:void 0,rootMargin:r,threshold:"number"===typeof a?a:_d[a]};return Sd(this.node.current,s,e=>{const{isIntersecting:t}=e;if(this.isInView===t)return;if(this.isInView=t,n&&!t&&this.hasEnteredView)return;t&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",t);const{onViewportEnter:r,onViewportLeave:a}=this.node.getProps(),s=t?r:a;s&&s(e)})}mount(){this.startObserver()}update(){if("undefined"===typeof IntersectionObserver)return;const{props:e,prevProps:t}=this.node,r=["amount","margin","root"].some(function(e){let{viewport:t={}}=e,{viewport:r={}}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e=>t[e]!==r[e]}(e,t));r&&this.startObserver()}unmount(){}}},tap:{Feature:class extends gl{mount(){const{current:e}=this.node;e&&(this.unmount=yd(e,(e,t)=>(vd(this.node,t,"Start"),(e,t)=>{let{success:r}=t;return vd(this.node,e,r?"End":"Cancel")}),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}},focus:{Feature:class extends gl{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch(t){e=!0}e&&this.node.animationState&&(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){this.isActive&&this.node.animationState&&(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=yi(bl(this.node.current,"focus",()=>this.onFocus()),bl(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}},hover:{Feature:class extends gl{mount(){const{current:e}=this.node;e&&(this.unmount=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const[a,n,s]=cd(e,r),i=e=>{if(!dd(e))return;const{target:r}=e,a=t(r,e);if("function"!==typeof a||!r)return;const s=e=>{dd(e)&&(a(e),r.removeEventListener("pointerleave",s))};r.addEventListener("pointerleave",s,n)};return a.forEach(e=>{e.addEventListener("pointerenter",i,n)}),s}(e,(e,t)=>(ud(this.node,t,"Start"),e=>ud(this.node,e,"End"))))}unmount(){}}}},Ad={layout:{ProjectionNode:od,MeasureLayout:tc}},Cd=oi((0,n.A)((0,n.A)((0,n.A)((0,n.A)({},xl),Ed),ld),Ad),Is),Id=y("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),Td=y("loader",[["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m16.2 7.8 2.9-2.9",key:"r700ao"}],["path",{d:"M18 12h4",key:"wj9ykh"}],["path",{d:"m16.2 16.2 2.9 2.9",key:"1bxg5t"}],["path",{d:"M12 18v4",key:"jadmvz"}],["path",{d:"m4.9 19.1 2.9-2.9",key:"bwix9q"}],["path",{d:"M2 12h4",key:"j09sii"}],["path",{d:"m4.9 4.9 2.9 2.9",key:"giyufr"}]]),Dd=y("map-pin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]),Pd=y("trending-up",[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]]),Fd=y("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),Ld=y("star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]),Md=y("package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]]),Rd=y("message-square",[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]]),Od=y("bell",[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]]),Bd=t=>{var r,a;let{usuario:i,onClose:o}=t;const[l,c]=(0,e.useState)(!0),[d,u]=(0,e.useState)({tarefas:[],emprestimos:[],mensagens:[],notificacoes:[],pontos:0,avaliacoes:[],localizacaoBanco:{principal:"",colecoes:[]}});(0,e.useEffect)(()=>{h()},[i]);const h=async()=>{try{c(!0);const e=await m(),t=await f(),r=await g(),a=await p(),n=await x(),{pontos:s,avaliacoes:i}=await y(t);u({tarefas:t,emprestimos:r,mensagens:a,notificacoes:n,pontos:s,avaliacoes:i,localizacaoBanco:e})}catch(e){console.error("Erro ao carregar dados:",e)}finally{c(!1)}},m=async()=>{const e=[];try{const t=(0,s.doc)(P.db,"usuarios",i.id),r=await(0,s.x7)(t);r.exists()&&e.push({nome:"usuarios",banco:"workflow-cfe2e (Firebase Principal)",projectId:"workflow-cfe2e",caminho:"usuarios/".concat(i.id),dados:r.data()})}catch(t){console.log("N\xe3o encontrado em workflow-cfe2e/usuarios")}try{const t=(0,s.collection)(P.db,"funcionarios"),r=(0,s.P)(t,(0,s._M)("userId","==",i.id)),a=await(0,s.GG)(r);a.empty||a.forEach(t=>{e.push({nome:"funcionarios",banco:"workflow-cfe2e (Firebase Principal)",projectId:"workflow-cfe2e",caminho:"funcionarios/".concat(t.id),dados:t.data()})})}catch(t){console.log("N\xe3o encontrado em workflow-cfe2e/funcionarios")}try{const t=(0,s.collection)(vt,"usuarios"),r=(0,s.P)(t,(0,s._M)("email","==",i.email)),a=await(0,s.GG)(r);a.empty||a.forEach(t=>{e.push({nome:"usuarios",banco:"workflowbr1 (Firebase Novo)",projectId:"workflowbr1",caminho:"usuarios/".concat(t.id),dados:t.data()})})}catch(t){console.log("N\xe3o encontrado em workflowbr1/usuarios")}return{principal:e.length>0?e[0].banco:"N\xe3o encontrado",colecoes:e}},f=async()=>{try{const e=(0,s.collection)(P.db,"tarefas"),t=(0,s.P)(e,(0,s._M)("funcionariosIds","array-contains",i.id)),r=await(0,s.GG)(t),a=(0,s.P)(e,(0,s._M)("funcionariosIds","array-contains",i.nome)),o=await(0,s.GG)(a),l=new Map;return r.forEach(e=>{l.set(e.id,(0,n.A)({id:e.id},e.data()))}),o.forEach(e=>{l.has(e.id)||l.set(e.id,(0,n.A)({id:e.id},e.data()))}),Array.from(l.values())}catch(e){return console.error("Erro ao carregar tarefas:",e),[]}},g=async()=>{try{const e=(0,s.collection)(P.db,"emprestimos"),t=(0,s.P)(e,(0,s._M)("funcionarioId","==",i.id));return(await(0,s.GG)(t)).docs.map(e=>(0,n.A)({id:e.id},e.data()))}catch(e){return console.error("Erro ao carregar empr\xe9stimos:",e),[]}},p=async()=>{try{const e=(0,s.collection)(P.db,"mensagens"),t=(0,s.P)(e,(0,s._M)("userId","==",i.id));return(await(0,s.GG)(t)).docs.map(e=>(0,n.A)({id:e.id},e.data()))}catch(e){return console.error("Erro ao carregar mensagens:",e),[]}},x=async()=>{try{const e=(0,s.collection)(P.db,"notificacoes"),t=(0,s.P)(e,(0,s._M)("usuarioId","==",i.id));return(await(0,s.GG)(t)).docs.map(e=>(0,n.A)({id:e.id},e.data()))}catch(e){return console.error("Erro ao carregar notifica\xe7\xf5es:",e),[]}},y=async e=>{let t=0;const r=[];return e.forEach(e=>{"concluida"===e.status&&(t+=50,e.avaliacao&&(t+=10*e.avaliacao.estrelas,r.push({tarefaId:e.id,titulo:e.titulo,estrelas:e.avaliacao.estrelas,feedback:e.avaliacao.feedback,data:e.avaliacao.data})))}),{pontos:t,avaliacoes:r}},v=e=>{if(!e)return"N/A";try{return new Date(e).toLocaleString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})}catch(Z_){return e}};return(0,k.jsx)(Pr,{children:(0,k.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[(0,k.jsx)(Cd.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:o,className:"absolute inset-0 bg-black/60 backdrop-blur-sm"}),(0,k.jsxs)(Cd.div,{initial:{opacity:0,scale:.9,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.9,y:20},className:"relative w-full max-w-6xl bg-white dark:bg-gray-800 rounded-2xl shadow-2xl overflow-hidden max-h-[90vh] flex flex-col",children:[(0,k.jsxs)("div",{className:"bg-gradient-to-r from-[#1d9bf0] to-blue-600 text-white p-6",children:[(0,k.jsx)("button",{onClick:o,className:"absolute top-4 right-4 p-2 hover:bg-white/20 rounded-full transition-colors z-10",children:(0,k.jsx)(Id,{className:"w-5 h-5"})}),(0,k.jsxs)("h2",{className:"text-2xl font-bold flex items-center gap-3",children:[(0,k.jsx)(xr,{className:"w-8 h-8"}),"Dados Completos do Usu\xe1rio"]}),(0,k.jsx)("p",{className:"text-blue-100 mt-1",children:"Todas as informa\xe7\xf5es e rela\xe7\xf5es no banco de dados"}),(0,k.jsxs)("div",{className:"mt-4 flex items-center gap-4",children:[(0,k.jsx)("div",{className:"w-16 h-16 bg-white/20 rounded-full flex items-center justify-center text-2xl font-bold",children:(null===(r=i.nome)||void 0===r||null===(a=r[0])||void 0===a?void 0:a.toUpperCase())||"?"}),(0,k.jsxs)("div",{children:[(0,k.jsx)("div",{className:"font-semibold text-lg",children:i.nome}),(0,k.jsx)("div",{className:"text-blue-100",children:i.email}),(0,k.jsxs)("div",{className:"text-sm text-blue-200",children:["ID: ",i.id]})]})]})]}),(0,k.jsx)("div",{className:"flex-1 overflow-y-auto p-6",children:l?(0,k.jsxs)("div",{className:"flex flex-col items-center justify-center py-12",children:[(0,k.jsx)(Td,{className:"w-12 h-12 text-[#1d9bf0] animate-spin mb-4"}),(0,k.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"Carregando dados do banco..."})]}):(0,k.jsxs)("div",{className:"space-y-6",children:[(0,k.jsxs)("section",{className:"bg-gradient-to-r from-purple-50 to-blue-50 dark:from-purple-900/20 dark:to-blue-900/20 rounded-xl p-6 border-2 border-purple-200 dark:border-purple-700",children:[(0,k.jsxs)("h3",{className:"text-lg font-semibold text-gray-800 dark:text-white mb-4 flex items-center gap-2",children:[(0,k.jsx)(Dd,{className:"w-5 h-5 text-purple-600"}),"Localiza\xe7\xe3o no Banco de Dados"]}),(0,k.jsxs)("div",{className:"space-y-3",children:[(0,k.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-4",children:[(0,k.jsx)("div",{className:"text-sm text-gray-600 dark:text-gray-400 mb-1",children:"Banco Principal:"}),(0,k.jsx)("div",{className:"font-semibold text-gray-900 dark:text-white",children:d.localizacaoBanco.principal})]}),d.localizacaoBanco.colecoes.length>0?(0,k.jsxs)("div",{children:[(0,k.jsxs)("div",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:["Encontrado em ",d.localizacaoBanco.colecoes.length," cole\xe7\xe3o(\xf5es):"]}),d.localizacaoBanco.colecoes.map((e,t)=>(0,k.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-4 mb-2",children:(0,k.jsx)("div",{className:"flex items-start justify-between",children:(0,k.jsxs)("div",{className:"flex-1",children:[(0,k.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,k.jsx)(xr,{className:"w-4 h-4 text-[#1d9bf0]"}),(0,k.jsx)("span",{className:"font-semibold text-gray-900 dark:text-white",children:e.banco})]}),(0,k.jsxs)("div",{className:"text-sm space-y-1",children:[(0,k.jsxs)("div",{children:[(0,k.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"Cole\xe7\xe3o: "}),(0,k.jsx)("code",{className:"bg-gray-100 dark:bg-gray-700 px-2 py-1 rounded text-xs",children:e.nome})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"Caminho: "}),(0,k.jsx)("code",{className:"bg-gray-100 dark:bg-gray-700 px-2 py-1 rounded text-xs",children:e.caminho})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"Project ID: "}),(0,k.jsx)("code",{className:"bg-gray-100 dark:bg-gray-700 px-2 py-1 rounded text-xs",children:e.projectId})]})]})]})})},t))]}):(0,k.jsx)("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-700 rounded-lg p-4",children:(0,k.jsx)("p",{className:"text-sm text-yellow-800 dark:text-yellow-200",children:"\u26a0\ufe0f Usu\xe1rio n\xe3o encontrado em nenhuma cole\xe7\xe3o do Firebase"})})]})]}),(0,k.jsxs)("section",{children:[(0,k.jsxs)("h3",{className:"text-lg font-semibold text-gray-800 dark:text-white mb-4 flex items-center gap-2",children:[(0,k.jsx)(Pd,{className:"w-5 h-5 text-[#1d9bf0]"}),"Estat\xedsticas Gerais"]}),(0,k.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,k.jsx)("div",{className:"bg-blue-50 dark:bg-blue-900/20 rounded-lg p-4 border border-blue-200 dark:border-blue-700",children:(0,k.jsxs)("div",{className:"flex items-center gap-3",children:[(0,k.jsx)(Fd,{className:"w-8 h-8 text-blue-600"}),(0,k.jsxs)("div",{children:[(0,k.jsx)("div",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:d.tarefas.length}),(0,k.jsx)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Tarefas"})]})]})}),(0,k.jsx)("div",{className:"bg-green-50 dark:bg-green-900/20 rounded-lg p-4 border border-green-200 dark:border-green-700",children:(0,k.jsxs)("div",{className:"flex items-center gap-3",children:[(0,k.jsx)(Ld,{className:"w-8 h-8 text-green-600"}),(0,k.jsxs)("div",{children:[(0,k.jsx)("div",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:d.pontos}),(0,k.jsx)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Pontos"})]})]})}),(0,k.jsx)("div",{className:"bg-purple-50 dark:bg-purple-900/20 rounded-lg p-4 border border-purple-200 dark:border-purple-700",children:(0,k.jsxs)("div",{className:"flex items-center gap-3",children:[(0,k.jsx)(Md,{className:"w-8 h-8 text-purple-600"}),(0,k.jsxs)("div",{children:[(0,k.jsx)("div",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:d.emprestimos.length}),(0,k.jsx)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Empr\xe9stimos"})]})]})}),(0,k.jsx)("div",{className:"bg-orange-50 dark:bg-orange-900/20 rounded-lg p-4 border border-orange-200 dark:border-orange-700",children:(0,k.jsxs)("div",{className:"flex items-center gap-3",children:[(0,k.jsx)(Rd,{className:"w-8 h-8 text-orange-600"}),(0,k.jsxs)("div",{children:[(0,k.jsx)("div",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:d.mensagens.length}),(0,k.jsx)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Mensagens"})]})]})})]})]}),(0,k.jsxs)("section",{children:[(0,k.jsxs)("h3",{className:"text-lg font-semibold text-gray-800 dark:text-white mb-4 flex items-center gap-2",children:[(0,k.jsx)(Fd,{className:"w-5 h-5 text-[#1d9bf0]"}),"Tarefas (",d.tarefas.length,")"]}),d.tarefas.length>0?(0,k.jsx)("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:d.tarefas.map(e=>{return(0,k.jsxs)("div",{className:"bg-white dark:bg-gray-700 rounded-lg p-4 border border-gray-200 dark:border-gray-600",children:[(0,k.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,k.jsxs)("div",{className:"flex-1",children:[(0,k.jsx)("h4",{className:"font-semibold text-gray-900 dark:text-white",children:e.titulo}),(0,k.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:e.descricao})]}),(0,k.jsx)("span",{className:"px-3 py-1 rounded-full text-xs font-medium border ".concat((r=e.status,{pendente:"bg-gray-100 text-gray-700 border-gray-300",em_andamento:"bg-blue-100 text-blue-700 border-blue-300",pausada:"bg-yellow-100 text-yellow-700 border-yellow-300",concluida:"bg-green-100 text-green-700 border-green-300",cancelada:"bg-red-100 text-red-700 border-red-300"}[r]||"bg-gray-100 text-gray-700")),children:e.status})]}),(0,k.jsxs)("div",{className:"grid grid-cols-2 gap-4 mt-3 text-sm",children:[(0,k.jsxs)("div",{children:[(0,k.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"Prioridade: "}),(0,k.jsx)("span",{className:"font-semibold ".concat((t=e.prioridade,{baixa:"text-green-600",media:"text-yellow-600",alta:"text-orange-600",urgente:"text-red-600"}[t]||"text-gray-600")),children:e.prioridade})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"Criado: "}),(0,k.jsx)("span",{className:"text-gray-900 dark:text-white",children:v(e.dataCriacao)})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"ID: "}),(0,k.jsx)("code",{className:"text-xs bg-gray-100 dark:bg-gray-600 px-2 py-1 rounded",children:e.id})]}),e.avaliacao&&(0,k.jsxs)("div",{children:[(0,k.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"Avalia\xe7\xe3o: "}),(0,k.jsx)("span",{className:"text-yellow-600",children:"\u2b50".repeat(e.avaliacao.estrelas)})]})]})]},e.id);var t,r})}):(0,k.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-8 text-center",children:[(0,k.jsx)(w,{className:"w-12 h-12 text-gray-400 mx-auto mb-2"}),(0,k.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"Nenhuma tarefa encontrada"})]})]}),d.emprestimos.length>0&&(0,k.jsxs)("section",{children:[(0,k.jsxs)("h3",{className:"text-lg font-semibold text-gray-800 dark:text-white mb-4 flex items-center gap-2",children:[(0,k.jsx)(Md,{className:"w-5 h-5 text-[#1d9bf0]"}),"Empr\xe9stimos (",d.emprestimos.length,")"]}),(0,k.jsx)("div",{className:"space-y-3 max-h-64 overflow-y-auto",children:d.emprestimos.map(e=>(0,k.jsx)("div",{className:"bg-white dark:bg-gray-700 rounded-lg p-4 border border-gray-200 dark:border-gray-600",children:(0,k.jsxs)("div",{className:"flex items-center justify-between",children:[(0,k.jsxs)("div",{children:[(0,k.jsx)("div",{className:"font-semibold text-gray-900 dark:text-white",children:e.ferramenta||e.item}),(0,k.jsxs)("div",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:["Emprestado em: ",v(e.dataEmprestimo)]})]}),(0,k.jsxs)("div",{className:"text-right",children:[(0,k.jsxs)("div",{className:"text-sm",children:[(0,k.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"Status: "}),(0,k.jsx)("span",{className:"font-semibold ".concat(e.devolvido?"text-green-600":"text-orange-600"),children:e.devolvido?"Devolvido":"Pendente"})]}),(0,k.jsx)("code",{className:"text-xs text-gray-500 dark:text-gray-400",children:e.id})]})]})},e.id))})]}),d.notificacoes.length>0&&(0,k.jsxs)("section",{children:[(0,k.jsxs)("h3",{className:"text-lg font-semibold text-gray-800 dark:text-white mb-4 flex items-center gap-2",children:[(0,k.jsx)(Od,{className:"w-5 h-5 text-[#1d9bf0]"}),"Notifica\xe7\xf5es (",d.notificacoes.length,")"]}),(0,k.jsx)("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:d.notificacoes.slice(0,10).map(e=>(0,k.jsx)("div",{className:"bg-white dark:bg-gray-700 rounded-lg p-3 border border-gray-200 dark:border-gray-600 text-sm",children:(0,k.jsxs)("div",{className:"flex items-start justify-between",children:[(0,k.jsxs)("div",{className:"flex-1",children:[(0,k.jsx)("div",{className:"font-medium text-gray-900 dark:text-white",children:e.titulo}),(0,k.jsx)("div",{className:"text-gray-600 dark:text-gray-400 text-xs mt-1",children:e.mensagem})]}),(0,k.jsx)("span",{className:"px-2 py-1 rounded text-xs ".concat(e.lida?"bg-gray-100 text-gray-600":"bg-blue-100 text-blue-600"),children:e.lida?"Lida":"Nova"})]})},e.id))})]})]})}),(0,k.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-700/50 px-6 py-4 flex justify-between items-center border-t border-gray-200 dark:border-gray-600",children:[(0,k.jsxs)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:["\xdaltima atualiza\xe7\xe3o: ",(new Date).toLocaleString("pt-BR")]}),(0,k.jsx)("button",{onClick:o,className:"px-6 py-2 bg-[#1d9bf0] hover:bg-[#1a8cd8] text-white rounded-lg transition-colors font-medium",children:"Fechar"})]})]})]})})},zd=t=>{var r;let{isOpen:a,onClose:i,userId:o}=t;const{usuario:l,atualizarUsuario:c}=Nt(),{showToast:d}=_(),[u,h]=(0,e.useState)(!1),[m,f]=(0,e.useState)(!1),[g,p]=(0,e.useState)(!1),x=(null===l||void 0===l?void 0:l.id)===o,[y,v]=(0,e.useState)({nome:(null===l||void 0===l?void 0:l.nome)||"",email:(null===l||void 0===l?void 0:l.email)||"",senha:"",telefone:(null===l||void 0===l?void 0:l.telefone)||"",nivel:(null===l||void 0===l?void 0:l.nivel)||jt.FUNCIONARIO,ativo:null===(r=null===l||void 0===l?void 0:l.ativo)||void 0===r||r});(0,e.useEffect)(()=>{var e;a&&l&&v({nome:l.nome||"",email:l.email||"",senha:"",telefone:l.telefone||"",nivel:l.nivel||jt.FUNCIONARIO,ativo:null===(e=l.ativo)||void 0===e||e})},[a,l]);return a?(0,k.jsxs)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:[(0,k.jsx)("div",{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-300 dark:border-gray-600 rounded-xl shadow-lg max-w-lg w-full mx-4",children:(0,k.jsxs)("div",{className:"p-6",children:[(0,k.jsx)("div",{className:"flex items-center justify-between mb-6",children:(0,k.jsx)("h3",{className:"text-lg font-medium text-gray-900 dark:text-[#FFFFFF]",children:(null===l||void 0===l?void 0:l.id)===o?"Editar Perfil":"Visualizar Perfil"})}),(0,k.jsxs)("div",{className:"space-y-4",children:[(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium text-gray-900 dark:text-[#FFFFFF] mb-2",children:"Nome Completo"}),(0,k.jsx)("input",{type:"text",className:"w-full px-3 py-2 bg-gray-100 dark:bg-gray-700 text-gray-900 dark:text-white border border-gray-200 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-[#1d9bf0] focus:border-transparent",placeholder:"Digite o nome completo",value:y.nome||"",onChange:e=>v(t=>(0,n.A)((0,n.A)({},t),{},{nome:e.target.value})),disabled:!x})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium text-gray-900 dark:text-[#FFFFFF] mb-2",children:"Email (Login)"}),(0,k.jsx)("input",{type:"email",className:"w-full px-3 py-2 bg-gray-100 dark:bg-gray-700 text-gray-900 dark:text-white border border-gray-200 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-[#1d9bf0] focus:border-transparent",placeholder:"seu.email@exemplo.com",value:y.email||"",onChange:e=>v(t=>(0,n.A)((0,n.A)({},t),{},{email:e.target.value})),disabled:!x}),(0,k.jsx)("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:"Este ser\xe1 seu novo login de acesso"})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium text-gray-900 dark:text-[#FFFFFF] mb-2",children:"Telefone"}),(0,k.jsx)("input",{type:"tel",className:"w-full px-3 py-2 bg-gray-100 dark:bg-gray-700 text-gray-900 dark:text-white border border-gray-200 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-[#1d9bf0] focus:border-transparent",placeholder:"(11) 98765-4321",value:y.telefone||"",onChange:e=>v(t=>(0,n.A)((0,n.A)({},t),{},{telefone:e.target.value})),disabled:!x})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium text-gray-900 dark:text-[#FFFFFF] mb-2",children:"Nova Senha"}),(0,k.jsxs)("div",{className:"relative",children:[(0,k.jsx)("input",{type:m?"text":"password",className:"w-full px-3 py-2 pr-10 bg-gray-100 dark:bg-gray-700 text-gray-900 dark:text-white border border-gray-200 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-[#1d9bf0] focus:border-transparent",placeholder:x?"Deixe em branco para manter a atual":"",value:y.senha||"",onChange:e=>v(t=>(0,n.A)((0,n.A)({},t),{},{senha:e.target.value})),disabled:!x}),x&&(0,k.jsx)("button",{type:"button",onClick:()=>f(!m),className:"absolute right-3 top-1/2 -translate-y-1/2 p-1 hover:bg-[#1d9bf0] hover:bg-opacity-10 rounded-full transition-colors",children:m?(0,k.jsx)(gr,{className:"w-5 h-5 text-[#1d9bf0]"}):(0,k.jsx)(pr,{className:"w-5 h-5 text-[#1d9bf0]"})})]}),(0,k.jsx)("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:"M\xednimo de 6 caracteres. Deixe vazio para n\xe3o alterar"})]})]}),x&&(0,k.jsxs)("div",{className:"mt-6 pt-4 border-t border-gray-200 dark:border-[#2F3336]",children:[(0,k.jsxs)("button",{onClick:()=>p(!0),className:"w-full px-4 py-3 bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700 text-white rounded-lg transition-all duration-200 flex items-center justify-center gap-2 font-semibold",children:[(0,k.jsx)(xr,{className:"w-5 h-5"}),"Ver Todos os Meus Dados no Sistema"]}),(0,k.jsx)("p",{className:"mt-2 text-xs text-center text-gray-500 dark:text-gray-400",children:"Visualize todas as tarefas, empr\xe9stimos e localiza\xe7\xe3o no banco de dados"})]}),(0,k.jsxs)("div",{className:"flex justify-end space-x-3 mt-6 pt-4 border-t border-gray-200 dark:border-[#2F3336]",children:[(0,k.jsx)("button",{onClick:i,className:"px-6 py-2 bg-gray-100 hover:bg-gray-200 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-700 dark:text-white rounded-lg transition-colors disabled:opacity-50",children:"Cancelar"}),x&&(0,k.jsx)("button",{onClick:async()=>{try{var e,t,r,a,o,u;if(!x)return void d("Voc\xea s\xf3 pode editar seu pr\xf3prio perfil","error");if(h(!0),null===(e=y.nome)||void 0===e||!e.trim())return d("O nome \xe9 obrigat\xf3rio","error"),void h(!1);if(null!==(t=y.email)&&void 0!==t&&t.trim()&&y.email!==l.email){if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(y.email.trim()))return d("Email inv\xe1lido","error"),void h(!1)}if(null!==(r=y.telefone)&&void 0!==r&&r.trim()){if(!/^[\d\s\-\(\)]+$/.test(y.telefone.trim()))return d("Telefone inv\xe1lido. Use apenas n\xfameros, espa\xe7os, par\xeanteses e tra\xe7os","error"),void h(!1)}const g={nome:y.nome.trim(),ativo:y.ativo};if(null!==(a=y.email)&&void 0!==a&&a.trim()&&y.email!==l.email&&(g.email=y.email.trim().toLowerCase()),null!==(o=y.telefone)&&void 0!==o&&o.trim()&&(g.telefone=y.telefone.trim()),null!==(u=y.senha)&&void 0!==u&&u.trim()){if(y.senha.trim().length<6)return d("A senha deve ter no m\xednimo 6 caracteres","error"),void h(!1);const e=B(y.senha.trim());g.senhaHash=e.hash,g.senhaSalt=e.salt,g.senhaVersion=e.version,g.senhaAlgorithm=e.algorithm,g.senha=null,g.authKey=0===l.nivel?"admin2024":"workflow2024",g.authKeyUpdatedAt=new Date,g.dataAlteracaoSenha=(new Date).toISOString(),console.log("\ud83d\udd11 Campo authKey atualizado junto com a senha:",g.authKey),console.log("\ud83d\udd12 Senha criptografada com SHA-512 e authKey configurado")}try{await(0,s.updateDoc)((0,s.doc)(P.db,"usuarios",l.id),g),console.log("\u2705 Usu\xe1rio atualizado no Firebase principal");try{await(0,s.updateDoc)((0,s.doc)(Jt,"usuarios",l.id),g),console.log("\u2705 Usu\xe1rio atualizado no Firebase Backup")}catch(m){console.warn("\u26a0\ufe0f Erro ao atualizar Firebase Backup (n\xe3o cr\xedtico):",m)}}catch(f){throw console.error("\u274c Erro ao atualizar Firebase principal:",f),f}c((0,n.A)((0,n.A)({},l),g)),d("Perfil atualizado com sucesso!","success"),i()}catch(f){console.error("Erro ao atualizar:",f),d("Erro ao atualizar perfil: "+(f.message||"Tente novamente"),"error")}finally{h(!1)}},disabled:u,className:"px-6 py-2 bg-[#1d9bf0] hover:bg-[#1a8cd8] text-white rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:u?(0,k.jsxs)("div",{className:"flex items-center gap-2",children:[(0,k.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Salvando..."]}):"Atualizar"})]})]})}),g&&(0,k.jsx)(Bd,{usuario:l,onClose:()=>p(!1)})]}):null},Ud=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function Vd(e){if("serviceWorker"in navigator){if(new URL(".",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",()=>{const t="".concat(".","/service-worker.js");Ud?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then(r=>{const a=r.headers.get("content-type");404===r.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then(e=>{e.unregister().then(()=>{window.location.reload()})}):qd(e,t)}).catch(()=>{console.log("No internet connection found. App is running in offline mode.")})}(t,e),navigator.serviceWorker.ready.then(()=>{console.log("This web app is being served cache-first by a service worker. To learn more, visit https://cra.link/PWA")})):qd(t,e)}),window.addEventListener("online",function(e){console.log("Online")}),window.addEventListener("offline",function(e){console.log("Offline")})}}function qd(e,t){navigator.serviceWorker.register(e).then(async e=>{if("Notification"in window){"granted"===await Notification.requestPermission()&&await async function(e){try{const t=await e.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:{NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_ENV:"production"}.REACT_APP_VAPID_PUBLIC_KEY});return console.log("Push Notification subscription:",t),t}catch(t){return console.error("Erro ao se inscrever para notifica\xe7\xf5es push:",t),null}}(e)}e.onupdatefound=()=>{const r=e.installing;null!=r&&(r.onstatechange=()=>{"installed"===r.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://cra.link/PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}}).catch(e=>{console.error("Error during service worker registration:",e)})}const Hd=()=>{const[t,r]=(0,e.useState)(null),[a,n]=(0,e.useState)(!1);(0,e.useEffect)(()=>{Vd({onUpdate:e=>{r(e.waiting),n(!0)}})},[]);return a?(0,k.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,k.jsx)("div",{className:"bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-xl shadow-lg max-w-md w-full mx-4",children:(0,k.jsxs)("div",{className:"p-6",children:[(0,k.jsx)("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4",children:"Nova atualiza\xe7\xe3o dispon\xedvel!"}),(0,k.jsx)("p",{className:"text-gray-500 dark:text-gray-400 mb-6",children:"Uma nova vers\xe3o do aplicativo est\xe1 dispon\xedvel. Atualize para obter as \xfaltimas melhorias e corre\xe7\xf5es."}),(0,k.jsx)("div",{className:"flex justify-end",children:(0,k.jsx)("button",{onClick:()=>{null===t||void 0===t||t.postMessage({type:"SKIP_WAITING"}),n(!1),window.location.reload()},className:"px-6 py-3 bg-blue-500 dark:bg-[#1D9BF0] text-gray-900 dark:text-white rounded-full font-medium hover:bg-blue-600 dark:hover:bg-[#1a8cd8] transition-colors",children:"Atualizar agora"})})]})})}):null},Gd=y("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]]),Wd=y("zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),Kd=y("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),Qd=()=>{const[t,r]=(0,e.useState)(!1),[a,n]=(0,e.useState)(null),[s,i]=(0,e.useState)(null),[o,l]=(0,e.useState)(!1),c=(0,e.useRef)(null),d=(0,e.useRef)(null),u=(0,e.useCallback)(async()=>{try{const e=await fetch("/version.json",{cache:"no-store",headers:{"Cache-Control":"no-cache",Pragma:"no-cache"}}),t=await e.json();return d.current=t,n(t),t}catch(e){return console.error("Erro ao carregar vers\xe3o local:",e),null}},[]),h=(0,e.useCallback)(async()=>{if(!o){l(!0);try{const e=(new Date).getTime(),t=await fetch("/version.json?t=".concat(e),{cache:"no-store",headers:{"Cache-Control":"no-cache",Pragma:"no-cache"}});if(!t.ok)return console.warn("N\xe3o foi poss\xedvel verificar atualiza\xe7\xf5es"),!1;const a=await t.json();d.current||await u();const n=m(a,d.current);return n&&(console.log("\u2728 Nova vers\xe3o dispon\xedvel!",{atual:d.current,nova:a}),i(a),r(!0),"Notification"in window&&"granted"===Notification.permission&&new Notification("Atualiza\xe7\xe3o Dispon\xedvel",{body:"Uma nova vers\xe3o do sistema est\xe1 dispon\xedvel!",icon:"/logo192.png",badge:"/logo192.png",tag:"app-update",requireInteraction:!1})),n}catch(e){return console.error("Erro ao verificar atualiza\xe7\xf5es:",e),!1}finally{l(!1)}}},[o,u]),m=(e,t)=>{if(!e||!t)return!1;return new Date(e.buildDate).getTime()>new Date(t.buildDate).getTime()||(e.buildNumber&&t.buildNumber?e.buildNumber>t.buildNumber:f(e.version,t.version))},f=(e,t)=>{const r=e.split(".").map(Number),a=t.split(".").map(Number);for(let n=0;n<Math.max(r.length,a.length);n++){const e=r[n]||0,t=a[n]||0;if(e>t)return!0;if(e<t)return!1}return!1},g=(0,e.useCallback)(async()=>{try{if("serviceWorker"in navigator){const e=await navigator.serviceWorker.getRegistration();e&&e.waiting&&(e.waiting.postMessage({type:"SKIP_WAITING"}),await new Promise(e=>setTimeout(e,500))),e&&await e.update()}if("caches"in window){const e=await caches.keys();await Promise.all(e.map(e=>caches.delete(e)))}localStorage.removeItem("app-version"),s&&localStorage.setItem("app-version",JSON.stringify(s)),window.location.reload(!0)}catch(e){console.error("Erro ao aplicar atualiza\xe7\xe3o:",e),window.location.reload(!0)}},[s]),p=(0,e.useCallback)(()=>{r(!1),localStorage.setItem("update-dismissed-at",Date.now().toString())},[]);return(0,e.useEffect)(()=>{u();const e=setTimeout(()=>{h()},5e3);c.current=setInterval(()=>{h()},3e5);const t=()=>{h()};window.addEventListener("focus",t);const r=()=>{h()};return window.addEventListener("online",r),()=>{clearTimeout(e),c.current&&clearInterval(c.current),window.removeEventListener("focus",t),window.removeEventListener("online",r)}},[u,h]),{updateAvailable:t,currentVersion:a,newVersion:s,isChecking:o,checkForUpdate:h,applyUpdate:g,dismissUpdate:p}};var Yd=r(9034);const Xd=()=>{const[t,r]=(0,e.useState)(navigator.onLine),[a,n]=(0,e.useState)(0),[s,i]=(0,e.useState)(!1),[o,l]=(0,e.useState)(null),c=(0,e.useCallback)(async()=>{try{const e=await Yd.default.getPendingCount();n(e)}catch(e){console.error("Erro ao obter contagem de pendentes:",e)}},[]),d=(0,e.useCallback)(async()=>{if(!t)return console.warn("N\xe3o \xe9 poss\xedvel sincronizar offline"),!1;i(!0);try{return await Yd.default.syncPendingOperations(),await c(),l(new Date),!0}catch(e){return console.error("Erro ao sincronizar:",e),!1}finally{i(!1)}},[t,c]),u=(0,e.useCallback)(async(e,r,a,n)=>{const s={type:e,collection:r,id:a,data:n,timestamp:Date.now()};if(!t)return await Yd.default.savePendingOperation(s),await c(),console.log("\ud83d\udcbe Opera\xe7\xe3o salva offline:",e),!1;try{return await Yd.default.executeOperation(s),console.log("\u2705 Opera\xe7\xe3o executada online:",e),!0}catch(i){return console.error("\u274c Erro ao executar online, salvando para depois:",i),await Yd.default.savePendingOperation(s),await c(),!1}},[t,c]),h=(0,e.useCallback)(async(e,t,r)=>{try{await Yd.default.cacheData(e,t,r),console.log("\ud83d\udcbe Dados salvos em cache:",e)}catch(a){console.error("Erro ao salvar cache:",a)}},[]),m=(0,e.useCallback)(async e=>{try{const t=await Yd.default.getCachedData(e);return t&&console.log("\ud83d\udce6 Dados obtidos do cache:",e),t}catch(t){return console.error("Erro ao obter cache:",t),null}},[]),f=(0,e.useCallback)(async()=>{try{const e=await Yd.default.clearExpiredCache();return console.log("\ud83e\uddf9 ".concat(e," itens de cache removidos")),e}catch(e){return console.error("Erro ao limpar cache:",e),0}},[]);return(0,e.useEffect)(()=>{const e=Yd.default.addStatusListener((e,t)=>{r(t),"online"===e?(console.log("\ud83c\udf10 Online! Sincronizando automaticamente..."),d()):"offline"===e?console.log("\ud83d\udcf4 Offline! Opera\xe7\xf5es ser\xe3o salvas localmente."):"synced"===e&&c()});c();const t=setInterval(()=>{f()},18e5);return()=>{e(),clearInterval(t)}},[d,c,f]),{isOnline:t,pendingCount:a,isSyncing:s,lastSyncTime:o,syncNow:d,saveOperation:u,cacheData:h,getCachedData:m,clearExpiredCache:f}},Jd=["src","alt","className","style"],Zd=e=>{let{src:t,alt:r="Logo",className:s="",style:i={}}=e,o=(0,a.A)(e,Jd);const{isOnline:l}=Xd(),c={filter:l?"none":"brightness(0.4) sepia(1) hue-rotate(-50deg) saturate(6)",transition:"filter 0.3s ease-in-out"};return(0,k.jsx)("img",(0,n.A)({src:t,alt:r,className:s,style:(0,n.A)((0,n.A)({},i),c)},o))},$d=()=>{const{updateAvailable:t,currentVersion:r,newVersion:a,isChecking:n,applyUpdate:s,dismissUpdate:i,checkForUpdate:o}=Qd(),[l,c]=(0,e.useState)(!1),[d,u]=(0,e.useState)(0),[h,m]=(0,e.useState)(null);(0,e.useEffect)(()=>{if(l){u(0);const e=setInterval(()=>{u(t=>t>=90?(clearInterval(e),90):t+10)},100);return()=>clearInterval(e)}},[l]),(0,e.useEffect)(()=>{if(t&&!h){m(30);const e=setInterval(()=>{m(t=>t<=1?(clearInterval(e),f(),0):t-1)},1e3);return()=>clearInterval(e)}},[t,h]);const f=async()=>{c(!0),u(0),await new Promise(e=>setTimeout(e,1e3)),u(100),await new Promise(e=>setTimeout(e,300)),await s()},g=()=>{m(null),i()};return t?(0,k.jsx)(Pr,{children:(0,k.jsx)(Cd.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-[9999] p-4",children:(0,k.jsxs)(Cd.div,{initial:{scale:.9,opacity:0,y:20},animate:{scale:1,opacity:1,y:0},exit:{scale:.9,opacity:0,y:20},transition:{type:"spring",damping:20,stiffness:300},className:"bg-white dark:bg-gray-800 rounded-2xl shadow-2xl max-w-md w-full overflow-hidden",children:[(0,k.jsxs)("div",{className:"bg-blue-600 dark:bg-blue-700 p-6 relative overflow-hidden",children:[(0,k.jsx)("div",{className:"absolute inset-0 bg-white/10 backdrop-blur-sm"}),(0,k.jsxs)("div",{className:"relative z-10",children:[(0,k.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,k.jsxs)("div",{className:"flex items-center gap-3",children:[(0,k.jsx)("div",{className:"w-8 h-8 flex items-center justify-center",children:(0,k.jsx)(Zd,{src:"/logo.png",alt:"WorkFlow Logo",className:"w-full h-full object-contain"})}),(0,k.jsx)("h2",{className:"text-2xl font-bold text-white",children:"Nova Atualiza\xe7\xe3o!"})]}),!l&&h>10&&(0,k.jsx)("button",{onClick:g,className:"text-white/80 hover:text-white transition-colors","aria-label":"Fechar",children:(0,k.jsx)(Id,{className:"w-5 h-5"})})]}),(0,k.jsx)("p",{className:"text-white/90 text-sm",children:"Uma nova vers\xe3o est\xe1 dispon\xedvel com melhorias e corre\xe7\xf5es"})]})]}),(0,k.jsxs)("div",{className:"p-6",children:[(0,k.jsxs)("div",{className:"space-y-3 mb-6",children:[(0,k.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg",children:[(0,k.jsx)("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Vers\xe3o Atual"}),(0,k.jsxs)("span",{className:"font-mono font-semibold text-gray-900 dark:text-white",children:["v",(null===r||void 0===r?void 0:r.version)||"1.0.0"]})]}),(0,k.jsx)("div",{className:"flex items-center justify-center",children:(0,k.jsx)(Cd.div,{animate:{y:[0,-5,0]},transition:{duration:1.5,repeat:1/0},children:(0,k.jsx)(Gd,{className:"w-5 h-5 text-blue-500 dark:text-blue-400"})})}),(0,k.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gradient-to-r from-blue-50 to-blue-50 dark:from-blue-900/20 dark:to-blue-900/20 rounded-lg border-2 border-blue-200 dark:border-blue-700",children:[(0,k.jsx)("span",{className:"text-sm font-medium text-blue-700 dark:text-blue-300",children:"Nova Vers\xe3o"}),(0,k.jsxs)("div",{className:"flex items-center gap-2",children:[(0,k.jsx)(Wd,{className:"w-4 h-4 text-blue-600 dark:text-blue-400"}),(0,k.jsxs)("span",{className:"font-mono font-bold text-blue-900 dark:text-blue-100",children:["v",(null===a||void 0===a?void 0:a.version)||"1.0.1"]})]})]})]}),l&&(0,k.jsxs)(Cd.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"mb-6",children:[(0,k.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,k.jsx)("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Atualizando..."}),(0,k.jsxs)("span",{className:"text-sm font-bold text-blue-600 dark:text-blue-400",children:[d,"%"]})]}),(0,k.jsx)("div",{className:"h-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden",children:(0,k.jsx)(Cd.div,{initial:{width:0},animate:{width:"".concat(d,"%")},transition:{duration:.3},className:"h-full bg-blue-600 dark:bg-blue-500"})})]}),!l&&(0,k.jsxs)("div",{className:"space-y-3",children:[(0,k.jsxs)("button",{onClick:f,className:"w-full py-3 px-4 bg-blue-600 hover:bg-blue-700 dark:bg-blue-600 dark:hover:bg-blue-700 text-white font-semibold rounded-xl transition-all duration-200 transform hover:scale-[1.02] active:scale-[0.98] shadow-lg hover:shadow-xl flex items-center justify-center gap-2",children:[(0,k.jsx)(Kd,{className:"w-5 h-5"}),"Atualizar Agora"]}),h&&h>10&&(0,k.jsx)("button",{onClick:g,className:"w-full py-2 px-4 text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 font-medium transition-colors",children:"Lembrar mais tarde"}),h&&(0,k.jsx)(Cd.div,{initial:{opacity:0},animate:{opacity:1},className:"text-center",children:(0,k.jsxs)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Atualiza\xe7\xe3o autom\xe1tica em"," ",(0,k.jsxs)("span",{className:"font-bold text-blue-600 dark:text-blue-400",children:[h,"s"]})]})})]}),l&&(0,k.jsx)(Cd.p,{initial:{opacity:0},animate:{opacity:1},className:"text-center text-sm text-gray-600 dark:text-gray-400",children:"Aguarde enquanto atualizamos o sistema..."})]}),(0,k.jsx)("div",{className:"px-6 pb-4",children:(0,k.jsxs)("div",{className:"flex items-center justify-center gap-2 text-xs text-gray-500 dark:text-gray-400",children:[(0,k.jsx)("div",{className:"w-3 h-3 flex items-center justify-center",children:(0,k.jsx)(Zd,{src:"/logo.png",alt:"WorkFlow",className:"w-full h-full object-contain"})}),(0,k.jsx)("span",{children:"Seu sistema ser\xe1 atualizado automaticamente"})]})})]})})}):null},eu=()=>{const[t,r]=(0,e.useState)(!1);return(0,e.useEffect)(()=>{const e=()=>{r(window.innerWidth<768)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),t},tu=y("chart-column",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]),ru=y("scale",[["path",{d:"m16 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z",key:"7g6ntu"}],["path",{d:"m2 16 3-8 3 8c-.87.65-1.92 1-3 1s-2.13-.35-3-1Z",key:"ijws7r"}],["path",{d:"M7 21h10",key:"1b0cd5"}],["path",{d:"M12 3v18",key:"108xh3"}],["path",{d:"M3 7h2c2 0 5-1 7-2 2 1 5 2 7 2h2",key:"3gwbw2"}]]),au=y("menu",[["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 18h16",key:"19g7jn"}],["path",{d:"M4 6h16",key:"1o0s65"}]]),nu=y("trophy",[["path",{d:"M10 14.66v1.626a2 2 0 0 1-.976 1.696A5 5 0 0 0 7 21.978",key:"1n3hpd"}],["path",{d:"M14 14.66v1.626a2 2 0 0 0 .976 1.696A5 5 0 0 1 17 21.978",key:"rfe1zi"}],["path",{d:"M18 9h1.5a1 1 0 0 0 0-5H18",key:"7xy6bh"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M6 9a6 6 0 0 0 12 0V3a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1z",key:"1mhfuq"}],["path",{d:"M6 9H4.5a1 1 0 0 1 0-5H6",key:"tex48p"}]]),su=y("medal",[["path",{d:"M7.21 15 2.66 7.14a2 2 0 0 1 .13-2.2L4.4 2.8A2 2 0 0 1 6 2h12a2 2 0 0 1 1.6.8l1.6 2.14a2 2 0 0 1 .14 2.2L16.79 15",key:"143lza"}],["path",{d:"M11 12 5.12 2.2",key:"qhuxz6"}],["path",{d:"m13 12 5.88-9.8",key:"hbye0f"}],["path",{d:"M8 7h8",key:"i86dvs"}],["circle",{cx:"12",cy:"17",r:"5",key:"qbz8iq"}],["path",{d:"M12 18v-2h-.5",key:"fawc4q"}]]),iu=y("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]),ou=y("award",[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]]),lu=y("tool-case",[["path",{d:"M10 15h4",key:"192ueg"}],["path",{d:"m14.817 10.995-.971-1.45 1.034-1.232a2 2 0 0 0-2.025-3.238l-1.82.364L9.91 3.885a2 2 0 0 0-3.625.748L6.141 6.55l-1.725.426a2 2 0 0 0-.19 3.756l.657.27",key:"xbnumr"}],["path",{d:"m18.822 10.995 2.26-5.38a1 1 0 0 0-.557-1.318L16.954 2.9a1 1 0 0 0-1.281.533l-.924 2.122",key:"eaw7gc"}],["path",{d:"M4 12.006A1 1 0 0 1 4.994 11H19a1 1 0 0 1 1 1v7a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2z",key:"1vaooh"}]]),cu=()=>{const{usuario:t}=Nt();return(0,e.useMemo)(()=>t?{canViewAllSectors:Dt.canViewAllSectors(t.nivel),canManageCurrentSector:Tt(t.nivel),userSetorId:t.setorId,userSetorNome:t.setorNome,userEmpresaId:t.empresaId,userEmpresaNome:t.empresaNome,filterBySector:e=>e&&Array.isArray(e)?Dt.filterBySector(e,t):[],canManageItem:e=>Dt.canManageItem(t.nivel,e,t.setorId),canCreateInSector:e=>Dt.canCreateInSector(t.nivel,e,t.setorId),itemBelongsToUserSector:e=>Dt.itemBelongsToUserSector(e,t.setorId),getPermissionScope:()=>Dt.canViewAllSectors(t.nivel)?"Visualizando todos os setores":"Visualizando apenas: ".concat(t.setorNome||"Setor n\xe3o definido"),usuario:t}:{canViewAllSectors:!1,canManageCurrentSector:!1,userSetorId:null,filterBySector:()=>[],canManageItem:()=>!1,canCreateInSector:()=>!1},[t])},du=["Janeiro","Fevereiro","Mar\xe7o","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],uu=t=>{let{funcionario:r,onClose:a}=t;const{emprestimos:s,tarefas:i,avaliacoes:o}=r,[l,c]=(0,e.useState)({emprestimos:!1,tarefas:!1,avaliacoes:!1}),d=e=>{c(t=>(0,n.A)((0,n.A)({},t),{},{[e]:!t[e]}))},u=e=>new Date(e).toLocaleDateString("pt-BR");return(0,k.jsx)("div",{className:"fixed inset-0 bg-black/50 dark:bg-black/70 z-50 flex items-center justify-center p-4",children:(0,k.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg w-full max-w-3xl shadow-xl max-h-[85vh] flex flex-col",children:[(0,k.jsxs)("div",{className:"bg-gradient-to-r from-[#1D9BF0] to-[#1A8CD8] p-6 rounded-t-lg",children:[(0,k.jsxs)("div",{className:"flex justify-between items-start",children:[(0,k.jsxs)("div",{className:"flex items-center gap-4",children:[r.photoURL?(0,k.jsx)("img",{src:r.photoURL,alt:r.nome,className:"w-16 h-16 rounded-full object-cover border-4 border-white/30 shadow-lg"}):(0,k.jsx)("div",{className:"w-16 h-16 rounded-full flex items-center justify-center bg-white/20 border-4 border-white/30 shadow-lg",children:(0,k.jsx)("span",{className:"text-2xl font-bold text-white",children:r.nome.charAt(0)})}),(0,k.jsxs)("div",{children:[(0,k.jsx)("h3",{className:"text-xl font-bold text-white mb-1",children:r.nome}),(0,k.jsx)("p",{className:"text-blue-100 text-sm",children:"Detalhes de Pontua\xe7\xe3o"})]})]}),(0,k.jsx)("button",{onClick:a,className:"text-white hover:bg-white/20 rounded-lg p-2 transition-colors",children:(0,k.jsx)(Id,{className:"w-5 h-5"})})]}),(0,k.jsxs)("div",{className:"grid grid-cols-3 gap-3 mt-4",children:[(0,k.jsxs)("div",{className:"bg-white/10 backdrop-blur-sm rounded-lg p-3",children:[(0,k.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,k.jsx)(lu,{className:"w-4 h-4 text-white"}),(0,k.jsx)("span",{className:"text-xs text-blue-100",children:"Ferramentas"})]}),(0,k.jsx)("p",{className:"text-2xl font-bold text-white",children:r.pontuacao.detalhes.ferramentas}),(0,k.jsx)("p",{className:"text-xs text-blue-100",children:"pontos"})]}),(0,k.jsxs)("div",{className:"bg-white/10 backdrop-blur-sm rounded-lg p-3",children:[(0,k.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,k.jsx)(Fd,{className:"w-4 h-4 text-white"}),(0,k.jsx)("span",{className:"text-xs text-blue-100",children:"Tarefas"})]}),(0,k.jsx)("p",{className:"text-2xl font-bold text-white",children:r.pontuacao.detalhes.tarefas}),(0,k.jsx)("p",{className:"text-xs text-blue-100",children:"pontos"})]}),(0,k.jsxs)("div",{className:"bg-white/10 backdrop-blur-sm rounded-lg p-3",children:[(0,k.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,k.jsx)(Ld,{className:"w-4 h-4 text-white"}),(0,k.jsx)("span",{className:"text-xs text-blue-100",children:"Avalia\xe7\xf5es"})]}),(0,k.jsx)("p",{className:"text-2xl font-bold text-white",children:r.pontuacao.detalhes.avaliacao}),(0,k.jsx)("p",{className:"text-xs text-blue-100",children:"pontos"})]})]})]}),(0,k.jsx)("div",{className:"overflow-y-auto flex-1 p-4",children:(0,k.jsxs)("div",{className:"space-y-4",children:[(0,k.jsxs)("div",{className:"bg-white dark:bg-gray-700/50 rounded-lg border-2 border-gray-200 dark:border-gray-600",children:[(0,k.jsxs)("div",{className:"flex justify-between items-center p-4 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700/70 transition-colors rounded-t-lg",onClick:()=>d("emprestimos"),children:[(0,k.jsxs)("h4",{className:"font-semibold text-gray-900 dark:text-white flex items-center gap-2",children:[(0,k.jsx)("div",{className:"p-2 bg-blue-100 dark:bg-blue-900/30 rounded-lg",children:(0,k.jsx)(lu,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"})}),(0,k.jsxs)("div",{children:[(0,k.jsx)("div",{children:"Empr\xe9stimos"}),(0,k.jsxs)("div",{className:"text-xs font-normal text-gray-500 dark:text-gray-400",children:[s.reduce((e,t)=>e+t.quantidade,0)," ferramentas devolvidas"]})]}),(0,k.jsx)(Mt,{className:"w-5 h-5 ml-2 transform transition-transform ".concat(l.emprestimos?"":"-rotate-90")})]}),(0,k.jsxs)("div",{className:"text-right",children:[(0,k.jsx)("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Total"}),(0,k.jsxs)("div",{className:"text-xl font-bold text-blue-600 dark:text-blue-400",children:[r.pontuacao.detalhes.ferramentas," pts"]})]})]}),l.emprestimos&&(0,k.jsx)("div",{className:"px-4 pb-4 space-y-2 max-h-[300px] overflow-y-auto",children:0===s.length?(0,k.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400 text-center py-4",children:"Nenhum empr\xe9stimo registrado neste per\xedodo"}):s.map((e,t)=>(0,k.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-800/50 rounded-lg p-3 border border-gray-200 dark:border-gray-600",children:[(0,k.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,k.jsxs)("div",{className:"flex items-center gap-2",children:[(0,k.jsx)("div",{className:"bg-blue-100 dark:bg-blue-900/30 text-blue-600 dark:text-blue-400 px-2 py-1 rounded text-xs font-medium",children:u(e.dataDevolucao)}),(0,k.jsxs)("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:[e.quantidade," ",1===e.quantidade?"ferramenta":"ferramentas"]})]}),(0,k.jsxs)("span",{className:"font-bold text-blue-600 dark:text-blue-400",children:["+",20*e.quantidade," pts"]})]}),e.ferramentas&&e.ferramentas.length>0&&(0,k.jsx)("div",{className:"mt-2 pt-2 border-t border-gray-200 dark:border-gray-600",children:(0,k.jsx)("div",{className:"grid grid-cols-2 gap-1.5",children:e.ferramentas.map((e,t)=>(0,k.jsxs)("div",{className:"flex items-center gap-1.5 text-xs text-gray-600 dark:text-gray-300",children:[(0,k.jsx)("div",{className:"w-1.5 h-1.5 rounded-full bg-blue-500"}),(0,k.jsx)("span",{className:"truncate",children:e.nome||e})]},t))})})]},t))})]}),(0,k.jsxs)("div",{className:"bg-white dark:bg-gray-700/50 rounded-lg border-2 border-gray-200 dark:border-gray-600",children:[(0,k.jsxs)("div",{className:"flex justify-between items-center p-4 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700/70 transition-colors rounded-t-lg",onClick:()=>d("tarefas"),children:[(0,k.jsxs)("h4",{className:"font-semibold text-gray-900 dark:text-white flex items-center gap-2",children:[(0,k.jsx)("div",{className:"p-2 bg-green-100 dark:bg-green-900/30 rounded-lg",children:(0,k.jsx)(Fd,{className:"w-5 h-5 text-green-600 dark:text-green-400"})}),(0,k.jsxs)("div",{children:[(0,k.jsx)("div",{children:"Tarefas Conclu\xeddas"}),(0,k.jsxs)("div",{className:"text-xs font-normal text-gray-500 dark:text-gray-400",children:[i.length," ",1===i.length?"tarefa":"tarefas"]})]}),(0,k.jsx)(Mt,{className:"w-5 h-5 ml-2 transform transition-transform ".concat(l.tarefas?"":"-rotate-90")})]}),(0,k.jsxs)("div",{className:"text-right",children:[(0,k.jsx)("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Total"}),(0,k.jsxs)("div",{className:"text-xl font-bold text-green-600 dark:text-green-400",children:[r.pontuacao.detalhes.tarefas," pts"]})]})]}),l.tarefas&&(0,k.jsx)("div",{className:"px-4 pb-4 space-y-2 max-h-[300px] overflow-y-auto",children:0===i.length?(0,k.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400 text-center py-4",children:"Nenhuma tarefa conclu\xedda neste per\xedodo"}):i.map((e,t)=>{var r,a,n;const s={baixa:20,media:30,"m\xe9dia":30,normal:30,alta:50,urgente:70}[null===(r=e.prioridade)||void 0===r?void 0:r.toLowerCase().trim()]||30,i=parseFloat(e.tempoEstimado)||1,o=isNaN(i)?0:Math.min(5*Math.floor(i),50),l=s+o;return(0,k.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-800/50 rounded-lg p-3 border border-gray-200 dark:border-gray-600",children:[(0,k.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,k.jsxs)("div",{children:[(0,k.jsx)("div",{className:"font-medium text-gray-900 dark:text-white mb-1",children:e.titulo||"Tarefa sem t\xedtulo"}),(0,k.jsxs)("div",{className:"flex items-center gap-2 text-xs",children:[(0,k.jsx)("span",{className:"bg-green-100 dark:bg-green-900/30 text-green-600 dark:text-green-400 px-2 py-1 rounded font-medium",children:u(e.dataConclusao)}),(0,k.jsx)("span",{className:"px-2 py-1 rounded font-medium ".concat("urgente"===(null===(a=e.prioridade)||void 0===a?void 0:a.toLowerCase())?"bg-red-100 dark:bg-red-900/30 text-red-600 dark:text-red-400":"alta"===(null===(n=e.prioridade)||void 0===n?void 0:n.toLowerCase())?"bg-orange-100 dark:bg-orange-900/30 text-orange-600 dark:text-orange-400":"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400"),children:e.prioridade||"M\xe9dia"}),(0,k.jsxs)("span",{className:"text-gray-500 dark:text-gray-400",children:[e.tempoEstimado||"1","h"]})]})]}),(0,k.jsxs)("div",{className:"text-right",children:[(0,k.jsxs)("div",{className:"font-bold text-green-600 dark:text-green-400 text-lg",children:["+",l," pts"]}),(0,k.jsxs)("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:[s," + ",o]})]})]}),e.descricao&&(0,k.jsx)("div",{className:"text-xs text-gray-600 dark:text-gray-300 mt-2 pt-2 border-t border-gray-200 dark:border-gray-600",children:e.descricao})]},t)})})]}),(0,k.jsxs)("div",{className:"bg-white dark:bg-gray-700/50 rounded-lg border-2 border-gray-200 dark:border-gray-600",children:[(0,k.jsxs)("div",{className:"flex justify-between items-center p-4 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700/70 transition-colors rounded-t-lg",onClick:()=>d("avaliacoes"),children:[(0,k.jsxs)("h4",{className:"font-semibold text-gray-900 dark:text-white flex items-center gap-2",children:[(0,k.jsx)("div",{className:"p-2 bg-yellow-100 dark:bg-yellow-900/30 rounded-lg",children:(0,k.jsx)(Ld,{className:"w-5 h-5 text-yellow-600 dark:text-yellow-400"})}),(0,k.jsxs)("div",{children:[(0,k.jsx)("div",{children:"Avalia\xe7\xf5es"}),(0,k.jsxs)("div",{className:"text-xs font-normal text-gray-500 dark:text-gray-400",children:[o.length," ",1===o.length?"avalia\xe7\xe3o":"avalia\xe7\xf5es"]})]}),(0,k.jsx)(Mt,{className:"w-5 h-5 ml-2 transform transition-transform ".concat(l.avaliacoes?"":"-rotate-90")})]}),(0,k.jsxs)("div",{className:"text-right",children:[(0,k.jsx)("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Total"}),(0,k.jsxs)("div",{className:"text-xl font-bold text-yellow-600 dark:text-yellow-400",children:[r.pontuacao.detalhes.avaliacao," pts"]})]})]}),l.avaliacoes&&(0,k.jsx)("div",{className:"px-4 pb-4 space-y-2 max-h-[300px] overflow-y-auto",children:0===o.length?(0,k.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400 text-center py-4",children:"Nenhuma avalia\xe7\xe3o registrada neste per\xedodo"}):o.map((e,t)=>(0,k.jsx)("div",{className:"bg-gray-50 dark:bg-gray-800/50 rounded-lg p-3 border border-gray-200 dark:border-gray-600",children:(0,k.jsxs)("div",{className:"flex justify-between items-center",children:[(0,k.jsxs)("div",{className:"flex items-center gap-3",children:[(0,k.jsx)("div",{className:"bg-yellow-100 dark:bg-yellow-900/30 text-yellow-600 dark:text-yellow-400 px-2 py-1 rounded text-xs font-medium",children:u(e.data)}),(0,k.jsxs)("div",{className:"flex items-center gap-1",children:[[...Array(5)].map((t,r)=>(0,k.jsx)(Ld,{className:"w-4 h-4 ".concat(r<e.estrelas?"text-yellow-400 fill-yellow-400":"text-gray-300 dark:text-gray-600")},r)),(0,k.jsxs)("span",{className:"ml-1 text-sm font-medium text-gray-700 dark:text-gray-300",children:[e.estrelas,"/5"]})]})]}),(0,k.jsxs)("div",{className:"font-bold text-yellow-600 dark:text-yellow-400 text-lg",children:["+",{5:50,4:40,3:30,2:20,1:10}[e.estrelas]||0," pts"]})]})},t))})]})]})}),(0,k.jsx)("div",{className:"p-6 border-t-2 border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-800/50",children:(0,k.jsxs)("div",{className:"flex justify-between items-center",children:[(0,k.jsxs)("div",{children:[(0,k.jsx)("div",{className:"text-sm text-gray-500 dark:text-gray-400 mb-1",children:"Pontua\xe7\xe3o Total do Per\xedodo"}),(0,k.jsx)("div",{className:"text-3xl font-bold text-[#1D9BF0]",children:r.pontuacao.total}),(0,k.jsx)("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"pontos acumulados"})]}),(0,k.jsxs)("div",{className:"text-right space-y-1",children:[(0,k.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,k.jsx)("span",{className:"text-gray-500 dark:text-gray-400",children:"Ferramentas:"}),(0,k.jsxs)("span",{className:"font-semibold text-blue-600 dark:text-blue-400",children:[r.pontuacao.detalhes.ferramentas," pts"]})]}),(0,k.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,k.jsx)("span",{className:"text-gray-500 dark:text-gray-400",children:"Tarefas:"}),(0,k.jsxs)("span",{className:"font-semibold text-green-600 dark:text-green-400",children:[r.pontuacao.detalhes.tarefas," pts"]})]}),(0,k.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,k.jsx)("span",{className:"text-gray-500 dark:text-gray-400",children:"Avalia\xe7\xf5es:"}),(0,k.jsxs)("span",{className:"font-semibold text-yellow-600 dark:text-yellow-400",children:[r.pontuacao.detalhes.avaliacao," pts"]})]})]})]})})]})})},hu=()=>{const{usuario:t}=Nt(),{funcionarios:r}=or(),[a,i]=(0,e.useState)([]),[o,l]=(0,e.useState)(!0),[c,d]=(0,e.useState)("semana"),[u,h]=(0,e.useState)((new Date).getMonth()),[m,f]=(0,e.useState)((new Date).getFullYear()),[g,p]=(0,e.useState)(!1),[x,y]=(0,e.useState)(!1),[v,b]=(0,e.useState)(!1),[w,N]=(0,e.useState)(!1),{canViewAllSectors:j}=cu(),S=j,_=((e,t)=>{const r=new Date(e,t,1),a=new Date(e,t+1,0),n=[];let s=new Date(r);for(s.setDate(s.getDate()-s.getDay()+(0===s.getDay()?-6:1));s<=a;){const e=new Date(s);e.setDate(e.getDate()+6);const i=new Date(Math.min(e,a));if(i>=r){const e=new Date(Math.max(s,r));n.push({inicio:e,fim:i,label:"".concat(e.getDate(),"/").concat(t+1," - ").concat(i.getDate(),"/").concat(t+1)})}s=new Date(e),s.setDate(s.getDate()+1)}return n})(m,u),E=e=>{const t=new Date(e.getFullYear(),e.getMonth(),1),r=new Date(t);r.setDate(t.getDate()-t.getDay()+(0===t.getDay()?-6:1));const a=e-r,n=Math.floor(a/6048e5);return Math.max(0,Math.min(n,_.length-1))},[A,C]=(0,e.useState)(E(new Date)),[T,D]=(0,e.useState)(null),[F,L]=(0,e.useState)(!1);(0,e.useEffect)(()=>{const e=e=>{e.target.closest(".selector-container")||(p(!1),y(!1),b(!1))};return document.addEventListener("click",e),()=>document.removeEventListener("click",e)},[]),(0,e.useEffect)(()=>{const e=new Date;e.getMonth()===u&&e.getFullYear()===m?C(E(e)):C(0)},[u,m]);const M=e=>{if(e.length>0&&("mes"===c||"ano"===c||"semana"===c)){let t,r;"semana"===c&&_&&_[A]?(t=_[A].inicio,r=_[A].fim):"mes"===c?(t=new Date(m,u,1),r=new Date(m,u+1,0)):"ano"===c&&(t=new Date(m,0,1),r=new Date(m,11,31,23,59,59)),t&&r&&console.log("\ud83d\udcc5 PER\xcdODO SELECIONADO:",{tipo:c,dataInicio:t.toLocaleString("pt-BR"),dataFim:r.toLocaleString("pt-BR"),hoje:(new Date).toLocaleString("pt-BR"),totalFuncionarios:e.length})}return e.map(e=>{let t=(0,n.A)({},e.pontuacao);if("mes"===c||"ano"===c||"semana"===c){let r,a;"semana"===c?_&&_[A]?(r=_[A].inicio,a=_[A].fim):(r=new Date(m,u,1),a=new Date(m,u+1,0)):"mes"===c?(r=new Date(m,u,1),a=new Date(m,u+1,0)):(r=new Date(m,0,1),a=new Date(m,11,31,23,59,59));const s=e.emprestimos.filter(e=>{const t=new Date(e.dataDevolucao);return t>=r&&t<=a});t=(0,n.A)((0,n.A)({},t),{},{total:0,detalhes:{ferramentas:s.reduce((e,t)=>{var r;const a=new Date(t.dataRetirada),n=new Date(t.dataDevolucao),s=O(a),i=O(n);let o=0;return s.bonus&&(o+=10,t.bonusRetirada=!0),i.bonus&&(o+=10,t.bonusDevolucao=!0),e+(20+o)*((null===(r=t.ferramentas)||void 0===r?void 0:r.length)||1)},0),tarefas:(e.tarefas||[]).filter(e=>{const t=new Date(e.dataConclusao);return!isNaN(t)&&t>=r&&t<=a}).reduce((e,t)=>{var r,a;if("concluida"!==t.status)return e;let n={baixa:20,media:30,"m\xe9dia":30,normal:30,alta:50,urgente:70}[(null===(r=t.prioridade)||void 0===r||null===(a=r.toLowerCase())||void 0===a?void 0:a.trim())||"normal"]||30;const s=parseFloat(t.tempoEstimado)||1;if(!isNaN(s)&&s>0){n+=Math.min(5*Math.floor(s),50)}return e+n},0),avaliacao:e.avaliacoes.filter(e=>{const t=new Date(e.data);if(isNaN(t.getTime()))return!1;return t>=r&&t<=a}).reduce((e,t)=>e+({5:50,4:40,3:30,2:20,1:10}[t.estrelas]||0),0)}}),t.total=t.detalhes.ferramentas+t.detalhes.tarefas+t.detalhes.avaliacao}else t=(0,n.A)((0,n.A)({},e.pontuacao),{},{detalhes:(0,n.A)((0,n.A)({},e.pontuacao.detalhes),{},{avaliacao:e.pontuacao.detalhes.avaliacao||0})});return(0,n.A)((0,n.A)({},e),{},{pontuacao:t})})};(0,e.useEffect)(()=>{r&&r.length>0&&(console.log("\ud83d\udd04 Carregando dados do ranking com contexto atualizado...",r.length,"funcion\xe1rios"),z())},[r]);const R=e=>!0===e.terceirizado||!0===e.tercerizado||"terceirizado"===e.tipo||"tercerizado"===e.tipo||"string"===typeof e.terceirizado&&"sim"===e.terceirizado.toLowerCase()||"string"===typeof e.tercerizado&&"sim"===e.tercerizado.toLowerCase()||e.nome&&e.nome.toLowerCase().includes("terceirizado")||e.nome&&e.nome.toLowerCase().includes("tercerizado"),O=e=>{if(!e)return{bonus:!1,tipo:null};const t=60*e.getHours()+e.getMinutes();return t>=440&&t<=455?{bonus:!0,tipo:"retirada"}:t>=960&&t<=965?{bonus:!0,tipo:"devolucao"}:{bonus:!1,tipo:null}},B=e=>{var t,r,a;const n={total:0,detalhes:{ferramentas:0,tarefas:0,avaliacao:0}};return n.detalhes.ferramentas=(null===(t=e.emprestimos)||void 0===t?void 0:t.reduce((e,t)=>{var r;const a=(null===(r=t.ferramentas)||void 0===r?void 0:r.length)||1,n=t.dataRetirada?new Date(t.dataRetirada):null,s=t.dataDevolucao?new Date(t.dataDevolucao):null;let i=0;if(n){O(n).bonus&&(i+=10)}if(s){O(s).bonus&&(i+=10)}return e+(20+i)*a},0))||0,n.detalhes.tarefas=(null===(r=e.tarefas)||void 0===r?void 0:r.reduce((e,t)=>{var r;if("concluida"!==t.status)return e;let a={baixa:20,media:30,"m\xe9dia":30,normal:30,alta:50,urgente:70}[null===(r=t.prioridade)||void 0===r?void 0:r.toLowerCase().trim()]||30;const n=parseFloat(t.tempoEstimado)||1;return isNaN(n)||(a+=Math.min(5*Math.floor(n),50)),e+a},0))||0,n.detalhes.avaliacao=(null===(a=e.avaliacoes)||void 0===a?void 0:a.reduce((e,t)=>{const r=Number(t.estrelas)||0;return e+(!isNaN(r)&&r>0?10*r:0)},0))||0,n.total=n.detalhes.ferramentas+n.detalhes.tarefas+n.detalhes.avaliacao,n},z=async()=>{try{console.log("\ud83d\udd04 RankingPontos: Iniciando carregamento de dados...");const e=(0,s.collection)(P.db,"emprestimos"),t=(0,s.collection)(P.db,"tarefas"),a=(0,s.collection)(P.db,"avaliacoes"),o=(0,s.collection)(P.db,"usuario"),[c,d,u,h]=await Promise.all([(0,s.GG)(e),(0,s.GG)(t),(0,s.GG)(a),(0,s.GG)(o)]);console.log("\ud83d\udce6 RankingPontos: Dados carregados:",{funcionariosContext:(null===r||void 0===r?void 0:r.length)||0,usuarios:h.size,emprestimos:c.size,tarefas:d.size,avaliacoes:u.size});const m={},f={},g=new Set;console.log("\ud83d\udcca Contexto de funcion\xe1rios dispon\xedvel:",(null===r||void 0===r?void 0:r.length)||0);let p=0,x=0,y=0;r.forEach(e=>{var t;const r=R(e),a=null===(t=e.email)||void 0===t?void 0:t.toLowerCase();if(!0===e.demitido)return void console.log("\u274c Funcion\xe1rio demitido n\xe3o inclu\xeddo no ranking: ".concat(e.nome));if(r)return void x++;if(a&&g.has(a))return void y++;const n=e.nome||e.username||e.email;p++,m[e.id]={id:e.id,nome:n,email:e.email,photoURL:e.photoURL||null,cargo:e.cargo||null,setor:e.setor||null,terceirizado:!1,tercerizado:!1,ferramentasDevolvidas:0,tarefasConcluidas:0,avaliacao:0,avaliacoes:[]},n&&(f[n.toLowerCase()]=e.id),a&&g.add(a)});const v=Object.values(m).filter(e=>e.photoURL).length,b=(r.map(e=>{var t;return null===(t=e.nome)||void 0===t?void 0:t.toLowerCase()}).filter(Boolean),r.map(e=>{var t;return null===(t=e.email)||void 0===t?void 0:t.toLowerCase()}).filter(Boolean),[]),w=new Set,k=new Set;r.forEach(e=>{var t,r;const a=null===(t=e.nome)||void 0===t?void 0:t.toLowerCase(),n=null===(r=e.email)||void 0===r?void 0:r.toLowerCase();a&&w.has(a)&&b.push("Nome duplicado no CONTEXTO: ".concat(e.nome," (ID: ").concat(e.id,")")),n&&k.has(n)&&b.push("Email duplicado no CONTEXTO: ".concat(e.email," (ID: ").concat(e.id,")")),a&&w.add(a),n&&k.add(n)}),b.length>0&&console.error("\u274c DUPLICATAS NO funcionariosContext:",b),console.log("\u2705 Funcion\xe1rios do contexto processados:",{totalNoContexto:r.length,totalProcessados:p,puladosTerceirizados:x,puladosDuplicados:y,totalNoRanking:Object.keys(m).length,comFoto:v,semFoto:p-v,duplicatasNoContexto:b.length});let N=0,j=0,S=0;h.forEach(e=>{var t;const r=(0,n.A)({id:e.id},e.data()),a=R(r),s=null===(t=r.email)||void 0===t?void 0:t.toLowerCase(),i=r.nome||r.username||r.email,o=null===i||void 0===i?void 0:i.toLowerCase();if(a||!0===r.demitido)!0===r.demitido&&console.log("\u274c Usu\xe1rio demitido n\xe3o inclu\xeddo no ranking: ".concat(i));else if(m[r.id])r.photoURL&&!m[r.id].photoURL&&(m[r.id].photoURL=r.photoURL,j++,console.log("\ud83d\udcf8 Foto atualizada para: ".concat(m[r.id].nome)));else if(s&&g.has(s)){if(S++,console.log("\u26a0\ufe0f Usu\xe1rio pulado (email duplicado): ".concat(i," (").concat(s,") - ID: ").concat(r.id)),r.photoURL){var l;const e=null===(l=Object.values(m).find(e=>{var t;return(null===(t=e.email)||void 0===t?void 0:t.toLowerCase())===s}))||void 0===l?void 0:l.id;e&&!m[e].photoURL&&(m[e].photoURL=r.photoURL,j++,console.log("\ud83d\udcf8 Foto atualizada via email duplicado para: ".concat(m[e].nome)))}}else if(o&&f[o]){if(S++,console.log("\u26a0\ufe0f Usu\xe1rio pulado (nome duplicado): ".concat(i," - ID: ").concat(r.id," vs ").concat(f[o])),r.photoURL){const e=f[o];e&&!m[e].photoURL&&(m[e].photoURL=r.photoURL,j++,console.log("\ud83d\udcf8 Foto atualizada via nome duplicado para: ".concat(m[e].nome)))}}else N++,m[r.id]={id:r.id,nome:i,email:r.email,photoURL:r.photoURL||null,cargo:r.cargo||null,setor:r.setor||null,terceirizado:!1,tercerizado:!1,ferramentasDevolvidas:0,tarefasConcluidas:0,avaliacao:0,avaliacoes:[]},i&&(f[i.toLowerCase()]=r.id),s&&g.add(s)}),console.log("\u2705 Total final ap\xf3s processar usu\xe1rios:",{usuariosAdicionados:N,usuariosPuladosDuplicados:S,fotosAtualizadas:j,totalNoRanking:Object.keys(m).length,comFoto:Object.values(m).filter(e=>e.photoURL).length,semFoto:Object.values(m).filter(e=>!e.photoURL).length,primeiros5:Object.values(m).slice(0,5).map(e=>({nome:e.nome,temFoto:!!e.photoURL}))}),c.forEach(e=>{const t=e.data();var r;"devolvido"===t.status&&t.funcionarioId&&m[t.funcionarioId]&&(m[t.funcionarioId].ferramentasDevolvidas+=(null===(r=t.ferramentas)||void 0===r?void 0:r.length)||0)}),d.forEach(e=>{const t=e.data();if("concluida"===t.status||"Conclu\xedda"===t.status){let e=!1;t.funcionariosIds&&Array.isArray(t.funcionariosIds)&&t.funcionariosIds.forEach(t=>{if(m[t])m[t].tarefasConcluidas++,e=!0;else{const r=f[t.toLowerCase()];r&&m[r]&&(m[r].tarefasConcluidas++,e=!0)}}),!e&&t.responsavelId&&m[t.responsavelId]&&m[t.responsavelId].tarefasConcluidas++}}),u.forEach(e=>{const t=e.data();if(t.estrelas){let e=null;if(t.funcionarioId&&m[t.funcionarioId]&&(e=m[t.funcionarioId]),!e&&t.funcionarioNome){const r=f[t.funcionarioNome.toLowerCase()];r&&m[r]&&(e=m[r])}e&&e.avaliacoes.push(t.estrelas)}}),console.log("RankingPontos: Avalia\xe7\xf5es processadas"),Object.values(m).forEach(e=>{e.avaliacoes.length>0&&(e.avaliacao=e.avaliacoes.reduce((e,t)=>e+t,0)/e.avaliacoes.length)});const _=new Set,E=new Set,A=[];Object.values(m).forEach(e=>{var t,r;const a=null===(t=e.nome)||void 0===t?void 0:t.toLowerCase(),n=null===(r=e.email)||void 0===r?void 0:r.toLowerCase();a&&_.has(a)&&A.push("\u26a0\ufe0f dadosFuncionarios tem nome duplicado: ".concat(e.nome," (ID: ").concat(e.id,")")),n&&E.has(n)&&A.push("\u26a0\ufe0f dadosFuncionarios tem email duplicado: ".concat(e.email," (ID: ").concat(e.id,")")),a&&_.add(a),n&&E.add(n)}),A.length>0&&console.error("\u274c DUPLICATAS EM dadosFuncionarios (ANTES de criar rankingList):",A),console.log("\ud83d\udce6 Funcion\xe1rios prontos para ranking:",{total:Object.keys(m).length,nomesUnicos:_.size,emailsUnicos:E.size,comFoto:Object.values(m).filter(e=>e.photoURL).length,duplicatasDetectadas:A.length});const C=Object.values(m).map(e=>{const t=[],r=[],a=[];return c.forEach(r=>{const a=r.data();var n;"devolvido"===a.status&&a.funcionarioId===e.id&&t.push({dataDevolucao:a.dataDevolucao,quantidade:(null===(n=a.ferramentas)||void 0===n?void 0:n.length)||0,ferramentas:a.ferramentas||[]})}),d.forEach(t=>{const a=t.data(),n=(a.status||"").toLowerCase();if("concluida"===n||"conclu\xedda"===n){let s=!1;if(a.funcionariosIds&&Array.isArray(a.funcionariosIds)&&(s=a.funcionariosIds.some(t=>t===e.id||t.toLowerCase()===e.nome.toLowerCase())),s||(s=a.responsavelId===e.id||a.funcionarioId===e.id||a.responsavel&&a.responsavel.toLowerCase()===e.nome.toLowerCase()),s){const e=a.dataConclusao||a.dataAtualizacao||a.dataFinalizacao||t.updateTime||t.createTime;r.push({dataConclusao:"string"===typeof e?new Date(e):e,dataRetirada:"string"===typeof e?new Date(e):e,prioridade:(a.prioridade||"normal").toLowerCase().trim(),tempoEstimado:parseFloat(a.tempoEstimado)||1,titulo:a.titulo||"Sem t\xedtulo",descricao:a.descricao||"",status:n})}}}),u.forEach(t=>{const r=t.data();let n=!1;if(n=r.funcionarioId===e.id||r.idFuncionario===e.id||r.funcionario&&r.funcionario.id===e.id,n||(r.funcionarioNome&&r.funcionarioNome.toLowerCase()===e.nome.toLowerCase()||r.funcionario===e.nome||"object"===typeof r.funcionario&&r.funcionario.nome===e.nome)&&(n=!0),n&&r.estrelas){let e=r.data||r.dataAvaliacao||r.timestamp;var s;if(!e)e=null!==(s=t.metadata)&&void 0!==s&&s.fromCache?new Date:t.createTime||new Date;"string"===typeof e&&(e=new Date(e));const n={data:e,estrelas:Number(r.estrelas)};a.push(n)}}),(0,n.A)((0,n.A)({},e),{},{emprestimos:t,tarefas:r,avaliacoes:a,pontuacao:B({emprestimos:t,tarefas:r,avaliacoes:a})})}),I=new Map;C.forEach(e=>{var t;const r=null===(t=e.nome)||void 0===t?void 0:t.toLowerCase().trim();if(r)if(I.has(r)){const t=I.get(r);t.emprestimos=[...t.emprestimos,...e.emprestimos],t.tarefas=[...t.tarefas,...e.tarefas],t.avaliacoes=[...t.avaliacoes,...e.avaliacoes],!t.photoURL&&e.photoURL&&(t.photoURL=e.photoURL),t.pontuacao=B({emprestimos:t.emprestimos,tarefas:t.tarefas,avaliacoes:t.avaliacoes}),console.log("\ud83d\udd17 Dados unidos para: ".concat(e.nome),{totalEmprestimos:t.emprestimos.length,totalTarefas:t.tarefas.length,totalAvaliacoes:t.avaliacoes.length,pontuacaoTotal:t.pontuacao.total})}else I.set(r,(0,n.A)({},e))});const T=Array.from(I.values());console.log("\u2705 Ranking processado com sucesso:",{totalOriginal:C.length,totalUnificado:T.length,funcionariosUnidos:C.length-T.length,funcionariosComFoto:T.filter(e=>e.photoURL).length,primeiros3:T.sort((e,t)=>t.pontuacao.total-e.pontuacao.total).slice(0,3).map(e=>({id:e.id,nome:e.nome,email:e.email,pontos:e.pontuacao.total,foto:!!e.photoURL}))}),i(T),l(!1)}catch(e){console.error("\u274c Erro ao carregar dados:",e),l(!1)}},U=e=>{switch(e){case 0:return(0,k.jsx)("div",{className:"m-3 flex items-center justify-center w-14 h-14 rounded-full bg-yellow-400 shadow-lg border-3 border-yellow-300",children:(0,k.jsx)(nu,{className:"w-7 h-7 text-white fill-white"})});case 1:return(0,k.jsx)("div",{className:"m-3 flex items-center justify-center w-14 h-14 rounded-full bg-gray-400 dark:bg-gray-500 shadow-lg border-3 border-gray-300 dark:border-gray-400",children:(0,k.jsx)(su,{className:"w-7 h-7 text-white"})});case 2:return(0,k.jsx)("div",{className:"m-3 flex items-center justify-center w-14 h-14 rounded-full bg-orange-500 shadow-lg border-3 border-orange-400",children:(0,k.jsx)(su,{className:"w-7 h-7 text-white"})});default:return(0,k.jsx)("div",{className:"m-3 flex items-center justify-center w-14 h-14 rounded-full bg-gray-200 dark:bg-gray-700 shadow-md border-2 border-gray-300 dark:border-gray-600",children:(0,k.jsx)("span",{className:"text-xl font-bold text-gray-700 dark:text-gray-300",children:e+1})})}},V=(0,e.useMemo)(()=>S?a:Dt.filterBySector(a,t),[a,t,S]);return o?(0,k.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,k.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})}):(0,k.jsxs)("div",{className:"space-y-4",children:[!S&&(null===t||void 0===t?void 0:t.setor)&&(0,k.jsxs)("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-3 flex items-center gap-2",children:[(0,k.jsx)(I,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"}),(0,k.jsxs)("p",{className:"text-sm text-blue-800 dark:text-blue-300",children:[(0,k.jsx)("strong",{children:"Visualiza\xe7\xe3o por setor:"})," Voc\xea est\xe1 vendo apenas o ranking do setor ",(0,k.jsx)("strong",{children:t.setor}),"."]})]}),(0,k.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 border-2 border-gray-200 dark:border-gray-700",children:[F&&T&&(0,k.jsx)(uu,{funcionario:T,onClose:()=>{L(!1),D(null)}}),(0,k.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-6",children:[(0,k.jsxs)("div",{className:"flex flex-col gap-2 w-full md:w-auto",children:[(0,k.jsxs)("div",{className:"flex items-center gap-3",children:[(0,k.jsx)("div",{className:"p-2 bg-[#1D9BF0] rounded-lg",children:(0,k.jsx)(nu,{className:"w-7 h-7 text-white"})}),(0,k.jsx)("h2",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Ranking de Pontos"})]}),(0,k.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,k.jsxs)("div",{className:"relative selector-container",children:[(0,k.jsxs)("button",{onClick:()=>{d("semana"),b(!v),p(!1),y(!1)},className:"px-3 py-1.5 rounded-lg text-sm font-medium transition-colors flex items-center gap-2 ".concat("semana"===c?"bg-blue-500 dark:bg-[#1D9BF0] text-white":"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"),children:[(0,k.jsx)(iu,{className:"w-4 h-4"}),"Semana ",A+1,(0,k.jsx)(Mt,{className:"w-4 h-4"})]}),v&&(0,k.jsx)("div",{className:"absolute z-20 mt-2 w-48 bg-white dark:bg-gray-800 dark:bg-gray-800 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700 py-2",children:_.map((e,t)=>(0,k.jsxs)("button",{onClick:()=>{C(t),b(!1)},className:"w-full px-4 py-2 text-sm hover:bg-gray-100 dark:hover:bg-gray-700 text-left flex items-center justify-between ".concat(A===t?"text-blue-500 dark:text-[#1D9BF0] font-medium":"text-gray-700 dark:text-gray-300"),children:[(0,k.jsxs)("span",{children:["Semana ",t+1]}),(0,k.jsx)("span",{className:"text-xs text-gray-500",children:e.label})]},t))})]}),(0,k.jsxs)("div",{className:"relative selector-container",children:[(0,k.jsxs)("button",{onClick:()=>{d("mes"),p(!g),b(!1),y(!1)},className:"px-3 py-1.5 rounded-lg text-sm font-medium transition-colors flex items-center gap-2 ".concat("mes"===c?"bg-blue-500 dark:bg-[#1D9BF0] text-white":"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"),children:[(0,k.jsx)(iu,{className:"w-4 h-4"}),du[u],(0,k.jsx)(Mt,{className:"w-4 h-4"})]}),g&&(0,k.jsx)("div",{className:"absolute z-10 mt-2 w-48 bg-white dark:bg-gray-800 dark:bg-gray-800 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700 py-2 grid grid-cols-2 gap-1",children:du.map((e,t)=>(0,k.jsx)("button",{onClick:()=>{h(t),p(!1)},className:"px-4 py-2 text-sm hover:bg-gray-100 dark:hover:bg-gray-700 text-left ".concat(u===t?"text-blue-500 dark:text-[#1D9BF0] font-medium":"text-gray-700 dark:text-gray-300"),children:e},e))})]}),(0,k.jsxs)("div",{className:"relative selector-container",children:[(0,k.jsxs)("button",{onClick:()=>{d("ano"),y(!x),p(!1),b(!1)},className:"px-3 py-1.5 rounded-lg text-sm font-medium transition-colors flex items-center gap-2 ".concat("ano"===c?"bg-blue-500 dark:bg-[#1D9BF0] text-white":"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"),children:[(0,k.jsx)(iu,{className:"w-4 h-4"}),m,(0,k.jsx)(Mt,{className:"w-4 h-4"})]}),x&&(0,k.jsx)("div",{className:"absolute z-10 mt-2 w-32 bg-white dark:bg-gray-800 dark:bg-gray-800 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700 py-2",children:[...Array(5)].map((e,t)=>{const r=(new Date).getFullYear()-t;return(0,k.jsx)("button",{onClick:()=>{f(r),y(!1)},className:"w-full px-4 py-2 text-sm hover:bg-gray-100 dark:hover:bg-gray-700 text-left ".concat(m===r?"text-blue-500 dark:text-[#1D9BF0] font-medium":"text-gray-700 dark:text-gray-300"),children:r},r)})})]})]})]}),(0,k.jsxs)("div",{className:"bg-[#1D9BF0] dark:bg-[#1A8CD8] text-white rounded-lg shadow-lg w-full md:w-auto overflow-hidden border-2 border-[#1A8CD8] dark:border-[#1779BE]",children:[(0,k.jsxs)("div",{className:"p-4 flex flex-col gap-2",children:[(0,k.jsxs)("div",{className:"flex items-center justify-between",children:[(0,k.jsxs)("div",{className:"flex items-center gap-2",children:[(0,k.jsx)(ou,{className:"w-6 h-6 text-white",strokeWidth:2}),(0,k.jsx)("h3",{className:"text-lg font-bold text-white",children:"Total de Pontos"})]}),(0,k.jsxs)("div",{className:"bg-white/20 rounded-lg px-3 py-1 text-sm font-semibold backdrop-blur-sm",children:[M(V).filter(e=>!R(e)&&e.pontuacao.total>0).length," funcion\xe1rios"]})]}),(0,k.jsx)("div",{className:"flex items-end gap-3 mt-1",children:(0,k.jsxs)("div",{className:"flex-1",children:[(0,k.jsxs)("div",{className:"flex items-baseline gap-2",children:[(0,k.jsx)("span",{className:"text-4xl font-bold text-white",children:M(V).filter(e=>!R(e)&&e.pontuacao.total>0).reduce((e,t)=>e+t.pontuacao.total,0)}),(0,k.jsx)("span",{className:"text-white/90 font-medium",children:"pontos"}),(0,k.jsxs)("div",{className:"relative",children:[(0,k.jsx)(Rt,{className:"w-5 h-5 text-white/80 hover:text-white cursor-pointer ml-2",onClick:()=>N(e=>!e)}),w&&(0,k.jsx)("div",{className:"fixed inset-0 z-40",onClick:()=>N(!1),children:(0,k.jsxs)("div",{className:"absolute top-full left-0 mt-2 w-64 bg-gray-800 text-gray-900 dark:text-white text-xs rounded-lg p-3 shadow-lg z-50",style:{pointerEvents:"auto"},onClick:e=>e.stopPropagation(),children:[(0,k.jsxs)("div",{className:"text-left",children:[(0,k.jsx)("p",{className:"mb-2",children:"Os pontos s\xe3o calculados da seguinte forma:"}),(0,k.jsxs)("ul",{className:"space-y-1",children:[(0,k.jsxs)("li",{className:"flex items-center gap-1",children:[(0,k.jsx)(lu,{className:"w-3 h-3 text-blue-400"}),"20 pontos por ferramenta devolvida"]}),(0,k.jsx)("li",{className:"ml-4 text-xs text-gray-300",children:"B\xf4nus de hor\xe1rio:"}),(0,k.jsx)("li",{className:"ml-4 text-xs text-gray-300",children:"\u2022 +50% se retirada entre 7:20-7:35"}),(0,k.jsx)("li",{className:"ml-4 text-xs text-gray-300",children:"\u2022 +50% se devolvida entre 16:00-16:05"}),(0,k.jsxs)("li",{className:"flex items-center gap-1",children:[(0,k.jsx)(Fd,{className:"w-3 h-3 text-green-400"}),"Tarefas: 20-70 pts + tempo estimado"]}),(0,k.jsx)("li",{className:"ml-4 text-xs text-gray-300",children:"\u2022 Baixa: 20 pts \u2022 M\xe9dia: 30 pts \u2022 Alta: 50 pts \u2022 Urgente: 70 pts"}),(0,k.jsx)("li",{className:"ml-4 text-xs text-gray-300",children:"+ 5 pts por hora estimada (m\xe1x. 50 pts extras)"}),(0,k.jsxs)("li",{className:"flex items-center gap-1",children:[(0,k.jsx)(Ld,{className:"w-3 h-3 text-yellow-400"}),"Avalia\xe7\xf5es por estrelas:"]}),(0,k.jsx)("li",{className:"ml-4 text-xs text-gray-300",children:"\u2022 Cada estrela vale 10 pontos"}),(0,k.jsx)("li",{className:"ml-4 text-xs text-gray-300",children:"\u2022 Ex: 5 estrelas = 50 pts"}),(0,k.jsx)("li",{className:"ml-4 text-xs text-gray-300",children:"\u2022 Ex: 3 estrelas = 30 pts"}),(0,k.jsx)("li",{className:"ml-4 text-xs text-gray-300",children:"\u2022 2 estrelas: 20 pts"}),(0,k.jsx)("li",{className:"ml-4 text-xs text-gray-300",children:"\u2022 1 estrela: 10 pts"})]})]}),(0,k.jsx)("div",{className:"absolute left-1/2 -translate-x-1/2 -top-1 w-2 h-2 bg-gray-800 rotate-45"})]})})]})]}),(0,k.jsxs)("div",{className:"flex gap-4 mt-3 text-sm font-medium",children:[(0,k.jsxs)("div",{className:"flex items-center gap-1.5 relative group bg-white/10 rounded-lg px-2 py-1 backdrop-blur-sm",children:[(0,k.jsx)(lu,{className:"w-4 h-4 text-white"}),(0,k.jsxs)("span",{className:"text-white",children:[M(V).filter(e=>!R(e)).reduce((e,t)=>e+t.pontuacao.detalhes.ferramentas,0)," pts"]}),M(V).some(e=>e.emprestimos.some(e=>e.bonusRetirada||e.bonusDevolucao))&&(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(Ld,{className:"w-3 h-3 text-yellow-300 fill-yellow-300"}),(0,k.jsx)("div",{className:"absolute bottom-full left-0 mb-1 hidden group-hover:block bg-gray-800 text-xs text-white p-2 rounded whitespace-nowrap shadow-lg",children:"Inclui b\xf4nus de hor\xe1rio"})]})]}),(0,k.jsxs)("div",{className:"flex items-center gap-1.5 bg-white/10 rounded-lg px-2 py-1 backdrop-blur-sm",children:[(0,k.jsx)(Fd,{className:"w-4 h-4 text-white"}),(0,k.jsxs)("span",{className:"text-white",children:[M(V).filter(e=>!R(e)).reduce((e,t)=>e+t.pontuacao.detalhes.tarefas,0)," pts"]})]}),(0,k.jsxs)("div",{className:"flex items-center gap-1.5 bg-white/10 rounded-lg px-2 py-1 backdrop-blur-sm",children:[(0,k.jsx)(Ld,{className:"w-4 h-4 text-white"}),(0,k.jsxs)("span",{className:"text-white",children:[M(V).filter(e=>!R(e)).reduce((e,t)=>e+t.pontuacao.detalhes.avaliacao,0)," pts"]})]})]})]})})]}),(0,k.jsx)("div",{className:"h-1 w-full bg-white/30"})]})]}),(0,k.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:(()=>{const e=M(V);console.log("\ud83d\udd0d DEBUG RENDERIZA\xc7\xc3O:",{totalAntesFiltro:e.length,periodo:c,mes:u,ano:m,semana:A});const t=e.filter(e=>e.pontuacao.total>0),r=e.filter(e=>R(e)),a=e.filter(e=>R(e)&&e.pontuacao.total>0),n=e.map(e=>{var t,r,a;return{nome:e.nome,pontos:e.pontuacao.total,ferramentas:e.pontuacao.detalhes.ferramentas,tarefas:e.pontuacao.detalhes.tarefas,avaliacao:e.pontuacao.detalhes.avaliacao,terceirizado:R(e),demitido:e.demitido||!1,temAtividades:((null===(t=e.emprestimos)||void 0===t?void 0:t.length)||0)+((null===(r=e.tarefas)||void 0===r?void 0:r.length)||0)+((null===(a=e.avaliacoes)||void 0===a?void 0:a.length)||0)>0}}).sort((e,t)=>t.pontos-e.pontos);console.log("\ud83d\udd0d AN\xc1LISE DE PONTUA\xc7\xc3O:",{totalFuncionarios:e.length,comPontuacaoMaiorQueZero:t.length,semPontuacao:e.length-t.length,terceirizados:r.length,terceirizadosComPontos:a.length}),console.table(n.slice(0,30));const s=e.filter(e=>(e.emprestimos&&e.emprestimos.length>0||e.tarefas&&e.tarefas.length>0||e.avaliacoes&&e.avaliacoes.length>0)&&0===e.pontuacao.total);return s.length>0&&console.warn("\u26a0\ufe0f FUNCION\xc1RIOS COM ATIVIDADES MAS SEM PONTOS:",s.map(e=>{var t,r,a;return{nome:e.nome,emprestimos:(null===(t=e.emprestimos)||void 0===t?void 0:t.length)||0,tarefas:(null===(r=e.tarefas)||void 0===r?void 0:r.length)||0,avaliacoes:(null===(a=e.avaliacoes)||void 0===a?void 0:a.length)||0,pontuacao:e.pontuacao}})),e.filter(e=>!R(e)&&!e.demitido&&e.pontuacao.total>0).sort((e,t)=>t.pontuacao.total-e.pontuacao.total).map((e,t)=>{const r=t<3,a=0===t;return(0,k.jsxs)("div",{onClick:()=>{D(e),L(!0)},className:"\n                  relative overflow-hidden rounded-2xl cursor-pointer transform transition-all duration-300 hover:scale-105 hover:shadow-2xl\n                  ".concat(a?"bg-[#1D9BF0] dark:bg-[#1A8CD8] border-4 border-yellow-400 shadow-xl":r?"bg-white dark:bg-gray-800 border-3 border-gray-300 dark:border-gray-600 shadow-lg":"bg-white dark:bg-gray-800 border-2 border-gray-200 dark:border-gray-700 shadow-md","\n                "),children:[(0,k.jsx)("div",{className:"absolute top-0 left-0 z-10",children:U(t)}),(0,k.jsxs)("div",{className:"p-6 pt-16 ".concat(a?"text-white":""),children:[(0,k.jsxs)("div",{className:"flex flex-col items-center mb-4",children:[e.photoURL?(0,k.jsx)("img",{src:e.photoURL,alt:e.nome,className:"w-24 h-24 rounded-full object-cover shadow-lg mb-3 ".concat(a?"border-4 border-yellow-400":"border-4 border-[#1D9BF0]")}):(0,k.jsx)("div",{className:"w-24 h-24 rounded-full flex items-center justify-center shadow-lg mb-3 ".concat(a?"bg-yellow-400 border-4 border-yellow-300":"bg-[#1D9BF0] border-4 border-[#1A8CD8]"),children:(0,k.jsx)("span",{className:"text-4xl font-bold text-white",children:e.nome.charAt(0)})}),(0,k.jsx)("h3",{className:"text-xl font-bold text-center mb-2 ".concat(a?"text-white":"text-gray-900 dark:text-white"),children:e.nome}),(0,k.jsxs)("div",{className:"flex items-center gap-2 px-4 py-2 rounded-full ".concat(a?"bg-yellow-400":"bg-[#1D9BF0]"," shadow-lg"),children:[(0,k.jsx)(nu,{className:"w-5 h-5 text-white"}),(0,k.jsx)("span",{className:"text-2xl font-bold text-white",children:e.pontuacao.total}),(0,k.jsx)("span",{className:"text-sm font-semibold text-white",children:"pts"})]})]}),(0,k.jsxs)("div",{className:"space-y-2 mt-4",children:[(0,k.jsxs)("div",{className:"flex items-center justify-between px-3 py-2 rounded-lg ".concat(a?"bg-white/20 backdrop-blur-sm":"bg-blue-50 dark:bg-blue-900/20"),children:[(0,k.jsxs)("div",{className:"flex items-center gap-2",children:[(0,k.jsx)(lu,{className:"w-5 h-5 ".concat(a?"text-white":"text-blue-600 dark:text-blue-400")}),(0,k.jsx)("span",{className:"text-sm font-medium ".concat(a?"text-white":"text-gray-700 dark:text-gray-300"),children:"Ferramentas"})]}),(0,k.jsx)("span",{className:"text-lg font-bold ".concat(a?"text-white":"text-blue-600 dark:text-blue-400"),children:e.pontuacao.detalhes.ferramentas})]}),(0,k.jsxs)("div",{className:"flex items-center justify-between px-3 py-2 rounded-lg ".concat(a?"bg-white/20 backdrop-blur-sm":"bg-green-50 dark:bg-green-900/20"),children:[(0,k.jsxs)("div",{className:"flex items-center gap-2",children:[(0,k.jsx)(Fd,{className:"w-5 h-5 ".concat(a?"text-white":"text-green-600 dark:text-green-400")}),(0,k.jsx)("span",{className:"text-sm font-medium ".concat(a?"text-white":"text-gray-700 dark:text-gray-300"),children:"Tarefas"})]}),(0,k.jsx)("span",{className:"text-lg font-bold ".concat(a?"text-white":"text-green-600 dark:text-green-400"),children:e.pontuacao.detalhes.tarefas})]}),(0,k.jsxs)("div",{className:"flex items-center justify-between px-3 py-2 rounded-lg ".concat(a?"bg-white/20 backdrop-blur-sm":"bg-yellow-50 dark:bg-yellow-900/20"),children:[(0,k.jsxs)("div",{className:"flex items-center gap-2",children:[(0,k.jsx)(Ld,{className:"w-5 h-5 ".concat(a?"text-white":"text-yellow-600 dark:text-yellow-400")}),(0,k.jsx)("span",{className:"text-sm font-medium ".concat(a?"text-white":"text-gray-700 dark:text-gray-300"),children:"Avalia\xe7\xf5es"})]}),(0,k.jsx)("span",{className:"text-lg font-bold ".concat(a?"text-white":"text-yellow-600 dark:text-yellow-400"),children:e.pontuacao.detalhes.avaliacao})]})]})]}),(0,k.jsx)("div",{className:"absolute inset-0 bg-white/0 hover:bg-white/5 transition-all pointer-events-none"})]},e.id)})})()})]})]})},mu=y("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),fu=y("clipboard-list",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]),gu=y("list-filter",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M7 12h10",key:"b7w52i"}],["path",{d:"M10 18h4",key:"1ulq68"}]]),pu=y("arrow-up-down",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]),xu=y("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),yu=y("circle-dot-dashed",[["path",{d:"M10.1 2.18a9.93 9.93 0 0 1 3.8 0",key:"1qdqn0"}],["path",{d:"M17.6 3.71a9.95 9.95 0 0 1 2.69 2.7",key:"1bq7p6"}],["path",{d:"M21.82 10.1a9.93 9.93 0 0 1 0 3.8",key:"1rlaqf"}],["path",{d:"M20.29 17.6a9.95 9.95 0 0 1-2.7 2.69",key:"1xk03u"}],["path",{d:"M13.9 21.82a9.94 9.94 0 0 1-3.8 0",key:"l7re25"}],["path",{d:"M6.4 20.29a9.95 9.95 0 0 1-2.69-2.7",key:"1v18p6"}],["path",{d:"M2.18 13.9a9.93 9.93 0 0 1 0-3.8",key:"xdo6bj"}],["path",{d:"M3.71 6.4a9.95 9.95 0 0 1 2.7-2.69",key:"1jjmaz"}],["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}]]),vu=y("arrow-right",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]),bu=e=>{if(!e)return"-";try{return("string"===typeof e?new Date(e.replace(/-/g,"/")):new Date(e)).toLocaleDateString("pt-BR")}catch(t){return console.error("Erro ao formatar data:",e,t),"-"}},wu=e=>{if(!e)return"-";try{const t=new Date(e);return"".concat(t.toLocaleDateString("pt-BR")," \xe0s ").concat(t.toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"}))}catch(t){return console.error("Erro ao formatar data e hora:",e,t),"-"}},ku=t=>{let{emprestimo:r,funcionarios:a,onClose:n}=t;const[i,o]=(0,e.useState)(""),[l,c]=(0,e.useState)(!1),[d,u]=(0,e.useState)(!1),{showToast:h}=_(),m=(null===a||void 0===a?void 0:a.filter(e=>e.id!==r.funcionarioId))||[];return(0,k.jsx)("div",{className:"fixed inset-0 bg-black/50 dark:bg-black/70 flex items-center justify-center p-4",children:(0,k.jsxs)("div",{className:"bg-white dark:bg-gray-700 rounded-lg shadow-xl w-full max-w-2xl border border-gray-200 dark:border-gray-600",children:[(0,k.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-800 px-6 py-4 rounded-t-lg border-b border-gray-200 dark:border-gray-600",children:[(0,k.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Transferir Ferramentas"}),(0,k.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-300 mt-1",children:"Selecione o funcion\xe1rio e confirme a transfer\xeancia das ferramentas"})]}),(0,k.jsxs)("div",{className:"p-6 space-y-6",children:[(0,k.jsxs)("div",{children:[(0,k.jsx)("h4",{className:"text-sm font-medium text-gray-900 dark:text-white mb-2",children:"Ferramentas a transferir:"}),(0,k.jsx)("div",{className:"bg-gray-50 dark:bg-gray-600 border border-gray-200 dark:border-gray-500 rounded-lg divide-y divide-gray-200 dark:divide-gray-500",children:r.ferramentas.map((e,t)=>(0,k.jsxs)("div",{className:"p-3 flex items-center justify-between",children:[(0,k.jsxs)("div",{className:"flex items-center gap-3",children:[(0,k.jsx)(lu,{className:"w-5 h-5 text-gray-400"}),(0,k.jsxs)("div",{children:[(0,k.jsx)("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:"string"===typeof e?e:e.nome}),"string"!==typeof e&&e.codigo&&(0,k.jsxs)("span",{className:"ml-2 text-xs text-gray-500 dark:text-gray-400",children:["C\xf3digo: ",e.codigo]})]})]}),"string"!==typeof e&&e.quantidade>1&&(0,k.jsxs)("span",{className:"text-sm text-gray-900 dark:text-white bg-gray-100 dark:bg-gray-500 px-2 py-1 rounded",children:["Qtd: ",e.quantidade]})]},t))})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium text-gray-900 dark:text-white mb-2",children:"Selecione o funcion\xe1rio para receber as ferramentas:"}),(0,k.jsxs)("select",{value:i,onChange:e=>o(e.target.value),className:"w-full bg-white dark:bg-gray-600 border border-gray-300 dark:border-gray-500 text-gray-900 dark:text-white rounded-full px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-[#1D9BF0] transition-colors appearance-none",required:!0,children:[(0,k.jsx)("option",{value:"",children:"Selecione um funcion\xe1rio"}),m.map(e=>(0,k.jsx)("option",{value:e.id,children:e.nome},e.id))]})]}),(0,k.jsx)("div",{className:"border border-yellow-200 bg-yellow-50 rounded-lg p-4",children:(0,k.jsxs)("label",{className:"flex items-start gap-3 cursor-pointer",children:[(0,k.jsx)("input",{type:"checkbox",checked:d,onChange:e=>u(e.target.checked),className:"mt-1 h-4 w-4 text-green-600 border-yellow-400 rounded focus:ring-green-500"}),(0,k.jsxs)("div",{className:"space-y-1",children:[(0,k.jsx)("span",{className:"text-sm font-medium text-yellow-800 block",children:"Termo de Responsabilidade"}),(0,k.jsx)("span",{className:"text-sm text-yellow-700",children:"Confirmo que me responsabilizo pela entrega f\xedsica das ferramentas ao colaborador selecionado e que manterei o sistema atualizado com a localiza\xe7\xe3o real das ferramentas. Entendo que esta transfer\xeancia registrar\xe1 a mudan\xe7a de responsabilidade no sistema imediatamente."})]})]})})]}),(0,k.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-800 px-6 py-4 rounded-b-lg border-t border-gray-200 dark:border-gray-600 flex justify-end gap-3",children:[(0,k.jsx)("button",{type:"button",onClick:n,className:"px-4 py-2 text-sm font-medium text-gray-900 dark:text-white bg-white dark:bg-gray-600 border border-gray-200 dark:border-gray-500 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-500 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500",children:"Cancelar"}),(0,k.jsxs)("button",{type:"button",onClick:async()=>{if(i)if(d){c(!0);try{if(null===r||void 0===r||!r.id||null===r||void 0===r||!r.funcionarioId)throw new Error("Dados do empr\xe9stimo incompletos");const e=a.find(e=>e.id===i);if(null===e||void 0===e||!e.nome)throw new Error("Funcion\xe1rio de destino n\xe3o encontrado");console.log("Transferindo para:",e.nome);const t=(0,s.doc)(P.db,"emprestimos",r.id),o=new Date,l=o.toISOString(),c=o.toTimeString().split(" ")[0];await(0,s.updateDoc)(t,{funcionarioId:String(i),colaborador:e.nome,dataUltimaTransferencia:l,dataRetirada:l.split("T")[0],horaRetirada:c,historicoTransferencias:[...r.historicoTransferencias||[],{data:l,de:r.colaborador,para:e.nome,deId:String(r.funcionarioId),paraId:String(i)}]}),h("Ferramenta(s) transferida(s) com sucesso!","success"),n()}catch(e){console.error("Erro ao transferir:",e);let t="Erro ao transferir. ";"Funcion\xe1rio de destino n\xe3o encontrado"===e.message?t+="Funcion\xe1rio n\xe3o encontrado.":"Dados do empr\xe9stimo incompletos"===e.message?t+="Dados do empr\xe9stimo inv\xe1lidos.":t+="Tente novamente.",h(t,"error")}finally{c(!1)}}else h("Voc\xea precisa confirmar a responsabilidade pela entrega das ferramentas","warning");else h("Selecione um funcion\xe1rio para transferir","warning")},disabled:l||!i||!d,className:"px-4 py-2 text-sm font-medium text-white bg-green-600 rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 flex items-center gap-2",children:[(0,k.jsx)(vu,{className:"w-4 h-4"}),l?"Transferindo...":"Confirmar Transfer\xeancia"]})]})]})})},Nu=y("printer",[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]]);var ju=r(2284),Su=Uint8Array,_u=Uint16Array,Eu=Int32Array,Au=new Su([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Cu=new Su([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Iu=new Su([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Tu=function(e,t){for(var r=new _u(31),a=0;a<31;++a)r[a]=t+=1<<e[a-1];var n=new Eu(r[30]);for(a=1;a<30;++a)for(var s=r[a];s<r[a+1];++s)n[s]=s-r[a]<<5|a;return{b:r,r:n}},Du=Tu(Au,2),Pu=Du.b,Fu=Du.r;Pu[28]=258,Fu[258]=28;for(var Lu=Tu(Cu,0),Mu=(Lu.b,Lu.r),Ru=new _u(32768),Ou=0;Ou<32768;++Ou){var Bu=(43690&Ou)>>1|(21845&Ou)<<1;Bu=(61680&(Bu=(52428&Bu)>>2|(13107&Bu)<<2))>>4|(3855&Bu)<<4,Ru[Ou]=((65280&Bu)>>8|(255&Bu)<<8)>>1}var zu=function(e,t,r){for(var a=e.length,n=0,s=new _u(t);n<a;++n)e[n]&&++s[e[n]-1];var i,o=new _u(t);for(n=1;n<t;++n)o[n]=o[n-1]+s[n-1]<<1;if(r){i=new _u(1<<t);var l=15-t;for(n=0;n<a;++n)if(e[n])for(var c=n<<4|e[n],d=t-e[n],u=o[e[n]-1]++<<d,h=u|(1<<d)-1;u<=h;++u)i[Ru[u]>>l]=c}else for(i=new _u(a),n=0;n<a;++n)e[n]&&(i[n]=Ru[o[e[n]-1]++]>>15-e[n]);return i},Uu=new Su(288);for(Ou=0;Ou<144;++Ou)Uu[Ou]=8;for(Ou=144;Ou<256;++Ou)Uu[Ou]=9;for(Ou=256;Ou<280;++Ou)Uu[Ou]=7;for(Ou=280;Ou<288;++Ou)Uu[Ou]=8;var Vu=new Su(32);for(Ou=0;Ou<32;++Ou)Vu[Ou]=5;var qu=zu(Uu,9,0),Hu=zu(Vu,5,0),Gu=function(e){return(e+7)/8|0},Wu=function(e,t,r){return(null==t||t<0)&&(t=0),(null==r||r>e.length)&&(r=e.length),new Su(e.subarray(t,r))},Ku=function(e,t,r){r<<=7&t;var a=t/8|0;e[a]|=r,e[a+1]|=r>>8},Qu=function(e,t,r){r<<=7&t;var a=t/8|0;e[a]|=r,e[a+1]|=r>>8,e[a+2]|=r>>16},Yu=function(e,t){for(var r=[],a=0;a<e.length;++a)e[a]&&r.push({s:a,f:e[a]});var n=r.length,s=r.slice();if(!n)return{t:rh,l:0};if(1==n){var i=new Su(r[0].s+1);return i[r[0].s]=1,{t:i,l:1}}r.sort(function(e,t){return e.f-t.f}),r.push({s:-1,f:25001});var o=r[0],l=r[1],c=0,d=1,u=2;for(r[0]={s:-1,f:o.f+l.f,l:o,r:l};d!=n-1;)o=r[r[c].f<r[u].f?c++:u++],l=r[c!=d&&r[c].f<r[u].f?c++:u++],r[d++]={s:-1,f:o.f+l.f,l:o,r:l};var h=s[0].s;for(a=1;a<n;++a)s[a].s>h&&(h=s[a].s);var m=new _u(h+1),f=Xu(r[d-1],m,0);if(f>t){a=0;var g=0,p=f-t,x=1<<p;for(s.sort(function(e,t){return m[t.s]-m[e.s]||e.f-t.f});a<n;++a){var y=s[a].s;if(!(m[y]>t))break;g+=x-(1<<f-m[y]),m[y]=t}for(g>>=p;g>0;){var v=s[a].s;m[v]<t?g-=1<<t-m[v]++-1:++a}for(;a>=0&&g;--a){var b=s[a].s;m[b]==t&&(--m[b],++g)}f=t}return{t:new Su(m),l:f}},Xu=function(e,t,r){return-1==e.s?Math.max(Xu(e.l,t,r+1),Xu(e.r,t,r+1)):t[e.s]=r},Ju=function(e){for(var t=e.length;t&&!e[--t];);for(var r=new _u(++t),a=0,n=e[0],s=1,i=function(e){r[a++]=e},o=1;o<=t;++o)if(e[o]==n&&o!=t)++s;else{if(!n&&s>2){for(;s>138;s-=138)i(32754);s>2&&(i(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(i(n),--s;s>6;s-=6)i(8304);s>2&&(i(s-3<<5|8208),s=0)}for(;s--;)i(n);s=1,n=e[o]}return{c:r.subarray(0,a),n:t}},Zu=function(e,t){for(var r=0,a=0;a<t.length;++a)r+=e[a]*t[a];return r},$u=function(e,t,r){var a=r.length,n=Gu(t+2);e[n]=255&a,e[n+1]=a>>8,e[n+2]=255^e[n],e[n+3]=255^e[n+1];for(var s=0;s<a;++s)e[n+s+4]=r[s];return 8*(n+4+a)},eh=function(e,t,r,a,n,s,i,o,l,c,d){Ku(t,d++,r),++n[256];for(var u=Yu(n,15),h=u.t,m=u.l,f=Yu(s,15),g=f.t,p=f.l,x=Ju(h),y=x.c,v=x.n,b=Ju(g),w=b.c,k=b.n,N=new _u(19),j=0;j<y.length;++j)++N[31&y[j]];for(j=0;j<w.length;++j)++N[31&w[j]];for(var S=Yu(N,7),_=S.t,E=S.l,A=19;A>4&&!_[Iu[A-1]];--A);var C,I,T,D,P=c+5<<3,F=Zu(n,Uu)+Zu(s,Vu)+i,L=Zu(n,h)+Zu(s,g)+i+14+3*A+Zu(N,_)+2*N[16]+3*N[17]+7*N[18];if(l>=0&&P<=F&&P<=L)return $u(t,d,e.subarray(l,l+c));if(Ku(t,d,1+(L<F)),d+=2,L<F){C=zu(h,m,0),I=h,T=zu(g,p,0),D=g;var M=zu(_,E,0);Ku(t,d,v-257),Ku(t,d+5,k-1),Ku(t,d+10,A-4),d+=14;for(j=0;j<A;++j)Ku(t,d+3*j,_[Iu[j]]);d+=3*A;for(var R=[y,w],O=0;O<2;++O){var B=R[O];for(j=0;j<B.length;++j){var z=31&B[j];Ku(t,d,M[z]),d+=_[z],z>15&&(Ku(t,d,B[j]>>5&127),d+=B[j]>>12)}}}else C=qu,I=Uu,T=Hu,D=Vu;for(j=0;j<o;++j){var U=a[j];if(U>255){Qu(t,d,C[(z=U>>18&31)+257]),d+=I[z+257],z>7&&(Ku(t,d,U>>23&31),d+=Au[z]);var V=31&U;Qu(t,d,T[V]),d+=D[V],V>3&&(Qu(t,d,U>>5&8191),d+=Cu[V])}else Qu(t,d,C[U]),d+=I[U]}return Qu(t,d,C[256]),d+I[256]},th=new Eu([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),rh=new Su(0),ah=function(e,t,r,a,n,s){var i=s.z||e.length,o=new Su(a+i+5*(1+Math.ceil(i/7e3))+n),l=o.subarray(a,o.length-n),c=s.l,d=7&(s.r||0);if(t){d&&(l[0]=s.r>>3);for(var u=th[t-1],h=u>>13,m=8191&u,f=(1<<r)-1,g=s.p||new _u(32768),p=s.h||new _u(f+1),x=Math.ceil(r/3),y=2*x,v=function(t){return(e[t]^e[t+1]<<x^e[t+2]<<y)&f},b=new Eu(25e3),w=new _u(288),k=new _u(32),N=0,j=0,S=s.i||0,_=0,E=s.w||0,A=0;S+2<i;++S){var C=v(S),I=32767&S,T=p[C];if(g[I]=T,p[C]=I,E<=S){var D=i-S;if((N>7e3||_>24576)&&(D>423||!c)){d=eh(e,l,0,b,w,k,j,_,A,S-A,d),_=N=j=0,A=S;for(var P=0;P<286;++P)w[P]=0;for(P=0;P<30;++P)k[P]=0}var F=2,L=0,M=m,R=I-T&32767;if(D>2&&C==v(S-R))for(var O=Math.min(h,D)-1,B=Math.min(32767,S),z=Math.min(258,D);R<=B&&--M&&I!=T;){if(e[S+F]==e[S+F-R]){for(var U=0;U<z&&e[S+U]==e[S+U-R];++U);if(U>F){if(F=U,L=R,U>O)break;var V=Math.min(R,U-2),q=0;for(P=0;P<V;++P){var H=S-R+P&32767,G=H-g[H]&32767;G>q&&(q=G,T=H)}}}R+=(I=T)-(T=g[I])&32767}if(L){b[_++]=268435456|Fu[F]<<18|Mu[L];var W=31&Fu[F],K=31&Mu[L];j+=Au[W]+Cu[K],++w[257+W],++k[K],E=S+F,++N}else b[_++]=e[S],++w[e[S]]}}for(S=Math.max(S,E);S<i;++S)b[_++]=e[S],++w[e[S]];d=eh(e,l,c,b,w,k,j,_,A,S-A,d),c||(s.r=7&d|l[d/8|0]<<3,d-=7,s.h=p,s.p=g,s.i=S,s.w=E)}else{for(S=s.w||0;S<i+c;S+=65535){var Q=S+65535;Q>=i&&(l[d/8|0]=c,Q=i),d=$u(l,d+1,e.subarray(S,Q))}s.i=i}return Wu(o,0,a+Gu(d)+n)},nh=function(){var e=1,t=0;return{p:function(r){for(var a=e,n=t,s=0|r.length,i=0;i!=s;){for(var o=Math.min(i+2655,s);i<o;++i)n+=a+=r[i];a=(65535&a)+15*(a>>16),n=(65535&n)+15*(n>>16)}e=a,t=n},d:function(){return(255&(e%=65521))<<24|(65280&e)<<8|(255&(t%=65521))<<8|t>>8}}},sh=function(e,t,r,a,n){if(!n&&(n={l:1},t.dictionary)){var s=t.dictionary.subarray(-32768),i=new Su(s.length+e.length);i.set(s),i.set(e,s.length),e=i,n.w=s.length}return ah(e,null==t.level?6:t.level,null==t.mem?n.l?Math.ceil(1.5*Math.max(8,Math.min(13,Math.log(e.length)))):20:12+t.mem,r,a,n)},ih=function(e,t,r){for(;r;++t)e[t]=r,r>>>=8},oh=function(e,t){var r=t.level,a=0==r?0:r<6?1:9==r?3:2;if(e[0]=120,e[1]=a<<6|(t.dictionary&&32),e[1]|=31-(e[0]<<8|e[1])%31,t.dictionary){var n=nh();n.p(t.dictionary),ih(e,2,n.d())}};function lh(e,t){t||(t={});var r=nh();r.p(e);var a=sh(e,t,t.dictionary?6:2,4);return oh(a,t),ih(a,a.length-4,r.d()),a}var ch="undefined"!=typeof TextDecoder&&new TextDecoder;try{ch.decode(rh,{stream:!0})}catch($_){}"function"==typeof queueMicrotask?queueMicrotask:"function"==typeof setTimeout&&setTimeout;function dh(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,a=Array(t);r<t;r++)a[r]=e[r];return a}function uh(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var a,n,s,i,o=[],l=!0,c=!1;try{if(s=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(a=s.call(r)).done)&&(o.push(a.value),o.length!==t);l=!0);}catch(e){c=!0,n=e}finally{try{if(!l&&null!=r.return&&(i=r.return(),Object(i)!==i))return}finally{if(c)throw n}}return o}}(e,t)||function(e,t){if(e){if("string"==typeof e)return dh(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?dh(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var hh=r(4980);function mh(e){return new TextDecoder(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf8").decode(e)}const fh=new TextEncoder;const gh=(()=>{const e=new Uint8Array(4);return!((new Uint32Array(e.buffer)[0]=1)&e[0])})(),ph={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class xh{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8192,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,hh.A)(this,"buffer",void 0),(0,hh.A)(this,"byteLength",void 0),(0,hh.A)(this,"byteOffset",void 0),(0,hh.A)(this,"length",void 0),(0,hh.A)(this,"offset",void 0),(0,hh.A)(this,"lastWrittenByte",void 0),(0,hh.A)(this,"littleEndian",void 0),(0,hh.A)(this,"_data",void 0),(0,hh.A)(this,"_mark",void 0),(0,hh.A)(this,"_marks",void 0);let r=!1;"number"===typeof e?e=new ArrayBuffer(e):(r=!0,this.lastWrittenByte=e.byteLength);const a=t.offset?t.offset>>>0:0,n=e.byteLength-a;let s=a;(ArrayBuffer.isView(e)||e instanceof xh)&&(e.byteLength!==e.buffer.byteLength&&(s=e.byteOffset+a),e=e.buffer),this.lastWrittenByte=r?n:0,this.buffer=e,this.length=n,this.byteLength=n,this.byteOffset=s,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,s,n),this._mark=0,this._marks=[]}available(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return this.offset+e<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return this.offset+=e,this}back(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return this.offset-=e,this}seek(e){return this.offset=e,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const e=this._marks.pop();if(void 0===e)throw new Error("Mark stack empty");return this.seek(e),this}rewind(){return this.offset=0,this}ensureAvailable(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;if(!this.available(e)){const t=2*(this.offset+e),r=new Uint8Array(t);r.set(new Uint8Array(this.buffer)),this.buffer=r.buffer,this.length=t,this.byteLength=t,this._data=new DataView(this.buffer)}return this}readBoolean(){return 0!==this.readUint8()}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return this.readArray(e,"uint8")}readArray(e,t){const r=ph[t].BYTES_PER_ELEMENT*e,a=this.byteOffset+this.offset,n=this.buffer.slice(a,a+r);if(this.littleEndian===gh&&"uint8"!==t&&"int8"!==t){const e=new Uint8Array(this.buffer.slice(a,a+r));e.reverse();const n=new ph[t](e.buffer);return this.offset+=r,n.reverse(),n}const s=new ph[t](n);return this.offset+=r,s}readInt16(){const e=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,e}readUint16(){const e=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,e}readInt32(){const e=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,e}readUint32(){const e=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat32(){const e=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e}readFloat64(){const e=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e}readBigInt64(){const e=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,e}readBigUint64(){const e=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,e}readChar(){return String.fromCharCode(this.readInt8())}readChars(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t="";for(let r=0;r<e;r++)t+=this.readChar();return t}readUtf8(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return mh(this.readBytes(e))}decodeText(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf8";return mh(this.readBytes(e),t)}writeBoolean(e){return this.writeUint8(e?255:0),this}writeInt8(e){return this.ensureAvailable(1),this._data.setInt8(this.offset++,e),this._updateLastWrittenByte(),this}writeUint8(e){return this.ensureAvailable(1),this._data.setUint8(this.offset++,e),this._updateLastWrittenByte(),this}writeByte(e){return this.writeUint8(e)}writeBytes(e){this.ensureAvailable(e.length);for(let t=0;t<e.length;t++)this._data.setUint8(this.offset++,e[t]);return this._updateLastWrittenByte(),this}writeInt16(e){return this.ensureAvailable(2),this._data.setInt16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(e){return this.ensureAvailable(2),this._data.setUint16(this.offset,e,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(e){return this.ensureAvailable(4),this._data.setInt32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(e){return this.ensureAvailable(4),this._data.setUint32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(e){return this.ensureAvailable(4),this._data.setFloat32(this.offset,e,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(e){return this.ensureAvailable(8),this._data.setFloat64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(e){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(e){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,e,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(e){return this.writeUint8(e.charCodeAt(0))}writeChars(e){for(let t=0;t<e.length;t++)this.writeUint8(e.charCodeAt(t));return this}writeUtf8(e){return this.writeBytes(function(e){return fh.encode(e)}(e))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}function yh(e){let t=e.length;for(;--t>=0;)e[t]=0}const vh=256,bh=286,wh=30,kh=15,Nh=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),jh=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),Sh=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),_h=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Eh=new Array(576);yh(Eh);const Ah=new Array(60);yh(Ah);const Ch=new Array(512);yh(Ch);const Ih=new Array(256);yh(Ih);const Th=new Array(29);yh(Th);const Dh=new Array(wh);function Ph(e,t,r,a,n){this.static_tree=e,this.extra_bits=t,this.extra_base=r,this.elems=a,this.max_length=n,this.has_stree=e&&e.length}let Fh,Lh,Mh;function Rh(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}yh(Dh);const Oh=e=>e<256?Ch[e]:Ch[256+(e>>>7)],Bh=(e,t)=>{e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255},zh=(e,t,r)=>{e.bi_valid>16-r?(e.bi_buf|=t<<e.bi_valid&65535,Bh(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=r-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=r)},Uh=(e,t,r)=>{zh(e,r[2*t],r[2*t+1])},Vh=(e,t)=>{let r=0;do{r|=1&e,e>>>=1,r<<=1}while(--t>0);return r>>>1},qh=(e,t,r)=>{const a=new Array(16);let n,s,i=0;for(n=1;n<=kh;n++)i=i+r[n-1]<<1,a[n]=i;for(s=0;s<=t;s++){let t=e[2*s+1];0!==t&&(e[2*s]=Vh(a[t]++,t))}},Hh=e=>{let t;for(t=0;t<bh;t++)e.dyn_ltree[2*t]=0;for(t=0;t<wh;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.sym_next=e.matches=0},Gh=e=>{e.bi_valid>8?Bh(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},Wh=(e,t,r,a)=>{const n=2*t,s=2*r;return e[n]<e[s]||e[n]===e[s]&&a[t]<=a[r]},Kh=(e,t,r)=>{const a=e.heap[r];let n=r<<1;for(;n<=e.heap_len&&(n<e.heap_len&&Wh(t,e.heap[n+1],e.heap[n],e.depth)&&n++,!Wh(t,a,e.heap[n],e.depth));)e.heap[r]=e.heap[n],r=n,n<<=1;e.heap[r]=a},Qh=(e,t,r)=>{let a,n,s,i,o=0;if(0!==e.sym_next)do{a=255&e.pending_buf[e.sym_buf+o++],a+=(255&e.pending_buf[e.sym_buf+o++])<<8,n=e.pending_buf[e.sym_buf+o++],0===a?Uh(e,n,t):(s=Ih[n],Uh(e,s+vh+1,t),i=Nh[s],0!==i&&(n-=Th[s],zh(e,n,i)),a--,s=Oh(a),Uh(e,s,r),i=jh[s],0!==i&&(a-=Dh[s],zh(e,a,i)))}while(o<e.sym_next);Uh(e,256,t)},Yh=(e,t)=>{const r=t.dyn_tree,a=t.stat_desc.static_tree,n=t.stat_desc.has_stree,s=t.stat_desc.elems;let i,o,l,c=-1;for(e.heap_len=0,e.heap_max=573,i=0;i<s;i++)0!==r[2*i]?(e.heap[++e.heap_len]=c=i,e.depth[i]=0):r[2*i+1]=0;for(;e.heap_len<2;)l=e.heap[++e.heap_len]=c<2?++c:0,r[2*l]=1,e.depth[l]=0,e.opt_len--,n&&(e.static_len-=a[2*l+1]);for(t.max_code=c,i=e.heap_len>>1;i>=1;i--)Kh(e,r,i);l=s;do{i=e.heap[1],e.heap[1]=e.heap[e.heap_len--],Kh(e,r,1),o=e.heap[1],e.heap[--e.heap_max]=i,e.heap[--e.heap_max]=o,r[2*l]=r[2*i]+r[2*o],e.depth[l]=(e.depth[i]>=e.depth[o]?e.depth[i]:e.depth[o])+1,r[2*i+1]=r[2*o+1]=l,e.heap[1]=l++,Kh(e,r,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],((e,t)=>{const r=t.dyn_tree,a=t.max_code,n=t.stat_desc.static_tree,s=t.stat_desc.has_stree,i=t.stat_desc.extra_bits,o=t.stat_desc.extra_base,l=t.stat_desc.max_length;let c,d,u,h,m,f,g=0;for(h=0;h<=kh;h++)e.bl_count[h]=0;for(r[2*e.heap[e.heap_max]+1]=0,c=e.heap_max+1;c<573;c++)d=e.heap[c],h=r[2*r[2*d+1]+1]+1,h>l&&(h=l,g++),r[2*d+1]=h,d>a||(e.bl_count[h]++,m=0,d>=o&&(m=i[d-o]),f=r[2*d],e.opt_len+=f*(h+m),s&&(e.static_len+=f*(n[2*d+1]+m)));if(0!==g){do{for(h=l-1;0===e.bl_count[h];)h--;e.bl_count[h]--,e.bl_count[h+1]+=2,e.bl_count[l]--,g-=2}while(g>0);for(h=l;0!==h;h--)for(d=e.bl_count[h];0!==d;)u=e.heap[--c],u>a||(r[2*u+1]!==h&&(e.opt_len+=(h-r[2*u+1])*r[2*u],r[2*u+1]=h),d--)}})(e,t),qh(r,c,e.bl_count)},Xh=(e,t,r)=>{let a,n,s=-1,i=t[1],o=0,l=7,c=4;for(0===i&&(l=138,c=3),t[2*(r+1)+1]=65535,a=0;a<=r;a++)n=i,i=t[2*(a+1)+1],++o<l&&n===i||(o<c?e.bl_tree[2*n]+=o:0!==n?(n!==s&&e.bl_tree[2*n]++,e.bl_tree[32]++):o<=10?e.bl_tree[34]++:e.bl_tree[36]++,o=0,s=n,0===i?(l=138,c=3):n===i?(l=6,c=3):(l=7,c=4))},Jh=(e,t,r)=>{let a,n,s=-1,i=t[1],o=0,l=7,c=4;for(0===i&&(l=138,c=3),a=0;a<=r;a++)if(n=i,i=t[2*(a+1)+1],!(++o<l&&n===i)){if(o<c)do{Uh(e,n,e.bl_tree)}while(0!==--o);else 0!==n?(n!==s&&(Uh(e,n,e.bl_tree),o--),Uh(e,16,e.bl_tree),zh(e,o-3,2)):o<=10?(Uh(e,17,e.bl_tree),zh(e,o-3,3)):(Uh(e,18,e.bl_tree),zh(e,o-11,7));o=0,s=n,0===i?(l=138,c=3):n===i?(l=6,c=3):(l=7,c=4)}};let Zh=!1;const $h=(e,t,r,a)=>{zh(e,0+(a?1:0),3),Gh(e),Bh(e,r),Bh(e,~r),r&&e.pending_buf.set(e.window.subarray(t,t+r),e.pending),e.pending+=r};var em=e=>{Zh||((()=>{let e,t,r,a,n;const s=new Array(16);for(r=0,a=0;a<28;a++)for(Th[a]=r,e=0;e<1<<Nh[a];e++)Ih[r++]=a;for(Ih[r-1]=a,n=0,a=0;a<16;a++)for(Dh[a]=n,e=0;e<1<<jh[a];e++)Ch[n++]=a;for(n>>=7;a<wh;a++)for(Dh[a]=n<<7,e=0;e<1<<jh[a]-7;e++)Ch[256+n++]=a;for(t=0;t<=kh;t++)s[t]=0;for(e=0;e<=143;)Eh[2*e+1]=8,e++,s[8]++;for(;e<=255;)Eh[2*e+1]=9,e++,s[9]++;for(;e<=279;)Eh[2*e+1]=7,e++,s[7]++;for(;e<=287;)Eh[2*e+1]=8,e++,s[8]++;for(qh(Eh,287,s),e=0;e<wh;e++)Ah[2*e+1]=5,Ah[2*e]=Vh(e,5);Fh=new Ph(Eh,Nh,257,bh,kh),Lh=new Ph(Ah,jh,0,wh,kh),Mh=new Ph(new Array(0),Sh,0,19,7)})(),Zh=!0),e.l_desc=new Rh(e.dyn_ltree,Fh),e.d_desc=new Rh(e.dyn_dtree,Lh),e.bl_desc=new Rh(e.bl_tree,Mh),e.bi_buf=0,e.bi_valid=0,Hh(e)},tm=(e,t,r,a)=>{let n,s,i=0;e.level>0?(2===e.strm.data_type&&(e.strm.data_type=(e=>{let t,r=4093624447;for(t=0;t<=31;t++,r>>>=1)if(1&r&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<vh;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0})(e)),Yh(e,e.l_desc),Yh(e,e.d_desc),i=(e=>{let t;for(Xh(e,e.dyn_ltree,e.l_desc.max_code),Xh(e,e.dyn_dtree,e.d_desc.max_code),Yh(e,e.bl_desc),t=18;t>=3&&0===e.bl_tree[2*_h[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t})(e),n=e.opt_len+3+7>>>3,s=e.static_len+3+7>>>3,s<=n&&(n=s)):n=s=r+5,r+4<=n&&-1!==t?$h(e,t,r,a):4===e.strategy||s===n?(zh(e,2+(a?1:0),3),Qh(e,Eh,Ah)):(zh(e,4+(a?1:0),3),((e,t,r,a)=>{let n;for(zh(e,t-257,5),zh(e,r-1,5),zh(e,a-4,4),n=0;n<a;n++)zh(e,e.bl_tree[2*_h[n]+1],3);Jh(e,e.dyn_ltree,t-1),Jh(e,e.dyn_dtree,r-1)})(e,e.l_desc.max_code+1,e.d_desc.max_code+1,i+1),Qh(e,e.dyn_ltree,e.dyn_dtree)),Hh(e),a&&Gh(e)},rm=(e,t,r)=>(e.pending_buf[e.sym_buf+e.sym_next++]=t,e.pending_buf[e.sym_buf+e.sym_next++]=t>>8,e.pending_buf[e.sym_buf+e.sym_next++]=r,0===t?e.dyn_ltree[2*r]++:(e.matches++,t--,e.dyn_ltree[2*(Ih[r]+vh+1)]++,e.dyn_dtree[2*Oh(t)]++),e.sym_next===e.sym_end),am=e=>{zh(e,2,3),Uh(e,256,Eh),(e=>{16===e.bi_valid?(Bh(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)})(e)},nm={_tr_init:em,_tr_stored_block:$h,_tr_flush_block:tm,_tr_tally:rm,_tr_align:am};var sm=(e,t,r,a)=>{let n=65535&e,s=e>>>16&65535,i=0;for(;0!==r;){i=r>2e3?2e3:r,r-=i;do{n=n+t[a++]|0,s=s+n|0}while(--i);n%=65521,s%=65521}return n|s<<16};const im=new Uint32Array((()=>{let e,t=[];for(var r=0;r<256;r++){e=r;for(var a=0;a<8;a++)e=1&e?3988292384^e>>>1:e>>>1;t[r]=e}return t})());var om=(e,t,r,a)=>{const n=im,s=a+r;e^=-1;for(let i=a;i<s;i++)e=e>>>8^n[255&(e^t[i])];return-1^e},lm={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},cm={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:dm,_tr_stored_block:um,_tr_flush_block:hm,_tr_tally:mm,_tr_align:fm}=nm,{Z_NO_FLUSH:gm,Z_PARTIAL_FLUSH:pm,Z_FULL_FLUSH:xm,Z_FINISH:ym,Z_BLOCK:vm,Z_OK:bm,Z_STREAM_END:wm,Z_STREAM_ERROR:km,Z_DATA_ERROR:Nm,Z_BUF_ERROR:jm,Z_DEFAULT_COMPRESSION:Sm,Z_FILTERED:_m,Z_HUFFMAN_ONLY:Em,Z_RLE:Am,Z_FIXED:Cm,Z_DEFAULT_STRATEGY:Im,Z_UNKNOWN:Tm,Z_DEFLATED:Dm}=cm,Pm=258,Fm=262,Lm=42,Mm=113,Rm=666,Om=(e,t)=>(e.msg=lm[t],t),Bm=e=>2*e-(e>4?9:0),zm=e=>{let t=e.length;for(;--t>=0;)e[t]=0},Um=e=>{let t,r,a,n=e.w_size;t=e.hash_size,a=t;do{r=e.head[--a],e.head[a]=r>=n?r-n:0}while(--t);t=n,a=t;do{r=e.prev[--a],e.prev[a]=r>=n?r-n:0}while(--t)};let Vm=(e,t,r)=>(t<<e.hash_shift^r)&e.hash_mask;const qm=e=>{const t=e.state;let r=t.pending;r>e.avail_out&&(r=e.avail_out),0!==r&&(e.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+r),e.next_out),e.next_out+=r,t.pending_out+=r,e.total_out+=r,e.avail_out-=r,t.pending-=r,0===t.pending&&(t.pending_out=0))},Hm=(e,t)=>{hm(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,qm(e.strm)},Gm=(e,t)=>{e.pending_buf[e.pending++]=t},Wm=(e,t)=>{e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t},Km=(e,t,r,a)=>{let n=e.avail_in;return n>a&&(n=a),0===n?0:(e.avail_in-=n,t.set(e.input.subarray(e.next_in,e.next_in+n),r),1===e.state.wrap?e.adler=sm(e.adler,t,n,r):2===e.state.wrap&&(e.adler=om(e.adler,t,n,r)),e.next_in+=n,e.total_in+=n,n)},Qm=(e,t)=>{let r,a,n=e.max_chain_length,s=e.strstart,i=e.prev_length,o=e.nice_match;const l=e.strstart>e.w_size-Fm?e.strstart-(e.w_size-Fm):0,c=e.window,d=e.w_mask,u=e.prev,h=e.strstart+Pm;let m=c[s+i-1],f=c[s+i];e.prev_length>=e.good_match&&(n>>=2),o>e.lookahead&&(o=e.lookahead);do{if(r=t,c[r+i]===f&&c[r+i-1]===m&&c[r]===c[s]&&c[++r]===c[s+1]){s+=2,r++;do{}while(c[++s]===c[++r]&&c[++s]===c[++r]&&c[++s]===c[++r]&&c[++s]===c[++r]&&c[++s]===c[++r]&&c[++s]===c[++r]&&c[++s]===c[++r]&&c[++s]===c[++r]&&s<h);if(a=Pm-(h-s),s=h-Pm,a>i){if(e.match_start=t,i=a,a>=o)break;m=c[s+i-1],f=c[s+i]}}}while((t=u[t&d])>l&&0!==--n);return i<=e.lookahead?i:e.lookahead},Ym=e=>{const t=e.w_size;let r,a,n;do{if(a=e.window_size-e.lookahead-e.strstart,e.strstart>=t+(t-Fm)&&(e.window.set(e.window.subarray(t,t+t-a),0),e.match_start-=t,e.strstart-=t,e.block_start-=t,e.insert>e.strstart&&(e.insert=e.strstart),Um(e),a+=t),0===e.strm.avail_in)break;if(r=Km(e.strm,e.window,e.strstart+e.lookahead,a),e.lookahead+=r,e.lookahead+e.insert>=3)for(n=e.strstart-e.insert,e.ins_h=e.window[n],e.ins_h=Vm(e,e.ins_h,e.window[n+1]);e.insert&&(e.ins_h=Vm(e,e.ins_h,e.window[n+3-1]),e.prev[n&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=n,n++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<Fm&&0!==e.strm.avail_in)},Xm=(e,t)=>{let r,a,n,s=e.pending_buf_size-5>e.w_size?e.w_size:e.pending_buf_size-5,i=0,o=e.strm.avail_in;do{if(r=65535,n=e.bi_valid+42>>3,e.strm.avail_out<n)break;if(n=e.strm.avail_out-n,a=e.strstart-e.block_start,r>a+e.strm.avail_in&&(r=a+e.strm.avail_in),r>n&&(r=n),r<s&&(0===r&&t!==ym||t===gm||r!==a+e.strm.avail_in))break;i=t===ym&&r===a+e.strm.avail_in?1:0,um(e,0,0,i),e.pending_buf[e.pending-4]=r,e.pending_buf[e.pending-3]=r>>8,e.pending_buf[e.pending-2]=~r,e.pending_buf[e.pending-1]=~r>>8,qm(e.strm),a&&(a>r&&(a=r),e.strm.output.set(e.window.subarray(e.block_start,e.block_start+a),e.strm.next_out),e.strm.next_out+=a,e.strm.avail_out-=a,e.strm.total_out+=a,e.block_start+=a,r-=a),r&&(Km(e.strm,e.strm.output,e.strm.next_out,r),e.strm.next_out+=r,e.strm.avail_out-=r,e.strm.total_out+=r)}while(0===i);return o-=e.strm.avail_in,o&&(o>=e.w_size?(e.matches=2,e.window.set(e.strm.input.subarray(e.strm.next_in-e.w_size,e.strm.next_in),0),e.strstart=e.w_size,e.insert=e.strstart):(e.window_size-e.strstart<=o&&(e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,e.insert>e.strstart&&(e.insert=e.strstart)),e.window.set(e.strm.input.subarray(e.strm.next_in-o,e.strm.next_in),e.strstart),e.strstart+=o,e.insert+=o>e.w_size-e.insert?e.w_size-e.insert:o),e.block_start=e.strstart),e.high_water<e.strstart&&(e.high_water=e.strstart),i?4:t!==gm&&t!==ym&&0===e.strm.avail_in&&e.strstart===e.block_start?2:(n=e.window_size-e.strstart,e.strm.avail_in>n&&e.block_start>=e.w_size&&(e.block_start-=e.w_size,e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,n+=e.w_size,e.insert>e.strstart&&(e.insert=e.strstart)),n>e.strm.avail_in&&(n=e.strm.avail_in),n&&(Km(e.strm,e.window,e.strstart,n),e.strstart+=n,e.insert+=n>e.w_size-e.insert?e.w_size-e.insert:n),e.high_water<e.strstart&&(e.high_water=e.strstart),n=e.bi_valid+42>>3,n=e.pending_buf_size-n>65535?65535:e.pending_buf_size-n,s=n>e.w_size?e.w_size:n,a=e.strstart-e.block_start,(a>=s||(a||t===ym)&&t!==gm&&0===e.strm.avail_in&&a<=n)&&(r=a>n?n:a,i=t===ym&&0===e.strm.avail_in&&r===a?1:0,um(e,e.block_start,r,i),e.block_start+=r,qm(e.strm)),i?3:1)},Jm=(e,t)=>{let r,a;for(;;){if(e.lookahead<Fm){if(Ym(e),e.lookahead<Fm&&t===gm)return 1;if(0===e.lookahead)break}if(r=0,e.lookahead>=3&&(e.ins_h=Vm(e,e.ins_h,e.window[e.strstart+3-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==r&&e.strstart-r<=e.w_size-Fm&&(e.match_length=Qm(e,r)),e.match_length>=3)if(a=mm(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){e.match_length--;do{e.strstart++,e.ins_h=Vm(e,e.ins_h,e.window[e.strstart+3-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!==--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=Vm(e,e.ins_h,e.window[e.strstart+1]);else a=mm(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(a&&(Hm(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<2?e.strstart:2,t===ym?(Hm(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(Hm(e,!1),0===e.strm.avail_out)?1:2},Zm=(e,t)=>{let r,a,n;for(;;){if(e.lookahead<Fm){if(Ym(e),e.lookahead<Fm&&t===gm)return 1;if(0===e.lookahead)break}if(r=0,e.lookahead>=3&&(e.ins_h=Vm(e,e.ins_h,e.window[e.strstart+3-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==r&&e.prev_length<e.max_lazy_match&&e.strstart-r<=e.w_size-Fm&&(e.match_length=Qm(e,r),e.match_length<=5&&(e.strategy===_m||3===e.match_length&&e.strstart-e.match_start>4096)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){n=e.strstart+e.lookahead-3,a=mm(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=n&&(e.ins_h=Vm(e,e.ins_h,e.window[e.strstart+3-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!==--e.prev_length);if(e.match_available=0,e.match_length=2,e.strstart++,a&&(Hm(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if(a=mm(e,0,e.window[e.strstart-1]),a&&Hm(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(a=mm(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,t===ym?(Hm(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(Hm(e,!1),0===e.strm.avail_out)?1:2};function $m(e,t,r,a,n){this.good_length=e,this.max_lazy=t,this.nice_length=r,this.max_chain=a,this.func=n}const ef=[new $m(0,0,0,0,Xm),new $m(4,4,8,4,Jm),new $m(4,5,16,8,Jm),new $m(4,6,32,32,Jm),new $m(4,4,16,16,Zm),new $m(8,16,32,32,Zm),new $m(8,16,128,128,Zm),new $m(8,32,128,256,Zm),new $m(32,128,258,1024,Zm),new $m(32,258,258,4096,Zm)];function tf(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Dm,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),zm(this.dyn_ltree),zm(this.dyn_dtree),zm(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),zm(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(573),zm(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const rf=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.status!==Lm&&57!==t.status&&69!==t.status&&73!==t.status&&91!==t.status&&103!==t.status&&t.status!==Mm&&t.status!==Rm?1:0},af=e=>{if(rf(e))return Om(e,km);e.total_in=e.total_out=0,e.data_type=Tm;const t=e.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=2===t.wrap?57:t.wrap?Lm:Mm,e.adler=2===t.wrap?0:1,t.last_flush=-2,dm(t),bm},nf=e=>{const t=af(e);return t===bm&&(e=>{e.window_size=2*e.w_size,zm(e.head),e.max_lazy_match=ef[e.level].max_lazy,e.good_match=ef[e.level].good_length,e.nice_match=ef[e.level].nice_length,e.max_chain_length=ef[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=2,e.match_available=0,e.ins_h=0})(e.state),t},sf=(e,t,r,a,n,s)=>{if(!e)return km;let i=1;if(t===Sm&&(t=6),a<0?(i=0,a=-a):a>15&&(i=2,a-=16),n<1||n>9||r!==Dm||a<8||a>15||t<0||t>9||s<0||s>Cm||8===a&&1!==i)return Om(e,km);8===a&&(a=9);const o=new tf;return e.state=o,o.strm=e,o.status=Lm,o.wrap=i,o.gzhead=null,o.w_bits=a,o.w_size=1<<o.w_bits,o.w_mask=o.w_size-1,o.hash_bits=n+7,o.hash_size=1<<o.hash_bits,o.hash_mask=o.hash_size-1,o.hash_shift=~~((o.hash_bits+3-1)/3),o.window=new Uint8Array(2*o.w_size),o.head=new Uint16Array(o.hash_size),o.prev=new Uint16Array(o.w_size),o.lit_bufsize=1<<n+6,o.pending_buf_size=4*o.lit_bufsize,o.pending_buf=new Uint8Array(o.pending_buf_size),o.sym_buf=o.lit_bufsize,o.sym_end=3*(o.lit_bufsize-1),o.level=t,o.strategy=s,o.method=r,nf(e)};var of=(e,t)=>{if(rf(e)||t>vm||t<0)return e?Om(e,km):km;const r=e.state;if(!e.output||0!==e.avail_in&&!e.input||r.status===Rm&&t!==ym)return Om(e,0===e.avail_out?jm:km);const a=r.last_flush;if(r.last_flush=t,0!==r.pending){if(qm(e),0===e.avail_out)return r.last_flush=-1,bm}else if(0===e.avail_in&&Bm(t)<=Bm(a)&&t!==ym)return Om(e,jm);if(r.status===Rm&&0!==e.avail_in)return Om(e,jm);if(r.status===Lm&&0===r.wrap&&(r.status=Mm),r.status===Lm){let t=Dm+(r.w_bits-8<<4)<<8,a=-1;if(a=r.strategy>=Em||r.level<2?0:r.level<6?1:6===r.level?2:3,t|=a<<6,0!==r.strstart&&(t|=32),t+=31-t%31,Wm(r,t),0!==r.strstart&&(Wm(r,e.adler>>>16),Wm(r,65535&e.adler)),e.adler=1,r.status=Mm,qm(e),0!==r.pending)return r.last_flush=-1,bm}if(57===r.status)if(e.adler=0,Gm(r,31),Gm(r,139),Gm(r,8),r.gzhead)Gm(r,(r.gzhead.text?1:0)+(r.gzhead.hcrc?2:0)+(r.gzhead.extra?4:0)+(r.gzhead.name?8:0)+(r.gzhead.comment?16:0)),Gm(r,255&r.gzhead.time),Gm(r,r.gzhead.time>>8&255),Gm(r,r.gzhead.time>>16&255),Gm(r,r.gzhead.time>>24&255),Gm(r,9===r.level?2:r.strategy>=Em||r.level<2?4:0),Gm(r,255&r.gzhead.os),r.gzhead.extra&&r.gzhead.extra.length&&(Gm(r,255&r.gzhead.extra.length),Gm(r,r.gzhead.extra.length>>8&255)),r.gzhead.hcrc&&(e.adler=om(e.adler,r.pending_buf,r.pending,0)),r.gzindex=0,r.status=69;else if(Gm(r,0),Gm(r,0),Gm(r,0),Gm(r,0),Gm(r,0),Gm(r,9===r.level?2:r.strategy>=Em||r.level<2?4:0),Gm(r,3),r.status=Mm,qm(e),0!==r.pending)return r.last_flush=-1,bm;if(69===r.status){if(r.gzhead.extra){let t=r.pending,a=(65535&r.gzhead.extra.length)-r.gzindex;for(;r.pending+a>r.pending_buf_size;){let n=r.pending_buf_size-r.pending;if(r.pending_buf.set(r.gzhead.extra.subarray(r.gzindex,r.gzindex+n),r.pending),r.pending=r.pending_buf_size,r.gzhead.hcrc&&r.pending>t&&(e.adler=om(e.adler,r.pending_buf,r.pending-t,t)),r.gzindex+=n,qm(e),0!==r.pending)return r.last_flush=-1,bm;t=0,a-=n}let n=new Uint8Array(r.gzhead.extra);r.pending_buf.set(n.subarray(r.gzindex,r.gzindex+a),r.pending),r.pending+=a,r.gzhead.hcrc&&r.pending>t&&(e.adler=om(e.adler,r.pending_buf,r.pending-t,t)),r.gzindex=0}r.status=73}if(73===r.status){if(r.gzhead.name){let t,a=r.pending;do{if(r.pending===r.pending_buf_size){if(r.gzhead.hcrc&&r.pending>a&&(e.adler=om(e.adler,r.pending_buf,r.pending-a,a)),qm(e),0!==r.pending)return r.last_flush=-1,bm;a=0}t=r.gzindex<r.gzhead.name.length?255&r.gzhead.name.charCodeAt(r.gzindex++):0,Gm(r,t)}while(0!==t);r.gzhead.hcrc&&r.pending>a&&(e.adler=om(e.adler,r.pending_buf,r.pending-a,a)),r.gzindex=0}r.status=91}if(91===r.status){if(r.gzhead.comment){let t,a=r.pending;do{if(r.pending===r.pending_buf_size){if(r.gzhead.hcrc&&r.pending>a&&(e.adler=om(e.adler,r.pending_buf,r.pending-a,a)),qm(e),0!==r.pending)return r.last_flush=-1,bm;a=0}t=r.gzindex<r.gzhead.comment.length?255&r.gzhead.comment.charCodeAt(r.gzindex++):0,Gm(r,t)}while(0!==t);r.gzhead.hcrc&&r.pending>a&&(e.adler=om(e.adler,r.pending_buf,r.pending-a,a))}r.status=103}if(103===r.status){if(r.gzhead.hcrc){if(r.pending+2>r.pending_buf_size&&(qm(e),0!==r.pending))return r.last_flush=-1,bm;Gm(r,255&e.adler),Gm(r,e.adler>>8&255),e.adler=0}if(r.status=Mm,qm(e),0!==r.pending)return r.last_flush=-1,bm}if(0!==e.avail_in||0!==r.lookahead||t!==gm&&r.status!==Rm){let a=0===r.level?Xm(r,t):r.strategy===Em?((e,t)=>{let r;for(;;){if(0===e.lookahead&&(Ym(e),0===e.lookahead)){if(t===gm)return 1;break}if(e.match_length=0,r=mm(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,r&&(Hm(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===ym?(Hm(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(Hm(e,!1),0===e.strm.avail_out)?1:2})(r,t):r.strategy===Am?((e,t)=>{let r,a,n,s;const i=e.window;for(;;){if(e.lookahead<=Pm){if(Ym(e),e.lookahead<=Pm&&t===gm)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=3&&e.strstart>0&&(n=e.strstart-1,a=i[n],a===i[++n]&&a===i[++n]&&a===i[++n])){s=e.strstart+Pm;do{}while(a===i[++n]&&a===i[++n]&&a===i[++n]&&a===i[++n]&&a===i[++n]&&a===i[++n]&&a===i[++n]&&a===i[++n]&&n<s);e.match_length=Pm-(s-n),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=3?(r=mm(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(r=mm(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),r&&(Hm(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===ym?(Hm(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(Hm(e,!1),0===e.strm.avail_out)?1:2})(r,t):ef[r.level].func(r,t);if(3!==a&&4!==a||(r.status=Rm),1===a||3===a)return 0===e.avail_out&&(r.last_flush=-1),bm;if(2===a&&(t===pm?fm(r):t!==vm&&(um(r,0,0,!1),t===xm&&(zm(r.head),0===r.lookahead&&(r.strstart=0,r.block_start=0,r.insert=0))),qm(e),0===e.avail_out))return r.last_flush=-1,bm}return t!==ym?bm:r.wrap<=0?wm:(2===r.wrap?(Gm(r,255&e.adler),Gm(r,e.adler>>8&255),Gm(r,e.adler>>16&255),Gm(r,e.adler>>24&255),Gm(r,255&e.total_in),Gm(r,e.total_in>>8&255),Gm(r,e.total_in>>16&255),Gm(r,e.total_in>>24&255)):(Wm(r,e.adler>>>16),Wm(r,65535&e.adler)),qm(e),r.wrap>0&&(r.wrap=-r.wrap),0!==r.pending?bm:wm)},lf=(e,t)=>{let r=t.length;if(rf(e))return km;const a=e.state,n=a.wrap;if(2===n||1===n&&a.status!==Lm||a.lookahead)return km;if(1===n&&(e.adler=sm(e.adler,t,r,0)),a.wrap=0,r>=a.w_size){0===n&&(zm(a.head),a.strstart=0,a.block_start=0,a.insert=0);let e=new Uint8Array(a.w_size);e.set(t.subarray(r-a.w_size,r),0),t=e,r=a.w_size}const s=e.avail_in,i=e.next_in,o=e.input;for(e.avail_in=r,e.next_in=0,e.input=t,Ym(a);a.lookahead>=3;){let e=a.strstart,t=a.lookahead-2;do{a.ins_h=Vm(a,a.ins_h,a.window[e+3-1]),a.prev[e&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=e,e++}while(--t);a.strstart=e,a.lookahead=2,Ym(a)}return a.strstart+=a.lookahead,a.block_start=a.strstart,a.insert=a.lookahead,a.lookahead=0,a.match_length=a.prev_length=2,a.match_available=0,e.next_in=i,e.input=o,e.avail_in=s,a.wrap=n,bm},cf={deflateInit:(e,t)=>sf(e,t,Dm,15,8,Im),deflateInit2:sf,deflateReset:nf,deflateResetKeep:af,deflateSetHeader:(e,t)=>rf(e)||2!==e.state.wrap?km:(e.state.gzhead=t,bm),deflate:of,deflateEnd:e=>{if(rf(e))return km;const t=e.state.status;return e.state=null,t===Mm?Om(e,Nm):bm},deflateSetDictionary:lf,deflateInfo:"pako deflate (from Nodeca project)"};const df=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var uf=function(e){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const r=t.shift();if(r){if("object"!==typeof r)throw new TypeError(r+"must be non-object");for(const t in r)df(r,t)&&(e[t]=r[t])}}return e},hf=e=>{let t=0;for(let a=0,n=e.length;a<n;a++)t+=e[a].length;const r=new Uint8Array(t);for(let a=0,n=0,s=e.length;a<s;a++){let t=e[a];r.set(t,n),n+=t.length}return r};let mf=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(eE){mf=!1}const ff=new Uint8Array(256);for(let r=0;r<256;r++)ff[r]=r>=252?6:r>=248?5:r>=240?4:r>=224?3:r>=192?2:1;ff[254]=ff[254]=1;var gf=e=>{if("function"===typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(e);let t,r,a,n,s,i=e.length,o=0;for(n=0;n<i;n++)r=e.charCodeAt(n),55296===(64512&r)&&n+1<i&&(a=e.charCodeAt(n+1),56320===(64512&a)&&(r=65536+(r-55296<<10)+(a-56320),n++)),o+=r<128?1:r<2048?2:r<65536?3:4;for(t=new Uint8Array(o),s=0,n=0;s<o;n++)r=e.charCodeAt(n),55296===(64512&r)&&n+1<i&&(a=e.charCodeAt(n+1),56320===(64512&a)&&(r=65536+(r-55296<<10)+(a-56320),n++)),r<128?t[s++]=r:r<2048?(t[s++]=192|r>>>6,t[s++]=128|63&r):r<65536?(t[s++]=224|r>>>12,t[s++]=128|r>>>6&63,t[s++]=128|63&r):(t[s++]=240|r>>>18,t[s++]=128|r>>>12&63,t[s++]=128|r>>>6&63,t[s++]=128|63&r);return t},pf=(e,t)=>{const r=t||e.length;if("function"===typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(e.subarray(0,t));let a,n;const s=new Array(2*r);for(n=0,a=0;a<r;){let t=e[a++];if(t<128){s[n++]=t;continue}let i=ff[t];if(i>4)s[n++]=65533,a+=i-1;else{for(t&=2===i?31:3===i?15:7;i>1&&a<r;)t=t<<6|63&e[a++],i--;i>1?s[n++]=65533:t<65536?s[n++]=t:(t-=65536,s[n++]=55296|t>>10&1023,s[n++]=56320|1023&t)}}return((e,t)=>{if(t<65534&&e.subarray&&mf)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));let r="";for(let a=0;a<t;a++)r+=String.fromCharCode(e[a]);return r})(s,n)},xf=(e,t)=>{(t=t||e.length)>e.length&&(t=e.length);let r=t-1;for(;r>=0&&128===(192&e[r]);)r--;return r<0||0===r?t:r+ff[e[r]]>t?r:t};var yf=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};const vf=Object.prototype.toString,{Z_NO_FLUSH:bf,Z_SYNC_FLUSH:wf,Z_FULL_FLUSH:kf,Z_FINISH:Nf,Z_OK:jf,Z_STREAM_END:Sf,Z_DEFAULT_COMPRESSION:_f,Z_DEFAULT_STRATEGY:Ef,Z_DEFLATED:Af}=cm;function Cf(e){this.options=uf({level:_f,method:Af,chunkSize:16384,windowBits:15,memLevel:8,strategy:Ef},e||{});let t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new yf,this.strm.avail_out=0;let r=cf.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(r!==jf)throw new Error(lm[r]);if(t.header&&cf.deflateSetHeader(this.strm,t.header),t.dictionary){let e;if(e="string"===typeof t.dictionary?gf(t.dictionary):"[object ArrayBuffer]"===vf.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,r=cf.deflateSetDictionary(this.strm,e),r!==jf)throw new Error(lm[r]);this._dict_set=!0}}function If(e,t){const r=new Cf(t);if(r.push(e,!0),r.err)throw r.msg||lm[r.err];return r.result}Cf.prototype.push=function(e,t){const r=this.strm,a=this.options.chunkSize;let n,s;if(this.ended)return!1;for(s=t===~~t?t:!0===t?Nf:bf,"string"===typeof e?r.input=gf(e):"[object ArrayBuffer]"===vf.call(e)?r.input=new Uint8Array(e):r.input=e,r.next_in=0,r.avail_in=r.input.length;;)if(0===r.avail_out&&(r.output=new Uint8Array(a),r.next_out=0,r.avail_out=a),(s===wf||s===kf)&&r.avail_out<=6)this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;else{if(n=cf.deflate(r,s),n===Sf)return r.next_out>0&&this.onData(r.output.subarray(0,r.next_out)),n=cf.deflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===jf;if(0!==r.avail_out){if(s>0&&r.next_out>0)this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;else if(0===r.avail_in)break}else this.onData(r.output)}return!0},Cf.prototype.onData=function(e){this.chunks.push(e)},Cf.prototype.onEnd=function(e){e===jf&&(this.result=hf(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var Tf={Deflate:Cf,deflate:If,deflateRaw:function(e,t){return(t=t||{}).raw=!0,If(e,t)},gzip:function(e,t){return(t=t||{}).gzip=!0,If(e,t)},constants:cm};const Df=16209;var Pf=function(e,t){let r,a,n,s,i,o,l,c,d,u,h,m,f,g,p,x,y,v,b,w,k,N,j,S;const _=e.state;r=e.next_in,j=e.input,a=r+(e.avail_in-5),n=e.next_out,S=e.output,s=n-(t-e.avail_out),i=n+(e.avail_out-257),o=_.dmax,l=_.wsize,c=_.whave,d=_.wnext,u=_.window,h=_.hold,m=_.bits,f=_.lencode,g=_.distcode,p=(1<<_.lenbits)-1,x=(1<<_.distbits)-1;e:do{m<15&&(h+=j[r++]<<m,m+=8,h+=j[r++]<<m,m+=8),y=f[h&p];t:for(;;){if(v=y>>>24,h>>>=v,m-=v,v=y>>>16&255,0===v)S[n++]=65535&y;else{if(!(16&v)){if(0===(64&v)){y=f[(65535&y)+(h&(1<<v)-1)];continue t}if(32&v){_.mode=16191;break e}e.msg="invalid literal/length code",_.mode=Df;break e}b=65535&y,v&=15,v&&(m<v&&(h+=j[r++]<<m,m+=8),b+=h&(1<<v)-1,h>>>=v,m-=v),m<15&&(h+=j[r++]<<m,m+=8,h+=j[r++]<<m,m+=8),y=g[h&x];r:for(;;){if(v=y>>>24,h>>>=v,m-=v,v=y>>>16&255,!(16&v)){if(0===(64&v)){y=g[(65535&y)+(h&(1<<v)-1)];continue r}e.msg="invalid distance code",_.mode=Df;break e}if(w=65535&y,v&=15,m<v&&(h+=j[r++]<<m,m+=8,m<v&&(h+=j[r++]<<m,m+=8)),w+=h&(1<<v)-1,w>o){e.msg="invalid distance too far back",_.mode=Df;break e}if(h>>>=v,m-=v,v=n-s,w>v){if(v=w-v,v>c&&_.sane){e.msg="invalid distance too far back",_.mode=Df;break e}if(k=0,N=u,0===d){if(k+=l-v,v<b){b-=v;do{S[n++]=u[k++]}while(--v);k=n-w,N=S}}else if(d<v){if(k+=l+d-v,v-=d,v<b){b-=v;do{S[n++]=u[k++]}while(--v);if(k=0,d<b){v=d,b-=v;do{S[n++]=u[k++]}while(--v);k=n-w,N=S}}}else if(k+=d-v,v<b){b-=v;do{S[n++]=u[k++]}while(--v);k=n-w,N=S}for(;b>2;)S[n++]=N[k++],S[n++]=N[k++],S[n++]=N[k++],b-=3;b&&(S[n++]=N[k++],b>1&&(S[n++]=N[k++]))}else{k=n-w;do{S[n++]=S[k++],S[n++]=S[k++],S[n++]=S[k++],b-=3}while(b>2);b&&(S[n++]=S[k++],b>1&&(S[n++]=S[k++]))}break}}break}}while(r<a&&n<i);b=m>>3,r-=b,m-=b<<3,h&=(1<<m)-1,e.next_in=r,e.next_out=n,e.avail_in=r<a?a-r+5:5-(r-a),e.avail_out=n<i?i-n+257:257-(n-i),_.hold=h,_.bits=m};const Ff=15,Lf=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),Mf=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),Rf=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),Of=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var Bf=(e,t,r,a,n,s,i,o)=>{const l=o.bits;let c,d,u,h,m,f,g=0,p=0,x=0,y=0,v=0,b=0,w=0,k=0,N=0,j=0,S=null;const _=new Uint16Array(16),E=new Uint16Array(16);let A,C,I,T=null;for(g=0;g<=Ff;g++)_[g]=0;for(p=0;p<a;p++)_[t[r+p]]++;for(v=l,y=Ff;y>=1&&0===_[y];y--);if(v>y&&(v=y),0===y)return n[s++]=20971520,n[s++]=20971520,o.bits=1,0;for(x=1;x<y&&0===_[x];x++);for(v<x&&(v=x),k=1,g=1;g<=Ff;g++)if(k<<=1,k-=_[g],k<0)return-1;if(k>0&&(0===e||1!==y))return-1;for(E[1]=0,g=1;g<Ff;g++)E[g+1]=E[g]+_[g];for(p=0;p<a;p++)0!==t[r+p]&&(i[E[t[r+p]]++]=p);if(0===e?(S=T=i,f=20):1===e?(S=Lf,T=Mf,f=257):(S=Rf,T=Of,f=0),j=0,p=0,g=x,m=s,b=v,w=0,u=-1,N=1<<v,h=N-1,1===e&&N>852||2===e&&N>592)return 1;for(;;){A=g-w,i[p]+1<f?(C=0,I=i[p]):i[p]>=f?(C=T[i[p]-f],I=S[i[p]-f]):(C=96,I=0),c=1<<g-w,d=1<<b,x=d;do{d-=c,n[m+(j>>w)+d]=A<<24|C<<16|I}while(0!==d);for(c=1<<g-1;j&c;)c>>=1;if(0!==c?(j&=c-1,j+=c):j=0,p++,0===--_[g]){if(g===y)break;g=t[r+i[p]]}if(g>v&&(j&h)!==u){for(0===w&&(w=v),m+=x,b=g-w,k=1<<b;b+w<y&&(k-=_[b+w],!(k<=0));)b++,k<<=1;if(N+=1<<b,1===e&&N>852||2===e&&N>592)return 1;u=j&h,n[u]=v<<24|b<<16|m-s}}return 0!==j&&(n[m+j]=g-w<<24|64<<16),o.bits=v,0};const{Z_FINISH:zf,Z_BLOCK:Uf,Z_TREES:Vf,Z_OK:qf,Z_STREAM_END:Hf,Z_NEED_DICT:Gf,Z_STREAM_ERROR:Wf,Z_DATA_ERROR:Kf,Z_MEM_ERROR:Qf,Z_BUF_ERROR:Yf,Z_DEFLATED:Xf}=cm,Jf=16180,Zf=16190,$f=16191,eg=16192,tg=16194,rg=16199,ag=16200,ng=16206,sg=16209,ig=e=>(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24);function og(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const lg=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.mode<Jf||t.mode>16211?1:0},cg=e=>{if(lg(e))return Wf;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=Jf,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(852),t.distcode=t.distdyn=new Int32Array(592),t.sane=1,t.back=-1,qf},dg=e=>{if(lg(e))return Wf;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,cg(e)},ug=(e,t)=>{let r;if(lg(e))return Wf;const a=e.state;return t<0?(r=0,t=-t):(r=5+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?Wf:(null!==a.window&&a.wbits!==t&&(a.window=null),a.wrap=r,a.wbits=t,dg(e))},hg=(e,t)=>{if(!e)return Wf;const r=new og;e.state=r,r.strm=e,r.window=null,r.mode=Jf;const a=ug(e,t);return a!==qf&&(e.state=null),a};let mg,fg,gg=!0;const pg=e=>{if(gg){mg=new Int32Array(512),fg=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(Bf(1,e.lens,0,288,mg,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;Bf(2,e.lens,0,32,fg,0,e.work,{bits:5}),gg=!1}e.lencode=mg,e.lenbits=9,e.distcode=fg,e.distbits=5},xg=(e,t,r,a)=>{let n;const s=e.state;return null===s.window&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new Uint8Array(s.wsize)),a>=s.wsize?(s.window.set(t.subarray(r-s.wsize,r),0),s.wnext=0,s.whave=s.wsize):(n=s.wsize-s.wnext,n>a&&(n=a),s.window.set(t.subarray(r-a,r-a+n),s.wnext),(a-=n)?(s.window.set(t.subarray(r-a,r),0),s.wnext=a,s.whave=s.wsize):(s.wnext+=n,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=n))),0};var yg=(e,t)=>{let r,a,n,s,i,o,l,c,d,u,h,m,f,g,p,x,y,v,b,w,k,N,j=0;const S=new Uint8Array(4);let _,E;const A=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(lg(e)||!e.output||!e.input&&0!==e.avail_in)return Wf;r=e.state,r.mode===$f&&(r.mode=eg),i=e.next_out,n=e.output,l=e.avail_out,s=e.next_in,a=e.input,o=e.avail_in,c=r.hold,d=r.bits,u=o,h=l,N=qf;e:for(;;)switch(r.mode){case Jf:if(0===r.wrap){r.mode=eg;break}for(;d<16;){if(0===o)break e;o--,c+=a[s++]<<d,d+=8}if(2&r.wrap&&35615===c){0===r.wbits&&(r.wbits=15),r.check=0,S[0]=255&c,S[1]=c>>>8&255,r.check=om(r.check,S,2,0),c=0,d=0,r.mode=16181;break}if(r.head&&(r.head.done=!1),!(1&r.wrap)||(((255&c)<<8)+(c>>8))%31){e.msg="incorrect header check",r.mode=sg;break}if((15&c)!==Xf){e.msg="unknown compression method",r.mode=sg;break}if(c>>>=4,d-=4,k=8+(15&c),0===r.wbits&&(r.wbits=k),k>15||k>r.wbits){e.msg="invalid window size",r.mode=sg;break}r.dmax=1<<r.wbits,r.flags=0,e.adler=r.check=1,r.mode=512&c?16189:$f,c=0,d=0;break;case 16181:for(;d<16;){if(0===o)break e;o--,c+=a[s++]<<d,d+=8}if(r.flags=c,(255&r.flags)!==Xf){e.msg="unknown compression method",r.mode=sg;break}if(57344&r.flags){e.msg="unknown header flags set",r.mode=sg;break}r.head&&(r.head.text=c>>8&1),512&r.flags&&4&r.wrap&&(S[0]=255&c,S[1]=c>>>8&255,r.check=om(r.check,S,2,0)),c=0,d=0,r.mode=16182;case 16182:for(;d<32;){if(0===o)break e;o--,c+=a[s++]<<d,d+=8}r.head&&(r.head.time=c),512&r.flags&&4&r.wrap&&(S[0]=255&c,S[1]=c>>>8&255,S[2]=c>>>16&255,S[3]=c>>>24&255,r.check=om(r.check,S,4,0)),c=0,d=0,r.mode=16183;case 16183:for(;d<16;){if(0===o)break e;o--,c+=a[s++]<<d,d+=8}r.head&&(r.head.xflags=255&c,r.head.os=c>>8),512&r.flags&&4&r.wrap&&(S[0]=255&c,S[1]=c>>>8&255,r.check=om(r.check,S,2,0)),c=0,d=0,r.mode=16184;case 16184:if(1024&r.flags){for(;d<16;){if(0===o)break e;o--,c+=a[s++]<<d,d+=8}r.length=c,r.head&&(r.head.extra_len=c),512&r.flags&&4&r.wrap&&(S[0]=255&c,S[1]=c>>>8&255,r.check=om(r.check,S,2,0)),c=0,d=0}else r.head&&(r.head.extra=null);r.mode=16185;case 16185:if(1024&r.flags&&(m=r.length,m>o&&(m=o),m&&(r.head&&(k=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(a.subarray(s,s+m),k)),512&r.flags&&4&r.wrap&&(r.check=om(r.check,a,m,s)),o-=m,s+=m,r.length-=m),r.length))break e;r.length=0,r.mode=16186;case 16186:if(2048&r.flags){if(0===o)break e;m=0;do{k=a[s+m++],r.head&&k&&r.length<65536&&(r.head.name+=String.fromCharCode(k))}while(k&&m<o);if(512&r.flags&&4&r.wrap&&(r.check=om(r.check,a,m,s)),o-=m,s+=m,k)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=16187;case 16187:if(4096&r.flags){if(0===o)break e;m=0;do{k=a[s+m++],r.head&&k&&r.length<65536&&(r.head.comment+=String.fromCharCode(k))}while(k&&m<o);if(512&r.flags&&4&r.wrap&&(r.check=om(r.check,a,m,s)),o-=m,s+=m,k)break e}else r.head&&(r.head.comment=null);r.mode=16188;case 16188:if(512&r.flags){for(;d<16;){if(0===o)break e;o--,c+=a[s++]<<d,d+=8}if(4&r.wrap&&c!==(65535&r.check)){e.msg="header crc mismatch",r.mode=sg;break}c=0,d=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),e.adler=r.check=0,r.mode=$f;break;case 16189:for(;d<32;){if(0===o)break e;o--,c+=a[s++]<<d,d+=8}e.adler=r.check=ig(c),c=0,d=0,r.mode=Zf;case Zf:if(0===r.havedict)return e.next_out=i,e.avail_out=l,e.next_in=s,e.avail_in=o,r.hold=c,r.bits=d,Gf;e.adler=r.check=1,r.mode=$f;case $f:if(t===Uf||t===Vf)break e;case eg:if(r.last){c>>>=7&d,d-=7&d,r.mode=ng;break}for(;d<3;){if(0===o)break e;o--,c+=a[s++]<<d,d+=8}switch(r.last=1&c,c>>>=1,d-=1,3&c){case 0:r.mode=16193;break;case 1:if(pg(r),r.mode=rg,t===Vf){c>>>=2,d-=2;break e}break;case 2:r.mode=16196;break;case 3:e.msg="invalid block type",r.mode=sg}c>>>=2,d-=2;break;case 16193:for(c>>>=7&d,d-=7&d;d<32;){if(0===o)break e;o--,c+=a[s++]<<d,d+=8}if((65535&c)!==(c>>>16^65535)){e.msg="invalid stored block lengths",r.mode=sg;break}if(r.length=65535&c,c=0,d=0,r.mode=tg,t===Vf)break e;case tg:r.mode=16195;case 16195:if(m=r.length,m){if(m>o&&(m=o),m>l&&(m=l),0===m)break e;n.set(a.subarray(s,s+m),i),o-=m,s+=m,l-=m,i+=m,r.length-=m;break}r.mode=$f;break;case 16196:for(;d<14;){if(0===o)break e;o--,c+=a[s++]<<d,d+=8}if(r.nlen=257+(31&c),c>>>=5,d-=5,r.ndist=1+(31&c),c>>>=5,d-=5,r.ncode=4+(15&c),c>>>=4,d-=4,r.nlen>286||r.ndist>30){e.msg="too many length or distance symbols",r.mode=sg;break}r.have=0,r.mode=16197;case 16197:for(;r.have<r.ncode;){for(;d<3;){if(0===o)break e;o--,c+=a[s++]<<d,d+=8}r.lens[A[r.have++]]=7&c,c>>>=3,d-=3}for(;r.have<19;)r.lens[A[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,_={bits:r.lenbits},N=Bf(0,r.lens,0,19,r.lencode,0,r.work,_),r.lenbits=_.bits,N){e.msg="invalid code lengths set",r.mode=sg;break}r.have=0,r.mode=16198;case 16198:for(;r.have<r.nlen+r.ndist;){for(;j=r.lencode[c&(1<<r.lenbits)-1],p=j>>>24,x=j>>>16&255,y=65535&j,!(p<=d);){if(0===o)break e;o--,c+=a[s++]<<d,d+=8}if(y<16)c>>>=p,d-=p,r.lens[r.have++]=y;else{if(16===y){for(E=p+2;d<E;){if(0===o)break e;o--,c+=a[s++]<<d,d+=8}if(c>>>=p,d-=p,0===r.have){e.msg="invalid bit length repeat",r.mode=sg;break}k=r.lens[r.have-1],m=3+(3&c),c>>>=2,d-=2}else if(17===y){for(E=p+3;d<E;){if(0===o)break e;o--,c+=a[s++]<<d,d+=8}c>>>=p,d-=p,k=0,m=3+(7&c),c>>>=3,d-=3}else{for(E=p+7;d<E;){if(0===o)break e;o--,c+=a[s++]<<d,d+=8}c>>>=p,d-=p,k=0,m=11+(127&c),c>>>=7,d-=7}if(r.have+m>r.nlen+r.ndist){e.msg="invalid bit length repeat",r.mode=sg;break}for(;m--;)r.lens[r.have++]=k}}if(r.mode===sg)break;if(0===r.lens[256]){e.msg="invalid code -- missing end-of-block",r.mode=sg;break}if(r.lenbits=9,_={bits:r.lenbits},N=Bf(1,r.lens,0,r.nlen,r.lencode,0,r.work,_),r.lenbits=_.bits,N){e.msg="invalid literal/lengths set",r.mode=sg;break}if(r.distbits=6,r.distcode=r.distdyn,_={bits:r.distbits},N=Bf(2,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,_),r.distbits=_.bits,N){e.msg="invalid distances set",r.mode=sg;break}if(r.mode=rg,t===Vf)break e;case rg:r.mode=ag;case ag:if(o>=6&&l>=258){e.next_out=i,e.avail_out=l,e.next_in=s,e.avail_in=o,r.hold=c,r.bits=d,Pf(e,h),i=e.next_out,n=e.output,l=e.avail_out,s=e.next_in,a=e.input,o=e.avail_in,c=r.hold,d=r.bits,r.mode===$f&&(r.back=-1);break}for(r.back=0;j=r.lencode[c&(1<<r.lenbits)-1],p=j>>>24,x=j>>>16&255,y=65535&j,!(p<=d);){if(0===o)break e;o--,c+=a[s++]<<d,d+=8}if(x&&0===(240&x)){for(v=p,b=x,w=y;j=r.lencode[w+((c&(1<<v+b)-1)>>v)],p=j>>>24,x=j>>>16&255,y=65535&j,!(v+p<=d);){if(0===o)break e;o--,c+=a[s++]<<d,d+=8}c>>>=v,d-=v,r.back+=v}if(c>>>=p,d-=p,r.back+=p,r.length=y,0===x){r.mode=16205;break}if(32&x){r.back=-1,r.mode=$f;break}if(64&x){e.msg="invalid literal/length code",r.mode=sg;break}r.extra=15&x,r.mode=16201;case 16201:if(r.extra){for(E=r.extra;d<E;){if(0===o)break e;o--,c+=a[s++]<<d,d+=8}r.length+=c&(1<<r.extra)-1,c>>>=r.extra,d-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=16202;case 16202:for(;j=r.distcode[c&(1<<r.distbits)-1],p=j>>>24,x=j>>>16&255,y=65535&j,!(p<=d);){if(0===o)break e;o--,c+=a[s++]<<d,d+=8}if(0===(240&x)){for(v=p,b=x,w=y;j=r.distcode[w+((c&(1<<v+b)-1)>>v)],p=j>>>24,x=j>>>16&255,y=65535&j,!(v+p<=d);){if(0===o)break e;o--,c+=a[s++]<<d,d+=8}c>>>=v,d-=v,r.back+=v}if(c>>>=p,d-=p,r.back+=p,64&x){e.msg="invalid distance code",r.mode=sg;break}r.offset=y,r.extra=15&x,r.mode=16203;case 16203:if(r.extra){for(E=r.extra;d<E;){if(0===o)break e;o--,c+=a[s++]<<d,d+=8}r.offset+=c&(1<<r.extra)-1,c>>>=r.extra,d-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back",r.mode=sg;break}r.mode=16204;case 16204:if(0===l)break e;if(m=h-l,r.offset>m){if(m=r.offset-m,m>r.whave&&r.sane){e.msg="invalid distance too far back",r.mode=sg;break}m>r.wnext?(m-=r.wnext,f=r.wsize-m):f=r.wnext-m,m>r.length&&(m=r.length),g=r.window}else g=n,f=i-r.offset,m=r.length;m>l&&(m=l),l-=m,r.length-=m;do{n[i++]=g[f++]}while(--m);0===r.length&&(r.mode=ag);break;case 16205:if(0===l)break e;n[i++]=r.length,l--,r.mode=ag;break;case ng:if(r.wrap){for(;d<32;){if(0===o)break e;o--,c|=a[s++]<<d,d+=8}if(h-=l,e.total_out+=h,r.total+=h,4&r.wrap&&h&&(e.adler=r.check=r.flags?om(r.check,n,h,i-h):sm(r.check,n,h,i-h)),h=l,4&r.wrap&&(r.flags?c:ig(c))!==r.check){e.msg="incorrect data check",r.mode=sg;break}c=0,d=0}r.mode=16207;case 16207:if(r.wrap&&r.flags){for(;d<32;){if(0===o)break e;o--,c+=a[s++]<<d,d+=8}if(4&r.wrap&&c!==(4294967295&r.total)){e.msg="incorrect length check",r.mode=sg;break}c=0,d=0}r.mode=16208;case 16208:N=Hf;break e;case sg:N=Kf;break e;case 16210:return Qf;default:return Wf}return e.next_out=i,e.avail_out=l,e.next_in=s,e.avail_in=o,r.hold=c,r.bits=d,(r.wsize||h!==e.avail_out&&r.mode<sg&&(r.mode<ng||t!==zf))&&xg(e,e.output,e.next_out,h-e.avail_out),u-=e.avail_in,h-=e.avail_out,e.total_in+=u,e.total_out+=h,r.total+=h,4&r.wrap&&h&&(e.adler=r.check=r.flags?om(r.check,n,h,e.next_out-h):sm(r.check,n,h,e.next_out-h)),e.data_type=r.bits+(r.last?64:0)+(r.mode===$f?128:0)+(r.mode===rg||r.mode===tg?256:0),(0===u&&0===h||t===zf)&&N===qf&&(N=Yf),N},vg={inflateReset:dg,inflateReset2:ug,inflateResetKeep:cg,inflateInit:e=>hg(e,15),inflateInit2:hg,inflate:yg,inflateEnd:e=>{if(lg(e))return Wf;let t=e.state;return t.window&&(t.window=null),e.state=null,qf},inflateGetHeader:(e,t)=>{if(lg(e))return Wf;const r=e.state;return 0===(2&r.wrap)?Wf:(r.head=t,t.done=!1,qf)},inflateSetDictionary:(e,t)=>{const r=t.length;let a,n,s;return lg(e)?Wf:(a=e.state,0!==a.wrap&&a.mode!==Zf?Wf:a.mode===Zf&&(n=1,n=sm(n,t,r,0),n!==a.check)?Kf:(s=xg(e,t,r,r),s?(a.mode=16210,Qf):(a.havedict=1,qf)))},inflateInfo:"pako inflate (from Nodeca project)"};var bg=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1};const wg=Object.prototype.toString,{Z_NO_FLUSH:kg,Z_FINISH:Ng,Z_OK:jg,Z_STREAM_END:Sg,Z_NEED_DICT:_g,Z_STREAM_ERROR:Eg,Z_DATA_ERROR:Ag,Z_MEM_ERROR:Cg}=cm;function Ig(e){this.options=uf({chunkSize:65536,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0===(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new yf,this.strm.avail_out=0;let r=vg.inflateInit2(this.strm,t.windowBits);if(r!==jg)throw new Error(lm[r]);if(this.header=new bg,vg.inflateGetHeader(this.strm,this.header),t.dictionary&&("string"===typeof t.dictionary?t.dictionary=gf(t.dictionary):"[object ArrayBuffer]"===wg.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(r=vg.inflateSetDictionary(this.strm,t.dictionary),r!==jg)))throw new Error(lm[r])}function Tg(e,t){const r=new Ig(t);if(r.push(e),r.err)throw r.msg||lm[r.err];return r.result}Ig.prototype.push=function(e,t){const r=this.strm,a=this.options.chunkSize,n=this.options.dictionary;let s,i,o;if(this.ended)return!1;for(i=t===~~t?t:!0===t?Ng:kg,"[object ArrayBuffer]"===wg.call(e)?r.input=new Uint8Array(e):r.input=e,r.next_in=0,r.avail_in=r.input.length;;){for(0===r.avail_out&&(r.output=new Uint8Array(a),r.next_out=0,r.avail_out=a),s=vg.inflate(r,i),s===_g&&n&&(s=vg.inflateSetDictionary(r,n),s===jg?s=vg.inflate(r,i):s===Ag&&(s=_g));r.avail_in>0&&s===Sg&&r.state.wrap>0&&0!==e[r.next_in];)vg.inflateReset(r),s=vg.inflate(r,i);switch(s){case Eg:case Ag:case _g:case Cg:return this.onEnd(s),this.ended=!0,!1}if(o=r.avail_out,r.next_out&&(0===r.avail_out||s===Sg))if("string"===this.options.to){let e=xf(r.output,r.next_out),t=r.next_out-e,n=pf(r.output,e);r.next_out=t,r.avail_out=a-t,t&&r.output.set(r.output.subarray(e,e+t),0),this.onData(n)}else this.onData(r.output.length===r.next_out?r.output:r.output.subarray(0,r.next_out));if(s!==jg||0!==o){if(s===Sg)return s=vg.inflateEnd(this.strm),this.onEnd(s),this.ended=!0,!0;if(0===r.avail_in)break}}return!0},Ig.prototype.onData=function(e){this.chunks.push(e)},Ig.prototype.onEnd=function(e){e===jg&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=hf(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var Dg={Inflate:Ig,inflate:Tg,inflateRaw:function(e,t){return(t=t||{}).raw=!0,Tg(e,t)},ungzip:Tg,constants:cm};const{Deflate:Pg,deflate:Fg,deflateRaw:Lg,gzip:Mg}=Tf,{Inflate:Rg,inflate:Og,inflateRaw:Bg,ungzip:zg}=Dg;var Ug=Rg,Vg=Og;const qg=[];for(let r=0;r<256;r++){let e=r;for(let t=0;t<8;t++)1&e?e=3988292384^e>>>1:e>>>=1;qg[r]=e}const Hg=4294967295;function Gg(e,t){return(function(e,t,r){let a=e;for(let n=0;n<r;n++)a=qg[255&(a^t[n])]^a>>>8;return a}(Hg,e,t)^Hg)>>>0}function Wg(e,t,r){const a=e.readUint32(),n=Gg(new Uint8Array(e.buffer,e.byteOffset+e.offset-t-4,t),t);if(n!==a)throw new Error("CRC mismatch for chunk ".concat(r,". Expected ").concat(a,", found ").concat(n))}function Kg(e,t,r){for(let a=0;a<r;a++)t[a]=e[a]}function Qg(e,t,r,a){let n=0;for(;n<a;n++)t[n]=e[n];for(;n<r;n++)t[n]=e[n]+t[n-a]&255}function Yg(e,t,r,a){let n=0;if(0===r.length)for(;n<a;n++)t[n]=e[n];else for(;n<a;n++)t[n]=e[n]+r[n]&255}function Xg(e,t,r,a,n){let s=0;if(0===r.length){for(;s<n;s++)t[s]=e[s];for(;s<a;s++)t[s]=e[s]+(t[s-n]>>1)&255}else{for(;s<n;s++)t[s]=e[s]+(r[s]>>1)&255;for(;s<a;s++)t[s]=e[s]+(t[s-n]+r[s]>>1)&255}}function Jg(e,t,r,a,n){let s=0;if(0===r.length){for(;s<n;s++)t[s]=e[s];for(;s<a;s++)t[s]=e[s]+t[s-n]&255}else{for(;s<n;s++)t[s]=e[s]+r[s]&255;for(;s<a;s++)t[s]=e[s]+Zg(t[s-n],r[s],r[s-n])&255}}function Zg(e,t,r){const a=e+t-r,n=Math.abs(a-e),s=Math.abs(a-t),i=Math.abs(a-r);return n<=s&&n<=i?e:s<=i?t:r}function $g(e,t,r,a,n,s){switch(e){case 0:Kg(t,r,n);break;case 1:Qg(t,r,n,s);break;case 2:Yg(t,r,a,n);break;case 3:Xg(t,r,a,n,s);break;case 4:Jg(t,r,a,n,s);break;default:throw new Error("Unsupported filter: ".concat(e))}}const ep=new Uint16Array([255]),tp=255===new Uint8Array(ep.buffer)[0];function rp(e){return(255&e)<<8|e>>8&255}const ap=new Uint16Array([255]),np=255===new Uint8Array(ap.buffer)[0],sp=new Uint8Array(0);function ip(e){const{data:t,width:r,height:a,channels:n,depth:s}=e,i=Math.ceil(s/8)*n,o=Math.ceil(s/8*n*r),l=new Uint8Array(a*o);let c,d,u=sp,h=0;for(let m=0;m<a;m++){switch(c=t.subarray(h+1,h+1+o),d=l.subarray(m*o,(m+1)*o),t[h]){case 0:Kg(c,d,o);break;case 1:Qg(c,d,o,i);break;case 2:Yg(c,d,u,o);break;case 3:Xg(c,d,u,o,i);break;case 4:Jg(c,d,u,o,i);break;default:throw new Error("Unsupported filter: ".concat(t[h]))}u=d,h+=o+1}if(16===s){const e=new Uint16Array(l.buffer);if(np)for(let t=0;t<e.length;t++)e[t]=op(e[t]);return e}return l}function op(e){return(255&e)<<8|e>>8&255}const lp=Uint8Array.of(137,80,78,71,13,10,26,10);function cp(e){if(!function(e){if(e.length<lp.length)return!1;for(let t=0;t<lp.length;t++)if(e[t]!==lp[t])return!1;return!0}(e.readBytes(lp.length)))throw new Error("wrong PNG signature")}const dp="tEXt",up=new TextDecoder("latin1");function hp(e){if(fp(e),0===e.length||e.length>79)throw new Error("keyword length must be between 1 and 79")}const mp=/^[\u0000-\u00FF]*$/;function fp(e){if(!mp.test(e))throw new Error("invalid latin1 text")}function gp(e,t,r){const a=pp(t);e[a]=function(e,t){return up.decode(e.readBytes(t))}(t,r-a.length-1)}function pp(e){for(e.mark();0!==e.readByte(););const t=e.offset;e.reset();const r=up.decode(e.readBytes(t-e.offset-1));return e.skip(1),hp(r),r}const xp=-1,yp=0,vp=2,bp=3,wp=4,kp=6,Np=-1,jp=0,Sp=-1,_p=0,Ep=-1,Ap=0,Cp=1,Ip=0,Tp=1,Dp=2,Pp=0,Fp=1;class Lp extends xh{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(e),(0,hh.A)(this,"_checkCrc",void 0),(0,hh.A)(this,"_inflator",void 0),(0,hh.A)(this,"_png",void 0),(0,hh.A)(this,"_apng",void 0),(0,hh.A)(this,"_end",void 0),(0,hh.A)(this,"_hasPalette",void 0),(0,hh.A)(this,"_palette",void 0),(0,hh.A)(this,"_hasTransparency",void 0),(0,hh.A)(this,"_transparency",void 0),(0,hh.A)(this,"_compressionMethod",void 0),(0,hh.A)(this,"_filterMethod",void 0),(0,hh.A)(this,"_interlaceMethod",void 0),(0,hh.A)(this,"_colorType",void 0),(0,hh.A)(this,"_isAnimated",void 0),(0,hh.A)(this,"_numberOfFrames",void 0),(0,hh.A)(this,"_numberOfPlays",void 0),(0,hh.A)(this,"_frames",void 0),(0,hh.A)(this,"_writingDataChunks",void 0);const{checkCrc:r=!1}=t;this._checkCrc=r,this._inflator=new Ug,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=Np,this._filterMethod=Sp,this._interlaceMethod=Ep,this._colorType=xp,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(cp(this);!this._end;){const e=this.readUint32(),t=this.readChars(4);this.decodeChunk(e,t)}return this.decodeImage(),this._png}decodeApng(){for(cp(this);!this._end;){const e=this.readUint32(),t=this.readChars(4);this.decodeApngChunk(e,t)}return this.decodeApngImage(),this._apng}decodeChunk(e,t){const r=this.offset;switch(t){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(e);break;case"IDAT":this.decodeIDAT(e);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(e);break;case"iCCP":this.decodeiCCP(e);break;case dp:gp(this._png.text,this,e);break;case"pHYs":this.decodepHYs();break;default:this.skip(e)}if(this.offset-r!==e)throw new Error("Length mismatch while decoding chunk ".concat(t));this._checkCrc?Wg(this,e+4,t):this.skip(4)}decodeApngChunk(e,t){const r=this.offset;switch("fdAT"!==t&&"IDAT"!==t&&this._writingDataChunks&&this.pushDataToFrame(),t){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(e);break;default:this.decodeChunk(e,t),this.offset=r+e}if(this.offset-r!==e)throw new Error("Length mismatch while decoding chunk ".concat(t));this._checkCrc?Wg(this,e+4,t):this.skip(4)}decodeIHDR(){const e=this._png;e.width=this.readUint32(),e.height=this.readUint32(),e.depth=function(e){if(1!==e&&2!==e&&4!==e&&8!==e&&16!==e)throw new Error("invalid bit depth: ".concat(e));return e}(this.readUint8());const t=this.readUint8();let r;switch(this._colorType=t,t){case yp:r=1;break;case vp:r=3;break;case bp:r=1;break;case wp:r=2;break;case kp:r=4;break;default:throw new Error("Unknown color type: ".concat(t))}if(this._png.channels=r,this._compressionMethod=this.readUint8(),this._compressionMethod!==jp)throw new Error("Unsupported compression method: ".concat(this._compressionMethod));this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const e={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(e)}decodePLTE(e){if(e%3!==0)throw new RangeError("PLTE field length must be a multiple of 3. Got ".concat(e));const t=e/3;this._hasPalette=!0;const r=[];this._palette=r;for(let a=0;a<t;a++)r.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(e){this._writingDataChunks=!0;const t=e,r=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,r,t)),this._inflator.err)throw new Error("Error while decompressing the data: ".concat(this._inflator.err));this.skip(e)}decodeFDAT(e){this._writingDataChunks=!0;let t=e,r=this.offset+this.byteOffset;if(r+=4,t-=4,this._inflator.push(new Uint8Array(this.buffer,r,t)),this._inflator.err)throw new Error("Error while decompressing the data: ".concat(this._inflator.err));this.skip(e)}decodetRNS(e){switch(this._colorType){case yp:case vp:if(e%2!==0)throw new RangeError("tRNS chunk length must be a multiple of 2. Got ".concat(e));if(e/2>this._png.width*this._png.height)throw new Error("tRNS chunk contains more alpha values than there are pixels (".concat(e/2," vs ").concat(this._png.width*this._png.height,")"));this._hasTransparency=!0,this._transparency=new Uint16Array(e/2);for(let t=0;t<e/2;t++)this._transparency[t]=this.readUint16();break;case bp:{if(e>this._palette.length)throw new Error("tRNS chunk contains more alpha values than there are palette colors (".concat(e," vs ").concat(this._palette.length,")"));let t=0;for(;t<e;t++){const e=this.readByte();this._palette[t].push(e)}for(;t<this._palette.length;t++)this._palette[t].push(255);break}default:throw new Error("tRNS chunk is not supported for color type ".concat(this._colorType))}}decodeiCCP(e){const t=pp(this),r=this.readUint8();if(r!==jp)throw new Error("Unsupported iCCP compression method: ".concat(r));const a=this.readBytes(e-t.length-2);this._png.iccEmbeddedProfile={name:t,profile:Vg(a)}}decodepHYs(){const e=this.readUint32(),t=this.readUint32(),r=this.readByte();this._png.resolution={x:e,y:t,unit:r}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let e=0;e<this._numberOfFrames;e++){const t={sequenceNumber:this._frames[e].sequenceNumber,delayNumber:this._frames[e].delayNumber,delayDenominator:this._frames[e].delayDenominator,data:8===this._apng.depth?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},r=this._frames.at(e);if(r){if(r.data=ip({data:r.data,width:r.width,height:r.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),0===e||0===r.xOffset&&0===r.yOffset&&r.width===this._png.width&&r.height===this._png.height)t.data=r.data;else{const a=this._apng.frames.at(e-1);this.disposeFrame(r,a,t),this.addFrameDataToCanvas(t,r)}this._apng.frames.push(t)}}return this._apng}disposeFrame(e,t,r){switch(e.disposeOp){case Ip:break;case Tp:for(let t=0;t<this._png.height;t++)for(let a=0;a<this._png.width;a++){const n=(t*e.width+a)*this._png.channels;for(let e=0;e<this._png.channels;e++)r.data[n+e]=0}break;case Dp:r.data.set(t.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(e,t){const r=1<<this._png.depth,a=(e,r)=>({index:((e+t.yOffset)*this._png.width+t.xOffset+r)*this._png.channels,frameIndex:(e*t.width+r)*this._png.channels});switch(t.blendOp){case Pp:for(let r=0;r<t.height;r++)for(let n=0;n<t.width;n++){const{index:s,frameIndex:i}=a(r,n);for(let r=0;r<this._png.channels;r++)e.data[s+r]=t.data[i+r]}break;case Fp:for(let n=0;n<t.height;n++)for(let s=0;s<t.width;s++){const{index:i,frameIndex:o}=a(n,s);for(let a=0;a<this._png.channels;a++){const n=t.data[o+this._png.channels-1]/r,s=a%(this._png.channels-1)===0?1:t.data[o+a],l=Math.floor(n*s+(1-n)*e.data[i+a]);e.data[i+a]+=l}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){var e;if(this._inflator.err)throw new Error("Error while decompressing the data: ".concat(this._inflator.err));const t=this._isAnimated?(null===(e=this._frames)||void 0===e?void 0:e.at(0)).data:this._inflator.result;if(this._filterMethod!==_p)throw new Error("Filter method ".concat(this._filterMethod," not supported"));if(this._interlaceMethod===Ap)this._png.data=ip({data:t,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else{if(this._interlaceMethod!==Cp)throw new Error("Interlace method ".concat(this._interlaceMethod," not supported"));this._png.data=function(e){const{data:t,width:r,height:a,channels:n,depth:s}=e,i=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],o=Math.ceil(s/8)*n,l=new Uint8Array(a*r*o);let c=0;for(let d=0;d<7;d++){const e=i[d],n=Math.ceil((r-e.x)/e.xStep),s=Math.ceil((a-e.y)/e.yStep);if(n<=0||s<=0)continue;const u=n*o,h=new Uint8Array(u);for(let i=0;i<s;i++){const s=t[c++],d=t.subarray(c,c+u);c+=u;const m=new Uint8Array(u);$g(s,d,m,h,u,o),h.set(m);for(let t=0;t<n;t++){const n=e.x+t*e.xStep,s=e.y+i*e.yStep;if(!(n>=r||s>=a))for(let e=0;e<o;e++)l[(s*r+n)*o+e]=m[t*o+e]}}}if(16===s){const e=new Uint16Array(l.buffer);if(tp)for(let t=0;t<e.length;t++)e[t]=rp(e[t]);return e}return l}({data:t,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth})}this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const e=this._inflator.result,t=this._frames.at(-1);t?t.data=e:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:Ip,blendOp:Pp,data:e}),this._inflator=new Ug,this._writingDataChunks=!1}}var Mp;!function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.METRE=1]="METRE"}(Mp||(Mp={}));var Rp=function(){return"undefined"!=typeof window?window:"undefined"!=typeof r.g?r.g:"undefined"!=typeof self?self:this}();function Op(){Rp.console&&"function"==typeof Rp.console.log&&Rp.console.log.apply(Rp.console,arguments)}var Bp={log:Op,warn:function(e){Rp.console&&("function"==typeof Rp.console.warn?Rp.console.warn.apply(Rp.console,arguments):Op.call(null,arguments))},error:function(e){Rp.console&&("function"==typeof Rp.console.error?Rp.console.error.apply(Rp.console,arguments):Op(e))}};function zp(e,t,r){var a=new XMLHttpRequest;a.open("GET",e),a.responseType="blob",a.onload=function(){qp(a.response,t,r)},a.onerror=function(){Bp.error("could not download file")},a.send()}function Up(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(r){}return t.status>=200&&t.status<=299}function Vp(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(r){var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var qp=Rp.saveAs||("object"!==("undefined"==typeof window?"undefined":(0,ju.A)(window))||window!==Rp?function(){}:"undefined"!=typeof HTMLAnchorElement&&"download"in HTMLAnchorElement.prototype?function(e,t,r){var a=Rp.URL||Rp.webkitURL,n=document.createElement("a");t=t||e.name||"download",n.download=t,n.rel="noopener","string"==typeof e?(n.href=e,n.origin!==location.origin?Up(n.href)?zp(e,t,r):Vp(n,n.target="_blank"):Vp(n)):(n.href=a.createObjectURL(e),setTimeout(function(){a.revokeObjectURL(n.href)},4e4),setTimeout(function(){Vp(n)},0))}:"msSaveOrOpenBlob"in navigator?function(e,t,r){if(t=t||e.name||"download","string"==typeof e)if(Up(e))zp(e,t,r);else{var a=document.createElement("a");a.href=e,a.target="_blank",setTimeout(function(){Vp(a)})}else navigator.msSaveOrOpenBlob(function(e,t){return void 0===t?t={autoBom:!1}:"object"!==(0,ju.A)(t)&&(Bp.warn("Deprecated: Expected third argument to be a object"),t={autoBom:!t}),t.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob([String.fromCharCode(65279),e],{type:e.type}):e}(e,r),t)}:function(e,t,r,a){if((a=a||open("","_blank"))&&(a.document.title=a.document.body.innerText="downloading..."),"string"==typeof e)return zp(e,t,r);var n="application/octet-stream"===e.type,s=/constructor/i.test(Rp.HTMLElement)||Rp.safari,i=/CriOS\/[\d]+/.test(navigator.userAgent);if((i||n&&s)&&"object"===("undefined"==typeof FileReader?"undefined":(0,ju.A)(FileReader))){var o=new FileReader;o.onloadend=function(){var e=o.result;e=i?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),a?a.location.href=e:location=e,a=null},o.readAsDataURL(e)}else{var l=Rp.URL||Rp.webkitURL,c=l.createObjectURL(e);a?a.location=c:location.href=c,a=null,setTimeout(function(){l.revokeObjectURL(c)},4e4)}});function Hp(e){var t;e=e||"",this.ok=!1,"#"==e.charAt(0)&&(e=e.substr(1,6)),e={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[e=(e=e.replace(/ /g,"")).toLowerCase()]||e;for(var r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(e){return[parseInt(e[1]),parseInt(e[2]),parseInt(e[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(e){return[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(e){return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)]}}],a=0;a<r.length;a++){var n=r[a].re,s=r[a].process,i=n.exec(e);i&&(t=s(i),this.r=t[0],this.g=t[1],this.b=t[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var e=this.r.toString(16),t=this.g.toString(16),r=this.b.toString(16);return 1==e.length&&(e="0"+e),1==t.length&&(t="0"+t),1==r.length&&(r="0"+r),"#"+e+t+r}}var Gp=Rp.atob.bind(Rp),Wp=Rp.btoa.bind(Rp);function Kp(e,t){var r=e[0],a=e[1],n=e[2],s=e[3];r=Yp(r,a,n,s,t[0],7,-680876936),s=Yp(s,r,a,n,t[1],12,-389564586),n=Yp(n,s,r,a,t[2],17,606105819),a=Yp(a,n,s,r,t[3],22,-1044525330),r=Yp(r,a,n,s,t[4],7,-176418897),s=Yp(s,r,a,n,t[5],12,1200080426),n=Yp(n,s,r,a,t[6],17,-1473231341),a=Yp(a,n,s,r,t[7],22,-45705983),r=Yp(r,a,n,s,t[8],7,1770035416),s=Yp(s,r,a,n,t[9],12,-1958414417),n=Yp(n,s,r,a,t[10],17,-42063),a=Yp(a,n,s,r,t[11],22,-1990404162),r=Yp(r,a,n,s,t[12],7,1804603682),s=Yp(s,r,a,n,t[13],12,-40341101),n=Yp(n,s,r,a,t[14],17,-1502002290),r=Xp(r,a=Yp(a,n,s,r,t[15],22,1236535329),n,s,t[1],5,-165796510),s=Xp(s,r,a,n,t[6],9,-1069501632),n=Xp(n,s,r,a,t[11],14,643717713),a=Xp(a,n,s,r,t[0],20,-373897302),r=Xp(r,a,n,s,t[5],5,-701558691),s=Xp(s,r,a,n,t[10],9,38016083),n=Xp(n,s,r,a,t[15],14,-660478335),a=Xp(a,n,s,r,t[4],20,-405537848),r=Xp(r,a,n,s,t[9],5,568446438),s=Xp(s,r,a,n,t[14],9,-1019803690),n=Xp(n,s,r,a,t[3],14,-187363961),a=Xp(a,n,s,r,t[8],20,1163531501),r=Xp(r,a,n,s,t[13],5,-1444681467),s=Xp(s,r,a,n,t[2],9,-51403784),n=Xp(n,s,r,a,t[7],14,1735328473),r=Jp(r,a=Xp(a,n,s,r,t[12],20,-1926607734),n,s,t[5],4,-378558),s=Jp(s,r,a,n,t[8],11,-2022574463),n=Jp(n,s,r,a,t[11],16,1839030562),a=Jp(a,n,s,r,t[14],23,-35309556),r=Jp(r,a,n,s,t[1],4,-1530992060),s=Jp(s,r,a,n,t[4],11,1272893353),n=Jp(n,s,r,a,t[7],16,-155497632),a=Jp(a,n,s,r,t[10],23,-1094730640),r=Jp(r,a,n,s,t[13],4,681279174),s=Jp(s,r,a,n,t[0],11,-358537222),n=Jp(n,s,r,a,t[3],16,-722521979),a=Jp(a,n,s,r,t[6],23,76029189),r=Jp(r,a,n,s,t[9],4,-640364487),s=Jp(s,r,a,n,t[12],11,-421815835),n=Jp(n,s,r,a,t[15],16,530742520),r=Zp(r,a=Jp(a,n,s,r,t[2],23,-995338651),n,s,t[0],6,-198630844),s=Zp(s,r,a,n,t[7],10,1126891415),n=Zp(n,s,r,a,t[14],15,-1416354905),a=Zp(a,n,s,r,t[5],21,-57434055),r=Zp(r,a,n,s,t[12],6,1700485571),s=Zp(s,r,a,n,t[3],10,-1894986606),n=Zp(n,s,r,a,t[10],15,-1051523),a=Zp(a,n,s,r,t[1],21,-2054922799),r=Zp(r,a,n,s,t[8],6,1873313359),s=Zp(s,r,a,n,t[15],10,-30611744),n=Zp(n,s,r,a,t[6],15,-1560198380),a=Zp(a,n,s,r,t[13],21,1309151649),r=Zp(r,a,n,s,t[4],6,-145523070),s=Zp(s,r,a,n,t[11],10,-1120210379),n=Zp(n,s,r,a,t[2],15,718787259),a=Zp(a,n,s,r,t[9],21,-343485551),e[0]=ix(r,e[0]),e[1]=ix(a,e[1]),e[2]=ix(n,e[2]),e[3]=ix(s,e[3])}function Qp(e,t,r,a,n,s){return t=ix(ix(t,e),ix(a,s)),ix(t<<n|t>>>32-n,r)}function Yp(e,t,r,a,n,s,i){return Qp(t&r|~t&a,e,t,n,s,i)}function Xp(e,t,r,a,n,s,i){return Qp(t&a|r&~a,e,t,n,s,i)}function Jp(e,t,r,a,n,s,i){return Qp(t^r^a,e,t,n,s,i)}function Zp(e,t,r,a,n,s,i){return Qp(r^(t|~a),e,t,n,s,i)}function $p(e){var t,r=e.length,a=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=e.length;t+=64)Kp(a,ex(e.substring(t-64,t)));e=e.substring(t-64);var n=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<e.length;t++)n[t>>2]|=e.charCodeAt(t)<<(t%4<<3);if(n[t>>2]|=128<<(t%4<<3),t>55)for(Kp(a,n),t=0;t<16;t++)n[t]=0;return n[14]=8*r,Kp(a,n),a}function ex(e){var t,r=[];for(t=0;t<64;t+=4)r[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return r}var tx="0123456789abcdef".split("");function rx(e){for(var t="",r=0;r<4;r++)t+=tx[e>>8*r+4&15]+tx[e>>8*r&15];return t}function ax(e){return String.fromCharCode(255&e,(65280&e)>>8,(16711680&e)>>16,(4278190080&e)>>24)}function nx(e){return $p(e).map(ax).join("")}var sx="5d41402abc4b2a76b9719d911017c592"!=function(e){for(var t=0;t<e.length;t++)e[t]=rx(e[t]);return e.join("")}($p("hello"));function ix(e,t){if(sx){var r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}return e+t&4294967295}function ox(e,t){var r,a,n,s;if(e!==r){for(var i=(n=e,s=1+(256/e.length|0),new Array(s+1).join(n)),o=[],l=0;l<256;l++)o[l]=l;var c=0;for(l=0;l<256;l++){var d=o[l];c=(c+d+i.charCodeAt(l))%256,o[l]=o[c],o[c]=d}r=e,a=o}else o=a;var u=t.length,h=0,m=0,f="";for(l=0;l<u;l++)m=(m+(d=o[h=(h+1)%256]))%256,o[h]=o[m],o[m]=d,i=o[(o[h]+o[m])%256],f+=String.fromCharCode(t.charCodeAt(l)^i);return f}var lx={print:4,modify:8,copy:16,"annot-forms":32};function cx(e,t,r,a){this.v=1,this.r=2;var n=192;e.forEach(function(e){if(void 0!==lx.perm)throw new Error("Invalid permission: "+e);n+=lx[e]}),this.padding="(\xbfN^Nu\x8aAd\0NV\xff\xfa\x01\b..\0\xb6\xd0h>\x80/\f\xa9\xfedSiz";var s=(t+this.padding).substr(0,32),i=(r+this.padding).substr(0,32);this.O=this.processOwnerPassword(s,i),this.P=-(1+(255^n)),this.encryptionKey=nx(s+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(a)).substr(0,5),this.U=ox(this.encryptionKey,this.padding)}function dx(e){if(/[^\u0000-\u00ff]/.test(e))throw new Error("Invalid PDF Name Object: "+e+", Only accept ASCII characters.");for(var t="",r=e.length,a=0;a<r;a++){var n=e.charCodeAt(a);t+=n<33||35===n||37===n||40===n||41===n||47===n||60===n||62===n||91===n||93===n||123===n||125===n||n>126?"#"+("0"+n.toString(16)).slice(-2):e[a]}return t}function ux(e){if("object"!==(0,ju.A)(e))throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var t={};this.subscribe=function(e,r,a){if(a=a||!1,"string"!=typeof e||"function"!=typeof r||"boolean"!=typeof a)throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");t.hasOwnProperty(e)||(t[e]={});var n=Math.random().toString(35);return t[e][n]=[r,!!a],n},this.unsubscribe=function(e){for(var r in t)if(t[r][e])return delete t[r][e],0===Object.keys(t[r]).length&&delete t[r],!0;return!1},this.publish=function(r){if(t.hasOwnProperty(r)){var a=Array.prototype.slice.call(arguments,1),n=[];for(var s in t[r]){var i=t[r][s];try{i[0].apply(e,a)}catch(Vp){Rp.console&&Bp.error("jsPDF PubSub Error",Vp.message,Vp)}i[1]&&n.push(s)}n.length&&n.forEach(this.unsubscribe)}},this.getTopics=function(){return t}}function hx(e){if(!(this instanceof hx))return new hx(e);var t="opacity,stroke-opacity".split(",");for(var r in e)e.hasOwnProperty(r)&&t.indexOf(r)>=0&&(this[r]=e[r]);this.id="",this.objectNumber=-1}function mx(e,t){this.gState=e,this.matrix=t,this.id="",this.objectNumber=-1}function fx(e,t,r,a,n){if(!(this instanceof fx))return new fx(e,t,r,a,n);this.type="axial"===e?2:3,this.coords=t,this.colors=r,mx.call(this,a,n)}function gx(e,t,r,a,n){if(!(this instanceof gx))return new gx(e,t,r,a,n);this.boundingBox=e,this.xStep=t,this.yStep=r,this.stream="",this.cloneIndex=0,mx.call(this,a,n)}function px(e){var t,r="string"==typeof arguments[0]?arguments[0]:"p",a=arguments[1],n=arguments[2],s=arguments[3],i=[],o=1,l=16,c="S",d=null;"object"===(0,ju.A)(e=e||{})&&(r=e.orientation,a=e.unit||a,n=e.format||n,s=e.compress||e.compressPdf||s,null!==(d=e.encryption||null)&&(d.userPassword=d.userPassword||"",d.ownerPassword=d.ownerPassword||"",d.userPermissions=d.userPermissions||[]),o="number"==typeof e.userUnit?Math.abs(e.userUnit):1,void 0!==e.precision&&(t=e.precision),void 0!==e.floatPrecision&&(l=e.floatPrecision),c=e.defaultPathOperation||"S"),i=e.filters||(!0===s?["FlateEncode"]:i),a=a||"mm",r=(""+(r||"P")).toLowerCase();var u=e.putOnlyUsedFonts||!1,h={},m={internal:{},__private__:{}};m.__private__.PubSub=ux;var f="1.3",g=m.__private__.getPdfVersion=function(){return f};m.__private__.setPdfVersion=function(e){f=e};var p={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};m.__private__.getPageFormats=function(){return p};var x=m.__private__.getPageFormat=function(e){return p[e]};n=n||"a4";var y="compat",v="advanced",b=y;function w(){this.saveGraphicsState(),J(new Te(he,0,0,-he,0,hr()*he).toString()+" cm"),this.setFontSize(this.getFontSize()/he),c="n",b=v}function k(){this.restoreGraphicsState(),c="S",b=y}var N=m.__private__.combineFontStyleAndFontWeight=function(e,t){if("bold"==e&&"normal"==t||"bold"==e&&400==t||"normal"==e&&"italic"==t||"bold"==e&&"italic"==t)throw new Error("Invalid Combination of fontweight and fontstyle");return t&&(e=400==t||"normal"===t?"italic"===e?"italic":"normal":700!=t&&"bold"!==t||"normal"!==e?(700==t?"bold":t)+""+e:"bold"),e};m.advancedAPI=function(e){var t=b===y;return t&&w.call(this),"function"!=typeof e||(e(this),t&&k.call(this)),this},m.compatAPI=function(e){var t=b===v;return t&&k.call(this),"function"!=typeof e||(e(this),t&&w.call(this)),this},m.isAdvancedAPI=function(){return b===v};var j,S=function(e){if(b!==v)throw new Error(e+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},_=m.roundToPrecision=m.__private__.roundToPrecision=function(e,r){var a=t||r;if(isNaN(e)||isNaN(a))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return e.toFixed(a).replace(/0+$/,"")};j=m.hpf=m.__private__.hpf="number"==typeof l?function(e){if(isNaN(e))throw new Error("Invalid argument passed to jsPDF.hpf");return _(e,l)}:"smart"===l?function(e){if(isNaN(e))throw new Error("Invalid argument passed to jsPDF.hpf");return _(e,e>-1&&e<1?16:5)}:function(e){if(isNaN(e))throw new Error("Invalid argument passed to jsPDF.hpf");return _(e,16)};var E=m.f2=m.__private__.f2=function(e){if(isNaN(e))throw new Error("Invalid argument passed to jsPDF.f2");return _(e,2)},A=m.__private__.f3=function(e){if(isNaN(e))throw new Error("Invalid argument passed to jsPDF.f3");return _(e,3)},C=m.scale=m.__private__.scale=function(e){if(isNaN(e))throw new Error("Invalid argument passed to jsPDF.scale");return b===y?e*he:b===v?e:void 0},I=function(e){return C(function(e){return b===y?hr()-e:b===v?e:void 0}(e))};m.__private__.setPrecision=m.setPrecision=function(e){"number"==typeof parseInt(e,10)&&(t=parseInt(e,10))};var T,D="00000000000000000000000000000000",P=m.__private__.getFileId=function(){return D},F=m.__private__.setFileId=function(e){return D=void 0!==e&&/^[a-fA-F0-9]{32}$/.test(e)?e.toUpperCase():D.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),null!==d&&(yt=new cx(d.userPermissions,d.userPassword,d.ownerPassword,D)),D};m.setFileId=function(e){return F(e),this},m.getFileId=function(){return P()};var L=m.__private__.convertDateToPDFDate=function(e){var t=e.getTimezoneOffset(),r=t<0?"+":"-",a=Math.floor(Math.abs(t/60)),n=Math.abs(t%60),s=[r,z(a),"'",z(n),"'"].join("");return["D:",e.getFullYear(),z(e.getMonth()+1),z(e.getDate()),z(e.getHours()),z(e.getMinutes()),z(e.getSeconds()),s].join("")},M=m.__private__.convertPDFDateToDate=function(e){var t=parseInt(e.substr(2,4),10),r=parseInt(e.substr(6,2),10)-1,a=parseInt(e.substr(8,2),10),n=parseInt(e.substr(10,2),10),s=parseInt(e.substr(12,2),10),i=parseInt(e.substr(14,2),10);return new Date(t,r,a,n,s,i,0)},R=m.__private__.setCreationDate=function(e){var t;if(void 0===e&&(e=new Date),e instanceof Date)t=L(e);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(e))throw new Error("Invalid argument passed to jsPDF.setCreationDate");t=e}return T=t},O=m.__private__.getCreationDate=function(e){var t=T;return"jsDate"===e&&(t=M(T)),t};m.setCreationDate=function(e){return R(e),this},m.getCreationDate=function(e){return O(e)};var B,z=m.__private__.padd2=function(e){return("0"+parseInt(e)).slice(-2)},U=m.__private__.padd2Hex=function(e){return("00"+(e=e.toString())).substr(e.length)},V=0,q=[],H=[],G=0,W=[],K=[],Q=!1,Y=H;m.__private__.setCustomOutputDestination=function(e){Q=!0,Y=e};var X=function(e){Q||(Y=e)};m.__private__.resetCustomOutputDestination=function(){Q=!1,Y=H};var J=m.__private__.out=function(e){return e=e.toString(),G+=e.length+1,Y.push(e),Y},Z=m.__private__.write=function(e){return J(1===arguments.length?e.toString():Array.prototype.join.call(arguments," "))},$=m.__private__.getArrayBuffer=function(e){for(var t=e.length,r=new ArrayBuffer(t),a=new Uint8Array(r);t--;)a[t]=e.charCodeAt(t);return r},ee=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];m.__private__.getStandardFonts=function(){return ee};var te=e.fontSize||16;m.__private__.setFontSize=m.setFontSize=function(e){return te=b===v?e/he:e,this};var re,ae=m.__private__.getFontSize=m.getFontSize=function(){return b===y?te:te*he},ne=e.R2L||!1;m.__private__.setR2L=m.setR2L=function(e){return ne=e,this},m.__private__.getR2L=m.getR2L=function(){return ne};var se,ie=m.__private__.setZoomMode=function(e){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(e))re=e;else if(isNaN(e)){if(-1===[void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(e))throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+e+'" is not recognized.');re=e}else re=parseInt(e,10)};m.__private__.getZoomMode=function(){return re};var oe,le=m.__private__.setPageMode=function(e){if(-1==[void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(e))throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+e+'" is not recognized.');se=e};m.__private__.getPageMode=function(){return se};var ce=m.__private__.setLayoutMode=function(e){if(-1==[void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(e))throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+e+'" is not recognized.');oe=e};m.__private__.getLayoutMode=function(){return oe},m.__private__.setDisplayMode=m.setDisplayMode=function(e,t,r){return ie(e),ce(t),le(r),this};var de={title:"",subject:"",author:"",keywords:"",creator:""};m.__private__.getDocumentProperty=function(e){if(-1===Object.keys(de).indexOf(e))throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return de[e]},m.__private__.getDocumentProperties=function(){return de},m.__private__.setDocumentProperties=m.setProperties=m.setDocumentProperties=function(e){for(var t in de)de.hasOwnProperty(t)&&e[t]&&(de[t]=e[t]);return this},m.__private__.setDocumentProperty=function(e,t){if(-1===Object.keys(de).indexOf(e))throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return de[e]=t};var ue,he,me,fe,ge,pe={},xe={},ye=[],ve={},be={},we={},ke={},Ne=null,je=0,Se=[],_e=new ux(m),Ee=e.hotfixes||[],Ae={},Ce={},Ie=[],Te=function e(t,r,a,n,s,i){if(!(this instanceof e))return new e(t,r,a,n,s,i);isNaN(t)&&(t=1),isNaN(r)&&(r=0),isNaN(a)&&(a=0),isNaN(n)&&(n=1),isNaN(s)&&(s=0),isNaN(i)&&(i=0),this._matrix=[t,r,a,n,s,i]};Object.defineProperty(Te.prototype,"sx",{get:function(){return this._matrix[0]},set:function(e){this._matrix[0]=e}}),Object.defineProperty(Te.prototype,"shy",{get:function(){return this._matrix[1]},set:function(e){this._matrix[1]=e}}),Object.defineProperty(Te.prototype,"shx",{get:function(){return this._matrix[2]},set:function(e){this._matrix[2]=e}}),Object.defineProperty(Te.prototype,"sy",{get:function(){return this._matrix[3]},set:function(e){this._matrix[3]=e}}),Object.defineProperty(Te.prototype,"tx",{get:function(){return this._matrix[4]},set:function(e){this._matrix[4]=e}}),Object.defineProperty(Te.prototype,"ty",{get:function(){return this._matrix[5]},set:function(e){this._matrix[5]=e}}),Object.defineProperty(Te.prototype,"a",{get:function(){return this._matrix[0]},set:function(e){this._matrix[0]=e}}),Object.defineProperty(Te.prototype,"b",{get:function(){return this._matrix[1]},set:function(e){this._matrix[1]=e}}),Object.defineProperty(Te.prototype,"c",{get:function(){return this._matrix[2]},set:function(e){this._matrix[2]=e}}),Object.defineProperty(Te.prototype,"d",{get:function(){return this._matrix[3]},set:function(e){this._matrix[3]=e}}),Object.defineProperty(Te.prototype,"e",{get:function(){return this._matrix[4]},set:function(e){this._matrix[4]=e}}),Object.defineProperty(Te.prototype,"f",{get:function(){return this._matrix[5]},set:function(e){this._matrix[5]=e}}),Object.defineProperty(Te.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(Te.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(Te.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(Te.prototype,"isIdentity",{get:function(){return 1===this.sx&&0===this.shy&&0===this.shx&&1===this.sy&&0===this.tx&&0===this.ty}}),Te.prototype.join=function(e){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(j).join(e)},Te.prototype.multiply=function(e){var t=e.sx*this.sx+e.shy*this.shx,r=e.sx*this.shy+e.shy*this.sy,a=e.shx*this.sx+e.sy*this.shx,n=e.shx*this.shy+e.sy*this.sy,s=e.tx*this.sx+e.ty*this.shx+this.tx,i=e.tx*this.shy+e.ty*this.sy+this.ty;return new Te(t,r,a,n,s,i)},Te.prototype.decompose=function(){var e=this.sx,t=this.shy,r=this.shx,a=this.sy,n=this.tx,s=this.ty,i=Math.sqrt(e*e+t*t),o=(e/=i)*r+(t/=i)*a;r-=e*o,a-=t*o;var l=Math.sqrt(r*r+a*a);return o/=l,e*(a/=l)<t*(r/=l)&&(e=-e,t=-t,o=-o,i=-i),{scale:new Te(i,0,0,l,0,0),translate:new Te(1,0,0,1,n,s),rotate:new Te(e,t,-t,e,0,0),skew:new Te(1,0,o,1,0,0)}},Te.prototype.toString=function(e){return this.join(" ")},Te.prototype.inversed=function(){var e=this.sx,t=this.shy,r=this.shx,a=this.sy,n=this.tx,s=this.ty,i=1/(e*a-t*r),o=a*i,l=-t*i,c=-r*i,d=e*i;return new Te(o,l,c,d,-o*n-c*s,-l*n-d*s)},Te.prototype.applyToPoint=function(e){var t=e.x*this.sx+e.y*this.shx+this.tx,r=e.x*this.shy+e.y*this.sy+this.ty;return new tr(t,r)},Te.prototype.applyToRectangle=function(e){var t=this.applyToPoint(e),r=this.applyToPoint(new tr(e.x+e.w,e.y+e.h));return new rr(t.x,t.y,r.x-t.x,r.y-t.y)},Te.prototype.clone=function(){var e=this.sx,t=this.shy,r=this.shx,a=this.sy,n=this.tx,s=this.ty;return new Te(e,t,r,a,n,s)},m.Matrix=Te;var De=m.matrixMult=function(e,t){return t.multiply(e)},Pe=new Te(1,0,0,1,0,0);m.unitMatrix=m.identityMatrix=Pe;var Fe=function(e,t){if(!be[e]){var r=(t instanceof fx?"Sh":"P")+(Object.keys(ve).length+1).toString(10);t.id=r,be[e]=r,ve[r]=t,_e.publish("addPattern",t)}};m.ShadingPattern=fx,m.TilingPattern=gx,m.addShadingPattern=function(e,t){return S("addShadingPattern()"),Fe(e,t),this},m.beginTilingPattern=function(e){S("beginTilingPattern()"),nr(e.boundingBox[0],e.boundingBox[1],e.boundingBox[2]-e.boundingBox[0],e.boundingBox[3]-e.boundingBox[1],e.matrix)},m.endTilingPattern=function(e,t){S("endTilingPattern()"),t.stream=K[B].join("\n"),Fe(e,t),_e.publish("endTilingPattern",t),Ie.pop().restore()};var Le,Me=m.__private__.newObject=function(){var e=Re();return Oe(e,!0),e},Re=m.__private__.newObjectDeferred=function(){return V++,q[V]=function(){return G},V},Oe=function(e,t){return t="boolean"==typeof t&&t,q[e]=G,t&&J(e+" 0 obj"),e},Be=m.__private__.newAdditionalObject=function(){var e={objId:Re(),content:""};return W.push(e),e},ze=Re(),Ue=Re(),Ve=m.__private__.decodeColorString=function(e){var t=e.split(" ");if(2!==t.length||"g"!==t[1]&&"G"!==t[1])5!==t.length||"k"!==t[4]&&"K"!==t[4]||(t=[(1-t[0])*(1-t[3]),(1-t[1])*(1-t[3]),(1-t[2])*(1-t[3]),"r"]);else{var r=parseFloat(t[0]);t=[r,r,r,"r"]}for(var a="#",n=0;n<3;n++)a+=("0"+Math.floor(255*parseFloat(t[n])).toString(16)).slice(-2);return a},qe=m.__private__.encodeColorString=function(e){var t;"string"==typeof e&&(e={ch1:e});var r=e.ch1,a=e.ch2,n=e.ch3,s=e.ch4,i="draw"===e.pdfColorType?["G","RG","K"]:["g","rg","k"];if("string"==typeof r&&"#"!==r.charAt(0)){var o=new Hp(r);if(o.ok)r=o.toHex();else if(!/^\d*\.?\d*$/.test(r))throw new Error('Invalid color "'+r+'" passed to jsPDF.encodeColorString.')}if("string"==typeof r&&/^#[0-9A-Fa-f]{3}$/.test(r)&&(r="#"+r[1]+r[1]+r[2]+r[2]+r[3]+r[3]),"string"==typeof r&&/^#[0-9A-Fa-f]{6}$/.test(r)){var l=parseInt(r.substr(1),16);r=l>>16&255,a=l>>8&255,n=255&l}if(void 0===a||void 0===s&&r===a&&a===n)t="string"==typeof r?r+" "+i[0]:2===e.precision?E(r/255)+" "+i[0]:A(r/255)+" "+i[0];else if(void 0===s||"object"===(0,ju.A)(s)){if(s&&!isNaN(s.a)&&0===s.a)return["1.","1.","1.",i[1]].join(" ");t="string"==typeof r?[r,a,n,i[1]].join(" "):2===e.precision?[E(r/255),E(a/255),E(n/255),i[1]].join(" "):[A(r/255),A(a/255),A(n/255),i[1]].join(" ")}else t="string"==typeof r?[r,a,n,s,i[2]].join(" "):2===e.precision?[E(r),E(a),E(n),E(s),i[2]].join(" "):[A(r),A(a),A(n),A(s),i[2]].join(" ");return t},He=m.__private__.getFilters=function(){return i},Ge=m.__private__.putStream=function(e){var t=(e=e||{}).data||"",r=e.filters||He(),a=e.alreadyAppliedFilters||[],n=e.addLength1||!1,s=t.length,i=e.objectId,o=function(e){return e};if(null!==d&&void 0===i)throw new Error("ObjectId must be passed to putStream for file encryption");null!==d&&(o=yt.encryptor(i,0));var l={};!0===r&&(r=["FlateEncode"]);var c=e.additionalKeyValues||[],u=(l=void 0!==px.API.processDataByFilters?px.API.processDataByFilters(t,r):{data:t,reverseChain:[]}).reverseChain+(Array.isArray(a)?a.join(" "):a.toString());if(0!==l.data.length&&(c.push({key:"Length",value:l.data.length}),!0===n&&c.push({key:"Length1",value:s})),0!=u.length)if(u.split("/").length-1==1)c.push({key:"Filter",value:u});else{c.push({key:"Filter",value:"["+u+"]"});for(var h=0;h<c.length;h+=1)if("DecodeParms"===c[h].key){for(var m=[],f=0;f<l.reverseChain.split("/").length-1;f+=1)m.push("null");m.push(c[h].value),c[h].value="["+m.join(" ")+"]"}}J("<<");for(var g=0;g<c.length;g++)J("/"+c[g].key+" "+c[g].value);J(">>"),0!==l.data.length&&(J("stream"),J(o(l.data)),J("endstream"))},We=m.__private__.putPage=function(e){var t=e.number,r=e.data,a=e.objId,n=e.contentsObjId;Oe(a,!0),J("<</Type /Page"),J("/Parent "+e.rootDictionaryObjId+" 0 R"),J("/Resources "+e.resourceDictionaryObjId+" 0 R"),J("/MediaBox ["+parseFloat(j(e.mediaBox.bottomLeftX))+" "+parseFloat(j(e.mediaBox.bottomLeftY))+" "+j(e.mediaBox.topRightX)+" "+j(e.mediaBox.topRightY)+"]"),null!==e.cropBox&&J("/CropBox ["+j(e.cropBox.bottomLeftX)+" "+j(e.cropBox.bottomLeftY)+" "+j(e.cropBox.topRightX)+" "+j(e.cropBox.topRightY)+"]"),null!==e.bleedBox&&J("/BleedBox ["+j(e.bleedBox.bottomLeftX)+" "+j(e.bleedBox.bottomLeftY)+" "+j(e.bleedBox.topRightX)+" "+j(e.bleedBox.topRightY)+"]"),null!==e.trimBox&&J("/TrimBox ["+j(e.trimBox.bottomLeftX)+" "+j(e.trimBox.bottomLeftY)+" "+j(e.trimBox.topRightX)+" "+j(e.trimBox.topRightY)+"]"),null!==e.artBox&&J("/ArtBox ["+j(e.artBox.bottomLeftX)+" "+j(e.artBox.bottomLeftY)+" "+j(e.artBox.topRightX)+" "+j(e.artBox.topRightY)+"]"),"number"==typeof e.userUnit&&1!==e.userUnit&&J("/UserUnit "+e.userUnit),_e.publish("putPage",{objId:a,pageContext:Se[t],pageNumber:t,page:r}),J("/Contents "+n+" 0 R"),J(">>"),J("endobj");var s=r.join("\n");return b===v&&(s+="\nQ"),Oe(n,!0),Ge({data:s,filters:He(),objectId:n}),J("endobj"),a},Ke=m.__private__.putPages=function(){var e,t,r=[];for(e=1;e<=je;e++)Se[e].objId=Re(),Se[e].contentsObjId=Re();for(e=1;e<=je;e++)r.push(We({number:e,data:K[e],objId:Se[e].objId,contentsObjId:Se[e].contentsObjId,mediaBox:Se[e].mediaBox,cropBox:Se[e].cropBox,bleedBox:Se[e].bleedBox,trimBox:Se[e].trimBox,artBox:Se[e].artBox,userUnit:Se[e].userUnit,rootDictionaryObjId:ze,resourceDictionaryObjId:Ue}));Oe(ze,!0),J("<</Type /Pages");var a="/Kids [";for(t=0;t<je;t++)a+=r[t]+" 0 R ";J(a+"]"),J("/Count "+je),J(">>"),J("endobj"),_e.publish("postPutPages")},Qe=function(e){_e.publish("putFont",{font:e,out:J,newObject:Me,putStream:Ge}),!0!==e.isAlreadyPutted&&(e.objectNumber=Me(),J("<<"),J("/Type /Font"),J("/BaseFont /"+dx(e.postScriptName)),J("/Subtype /Type1"),"string"==typeof e.encoding&&J("/Encoding /"+e.encoding),J("/FirstChar 32"),J("/LastChar 255"),J(">>"),J("endobj"))},Ye=function(e){e.objectNumber=Me();var t=[];t.push({key:"Type",value:"/XObject"}),t.push({key:"Subtype",value:"/Form"}),t.push({key:"BBox",value:"["+[j(e.x),j(e.y),j(e.x+e.width),j(e.y+e.height)].join(" ")+"]"}),t.push({key:"Matrix",value:"["+e.matrix.toString()+"]"});var r=e.pages[1].join("\n");Ge({data:r,additionalKeyValues:t,objectId:e.objectNumber}),J("endobj")},Xe=function(e,t){t||(t=21);var r=Me(),a=function(e,t){var r,a=[],n=1/(t-1);for(r=0;r<1;r+=n)a.push(r);if(a.push(1),0!=e[0].offset){var s={offset:0,color:e[0].color};e.unshift(s)}if(1!=e[e.length-1].offset){var i={offset:1,color:e[e.length-1].color};e.push(i)}for(var o="",l=0,c=0;c<a.length;c++){for(r=a[c];r>e[l+1].offset;)l++;var d=e[l].offset,u=(r-d)/(e[l+1].offset-d),h=e[l].color,m=e[l+1].color;o+=U(Math.round((1-u)*h[0]+u*m[0]).toString(16))+U(Math.round((1-u)*h[1]+u*m[1]).toString(16))+U(Math.round((1-u)*h[2]+u*m[2]).toString(16))}return o.trim()}(e.colors,t),n=[];n.push({key:"FunctionType",value:"0"}),n.push({key:"Domain",value:"[0.0 1.0]"}),n.push({key:"Size",value:"["+t+"]"}),n.push({key:"BitsPerSample",value:"8"}),n.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),n.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Ge({data:a,additionalKeyValues:n,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:r}),J("endobj"),e.objectNumber=Me(),J("<< /ShadingType "+e.type),J("/ColorSpace /DeviceRGB");var s="/Coords ["+j(parseFloat(e.coords[0]))+" "+j(parseFloat(e.coords[1]))+" ";2===e.type?s+=j(parseFloat(e.coords[2]))+" "+j(parseFloat(e.coords[3])):s+=j(parseFloat(e.coords[2]))+" "+j(parseFloat(e.coords[3]))+" "+j(parseFloat(e.coords[4]))+" "+j(parseFloat(e.coords[5])),J(s+="]"),e.matrix&&J("/Matrix ["+e.matrix.toString()+"]"),J("/Function "+r+" 0 R"),J("/Extend [true true]"),J(">>"),J("endobj")},Je=function(e,t){var r=Re(),a=Me();t.push({resourcesOid:r,objectOid:a}),e.objectNumber=a;var n=[];n.push({key:"Type",value:"/Pattern"}),n.push({key:"PatternType",value:"1"}),n.push({key:"PaintType",value:"1"}),n.push({key:"TilingType",value:"1"}),n.push({key:"BBox",value:"["+e.boundingBox.map(j).join(" ")+"]"}),n.push({key:"XStep",value:j(e.xStep)}),n.push({key:"YStep",value:j(e.yStep)}),n.push({key:"Resources",value:r+" 0 R"}),e.matrix&&n.push({key:"Matrix",value:"["+e.matrix.toString()+"]"}),Ge({data:e.stream,additionalKeyValues:n,objectId:e.objectNumber}),J("endobj")},Ze=function(e){for(var t in e.objectNumber=Me(),J("<<"),e)switch(t){case"opacity":J("/ca "+E(e[t]));break;case"stroke-opacity":J("/CA "+E(e[t]))}J(">>"),J("endobj")},$e=function(e){Oe(e.resourcesOid,!0),J("<<"),J("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),function(){for(var e in J("/Font <<"),pe)pe.hasOwnProperty(e)&&(!1===u||!0===u&&h.hasOwnProperty(e))&&J("/"+e+" "+pe[e].objectNumber+" 0 R");J(">>")}(),function(){if(Object.keys(ve).length>0){for(var e in J("/Shading <<"),ve)ve.hasOwnProperty(e)&&ve[e]instanceof fx&&ve[e].objectNumber>=0&&J("/"+e+" "+ve[e].objectNumber+" 0 R");_e.publish("putShadingPatternDict"),J(">>")}}(),function(e){if(Object.keys(ve).length>0){for(var t in J("/Pattern <<"),ve)ve.hasOwnProperty(t)&&ve[t]instanceof m.TilingPattern&&ve[t].objectNumber>=0&&ve[t].objectNumber<e&&J("/"+t+" "+ve[t].objectNumber+" 0 R");_e.publish("putTilingPatternDict"),J(">>")}}(e.objectOid),function(){if(Object.keys(we).length>0){var e;for(e in J("/ExtGState <<"),we)we.hasOwnProperty(e)&&we[e].objectNumber>=0&&J("/"+e+" "+we[e].objectNumber+" 0 R");_e.publish("putGStateDict"),J(">>")}}(),function(){for(var e in J("/XObject <<"),Ae)Ae.hasOwnProperty(e)&&Ae[e].objectNumber>=0&&J("/"+e+" "+Ae[e].objectNumber+" 0 R");_e.publish("putXobjectDict"),J(">>")}(),J(">>"),J("endobj")},et=function(e){xe[e.fontName]=xe[e.fontName]||{},xe[e.fontName][e.fontStyle]=e.id},tt=function(e,t,r,a,n){var s={id:"F"+(Object.keys(pe).length+1).toString(10),postScriptName:e,fontName:t,fontStyle:r,encoding:a,isStandardFont:n||!1,metadata:{}};return _e.publish("addFont",{font:s,instance:this}),pe[s.id]=s,et(s),s.id},rt=m.__private__.pdfEscape=m.pdfEscape=function(e,t){return function(e,t){var r,a,n,s,i,o,l,c,d;if(n=(t=t||{}).sourceEncoding||"Unicode",i=t.outputEncoding,(t.autoencode||i)&&pe[ue].metadata&&pe[ue].metadata[n]&&pe[ue].metadata[n].encoding&&(s=pe[ue].metadata[n].encoding,!i&&pe[ue].encoding&&(i=pe[ue].encoding),!i&&s.codePages&&(i=s.codePages[0]),"string"==typeof i&&(i=s[i]),i)){for(l=!1,o=[],r=0,a=e.length;r<a;r++)(c=i[e.charCodeAt(r)])?o.push(String.fromCharCode(c)):o.push(e[r]),o[r].charCodeAt(0)>>8&&(l=!0);e=o.join("")}for(r=e.length;void 0===l&&0!==r;)e.charCodeAt(r-1)>>8&&(l=!0),r--;if(!l)return e;for(o=t.noBOM?[]:[254,255],r=0,a=e.length;r<a;r++){if((d=(c=e.charCodeAt(r))>>8)>>8)throw new Error("Character at position "+r+" of string '"+e+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");o.push(d),o.push(c-(d<<8))}return String.fromCharCode.apply(void 0,o)}(e,t).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},at=m.__private__.beginPage=function(e){K[++je]=[],Se[je]={objId:0,contentsObjId:0,userUnit:Number(o),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(e[0]),topRightY:Number(e[1])}},it(je),X(K[B])},nt=function(e,t){var a,s,i;switch(r=t||r,"string"==typeof e&&(a=x(e.toLowerCase()),Array.isArray(a)&&(s=a[0],i=a[1])),Array.isArray(e)&&(s=e[0]*he,i=e[1]*he),isNaN(s)&&(s=n[0],i=n[1]),(s>14400||i>14400)&&(Bp.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),s=Math.min(14400,s),i=Math.min(14400,i)),n=[s,i],r.substr(0,1)){case"l":i>s&&(n=[i,s]);break;case"p":s>i&&(n=[i,s])}at(n),Ot(Mt),J(Wt),0!==Zt&&J(Zt+" J"),0!==$t&&J($t+" j"),_e.publish("addPage",{pageNumber:je})},st=function(e){e>0&&e<=je&&(K.splice(e,1),Se.splice(e,1),je--,B>je&&(B=je),this.setPage(B))},it=function(e){e>0&&e<=je&&(B=e)},ot=m.__private__.getNumberOfPages=m.getNumberOfPages=function(){return K.length-1},lt=function(e,t,r){var a,n=void 0;return r=r||{},e=void 0!==e?e:pe[ue].fontName,t=void 0!==t?t:pe[ue].fontStyle,a=e.toLowerCase(),void 0!==xe[a]&&void 0!==xe[a][t]?n=xe[a][t]:void 0!==xe[e]&&void 0!==xe[e][t]?n=xe[e][t]:!1===r.disableWarning&&Bp.warn("Unable to look up font label for font '"+e+"', '"+t+"'. Refer to getFontList() for available fonts."),n||r.noFallback||null==(n=xe.times[t])&&(n=xe.times.normal),n},ct=m.__private__.putInfo=function(){var e=Me(),t=function(e){return e};for(var r in null!==d&&(t=yt.encryptor(e,0)),J("<<"),J("/Producer ("+rt(t("jsPDF "+px.version))+")"),de)de.hasOwnProperty(r)&&de[r]&&J("/"+r.substr(0,1).toUpperCase()+r.substr(1)+" ("+rt(t(de[r]))+")");J("/CreationDate ("+rt(t(T))+")"),J(">>"),J("endobj")},dt=m.__private__.putCatalog=function(e){var t=(e=e||{}).rootDictionaryObjId||ze;switch(Me(),J("<<"),J("/Type /Catalog"),J("/Pages "+t+" 0 R"),re||(re="fullwidth"),re){case"fullwidth":J("/OpenAction [3 0 R /FitH null]");break;case"fullheight":J("/OpenAction [3 0 R /FitV null]");break;case"fullpage":J("/OpenAction [3 0 R /Fit]");break;case"original":J("/OpenAction [3 0 R /XYZ null null 1]");break;default:var r=""+re;"%"===r.substr(r.length-1)&&(re=parseInt(re)/100),"number"==typeof re&&J("/OpenAction [3 0 R /XYZ null null "+E(re)+"]")}switch(oe||(oe="continuous"),oe){case"continuous":J("/PageLayout /OneColumn");break;case"single":J("/PageLayout /SinglePage");break;case"two":case"twoleft":J("/PageLayout /TwoColumnLeft");break;case"tworight":J("/PageLayout /TwoColumnRight")}se&&J("/PageMode /"+se),_e.publish("putCatalog"),J(">>"),J("endobj")},ut=m.__private__.putTrailer=function(){J("trailer"),J("<<"),J("/Size "+(V+1)),J("/Root "+V+" 0 R"),J("/Info "+(V-1)+" 0 R"),null!==d&&J("/Encrypt "+yt.oid+" 0 R"),J("/ID [ <"+D+"> <"+D+"> ]"),J(">>")},ht=m.__private__.putHeader=function(){J("%PDF-"+f),J("%\xba\xdf\xac\xe0")},mt=m.__private__.putXRef=function(){var e="0000000000";J("xref"),J("0 "+(V+1)),J("0000000000 65535 f ");for(var t=1;t<=V;t++)"function"==typeof q[t]?J((e+q[t]()).slice(-10)+" 00000 n "):void 0!==q[t]?J((e+q[t]).slice(-10)+" 00000 n "):J("0000000000 00000 n ")},ft=m.__private__.buildDocument=function(){var e;V=0,G=0,H=[],q=[],W=[],ze=Re(),Ue=Re(),X(H),_e.publish("buildDocument"),ht(),Ke(),function(){_e.publish("putAdditionalObjects");for(var e=0;e<W.length;e++){var t=W[e];Oe(t.objId,!0),J(t.content),J("endobj")}_e.publish("postPutAdditionalObjects")}(),e=[],function(){for(var e in pe)pe.hasOwnProperty(e)&&(!1===u||!0===u&&h.hasOwnProperty(e))&&Qe(pe[e])}(),function(){var e;for(e in we)we.hasOwnProperty(e)&&Ze(we[e])}(),function(){for(var e in Ae)Ae.hasOwnProperty(e)&&Ye(Ae[e])}(),function(e){var t;for(t in ve)ve.hasOwnProperty(t)&&(ve[t]instanceof fx?Xe(ve[t]):ve[t]instanceof gx&&Je(ve[t],e))}(e),_e.publish("putResources"),e.forEach($e),$e({resourcesOid:Ue,objectOid:Number.MAX_SAFE_INTEGER}),_e.publish("postPutResources"),null!==d&&(yt.oid=Me(),J("<<"),J("/Filter /Standard"),J("/V "+yt.v),J("/R "+yt.r),J("/U <"+yt.toHexString(yt.U)+">"),J("/O <"+yt.toHexString(yt.O)+">"),J("/P "+yt.P),J(">>"),J("endobj")),ct(),dt();var t=G;return mt(),ut(),J("startxref"),J(""+t),J("%%EOF"),X(K[B]),H.join("\n")},gt=m.__private__.getBlob=function(e){return new Blob([$(e)],{type:"application/pdf"})},pt=m.output=m.__private__.output=(Le=function(e,t){switch("string"==typeof(t=t||{})?t={filename:t}:t.filename=t.filename||"generated.pdf",e){case void 0:return ft();case"save":m.save(t.filename);break;case"arraybuffer":return $(ft());case"blob":return gt(ft());case"bloburi":case"bloburl":if(void 0!==Rp.URL&&"function"==typeof Rp.URL.createObjectURL)return Rp.URL&&Rp.URL.createObjectURL(gt(ft()))||void 0;Bp.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var r="",a=ft();try{r=Wp(a)}catch(d){r=Wp(unescape(encodeURIComponent(a)))}return"data:application/pdf;filename="+t.filename+";base64,"+r;case"pdfobjectnewwindow":if("[object Window]"===Object.prototype.toString.call(Rp)){var n="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",s=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';t.pdfObjectUrl&&(n=t.pdfObjectUrl,s="");var i='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+n+'"'+s+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(t)+");<\/script></body></html>",o=Rp.open();return null!==o&&o.document.write(i),o}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if("[object Window]"===Object.prototype.toString.call(Rp)){var l='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(t.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+t.filename+'" width="500px" height="400px" /></body></html>',c=Rp.open();if(null!==c){c.document.write(l);var u=this;c.document.documentElement.querySelector("#pdfViewer").onload=function(){c.document.title=t.filename,c.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(u.output("bloburl"))}}return c}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if("[object Window]"!==Object.prototype.toString.call(Rp))throw new Error("The option dataurlnewwindow just works in a browser-environment.");var h='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",t)+'"></iframe></body></html>',f=Rp.open();if(null!==f&&(f.document.write(h),f.document.title=t.filename),f||"undefined"==typeof safari)return f;break;case"datauri":case"dataurl":return Rp.document.location.href=this.output("datauristring",t);default:return null}},Le.foo=function(){try{return Le.apply(this,arguments)}catch(t){var e=t.stack||"";~e.indexOf(" at ")&&(e=e.split(" at ")[1]);var r="Error in function "+e.split("\n")[0].split("<")[0]+": "+t.message;if(!Rp.console)throw new Error(r);Rp.console.error(r,t),Rp.alert&&alert(r)}},Le.foo.bar=Le,Le.foo),xt=function(e){return!0===Array.isArray(Ee)&&Ee.indexOf(e)>-1};switch(a){case"pt":he=1;break;case"mm":he=72/25.4;break;case"cm":he=72/2.54;break;case"in":he=72;break;case"px":he=1==xt("px_scaling")?.75:96/72;break;case"pc":case"em":he=12;break;case"ex":he=6;break;default:if("number"!=typeof a)throw new Error("Invalid unit: "+a);he=a}var yt=null;R(),F();var vt=m.__private__.getPageInfo=m.getPageInfo=function(e){if(isNaN(e)||e%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:Se[e].objId,pageNumber:e,pageContext:Se[e]}},bt=m.__private__.getPageInfoByObjId=function(e){if(isNaN(e)||e%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var t in Se)if(Se[t].objId===e)break;return vt(t)},wt=m.__private__.getCurrentPageInfo=m.getCurrentPageInfo=function(){return{objId:Se[B].objId,pageNumber:B,pageContext:Se[B]}};m.addPage=function(){return nt.apply(this,arguments),this},m.setPage=function(){return it.apply(this,arguments),X.call(this,K[B]),this},m.insertPage=function(e){return this.addPage(),this.movePage(B,e),this},m.movePage=function(e,t){var r,a;if(e>t){r=K[e],a=Se[e];for(var n=e;n>t;n--)K[n]=K[n-1],Se[n]=Se[n-1];K[t]=r,Se[t]=a,this.setPage(t)}else if(e<t){r=K[e],a=Se[e];for(var s=e;s<t;s++)K[s]=K[s+1],Se[s]=Se[s+1];K[t]=r,Se[t]=a,this.setPage(t)}return this},m.deletePage=function(){return st.apply(this,arguments),this},m.__private__.text=m.text=function(e,t,r,a,n){var s,i,o,l,c,d,u,m,f,g=(a=a||{}).scope||this;if("number"==typeof e&&"number"==typeof t&&("string"==typeof r||Array.isArray(r))){var p=r;r=t,t=e,e=p}if(arguments[3]instanceof Te==0?(o=arguments[4],l=arguments[5],"object"===(0,ju.A)(u=arguments[3])&&null!==u||("string"==typeof o&&(l=o,o=null),"string"==typeof u&&(l=u,u=null),"number"==typeof u&&(o=u,u=null),a={flags:u,angle:o,align:l})):(S("The transform parameter of text() with a Matrix value"),f=n),isNaN(t)||isNaN(r)||null==e)throw new Error("Invalid arguments passed to jsPDF.text");if(0===e.length)return g;var x,y="",w="number"==typeof a.lineHeightFactor?a.lineHeightFactor:Lt,k=g.internal.scaleFactor;function N(e){return e=e.split("\t").join(Array(a.TabLen||9).join(" ")),rt(e,u)}function _(e){for(var t,r=e.concat(),a=[],n=r.length;n--;)"string"==typeof(t=r.shift())?a.push(t):Array.isArray(e)&&(1===t.length||void 0===t[1]&&void 0===t[2])?a.push(t[0]):a.push([t[0],t[1],t[2]]);return a}function E(e,t){var r;if("string"==typeof e)r=t(e)[0];else if(Array.isArray(e)){for(var a,n,s=e.concat(),i=[],o=s.length;o--;)"string"==typeof(a=s.shift())?i.push(t(a)[0]):Array.isArray(a)&&"string"==typeof a[0]&&(n=t(a[0],a[1],a[2]),i.push([n[0],n[1],n[2]]));r=i}return r}var A=!1,I=!0;if("string"==typeof e)A=!0;else if(Array.isArray(e)){var T=e.concat();i=[];for(var D,P=T.length;P--;)("string"!=typeof(D=T.shift())||Array.isArray(D)&&"string"!=typeof D[0])&&(I=!1);A=I}if(!1===A)throw new Error('Type of text must be string or Array. "'+e+'" is not recognized.');"string"==typeof e&&(e=e.match(/[\r?\n]/)?e.split(/\r\n|\r|\n/g):[e]);var F=te/g.internal.scaleFactor,L=F*(w-1);switch(a.baseline){case"bottom":r-=L;break;case"top":r+=F-L;break;case"hanging":r+=F-2*L;break;case"middle":r+=F/2-L}if((d=a.maxWidth||0)>0&&("string"==typeof e?e=g.splitTextToSize(e,d):"[object Array]"===Object.prototype.toString.call(e)&&(e=e.reduce(function(e,t){return e.concat(g.splitTextToSize(t,d))},[]))),s={text:e,x:t,y:r,options:a,mutex:{pdfEscape:rt,activeFontKey:ue,fonts:pe,activeFontSize:te}},_e.publish("preProcessText",s),e=s.text,o=(a=s.options).angle,f instanceof Te==0&&o&&"number"==typeof o){o*=Math.PI/180,0===a.rotationDirection&&(o=-o),b===v&&(o=-o);var M=Math.cos(o),R=Math.sin(o);f=new Te(M,R,-R,M,0,0)}else o&&o instanceof Te&&(f=o);b!==v||f||(f=Pe),void 0!==(c=a.charSpace||Xt)&&(y+=j(C(c))+" Tc\n",this.setCharSpace(this.getCharSpace()||0)),void 0!==(m=a.horizontalScale)&&(y+=j(100*m)+" Tz\n"),a.lang;var O=-1,B=void 0!==a.renderingMode?a.renderingMode:a.stroke,z=g.internal.getCurrentPageInfo().pageContext;switch(B){case 0:case!1:case"fill":O=0;break;case 1:case!0:case"stroke":O=1;break;case 2:case"fillThenStroke":O=2;break;case 3:case"invisible":O=3;break;case 4:case"fillAndAddForClipping":O=4;break;case 5:case"strokeAndAddPathForClipping":O=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":O=6;break;case 7:case"addToPathForClipping":O=7}var U=void 0!==z.usedRenderingMode?z.usedRenderingMode:-1;-1!==O?y+=O+" Tr\n":-1!==U&&(y+="0 Tr\n"),-1!==O&&(z.usedRenderingMode=O),l=a.align||"left";var V,q=te*w,H=g.internal.pageSize.getWidth(),G=pe[ue];c=a.charSpace||Xt,d=a.maxWidth||0,u=Object.assign({autoencode:!0,noBOM:!0},a.flags);var W=[],K=function(e){return g.getStringUnitWidth(e,{font:G,charSpace:c,fontSize:te,doKerning:!1})*te/k};if("[object Array]"===Object.prototype.toString.call(e)){var Q;i=_(e),"left"!==l&&(V=i.map(K));var Y,X=0;if("right"===l){t-=V[0],e=[],P=i.length;for(var Z=0;Z<P;Z++)0===Z?(Y=Vt(t),Q=qt(r)):(Y=C(X-V[Z]),Q=-q),e.push([i[Z],Y,Q]),X=V[Z]}else if("center"===l){t-=V[0]/2,e=[],P=i.length;for(var $=0;$<P;$++)0===$?(Y=Vt(t),Q=qt(r)):(Y=C((X-V[$])/2),Q=-q),e.push([i[$],Y,Q]),X=V[$]}else if("left"===l){e=[],P=i.length;for(var ee=0;ee<P;ee++)e.push(i[ee])}else if("justify"===l&&"Identity-H"===G.encoding){e=[],P=i.length,d=0!==d?d:H;for(var re=0,ae=0;ae<P;ae++)if(Q=0===ae?qt(r):-q,Y=0===ae?Vt(t):re,ae<P-1){var se=C((d-V[ae])/(i[ae].split(" ").length-1)),ie=i[ae].split(" ");e.push([ie[0]+" ",Y,Q]),re=0;for(var oe=1;oe<ie.length;oe++){var le=(K(ie[oe-1]+" "+ie[oe])-K(ie[oe]))*k+se;oe==ie.length-1?e.push([ie[oe],le,0]):e.push([ie[oe]+" ",le,0]),re-=le}}else e.push([i[ae],Y,Q]);e.push(["",re,0])}else{if("justify"!==l)throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(e=[],P=i.length,d=0!==d?d:H,ae=0;ae<P;ae++){Q=0===ae?qt(r):-q,Y=0===ae?Vt(t):0;var ce=i[ae].split(" ").length-1,de=ce>0?(d-V[ae])/ce:0;ae<P-1?W.push(j(C(de))):W.push(0),e.push([i[ae],Y,Q])}}}!0===("boolean"==typeof a.R2L?a.R2L:ne)&&(e=E(e,function(e,t,r){return[e.split("").reverse().join(""),t,r]})),s={text:e,x:t,y:r,options:a,mutex:{pdfEscape:rt,activeFontKey:ue,fonts:pe,activeFontSize:te}},_e.publish("postProcessText",s),e=s.text,x=s.mutex.isHex||!1;var he=pe[ue].encoding;"WinAnsiEncoding"!==he&&"StandardEncoding"!==he||(e=E(e,function(e,t,r){return[N(e),t,r]})),i=_(e),e=[];for(var me,fe,ge,xe=Array.isArray(i[0])?1:0,ye="",ve=function(e,t,r){var n="";return r instanceof Te?(r="number"==typeof a.angle?De(r,new Te(1,0,0,1,e,t)):De(new Te(1,0,0,1,e,t),r),b===v&&(r=De(new Te(1,0,0,-1,0,0),r)),n=r.join(" ")+" Tm\n"):n=j(e)+" "+j(t)+" Td\n",n},be=0;be<i.length;be++){switch(ye="",xe){case 1:ge=(x?"<":"(")+i[be][0]+(x?">":")"),me=parseFloat(i[be][1]),fe=parseFloat(i[be][2]);break;case 0:ge=(x?"<":"(")+i[be]+(x?">":")"),me=Vt(t),fe=qt(r)}void 0!==W&&void 0!==W[be]&&(ye=W[be]+" Tw\n"),0===be?e.push(ye+ve(me,fe,f)+ge):0===xe?e.push(ye+ge):1===xe&&e.push(ye+ve(me,fe,f)+ge)}e=0===xe?e.join(" Tj\nT* "):e.join(" Tj\n"),e+=" Tj\n";var we="BT\n/";return we+=ue+" "+te+" Tf\n",we+=j(te*w)+" TL\n",we+=Qt+"\n",we+=y,we+=e,J(we+="ET"),h[ue]=!0,g};var kt=m.__private__.clip=m.clip=function(e){return J("evenodd"===e?"W*":"W"),this};m.clipEvenOdd=function(){return kt("evenodd")},m.__private__.discardPath=m.discardPath=function(){return J("n"),this};var Nt=m.__private__.isValidStyle=function(e){var t=!1;return-1!==[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(e)&&(t=!0),t};m.__private__.setDefaultPathOperation=m.setDefaultPathOperation=function(e){return Nt(e)&&(c=e),this};var jt=m.__private__.getStyle=m.getStyle=function(e){var t=c;switch(e){case"D":case"S":t="S";break;case"F":t="f";break;case"FD":case"DF":t="B";break;case"f":case"f*":case"B":case"B*":t=e}return t},St=m.close=function(){return J("h"),this};m.stroke=function(){return J("S"),this},m.fill=function(e){return _t("f",e),this},m.fillEvenOdd=function(e){return _t("f*",e),this},m.fillStroke=function(e){return _t("B",e),this},m.fillStrokeEvenOdd=function(e){return _t("B*",e),this};var _t=function(e,t){"object"===(0,ju.A)(t)?Ct(t,e):J(e)},Et=function(e){null===e||b===v&&void 0===e||(e=jt(e),J(e))};function At(e,t,r,a,n){var s=new gx(t||this.boundingBox,r||this.xStep,a||this.yStep,this.gState,n||this.matrix);s.stream=this.stream;var i=e+"$$"+this.cloneIndex+++"$$";return Fe(i,s),s}var Ct=function(e,t){var r=be[e.key],a=ve[r];if(a instanceof fx)J("q"),J(It(t)),a.gState&&m.setGState(a.gState),J(e.matrix.toString()+" cm"),J("/"+r+" sh"),J("Q");else if(a instanceof gx){var n=new Te(1,0,0,-1,0,hr());e.matrix&&(n=n.multiply(e.matrix||Pe),r=At.call(a,e.key,e.boundingBox,e.xStep,e.yStep,n).id),J("q"),J("/Pattern cs"),J("/"+r+" scn"),a.gState&&m.setGState(a.gState),J(t),J("Q")}},It=function(e){switch(e){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},Tt=m.moveTo=function(e,t){return J(j(C(e))+" "+j(I(t))+" m"),this},Dt=m.lineTo=function(e,t){return J(j(C(e))+" "+j(I(t))+" l"),this},Pt=m.curveTo=function(e,t,r,a,n,s){return J([j(C(e)),j(I(t)),j(C(r)),j(I(a)),j(C(n)),j(I(s)),"c"].join(" ")),this};m.__private__.line=m.line=function(e,t,r,a,n){if(isNaN(e)||isNaN(t)||isNaN(r)||isNaN(a)||!Nt(n))throw new Error("Invalid arguments passed to jsPDF.line");return b===y?this.lines([[r-e,a-t]],e,t,[1,1],n||"S"):this.lines([[r-e,a-t]],e,t,[1,1]).stroke()},m.__private__.lines=m.lines=function(e,t,r,a,n,s){var i,o,l,c,d,u,h,m,f,g,p,x;if("number"==typeof e&&(x=r,r=t,t=e,e=x),a=a||[1,1],s=s||!1,isNaN(t)||isNaN(r)||!Array.isArray(e)||!Array.isArray(a)||!Nt(n)||"boolean"!=typeof s)throw new Error("Invalid arguments passed to jsPDF.lines");for(Tt(t,r),i=a[0],o=a[1],c=e.length,g=t,p=r,l=0;l<c;l++)2===(d=e[l]).length?(g=d[0]*i+g,p=d[1]*o+p,Dt(g,p)):(u=d[0]*i+g,h=d[1]*o+p,m=d[2]*i+g,f=d[3]*o+p,g=d[4]*i+g,p=d[5]*o+p,Pt(u,h,m,f,g,p));return s&&St(),Et(n),this},m.path=function(e){for(var t=0;t<e.length;t++){var r=e[t],a=r.c;switch(r.op){case"m":Tt(a[0],a[1]);break;case"l":Dt(a[0],a[1]);break;case"c":Pt.apply(this,a);break;case"h":St()}}return this},m.__private__.rect=m.rect=function(e,t,r,a,n){if(isNaN(e)||isNaN(t)||isNaN(r)||isNaN(a)||!Nt(n))throw new Error("Invalid arguments passed to jsPDF.rect");return b===y&&(a=-a),J([j(C(e)),j(I(t)),j(C(r)),j(C(a)),"re"].join(" ")),Et(n),this},m.__private__.triangle=m.triangle=function(e,t,r,a,n,s,i){if(isNaN(e)||isNaN(t)||isNaN(r)||isNaN(a)||isNaN(n)||isNaN(s)||!Nt(i))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[r-e,a-t],[n-r,s-a],[e-n,t-s]],e,t,[1,1],i,!0),this},m.__private__.roundedRect=m.roundedRect=function(e,t,r,a,n,s,i){if(isNaN(e)||isNaN(t)||isNaN(r)||isNaN(a)||isNaN(n)||isNaN(s)||!Nt(i))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var o=4/3*(Math.SQRT2-1);return n=Math.min(n,.5*r),s=Math.min(s,.5*a),this.lines([[r-2*n,0],[n*o,0,n,s-s*o,n,s],[0,a-2*s],[0,s*o,-n*o,s,-n,s],[2*n-r,0],[-n*o,0,-n,-s*o,-n,-s],[0,2*s-a],[0,-s*o,n*o,-s,n,-s]],e+n,t,[1,1],i,!0),this},m.__private__.ellipse=m.ellipse=function(e,t,r,a,n){if(isNaN(e)||isNaN(t)||isNaN(r)||isNaN(a)||!Nt(n))throw new Error("Invalid arguments passed to jsPDF.ellipse");var s=4/3*(Math.SQRT2-1)*r,i=4/3*(Math.SQRT2-1)*a;return Tt(e+r,t),Pt(e+r,t-i,e+s,t-a,e,t-a),Pt(e-s,t-a,e-r,t-i,e-r,t),Pt(e-r,t+i,e-s,t+a,e,t+a),Pt(e+s,t+a,e+r,t+i,e+r,t),Et(n),this},m.__private__.circle=m.circle=function(e,t,r,a){if(isNaN(e)||isNaN(t)||isNaN(r)||!Nt(a))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(e,t,r,r,a)},m.setFont=function(e,t,r){return r&&(t=N(t,r)),ue=lt(e,t,{disableWarning:!1}),this};var Ft=m.__private__.getFont=m.getFont=function(){return pe[lt.apply(m,arguments)]};m.__private__.getFontList=m.getFontList=function(){var e,t,r={};for(e in xe)if(xe.hasOwnProperty(e))for(t in r[e]=[],xe[e])xe[e].hasOwnProperty(t)&&r[e].push(t);return r},m.addFont=function(e,t,r,a,n){var s=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&-1!==s.indexOf(arguments[3])?n=arguments[3]:arguments[3]&&-1==s.indexOf(arguments[3])&&(r=N(r,a)),tt.call(this,e,t,r,n=n||"Identity-H")};var Lt,Mt=e.lineWidth||.200025,Rt=m.__private__.getLineWidth=m.getLineWidth=function(){return Mt},Ot=m.__private__.setLineWidth=m.setLineWidth=function(e){return Mt=e,J(j(C(e))+" w"),this};m.__private__.setLineDash=px.API.setLineDash=px.API.setLineDashPattern=function(e,t){if(e=e||[],t=t||0,isNaN(t)||!Array.isArray(e))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return e=e.map(function(e){return j(C(e))}).join(" "),t=j(C(t)),J("["+e+"] "+t+" d"),this};var Bt=m.__private__.getLineHeight=m.getLineHeight=function(){return te*Lt};m.__private__.getLineHeight=m.getLineHeight=function(){return te*Lt};var zt=m.__private__.setLineHeightFactor=m.setLineHeightFactor=function(e){return"number"==typeof(e=e||1.15)&&(Lt=e),this},Ut=m.__private__.getLineHeightFactor=m.getLineHeightFactor=function(){return Lt};zt(e.lineHeight);var Vt=m.__private__.getHorizontalCoordinate=function(e){return C(e)},qt=m.__private__.getVerticalCoordinate=function(e){return b===v?e:Se[B].mediaBox.topRightY-Se[B].mediaBox.bottomLeftY-C(e)},Ht=m.__private__.getHorizontalCoordinateString=m.getHorizontalCoordinateString=function(e){return j(Vt(e))},Gt=m.__private__.getVerticalCoordinateString=m.getVerticalCoordinateString=function(e){return j(qt(e))},Wt=e.strokeColor||"0 G";m.__private__.getStrokeColor=m.getDrawColor=function(){return Ve(Wt)},m.__private__.setStrokeColor=m.setDrawColor=function(e,t,r,a){return Wt=qe({ch1:e,ch2:t,ch3:r,ch4:a,pdfColorType:"draw",precision:2}),J(Wt),this};var Kt=e.fillColor||"0 g";m.__private__.getFillColor=m.getFillColor=function(){return Ve(Kt)},m.__private__.setFillColor=m.setFillColor=function(e,t,r,a){return Kt=qe({ch1:e,ch2:t,ch3:r,ch4:a,pdfColorType:"fill",precision:2}),J(Kt),this};var Qt=e.textColor||"0 g",Yt=m.__private__.getTextColor=m.getTextColor=function(){return Ve(Qt)};m.__private__.setTextColor=m.setTextColor=function(e,t,r,a){return Qt=qe({ch1:e,ch2:t,ch3:r,ch4:a,pdfColorType:"text",precision:3}),this};var Xt=e.charSpace,Jt=m.__private__.getCharSpace=m.getCharSpace=function(){return parseFloat(Xt||0)};m.__private__.setCharSpace=m.setCharSpace=function(e){if(isNaN(e))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return Xt=e,this};var Zt=0;m.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},m.__private__.setLineCap=m.setLineCap=function(e){var t=m.CapJoinStyles[e];if(void 0===t)throw new Error("Line cap style of '"+e+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Zt=t,J(t+" J"),this};var $t=0;m.__private__.setLineJoin=m.setLineJoin=function(e){var t=m.CapJoinStyles[e];if(void 0===t)throw new Error("Line join style of '"+e+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return $t=t,J(t+" j"),this},m.__private__.setLineMiterLimit=m.__private__.setMiterLimit=m.setLineMiterLimit=m.setMiterLimit=function(e){if(e=e||0,isNaN(e))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return J(j(C(e))+" M"),this},m.GState=hx,m.setGState=function(e){(e="string"==typeof e?we[ke[e]]:er(null,e)).equals(Ne)||(J("/"+e.id+" gs"),Ne=e)};var er=function(e,t){if(!e||!ke[e]){var r=!1;for(var a in we)if(we.hasOwnProperty(a)&&we[a].equals(t)){r=!0;break}if(r)t=we[a];else{var n="GS"+(Object.keys(we).length+1).toString(10);we[n]=t,t.id=n}return e&&(ke[e]=t.id),_e.publish("addGState",t),t}};m.addGState=function(e,t){return er(e,t),this},m.saveGraphicsState=function(){return J("q"),ye.push({key:ue,size:te,color:Qt}),this},m.restoreGraphicsState=function(){J("Q");var e=ye.pop();return ue=e.key,te=e.size,Qt=e.color,Ne=null,this},m.setCurrentTransformationMatrix=function(e){return J(e.toString()+" cm"),this},m.comment=function(e){return J("#"+e),this};var tr=function(e,t){var r=e||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return r},set:function(e){isNaN(e)||(r=parseFloat(e))}});var a=t||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return a},set:function(e){isNaN(e)||(a=parseFloat(e))}});var n="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return n},set:function(e){n=e.toString()}}),this},rr=function(e,t,r,a){tr.call(this,e,t),this.type="rect";var n=r||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return n},set:function(e){isNaN(e)||(n=parseFloat(e))}});var s=a||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return s},set:function(e){isNaN(e)||(s=parseFloat(e))}}),this},ar=function(){this.page=je,this.currentPage=B,this.pages=K.slice(0),this.pagesContext=Se.slice(0),this.x=me,this.y=fe,this.matrix=ge,this.width=ir(B),this.height=lr(B),this.outputDestination=Y,this.id="",this.objectNumber=-1};ar.prototype.restore=function(){je=this.page,B=this.currentPage,Se=this.pagesContext,K=this.pages,me=this.x,fe=this.y,ge=this.matrix,or(B,this.width),cr(B,this.height),Y=this.outputDestination};var nr=function(e,t,r,a,n){Ie.push(new ar),je=B=0,K=[],me=e,fe=t,ge=n,at([r,a])};for(var sr in m.beginFormObject=function(e,t,r,a,n){return nr(e,t,r,a,n),this},m.endFormObject=function(e){return function(e){if(Ce[e])Ie.pop().restore();else{var t=new ar,r="Xo"+(Object.keys(Ae).length+1).toString(10);t.id=r,Ce[e]=r,Ae[r]=t,_e.publish("addFormObject",t),Ie.pop().restore()}}(e),this},m.doFormObject=function(e,t){var r=Ae[Ce[e]];return J("q"),J(t.toString()+" cm"),J("/"+r.id+" Do"),J("Q"),this},m.getFormObject=function(e){var t=Ae[Ce[e]];return{x:t.x,y:t.y,width:t.width,height:t.height,matrix:t.matrix}},m.save=function(e,t){return e=e||"generated.pdf",(t=t||{}).returnPromise=t.returnPromise||!1,!1===t.returnPromise?(qp(gt(ft()),e),"function"==typeof qp.unload&&Rp.setTimeout&&setTimeout(qp.unload,911),this):new Promise(function(t,r){try{var n=qp(gt(ft()),e);"function"==typeof qp.unload&&Rp.setTimeout&&setTimeout(qp.unload,911),t(n)}catch(a){r(a.message)}})},px.API)px.API.hasOwnProperty(sr)&&("events"===sr&&px.API.events.length?function(e,t){var r,a,n;for(n=t.length-1;-1!==n;n--)r=t[n][0],a=t[n][1],e.subscribe.apply(e,[r].concat("function"==typeof a?[a]:a))}(_e,px.API.events):m[sr]=px.API[sr]);function ir(e){return Se[e].mediaBox.topRightX-Se[e].mediaBox.bottomLeftX}function or(e,t){Se[e].mediaBox.topRightX=t+Se[e].mediaBox.bottomLeftX}function lr(e){return Se[e].mediaBox.topRightY-Se[e].mediaBox.bottomLeftY}function cr(e,t){Se[e].mediaBox.topRightY=t+Se[e].mediaBox.bottomLeftY}var dr=m.getPageWidth=function(e){return ir(e=e||B)/he},ur=m.setPageWidth=function(e,t){or(e,t*he)},hr=m.getPageHeight=function(e){return lr(e=e||B)/he},mr=m.setPageHeight=function(e,t){cr(e,t*he)};return m.internal={pdfEscape:rt,getStyle:jt,getFont:Ft,getFontSize:ae,getCharSpace:Jt,getTextColor:Yt,getLineHeight:Bt,getLineHeightFactor:Ut,getLineWidth:Rt,write:Z,getHorizontalCoordinate:Vt,getVerticalCoordinate:qt,getCoordinateString:Ht,getVerticalCoordinateString:Gt,collections:{},newObject:Me,newAdditionalObject:Be,newObjectDeferred:Re,newObjectDeferredBegin:Oe,getFilters:He,putStream:Ge,events:_e,scaleFactor:he,pageSize:{getWidth:function(){return dr(B)},setWidth:function(e){ur(B,e)},getHeight:function(){return hr(B)},setHeight:function(e){mr(B,e)}},encryptionOptions:d,encryption:yt,getEncryptor:function(e){return null!==d?yt.encryptor(e,0):function(e){return e}},output:pt,getNumberOfPages:ot,pages:K,out:J,f2:E,f3:A,getPageInfo:vt,getPageInfoByObjId:bt,getCurrentPageInfo:wt,getPDFVersion:g,Point:tr,Rectangle:rr,Matrix:Te,hasHotfix:xt},Object.defineProperty(m.internal.pageSize,"width",{get:function(){return dr(B)},set:function(e){ur(B,e)},enumerable:!0,configurable:!0}),Object.defineProperty(m.internal.pageSize,"height",{get:function(){return hr(B)},set:function(e){mr(B,e)},enumerable:!0,configurable:!0}),function(e){for(var t=0,r=ee.length;t<r;t++){var a=tt.call(this,e[t][0],e[t][1],e[t][2],ee[t][3],!0);!1===u&&(h[a]=!0);var n=e[t][0].split("-");et({id:a,fontName:n[0],fontStyle:n[1]||""})}_e.publish("addFonts",{fonts:pe,dictionary:xe})}.call(m,ee),ue="F1",nt(n,r),_e.publish("initialized"),m}cx.prototype.lsbFirstWord=function(e){return String.fromCharCode(255&e,e>>8&255,e>>16&255,e>>24&255)},cx.prototype.toHexString=function(e){return e.split("").map(function(e){return("0"+(255&e.charCodeAt(0)).toString(16)).slice(-2)}).join("")},cx.prototype.hexToBytes=function(e){for(var t=[],r=0;r<e.length;r+=2)t.push(String.fromCharCode(parseInt(e.substr(r,2),16)));return t.join("")},cx.prototype.processOwnerPassword=function(e,t){return ox(nx(t).substr(0,5),e)},cx.prototype.encryptor=function(e,t){var r=nx(this.encryptionKey+String.fromCharCode(255&e,e>>8&255,e>>16&255,255&t,t>>8&255)).substr(0,10);return function(e){return ox(r,e)}},hx.prototype.equals=function(e){var t,r="id,objectNumber,equals";if(!e||(0,ju.A)(e)!==(0,ju.A)(this))return!1;var a=0;for(t in this)if(!(r.indexOf(t)>=0)){if(this.hasOwnProperty(t)&&!e.hasOwnProperty(t))return!1;if(this[t]!==e[t])return!1;a++}for(t in e)e.hasOwnProperty(t)&&r.indexOf(t)<0&&a--;return 0===a},px.API={events:[]},px.version="3.0.3";var xx=px.API,yx=1,vx=function(e){return e.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},bx=function(e){return e.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},wx=function(e){return e.toFixed(2)},kx=function(e){return e.toFixed(5)};xx.__acroform__={};var Nx=function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e},jx=function(e){return e*yx},Sx=function(e){var t=new Ux,r=ty.internal.getHeight(e)||0,a=ty.internal.getWidth(e)||0;return t.BBox=[0,0,Number(wx(a)),Number(wx(r))],t},_x=xx.__acroform__.setBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return e|1<<t},Ex=xx.__acroform__.clearBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return e&~(1<<t)},Ax=xx.__acroform__.getBit=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return e&1<<t?1:0},Cx=xx.__acroform__.getBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return Ax(e,t-1)},Ix=xx.__acroform__.setBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return _x(e,t-1)},Tx=xx.__acroform__.clearBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return Ex(e,t-1)},Dx=xx.__acroform__.calculateCoordinates=function(e,t){var r=t.internal.getHorizontalCoordinate,a=t.internal.getVerticalCoordinate,n=e[0],s=e[1],i=e[2],o=e[3],l={};return l.lowerLeft_X=r(n)||0,l.lowerLeft_Y=a(s+o)||0,l.upperRight_X=r(n+i)||0,l.upperRight_Y=a(s)||0,[Number(wx(l.lowerLeft_X)),Number(wx(l.lowerLeft_Y)),Number(wx(l.upperRight_X)),Number(wx(l.upperRight_Y))]},Px=function(e){if(e.appearanceStreamContent)return e.appearanceStreamContent;if(e.V||e.DV){var t=[],r=e._V||e.DV,a=Fx(e,r),n=e.scope.internal.getFont(e.fontName,e.fontStyle).id;t.push("/Tx BMC"),t.push("q"),t.push("BT"),t.push(e.scope.__private__.encodeColorString(e.color)),t.push("/"+n+" "+wx(a.fontSize)+" Tf"),t.push("1 0 0 1 0 0 Tm"),t.push(a.text),t.push("ET"),t.push("Q"),t.push("EMC");var s=Sx(e);return s.scope=e.scope,s.stream=t.join("\n"),s}},Fx=function(e,t){var r=0===e.fontSize?e.maxFontSize:e.fontSize,a={text:"",fontSize:""},n=(t=")"==(t="("==t.substr(0,1)?t.substr(1):t).substr(t.length-1)?t.substr(0,t.length-1):t).split(" ");n=e.multiline?n.map(function(e){return e.split("\n")}):n.map(function(e){return[e]});var s=r,i=ty.internal.getHeight(e)||0;i=i<0?-i:i;var o=ty.internal.getWidth(e)||0;o=o<0?-o:o;var l=function(t,r,a){if(t+1<n.length){var s=r+" "+n[t+1][0];return Lx(s,e,a).width<=o-4}return!1};s++;e:for(;s>0;){t="",s--;var c,d,u=Lx("3",e,s).height,h=e.multiline?i-s:(i-u)/2,m=h+=2,f=0,g=0,p=0;if(s<=0){t="(...) Tj\n",t+="% Width of Text: "+Lx(t,e,s=12).width+", FieldWidth:"+o+"\n";break}for(var x="",y=0,v=0;v<n.length;v++)if(n.hasOwnProperty(v)){var b=!1;if(1!==n[v].length&&p!==n[v].length-1){if((u+2)*(y+2)+2>i)continue e;x+=n[v][p],b=!0,g=v,v--}else{x=" "==(x+=n[v][p]+" ").substr(x.length-1)?x.substr(0,x.length-1):x;var w=parseInt(v),k=l(w,x,s),N=v>=n.length-1;if(k&&!N){x+=" ",p=0;continue}if(k||N){if(N)g=w;else if(e.multiline&&(u+2)*(y+2)+2>i)continue e}else{if(!e.multiline)continue e;if((u+2)*(y+2)+2>i)continue e;g=w}}for(var j="",S=f;S<=g;S++){var _=n[S];if(e.multiline){if(S===g){j+=_[p]+" ",p=(p+1)%_.length;continue}if(S===f){j+=_[_.length-1]+" ";continue}}j+=_[0]+" "}switch(j=" "==j.substr(j.length-1)?j.substr(0,j.length-1):j,d=Lx(j,e,s).width,e.textAlign){case"right":c=o-d-2;break;case"center":c=(o-d)/2;break;default:c=2}t+=wx(c)+" "+wx(m)+" Td\n",t+="("+vx(j)+") Tj\n",t+=-wx(c)+" 0 Td\n",m=-(s+2),d=0,f=b?g:g+1,y++,x=""}break}return a.text=t,a.fontSize=s,a},Lx=function(e,t,r){var a=t.scope.internal.getFont(t.fontName,t.fontStyle),n=t.scope.getStringUnitWidth(e,{font:a,fontSize:parseFloat(r),charSpace:0})*parseFloat(r);return{height:t.scope.getStringUnitWidth("3",{font:a,fontSize:parseFloat(r),charSpace:0})*parseFloat(r)*1.5,width:n}},Mx={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},Rx=function(e,t){var r={type:"reference",object:e};void 0===t.internal.getPageInfo(e.page).pageContext.annotations.find(function(e){return e.type===r.type&&e.object===r.object})&&t.internal.getPageInfo(e.page).pageContext.annotations.push(r)},Ox=xx.__acroform__.arrayToPdfArray=function(e,t,r){var a=function(e){return e};if(Array.isArray(e)){for(var n="[",s=0;s<e.length;s++)switch(0!==s&&(n+=" "),(0,ju.A)(e[s])){case"boolean":case"number":case"object":n+=e[s].toString();break;case"string":"/"!==e[s].substr(0,1)?(void 0!==t&&r&&(a=r.internal.getEncryptor(t)),n+="("+vx(a(e[s].toString()))+")"):n+=e[s].toString()}return n+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},Bx=function(e,t,r){var a=function(e){return e};return void 0!==t&&r&&(a=r.internal.getEncryptor(t)),(e=e||"").toString(),"("+vx(a(e))+")"},zx=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(void 0===this._objId){if(void 0===this.scope)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(e){this._objId=e}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};zx.prototype.toString=function(){return this.objId+" 0 R"},zx.prototype.putStream=function(){var e=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:e,objectId:this.objId}),this.scope.internal.out("endobj")},zx.prototype.getKeyValueListForStream=function(){var e=[],t=Object.getOwnPropertyNames(this).filter(function(e){return"content"!=e&&"appearanceStreamContent"!=e&&"scope"!=e&&"objId"!=e&&"_"!=e.substring(0,1)});for(var r in t)if(!1===Object.getOwnPropertyDescriptor(this,t[r]).configurable){var a=t[r],n=this[a];n&&(Array.isArray(n)?e.push({key:a,value:Ox(n,this.objId,this.scope)}):n instanceof zx?(n.scope=this.scope,e.push({key:a,value:n.objId+" 0 R"})):"function"!=typeof n&&e.push({key:a,value:n}))}return e};var Ux=function(){zx.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var e,t=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return t},set:function(e){t=e}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(t){e=t.trim()},get:function(){return e||null}})};Nx(Ux,zx);var Vx=function(){zx.call(this);var e,t=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return t.length>0?t:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return t}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(e){var t=function(e){return e};return this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),"("+vx(t(e))+")"}},set:function(t){e=t}})};Nx(Vx,zx);var qx=function e(){zx.call(this);var t=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return t},set:function(e){if(isNaN(e))throw new Error('Invalid value "'+e+'" for attribute F supplied.');t=e}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return Boolean(Cx(t,3))},set:function(e){!0===Boolean(e)?this.F=Ix(t,3):this.F=Tx(t,3)}});var r=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return r},set:function(e){if(isNaN(e))throw new Error('Invalid value "'+e+'" for attribute Ff supplied.');r=e}});var a=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(0!==a.length)return a},set:function(e){a=void 0!==e?e:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!a||isNaN(a[0])?0:a[0]},set:function(e){a[0]=e}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!a||isNaN(a[1])?0:a[1]},set:function(e){a[1]=e}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!a||isNaN(a[2])?0:a[2]},set:function(e){a[2]=e}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!a||isNaN(a[3])?0:a[3]},set:function(e){a[3]=e}});var n="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return n},set:function(e){switch(e){case"/Btn":case"/Tx":case"/Ch":case"/Sig":n=e;break;default:throw new Error('Invalid value "'+e+'" for attribute FT supplied.')}}});var s=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!s||s.length<1){if(this instanceof Jx)return;s="FieldObject"+e.FieldNum++}var t=function(e){return e};return this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),"("+vx(t(s))+")"},set:function(e){s=e.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return s},set:function(e){s=e}});var i="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return i},set:function(e){i=e}});var o="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return o},set:function(e){o=e}});var l=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return l},set:function(e){l=e}});var c=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return void 0===c?50/yx:c},set:function(e){c=e}});var d="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return d},set:function(e){d=e}});var u="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!u||this instanceof Jx||this instanceof $x))return Bx(u,this.objId,this.scope)},set:function(e){e=e.toString(),u=e}});var h=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(h)return this instanceof Qx==0?Bx(h,this.objId,this.scope):h},set:function(e){e=e.toString(),h=this instanceof Qx==0?"("===e.substr(0,1)?bx(e.substr(1,e.length-2)):bx(e):e}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof Qx==1?bx(h.substr(1,h.length-1)):h},set:function(e){e=e.toString(),h=this instanceof Qx==1?"/"+e:e}});var m=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(m)return m},set:function(e){this.V=e}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(m)return this instanceof Qx==0?Bx(m,this.objId,this.scope):m},set:function(e){e=e.toString(),m=this instanceof Qx==0?"("===e.substr(0,1)?bx(e.substr(1,e.length-2)):bx(e):e}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof Qx==1?bx(m.substr(1,m.length-1)):m},set:function(e){e=e.toString(),m=this instanceof Qx==1?"/"+e:e}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var f,g=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return g},set:function(e){e=Boolean(e),g=e}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(f)return f},set:function(e){f=e}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return Boolean(Cx(this.Ff,1))},set:function(e){!0===Boolean(e)?this.Ff=Ix(this.Ff,1):this.Ff=Tx(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return Boolean(Cx(this.Ff,2))},set:function(e){!0===Boolean(e)?this.Ff=Ix(this.Ff,2):this.Ff=Tx(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return Boolean(Cx(this.Ff,3))},set:function(e){!0===Boolean(e)?this.Ff=Ix(this.Ff,3):this.Ff=Tx(this.Ff,3)}});var p=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(null!==p)return p},set:function(e){if(-1===[0,1,2].indexOf(e))throw new Error('Invalid value "'+e+'" for attribute Q supplied.');p=e}}),Object.defineProperty(this,"textAlign",{get:function(){var e;switch(p){case 0:default:e="left";break;case 1:e="center";break;case 2:e="right"}return e},configurable:!0,enumerable:!0,set:function(e){switch(e){case"right":case 2:p=2;break;case"center":case 1:p=1;break;default:p=0}}})};Nx(qx,zx);var Hx=function(){qx.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var e=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return e},set:function(t){e=t}});var t=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return Ox(t,this.objId,this.scope)},set:function(e){var r,a;a=[],"string"==typeof(r=e)&&(a=function(e,t,r){r||(r=1);for(var a,n=[];a=t.exec(e);)n.push(a[r]);return n}(r,/\((.*?)\)/g)),t=a}}),this.getOptions=function(){return t},this.setOptions=function(e){t=e,this.sort&&t.sort()},this.addOption=function(e){e=(e=e||"").toString(),t.push(e),this.sort&&t.sort()},this.removeOption=function(e,r){for(r=r||!1,e=(e=e||"").toString();-1!==t.indexOf(e)&&(t.splice(t.indexOf(e),1),!1!==r););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return Boolean(Cx(this.Ff,18))},set:function(e){!0===Boolean(e)?this.Ff=Ix(this.Ff,18):this.Ff=Tx(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return Boolean(Cx(this.Ff,19))},set:function(e){!0===this.combo&&(!0===Boolean(e)?this.Ff=Ix(this.Ff,19):this.Ff=Tx(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return Boolean(Cx(this.Ff,20))},set:function(e){!0===Boolean(e)?(this.Ff=Ix(this.Ff,20),t.sort()):this.Ff=Tx(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return Boolean(Cx(this.Ff,22))},set:function(e){!0===Boolean(e)?this.Ff=Ix(this.Ff,22):this.Ff=Tx(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return Boolean(Cx(this.Ff,23))},set:function(e){!0===Boolean(e)?this.Ff=Ix(this.Ff,23):this.Ff=Tx(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return Boolean(Cx(this.Ff,27))},set:function(e){!0===Boolean(e)?this.Ff=Ix(this.Ff,27):this.Ff=Tx(this.Ff,27)}}),this.hasAppearanceStream=!1};Nx(Hx,qx);var Gx=function(){Hx.call(this),this.fontName="helvetica",this.combo=!1};Nx(Gx,Hx);var Wx=function(){Gx.call(this),this.combo=!0};Nx(Wx,Gx);var Kx=function(){Wx.call(this),this.edit=!0};Nx(Kx,Wx);var Qx=function(){qx.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return Boolean(Cx(this.Ff,15))},set:function(e){!0===Boolean(e)?this.Ff=Ix(this.Ff,15):this.Ff=Tx(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return Boolean(Cx(this.Ff,16))},set:function(e){!0===Boolean(e)?this.Ff=Ix(this.Ff,16):this.Ff=Tx(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return Boolean(Cx(this.Ff,17))},set:function(e){!0===Boolean(e)?this.Ff=Ix(this.Ff,17):this.Ff=Tx(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return Boolean(Cx(this.Ff,26))},set:function(e){!0===Boolean(e)?this.Ff=Ix(this.Ff,26):this.Ff=Tx(this.Ff,26)}});var e,t={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var e=function(e){return e};if(this.scope&&(e=this.scope.internal.getEncryptor(this.objId)),0!==Object.keys(t).length){var r,a=[];for(r in a.push("<<"),t)a.push("/"+r+" ("+vx(e(t[r]))+")");return a.push(">>"),a.join("\n")}},set:function(e){"object"===(0,ju.A)(e)&&(t=e)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return t.CA||""},set:function(e){"string"==typeof e&&(t.CA=e)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return e.substr(1,e.length-1)},set:function(t){e="/"+t}})};Nx(Qx,qx);var Yx=function(){Qx.call(this),this.pushButton=!0};Nx(Yx,Qx);var Xx=function(){Qx.call(this),this.radio=!0,this.pushButton=!1;var e=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=void 0!==t?t:[]}})};Nx(Xx,Qx);var Jx=function(){var e,t;qx.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return t},set:function(e){t=e}});var r,a={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var e=function(e){return e};this.scope&&(e=this.scope.internal.getEncryptor(this.objId));var t,r=[];for(t in r.push("<<"),a)r.push("/"+t+" ("+vx(e(a[t]))+")");return r.push(">>"),r.join("\n")},set:function(e){"object"===(0,ju.A)(e)&&(a=e)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return a.CA||""},set:function(e){"string"==typeof e&&(a.CA=e)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(e){r=e}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(e){r="/"+e}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=ty.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};Nx(Jx,qx),Xx.prototype.setAppearance=function(e){if(!("createAppearanceStream"in e)||!("getCA"in e))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var t in this.Kids)if(this.Kids.hasOwnProperty(t)){var r=this.Kids[t];r.appearanceStreamContent=e.createAppearanceStream(r.optionName),r.caption=e.getCA()}},Xx.prototype.createOption=function(e){var t=new Jx;return t.Parent=this,t.optionName=e,this.Kids.push(t),ry.call(this.scope,t),t};var Zx=function(){Qx.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=ty.CheckBox.createAppearanceStream()};Nx(Zx,Qx);var $x=function(){qx.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return Boolean(Cx(this.Ff,13))},set:function(e){!0===Boolean(e)?this.Ff=Ix(this.Ff,13):this.Ff=Tx(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return Boolean(Cx(this.Ff,21))},set:function(e){!0===Boolean(e)?this.Ff=Ix(this.Ff,21):this.Ff=Tx(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return Boolean(Cx(this.Ff,23))},set:function(e){!0===Boolean(e)?this.Ff=Ix(this.Ff,23):this.Ff=Tx(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return Boolean(Cx(this.Ff,24))},set:function(e){!0===Boolean(e)?this.Ff=Ix(this.Ff,24):this.Ff=Tx(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return Boolean(Cx(this.Ff,25))},set:function(e){!0===Boolean(e)?this.Ff=Ix(this.Ff,25):this.Ff=Tx(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return Boolean(Cx(this.Ff,26))},set:function(e){!0===Boolean(e)?this.Ff=Ix(this.Ff,26):this.Ff=Tx(this.Ff,26)}});var e=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return e},set:function(t){Number.isInteger(t)&&(e=t)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};Nx($x,qx);var ey=function(){$x.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return Boolean(Cx(this.Ff,14))},set:function(e){!0===Boolean(e)?this.Ff=Ix(this.Ff,14):this.Ff=Tx(this.Ff,14)}}),this.password=!0};Nx(ey,$x);var ty={CheckBox:{createAppearanceStream:function(){return{N:{On:ty.CheckBox.YesNormal},D:{On:ty.CheckBox.YesPushDown,Off:ty.CheckBox.OffPushDown}}},YesPushDown:function(e){var t=Sx(e);t.scope=e.scope;var r=[],a=e.scope.internal.getFont(e.fontName,e.fontStyle).id,n=e.scope.__private__.encodeColorString(e.color),s=Fx(e,e.caption);return r.push("0.749023 g"),r.push("0 0 "+wx(ty.internal.getWidth(e))+" "+wx(ty.internal.getHeight(e))+" re"),r.push("f"),r.push("BMC"),r.push("q"),r.push("0 0 1 rg"),r.push("/"+a+" "+wx(s.fontSize)+" Tf "+n),r.push("BT"),r.push(s.text),r.push("ET"),r.push("Q"),r.push("EMC"),t.stream=r.join("\n"),t},YesNormal:function(e){var t=Sx(e);t.scope=e.scope;var r=e.scope.internal.getFont(e.fontName,e.fontStyle).id,a=e.scope.__private__.encodeColorString(e.color),n=[],s=ty.internal.getHeight(e),i=ty.internal.getWidth(e),o=Fx(e,e.caption);return n.push("1 g"),n.push("0 0 "+wx(i)+" "+wx(s)+" re"),n.push("f"),n.push("q"),n.push("0 0 1 rg"),n.push("0 0 "+wx(i-1)+" "+wx(s-1)+" re"),n.push("W"),n.push("n"),n.push("0 g"),n.push("BT"),n.push("/"+r+" "+wx(o.fontSize)+" Tf "+a),n.push(o.text),n.push("ET"),n.push("Q"),t.stream=n.join("\n"),t},OffPushDown:function(e){var t=Sx(e);t.scope=e.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+wx(ty.internal.getWidth(e))+" "+wx(ty.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join("\n"),t}},RadioButton:{Circle:{createAppearanceStream:function(e){var t={D:{Off:ty.RadioButton.Circle.OffPushDown},N:{}};return t.N[e]=ty.RadioButton.Circle.YesNormal,t.D[e]=ty.RadioButton.Circle.YesPushDown,t},getCA:function(){return"l"},YesNormal:function(e){var t=Sx(e);t.scope=e.scope;var r=[],a=ty.internal.getWidth(e)<=ty.internal.getHeight(e)?ty.internal.getWidth(e)/4:ty.internal.getHeight(e)/4;a=Number((.9*a).toFixed(5));var n=ty.internal.Bezier_C,s=Number((a*n).toFixed(5));return r.push("q"),r.push("1 0 0 1 "+kx(ty.internal.getWidth(e)/2)+" "+kx(ty.internal.getHeight(e)/2)+" cm"),r.push(a+" 0 m"),r.push(a+" "+s+" "+s+" "+a+" 0 "+a+" c"),r.push("-"+s+" "+a+" -"+a+" "+s+" -"+a+" 0 c"),r.push("-"+a+" -"+s+" -"+s+" -"+a+" 0 -"+a+" c"),r.push(s+" -"+a+" "+a+" -"+s+" "+a+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join("\n"),t},YesPushDown:function(e){var t=Sx(e);t.scope=e.scope;var r=[],a=ty.internal.getWidth(e)<=ty.internal.getHeight(e)?ty.internal.getWidth(e)/4:ty.internal.getHeight(e)/4;a=Number((.9*a).toFixed(5));var n=Number((2*a).toFixed(5)),s=Number((n*ty.internal.Bezier_C).toFixed(5)),i=Number((a*ty.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+kx(ty.internal.getWidth(e)/2)+" "+kx(ty.internal.getHeight(e)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+s+" "+s+" "+n+" 0 "+n+" c"),r.push("-"+s+" "+n+" -"+n+" "+s+" -"+n+" 0 c"),r.push("-"+n+" -"+s+" -"+s+" -"+n+" 0 -"+n+" c"),r.push(s+" -"+n+" "+n+" -"+s+" "+n+" 0 c"),r.push("f"),r.push("Q"),r.push("0 g"),r.push("q"),r.push("1 0 0 1 "+kx(ty.internal.getWidth(e)/2)+" "+kx(ty.internal.getHeight(e)/2)+" cm"),r.push(a+" 0 m"),r.push(a+" "+i+" "+i+" "+a+" 0 "+a+" c"),r.push("-"+i+" "+a+" -"+a+" "+i+" -"+a+" 0 c"),r.push("-"+a+" -"+i+" -"+i+" -"+a+" 0 -"+a+" c"),r.push(i+" -"+a+" "+a+" -"+i+" "+a+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join("\n"),t},OffPushDown:function(e){var t=Sx(e);t.scope=e.scope;var r=[],a=ty.internal.getWidth(e)<=ty.internal.getHeight(e)?ty.internal.getWidth(e)/4:ty.internal.getHeight(e)/4;a=Number((.9*a).toFixed(5));var n=Number((2*a).toFixed(5)),s=Number((n*ty.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+kx(ty.internal.getWidth(e)/2)+" "+kx(ty.internal.getHeight(e)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+s+" "+s+" "+n+" 0 "+n+" c"),r.push("-"+s+" "+n+" -"+n+" "+s+" -"+n+" 0 c"),r.push("-"+n+" -"+s+" -"+s+" -"+n+" 0 -"+n+" c"),r.push(s+" -"+n+" "+n+" -"+s+" "+n+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join("\n"),t}},Cross:{createAppearanceStream:function(e){var t={D:{Off:ty.RadioButton.Cross.OffPushDown},N:{}};return t.N[e]=ty.RadioButton.Cross.YesNormal,t.D[e]=ty.RadioButton.Cross.YesPushDown,t},getCA:function(){return"8"},YesNormal:function(e){var t=Sx(e);t.scope=e.scope;var r=[],a=ty.internal.calculateCross(e);return r.push("q"),r.push("1 1 "+wx(ty.internal.getWidth(e)-2)+" "+wx(ty.internal.getHeight(e)-2)+" re"),r.push("W"),r.push("n"),r.push(wx(a.x1.x)+" "+wx(a.x1.y)+" m"),r.push(wx(a.x2.x)+" "+wx(a.x2.y)+" l"),r.push(wx(a.x4.x)+" "+wx(a.x4.y)+" m"),r.push(wx(a.x3.x)+" "+wx(a.x3.y)+" l"),r.push("s"),r.push("Q"),t.stream=r.join("\n"),t},YesPushDown:function(e){var t=Sx(e);t.scope=e.scope;var r=ty.internal.calculateCross(e),a=[];return a.push("0.749023 g"),a.push("0 0 "+wx(ty.internal.getWidth(e))+" "+wx(ty.internal.getHeight(e))+" re"),a.push("f"),a.push("q"),a.push("1 1 "+wx(ty.internal.getWidth(e)-2)+" "+wx(ty.internal.getHeight(e)-2)+" re"),a.push("W"),a.push("n"),a.push(wx(r.x1.x)+" "+wx(r.x1.y)+" m"),a.push(wx(r.x2.x)+" "+wx(r.x2.y)+" l"),a.push(wx(r.x4.x)+" "+wx(r.x4.y)+" m"),a.push(wx(r.x3.x)+" "+wx(r.x3.y)+" l"),a.push("s"),a.push("Q"),t.stream=a.join("\n"),t},OffPushDown:function(e){var t=Sx(e);t.scope=e.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+wx(ty.internal.getWidth(e))+" "+wx(ty.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join("\n"),t}}},createDefaultAppearanceStream:function(e){var t=e.scope.internal.getFont(e.fontName,e.fontStyle).id,r=e.scope.__private__.encodeColorString(e.color);return"/"+t+" "+e.fontSize+" Tf "+r}};ty.internal={Bezier_C:.551915024494,calculateCross:function(e){var t=ty.internal.getWidth(e),r=ty.internal.getHeight(e),a=Math.min(t,r);return{x1:{x:(t-a)/2,y:(r-a)/2+a},x2:{x:(t-a)/2+a,y:(r-a)/2},x3:{x:(t-a)/2,y:(r-a)/2},x4:{x:(t-a)/2+a,y:(r-a)/2+a}}}},ty.internal.getWidth=function(e){var t=0;return"object"===(0,ju.A)(e)&&(t=jx(e.Rect[2])),t},ty.internal.getHeight=function(e){var t=0;return"object"===(0,ju.A)(e)&&(t=jx(e.Rect[3])),t};var ry=xx.addField=function(e){if(function(e,t){if(t.scope=e,void 0!==e.internal&&(void 0===e.internal.acroformPlugin||!1===e.internal.acroformPlugin.isInitialized)){if(qx.FieldNum=0,e.internal.acroformPlugin=JSON.parse(JSON.stringify(Mx)),e.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");yx=e.internal.scaleFactor,e.internal.acroformPlugin.acroFormDictionaryRoot=new Vx,e.internal.acroformPlugin.acroFormDictionaryRoot.scope=e,e.internal.acroformPlugin.acroFormDictionaryRoot._eventID=e.internal.events.subscribe("postPutResources",function(){var t;(t=e).internal.events.unsubscribe(t.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete t.internal.acroformPlugin.acroFormDictionaryRoot._eventID,t.internal.acroformPlugin.printedOut=!0}),e.internal.events.subscribe("buildDocument",function(){!function(e){e.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var t=e.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var r in t)if(t.hasOwnProperty(r)){var a=t[r];a.objId=void 0,a.hasAnnotation&&Rx(a,e)}}(e)}),e.internal.events.subscribe("putCatalog",function(){!function(e){if(void 0===e.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("putCatalogCallback: Root missing.");e.internal.write("/AcroForm "+e.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")}(e)}),e.internal.events.subscribe("postPutPages",function(t){!function(e,t){var r=!e;for(var a in e||(t.internal.newObjectDeferredBegin(t.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),t.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),e=e||t.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(e.hasOwnProperty(a)){var n=e[a],s=[],i=n.Rect;if(n.Rect&&(n.Rect=Dx(n.Rect,t)),t.internal.newObjectDeferredBegin(n.objId,!0),n.DA=ty.createDefaultAppearanceStream(n),"object"===(0,ju.A)(n)&&"function"==typeof n.getKeyValueListForStream&&(s=n.getKeyValueListForStream()),n.Rect=i,n.hasAppearanceStream&&!n.appearanceStreamContent){var o=Px(n);s.push({key:"AP",value:"<</N "+o+">>"}),t.internal.acroformPlugin.xForms.push(o)}if(n.appearanceStreamContent){var l="";for(var c in n.appearanceStreamContent)if(n.appearanceStreamContent.hasOwnProperty(c)){var d=n.appearanceStreamContent[c];if(l+="/"+c+" ",l+="<<",Object.keys(d).length>=1||Array.isArray(d)){for(var a in d)if(d.hasOwnProperty(a)){var u=d[a];"function"==typeof u&&(u=u.call(t,n)),l+="/"+a+" "+u+" ",t.internal.acroformPlugin.xForms.indexOf(u)>=0||t.internal.acroformPlugin.xForms.push(u)}}else"function"==typeof(u=d)&&(u=u.call(t,n)),l+="/"+a+" "+u,t.internal.acroformPlugin.xForms.indexOf(u)>=0||t.internal.acroformPlugin.xForms.push(u);l+=">>"}s.push({key:"AP",value:"<<\n"+l+">>"})}t.internal.putStream({additionalKeyValues:s,objectId:n.objId}),t.internal.out("endobj")}r&&function(e,t){for(var r in e)if(e.hasOwnProperty(r)){var a=r,n=e[r];t.internal.newObjectDeferredBegin(n.objId,!0),"object"===(0,ju.A)(n)&&"function"==typeof n.putStream&&n.putStream(),delete e[a]}}(t.internal.acroformPlugin.xForms,t)}(t,e)}),e.internal.acroformPlugin.isInitialized=!0}}(this,e),!(e instanceof qx))throw new Error("Invalid argument passed to jsPDF.addField.");var t;return(t=e).scope.internal.acroformPlugin.printedOut&&(t.scope.internal.acroformPlugin.printedOut=!1,t.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),t.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(t),e.page=e.scope.internal.getCurrentPageInfo().pageNumber,this};xx.AcroFormChoiceField=Hx,xx.AcroFormListBox=Gx,xx.AcroFormComboBox=Wx,xx.AcroFormEditBox=Kx,xx.AcroFormButton=Qx,xx.AcroFormPushButton=Yx,xx.AcroFormRadioButton=Xx,xx.AcroFormCheckBox=Zx,xx.AcroFormTextField=$x,xx.AcroFormPasswordField=ey,xx.AcroFormAppearance=ty,xx.AcroForm={ChoiceField:Hx,ListBox:Gx,ComboBox:Wx,EditBox:Kx,Button:Qx,PushButton:Yx,RadioButton:Xx,CheckBox:Zx,TextField:$x,PasswordField:ey,Appearance:ty},px.AcroForm={ChoiceField:Hx,ListBox:Gx,ComboBox:Wx,EditBox:Kx,Button:Qx,PushButton:Yx,RadioButton:Xx,CheckBox:Zx,TextField:$x,PasswordField:ey,Appearance:ty};px.AcroForm;function ay(e){return e.reduce(function(e,t,r){return e[t]=r,e},{})}!function(e){var t="addImage_";e.__addimage__={};var r="UNKNOWN",a={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},n=e.__addimage__.getImageFileTypeByImageData=function(e,t){var n,s,i,o,l,c=r;if("RGBA"===(t=t||r)||void 0!==e.data&&e.data instanceof Uint8ClampedArray&&"height"in e&&"width"in e)return"RGBA";if(k(e))for(l in a)for(i=a[l],n=0;n<i.length;n+=1){for(o=!0,s=0;s<i[n].length;s+=1)if(void 0!==i[n][s]&&i[n][s]!==e[s]){o=!1;break}if(!0===o){c=l;break}}else for(l in a)for(i=a[l],n=0;n<i.length;n+=1){for(o=!0,s=0;s<i[n].length;s+=1)if(void 0!==i[n][s]&&i[n][s]!==e.charCodeAt(s)){o=!1;break}if(!0===o){c=l;break}}return c===r&&t!==r&&(c=t),c},s=function e(t){for(var r=this.internal.write,a=this.internal.putStream,n=(0,this.internal.getFilters)();-1!==n.indexOf("FlateEncode");)n.splice(n.indexOf("FlateEncode"),1);t.objectId=this.internal.newObject();var s=[];if(s.push({key:"Type",value:"/XObject"}),s.push({key:"Subtype",value:"/Image"}),s.push({key:"Width",value:t.width}),s.push({key:"Height",value:t.height}),t.colorSpace===x.INDEXED?s.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(t.palette.length/3-1)+" "+("sMask"in t&&void 0!==t.sMask?t.objectId+2:t.objectId+1)+" 0 R]"}):(s.push({key:"ColorSpace",value:"/"+t.colorSpace}),t.colorSpace===x.DEVICE_CMYK&&s.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),s.push({key:"BitsPerComponent",value:t.bitsPerComponent}),"decodeParameters"in t&&void 0!==t.decodeParameters&&s.push({key:"DecodeParms",value:"<<"+t.decodeParameters+">>"}),"transparency"in t&&Array.isArray(t.transparency)&&t.transparency.length>0){for(var i="",o=0,l=t.transparency.length;o<l;o++)i+=t.transparency[o]+" "+t.transparency[o]+" ";s.push({key:"Mask",value:"["+i+"]"})}void 0!==t.sMask&&s.push({key:"SMask",value:t.objectId+1+" 0 R"});var c=void 0!==t.filter?["/"+t.filter]:void 0;if(a({data:t.data,additionalKeyValues:s,alreadyAppliedFilters:c,objectId:t.objectId}),r("endobj"),"sMask"in t&&void 0!==t.sMask){var d,u=null!==(d=t.sMaskBitsPerComponent)&&void 0!==d?d:t.bitsPerComponent,h={width:t.width,height:t.height,colorSpace:"DeviceGray",bitsPerComponent:u,data:t.sMask};"filter"in t&&(h.decodeParameters="/Predictor ".concat(t.predictor," /Colors 1 /BitsPerComponent ").concat(u," /Columns ").concat(t.width),h.filter=t.filter),e.call(this,h)}if(t.colorSpace===x.INDEXED){var m=this.internal.newObject();a({data:j(new Uint8Array(t.palette)),objectId:m}),r("endobj")}},i=function(){var e=this.internal.collections[t+"images"];for(var r in e)s.call(this,e[r])},o=function(){var e,r=this.internal.collections[t+"images"],a=this.internal.write;for(var n in r)a("/I"+(e=r[n]).index,e.objectId,"0","R")},l=function(){this.internal.collections[t+"images"]||(this.internal.collections[t+"images"]={},this.internal.events.subscribe("putResources",i),this.internal.events.subscribe("putXobjectDict",o))},c=function(){var e=this.internal.collections[t+"images"];return l.call(this),e},d=function(){return Object.keys(this.internal.collections[t+"images"]).length},u=function(t){return"function"==typeof e["process"+t.toUpperCase()]},h=function(e){return"object"===(0,ju.A)(e)&&1===e.nodeType},m=function(t,r){if("IMG"===t.nodeName&&t.hasAttribute("src")){var a=""+t.getAttribute("src");if(0===a.indexOf("data:image/"))return Gp(unescape(a).split("base64,").pop());var n=e.loadFile(a,!0);if(void 0!==n)return n}if("CANVAS"===t.nodeName){if(0===t.width||0===t.height)throw new Error("Given canvas must have data. Canvas width: "+t.width+", height: "+t.height);var s;switch(r){case"PNG":s="image/png";break;case"WEBP":s="image/webp";break;default:s="image/jpeg"}return Gp(t.toDataURL(s,1).split("base64,").pop())}},f=function(e){var r=this.internal.collections[t+"images"];if(r)for(var a in r)if(e===r[a].alias)return r[a]},g=function(e,t,r){return e||t||(e=-96,t=-96),e<0&&(e=-1*r.width*72/e/this.internal.scaleFactor),t<0&&(t=-1*r.height*72/t/this.internal.scaleFactor),0===e&&(e=t*r.width/r.height),0===t&&(t=e*r.height/r.width),[e,t]},p=function(e,t,r,a,n,s){var i=g.call(this,r,a,n),o=this.internal.getCoordinateString,l=this.internal.getVerticalCoordinateString,d=c.call(this);if(r=i[0],a=i[1],d[n.index]=n,s){s*=Math.PI/180;var u=Math.cos(s),h=Math.sin(s),m=function(e){return e.toFixed(4)},f=[m(u),m(h),m(-1*h),m(u),0,0,"cm"]}this.internal.write("q"),s?(this.internal.write([1,"0","0",1,o(e),l(t+a),"cm"].join(" ")),this.internal.write(f.join(" ")),this.internal.write([o(r),"0","0",o(a),"0","0","cm"].join(" "))):this.internal.write([o(r),"0","0",o(a),o(e),l(t+a),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+n.index+" Do"),this.internal.write("Q")},x=e.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};e.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var y=e.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},v=e.__addimage__.sHashCode=function(e){var t,r,a=0;if("string"==typeof e)for(r=e.length,t=0;t<r;t++)a=(a<<5)-a+e.charCodeAt(t),a|=0;else if(k(e))for(r=e.byteLength/2,t=0;t<r;t++)a=(a<<5)-a+e[t],a|=0;return a},b=e.__addimage__.validateStringAsBase64=function(e){(e=e||"").toString().trim();var t=!0;return 0===e.length&&(t=!1),e.length%4!=0&&(t=!1),!1===/^[A-Za-z0-9+/]+$/.test(e.substr(0,e.length-2))&&(t=!1),!1===/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(e.substr(-2))&&(t=!1),t},w=e.__addimage__.extractImageFromDataUrl=function(e){if(null==e)return null;if(!(e=e.trim()).startsWith("data:"))return null;var t=e.indexOf(",");return t<0?null:e.substring(0,t).trim().endsWith("base64")?e.substring(t+1):null};e.__addimage__.isArrayBuffer=function(e){return e instanceof ArrayBuffer};var k=e.__addimage__.isArrayBufferView=function(e){return e instanceof Int8Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array||e instanceof Float64Array},N=e.__addimage__.binaryStringToUint8Array=function(e){for(var t=e.length,r=new Uint8Array(t),a=0;a<t;a++)r[a]=e.charCodeAt(a);return r},j=e.__addimage__.arrayBufferToBinaryString=function(e){for(var t="",r=k(e)?e:new Uint8Array(e),a=0;a<r.length;a+=8192)t+=String.fromCharCode.apply(null,r.subarray(a,a+8192));return t};e.addImage=function(){var e,t,a,n,s,i,o,c,d;if("number"==typeof arguments[1]?(t=r,a=arguments[1],n=arguments[2],s=arguments[3],i=arguments[4],o=arguments[5],c=arguments[6],d=arguments[7]):(t=arguments[1],a=arguments[2],n=arguments[3],s=arguments[4],i=arguments[5],o=arguments[6],c=arguments[7],d=arguments[8]),"object"===(0,ju.A)(e=arguments[0])&&!h(e)&&"imageData"in e){var u=e;e=u.imageData,t=u.format||t||r,a=u.x||a||0,n=u.y||n||0,s=u.w||u.width||s,i=u.h||u.height||i,o=u.alias||o,c=u.compression||c,d=u.rotation||u.angle||d}var m=this.internal.getFilters();if(void 0===c&&-1!==m.indexOf("FlateEncode")&&(c="SLOW"),isNaN(a)||isNaN(n))throw new Error("Invalid coordinates passed to jsPDF.addImage");l.call(this);var f=S.call(this,e,t,o,c);return p.call(this,a,n,s,i,f,d),this};var S=function(t,a,s,i){var o,l,c;if("string"==typeof t&&n(t)===r){t=unescape(t);var g=_(t,!1);(""!==g||void 0!==(g=e.loadFile(t,!0)))&&(t=g)}if(h(t)&&(t=m(t,a)),a=n(t,a),!u(a))throw new Error("addImage does not support files of type '"+a+"', please ensure that a plugin for '"+a+"' support is added.");if((null==(c=s)||0===c.length)&&(s=function(e){return"string"==typeof e||k(e)?v(e):k(e.data)?v(e.data):null}(t)),(o=f.call(this,s))||(t instanceof Uint8Array||"RGBA"===a||(l=t,t=N(t)),o=this["process"+a.toUpperCase()](t,d.call(this),s,function(t){return t&&"string"==typeof t&&(t=t.toUpperCase()),t in e.image_compression?t:y.NONE}(i),l)),!o)throw new Error("An unknown error occurred whilst processing the image.");return o},_=e.__addimage__.convertBase64ToBinaryString=function(e,t){t="boolean"!=typeof t||t;var r,a="";if("string"==typeof e){var s;r=null!==(s=w(e))&&void 0!==s?s:e;try{a=Gp(r)}catch(n){if(t)throw b(r)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+n.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return a};e.getImageProperties=function(t){var a,s,i="";if(h(t)&&(t=m(t)),"string"==typeof t&&n(t)===r&&(""===(i=_(t,!1))&&(i=e.loadFile(t)||""),t=i),s=n(t),!u(s))throw new Error("addImage does not support files of type '"+s+"', please ensure that a plugin for '"+s+"' support is added.");if(t instanceof Uint8Array||(t=N(t)),!(a=this["process"+s.toUpperCase()](t)))throw new Error("An unknown error occurred whilst processing the image");return a.fileType=s,a}}(px.API),function(e){var t=function(e){if(void 0!==e&&""!=e)return!0};px.API.events.push(["addPage",function(e){this.internal.getPageInfo(e.pageNumber).pageContext.annotations=[]}]),e.events.push(["putPage",function(e){for(var r,a,n,s=this.internal.getCoordinateString,i=this.internal.getVerticalCoordinateString,o=this.internal.getPageInfoByObjId(e.objId),l=e.pageContext.annotations,c=!1,d=0;d<l.length&&!c;d++)switch((r=l[d]).type){case"link":(t(r.options.url)||t(r.options.pageNumber))&&(c=!0);break;case"reference":case"text":case"freetext":c=!0}if(0!=c){this.internal.write("/Annots [");for(var u=0;u<l.length;u++){r=l[u];var h=this.internal.pdfEscape,m=this.internal.getEncryptor(e.objId);switch(r.type){case"reference":this.internal.write(" "+r.object.objId+" 0 R ");break;case"text":var f=this.internal.newAdditionalObject(),g=this.internal.newAdditionalObject(),p=this.internal.getEncryptor(f.objId),x=r.title||"Note";n="<</Type /Annot /Subtype /Text "+(a="/Rect ["+s(r.bounds.x)+" "+i(r.bounds.y+r.bounds.h)+" "+s(r.bounds.x+r.bounds.w)+" "+i(r.bounds.y)+"] ")+"/Contents ("+h(p(r.contents))+")",n+=" /Popup "+g.objId+" 0 R",n+=" /P "+o.objId+" 0 R",n+=" /T ("+h(p(x))+") >>",f.content=n;var y=f.objId+" 0 R";n="<</Type /Annot /Subtype /Popup "+(a="/Rect ["+s(r.bounds.x+30)+" "+i(r.bounds.y+r.bounds.h)+" "+s(r.bounds.x+r.bounds.w+30)+" "+i(r.bounds.y)+"] ")+" /Parent "+y,r.open&&(n+=" /Open true"),n+=" >>",g.content=n,this.internal.write(f.objId,"0 R",g.objId,"0 R");break;case"freetext":a="/Rect ["+s(r.bounds.x)+" "+i(r.bounds.y)+" "+s(r.bounds.x+r.bounds.w)+" "+i(r.bounds.y+r.bounds.h)+"] ";var v=r.color||"#000000";n="<</Type /Annot /Subtype /FreeText "+a+"/Contents ("+h(m(r.contents))+")",n+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+v+")",n+=" /Border [0 0 0]",n+=" >>",this.internal.write(n);break;case"link":if(r.options.name){var b=this.annotations._nameMap[r.options.name];r.options.pageNumber=b.page,r.options.top=b.y}else r.options.top||(r.options.top=0);if(a="/Rect ["+r.finalBounds.x+" "+r.finalBounds.y+" "+r.finalBounds.w+" "+r.finalBounds.h+"] ",n="",r.options.url)n="<</Type /Annot /Subtype /Link "+a+"/Border [0 0 0] /A <</S /URI /URI ("+h(m(r.options.url))+") >>";else if(r.options.pageNumber)switch(n="<</Type /Annot /Subtype /Link "+a+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(r.options.pageNumber).objId+" 0 R",r.options.magFactor=r.options.magFactor||"XYZ",r.options.magFactor){case"Fit":n+=" /Fit]";break;case"FitH":n+=" /FitH "+r.options.top+"]";break;case"FitV":r.options.left=r.options.left||0,n+=" /FitV "+r.options.left+"]";break;default:var w=i(r.options.top);r.options.left=r.options.left||0,void 0===r.options.zoom&&(r.options.zoom=0),n+=" /XYZ "+r.options.left+" "+w+" "+r.options.zoom+"]"}""!=n&&(n+=" >>",this.internal.write(n))}}this.internal.write("]")}}]),e.createAnnotation=function(e){var t=this.internal.getCurrentPageInfo();switch(e.type){case"link":this.link(e.bounds.x,e.bounds.y,e.bounds.w,e.bounds.h,e);break;case"text":case"freetext":t.pageContext.annotations.push(e)}},e.link=function(e,t,r,a,n){var s=this.internal.getCurrentPageInfo(),i=this.internal.getCoordinateString,o=this.internal.getVerticalCoordinateString;s.pageContext.annotations.push({finalBounds:{x:i(e),y:o(t),w:i(e+r),h:o(t+a)},options:n,type:"link"})},e.textWithLink=function(e,t,r,a){var n,s,i=this.getTextWidth(e),o=this.internal.getLineHeight()/this.internal.scaleFactor;if(void 0!==a.maxWidth){s=a.maxWidth;var l=this.splitTextToSize(e,s).length;n=Math.ceil(o*l)}else s=i,n=o;return this.text(e,t,r,a),r+=.2*o,"center"===a.align&&(t-=i/2),"right"===a.align&&(t-=i),this.link(t,r-o,s,n,a),i},e.getTextWidth=function(e){var t=this.internal.getFontSize();return this.getStringUnitWidth(e)*t/this.internal.scaleFactor}}(px.API),function(e){var t={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},r={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},a={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},n=[1570,1571,1573,1575];e.__arabicParser__={};var s=e.__arabicParser__.isInArabicSubstitutionA=function(e){return void 0!==t[e.charCodeAt(0)]},i=e.__arabicParser__.isArabicLetter=function(e){return"string"==typeof e&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(e)},o=e.__arabicParser__.isArabicEndLetter=function(e){return i(e)&&s(e)&&t[e.charCodeAt(0)].length<=2},l=e.__arabicParser__.isArabicAlfLetter=function(e){return i(e)&&n.indexOf(e.charCodeAt(0))>=0};e.__arabicParser__.arabicLetterHasIsolatedForm=function(e){return i(e)&&s(e)&&t[e.charCodeAt(0)].length>=1};var c=e.__arabicParser__.arabicLetterHasFinalForm=function(e){return i(e)&&s(e)&&t[e.charCodeAt(0)].length>=2};e.__arabicParser__.arabicLetterHasInitialForm=function(e){return i(e)&&s(e)&&t[e.charCodeAt(0)].length>=3};var d=e.__arabicParser__.arabicLetterHasMedialForm=function(e){return i(e)&&s(e)&&4==t[e.charCodeAt(0)].length},u=e.__arabicParser__.resolveLigatures=function(e){var t=0,a=r,n="",s=0;for(t=0;t<e.length;t+=1)void 0!==a[e.charCodeAt(t)]?(s++,"number"==typeof(a=a[e.charCodeAt(t)])&&(n+=String.fromCharCode(a),a=r,s=0),t===e.length-1&&(a=r,n+=e.charAt(t-(s-1)),t-=s-1,s=0)):(a=r,n+=e.charAt(t-s),t-=s,s=0);return n};e.__arabicParser__.isArabicDiacritic=function(e){return void 0!==e&&void 0!==a[e.charCodeAt(0)]};var h=e.__arabicParser__.getCorrectForm=function(e,t,r){return i(e)?!1===s(e)?-1:!c(e)||!i(t)&&!i(r)||!i(r)&&o(t)||o(e)&&!i(t)||o(e)&&l(t)||o(e)&&o(t)?0:d(e)&&i(t)&&!o(t)&&i(r)&&c(r)?3:o(e)||!i(r)?1:2:-1},m=function(e){var r=0,a=0,n=0,s="",o="",l="",c=(e=e||"").split("\\s+"),d=[];for(r=0;r<c.length;r+=1){for(d.push(""),a=0;a<c[r].length;a+=1)s=c[r][a],o=c[r][a-1],l=c[r][a+1],i(s)?(n=h(s,o,l),d[r]+=-1!==n?String.fromCharCode(t[s.charCodeAt(0)][n]):s):d[r]+=s;d[r]=u(d[r])}return d.join(" ")},f=e.__arabicParser__.processArabic=e.processArabic=function(){var e,t="string"==typeof arguments[0]?arguments[0]:arguments[0].text,r=[];if(Array.isArray(t)){var a=0;for(r=[],a=0;a<t.length;a+=1)Array.isArray(t[a])?r.push([m(t[a][0]),t[a][1],t[a][2]]):r.push([m(t[a])]);e=r}else e=m(t);return"string"==typeof arguments[0]?e:(arguments[0].text=e,arguments[0])};e.events.push(["preProcessText",f])}(px.API),px.API.autoPrint=function(e){var t;return(e=e||{}).variant=e.variant||"non-conform","javascript"===e.variant?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){t=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+t+" 0 R")})),this},function(e){var t=function(){var e=void 0;Object.defineProperty(this,"pdf",{get:function(){return e},set:function(t){e=t}});var t=150;Object.defineProperty(this,"width",{get:function(){return t},set:function(e){t=isNaN(e)||!1===Number.isInteger(e)||e<0?150:e,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=t+1)}});var r=300;Object.defineProperty(this,"height",{get:function(){return r},set:function(e){r=isNaN(e)||!1===Number.isInteger(e)||e<0?300:e,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=r+1)}});var a=[];Object.defineProperty(this,"childNodes",{get:function(){return a},set:function(e){a=e}});var n={};Object.defineProperty(this,"style",{get:function(){return n},set:function(e){n=e}}),Object.defineProperty(this,"parentNode",{})};t.prototype.getContext=function(e,t){var r;if("2d"!==(e=e||"2d"))return null;for(r in t)this.pdf.context2d.hasOwnProperty(r)&&(this.pdf.context2d[r]=t[r]);return this.pdf.context2d._canvas=this,this.pdf.context2d},t.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},e.events.push(["initialized",function(){this.canvas=new t,this.canvas.pdf=this}])}(px.API),function(e){var t={left:0,top:0,bottom:0,right:0},r=!1,a=function(){void 0===this.internal.__cell__&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},t),this.internal.__cell__.margins.width=this.getPageWidth(),n.call(this))},n=function(){this.internal.__cell__.lastCell=new s,this.internal.__cell__.pages=1},s=function(){var e=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return e},set:function(t){e=t}});var t=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return t},set:function(e){t=e}});var r=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return r},set:function(e){r=e}});var a=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return a},set:function(e){a=e}});var n=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return n},set:function(e){n=e}});var s=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return s},set:function(e){s=e}});var i=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return i},set:function(e){i=e}}),this};s.prototype.clone=function(){return new s(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},s.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},e.setHeaderFunction=function(e){return a.call(this),this.internal.__cell__.headerFunction="function"==typeof e?e:void 0,this},e.getTextDimensions=function(e,t){a.call(this);var r=(t=t||{}).fontSize||this.getFontSize(),n=t.font||this.getFont(),s=t.scaleFactor||this.internal.scaleFactor,i=0,o=0,l=0,c=this;if(!Array.isArray(e)&&"string"!=typeof e){if("number"!=typeof e)throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");e=String(e)}var d=t.maxWidth;d>0?"string"==typeof e?e=this.splitTextToSize(e,d):"[object Array]"===Object.prototype.toString.call(e)&&(e=e.reduce(function(e,t){return e.concat(c.splitTextToSize(t,d))},[])):e=Array.isArray(e)?e:[e];for(var u=0;u<e.length;u++)i<(l=this.getStringUnitWidth(e[u],{font:n})*r)&&(i=l);return 0!==i&&(o=e.length),{w:i/=s,h:Math.max((o*r*this.getLineHeightFactor()-r*(this.getLineHeightFactor()-1))/s,0)}},e.cellAddPage=function(){a.call(this),this.addPage();var e=this.internal.__cell__.margins||t;return this.internal.__cell__.lastCell=new s(e.left,e.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var i=e.cell=function(){var e;e=arguments[0]instanceof s?arguments[0]:new s(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),a.call(this);var n=this.internal.__cell__.lastCell,i=this.internal.__cell__.padding,o=this.internal.__cell__.margins||t,l=this.internal.__cell__.tableHeaderRow,c=this.internal.__cell__.printHeaders;return void 0!==n.lineNumber&&(n.lineNumber===e.lineNumber?(e.x=(n.x||0)+(n.width||0),e.y=n.y||0):n.y+n.height+e.height+o.bottom>this.getPageHeight()?(this.cellAddPage(),e.y=o.top,c&&l&&(this.printHeaderRow(e.lineNumber,!0),e.y+=l[0].height)):e.y=n.y+n.height||e.y),void 0!==e.text[0]&&(this.rect(e.x,e.y,e.width,e.height,!0===r?"FD":void 0),"right"===e.align?this.text(e.text,e.x+e.width-i,e.y+i,{align:"right",baseline:"top"}):"center"===e.align?this.text(e.text,e.x+e.width/2,e.y+i,{align:"center",baseline:"top",maxWidth:e.width-i-i}):this.text(e.text,e.x+i,e.y+i,{align:"left",baseline:"top",maxWidth:e.width-i-i})),this.internal.__cell__.lastCell=e,this};e.table=function(e,r,l,c,d){if(a.call(this),!l)throw new Error("No data for PDF table.");var u,h,m,f,g=[],p=[],x=[],y={},v={},b=[],w=[],k=(d=d||{}).autoSize||!1,N=!1!==d.printHeaders,j=d.css&&void 0!==d.css["font-size"]?16*d.css["font-size"]:d.fontSize||12,S=d.margins||Object.assign({width:this.getPageWidth()},t),_="number"==typeof d.padding?d.padding:3,E=d.headerBackgroundColor||"#c8c8c8",A=d.headerTextColor||"#000";if(n.call(this),this.internal.__cell__.printHeaders=N,this.internal.__cell__.margins=S,this.internal.__cell__.table_font_size=j,this.internal.__cell__.padding=_,this.internal.__cell__.headerBackgroundColor=E,this.internal.__cell__.headerTextColor=A,this.setFontSize(j),null==c)p=g=Object.keys(l[0]),x=g.map(function(){return"left"});else if(Array.isArray(c)&&"object"===(0,ju.A)(c[0]))for(g=c.map(function(e){return e.name}),p=c.map(function(e){return e.prompt||e.name||""}),x=c.map(function(e){return e.align||"left"}),u=0;u<c.length;u+=1)v[c[u].name]=.7499990551181103*c[u].width;else Array.isArray(c)&&"string"==typeof c[0]&&(p=g=c,x=g.map(function(){return"left"}));if(k||Array.isArray(c)&&"string"==typeof c[0])for(u=0;u<g.length;u+=1){for(y[f=g[u]]=l.map(function(e){return e[f]}),this.setFont(void 0,"bold"),b.push(this.getTextDimensions(p[u],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),h=y[f],this.setFont(void 0,"normal"),m=0;m<h.length;m+=1)b.push(this.getTextDimensions(h[m],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);v[f]=Math.max.apply(null,b)+_+_,b=[]}if(N){var C={};for(u=0;u<g.length;u+=1)C[g[u]]={},C[g[u]].text=p[u],C[g[u]].align=x[u];var I=o.call(this,C,v);w=g.map(function(t){return new s(e,r,v[t],I,C[t].text,void 0,C[t].align)}),this.setTableHeaderRow(w),this.printHeaderRow(1,!1)}var T=c.reduce(function(e,t){return e[t.name]=t.align,e},{});for(u=0;u<l.length;u+=1){"rowStart"in d&&d.rowStart instanceof Function&&d.rowStart({row:u,data:l[u]},this);var D=o.call(this,l[u],v);for(m=0;m<g.length;m+=1){var P=l[u][g[m]];"cellStart"in d&&d.cellStart instanceof Function&&d.cellStart({row:u,col:m,data:P},this),i.call(this,new s(e,r,v[g[m]],D,P,u+2,T[g[m]]))}}return this.internal.__cell__.table_x=e,this.internal.__cell__.table_y=r,this};var o=function(e,t){var r=this.internal.__cell__.padding,a=this.internal.__cell__.table_font_size,n=this.internal.scaleFactor;return Object.keys(e).map(function(a){var n=e[a];return this.splitTextToSize(n.hasOwnProperty("text")?n.text:n,t[a]-r-r)},this).map(function(e){return this.getLineHeightFactor()*e.length*a/n+r+r},this).reduce(function(e,t){return Math.max(e,t)},0)};e.setTableHeaderRow=function(e){a.call(this),this.internal.__cell__.tableHeaderRow=e},e.printHeaderRow=function(e,t){if(a.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var n;if(r=!0,"function"==typeof this.internal.__cell__.headerFunction){var o=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new s(o[0],o[1],o[2],o[3],void 0,-1)}this.setFont(void 0,"bold");for(var l=[],c=0;c<this.internal.__cell__.tableHeaderRow.length;c+=1){n=this.internal.__cell__.tableHeaderRow[c].clone(),t&&(n.y=this.internal.__cell__.margins.top||0,l.push(n)),n.lineNumber=e;var d=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),i.call(this,n),this.setTextColor(d)}l.length>0&&this.setTableHeaderRow(l),this.setFont(void 0,"normal"),r=!1}}(px.API);var ny={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},sy=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],iy=ay(sy),oy=[100,200,300,400,500,600,700,800,900],ly=ay(oy);function cy(e){var t=e.family.replace(/"|'/g,"").toLowerCase(),r=function(e){return ny[e=e||"normal"]?e:"normal"}(e.style),a=function(e){return e?"number"==typeof e?e>=100&&e<=900&&e%100==0?e:400:/^\d00$/.test(e)?parseInt(e):"bold"===e?700:400:400}(e.weight),n=function(e){return"number"==typeof iy[e=e||"normal"]?e:"normal"}(e.stretch);return{family:t,style:r,weight:a,stretch:n,src:e.src||[],ref:e.ref||{name:t,style:[n,r,a].join(" ")}}}function dy(e,t,r,a){var n;for(n=r;n>=0&&n<t.length;n+=a)if(e[t[n]])return e[t[n]];for(n=r;n>=0&&n<t.length;n-=a)if(e[t[n]])return e[t[n]]}var uy={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},hy={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function my(e){return[e.stretch,e.style,e.weight,e.family].join(" ")}function fy(e){return e.trimLeft()}function gy(e,t){for(var r=0;r<e.length;){if(e.charAt(r)===t)return[e.substring(0,r),e.substring(r+1)];r+=1}return null}function py(e){var t=e.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return null===t?null:[t[0],e.substring(t[0].length)]}var xy,yy,vy,by,wy,ky,Ny,jy,Sy,_y=["times"];function Ey(e,t,r,a,n){var s=4,i=Iy;switch(n){case px.API.image_compression.FAST:s=1,i=Cy;break;case px.API.image_compression.MEDIUM:s=6,i=Ty;break;case px.API.image_compression.SLOW:s=9,i=Dy}e=function(e,t,r,a){for(var n,s=e.length/t,i=new Uint8Array(e.length+s),o=[Ay,Cy,Iy,Ty,Dy],l=0;l<s;l+=1){var c=l*t,d=e.subarray(c,c+t);if(a)i.set(a(d,r,n),c+l);else{for(var u=o.length,h=[],m=0;m<u;m+=1)h[m]=o[m](d,r,n);var f=Fy(h.concat());i.set(h[f],c+l)}n=d}return i}(e,t,Math.ceil(r*a/8),i);var o=lh(e,{level:s});return px.API.__addimage__.arrayBufferToBinaryString(o)}function Ay(e){var t=Array.apply([],e);return t.unshift(0),t}function Cy(e,t){var r=e.length,a=[];a[0]=1;for(var n=0;n<r;n+=1){var s=e[n-t]||0;a[n+1]=e[n]-s+256&255}return a}function Iy(e,t,r){var a=e.length,n=[];n[0]=2;for(var s=0;s<a;s+=1){var i=r&&r[s]||0;n[s+1]=e[s]-i+256&255}return n}function Ty(e,t,r){var a=e.length,n=[];n[0]=3;for(var s=0;s<a;s+=1){var i=e[s-t]||0,o=r&&r[s]||0;n[s+1]=e[s]+256-(i+o>>>1)&255}return n}function Dy(e,t,r){var a=e.length,n=[];n[0]=4;for(var s=0;s<a;s+=1){var i=Py(e[s-t]||0,r&&r[s]||0,r&&r[s-t]||0);n[s+1]=e[s]-i+256&255}return n}function Py(e,t,r){if(e===t&&t===r)return e;var a=Math.abs(t-r),n=Math.abs(e-r),s=Math.abs(e+t-r-r);return a<=n&&a<=s?e:n<=s?t:r}function Fy(e){var t=e.map(function(e){return e.reduce(function(e,t){return e+Math.abs(t)},0)});return t.indexOf(Math.min.apply(null,t))}function Ly(e,t,r){var a=t*r,n=Math.floor(a/8),s=16-(a-8*n+r),i=(1<<r)-1;return Ry(e,n)>>s&i}function My(e,t,r,a){var n=r*a,s=Math.floor(n/8),i=16-(n-8*s+a),o=(1<<a)-1,l=(t&o)<<i;!function(e,t,r){if(t+1<e.byteLength)e.setUint16(t,r,!1);else{var a=r>>8&255;e.setUint8(t,a)}}(e,s,Ry(e,s)&~(o<<i)&65535|l)}function Ry(e,t){return t+1<e.byteLength?e.getUint16(t,!1):e.getUint8(t)<<8}function Oy(e){var t=0;if(71!==e[t++]||73!==e[t++]||70!==e[t++]||56!==e[t++]||56!=(e[t++]+1&253)||97!==e[t++])throw new Error("Invalid GIF 87a/89a header.");var r=e[t++]|e[t++]<<8,a=e[t++]|e[t++]<<8,n=e[t++],s=n>>7,i=1<<1+(7&n);e[t++],e[t++];var o=null,l=null;s&&(o=t,l=i,t+=3*i);var c=!0,d=[],u=0,h=null,m=0,f=null;for(this.width=r,this.height=a;c&&t<e.length;)switch(e[t++]){case 33:switch(e[t++]){case 255:if(11!==e[t]||78==e[t+1]&&69==e[t+2]&&84==e[t+3]&&83==e[t+4]&&67==e[t+5]&&65==e[t+6]&&80==e[t+7]&&69==e[t+8]&&50==e[t+9]&&46==e[t+10]&&48==e[t+11]&&3==e[t+12]&&1==e[t+13]&&0==e[t+16])t+=14,f=e[t++]|e[t++]<<8,t++;else for(t+=12;;){if(!((E=e[t++])>=0))throw Error("Invalid block size");if(0===E)break;t+=E}break;case 249:if(4!==e[t++]||0!==e[t+4])throw new Error("Invalid graphics extension block.");var g=e[t++];u=e[t++]|e[t++]<<8,h=e[t++],1&g||(h=null),m=g>>2&7,t++;break;case 254:for(;;){if(!((E=e[t++])>=0))throw Error("Invalid block size");if(0===E)break;t+=E}break;default:throw new Error("Unknown graphic control label: 0x"+e[t-1].toString(16))}break;case 44:var p=e[t++]|e[t++]<<8,x=e[t++]|e[t++]<<8,y=e[t++]|e[t++]<<8,v=e[t++]|e[t++]<<8,b=e[t++],w=b>>6&1,k=1<<1+(7&b),N=o,j=l,S=!1;b>>7&&(S=!0,N=t,j=k,t+=3*k);var _=t;for(t++;;){var E;if(!((E=e[t++])>=0))throw Error("Invalid block size");if(0===E)break;t+=E}d.push({x:p,y:x,width:y,height:v,has_local_palette:S,palette_offset:N,palette_size:j,data_offset:_,data_length:t-_,transparent_index:h,interlaced:!!w,delay:u,disposal:m});break;case 59:c=!1;break;default:throw new Error("Unknown gif block: 0x"+e[t-1].toString(16))}this.numFrames=function(){return d.length},this.loopCount=function(){return f},this.frameInfo=function(e){if(e<0||e>=d.length)throw new Error("Frame index out of range.");return d[e]},this.decodeAndBlitFrameBGRA=function(t,a){var n=this.frameInfo(t),s=n.width*n.height,i=new Uint8Array(s);By(e,n.data_offset,i,s);var o=n.palette_offset,l=n.transparent_index;null===l&&(l=256);var c=n.width,d=r-c,u=c,h=4*(n.y*r+n.x),m=4*((n.y+n.height)*r+n.x),f=h,g=4*d;!0===n.interlaced&&(g+=4*r*7);for(var p=8,x=0,y=i.length;x<y;++x){var v=i[x];if(0===u&&(u=c,(f+=g)>=m&&(g=4*d+4*r*(p-1),f=h+(c+d)*(p<<1),p>>=1)),v===l)f+=4;else{var b=e[o+3*v],w=e[o+3*v+1],k=e[o+3*v+2];a[f++]=k,a[f++]=w,a[f++]=b,a[f++]=255}--u}},this.decodeAndBlitFrameRGBA=function(t,a){var n=this.frameInfo(t),s=n.width*n.height,i=new Uint8Array(s);By(e,n.data_offset,i,s);var o=n.palette_offset,l=n.transparent_index;null===l&&(l=256);var c=n.width,d=r-c,u=c,h=4*(n.y*r+n.x),m=4*((n.y+n.height)*r+n.x),f=h,g=4*d;!0===n.interlaced&&(g+=4*r*7);for(var p=8,x=0,y=i.length;x<y;++x){var v=i[x];if(0===u&&(u=c,(f+=g)>=m&&(g=4*d+4*r*(p-1),f=h+(c+d)*(p<<1),p>>=1)),v===l)f+=4;else{var b=e[o+3*v],w=e[o+3*v+1],k=e[o+3*v+2];a[f++]=b,a[f++]=w,a[f++]=k,a[f++]=255}--u}}}function By(e,t,r,a){for(var n=e[t++],s=1<<n,i=s+1,o=i+1,l=n+1,c=(1<<l)-1,d=0,u=0,h=0,m=e[t++],f=new Int32Array(4096),g=null;;){for(;d<16&&0!==m;)u|=e[t++]<<d,d+=8,1===m?m=e[t++]:--m;if(d<l)break;var p=u&c;if(u>>=l,d-=l,p!==s){if(p===i)break;for(var x=p<o?p:g,y=0,v=x;v>s;)v=f[v]>>8,++y;var b=v;if(h+y+(x!==p?1:0)>a)return void Bp.log("Warning, gif stream longer than expected.");r[h++]=b;var w=h+=y;for(x!==p&&(r[h++]=b),v=x;y--;)v=f[v],r[--w]=255&v,v>>=8;null!==g&&o<4096&&(f[o++]=g<<8|b,o>=c+1&&l<12&&(++l,c=c<<1|1)),g=p}else o=i+1,c=(1<<(l=n+1))-1,g=null}return h!==a&&Bp.log("Warning, gif stream shorter than expected."),r}function zy(e){var t,r,a,n,s,i=Math.floor,o=new Array(64),l=new Array(64),c=new Array(64),d=new Array(64),u=new Array(65535),h=new Array(65535),m=new Array(64),f=new Array(64),g=[],p=0,x=7,y=new Array(64),v=new Array(64),b=new Array(64),w=new Array(256),k=new Array(2048),N=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],j=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],S=[0,1,2,3,4,5,6,7,8,9,10,11],_=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],E=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],A=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],C=[0,1,2,3,4,5,6,7,8,9,10,11],I=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],T=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function D(e,t){for(var r=0,a=0,n=new Array,s=1;s<=16;s++){for(var i=1;i<=e[s];i++)n[t[a]]=[],n[t[a]][0]=r,n[t[a]][1]=s,a++,r++;r*=2}return n}function P(e){for(var t=e[0],r=e[1]-1;r>=0;)t&1<<r&&(p|=1<<x),r--,--x<0&&(255==p?(F(255),F(0)):F(p),x=7,p=0)}function F(e){g.push(e)}function L(e){F(e>>8&255),F(255&e)}function M(e,t,r,a,n){for(var s,i=n[0],o=n[240],l=function(e,t){var r,a,n,s,i,o,l,c,d,u,h=0;for(d=0;d<8;++d){r=e[h],a=e[h+1],n=e[h+2],s=e[h+3],i=e[h+4],o=e[h+5],l=e[h+6];var f=r+(c=e[h+7]),g=r-c,p=a+l,x=a-l,y=n+o,v=n-o,b=s+i,w=s-i,k=f+b,N=f-b,j=p+y,S=p-y;e[h]=k+j,e[h+4]=k-j;var _=.707106781*(S+N);e[h+2]=N+_,e[h+6]=N-_;var E=.382683433*((k=w+v)-(S=x+g)),A=.5411961*k+E,C=1.306562965*S+E,I=.707106781*(j=v+x),T=g+I,D=g-I;e[h+5]=D+A,e[h+3]=D-A,e[h+1]=T+C,e[h+7]=T-C,h+=8}for(h=0,d=0;d<8;++d){r=e[h],a=e[h+8],n=e[h+16],s=e[h+24],i=e[h+32],o=e[h+40],l=e[h+48];var P=r+(c=e[h+56]),F=r-c,L=a+l,M=a-l,R=n+o,O=n-o,B=s+i,z=s-i,U=P+B,V=P-B,q=L+R,H=L-R;e[h]=U+q,e[h+32]=U-q;var G=.707106781*(H+V);e[h+16]=V+G,e[h+48]=V-G;var W=.382683433*((U=z+O)-(H=M+F)),K=.5411961*U+W,Q=1.306562965*H+W,Y=.707106781*(q=O+M),X=F+Y,J=F-Y;e[h+40]=J+K,e[h+24]=J-K,e[h+8]=X+Q,e[h+56]=X-Q,h++}for(d=0;d<64;++d)u=e[d]*t[d],m[d]=u>0?u+.5|0:u-.5|0;return m}(e,t),c=0;c<64;++c)f[N[c]]=l[c];var d=f[0]-r;r=f[0],0==d?P(a[0]):(P(a[h[s=32767+d]]),P(u[s]));for(var g=63;g>0&&0==f[g];)g--;if(0==g)return P(i),r;for(var p,x=1;x<=g;){for(var y=x;0==f[x]&&x<=g;)++x;var v=x-y;if(v>=16){p=v>>4;for(var b=1;b<=p;++b)P(o);v&=15}s=32767+f[x],P(n[(v<<4)+h[s]]),P(u[s]),x++}return 63!=g&&P(i),r}function R(e){e=Math.min(Math.max(e,1),100),s!=e&&(function(e){for(var t=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],r=0;r<64;r++){var a=i((t[r]*e+50)/100);a=Math.min(Math.max(a,1),255),o[N[r]]=a}for(var n=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],s=0;s<64;s++){var u=i((n[s]*e+50)/100);u=Math.min(Math.max(u,1),255),l[N[s]]=u}for(var h=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],m=0,f=0;f<8;f++)for(var g=0;g<8;g++)c[m]=1/(o[N[m]]*h[f]*h[g]*8),d[m]=1/(l[N[m]]*h[f]*h[g]*8),m++}(e<50?Math.floor(5e3/e):Math.floor(200-2*e)),s=e)}this.encode=function(e,s){s&&R(s),g=new Array,p=0,x=7,L(65496),L(65504),L(16),F(74),F(70),F(73),F(70),F(0),F(1),F(1),F(0),L(1),L(1),F(0),F(0),function(){L(65499),L(132),F(0);for(var e=0;e<64;e++)F(o[e]);F(1);for(var t=0;t<64;t++)F(l[t])}(),function(e,t){L(65472),L(17),F(8),L(t),L(e),F(3),F(1),F(17),F(0),F(2),F(17),F(1),F(3),F(17),F(1)}(e.width,e.height),function(){L(65476),L(418),F(0);for(var e=0;e<16;e++)F(j[e+1]);for(var t=0;t<=11;t++)F(S[t]);F(16);for(var r=0;r<16;r++)F(_[r+1]);for(var a=0;a<=161;a++)F(E[a]);F(1);for(var n=0;n<16;n++)F(A[n+1]);for(var s=0;s<=11;s++)F(C[s]);F(17);for(var i=0;i<16;i++)F(I[i+1]);for(var o=0;o<=161;o++)F(T[o])}(),L(65498),L(12),F(3),F(1),F(0),F(2),F(17),F(3),F(17),F(0),F(63),F(0);var i=0,u=0,h=0;p=0,x=7,this.encode.displayName="_encode_";for(var m,f,w,N,D,O,B,z,U,V=e.data,q=e.width,H=e.height,G=4*q,W=0;W<H;){for(m=0;m<G;){for(D=G*W+m,B=-1,z=0,U=0;U<64;U++)O=D+(z=U>>3)*G+(B=4*(7&U)),W+z>=H&&(O-=G*(W+1+z-H)),m+B>=G&&(O-=m+B-G+4),f=V[O++],w=V[O++],N=V[O++],y[U]=(k[f]+k[w+256|0]+k[N+512|0]>>16)-128,v[U]=(k[f+768|0]+k[w+1024|0]+k[N+1280|0]>>16)-128,b[U]=(k[f+1280|0]+k[w+1536|0]+k[N+1792|0]>>16)-128;i=M(y,c,i,t,a),u=M(v,d,u,r,n),h=M(b,d,h,r,n),m+=32}W+=8}if(x>=0){var K=[];K[1]=x+1,K[0]=(1<<x+1)-1,P(K)}return L(65497),new Uint8Array(g)},e=e||50,function(){for(var e=String.fromCharCode,t=0;t<256;t++)w[t]=e(t)}(),t=D(j,S),r=D(A,C),a=D(_,E),n=D(I,T),function(){for(var e=1,t=2,r=1;r<=15;r++){for(var a=e;a<t;a++)h[32767+a]=r,u[32767+a]=[],u[32767+a][1]=r,u[32767+a][0]=a;for(var n=-(t-1);n<=-e;n++)h[32767+n]=r,u[32767+n]=[],u[32767+n][1]=r,u[32767+n][0]=t-1+n;e<<=1,t<<=1}}(),function(){for(var e=0;e<256;e++)k[e]=19595*e,k[e+256|0]=38470*e,k[e+512|0]=7471*e+32768,k[e+768|0]=-11059*e,k[e+1024|0]=-21709*e,k[e+1280|0]=32768*e+8421375,k[e+1536|0]=-27439*e,k[e+1792|0]=-5329*e}(),R(e)}function Uy(e,t){if(this.pos=0,this.buffer=e,this.datav=new DataView(e.buffer),this.is_with_alpha=!!t,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,-1===["BM","BA","CI","CP","IC","PT"].indexOf(this.flag))throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function Vy(e){function t(e){if(!e)throw Error("assert :P")}function r(e,t,r){for(var a=0;4>a;a++)if(e[t+a]!=r.charCodeAt(a))return!0;return!1}function a(e,t,r,a,n){for(var s=0;s<n;s++)e[t+s]=r[a+s]}function n(e,t,r,a){for(var n=0;n<a;n++)e[t+n]=r}function s(e){return new Int32Array(e)}function i(e,t){for(var r=[],a=0;a<e;a++)r.push(new t);return r}function o(e,t){var r=[];return function e(r,a,n){for(var s=n[a],i=0;i<s&&(r.push(n.length>a+1?[]:new t),!(n.length<a+1));i++)e(r[i],a+1,n)}(r,0,e),r}var l=function(){var e=this;function l(e,t){for(var r=1<<t-1>>>0;e&r;)r>>>=1;return r?(e&r-1)+r:e}function c(e,r,a,n,s){t(!(n%a));do{e[r+(n-=a)]=s}while(0<n)}function d(e,r,a,n,i){if(t(2328>=i),512>=i)var o=s(512);else if(null==(o=s(i)))return 0;return function(e,r,a,n,i,o){var d,h,m=r,f=1<<a,g=s(16),p=s(16);for(t(0!=i),t(null!=n),t(null!=e),t(0<a),h=0;h<i;++h){if(15<n[h])return 0;++g[n[h]]}if(g[0]==i)return 0;for(p[1]=0,d=1;15>d;++d){if(g[d]>1<<d)return 0;p[d+1]=p[d]+g[d]}for(h=0;h<i;++h)d=n[h],0<n[h]&&(o[p[d]++]=h);if(1==p[15])return(n=new u).g=0,n.value=o[0],c(e,m,1,f,n),f;var x,y=-1,v=f-1,b=0,w=1,k=1,N=1<<a;for(h=0,d=1,i=2;d<=a;++d,i<<=1){if(w+=k<<=1,0>(k-=g[d]))return 0;for(;0<g[d];--g[d])(n=new u).g=d,n.value=o[h++],c(e,m+b,i,N,n),b=l(b,d)}for(d=a+1,i=2;15>=d;++d,i<<=1){if(w+=k<<=1,0>(k-=g[d]))return 0;for(;0<g[d];--g[d]){if(n=new u,(b&v)!=y){for(m+=N,x=1<<(y=d)-a;15>y&&!(0>=(x-=g[y]));)++y,x<<=1;f+=N=1<<(x=y-a),e[r+(y=b&v)].g=x+a,e[r+y].value=m-r-y}n.g=d-a,n.value=o[h++],c(e,m+(b>>a),i,N,n),b=l(b,d)}}return w!=2*p[15]-1?0:f}(e,r,a,n,i,o)}function u(){this.value=this.g=0}function h(){this.value=this.g=0}function m(){this.G=i(5,u),this.H=s(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=i(Rr,h)}function f(e,r,a,n){t(null!=e),t(null!=r),t(2147483648>n),e.Ca=254,e.I=0,e.b=-8,e.Ka=0,e.oa=r,e.pa=a,e.Jd=r,e.Yc=a+n,e.Zc=4<=n?a+n-4+1:a,_(e)}function g(e,t){for(var r=0;0<t--;)r|=A(e,128)<<t;return r}function p(e,t){var r=g(e,t);return E(e)?-r:r}function x(e,r,a,n){var s,i=0;for(t(null!=e),t(null!=r),t(4294967288>n),e.Sb=n,e.Ra=0,e.u=0,e.h=0,4<n&&(n=4),s=0;s<n;++s)i+=r[a+s]<<8*s;e.Ra=i,e.bb=n,e.oa=r,e.pa=a}function y(e){for(;8<=e.u&&e.bb<e.Sb;)e.Ra>>>=8,e.Ra+=e.oa[e.pa+e.bb]<<zr-8>>>0,++e.bb,e.u-=8;N(e)&&(e.h=1,e.u=0)}function v(e,r){if(t(0<=r),!e.h&&r<=Br){var a=k(e)&Or[r];return e.u+=r,y(e),a}return e.h=1,e.u=0}function b(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function w(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function k(e){return e.Ra>>>(e.u&zr-1)>>>0}function N(e){return t(e.bb<=e.Sb),e.h||e.bb==e.Sb&&e.u>zr}function j(e,t){e.u=t,e.h=N(e)}function S(e){e.u>=Ur&&(t(e.u>=Ur),y(e))}function _(e){t(null!=e&&null!=e.oa),e.pa<e.Zc?(e.I=(e.oa[e.pa++]|e.I<<8)>>>0,e.b+=8):(t(null!=e&&null!=e.oa),e.pa<e.Yc?(e.b+=8,e.I=e.oa[e.pa++]|e.I<<8):e.Ka?e.b=0:(e.I<<=8,e.b+=8,e.Ka=1))}function E(e){return g(e,1)}function A(e,t){var r=e.Ca;0>e.b&&_(e);var a=e.b,n=r*t>>>8,s=(e.I>>>a>n)+0;for(s?(r-=n,e.I-=n+1<<a>>>0):r=n+1,a=r,n=0;256<=a;)n+=8,a>>=8;return a=7^n+Vr[a],e.b-=a,e.Ca=(r<<a)-1,s}function C(e,t,r){e[t+0]=r>>24&255,e[t+1]=r>>16&255,e[t+2]=r>>8&255,e[t+3]=255&r}function I(e,t){return e[t+0]|e[t+1]<<8}function T(e,t){return I(e,t)|e[t+2]<<16}function D(e,t){return I(e,t)|I(e,t+2)<<16}function P(e,r){var a=1<<r;return t(null!=e),t(0<r),e.X=s(a),null==e.X?0:(e.Mb=32-r,e.Xa=r,1)}function F(e,r){t(null!=e),t(null!=r),t(e.Xa==r.Xa),a(r.X,0,e.X,0,1<<r.Xa)}function L(){this.X=[],this.Xa=this.Mb=0}function M(e,r,a,n){t(null!=a),t(null!=n);var s=a[0],i=n[0];return 0==s&&(s=(e*i+r/2)/r),0==i&&(i=(r*s+e/2)/e),0>=s||0>=i?0:(a[0]=s,n[0]=i,1)}function R(e,t){return e+(1<<t)-1>>>t}function O(e,t){return((4278255360&e)+(4278255360&t)>>>0&4278255360)+((16711935&e)+(16711935&t)>>>0&16711935)>>>0}function B(t,r){e[r]=function(r,a,n,s,i,o,l){var c;for(c=0;c<i;++c){var d=e[t](o[l+c-1],n,s+c);o[l+c]=O(r[a+c],d)}}}function z(){this.ud=this.hd=this.jd=0}function U(e,t){return((4278124286&(e^t))>>>1)+(e&t)>>>0}function V(e){return 0<=e&&256>e?e:0>e?0:255<e?255:void 0}function q(e,t){return V(e+(e-t+.5>>1))}function H(e,t,r){return Math.abs(t-r)-Math.abs(e-r)}function G(e,t,r,a,n,s,i){for(a=s[i-1],r=0;r<n;++r)s[i+r]=a=O(e[t+r],a)}function W(e,t,r,a,n){var s;for(s=0;s<r;++s){var i=e[t+s],o=i>>8&255,l=16711935&(l=(l=16711935&i)+((o<<16)+o));a[n+s]=(4278255360&i)+l>>>0}}function K(e,t){t.jd=255&e,t.hd=e>>8&255,t.ud=e>>16&255}function Q(e,t,r,a,n,s){var i;for(i=0;i<a;++i){var o=t[r+i],l=o>>>8,c=o,d=255&(d=(d=o>>>16)+((e.jd<<24>>24)*(l<<24>>24)>>>5));c=255&(c=(c+=(e.hd<<24>>24)*(l<<24>>24)>>>5)+((e.ud<<24>>24)*(d<<24>>24)>>>5)),n[s+i]=(4278255360&o)+(d<<16)+c}}function Y(t,r,a,n,s){e[r]=function(e,t,r,a,i,o,l,c,d){for(a=l;a<c;++a)for(l=0;l<d;++l)i[o++]=s(r[n(e[t++])])},e[t]=function(t,r,i,o,l,c,d){var u=8>>t.b,h=t.Ea,m=t.K[0],f=t.w;if(8>u)for(t=(1<<t.b)-1,f=(1<<u)-1;r<i;++r){var g,p=0;for(g=0;g<h;++g)g&t||(p=n(o[l++])),c[d++]=s(m[p&f]),p>>=u}else e["VP8LMapColor"+a](o,l,m,f,c,d,r,i,h)}}function X(e,t,r,a,n){for(r=t+r;t<r;){var s=e[t++];a[n++]=s>>16&255,a[n++]=s>>8&255,a[n++]=255&s}}function J(e,t,r,a,n){for(r=t+r;t<r;){var s=e[t++];a[n++]=s>>16&255,a[n++]=s>>8&255,a[n++]=255&s,a[n++]=s>>24&255}}function Z(e,t,r,a,n){for(r=t+r;t<r;){var s=(i=e[t++])>>16&240|i>>12&15,i=240&i|i>>28&15;a[n++]=s,a[n++]=i}}function $(e,t,r,a,n){for(r=t+r;t<r;){var s=(i=e[t++])>>16&248|i>>13&7,i=i>>5&224|i>>3&31;a[n++]=s,a[n++]=i}}function ee(e,t,r,a,n){for(r=t+r;t<r;){var s=e[t++];a[n++]=255&s,a[n++]=s>>8&255,a[n++]=s>>16&255}}function te(e,t,r,n,s,i){if(0==i)for(r=t+r;t<r;)C(n,((i=e[t++])[0]>>24|i[1]>>8&65280|i[2]<<8&16711680|i[3]<<24)>>>0),s+=32;else a(n,s,e,t,r)}function re(t,r){e[r][0]=e[t+"0"],e[r][1]=e[t+"1"],e[r][2]=e[t+"2"],e[r][3]=e[t+"3"],e[r][4]=e[t+"4"],e[r][5]=e[t+"5"],e[r][6]=e[t+"6"],e[r][7]=e[t+"7"],e[r][8]=e[t+"8"],e[r][9]=e[t+"9"],e[r][10]=e[t+"10"],e[r][11]=e[t+"11"],e[r][12]=e[t+"12"],e[r][13]=e[t+"13"],e[r][14]=e[t+"0"],e[r][15]=e[t+"0"]}function ae(e){return e==Ua||e==Va||e==qa||e==Ha}function ne(){this.eb=[],this.size=this.A=this.fb=0}function se(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function ie(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new ne,this.f.kb=new se,this.sd=null}function oe(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function le(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function ce(e){return alert("todo:WebPSamplerProcessPlane"),e.T}function de(e,t){var r=e.T,n=t.ba.f.RGBA,s=n.eb,i=n.fb+e.ka*n.A,o=pn[t.ba.S],l=e.y,c=e.O,d=e.f,u=e.N,h=e.ea,m=e.W,f=t.cc,g=t.dc,p=t.Mc,x=t.Nc,y=e.ka,v=e.ka+e.T,b=e.U,w=b+1>>1;for(0==y?o(l,c,null,null,d,u,h,m,d,u,h,m,s,i,null,null,b):(o(t.ec,t.fc,l,c,f,g,p,x,d,u,h,m,s,i-n.A,s,i,b),++r);y+2<v;y+=2)f=d,g=u,p=h,x=m,u+=e.Rc,m+=e.Rc,i+=2*n.A,o(l,(c+=2*e.fa)-e.fa,l,c,f,g,p,x,d,u,h,m,s,i-n.A,s,i,b);return c+=e.fa,e.j+v<e.o?(a(t.ec,t.fc,l,c,b),a(t.cc,t.dc,d,u,w),a(t.Mc,t.Nc,h,m,w),r--):1&v||o(l,c,null,null,d,u,h,m,d,u,h,m,s,i+n.A,null,null,b),r}function ue(e,r,a){var n=e.F,s=[e.J];if(null!=n){var i=e.U,o=r.ba.S,l=o==Oa||o==qa;r=r.ba.f.RGBA;var c=[0],d=e.ka;c[0]=e.T,e.Kb&&(0==d?--c[0]:(--d,s[0]-=e.width),e.j+e.ka+e.T==e.o&&(c[0]=e.o-e.j-d));var u=r.eb;d=r.fb+d*r.A,e=Na(n,s[0],e.width,i,c,u,d+(l?0:3),r.A),t(a==c),e&&ae(o)&&wa(u,d,l,i,c,r.A)}return 0}function he(e){var t=e.ma,r=t.ba.S,a=11>r,n=r==La||r==Ra||r==Oa||r==Ba||12==r||ae(r);if(t.memory=null,t.Ib=null,t.Jb=null,t.Nd=null,!Fr(t.Oa,e,n?11:12))return 0;if(n&&ae(r)&&xr(),e.da)alert("todo:use_scaling");else{if(a){if(t.Ib=ce,e.Kb){if(r=e.U+1>>1,t.memory=s(e.U+2*r),null==t.memory)return 0;t.ec=t.memory,t.fc=0,t.cc=t.ec,t.dc=t.fc+e.U,t.Mc=t.cc,t.Nc=t.dc+r,t.Ib=de,xr()}}else alert("todo:EmitYUV");n&&(t.Jb=ue,a&&gr())}if(a&&!In){for(e=0;256>e;++e)Tn[e]=89858*(e-128)+Sn>>jn,Fn[e]=-22014*(e-128)+Sn,Pn[e]=-45773*(e-128),Dn[e]=113618*(e-128)+Sn>>jn;for(e=_n;e<En;++e)t=76283*(e-16)+Sn>>jn,Ln[e-_n]=Ge(t,255),Mn[e-_n]=Ge(t+8>>4,15);In=1}return 1}function me(e){var r=e.ma,a=e.U,n=e.T;return t(!(1&e.ka)),0>=a||0>=n?0:(a=r.Ib(e,r),null!=r.Jb&&r.Jb(e,r,a),r.Dc+=a,1)}function fe(e){e.ma.memory=null}function ge(e,t,r,a){return 47!=v(e,8)?0:(t[0]=v(e,14)+1,r[0]=v(e,14)+1,a[0]=v(e,1),0!=v(e,3)?0:!e.h)}function pe(e,t){if(4>e)return e+1;var r=e-2>>1;return(2+(1&e)<<r)+v(t,r)+1}function xe(e,t){return 120<t?t-120:1<=(r=((r=Xa[t-1])>>4)*e+(8-(15&r)))?r:1;var r}function ye(e,t,r){var a=k(r),n=e[t+=255&a].g-8;return 0<n&&(j(r,r.u+8),a=k(r),t+=e[t].value,t+=a&(1<<n)-1),j(r,r.u+e[t].g),e[t].value}function ve(e,r,a){return a.g+=e.g,a.value+=e.value<<r>>>0,t(8>=a.g),e.g}function be(e,r,a){var n=e.xc;return t((r=0==n?0:e.vc[e.md*(a>>n)+(r>>n)])<e.Wb),e.Ya[r]}function we(e,r,n,s){var i=e.ab,o=e.c*r,l=e.C;r=l+r;var c=n,d=s;for(s=e.Ta,n=e.Ua;0<i--;){var u=e.gc[i],h=l,m=r,f=c,g=d,p=(d=s,c=n,u.Ea);switch(t(h<m),t(m<=u.nc),u.hc){case 2:Gr(f,g,(m-h)*p,d,c);break;case 0:var x=h,y=m,v=d,b=c,w=(_=u).Ea;0==x&&(qr(f,g,null,null,1,v,b),G(f,g+1,0,0,w-1,v,b+1),g+=w,b+=w,++x);for(var k=1<<_.b,N=k-1,j=R(w,_.b),S=_.K,_=_.w+(x>>_.b)*j;x<y;){var E=S,A=_,C=1;for(Hr(f,g,v,b-w,1,v,b);C<w;){var I=(C&~N)+k;I>w&&(I=w),(0,Xr[E[A++]>>8&15])(f,g+ +C,v,b+C-w,I-C,v,b+C),C=I}g+=w,b+=w,++x&N||(_+=j)}m!=u.nc&&a(d,c-p,d,c+(m-h-1)*p,p);break;case 1:for(p=f,y=g,w=(f=u.Ea)-(b=f&~(v=(g=1<<u.b)-1)),x=R(f,u.b),k=u.K,u=u.w+(h>>u.b)*x;h<m;){for(N=k,j=u,S=new z,_=y+b,E=y+f;y<_;)K(N[j++],S),Jr(S,p,y,g,d,c),y+=g,c+=g;y<E&&(K(N[j++],S),Jr(S,p,y,w,d,c),y+=w,c+=w),++h&v||(u+=x)}break;case 3:if(f==d&&g==c&&0<u.b){for(y=d,f=p=c+(m-h)*p-(b=(m-h)*R(u.Ea,u.b)),g=d,v=c,x=[],b=(w=b)-1;0<=b;--b)x[b]=g[v+b];for(b=w-1;0<=b;--b)y[f+b]=x[b];Wr(u,h,m,d,p,d,c)}else Wr(u,h,m,f,g,d,c)}c=s,d=n}d!=n&&a(s,n,c,d,o)}function ke(e,r){var a=e.V,n=e.Ba+e.c*e.C,s=r-e.C;if(t(r<=e.l.o),t(16>=s),0<s){var i=e.l,o=e.Ta,l=e.Ua,c=i.width;if(we(e,s,a,n),s=l=[l],t((a=e.C)<(n=r)),t(i.v<i.va),n>i.o&&(n=i.o),a<i.j){var d=i.j-a;a=i.j,s[0]+=d*c}if(a>=n?a=0:(s[0]+=4*i.v,i.ka=a-i.j,i.U=i.va-i.v,i.T=n-a,a=1),a){if(l=l[0],11>(a=e.ca).S){var u=a.f.RGBA,h=(n=a.S,s=i.U,i=i.T,d=u.eb,u.A),m=i;for(u=u.fb+e.Ma*u.A;0<m--;){var f=o,g=l,p=s,x=d,y=u;switch(n){case Fa:Zr(f,g,p,x,y);break;case La:$r(f,g,p,x,y);break;case Ua:$r(f,g,p,x,y),wa(x,y,0,p,1,0);break;case Ma:ra(f,g,p,x,y);break;case Ra:te(f,g,p,x,y,1);break;case Va:te(f,g,p,x,y,1),wa(x,y,0,p,1,0);break;case Oa:te(f,g,p,x,y,0);break;case qa:te(f,g,p,x,y,0),wa(x,y,1,p,1,0);break;case Ba:ea(f,g,p,x,y);break;case Ha:ea(f,g,p,x,y),ka(x,y,p,1,0);break;case za:ta(f,g,p,x,y);break;default:t(0)}l+=c,u+=h}e.Ma+=i}else alert("todo:EmitRescaledRowsYUVA");t(e.Ma<=a.height)}}e.C=r,t(e.C<=e.i)}function Ne(e){var t;if(0<e.ua)return 0;for(t=0;t<e.Wb;++t){var r=e.Ya[t].G,a=e.Ya[t].H;if(0<r[1][a[1]+0].g||0<r[2][a[2]+0].g||0<r[3][a[3]+0].g)return 0}return 1}function je(e,r,a,n,s,i){if(0!=e.Z){var o=e.qd,l=e.rd;for(t(null!=gn[e.Z]);r<a;++r)gn[e.Z](o,l,n,s,n,s,i),o=n,l=s,s+=i;e.qd=o,e.rd=l}}function Se(e,r){var a=e.l.ma,n=0==a.Z||1==a.Z?e.l.j:e.C;if(n=e.C<n?n:e.C,t(r<=e.l.o),r>n){var s=e.l.width,i=a.ca,o=a.tb+s*n,l=e.V,c=e.Ba+e.c*n,d=e.gc;t(1==e.ab),t(3==d[0].hc),Qr(d[0],n,r,l,c,i,o),je(a,n,r,i,o,s)}e.C=e.Ma=r}function _e(e,r,a,n,s,i,o){var l=e.$/n,c=e.$%n,d=e.m,u=e.s,h=a+e.$,m=h;s=a+n*s;var f=a+n*i,g=280+u.ua,p=e.Pb?l:16777216,x=0<u.ua?u.Wa:null,y=u.wc,v=h<f?be(u,c,l):null;t(e.C<i),t(f<=s);var b=!1;e:for(;;){for(;b||h<f;){var w=0;if(l>=p){var _=h-a;t((p=e).Pb),p.wd=p.m,p.xd=_,0<p.s.ua&&F(p.s.Wa,p.s.vb),p=l+Za}if(c&y||(v=be(u,c,l)),t(null!=v),v.Qb&&(r[h]=v.qb,b=!0),!b)if(S(d),v.jc){w=d,_=r;var E=h,A=v.pd[k(w)&Rr-1];t(v.jc),256>A.g?(j(w,w.u+A.g),_[E]=A.value,w=0):(j(w,w.u+A.g-256),t(256<=A.value),w=A.value),0==w&&(b=!0)}else w=ye(v.G[0],v.H[0],d);if(d.h)break;if(b||256>w){if(!b)if(v.nd)r[h]=(v.qb|w<<8)>>>0;else{if(S(d),b=ye(v.G[1],v.H[1],d),S(d),_=ye(v.G[2],v.H[2],d),E=ye(v.G[3],v.H[3],d),d.h)break;r[h]=(E<<24|b<<16|w<<8|_)>>>0}if(b=!1,++h,++c>=n&&(c=0,++l,null!=o&&l<=i&&!(l%16)&&o(e,l),null!=x))for(;m<h;)w=r[m++],x.X[(506832829*w&4294967295)>>>x.Mb]=w}else if(280>w){if(w=pe(w-256,d),_=ye(v.G[4],v.H[4],d),S(d),_=xe(n,_=pe(_,d)),d.h)break;if(h-a<_||s-h<w)break e;for(E=0;E<w;++E)r[h+E]=r[h+E-_];for(h+=w,c+=w;c>=n;)c-=n,++l,null!=o&&l<=i&&!(l%16)&&o(e,l);if(t(h<=s),c&y&&(v=be(u,c,l)),null!=x)for(;m<h;)w=r[m++],x.X[(506832829*w&4294967295)>>>x.Mb]=w}else{if(!(w<g))break e;for(b=w-280,t(null!=x);m<h;)w=r[m++],x.X[(506832829*w&4294967295)>>>x.Mb]=w;w=h,t(!(b>>>(_=x).Xa)),r[w]=_.X[b],b=!0}b||t(d.h==N(d))}if(e.Pb&&d.h&&h<s)t(e.m.h),e.a=5,e.m=e.wd,e.$=e.xd,0<e.s.ua&&F(e.s.vb,e.s.Wa);else{if(d.h)break e;null!=o&&o(e,l>i?i:l),e.a=0,e.$=h-a}return 1}return e.a=3,0}function Ee(e){t(null!=e),e.vc=null,e.yc=null,e.Ya=null;var r=e.Wa;null!=r&&(r.X=null),e.vb=null,t(null!=e)}function Ae(){var t=new sr;return null==t?null:(t.a=0,t.xb=fn,re("Predictor","VP8LPredictors"),re("Predictor","VP8LPredictors_C"),re("PredictorAdd","VP8LPredictorsAdd"),re("PredictorAdd","VP8LPredictorsAdd_C"),Gr=W,Jr=Q,Zr=X,$r=J,ea=Z,ta=$,ra=ee,e.VP8LMapColor32b=Kr,e.VP8LMapColor8b=Yr,t)}function Ce(e,r,a,o,l){var c=1,h=[e],f=[r],g=o.m,p=o.s,x=null,y=0;e:for(;;){if(a)for(;c&&v(g,1);){var b=h,w=f,N=o,_=1,E=N.m,A=N.gc[N.ab],C=v(E,2);if(N.Oc&1<<C)c=0;else{switch(N.Oc|=1<<C,A.hc=C,A.Ea=b[0],A.nc=w[0],A.K=[null],++N.ab,t(4>=N.ab),C){case 0:case 1:A.b=v(E,3)+2,_=Ce(R(A.Ea,A.b),R(A.nc,A.b),0,N,A.K),A.K=A.K[0];break;case 3:var I,T=v(E,8)+1,D=16<T?0:4<T?1:2<T?2:3;if(b[0]=R(A.Ea,D),A.b=D,I=_=Ce(T,1,0,N,A.K)){var F,L=T,M=A,B=1<<(8>>M.b),z=s(B);if(null==z)I=0;else{var U=M.K[0],V=M.w;for(z[0]=M.K[0][0],F=1;F<1*L;++F)z[F]=O(U[V+F],z[F-1]);for(;F<4*B;++F)z[F]=0;M.K[0]=null,M.K[0]=z,I=1}}_=I;break;case 2:break;default:t(0)}c=_}}if(h=h[0],f=f[0],c&&v(g,1)&&!(c=1<=(y=v(g,4))&&11>=y)){o.a=3;break e}var q;if(q=c)t:{var H,G,W,K=o,Q=h,Y=f,X=y,J=a,Z=K.m,$=K.s,ee=[null],te=1,re=0,ae=Ja[X];r:for(;;){if(J&&v(Z,1)){var ne=v(Z,3)+2,se=R(Q,ne),ie=R(Y,ne),oe=se*ie;if(!Ce(se,ie,0,K,ee))break r;for(ee=ee[0],$.xc=ne,H=0;H<oe;++H){var le=ee[H]>>8&65535;ee[H]=le,le>=te&&(te=le+1)}}if(Z.h)break r;for(G=0;5>G;++G){var ce=Ka[G];!G&&0<X&&(ce+=1<<X),re<ce&&(re=ce)}var de=i(te*ae,u),ue=te,he=i(ue,m);if(null==he)var me=null;else t(65536>=ue),me=he;var fe=s(re);if(null==me||null==fe||null==de){K.a=1;break r}var ge=de;for(H=W=0;H<te;++H){var pe=me[H],xe=pe.G,ye=pe.H,be=0,we=1,ke=0;for(G=0;5>G;++G){ce=Ka[G],xe[G]=ge,ye[G]=W,!G&&0<X&&(ce+=1<<X);a:{var Ne,je=ce,Se=K,Ae=fe,Ie=ge,Te=W,De=0,Pe=Se.m,Fe=v(Pe,1);if(n(Ae,0,0,je),Fe){var Le=v(Pe,1)+1,Me=v(Pe,1),Re=v(Pe,0==Me?1:8);Ae[Re]=1,2==Le&&(Ae[Re=v(Pe,8)]=1);var Oe=1}else{var Be=s(19),ze=v(Pe,4)+4;if(19<ze){Se.a=3;var Ue=0;break a}for(Ne=0;Ne<ze;++Ne)Be[Ya[Ne]]=v(Pe,3);var Ve=void 0,qe=void 0,He=Se,Ge=Be,We=je,Ke=Ae,Qe=0,Ye=He.m,Xe=8,Je=i(128,u);n:for(;d(Je,0,7,Ge,19);){if(v(Ye,1)){var Ze=2+2*v(Ye,3);if((Ve=2+v(Ye,Ze))>We)break n}else Ve=We;for(qe=0;qe<We&&Ve--;){S(Ye);var $e=Je[0+(127&k(Ye))];j(Ye,Ye.u+$e.g);var et=$e.value;if(16>et)Ke[qe++]=et,0!=et&&(Xe=et);else{var tt=16==et,rt=et-16,at=Wa[rt],nt=v(Ye,Ga[rt])+at;if(qe+nt>We)break n;for(var st=tt?Xe:0;0<nt--;)Ke[qe++]=st}}Qe=1;break n}Qe||(He.a=3),Oe=Qe}(Oe=Oe&&!Pe.h)&&(De=d(Ie,Te,8,Ae,je)),Oe&&0!=De?Ue=De:(Se.a=3,Ue=0)}if(0==Ue)break r;if(we&&1==Qa[G]&&(we=0==ge[W].g),be+=ge[W].g,W+=Ue,3>=G){var it,ot=fe[0];for(it=1;it<ce;++it)fe[it]>ot&&(ot=fe[it]);ke+=ot}}if(pe.nd=we,pe.Qb=0,we&&(pe.qb=(xe[3][ye[3]+0].value<<24|xe[1][ye[1]+0].value<<16|xe[2][ye[2]+0].value)>>>0,0==be&&256>xe[0][ye[0]+0].value&&(pe.Qb=1,pe.qb+=xe[0][ye[0]+0].value<<8)),pe.jc=!pe.Qb&&6>ke,pe.jc){var lt,ct=pe;for(lt=0;lt<Rr;++lt){var dt=lt,ut=ct.pd[dt],ht=ct.G[0][ct.H[0]+dt];256<=ht.value?(ut.g=ht.g+256,ut.value=ht.value):(ut.g=0,ut.value=0,dt>>=ve(ht,8,ut),dt>>=ve(ct.G[1][ct.H[1]+dt],16,ut),dt>>=ve(ct.G[2][ct.H[2]+dt],0,ut),ve(ct.G[3][ct.H[3]+dt],24,ut))}}}$.vc=ee,$.Wb=te,$.Ya=me,$.yc=de,q=1;break t}q=0}if(!(c=q)){o.a=3;break e}if(0<y){if(p.ua=1<<y,!P(p.Wa,y)){o.a=1,c=0;break e}}else p.ua=0;var mt=o,ft=h,gt=f,pt=mt.s,xt=pt.xc;if(mt.c=ft,mt.i=gt,pt.md=R(ft,xt),pt.wc=0==xt?-1:(1<<xt)-1,a){o.xb=mn;break e}if(null==(x=s(h*f))){o.a=1,c=0;break e}c=(c=_e(o,x,0,h,f,f,null))&&!g.h;break e}return c?(null!=l?l[0]=x:(t(null==x),t(a)),o.$=0,a||Ee(p)):Ee(p),c}function Ie(e,r){var a=e.c*e.i,n=a+r+16*r;return t(e.c<=r),e.V=s(n),null==e.V?(e.Ta=null,e.Ua=0,e.a=1,0):(e.Ta=e.V,e.Ua=e.Ba+a+r,1)}function Te(e,r){var a=e.C,n=r-a,s=e.V,i=e.Ba+e.c*a;for(t(r<=e.l.o);0<n;){var o=16<n?16:n,l=e.l.ma,c=e.l.width,d=c*o,u=l.ca,h=l.tb+c*a,m=e.Ta,f=e.Ua;we(e,o,s,i),ja(m,f,u,h,d),je(l,a,a+o,u,h,c),n-=o,s+=o*e.c,a+=o}t(a==r),e.C=e.Ma=r}function De(){this.ub=this.yd=this.td=this.Rb=0}function Pe(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function Fe(){this.Fb=this.Bb=this.Cb=0,this.Zb=s(4),this.Lb=s(4)}function Le(){this.Yb=function(){var e=[];return function e(t,r,a){for(var n=a[r],s=0;s<n&&(t.push(a.length>r+1?[]:0),!(a.length<r+1));s++)e(t[s],r+1,a)}(e,0,[3,11]),e}()}function Me(){this.jb=s(3),this.Wc=o([4,8],Le),this.Xc=o([4,17],Le)}function Re(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new s(4),this.od=new s(4)}function Oe(){this.ld=this.La=this.dd=this.tc=0}function Be(){this.Na=this.la=0}function ze(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function Ue(){this.ad=s(384),this.Za=0,this.Ob=s(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function Ve(){this.uc=this.M=this.Nb=0,this.wa=Array(new Oe),this.Y=0,this.ya=Array(new Ue),this.aa=0,this.l=new We}function qe(){this.y=s(16),this.f=s(8),this.ea=s(8)}function He(){this.cb=this.a=0,this.sc="",this.m=new b,this.Od=new De,this.Kc=new Pe,this.ed=new Re,this.Qa=new Fe,this.Ic=this.$c=this.Aa=0,this.D=new Ve,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=i(8,b),this.ia=0,this.pb=i(4,ze),this.Pa=new Me,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new qe),this.Hd=0,this.rb=Array(new Be),this.sb=0,this.wa=Array(new Oe),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new Ue),this.L=this.aa=0,this.gd=o([4,2],Oe),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function Ge(e,t){return 0>e?0:e>t?t:e}function We(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function Ke(){var e=new He;return null!=e&&(e.a=0,e.sc="OK",e.cb=0,e.Xb=0,tn||(tn=Je)),e}function Qe(e,t,r){return 0==e.a&&(e.a=t,e.sc=r,e.cb=0),0}function Ye(e,t,r){return 3<=r&&157==e[t+0]&&1==e[t+1]&&42==e[t+2]}function Xe(e,r){if(null==e)return 0;if(e.a=0,e.sc="OK",null==r)return Qe(e,2,"null VP8Io passed to VP8GetHeaders()");var a=r.data,s=r.w,i=r.ha;if(4>i)return Qe(e,7,"Truncated header.");var o=a[s+0]|a[s+1]<<8|a[s+2]<<16,l=e.Od;if(l.Rb=!(1&o),l.td=o>>1&7,l.yd=o>>4&1,l.ub=o>>5,3<l.td)return Qe(e,3,"Incorrect keyframe parameters.");if(!l.yd)return Qe(e,4,"Frame not displayable.");s+=3,i-=3;var c=e.Kc;if(l.Rb){if(7>i)return Qe(e,7,"cannot parse picture header");if(!Ye(a,s,i))return Qe(e,3,"Bad code word");c.c=16383&(a[s+4]<<8|a[s+3]),c.Td=a[s+4]>>6,c.i=16383&(a[s+6]<<8|a[s+5]),c.Ud=a[s+6]>>6,s+=7,i-=7,e.za=c.c+15>>4,e.Ub=c.i+15>>4,r.width=c.c,r.height=c.i,r.Da=0,r.j=0,r.v=0,r.va=r.width,r.o=r.height,r.da=0,r.ib=r.width,r.hb=r.height,r.U=r.width,r.T=r.height,n((o=e.Pa).jb,0,255,o.jb.length),t(null!=(o=e.Qa)),o.Cb=0,o.Bb=0,o.Fb=1,n(o.Zb,0,0,o.Zb.length),n(o.Lb,0,0,o.Lb)}if(l.ub>i)return Qe(e,7,"bad partition length");f(o=e.m,a,s,l.ub),s+=l.ub,i-=l.ub,l.Rb&&(c.Ld=E(o),c.Kd=E(o)),c=e.Qa;var d,u=e.Pa;if(t(null!=o),t(null!=c),c.Cb=E(o),c.Cb){if(c.Bb=E(o),E(o)){for(c.Fb=E(o),d=0;4>d;++d)c.Zb[d]=E(o)?p(o,7):0;for(d=0;4>d;++d)c.Lb[d]=E(o)?p(o,6):0}if(c.Bb)for(d=0;3>d;++d)u.jb[d]=E(o)?g(o,8):255}else c.Bb=0;if(o.Ka)return Qe(e,3,"cannot parse segment header");if((c=e.ed).zd=E(o),c.Tb=g(o,6),c.wb=g(o,3),c.Pc=E(o),c.Pc&&E(o)){for(u=0;4>u;++u)E(o)&&(c.vd[u]=p(o,6));for(u=0;4>u;++u)E(o)&&(c.od[u]=p(o,6))}if(e.L=0==c.Tb?0:c.zd?1:2,o.Ka)return Qe(e,3,"cannot parse filter header");var h=i;if(i=d=s,s=d+h,c=h,e.Xb=(1<<g(e.m,2))-1,h<3*(u=e.Xb))a=7;else{for(d+=3*u,c-=3*u,h=0;h<u;++h){var m=a[i+0]|a[i+1]<<8|a[i+2]<<16;m>c&&(m=c),f(e.Jc[+h],a,d,m),d+=m,c-=m,i+=3}f(e.Jc[+u],a,d,c),a=d<s?0:5}if(0!=a)return Qe(e,a,"cannot parse partitions");for(a=g(d=e.m,7),i=E(d)?p(d,4):0,s=E(d)?p(d,4):0,c=E(d)?p(d,4):0,u=E(d)?p(d,4):0,d=E(d)?p(d,4):0,h=e.Qa,m=0;4>m;++m){if(h.Cb){var x=h.Zb[m];h.Fb||(x+=a)}else{if(0<m){e.pb[m]=e.pb[0];continue}x=a}var y=e.pb[m];y.Sc[0]=$a[Ge(x+i,127)],y.Sc[1]=en[Ge(x+0,127)],y.Eb[0]=2*$a[Ge(x+s,127)],y.Eb[1]=101581*en[Ge(x+c,127)]>>16,8>y.Eb[1]&&(y.Eb[1]=8),y.Qc[0]=$a[Ge(x+u,117)],y.Qc[1]=en[Ge(x+d,127)],y.lc=x+d}if(!l.Rb)return Qe(e,4,"Not a key frame.");for(E(o),l=e.Pa,a=0;4>a;++a){for(i=0;8>i;++i)for(s=0;3>s;++s)for(c=0;11>c;++c)u=A(o,ln[a][i][s][c])?g(o,8):sn[a][i][s][c],l.Wc[a][i].Yb[s][c]=u;for(i=0;17>i;++i)l.Xc[a][i]=l.Wc[a][cn[i]]}return e.kc=E(o),e.kc&&(e.Bd=g(o,8)),e.cb=1}function Je(e,t,r,a,n,s,i){var o=t[n].Yb[r];for(r=0;16>n;++n){if(!A(e,o[r+0]))return n;for(;!A(e,o[r+1]);)if(o=t[++n].Yb[0],r=0,16==n)return 16;var l=t[n+1].Yb;if(A(e,o[r+2])){var c=e,d=0;if(A(c,(h=o)[(u=r)+3]))if(A(c,h[u+6])){for(o=0,u=2*(d=A(c,h[u+8]))+(h=A(c,h[u+9+d])),d=0,h=rn[u];h[o];++o)d+=d+A(c,h[o]);d+=3+(8<<u)}else A(c,h[u+7])?(d=7+2*A(c,165),d+=A(c,145)):d=5+A(c,159);else d=A(c,h[u+4])?3+A(c,h[u+5]):2;o=l[2]}else d=1,o=l[1];l=i+an[n],0>(c=e).b&&_(c);var u,h=c.b,m=(u=c.Ca>>1)-(c.I>>h)>>31;--c.b,c.Ca+=m,c.Ca|=1,c.I-=(u+1&m)<<h,s[l]=((d^m)-m)*a[(0<n)+0]}return 16}function Ze(e){var t=e.rb[e.sb-1];t.la=0,t.Na=0,n(e.zc,0,0,e.zc.length),e.ja=0}function $e(e,t,r,a,n){n=e[t+r+32*a]+(n>>3),e[t+r+32*a]=-256&n?0>n?0:255:n}function et(e,t,r,a,n,s){$e(e,t,0,r,a+n),$e(e,t,1,r,a+s),$e(e,t,2,r,a-s),$e(e,t,3,r,a-n)}function tt(e){return(20091*e>>16)+e}function rt(e,t,r,a){var n,i=0,o=s(16);for(n=0;4>n;++n){var l=e[t+0]+e[t+8],c=e[t+0]-e[t+8],d=(35468*e[t+4]>>16)-tt(e[t+12]),u=tt(e[t+4])+(35468*e[t+12]>>16);o[i+0]=l+u,o[i+1]=c+d,o[i+2]=c-d,o[i+3]=l-u,i+=4,t++}for(n=i=0;4>n;++n)l=(e=o[i+0]+4)+o[i+8],c=e-o[i+8],d=(35468*o[i+4]>>16)-tt(o[i+12]),$e(r,a,0,0,l+(u=tt(o[i+4])+(35468*o[i+12]>>16))),$e(r,a,1,0,c+d),$e(r,a,2,0,c-d),$e(r,a,3,0,l-u),i++,a+=32}function at(e,t,r,a){var n=e[t+0]+4,s=35468*e[t+4]>>16,i=tt(e[t+4]),o=35468*e[t+1]>>16;et(r,a,0,n+i,e=tt(e[t+1]),o),et(r,a,1,n+s,e,o),et(r,a,2,n-s,e,o),et(r,a,3,n-i,e,o)}function nt(e,t,r,a,n){rt(e,t,r,a),n&&rt(e,t+16,r,a+4)}function st(e,t,r,a){na(e,t+0,r,a,1),na(e,t+32,r,a+128,1)}function it(e,t,r,a){var n;for(e=e[t+0]+4,n=0;4>n;++n)for(t=0;4>t;++t)$e(r,a,t,n,e)}function ot(e,t,r,a){e[t+0]&&oa(e,t+0,r,a),e[t+16]&&oa(e,t+16,r,a+4),e[t+32]&&oa(e,t+32,r,a+128),e[t+48]&&oa(e,t+48,r,a+128+4)}function lt(e,t,r,a){var n,i=s(16);for(n=0;4>n;++n){var o=e[t+0+n]+e[t+12+n],l=e[t+4+n]+e[t+8+n],c=e[t+4+n]-e[t+8+n],d=e[t+0+n]-e[t+12+n];i[0+n]=o+l,i[8+n]=o-l,i[4+n]=d+c,i[12+n]=d-c}for(n=0;4>n;++n)o=(e=i[0+4*n]+3)+i[3+4*n],l=i[1+4*n]+i[2+4*n],c=i[1+4*n]-i[2+4*n],d=e-i[3+4*n],r[a+0]=o+l>>3,r[a+16]=d+c>>3,r[a+32]=o-l>>3,r[a+48]=d-c>>3,a+=64}function ct(e,t,r){var a,n=t-32,s=Da,i=255-e[n-1];for(a=0;a<r;++a){var o,l=s,c=i+e[t-1];for(o=0;o<r;++o)e[t+o]=l[c+e[n+o]];t+=32}}function dt(e,t){ct(e,t,4)}function ut(e,t){ct(e,t,8)}function ht(e,t){ct(e,t,16)}function mt(e,t){var r;for(r=0;16>r;++r)a(e,t+32*r,e,t-32,16)}function ft(e,t){var r;for(r=16;0<r;--r)n(e,t,e[t-1],16),t+=32}function gt(e,t,r){var a;for(a=0;16>a;++a)n(t,r+32*a,e,16)}function pt(e,t){var r,a=16;for(r=0;16>r;++r)a+=e[t-1+32*r]+e[t+r-32];gt(a>>5,e,t)}function xt(e,t){var r,a=8;for(r=0;16>r;++r)a+=e[t-1+32*r];gt(a>>4,e,t)}function yt(e,t){var r,a=8;for(r=0;16>r;++r)a+=e[t+r-32];gt(a>>4,e,t)}function vt(e,t){gt(128,e,t)}function bt(e,t,r){return e+2*t+r+2>>2}function wt(e,t){var r,n=t-32;for(n=new Uint8Array([bt(e[n-1],e[n+0],e[n+1]),bt(e[n+0],e[n+1],e[n+2]),bt(e[n+1],e[n+2],e[n+3]),bt(e[n+2],e[n+3],e[n+4])]),r=0;4>r;++r)a(e,t+32*r,n,0,n.length)}function kt(e,t){var r=e[t-1],a=e[t-1+32],n=e[t-1+64],s=e[t-1+96];C(e,t+0,16843009*bt(e[t-1-32],r,a)),C(e,t+32,16843009*bt(r,a,n)),C(e,t+64,16843009*bt(a,n,s)),C(e,t+96,16843009*bt(n,s,s))}function Nt(e,t){var r,a=4;for(r=0;4>r;++r)a+=e[t+r-32]+e[t-1+32*r];for(a>>=3,r=0;4>r;++r)n(e,t+32*r,a,4)}function jt(e,t){var r=e[t-1+0],a=e[t-1+32],n=e[t-1+64],s=e[t-1-32],i=e[t+0-32],o=e[t+1-32],l=e[t+2-32],c=e[t+3-32];e[t+0+96]=bt(a,n,e[t-1+96]),e[t+1+96]=e[t+0+64]=bt(r,a,n),e[t+2+96]=e[t+1+64]=e[t+0+32]=bt(s,r,a),e[t+3+96]=e[t+2+64]=e[t+1+32]=e[t+0+0]=bt(i,s,r),e[t+3+64]=e[t+2+32]=e[t+1+0]=bt(o,i,s),e[t+3+32]=e[t+2+0]=bt(l,o,i),e[t+3+0]=bt(c,l,o)}function St(e,t){var r=e[t+1-32],a=e[t+2-32],n=e[t+3-32],s=e[t+4-32],i=e[t+5-32],o=e[t+6-32],l=e[t+7-32];e[t+0+0]=bt(e[t+0-32],r,a),e[t+1+0]=e[t+0+32]=bt(r,a,n),e[t+2+0]=e[t+1+32]=e[t+0+64]=bt(a,n,s),e[t+3+0]=e[t+2+32]=e[t+1+64]=e[t+0+96]=bt(n,s,i),e[t+3+32]=e[t+2+64]=e[t+1+96]=bt(s,i,o),e[t+3+64]=e[t+2+96]=bt(i,o,l),e[t+3+96]=bt(o,l,l)}function _t(e,t){var r=e[t-1+0],a=e[t-1+32],n=e[t-1+64],s=e[t-1-32],i=e[t+0-32],o=e[t+1-32],l=e[t+2-32],c=e[t+3-32];e[t+0+0]=e[t+1+64]=s+i+1>>1,e[t+1+0]=e[t+2+64]=i+o+1>>1,e[t+2+0]=e[t+3+64]=o+l+1>>1,e[t+3+0]=l+c+1>>1,e[t+0+96]=bt(n,a,r),e[t+0+64]=bt(a,r,s),e[t+0+32]=e[t+1+96]=bt(r,s,i),e[t+1+32]=e[t+2+96]=bt(s,i,o),e[t+2+32]=e[t+3+96]=bt(i,o,l),e[t+3+32]=bt(o,l,c)}function Et(e,t){var r=e[t+0-32],a=e[t+1-32],n=e[t+2-32],s=e[t+3-32],i=e[t+4-32],o=e[t+5-32],l=e[t+6-32],c=e[t+7-32];e[t+0+0]=r+a+1>>1,e[t+1+0]=e[t+0+64]=a+n+1>>1,e[t+2+0]=e[t+1+64]=n+s+1>>1,e[t+3+0]=e[t+2+64]=s+i+1>>1,e[t+0+32]=bt(r,a,n),e[t+1+32]=e[t+0+96]=bt(a,n,s),e[t+2+32]=e[t+1+96]=bt(n,s,i),e[t+3+32]=e[t+2+96]=bt(s,i,o),e[t+3+64]=bt(i,o,l),e[t+3+96]=bt(o,l,c)}function At(e,t){var r=e[t-1+0],a=e[t-1+32],n=e[t-1+64],s=e[t-1+96];e[t+0+0]=r+a+1>>1,e[t+2+0]=e[t+0+32]=a+n+1>>1,e[t+2+32]=e[t+0+64]=n+s+1>>1,e[t+1+0]=bt(r,a,n),e[t+3+0]=e[t+1+32]=bt(a,n,s),e[t+3+32]=e[t+1+64]=bt(n,s,s),e[t+3+64]=e[t+2+64]=e[t+0+96]=e[t+1+96]=e[t+2+96]=e[t+3+96]=s}function Ct(e,t){var r=e[t-1+0],a=e[t-1+32],n=e[t-1+64],s=e[t-1+96],i=e[t-1-32],o=e[t+0-32],l=e[t+1-32],c=e[t+2-32];e[t+0+0]=e[t+2+32]=r+i+1>>1,e[t+0+32]=e[t+2+64]=a+r+1>>1,e[t+0+64]=e[t+2+96]=n+a+1>>1,e[t+0+96]=s+n+1>>1,e[t+3+0]=bt(o,l,c),e[t+2+0]=bt(i,o,l),e[t+1+0]=e[t+3+32]=bt(r,i,o),e[t+1+32]=e[t+3+64]=bt(a,r,i),e[t+1+64]=e[t+3+96]=bt(n,a,r),e[t+1+96]=bt(s,n,a)}function It(e,t){var r;for(r=0;8>r;++r)a(e,t+32*r,e,t-32,8)}function Tt(e,t){var r;for(r=0;8>r;++r)n(e,t,e[t-1],8),t+=32}function Dt(e,t,r){var a;for(a=0;8>a;++a)n(t,r+32*a,e,8)}function Pt(e,t){var r,a=8;for(r=0;8>r;++r)a+=e[t+r-32]+e[t-1+32*r];Dt(a>>4,e,t)}function Ft(e,t){var r,a=4;for(r=0;8>r;++r)a+=e[t+r-32];Dt(a>>3,e,t)}function Lt(e,t){var r,a=4;for(r=0;8>r;++r)a+=e[t-1+32*r];Dt(a>>3,e,t)}function Mt(e,t){Dt(128,e,t)}function Rt(e,t,r){var a=e[t-r],n=e[t+0],s=3*(n-a)+Ia[1020+e[t-2*r]-e[t+r]],i=Ta[112+(s+4>>3)];e[t-r]=Da[255+a+Ta[112+(s+3>>3)]],e[t+0]=Da[255+n-i]}function Ot(e,t,r,a){var n=e[t+0],s=e[t+r];return Pa[255+e[t-2*r]-e[t-r]]>a||Pa[255+s-n]>a}function Bt(e,t,r,a){return 4*Pa[255+e[t-r]-e[t+0]]+Pa[255+e[t-2*r]-e[t+r]]<=a}function zt(e,t,r,a,n){var s=e[t-3*r],i=e[t-2*r],o=e[t-r],l=e[t+0],c=e[t+r],d=e[t+2*r],u=e[t+3*r];return 4*Pa[255+o-l]+Pa[255+i-c]>a?0:Pa[255+e[t-4*r]-s]<=n&&Pa[255+s-i]<=n&&Pa[255+i-o]<=n&&Pa[255+u-d]<=n&&Pa[255+d-c]<=n&&Pa[255+c-l]<=n}function Ut(e,t,r,a){var n=2*a+1;for(a=0;16>a;++a)Bt(e,t+a,r,n)&&Rt(e,t+a,r)}function Vt(e,t,r,a){var n=2*a+1;for(a=0;16>a;++a)Bt(e,t+a*r,1,n)&&Rt(e,t+a*r,1)}function qt(e,t,r,a){var n;for(n=3;0<n;--n)Ut(e,t+=4*r,r,a)}function Ht(e,t,r,a){var n;for(n=3;0<n;--n)Vt(e,t+=4,r,a)}function Gt(e,t,r,a,n,s,i,o){for(s=2*s+1;0<n--;){if(zt(e,t,r,s,i))if(Ot(e,t,r,o))Rt(e,t,r);else{var l=e,c=t,d=r,u=l[c-2*d],h=l[c-d],m=l[c+0],f=l[c+d],g=l[c+2*d],p=27*(y=Ia[1020+3*(m-h)+Ia[1020+u-f]])+63>>7,x=18*y+63>>7,y=9*y+63>>7;l[c-3*d]=Da[255+l[c-3*d]+y],l[c-2*d]=Da[255+u+x],l[c-d]=Da[255+h+p],l[c+0]=Da[255+m-p],l[c+d]=Da[255+f-x],l[c+2*d]=Da[255+g-y]}t+=a}}function Wt(e,t,r,a,n,s,i,o){for(s=2*s+1;0<n--;){if(zt(e,t,r,s,i))if(Ot(e,t,r,o))Rt(e,t,r);else{var l=e,c=t,d=r,u=l[c-d],h=l[c+0],m=l[c+d],f=Ta[112+(4+(g=3*(h-u))>>3)],g=Ta[112+(g+3>>3)],p=f+1>>1;l[c-2*d]=Da[255+l[c-2*d]+p],l[c-d]=Da[255+u+g],l[c+0]=Da[255+h-f],l[c+d]=Da[255+m-p]}t+=a}}function Kt(e,t,r,a,n,s){Gt(e,t,r,1,16,a,n,s)}function Qt(e,t,r,a,n,s){Gt(e,t,1,r,16,a,n,s)}function Yt(e,t,r,a,n,s){var i;for(i=3;0<i;--i)Wt(e,t+=4*r,r,1,16,a,n,s)}function Xt(e,t,r,a,n,s){var i;for(i=3;0<i;--i)Wt(e,t+=4,1,r,16,a,n,s)}function Jt(e,t,r,a,n,s,i,o){Gt(e,t,n,1,8,s,i,o),Gt(r,a,n,1,8,s,i,o)}function Zt(e,t,r,a,n,s,i,o){Gt(e,t,1,n,8,s,i,o),Gt(r,a,1,n,8,s,i,o)}function $t(e,t,r,a,n,s,i,o){Wt(e,t+4*n,n,1,8,s,i,o),Wt(r,a+4*n,n,1,8,s,i,o)}function er(e,t,r,a,n,s,i,o){Wt(e,t+4,1,n,8,s,i,o),Wt(r,a+4,1,n,8,s,i,o)}function tr(){this.ba=new ie,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new le,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function rr(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function ar(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function nr(){this.ua=0,this.Wa=new L,this.vb=new L,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new m,this.yc=new u}function sr(){this.xb=this.a=0,this.l=new We,this.ca=new ie,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new w,this.Pb=0,this.wd=new w,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new nr,this.ab=0,this.gc=i(4,ar),this.Oc=0}function ir(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new We,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function or(e,t,r,a,n,s,i){for(e=null==e?0:e[t+0],t=0;t<i;++t)n[s+t]=e+r[a+t]&255,e=n[s+t]}function lr(e,t,r,a,n,s,i){var o;if(null==e)or(null,null,r,a,n,s,i);else for(o=0;o<i;++o)n[s+o]=e[t+o]+r[a+o]&255}function cr(e,t,r,a,n,s,i){if(null==e)or(null,null,r,a,n,s,i);else{var o,l=e[t+0],c=l,d=l;for(o=0;o<i;++o)c=d+(l=e[t+o])-c,d=r[a+o]+(-256&c?0>c?0:255:c)&255,c=l,n[s+o]=d}}function dr(e,r,n,i){var o=r.width,l=r.o;if(t(null!=e&&null!=r),0>n||0>=i||n+i>l)return null;if(!e.Cc){if(null==e.ga){var c;if(e.ga=new ir,(c=null==e.ga)||(c=r.width*r.o,t(0==e.Gb.length),e.Gb=s(c),e.Uc=0,null==e.Gb?c=0:(e.mb=e.Gb,e.nb=e.Uc,e.rc=null,c=1),c=!c),!c){c=e.ga;var d=e.Fa,u=e.P,h=e.qc,m=e.mb,f=e.nb,g=u+1,p=h-1,y=c.l;if(t(null!=d&&null!=m&&null!=r),gn[0]=null,gn[1]=or,gn[2]=lr,gn[3]=cr,c.ca=m,c.tb=f,c.c=r.width,c.i=r.height,t(0<c.c&&0<c.i),1>=h)r=0;else if(c.$a=3&d[u+0],c.Z=d[u+0]>>2&3,c.Lc=d[u+0]>>4&3,u=d[u+0]>>6&3,0>c.$a||1<c.$a||4<=c.Z||1<c.Lc||u)r=0;else if(y.put=me,y.ac=he,y.bc=fe,y.ma=c,y.width=r.width,y.height=r.height,y.Da=r.Da,y.v=r.v,y.va=r.va,y.j=r.j,y.o=r.o,c.$a)e:{t(1==c.$a),r=Ae();t:for(;;){if(null==r){r=0;break e}if(t(null!=c),c.mc=r,r.c=c.c,r.i=c.i,r.l=c.l,r.l.ma=c,r.l.width=c.c,r.l.height=c.i,r.a=0,x(r.m,d,g,p),!Ce(c.c,c.i,1,r,null))break t;if(1==r.ab&&3==r.gc[0].hc&&Ne(r.s)?(c.ic=1,d=r.c*r.i,r.Ta=null,r.Ua=0,r.V=s(d),r.Ba=0,null==r.V?(r.a=1,r=0):r=1):(c.ic=0,r=Ie(r,c.c)),!r)break t;r=1;break e}c.mc=null,r=0}else r=p>=c.c*c.i;c=!r}if(c)return null;1!=e.ga.Lc?e.Ga=0:i=l-n}t(null!=e.ga),t(n+i<=l);e:{if(r=(d=e.ga).c,l=d.l.o,0==d.$a){if(g=e.rc,p=e.Vc,y=e.Fa,u=e.P+1+n*r,h=e.mb,m=e.nb+n*r,t(u<=e.P+e.qc),0!=d.Z)for(t(null!=gn[d.Z]),c=0;c<i;++c)gn[d.Z](g,p,y,u,h,m,r),g=h,p=m,m+=r,u+=r;else for(c=0;c<i;++c)a(h,m,y,u,r),g=h,p=m,m+=r,u+=r;e.rc=g,e.Vc=p}else{if(t(null!=d.mc),r=n+i,t(null!=(c=d.mc)),t(r<=c.i),c.C>=r)r=1;else if(d.ic||gr(),d.ic){d=c.V,g=c.Ba,p=c.c;var v=c.i,b=(y=1,u=c.$/p,h=c.$%p,m=c.m,f=c.s,c.$),w=p*v,k=p*r,j=f.wc,_=b<k?be(f,h,u):null;t(b<=w),t(r<=v),t(Ne(f));t:for(;;){for(;!m.h&&b<k;){if(h&j||(_=be(f,h,u)),t(null!=_),S(m),256>(v=ye(_.G[0],_.H[0],m)))d[g+b]=v,++b,++h>=p&&(h=0,++u<=r&&!(u%16)&&Se(c,u));else{if(!(280>v)){y=0;break t}v=pe(v-256,m);var E,A=ye(_.G[4],_.H[4],m);if(S(m),!(b>=(A=xe(p,A=pe(A,m)))&&w-b>=v)){y=0;break t}for(E=0;E<v;++E)d[g+b+E]=d[g+b+E-A];for(b+=v,h+=v;h>=p;)h-=p,++u<=r&&!(u%16)&&Se(c,u);b<k&&h&j&&(_=be(f,h,u))}t(m.h==N(m))}Se(c,u>r?r:u);break t}!y||m.h&&b<w?(y=0,c.a=m.h?5:3):c.$=b,r=y}else r=_e(c,c.V,c.Ba,c.c,c.i,r,Te);if(!r){i=0;break e}}n+i>=l&&(e.Cc=1),i=1}if(!i)return null;if(e.Cc&&(null!=(i=e.ga)&&(i.mc=null),e.ga=null,0<e.Ga))return alert("todo:WebPDequantizeLevels"),null}return e.nb+n*o}function ur(e,t,r,a,n,s){for(;0<n--;){var i,o=e,l=t+(r?1:0),c=e,d=t+(r?0:3);for(i=0;i<a;++i){var u=c[d+4*i];255!=u&&(u*=32897,o[l+4*i+0]=o[l+4*i+0]*u>>23,o[l+4*i+1]=o[l+4*i+1]*u>>23,o[l+4*i+2]=o[l+4*i+2]*u>>23)}t+=s}}function hr(e,t,r,a,n){for(;0<a--;){var s;for(s=0;s<r;++s){var i=e[t+2*s+0],o=15&(c=e[t+2*s+1]),l=4369*o,c=(240&c|c>>4)*l>>16;e[t+2*s+0]=(240&i|i>>4)*l>>16&240|(15&i|i<<4)*l>>16>>4&15,e[t+2*s+1]=240&c|o}t+=n}}function mr(e,t,r,a,n,s,i,o){var l,c,d=255;for(c=0;c<n;++c){for(l=0;l<a;++l){var u=e[t+l];s[i+4*l]=u,d&=u}t+=r,i+=o}return 255!=d}function fr(e,t,r,a,n){var s;for(s=0;s<n;++s)r[a+s]=e[t+s]>>8}function gr(){wa=ur,ka=hr,Na=mr,ja=fr}function pr(r,a,n){e[r]=function(e,r,s,i,o,l,c,d,u,h,m,f,g,p,x,y,v){var b,w=v-1>>1,k=o[l+0]|c[d+0]<<16,N=u[h+0]|m[f+0]<<16;t(null!=e);var j=3*k+N+131074>>2;for(a(e[r+0],255&j,j>>16,g,p),null!=s&&(j=3*N+k+131074>>2,a(s[i+0],255&j,j>>16,x,y)),b=1;b<=w;++b){var S=o[l+b]|c[d+b]<<16,_=u[h+b]|m[f+b]<<16,E=k+S+N+_+524296,A=E+2*(S+N)>>3;j=A+k>>1,k=(E=E+2*(k+_)>>3)+S>>1,a(e[r+2*b-1],255&j,j>>16,g,p+(2*b-1)*n),a(e[r+2*b-0],255&k,k>>16,g,p+(2*b-0)*n),null!=s&&(j=E+N>>1,k=A+_>>1,a(s[i+2*b-1],255&j,j>>16,x,y+(2*b-1)*n),a(s[i+2*b+0],255&k,k>>16,x,y+(2*b+0)*n)),k=S,N=_}1&v||(j=3*k+N+131074>>2,a(e[r+v-1],255&j,j>>16,g,p+(v-1)*n),null!=s&&(j=3*N+k+131074>>2,a(s[i+v-1],255&j,j>>16,x,y+(v-1)*n)))}}function xr(){pn[Fa]=xn,pn[La]=vn,pn[Ma]=yn,pn[Ra]=bn,pn[Oa]=wn,pn[Ba]=kn,pn[za]=Nn,pn[Ua]=vn,pn[Va]=bn,pn[qa]=wn,pn[Ha]=kn}function yr(e){return e&~Cn?0>e?0:255:e>>An}function vr(e,t){return yr((19077*e>>8)+(26149*t>>8)-14234)}function br(e,t,r){return yr((19077*e>>8)-(6419*t>>8)-(13320*r>>8)+8708)}function wr(e,t){return yr((19077*e>>8)+(33050*t>>8)-17685)}function kr(e,t,r,a,n){a[n+0]=vr(e,r),a[n+1]=br(e,t,r),a[n+2]=wr(e,t)}function Nr(e,t,r,a,n){a[n+0]=wr(e,t),a[n+1]=br(e,t,r),a[n+2]=vr(e,r)}function jr(e,t,r,a,n){var s=br(e,t,r);t=s<<3&224|wr(e,t)>>3,a[n+0]=248&vr(e,r)|s>>5,a[n+1]=t}function Sr(e,t,r,a,n){var s=240&wr(e,t)|15;a[n+0]=240&vr(e,r)|br(e,t,r)>>4,a[n+1]=s}function _r(e,t,r,a,n){a[n+0]=255,kr(e,t,r,a,n+1)}function Er(e,t,r,a,n){Nr(e,t,r,a,n),a[n+3]=255}function Ar(e,t,r,a,n){kr(e,t,r,a,n),a[n+3]=255}function Ge(e,t){return 0>e?0:e>t?t:e}function Cr(t,r,a){e[t]=function(e,t,n,s,i,o,l,c,d){for(var u=c+(-2&d)*a;c!=u;)r(e[t+0],n[s+0],i[o+0],l,c),r(e[t+1],n[s+0],i[o+0],l,c+a),t+=2,++s,++o,c+=2*a;1&d&&r(e[t+0],n[s+0],i[o+0],l,c)}}function Ir(e,t,r){return 0==r?0==e?0==t?6:5:0==t?4:0:r}function Tr(e,t,r,a,n){switch(e>>>30){case 3:na(t,r,a,n,0);break;case 2:sa(t,r,a,n);break;case 1:oa(t,r,a,n)}}function Dr(e,t){var r,s,i=t.M,o=t.Nb,l=e.oc,c=e.pc+40,d=e.oc,u=e.pc+584,h=e.oc,m=e.pc+600;for(r=0;16>r;++r)l[c+32*r-1]=129;for(r=0;8>r;++r)d[u+32*r-1]=129,h[m+32*r-1]=129;for(0<i?l[c-1-32]=d[u-1-32]=h[m-1-32]=129:(n(l,c-32-1,127,21),n(d,u-32-1,127,9),n(h,m-32-1,127,9)),s=0;s<e.za;++s){var f=t.ya[t.aa+s];if(0<s){for(r=-1;16>r;++r)a(l,c+32*r-4,l,c+32*r+12,4);for(r=-1;8>r;++r)a(d,u+32*r-4,d,u+32*r+4,4),a(h,m+32*r-4,h,m+32*r+4,4)}var g=e.Gd,p=e.Hd+s,x=f.ad,y=f.Hc;if(0<i&&(a(l,c-32,g[p].y,0,16),a(d,u-32,g[p].f,0,8),a(h,m-32,g[p].ea,0,8)),f.Za){var v=l,b=c-32+16;for(0<i&&(s>=e.za-1?n(v,b,g[p].y[15],4):a(v,b,g[p+1].y,0,4)),r=0;4>r;r++)v[b+128+r]=v[b+256+r]=v[b+384+r]=v[b+0+r];for(r=0;16>r;++r,y<<=2)v=l,b=c+Rn[r],un[f.Ob[r]](v,b),Tr(y,x,16*+r,v,b)}else if(v=Ir(s,i,f.Ob[0]),dn[v](l,c),0!=y)for(r=0;16>r;++r,y<<=2)Tr(y,x,16*+r,l,c+Rn[r]);for(r=f.Gc,v=Ir(s,i,f.Dd),hn[v](d,u),hn[v](h,m),y=x,v=d,b=u,255&(f=0|r)&&(170&f?ia(y,256,v,b):la(y,256,v,b)),f=h,y=m,255&(r>>=8)&&(170&r?ia(x,320,f,y):la(x,320,f,y)),i<e.Ub-1&&(a(g[p].y,0,l,c+480,16),a(g[p].f,0,d,u+224,8),a(g[p].ea,0,h,m+224,8)),r=8*o*e.B,g=e.sa,p=e.ta+16*s+16*o*e.R,x=e.qa,f=e.ra+8*s+r,y=e.Ha,v=e.Ia+8*s+r,r=0;16>r;++r)a(g,p+r*e.R,l,c+32*r,16);for(r=0;8>r;++r)a(x,f+r*e.B,d,u+32*r,8),a(y,v+r*e.B,h,m+32*r,8)}}function Pr(e,a,n,s,i,o,l,c,d){var u=[0],h=[0],m=0,f=null!=d?d.kd:0,g=null!=d?d:new rr;if(null==e||12>n)return 7;g.data=e,g.w=a,g.ha=n,a=[a],n=[n],g.gb=[g.gb];e:{var p=a,y=n,v=g.gb;if(t(null!=e),t(null!=y),t(null!=v),v[0]=0,12<=y[0]&&!r(e,p[0],"RIFF")){if(r(e,p[0]+8,"WEBP")){v=3;break e}var b=D(e,p[0]+4);if(12>b||4294967286<b){v=3;break e}if(f&&b>y[0]-8){v=7;break e}v[0]=b,p[0]+=12,y[0]-=12}v=0}if(0!=v)return v;for(b=0<g.gb[0],n=n[0];;){e:{var k=e;y=a,v=n;var N=u,j=h,S=p=[0];if((A=m=[m])[0]=0,8>v[0])v=7;else{if(!r(k,y[0],"VP8X")){if(10!=D(k,y[0]+4)){v=3;break e}if(18>v[0]){v=7;break e}var _=D(k,y[0]+8),E=1+T(k,y[0]+12);if(2147483648<=E*(k=1+T(k,y[0]+15))){v=3;break e}null!=S&&(S[0]=_),null!=N&&(N[0]=E),null!=j&&(j[0]=k),y[0]+=18,v[0]-=18,A[0]=1}v=0}}if(m=m[0],p=p[0],0!=v)return v;if(y=!!(2&p),!b&&m)return 3;if(null!=o&&(o[0]=!!(16&p)),null!=l&&(l[0]=y),null!=c&&(c[0]=0),l=u[0],p=h[0],m&&y&&null==d){v=0;break}if(4>n){v=7;break}if(b&&m||!b&&!m&&!r(e,a[0],"ALPH")){n=[n],g.na=[g.na],g.P=[g.P],g.Sa=[g.Sa];e:{_=e,v=a,b=n;var A=g.gb;N=g.na,j=g.P,S=g.Sa,E=22,t(null!=_),t(null!=b),k=v[0];var C=b[0];for(t(null!=N),t(null!=S),N[0]=null,j[0]=null,S[0]=0;;){if(v[0]=k,b[0]=C,8>C){v=7;break e}var I=D(_,k+4);if(4294967286<I){v=3;break e}var P=8+I+1&-2;if(E+=P,0<A&&E>A){v=3;break e}if(!r(_,k,"VP8 ")||!r(_,k,"VP8L")){v=0;break e}if(C[0]<P){v=7;break e}r(_,k,"ALPH")||(N[0]=_,j[0]=k+8,S[0]=I),k+=P,C-=P}}if(n=n[0],g.na=g.na[0],g.P=g.P[0],g.Sa=g.Sa[0],0!=v)break}n=[n],g.Ja=[g.Ja],g.xa=[g.xa];e:if(A=e,v=a,b=n,N=g.gb[0],j=g.Ja,S=g.xa,_=v[0],k=!r(A,_,"VP8 "),E=!r(A,_,"VP8L"),t(null!=A),t(null!=b),t(null!=j),t(null!=S),8>b[0])v=7;else{if(k||E){if(A=D(A,_+4),12<=N&&A>N-12){v=3;break e}if(f&&A>b[0]-8){v=7;break e}j[0]=A,v[0]+=8,b[0]-=8,S[0]=E}else S[0]=5<=b[0]&&47==A[_+0]&&!(A[_+4]>>5),j[0]=b[0];v=0}if(n=n[0],g.Ja=g.Ja[0],g.xa=g.xa[0],a=a[0],0!=v)break;if(4294967286<g.Ja)return 3;if(null==c||y||(c[0]=g.xa?2:1),l=[l],p=[p],g.xa){if(5>n){v=7;break}c=l,f=p,y=o,null==e||5>n?e=0:5<=n&&47==e[a+0]&&!(e[a+4]>>5)?(b=[0],A=[0],N=[0],x(j=new w,e,a,n),ge(j,b,A,N)?(null!=c&&(c[0]=b[0]),null!=f&&(f[0]=A[0]),null!=y&&(y[0]=N[0]),e=1):e=0):e=0}else{if(10>n){v=7;break}c=p,null==e||10>n||!Ye(e,a+3,n-3)?e=0:(f=e[a+0]|e[a+1]<<8|e[a+2]<<16,y=16383&(e[a+7]<<8|e[a+6]),e=16383&(e[a+9]<<8|e[a+8]),1&f||3<(f>>1&7)||!(f>>4&1)||f>>5>=g.Ja||!y||!e?e=0:(l&&(l[0]=y),c&&(c[0]=e),e=1))}if(!e)return 3;if(l=l[0],p=p[0],m&&(u[0]!=l||h[0]!=p))return 3;null!=d&&(d[0]=g,d.offset=a-d.w,t(4294967286>a-d.w),t(d.offset==d.ha-n));break}return 0==v||7==v&&m&&null==d?(null!=o&&(o[0]|=null!=g.na&&0<g.na.length),null!=s&&(s[0]=l),null!=i&&(i[0]=p),0):v}function Fr(e,t,r){var a=t.width,n=t.height,s=0,i=0,o=a,l=n;if(t.Da=null!=e&&0<e.Da,t.Da&&(o=e.cd,l=e.bd,s=e.v,i=e.j,11>r||(s&=-2,i&=-2),0>s||0>i||0>=o||0>=l||s+o>a||i+l>n))return 0;if(t.v=s,t.j=i,t.va=s+o,t.o=i+l,t.U=o,t.T=l,t.da=null!=e&&0<e.da,t.da){if(!M(o,l,r=[e.ib],s=[e.hb]))return 0;t.ib=r[0],t.hb=s[0]}return t.ob=null!=e&&e.ob,t.Kb=null==e||!e.Sd,t.da&&(t.ob=t.ib<3*a/4&&t.hb<3*n/4,t.Kb=0),1}function Lr(e){if(null==e)return 2;if(11>e.S){var t=e.f.RGBA;t.fb+=(e.height-1)*t.A,t.A=-t.A}else t=e.f.kb,e=e.height,t.O+=(e-1)*t.fa,t.fa=-t.fa,t.N+=(e-1>>1)*t.Ab,t.Ab=-t.Ab,t.W+=(e-1>>1)*t.Db,t.Db=-t.Db,null!=t.F&&(t.J+=(e-1)*t.lb,t.lb=-t.lb);return 0}function Mr(e,t,r,a){if(null==a||0>=e||0>=t)return 2;if(null!=r){if(r.Da){var n=r.cd,i=r.bd,o=-2&r.v,l=-2&r.j;if(0>o||0>l||0>=n||0>=i||o+n>e||l+i>t)return 2;e=n,t=i}if(r.da){if(!M(e,t,n=[r.ib],i=[r.hb]))return 2;e=n[0],t=i[0]}}a.width=e,a.height=t;e:{var c=a.width,d=a.height;if(e=a.S,0>=c||0>=d||!(e>=Fa&&13>e))e=2;else{if(0>=a.Rd&&null==a.sd){o=i=n=t=0;var u=(l=c*zn[e])*d;if(11>e||(i=(d+1)/2*(t=(c+1)/2),12==e&&(o=(n=c)*d)),null==(d=s(u+2*i+o))){e=1;break e}a.sd=d,11>e?((c=a.f.RGBA).eb=d,c.fb=0,c.A=l,c.size=u):((c=a.f.kb).y=d,c.O=0,c.fa=l,c.Fd=u,c.f=d,c.N=0+u,c.Ab=t,c.Cd=i,c.ea=d,c.W=0+u+i,c.Db=t,c.Ed=i,12==e&&(c.F=d,c.J=0+u+2*i),c.Tc=o,c.lb=n)}if(t=1,n=a.S,i=a.width,o=a.height,n>=Fa&&13>n)if(11>n)e=a.f.RGBA,t&=(l=Math.abs(e.A))*(o-1)+i<=e.size,t&=l>=i*zn[n],t&=null!=e.eb;else{e=a.f.kb,l=(i+1)/2,u=(o+1)/2,c=Math.abs(e.fa),d=Math.abs(e.Ab);var h=Math.abs(e.Db),m=Math.abs(e.lb),f=m*(o-1)+i;t&=c*(o-1)+i<=e.Fd,t&=d*(u-1)+l<=e.Cd,t=(t&=h*(u-1)+l<=e.Ed)&c>=i&d>=l&h>=l,t&=null!=e.y,t&=null!=e.f,t&=null!=e.ea,12==n&&(t&=m>=i,t&=f<=e.Tc,t&=null!=e.F)}else t=0;e=t?0:2}}return 0!=e||null!=r&&r.fd&&(e=Lr(a)),e}var Rr=64,Or=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],Br=24,zr=32,Ur=8,Vr=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];B("Predictor0","PredictorAdd0"),e.Predictor0=function(){return 4278190080},e.Predictor1=function(e){return e},e.Predictor2=function(e,t,r){return t[r+0]},e.Predictor3=function(e,t,r){return t[r+1]},e.Predictor4=function(e,t,r){return t[r-1]},e.Predictor5=function(e,t,r){return U(U(e,t[r+1]),t[r+0])},e.Predictor6=function(e,t,r){return U(e,t[r-1])},e.Predictor7=function(e,t,r){return U(e,t[r+0])},e.Predictor8=function(e,t,r){return U(t[r-1],t[r+0])},e.Predictor9=function(e,t,r){return U(t[r+0],t[r+1])},e.Predictor10=function(e,t,r){return U(U(e,t[r-1]),U(t[r+0],t[r+1]))},e.Predictor11=function(e,t,r){var a=t[r+0];return 0>=H(a>>24&255,e>>24&255,(t=t[r-1])>>24&255)+H(a>>16&255,e>>16&255,t>>16&255)+H(a>>8&255,e>>8&255,t>>8&255)+H(255&a,255&e,255&t)?a:e},e.Predictor12=function(e,t,r){var a=t[r+0];return(V((e>>24&255)+(a>>24&255)-((t=t[r-1])>>24&255))<<24|V((e>>16&255)+(a>>16&255)-(t>>16&255))<<16|V((e>>8&255)+(a>>8&255)-(t>>8&255))<<8|V((255&e)+(255&a)-(255&t)))>>>0},e.Predictor13=function(e,t,r){var a=t[r-1];return(q((e=U(e,t[r+0]))>>24&255,a>>24&255)<<24|q(e>>16&255,a>>16&255)<<16|q(e>>8&255,a>>8&255)<<8|q(255&e,255&a))>>>0};var qr=e.PredictorAdd0;e.PredictorAdd1=G,B("Predictor2","PredictorAdd2"),B("Predictor3","PredictorAdd3"),B("Predictor4","PredictorAdd4"),B("Predictor5","PredictorAdd5"),B("Predictor6","PredictorAdd6"),B("Predictor7","PredictorAdd7"),B("Predictor8","PredictorAdd8"),B("Predictor9","PredictorAdd9"),B("Predictor10","PredictorAdd10"),B("Predictor11","PredictorAdd11"),B("Predictor12","PredictorAdd12"),B("Predictor13","PredictorAdd13");var Hr=e.PredictorAdd2;Y("ColorIndexInverseTransform","MapARGB","32b",function(e){return e>>8&255},function(e){return e}),Y("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(e){return e},function(e){return e>>8&255});var Gr,Wr=e.ColorIndexInverseTransform,Kr=e.MapARGB,Qr=e.VP8LColorIndexInverseTransformAlpha,Yr=e.MapAlpha,Xr=e.VP8LPredictorsAdd=[];Xr.length=16,(e.VP8LPredictors=[]).length=16,(e.VP8LPredictorsAdd_C=[]).length=16,(e.VP8LPredictors_C=[]).length=16;var Jr,Zr,$r,ea,ta,ra,aa,na,sa,ia,oa,la,ca,da,ua,ha,ma,fa,ga,pa,xa,ya,va,ba,wa,ka,Na,ja,Sa=s(511),_a=s(2041),Ea=s(225),Aa=s(767),Ca=0,Ia=_a,Ta=Ea,Da=Aa,Pa=Sa,Fa=0,La=1,Ma=2,Ra=3,Oa=4,Ba=5,za=6,Ua=7,Va=8,qa=9,Ha=10,Ga=[2,3,7],Wa=[3,3,11],Ka=[280,256,256,256,40],Qa=[0,1,1,1,0],Ya=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],Xa=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],Ja=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],Za=8,$a=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],en=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],tn=null,rn=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],an=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],nn=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],sn=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],on=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],ln=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],cn=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],dn=[],un=[],hn=[],mn=1,fn=2,gn=[],pn=[];pr("UpsampleRgbLinePair",kr,3),pr("UpsampleBgrLinePair",Nr,3),pr("UpsampleRgbaLinePair",Ar,4),pr("UpsampleBgraLinePair",Er,4),pr("UpsampleArgbLinePair",_r,4),pr("UpsampleRgba4444LinePair",Sr,2),pr("UpsampleRgb565LinePair",jr,2);var xn=e.UpsampleRgbLinePair,yn=e.UpsampleBgrLinePair,vn=e.UpsampleRgbaLinePair,bn=e.UpsampleBgraLinePair,wn=e.UpsampleArgbLinePair,kn=e.UpsampleRgba4444LinePair,Nn=e.UpsampleRgb565LinePair,jn=16,Sn=1<<jn-1,_n=-227,En=482,An=6,Cn=(256<<An)-1,In=0,Tn=s(256),Dn=s(256),Pn=s(256),Fn=s(256),Ln=s(En-_n),Mn=s(En-_n);Cr("YuvToRgbRow",kr,3),Cr("YuvToBgrRow",Nr,3),Cr("YuvToRgbaRow",Ar,4),Cr("YuvToBgraRow",Er,4),Cr("YuvToArgbRow",_r,4),Cr("YuvToRgba4444Row",Sr,2),Cr("YuvToRgb565Row",jr,2);var Rn=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],On=[0,2,8],Bn=[8,7,6,4,4,2,2,2,1,1,1,1];this.WebPDecodeRGBA=function(e,r,o,l,c){var d=La,u=new tr,h=new ie;u.ba=h,h.S=d,h.width=[h.width],h.height=[h.height];var m=h.width,f=h.height,g=new oe;if(null==g||null==e)var p=2;else t(null!=g),p=Pr(e,r,o,g.width,g.height,g.Pd,g.Qd,g.format,null);if(0!=p?m=0:(null!=m&&(m[0]=g.width[0]),null!=f&&(f[0]=g.height[0]),m=1),m){h.width=h.width[0],h.height=h.height[0],null!=l&&(l[0]=h.width),null!=c&&(c[0]=h.height);e:{if(l=new We,(c=new rr).data=e,c.w=r,c.ha=o,c.kd=1,r=[0],t(null!=c),(0==(e=Pr(c.data,c.w,c.ha,null,null,null,r,null,c))||7==e)&&r[0]&&(e=4),0==(r=e)){if(t(null!=u),l.data=c.data,l.w=c.w+c.offset,l.ha=c.ha-c.offset,l.put=me,l.ac=he,l.bc=fe,l.ma=u,c.xa){if(null==(e=Ae())){u=1;break e}if(function(e,r){var a=[0],n=[0],s=[0];t:for(;;){if(null==e)return 0;if(null==r)return e.a=2,0;if(e.l=r,e.a=0,x(e.m,r.data,r.w,r.ha),!ge(e.m,a,n,s)){e.a=3;break t}if(e.xb=fn,r.width=a[0],r.height=n[0],!Ce(a[0],n[0],1,e,null))break t;return 1}return t(0!=e.a),0}(e,l)){if(l=0==(r=Mr(l.width,l.height,u.Oa,u.ba))){t:{l=e;r:for(;;){if(null==l){l=0;break t}if(t(null!=l.s.yc),t(null!=l.s.Ya),t(0<l.s.Wb),t(null!=(o=l.l)),t(null!=(c=o.ma)),0!=l.xb){if(l.ca=c.ba,l.tb=c.tb,t(null!=l.ca),!Fr(c.Oa,o,Ra)){l.a=2;break r}if(!Ie(l,o.width))break r;if(o.da)break r;if((o.da||ae(l.ca.S))&&gr(),11>l.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),null!=l.ca.f.kb.F&&gr()),l.Pb&&0<l.s.ua&&null==l.s.vb.X&&!P(l.s.vb,l.s.Wa.Xa)){l.a=1;break r}l.xb=0}if(!_e(l,l.V,l.Ba,l.c,l.i,o.o,ke))break r;c.Dc=l.Ma,l=1;break t}t(0!=l.a),l=0}l=!l}l&&(r=e.a)}else r=e.a}else{if(null==(e=new Ke)){u=1;break e}if(e.Fa=c.na,e.P=c.P,e.qc=c.Sa,Xe(e,l)){if(0==(r=Mr(l.width,l.height,u.Oa,u.ba))){if(e.Aa=0,o=u.Oa,t(null!=(c=e)),null!=o){if(0<(m=0>(m=o.Md)?0:100<m?255:255*m/100)){for(f=g=0;4>f;++f)12>(p=c.pb[f]).lc&&(p.ia=m*Bn[0>p.lc?0:p.lc]>>3),g|=p.ia;g&&(alert("todo:VP8InitRandom"),c.ia=1)}c.Ga=o.Id,100<c.Ga?c.Ga=100:0>c.Ga&&(c.Ga=0)}(function(e,r){if(null==e)return 0;if(null==r)return Qe(e,2,"NULL VP8Io parameter in VP8Decode().");if(!e.cb&&!Xe(e,r))return 0;if(t(e.cb),null==r.ac||r.ac(r)){r.ob&&(e.L=0);var o=On[e.L];if(2==e.L?(e.yb=0,e.zb=0):(e.yb=r.v-o>>4,e.zb=r.j-o>>4,0>e.yb&&(e.yb=0),0>e.zb&&(e.zb=0)),e.Va=r.o+15+o>>4,e.Hb=r.va+15+o>>4,e.Hb>e.za&&(e.Hb=e.za),e.Va>e.Ub&&(e.Va=e.Ub),0<e.L){var l=e.ed;for(o=0;4>o;++o){var c;if(e.Qa.Cb){var d=e.Qa.Lb[o];e.Qa.Fb||(d+=l.Tb)}else d=l.Tb;for(c=0;1>=c;++c){var u=e.gd[o][c],h=d;if(l.Pc&&(h+=l.vd[0],c&&(h+=l.od[0])),0<(h=0>h?0:63<h?63:h)){var m=h;0<l.wb&&(m=4<l.wb?m>>2:m>>1)>9-l.wb&&(m=9-l.wb),1>m&&(m=1),u.dd=m,u.tc=2*h+m,u.ld=40<=h?2:15<=h?1:0}else u.tc=0;u.La=c}}}o=0}else Qe(e,6,"Frame setup failed"),o=e.a;if(o=0==o){if(o){e.$c=0,0<e.Aa||(e.Ic=1);t:{o=e.Ic,l=4*(m=e.za);var f=32*m,g=m+1,p=0<e.L?m*(0<e.Aa?2:1):0,x=(2==e.Aa?2:1)*m;if((u=l+832+(c=3*(16*o+On[e.L])/2*f)+(d=null!=e.Fa&&0<e.Fa.length?e.Kc.c*e.Kc.i:0))!=u)o=0;else{if(u>e.Vb){if(e.Vb=0,e.Ec=s(u),e.Fc=0,null==e.Ec){o=Qe(e,1,"no memory during frame initialization.");break t}e.Vb=u}u=e.Ec,h=e.Fc,e.Ac=u,e.Bc=h,h+=l,e.Gd=i(f,qe),e.Hd=0,e.rb=i(g+1,Be),e.sb=1,e.wa=p?i(p,Oe):null,e.Y=0,e.D.Nb=0,e.D.wa=e.wa,e.D.Y=e.Y,0<e.Aa&&(e.D.Y+=m),t(!0),e.oc=u,e.pc=h,h+=832,e.ya=i(x,Ue),e.aa=0,e.D.ya=e.ya,e.D.aa=e.aa,2==e.Aa&&(e.D.aa+=m),e.R=16*m,e.B=8*m,m=(f=On[e.L])*e.R,f=f/2*e.B,e.sa=u,e.ta=h+m,e.qa=e.sa,e.ra=e.ta+16*o*e.R+f,e.Ha=e.qa,e.Ia=e.ra+8*o*e.B+f,e.$c=0,h+=c,e.mb=d?u:null,e.nb=d?h:null,t(h+d<=e.Fc+e.Vb),Ze(e),n(e.Ac,e.Bc,0,l),o=1}}if(o){if(r.ka=0,r.y=e.sa,r.O=e.ta,r.f=e.qa,r.N=e.ra,r.ea=e.Ha,r.Vd=e.Ia,r.fa=e.R,r.Rc=e.B,r.F=null,r.J=0,!Ca){for(o=-255;255>=o;++o)Sa[255+o]=0>o?-o:o;for(o=-1020;1020>=o;++o)_a[1020+o]=-128>o?-128:127<o?127:o;for(o=-112;112>=o;++o)Ea[112+o]=-16>o?-16:15<o?15:o;for(o=-255;510>=o;++o)Aa[255+o]=0>o?0:255<o?255:o;Ca=1}aa=lt,na=nt,ia=st,oa=it,la=ot,sa=at,ca=Kt,da=Qt,ua=Jt,ha=Zt,ma=Yt,fa=Xt,ga=$t,pa=er,xa=Ut,ya=Vt,va=qt,ba=Ht,un[0]=Nt,un[1]=dt,un[2]=wt,un[3]=kt,un[4]=jt,un[5]=_t,un[6]=St,un[7]=Et,un[8]=Ct,un[9]=At,dn[0]=pt,dn[1]=ht,dn[2]=mt,dn[3]=ft,dn[4]=xt,dn[5]=yt,dn[6]=vt,hn[0]=Pt,hn[1]=ut,hn[2]=It,hn[3]=Tt,hn[4]=Lt,hn[5]=Ft,hn[6]=Mt,o=1}else o=0}o&&(o=function(e,r){for(e.M=0;e.M<e.Va;++e.M){var i,o=e.Jc[e.M&e.Xb],l=e.m,c=e;for(i=0;i<c.za;++i){var d=l,u=c,h=u.Ac,m=u.Bc+4*i,f=u.zc,g=u.ya[u.aa+i];if(u.Qa.Bb?g.$b=A(d,u.Pa.jb[0])?2+A(d,u.Pa.jb[2]):A(d,u.Pa.jb[1]):g.$b=0,u.kc&&(g.Ad=A(d,u.Bd)),g.Za=!A(d,145)+0,g.Za){var p=g.Ob,x=0;for(u=0;4>u;++u){var y,v=f[0+u];for(y=0;4>y;++y){v=on[h[m+y]][v];for(var b=nn[A(d,v[0])];0<b;)b=nn[2*b+A(d,v[b])];v=-b,h[m+y]=v}a(p,x,h,m,4),x+=4,f[0+u]=v}}else v=A(d,156)?A(d,128)?1:3:A(d,163)?2:0,g.Ob[0]=v,n(h,m,v,4),n(f,0,v,4);g.Dd=A(d,142)?A(d,114)?A(d,183)?1:3:2:0}if(c.m.Ka)return Qe(e,7,"Premature end-of-partition0 encountered.");for(;e.ja<e.za;++e.ja){if(c=o,d=(l=e).rb[l.sb-1],h=l.rb[l.sb+l.ja],i=l.ya[l.aa+l.ja],m=l.kc?i.Ad:0)d.la=h.la=0,i.Za||(d.Na=h.Na=0),i.Hc=0,i.Gc=0,i.ia=0;else{var w,k;if(d=h,h=c,m=l.Pa.Xc,f=l.ya[l.aa+l.ja],g=l.pb[f.$b],u=f.ad,p=0,x=l.rb[l.sb-1],v=y=0,n(u,p,0,384),f.Za)var N=0,j=m[3];else{b=s(16);var S=d.Na+x.Na;if(S=tn(h,m[1],S,g.Eb,0,b,0),d.Na=x.Na=(0<S)+0,1<S)aa(b,0,u,p);else{var _=b[0]+3>>3;for(b=0;256>b;b+=16)u[p+b]=_}N=1,j=m[0]}var E=15&d.la,C=15&x.la;for(b=0;4>b;++b){var I=1&C;for(_=k=0;4>_;++_)E=E>>1|(I=(S=tn(h,j,S=I+(1&E),g.Sc,N,u,p))>N)<<7,k=k<<2|(3<S?3:1<S?2:0!=u[p+0]),p+=16;E>>=4,C=C>>1|I<<7,y=(y<<8|k)>>>0}for(j=E,N=C>>4,w=0;4>w;w+=2){for(k=0,E=d.la>>4+w,C=x.la>>4+w,b=0;2>b;++b){for(I=1&C,_=0;2>_;++_)S=I+(1&E),E=E>>1|(I=0<(S=tn(h,m[2],S,g.Qc,0,u,p)))<<3,k=k<<2|(3<S?3:1<S?2:0!=u[p+0]),p+=16;E>>=2,C=C>>1|I<<5}v|=k<<4*w,j|=E<<4<<w,N|=(240&C)<<w}d.la=j,x.la=N,f.Hc=y,f.Gc=v,f.ia=43690&v?0:g.ia,m=!(y|v)}if(0<l.L&&(l.wa[l.Y+l.ja]=l.gd[i.$b][i.Za],l.wa[l.Y+l.ja].La|=!m),c.Ka)return Qe(e,7,"Premature end-of-file encountered.")}if(Ze(e),l=r,c=1,i=(o=e).D,d=0<o.L&&o.M>=o.zb&&o.M<=o.Va,0==o.Aa)t:{if(i.M=o.M,i.uc=d,Dr(o,i),c=1,i=(k=o.D).Nb,d=(v=On[o.L])*o.R,h=v/2*o.B,b=16*i*o.R,_=8*i*o.B,m=o.sa,f=o.ta-d+b,g=o.qa,u=o.ra-h+_,p=o.Ha,x=o.Ia-h+_,C=0==(E=k.M),y=E>=o.Va-1,2==o.Aa&&Dr(o,k),k.uc)for(I=(S=o).D.M,t(S.D.uc),k=S.yb;k<S.Hb;++k){N=k,j=I;var T=(D=(U=S).D).Nb;w=U.R;var D=D.wa[D.Y+N],P=U.sa,F=U.ta+16*T*w+16*N,L=D.dd,M=D.tc;if(0!=M)if(t(3<=M),1==U.L)0<N&&ya(P,F,w,M+4),D.La&&ba(P,F,w,M),0<j&&xa(P,F,w,M+4),D.La&&va(P,F,w,M);else{var R=U.B,O=U.qa,B=U.ra+8*T*R+8*N,z=U.Ha,U=U.Ia+8*T*R+8*N;T=D.ld,0<N&&(da(P,F,w,M+4,L,T),ha(O,B,z,U,R,M+4,L,T)),D.La&&(fa(P,F,w,M,L,T),pa(O,B,z,U,R,M,L,T)),0<j&&(ca(P,F,w,M+4,L,T),ua(O,B,z,U,R,M+4,L,T)),D.La&&(ma(P,F,w,M,L,T),ga(O,B,z,U,R,M,L,T))}}if(o.ia&&alert("todo:DitherRow"),null!=l.put){if(k=16*E,E=16*(E+1),C?(l.y=o.sa,l.O=o.ta+b,l.f=o.qa,l.N=o.ra+_,l.ea=o.Ha,l.W=o.Ia+_):(k-=v,l.y=m,l.O=f,l.f=g,l.N=u,l.ea=p,l.W=x),y||(E-=v),E>l.o&&(E=l.o),l.F=null,l.J=null,null!=o.Fa&&0<o.Fa.length&&k<E&&(l.J=dr(o,l,k,E-k),l.F=o.mb,null==l.F&&0==l.F.length)){c=Qe(o,3,"Could not decode alpha data.");break t}k<l.j&&(v=l.j-k,k=l.j,t(!(1&v)),l.O+=o.R*v,l.N+=o.B*(v>>1),l.W+=o.B*(v>>1),null!=l.F&&(l.J+=l.width*v)),k<E&&(l.O+=l.v,l.N+=l.v>>1,l.W+=l.v>>1,null!=l.F&&(l.J+=l.v),l.ka=k-l.j,l.U=l.va-l.v,l.T=E-k,c=l.put(l))}i+1!=o.Ic||y||(a(o.sa,o.ta-d,m,f+16*o.R,d),a(o.qa,o.ra-h,g,u+8*o.B,h),a(o.Ha,o.Ia-h,p,x+8*o.B,h))}if(!c)return Qe(e,6,"Output aborted.")}return 1}(e,r)),null!=r.bc&&r.bc(r),o&=1}return o?(e.cb=0,o):0})(e,l)||(r=e.a)}}else r=e.a}0==r&&null!=u.Oa&&u.Oa.fd&&(r=Lr(u.ba))}u=r}d=0!=u?null:11>d?h.f.RGBA.eb:h.f.kb.y}else d=null;return d};var zn=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function c(e,t){for(var r="",a=0;a<4;a++)r+=String.fromCharCode(e[t++]);return r}function d(e,t){return e[t+0]|e[t+1]<<8}function u(e,t){return(e[t+0]|e[t+1]<<8|e[t+2]<<16)>>>0}function h(e,t){return(e[t+0]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}new l;var m=[0],f=[0],g=[],p=new l,x=e,y=function(e,t){var r={},a=0,n=!1,s=0,i=0;if(r.frames=[],!function(e,t){for(var r=0;r<4;r++)if(e[t+r]!="RIFF".charCodeAt(r))return!0;return!1}(e,t)){for(h(e,t+=4),t+=8;t<e.length;){var o=c(e,t),l=h(e,t+=4);t+=4;var m=l+(1&l);switch(o){case"VP8 ":case"VP8L":void 0===r.frames[a]&&(r.frames[a]={}),(p=r.frames[a]).src_off=n?i:t-8,p.src_size=s+l+8,a++,n&&(n=!1,s=0,i=0);break;case"VP8X":(p=r.header={}).feature_flags=e[t];var f=t+4;p.canvas_width=1+u(e,f),f+=3,p.canvas_height=1+u(e,f),f+=3;break;case"ALPH":n=!0,s=m+8,i=t-8;break;case"ANIM":(p=r.header).bgcolor=h(e,t),f=t+4,p.loop_count=d(e,f),f+=2;break;case"ANMF":var g,p;(p=r.frames[a]={}).offset_x=2*u(e,t),t+=3,p.offset_y=2*u(e,t),t+=3,p.width=1+u(e,t),t+=3,p.height=1+u(e,t),t+=3,p.duration=u(e,t),t+=3,g=e[t++],p.dispose=1&g,p.blend=g>>1&1}"ANMF"!=o&&(t+=m)}return r}}(x,0);y.response=x,y.rgbaoutput=!0,y.dataurl=!1;var v=y.header?y.header:null,b=y.frames?y.frames:null;if(v){v.loop_counter=v.loop_count,m=[v.canvas_height],f=[v.canvas_width];for(var w=0;w<b.length&&0!=b[w].blend;w++);}var k=b[0],N=p.WebPDecodeRGBA(x,k.src_off,k.src_size,f,m);k.rgba=N,k.imgwidth=f[0],k.imgheight=m[0];for(var j=0;j<f[0]*m[0]*4;j++)g[j]=N[j];return this.width=f,this.height=m,this.data=g,this}!function(e){var t,r,a,n,s,i,o,l,c,d=function(e){return e=e||{},this.isStrokeTransparent=e.isStrokeTransparent||!1,this.strokeOpacity=e.strokeOpacity||1,this.strokeStyle=e.strokeStyle||"#000000",this.fillStyle=e.fillStyle||"#000000",this.isFillTransparent=e.isFillTransparent||!1,this.fillOpacity=e.fillOpacity||1,this.font=e.font||"10px sans-serif",this.textBaseline=e.textBaseline||"alphabetic",this.textAlign=e.textAlign||"left",this.lineWidth=e.lineWidth||1,this.lineJoin=e.lineJoin||"miter",this.lineCap=e.lineCap||"butt",this.path=e.path||[],this.transform=void 0!==e.transform?e.transform.clone():new l,this.globalCompositeOperation=e.globalCompositeOperation||"normal",this.globalAlpha=e.globalAlpha||1,this.clip_path=e.clip_path||[],this.currentPoint=e.currentPoint||new i,this.miterLimit=e.miterLimit||10,this.lastPoint=e.lastPoint||new i,this.lineDashOffset=e.lineDashOffset||0,this.lineDash=e.lineDash||[],this.margin=e.margin||[0,0,0,0],this.prevPageLastElemOffset=e.prevPageLastElemOffset||0,this.ignoreClearRect="boolean"!=typeof e.ignoreClearRect||e.ignoreClearRect,this};e.events.push(["initialized",function(){this.context2d=new u(this),t=this.internal.f2,r=this.internal.getCoordinateString,a=this.internal.getVerticalCoordinateString,n=this.internal.getHorizontalCoordinate,s=this.internal.getVerticalCoordinate,i=this.internal.Point,o=this.internal.Rectangle,l=this.internal.Matrix,c=new d}]);var u=function(e){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var t=e;Object.defineProperty(this,"pdf",{get:function(){return t}});var r=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return r},set:function(e){r=Boolean(e)}});var a=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return a},set:function(e){a=Boolean(e)}});var n=0;Object.defineProperty(this,"posX",{get:function(){return n},set:function(e){isNaN(e)||(n=e)}});var s=0;Object.defineProperty(this,"posY",{get:function(){return s},set:function(e){isNaN(e)||(s=e)}}),Object.defineProperty(this,"margin",{get:function(){return c.margin},set:function(e){var t;"number"==typeof e?t=[e,e,e,e]:((t=new Array(4))[0]=e[0],t[1]=e.length>=2?e[1]:t[0],t[2]=e.length>=3?e[2]:t[0],t[3]=e.length>=4?e[3]:t[1]),c.margin=t}});var i=!1;Object.defineProperty(this,"autoPaging",{get:function(){return i},set:function(e){i=e}});var o=0;Object.defineProperty(this,"lastBreak",{get:function(){return o},set:function(e){o=e}});var l=[];Object.defineProperty(this,"pageBreaks",{get:function(){return l},set:function(e){l=e}}),Object.defineProperty(this,"ctx",{get:function(){return c},set:function(e){e instanceof d&&(c=e)}}),Object.defineProperty(this,"path",{get:function(){return c.path},set:function(e){c.path=e}});var u=[];Object.defineProperty(this,"ctxStack",{get:function(){return u},set:function(e){u=e}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(e){var t;t=h(e),this.ctx.fillStyle=t.style,this.ctx.isFillTransparent=0===t.a,this.ctx.fillOpacity=t.a,this.pdf.setFillColor(t.r,t.g,t.b,{a:t.a}),this.pdf.setTextColor(t.r,t.g,t.b,{a:t.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(e){var t=h(e);this.ctx.strokeStyle=t.style,this.ctx.isStrokeTransparent=0===t.a,this.ctx.strokeOpacity=t.a,0===t.a?this.pdf.setDrawColor(255,255,255):(t.a,this.pdf.setDrawColor(t.r,t.g,t.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(e){-1!==["butt","round","square"].indexOf(e)&&(this.ctx.lineCap=e,this.pdf.setLineCap(e))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(e){isNaN(e)||(this.ctx.lineWidth=e,this.pdf.setLineWidth(e))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(e){-1!==["bevel","round","miter"].indexOf(e)&&(this.ctx.lineJoin=e,this.pdf.setLineJoin(e))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(e){isNaN(e)||(this.ctx.miterLimit=e,this.pdf.setMiterLimit(e))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(e){this.ctx.textBaseline=e}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(e){-1!==["right","end","center","left","start"].indexOf(e)&&(this.ctx.textAlign=e)}});var m=null,f=null;Object.defineProperty(this,"fontFaces",{get:function(){return f},set:function(e){m=null,f=e}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(e){var t;if(this.ctx.font=e,null!==(t=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(e))){var r=t[1];t[2];var a=t[3],n=t[4];t[5];var s=t[6],i=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(n)[2];n="px"===i?Math.floor(parseFloat(n)*this.pdf.internal.scaleFactor):"em"===i?Math.floor(parseFloat(n)*this.pdf.getFontSize()):Math.floor(parseFloat(n)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(n);var o=function(e){var t,r,a=[],n=e.trim();if(""===n)return _y;if(n in hy)return[hy[n]];for(;""!==n;){switch(r=null,t=(n=fy(n)).charAt(0)){case'"':case"'":r=gy(n.substring(1),t);break;default:r=py(n)}if(null===r)return _y;if(a.push(r[0]),""!==(n=fy(r[1]))&&","!==n.charAt(0))return _y;n=n.replace(/^,/,"")}return a}(s);if(this.fontFaces){var l=function(e,t){if(null===m){var r=function(e){var t=[];return Object.keys(e).forEach(function(r){e[r].forEach(function(e){var a=null;switch(e){case"bold":a={family:r,weight:"bold"};break;case"italic":a={family:r,style:"italic"};break;case"bolditalic":a={family:r,weight:"bold",style:"italic"};break;case"":case"normal":a={family:r}}null!==a&&(a.ref={name:r,style:e},t.push(a))})}),t}(e.getFontList());m=function(e){for(var t={},r=0;r<e.length;++r){var a=cy(e[r]),n=a.family,s=a.stretch,i=a.style,o=a.weight;t[n]=t[n]||{},t[n][s]=t[n][s]||{},t[n][s][i]=t[n][s][i]||{},t[n][s][i][o]=a}return t}(r.concat(t))}return m}(this.pdf,this.fontFaces),c=o.map(function(e){return{family:e,stretch:"normal",weight:a,style:r}}),d=function(e,t,r){for(var a=(r=r||{}).defaultFontFamily||"times",n=Object.assign({},uy,r.genericFontFamilies||{}),s=null,i=null,o=0;o<t.length;++o)if(n[(s=cy(t[o])).family]&&(s.family=n[s.family]),e.hasOwnProperty(s.family)){i=e[s.family];break}if(!(i=i||e[a]))throw new Error("Could not find a font-family for the rule '"+my(s)+"' and default family '"+a+"'.");if(i=function(e,t){if(t[e])return t[e];var r=iy[e],a=r<=iy.normal?-1:1,n=dy(t,sy,r,a);if(!n)throw new Error("Could not find a matching font-stretch value for "+e);return n}(s.stretch,i),i=function(e,t){if(t[e])return t[e];for(var r=ny[e],a=0;a<r.length;++a)if(t[r[a]])return t[r[a]];throw new Error("Could not find a matching font-style for "+e)}(s.style,i),!(i=function(e,t){if(t[e])return t[e];if(400===e&&t[500])return t[500];if(500===e&&t[400])return t[400];var r=ly[e],a=dy(t,oy,r,e<400?-1:1);if(!a)throw new Error("Could not find a matching font-weight for value "+e);return a}(s.weight,i)))throw new Error("Failed to resolve a font for the rule '"+my(s)+"'.");return i}(l,c);this.pdf.setFont(d.ref.name,d.ref.style)}else{var u="";("bold"===a||parseInt(a,10)>=700||"bold"===r)&&(u="bold"),"italic"===r&&(u+="italic"),0===u.length&&(u="normal");for(var h="",f={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},g=0;g<o.length;g++){if(void 0!==this.pdf.internal.getFont(o[g],u,{noFallback:!0,disableWarning:!0})){h=o[g];break}if("bolditalic"===u&&void 0!==this.pdf.internal.getFont(o[g],"bold",{noFallback:!0,disableWarning:!0}))h=o[g],u="bold";else if(void 0!==this.pdf.internal.getFont(o[g],"normal",{noFallback:!0,disableWarning:!0})){h=o[g],u="normal";break}}if(""===h)for(var p=0;p<o.length;p++)if(f[o[p]]){h=f[o[p]];break}h=""===h?"Times":h,this.pdf.setFont(h,u)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(e){this.ctx.globalCompositeOperation=e}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(e){this.ctx.globalAlpha=e}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(e){this.ctx.lineDashOffset=e,R.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(e){this.ctx.lineDash=e,R.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(e){this.ctx.ignoreClearRect=Boolean(e)}})};u.prototype.setLineDash=function(e){this.lineDash=e},u.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},u.prototype.fill=function(){b.call(this,"fill",!1)},u.prototype.stroke=function(){b.call(this,"stroke",!1)},u.prototype.beginPath=function(){this.path=[{type:"begin"}]},u.prototype.moveTo=function(e,t){if(isNaN(e)||isNaN(t))throw Bp.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var r=this.ctx.transform.applyToPoint(new i(e,t));this.path.push({type:"mt",x:r.x,y:r.y}),this.ctx.lastPoint=new i(e,t)},u.prototype.closePath=function(){var e=new i(0,0),t=0;for(t=this.path.length-1;-1!==t;t--)if("begin"===this.path[t].type&&"object"===(0,ju.A)(this.path[t+1])&&"number"==typeof this.path[t+1].x){e=new i(this.path[t+1].x,this.path[t+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new i(e.x,e.y)},u.prototype.lineTo=function(e,t){if(isNaN(e)||isNaN(t))throw Bp.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var r=this.ctx.transform.applyToPoint(new i(e,t));this.path.push({type:"lt",x:r.x,y:r.y}),this.ctx.lastPoint=new i(r.x,r.y)},u.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),b.call(this,null,!0)},u.prototype.quadraticCurveTo=function(e,t,r,a){if(isNaN(r)||isNaN(a)||isNaN(e)||isNaN(t))throw Bp.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var n=this.ctx.transform.applyToPoint(new i(r,a)),s=this.ctx.transform.applyToPoint(new i(e,t));this.path.push({type:"qct",x1:s.x,y1:s.y,x:n.x,y:n.y}),this.ctx.lastPoint=new i(n.x,n.y)},u.prototype.bezierCurveTo=function(e,t,r,a,n,s){if(isNaN(n)||isNaN(s)||isNaN(e)||isNaN(t)||isNaN(r)||isNaN(a))throw Bp.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var o=this.ctx.transform.applyToPoint(new i(n,s)),l=this.ctx.transform.applyToPoint(new i(e,t)),c=this.ctx.transform.applyToPoint(new i(r,a));this.path.push({type:"bct",x1:l.x,y1:l.y,x2:c.x,y2:c.y,x:o.x,y:o.y}),this.ctx.lastPoint=new i(o.x,o.y)},u.prototype.arc=function(e,t,r,a,n,s){if(isNaN(e)||isNaN(t)||isNaN(r)||isNaN(a)||isNaN(n))throw Bp.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(s=Boolean(s),!this.ctx.transform.isIdentity){var o=this.ctx.transform.applyToPoint(new i(e,t));e=o.x,t=o.y;var l=this.ctx.transform.applyToPoint(new i(0,r)),c=this.ctx.transform.applyToPoint(new i(0,0));r=Math.sqrt(Math.pow(l.x-c.x,2)+Math.pow(l.y-c.y,2))}Math.abs(n-a)>=2*Math.PI&&(a=0,n=2*Math.PI),this.path.push({type:"arc",x:e,y:t,radius:r,startAngle:a,endAngle:n,counterclockwise:s})},u.prototype.arcTo=function(e,t,r,a,n){throw new Error("arcTo not implemented.")},u.prototype.rect=function(e,t,r,a){if(isNaN(e)||isNaN(t)||isNaN(r)||isNaN(a))throw Bp.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(e,t),this.lineTo(e+r,t),this.lineTo(e+r,t+a),this.lineTo(e,t+a),this.lineTo(e,t),this.lineTo(e+r,t),this.lineTo(e,t)},u.prototype.fillRect=function(e,t,r,a){if(isNaN(e)||isNaN(t)||isNaN(r)||isNaN(a))throw Bp.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!m.call(this)){var n={};"butt"!==this.lineCap&&(n.lineCap=this.lineCap,this.lineCap="butt"),"miter"!==this.lineJoin&&(n.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(e,t,r,a),this.fill(),n.hasOwnProperty("lineCap")&&(this.lineCap=n.lineCap),n.hasOwnProperty("lineJoin")&&(this.lineJoin=n.lineJoin)}},u.prototype.strokeRect=function(e,t,r,a){if(isNaN(e)||isNaN(t)||isNaN(r)||isNaN(a))throw Bp.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");f.call(this)||(this.beginPath(),this.rect(e,t,r,a),this.stroke())},u.prototype.clearRect=function(e,t,r,a){if(isNaN(e)||isNaN(t)||isNaN(r)||isNaN(a))throw Bp.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(e,t,r,a))},u.prototype.save=function(e){e="boolean"!=typeof e||e;for(var t=this.pdf.internal.getCurrentPageInfo().pageNumber,r=0;r<this.pdf.internal.getNumberOfPages();r++)this.pdf.setPage(r+1),this.pdf.internal.out("q");if(this.pdf.setPage(t),e){this.ctx.fontSize=this.pdf.internal.getFontSize();var a=new d(this.ctx);this.ctxStack.push(this.ctx),this.ctx=a}},u.prototype.restore=function(e){e="boolean"!=typeof e||e;for(var t=this.pdf.internal.getCurrentPageInfo().pageNumber,r=0;r<this.pdf.internal.getNumberOfPages();r++)this.pdf.setPage(r+1),this.pdf.internal.out("Q");this.pdf.setPage(t),e&&0!==this.ctxStack.length&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},u.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var h=function(e){var t,r,a,n;if(!0===e.isCanvasGradient&&(e=e.getColor()),!e)return{r:0,g:0,b:0,a:0,style:e};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(e))t=0,r=0,a=0,n=0;else{var s=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(e);if(null!==s)t=parseInt(s[1]),r=parseInt(s[2]),a=parseInt(s[3]),n=1;else if(null!==(s=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(e)))t=parseInt(s[1]),r=parseInt(s[2]),a=parseInt(s[3]),n=parseFloat(s[4]);else{if(n=1,"string"==typeof e&&"#"!==e.charAt(0)){var i=new Hp(e);e=i.ok?i.toHex():"#000000"}4===e.length?(t=e.substring(1,2),t+=t,r=e.substring(2,3),r+=r,a=e.substring(3,4),a+=a):(t=e.substring(1,3),r=e.substring(3,5),a=e.substring(5,7)),t=parseInt(t,16),r=parseInt(r,16),a=parseInt(a,16)}}return{r:t,g:r,b:a,a:n,style:e}},m=function(){return this.ctx.isFillTransparent||0==this.globalAlpha},f=function(){return Boolean(this.ctx.isStrokeTransparent||0==this.globalAlpha)};u.prototype.fillText=function(e,t,r,a){if(isNaN(t)||isNaN(r)||"string"!=typeof e)throw Bp.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(a=isNaN(a)?void 0:a,!m.call(this)){var n=F(this.ctx.transform.rotation),s=this.ctx.transform.scaleX;A.call(this,{text:e,x:t,y:r,scale:s,angle:n,align:this.textAlign,maxWidth:a})}},u.prototype.strokeText=function(e,t,r,a){if(isNaN(t)||isNaN(r)||"string"!=typeof e)throw Bp.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!f.call(this)){a=isNaN(a)?void 0:a;var n=F(this.ctx.transform.rotation),s=this.ctx.transform.scaleX;A.call(this,{text:e,x:t,y:r,scale:s,renderingMode:"stroke",angle:n,align:this.textAlign,maxWidth:a})}},u.prototype.measureText=function(e){if("string"!=typeof e)throw Bp.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var t=this.pdf,r=this.pdf.internal.scaleFactor,a=t.internal.getFontSize(),n=t.getStringUnitWidth(e)*a/t.internal.scaleFactor;return new function(e){var t=(e=e||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return t}}),this}({width:n*=Math.round(96*r/72*1e4)/1e4})},u.prototype.scale=function(e,t){if(isNaN(e)||isNaN(t))throw Bp.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var r=new l(e,0,0,t,0,0);this.ctx.transform=this.ctx.transform.multiply(r)},u.prototype.rotate=function(e){if(isNaN(e))throw Bp.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var t=new l(Math.cos(e),Math.sin(e),-Math.sin(e),Math.cos(e),0,0);this.ctx.transform=this.ctx.transform.multiply(t)},u.prototype.translate=function(e,t){if(isNaN(e)||isNaN(t))throw Bp.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var r=new l(1,0,0,1,e,t);this.ctx.transform=this.ctx.transform.multiply(r)},u.prototype.transform=function(e,t,r,a,n,s){if(isNaN(e)||isNaN(t)||isNaN(r)||isNaN(a)||isNaN(n)||isNaN(s))throw Bp.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var i=new l(e,t,r,a,n,s);this.ctx.transform=this.ctx.transform.multiply(i)},u.prototype.setTransform=function(e,t,r,a,n,s){e=isNaN(e)?1:e,t=isNaN(t)?0:t,r=isNaN(r)?0:r,a=isNaN(a)?1:a,n=isNaN(n)?0:n,s=isNaN(s)?0:s,this.ctx.transform=new l(e,t,r,a,n,s)};var g=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};u.prototype.drawImage=function(e,t,r,a,n,s,i,c,d){var u=this.pdf.getImageProperties(e),h=1,m=1,f=1,x=1;void 0!==a&&void 0!==c&&(f=c/a,x=d/n,h=u.width/a*c/a,m=u.height/n*d/n),void 0===s&&(s=t,i=r,t=0,r=0),void 0!==a&&void 0===c&&(c=a,d=n),void 0===a&&void 0===c&&(c=u.width,d=u.height);for(var b,k=this.ctx.transform.decompose(),N=F(k.rotate.shx),j=new l,S=(j=(j=(j=j.multiply(k.translate)).multiply(k.skew)).multiply(k.scale)).applyToRectangle(new o(s-t*f,i-r*x,a*h,n*m)),_=p.call(this,S),E=[],A=0;A<_.length;A+=1)-1===E.indexOf(_[A])&&E.push(_[A]);if(v(E),this.autoPaging)for(var C=E[0],I=E[E.length-1],T=C;T<I+1;T++){this.pdf.setPage(T);var D=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],P=1===T?this.posY+this.margin[0]:this.margin[0],L=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],M=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],R=1===T?0:L+(T-2)*M;if(0!==this.ctx.clip_path.length){var O=this.path;b=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=y(b,this.posX+this.margin[3],-R+P+this.ctx.prevPageLastElemOffset),w.call(this,"fill",!0),this.path=O}var B=JSON.parse(JSON.stringify(S));B=y([B],this.posX+this.margin[3],-R+P+this.ctx.prevPageLastElemOffset)[0];var z=(T>C||T<I)&&g.call(this);z&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],D,M,null).clip().discardPath()),this.pdf.addImage(e,"JPEG",B.x,B.y,B.w,B.h,null,null,N),z&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(e,"JPEG",S.x,S.y,S.w,S.h,null,null,N)};var p=function(e,t,r){var a=[];t=t||this.pdf.internal.pageSize.width,r=r||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var n=this.posY+this.ctx.prevPageLastElemOffset;switch(e.type){default:case"mt":case"lt":a.push(Math.floor((e.y+n)/r)+1);break;case"arc":a.push(Math.floor((e.y+n-e.radius)/r)+1),a.push(Math.floor((e.y+n+e.radius)/r)+1);break;case"qct":var s=L(this.ctx.lastPoint.x,this.ctx.lastPoint.y,e.x1,e.y1,e.x,e.y);a.push(Math.floor((s.y+n)/r)+1),a.push(Math.floor((s.y+s.h+n)/r)+1);break;case"bct":var i=M(this.ctx.lastPoint.x,this.ctx.lastPoint.y,e.x1,e.y1,e.x2,e.y2,e.x,e.y);a.push(Math.floor((i.y+n)/r)+1),a.push(Math.floor((i.y+i.h+n)/r)+1);break;case"rect":a.push(Math.floor((e.y+n)/r)+1),a.push(Math.floor((e.y+e.h+n)/r)+1)}for(var o=0;o<a.length;o+=1)for(;this.pdf.internal.getNumberOfPages()<a[o];)x.call(this);return a},x=function(){var e=this.fillStyle,t=this.strokeStyle,r=this.font,a=this.lineCap,n=this.lineWidth,s=this.lineJoin;this.pdf.addPage(),this.fillStyle=e,this.strokeStyle=t,this.font=r,this.lineCap=a,this.lineWidth=n,this.lineJoin=s},y=function(e,t,r){for(var a=0;a<e.length;a++)switch(e[a].type){case"bct":e[a].x2+=t,e[a].y2+=r;case"qct":e[a].x1+=t,e[a].y1+=r;default:e[a].x+=t,e[a].y+=r}return e},v=function(e){return e.sort(function(e,t){return e-t})},b=function(e,t){for(var r,a,n=this.fillStyle,s=this.strokeStyle,i=this.lineCap,o=this.lineWidth,l=Math.abs(o*this.ctx.transform.scaleX),c=this.lineJoin,d=JSON.parse(JSON.stringify(this.path)),u=JSON.parse(JSON.stringify(this.path)),h=[],m=0;m<u.length;m++)if(void 0!==u[m].x)for(var f=p.call(this,u[m]),b=0;b<f.length;b+=1)-1===h.indexOf(f[b])&&h.push(f[b]);for(var k=0;k<h.length;k++)for(;this.pdf.internal.getNumberOfPages()<h[k];)x.call(this);if(v(h),this.autoPaging)for(var N=h[0],j=h[h.length-1],S=N;S<j+1;S++){this.pdf.setPage(S),this.fillStyle=n,this.strokeStyle=s,this.lineCap=i,this.lineWidth=l,this.lineJoin=c;var _=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],E=1===S?this.posY+this.margin[0]:this.margin[0],A=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],C=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],I=1===S?0:A+(S-2)*C;if(0!==this.ctx.clip_path.length){var T=this.path;r=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=y(r,this.posX+this.margin[3],-I+E+this.ctx.prevPageLastElemOffset),w.call(this,e,!0),this.path=T}if(a=JSON.parse(JSON.stringify(d)),this.path=y(a,this.posX+this.margin[3],-I+E+this.ctx.prevPageLastElemOffset),!1===t||0===S){var D=(S>N||S<j)&&g.call(this);D&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],_,C,null).clip().discardPath()),w.call(this,e,t),D&&this.pdf.restoreGraphicsState()}this.lineWidth=o}else this.lineWidth=l,w.call(this,e,t),this.lineWidth=o;this.path=d},w=function(e,t){if(("stroke"!==e||t||!f.call(this))&&("stroke"===e||t||!m.call(this))){for(var r,a,n=[],s=this.path,i=0;i<s.length;i++){var o=s[i];switch(o.type){case"begin":n.push({begin:!0});break;case"close":n.push({close:!0});break;case"mt":n.push({start:o,deltas:[],abs:[]});break;case"lt":var l=n.length;if(s[i-1]&&!isNaN(s[i-1].x)&&(r=[o.x-s[i-1].x,o.y-s[i-1].y],l>0))for(;l>=0;l--)if(!0!==n[l-1].close&&!0!==n[l-1].begin){n[l-1].deltas.push(r),n[l-1].abs.push(o);break}break;case"bct":r=[o.x1-s[i-1].x,o.y1-s[i-1].y,o.x2-s[i-1].x,o.y2-s[i-1].y,o.x-s[i-1].x,o.y-s[i-1].y],n[n.length-1].deltas.push(r);break;case"qct":var c=s[i-1].x+2/3*(o.x1-s[i-1].x),d=s[i-1].y+2/3*(o.y1-s[i-1].y),u=o.x+2/3*(o.x1-o.x),h=o.y+2/3*(o.y1-o.y),g=o.x,p=o.y;r=[c-s[i-1].x,d-s[i-1].y,u-s[i-1].x,h-s[i-1].y,g-s[i-1].x,p-s[i-1].y],n[n.length-1].deltas.push(r);break;case"arc":n.push({deltas:[],abs:[],arc:!0}),Array.isArray(n[n.length-1].abs)&&n[n.length-1].abs.push(o)}}a=t?null:"stroke"===e?"stroke":"fill";for(var x=!1,y=0;y<n.length;y++)if(n[y].arc)for(var v=n[y].abs,b=0;b<v.length;b++){var w=v[b];"arc"===w.type?j.call(this,w.x,w.y,w.radius,w.startAngle,w.endAngle,w.counterclockwise,void 0,t,!x):C.call(this,w.x,w.y),x=!0}else if(!0===n[y].close)this.pdf.internal.out("h"),x=!1;else if(!0!==n[y].begin){var k=n[y].start.x,N=n[y].start.y;I.call(this,n[y].deltas,k,N),x=!0}a&&S.call(this,a),t&&_.call(this)}},k=function(e){var t=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,r=t*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return e-r;case"top":return e+t-r;case"hanging":return e+t-2*r;case"middle":return e+t/2-r;default:return e}},N=function(e){return e+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};u.prototype.createLinearGradient=function(){var e=function(){};return e.colorStops=[],e.addColorStop=function(e,t){this.colorStops.push([e,t])},e.getColor=function(){return 0===this.colorStops.length?"#000000":this.colorStops[0][1]},e.isCanvasGradient=!0,e},u.prototype.createPattern=function(){return this.createLinearGradient()},u.prototype.createRadialGradient=function(){return this.createLinearGradient()};var j=function(e,t,r,a,n,s,i,o,l){for(var c=D.call(this,r,a,n,s),d=0;d<c.length;d++){var u=c[d];0===d&&(l?E.call(this,u.x1+e,u.y1+t):C.call(this,u.x1+e,u.y1+t)),T.call(this,e,t,u.x2,u.y2,u.x3,u.y3,u.x4,u.y4)}o?_.call(this):S.call(this,i)},S=function(e){switch(e){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},_=function(){this.pdf.clip(),this.pdf.discardPath()},E=function(e,t){this.pdf.internal.out(r(e)+" "+a(t)+" m")},A=function(e){var t;switch(e.align){case"right":case"end":t="right";break;case"center":t="center";break;default:t="left"}var r=this.pdf.getTextDimensions(e.text),a=k.call(this,e.y),n=N.call(this,a)-r.h,s=this.ctx.transform.applyToPoint(new i(e.x,a)),c=this.ctx.transform.decompose(),d=new l;d=(d=(d=d.multiply(c.translate)).multiply(c.skew)).multiply(c.scale);for(var u,h,m,f=this.ctx.transform.applyToRectangle(new o(e.x,a,r.w,r.h)),x=d.applyToRectangle(new o(e.x,n,r.w,r.h)),b=p.call(this,x),j=[],S=0;S<b.length;S+=1)-1===j.indexOf(b[S])&&j.push(b[S]);if(v(j),this.autoPaging)for(var _=j[0],E=j[j.length-1],A=_;A<E+1;A++){this.pdf.setPage(A);var C=1===A?this.posY+this.margin[0]:this.margin[0],I=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],T=this.pdf.internal.pageSize.height-this.margin[2],D=T-this.margin[0],P=this.pdf.internal.pageSize.width-this.margin[1],F=P-this.margin[3],L=1===A?0:I+(A-2)*D;if(0!==this.ctx.clip_path.length){var M=this.path;u=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=y(u,this.posX+this.margin[3],-1*L+C),w.call(this,"fill",!0),this.path=M}var R=y([JSON.parse(JSON.stringify(x))],this.posX+this.margin[3],-L+C+this.ctx.prevPageLastElemOffset)[0];e.scale>=.01&&(h=this.pdf.internal.getFontSize(),this.pdf.setFontSize(h*e.scale),m=this.lineWidth,this.lineWidth=m*e.scale);var O="text"!==this.autoPaging;if(O||R.y+R.h<=T){if(O||R.y>=C&&R.x<=P){var B=O?e.text:this.pdf.splitTextToSize(e.text,e.maxWidth||P-R.x)[0],z=y([JSON.parse(JSON.stringify(f))],this.posX+this.margin[3],-L+C+this.ctx.prevPageLastElemOffset)[0],U=O&&(A>_||A<E)&&g.call(this);U&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],F,D,null).clip().discardPath()),this.pdf.text(B,z.x,z.y,{angle:e.angle,align:t,renderingMode:e.renderingMode}),U&&this.pdf.restoreGraphicsState()}}else R.y<T&&(this.ctx.prevPageLastElemOffset+=T-R.y);e.scale>=.01&&(this.pdf.setFontSize(h),this.lineWidth=m)}else e.scale>=.01&&(h=this.pdf.internal.getFontSize(),this.pdf.setFontSize(h*e.scale),m=this.lineWidth,this.lineWidth=m*e.scale),this.pdf.text(e.text,s.x+this.posX,s.y+this.posY,{angle:e.angle,align:t,renderingMode:e.renderingMode,maxWidth:e.maxWidth}),e.scale>=.01&&(this.pdf.setFontSize(h),this.lineWidth=m)},C=function(e,t,n,s){n=n||0,s=s||0,this.pdf.internal.out(r(e+n)+" "+a(t+s)+" l")},I=function(e,t,r){return this.pdf.lines(e,t,r,null,null)},T=function(e,r,a,i,o,l,c,d){this.pdf.internal.out([t(n(a+e)),t(s(i+r)),t(n(o+e)),t(s(l+r)),t(n(c+e)),t(s(d+r)),"c"].join(" "))},D=function(e,t,r,a){for(var n=2*Math.PI,s=Math.PI/2;t>r;)t-=n;var i=Math.abs(r-t);i<n&&a&&(i=n-i);for(var o=[],l=a?-1:1,c=t;i>1e-5;){var d=c+l*Math.min(i,s);o.push(P.call(this,e,c,d)),i-=Math.abs(d-c),c=d}return o},P=function(e,t,r){var a=(r-t)/2,n=e*Math.cos(a),s=e*Math.sin(a),i=n,o=-s,l=i*i+o*o,c=l+i*n+o*s,d=4/3*(Math.sqrt(2*l*c)-c)/(i*s-o*n),u=i-d*o,h=o+d*i,m=u,f=-h,g=a+t,p=Math.cos(g),x=Math.sin(g);return{x1:e*Math.cos(t),y1:e*Math.sin(t),x2:u*p-h*x,y2:u*x+h*p,x3:m*p-f*x,y3:m*x+f*p,x4:e*Math.cos(r),y4:e*Math.sin(r)}},F=function(e){return 180*e/Math.PI},L=function(e,t,r,a,n,s){var i=e+.5*(r-e),l=t+.5*(a-t),c=n+.5*(r-n),d=s+.5*(a-s),u=Math.min(e,n,i,c),h=Math.max(e,n,i,c),m=Math.min(t,s,l,d),f=Math.max(t,s,l,d);return new o(u,m,h-u,f-m)},M=function(e,t,r,a,n,s,i,l){var c,d,u,h,m,f,g,p,x,y,v,b,w,k,N=r-e,j=a-t,S=n-r,_=s-a,E=i-n,A=l-s;for(d=0;d<41;d++)x=(g=(u=e+(c=d/40)*N)+c*((m=r+c*S)-u))+c*(m+c*(n+c*E-m)-g),y=(p=(h=t+c*j)+c*((f=a+c*_)-h))+c*(f+c*(s+c*A-f)-p),0==d?(v=x,b=y,w=x,k=y):(v=Math.min(v,x),b=Math.min(b,y),w=Math.max(w,x),k=Math.max(k,y));return new o(Math.round(v),Math.round(b),Math.round(w-v),Math.round(k-b))},R=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var e,t,r=(e=this.ctx.lineDash,t=this.ctx.lineDashOffset,JSON.stringify({lineDash:e,lineDashOffset:t}));this.prevLineDash!==r&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=r)}}}(px.API),function(e){var t=function(e){var t,r,a,n,s,i,o,l,c,d;for(/[^\x00-\xFF]/.test(e),r=[],a=0,n=(e+=t="\0\0\0\0".slice(e.length%4||4)).length;n>a;a+=4)0!==(s=(e.charCodeAt(a)<<24)+(e.charCodeAt(a+1)<<16)+(e.charCodeAt(a+2)<<8)+e.charCodeAt(a+3))?(i=(s=((s=((s=((s=(s-(d=s%85))/85)-(c=s%85))/85)-(l=s%85))/85)-(o=s%85))/85)%85,r.push(i+33,o+33,l+33,c+33,d+33)):r.push(122);return function(e,t){for(var r=t;r>0;r--)e.pop()}(r,t.length),String.fromCharCode.apply(String,r)+"~>"},r=function(e){var t,r,a,n,s,i=String,o="length",l=255,c="charCodeAt",d="slice",u="replace";for(e[d](-2),e=e[d](0,-2)[u](/\s/g,"")[u]("z","!!!!!"),a=[],n=0,s=(e+=t="uuuuu"[d](e[o]%5||5))[o];s>n;n+=5)r=52200625*(e[c](n)-33)+614125*(e[c](n+1)-33)+7225*(e[c](n+2)-33)+85*(e[c](n+3)-33)+(e[c](n+4)-33),a.push(l&r>>24,l&r>>16,l&r>>8,l&r);return function(e,t){for(var r=t;r>0;r--)e.pop()}(a,t[o]),i.fromCharCode.apply(i,a)},a=function(e){return e.split("").map(function(e){return("0"+e.charCodeAt().toString(16)).slice(-2)}).join("")+">"},n=function(e){var t=new RegExp(/^([0-9A-Fa-f]{2})+$/);if(-1!==(e=e.replace(/\s/g,"")).indexOf(">")&&(e=e.substr(0,e.indexOf(">"))),e.length%2&&(e+="0"),!1===t.test(e))return"";for(var r="",a=0;a<e.length;a+=2)r+=String.fromCharCode("0x"+(e[a]+e[a+1]));return r},s=function(e){for(var t=new Uint8Array(e.length),r=e.length;r--;)t[r]=e.charCodeAt(r);return(t=lh(t)).reduce(function(e,t){return e+String.fromCharCode(t)},"")};e.processDataByFilters=function(e,i){var o=0,l=e||"",c=[];for("string"==typeof(i=i||[])&&(i=[i]),o=0;o<i.length;o+=1)switch(i[o]){case"ASCII85Decode":case"/ASCII85Decode":l=r(l),c.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":l=t(l),c.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":l=n(l),c.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":l=a(l),c.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":l=s(l),c.push("/FlateDecode");break;default:throw new Error('The filter: "'+i[o]+'" is not implemented')}return{data:l,reverseChain:c.reverse().join(" ")}}}(px.API),(Sy=px.API).loadFile=function(e,t,r){return function(e,t,r){t=!1!==t,r="function"==typeof r?r:function(){};var a=void 0;try{a=function(e,t,r){var a=new XMLHttpRequest,n=0,s=function(e){var t=e.length,r=[],a=String.fromCharCode;for(n=0;n<t;n+=1)r.push(a(255&e.charCodeAt(n)));return r.join("")};if(a.open("GET",e,!t),a.overrideMimeType("text/plain; charset=x-user-defined"),!1===t&&(a.onload=function(){200===a.status?r(s(this.responseText)):r(void 0)}),a.send(null),t&&200===a.status)return s(a.responseText)}(e,t,r)}catch(Ou){}return a}(e,t,r)},Sy.loadImageFile=Sy.loadFile,function(e){function t(){return(Rp.html2canvas?Promise.resolve(Rp.html2canvas):r.e(52).then(r.t.bind(r,1052,23))).catch(function(e){return Promise.reject(new Error("Could not load html2canvas: "+e))}).then(function(e){return e.default?e.default:e})}function a(){return(Rp.DOMPurify?Promise.resolve(Rp.DOMPurify):r.e(82).then(r.bind(r,7082))).catch(function(e){return Promise.reject(new Error("Could not load dompurify: "+e))}).then(function(e){return e.default?e.default:e})}var n=function(e){var t=(0,ju.A)(e);return"undefined"===t?"undefined":"string"===t||e instanceof String?"string":"number"===t||e instanceof Number?"number":"function"===t||e instanceof Function?"function":e&&e.constructor===Array?"array":e&&1===e.nodeType?"element":"object"===t?"object":"unknown"},s=function(e,t){var r=document.createElement(e);for(var a in t.className&&(r.className=t.className),t.innerHTML&&t.dompurify&&(r.innerHTML=t.dompurify.sanitize(t.innerHTML)),t.style)r.style[a]=t.style[a];return r},i=function e(t,r){for(var a=3===t.nodeType?document.createTextNode(t.nodeValue):t.cloneNode(!1),n=t.firstChild;n;n=n.nextSibling)!0!==r&&1===n.nodeType&&"SCRIPT"===n.nodeName||a.appendChild(e(n,r));return 1===t.nodeType&&("CANVAS"===t.nodeName?(a.width=t.width,a.height=t.height,a.getContext("2d").drawImage(t,0,0)):"TEXTAREA"!==t.nodeName&&"SELECT"!==t.nodeName||(a.value=t.value),a.addEventListener("load",function(){a.scrollTop=t.scrollTop,a.scrollLeft=t.scrollLeft},!0)),a},o=function e(t){var r=Object.assign(e.convert(Promise.resolve()),JSON.parse(JSON.stringify(e.template))),a=e.convert(Promise.resolve(),r);return(a=a.setProgress(1,e,1,[e])).set(t)};(o.prototype=Object.create(Promise.prototype)).constructor=o,o.convert=function(e,t){return e.__proto__=t||o.prototype,e},o.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},o.prototype.from=function(e,t){return this.then(function(){switch(t=t||function(e){switch(n(e)){case"string":return"string";case"element":return"canvas"===e.nodeName.toLowerCase()?"canvas":"element";default:return"unknown"}}(e),t){case"string":return this.then(a).then(function(t){return this.set({src:s("div",{innerHTML:e,dompurify:t})})});case"element":return this.set({src:e});case"canvas":return this.set({canvas:e});case"img":return this.set({img:e});default:return this.error("Unknown source type.")}})},o.prototype.to=function(e){switch(e){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},o.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var e={position:"relative",display:"inline-block",width:("number"!=typeof this.opt.width||isNaN(this.opt.width)||"number"!=typeof this.opt.windowWidth||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},t=i(this.prop.src,this.opt.html2canvas.javascriptEnabled);"BODY"===t.tagName&&(e.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=s("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=s("div",{className:"html2pdf__container",style:e}),this.prop.container.appendChild(t),this.prop.container.firstChild.appendChild(s("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},o.prototype.toCanvas=function(){var e=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(e).then(t).then(function(e){var t=Object.assign({},this.opt.html2canvas);return delete t.onrendered,e(this.prop.container,t)}).then(function(e){(this.opt.html2canvas.onrendered||function(){})(e),this.prop.canvas=e,document.body.removeChild(this.prop.overlay)})},o.prototype.toContext2d=function(){var e=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(e).then(t).then(function(e){var t=this.opt.jsPDF,r=this.opt.fontFaces,a="number"!=typeof this.opt.width||isNaN(this.opt.width)||"number"!=typeof this.opt.windowWidth||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,n=Object.assign({async:!0,allowTaint:!0,scale:a,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete n.onrendered,t.context2d.autoPaging=void 0===this.opt.autoPaging||this.opt.autoPaging,t.context2d.posX=this.opt.x,t.context2d.posY=this.opt.y,t.context2d.margin=this.opt.margin,t.context2d.fontFaces=r,r)for(var s=0;s<r.length;++s){var i=r[s],o=i.src.find(function(e){return"truetype"===e.format});o&&t.addFont(o.url,i.ref.name,i.ref.style)}return n.windowHeight=n.windowHeight||0,n.windowHeight=0==n.windowHeight?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):n.windowHeight,t.context2d.save(!0),e(this.prop.container,n)}).then(function(e){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(e),this.prop.canvas=e,document.body.removeChild(this.prop.overlay)})},o.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var e=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=e})},o.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},o.prototype.output=function(e,t,r){return"img"===(r=r||"pdf").toLowerCase()||"image"===r.toLowerCase()?this.outputImg(e,t):this.outputPdf(e,t)},o.prototype.outputPdf=function(e,t){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(e,t)})},o.prototype.outputImg=function(e){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(e){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+e+'" is not supported.'}})},o.prototype.save=function(e){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(e?{filename:e}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},o.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},o.prototype.set=function(e){if("object"!==n(e))return this;var t=Object.keys(e||{}).map(function(t){if(t in o.template.prop)return function(){this.prop[t]=e[t]};switch(t){case"margin":return this.setMargin.bind(this,e.margin);case"jsPDF":return function(){return this.opt.jsPDF=e.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,e.pageSize);default:return function(){this.opt[t]=e[t]}}},this);return this.then(function(){return this.thenList(t)})},o.prototype.get=function(e,t){return this.then(function(){var r=e in o.template.prop?this.prop[e]:this.opt[e];return t?t(r):r})},o.prototype.setMargin=function(e){return this.then(function(){switch(n(e)){case"number":e=[e,e,e,e];case"array":if(2===e.length&&(e=[e[0],e[1],e[0],e[1]]),4===e.length)break;default:return this.error("Invalid margin array.")}this.opt.margin=e}).then(this.setPageSize)},o.prototype.setPageSize=function(e){function t(e,t){return Math.floor(e*t/72*96)}return this.then(function(){(e=e||px.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(e.inner={width:e.width-this.opt.margin[1]-this.opt.margin[3],height:e.height-this.opt.margin[0]-this.opt.margin[2]},e.inner.px={width:t(e.inner.width,e.k),height:t(e.inner.height,e.k)},e.inner.ratio=e.inner.height/e.inner.width),this.prop.pageSize=e})},o.prototype.setProgress=function(e,t,r,a){return null!=e&&(this.progress.val=e),null!=t&&(this.progress.state=t),null!=r&&(this.progress.n=r),null!=a&&(this.progress.stack=a),this.progress.ratio=this.progress.val/this.progress.state,this},o.prototype.updateProgress=function(e,t,r,a){return this.setProgress(e?this.progress.val+e:null,t||null,r?this.progress.n+r:null,a?this.progress.stack.concat(a):null)},o.prototype.then=function(e,t){var r=this;return this.thenCore(e,t,function(e,t){return r.updateProgress(null,null,1,[e]),Promise.prototype.then.call(this,function(t){return r.updateProgress(null,e),t}).then(e,t).then(function(e){return r.updateProgress(1),e})})},o.prototype.thenCore=function(e,t,r){r=r||Promise.prototype.then;var a=this;e&&(e=e.bind(a)),t&&(t=t.bind(a));var n=-1!==Promise.toString().indexOf("[native code]")&&"Promise"===Promise.name?a:o.convert(Object.assign({},a),Promise.prototype),s=r.call(n,e,t);return o.convert(s,a.__proto__)},o.prototype.thenExternal=function(e,t){return Promise.prototype.then.call(this,e,t)},o.prototype.thenList=function(e){var t=this;return e.forEach(function(e){t=t.thenCore(e)}),t},o.prototype.catch=function(e){e&&(e=e.bind(this));var t=Promise.prototype.catch.call(this,e);return o.convert(t,this)},o.prototype.catchExternal=function(e){return Promise.prototype.catch.call(this,e)},o.prototype.error=function(e){return this.then(function(){throw new Error(e)})},o.prototype.using=o.prototype.set,o.prototype.saveAs=o.prototype.save,o.prototype.export=o.prototype.output,o.prototype.run=o.prototype.then,px.getPageSize=function(e,t,r){if("object"===(0,ju.A)(e)){var a=e;e=a.orientation,t=a.unit||t,r=a.format||r}t=t||"mm",r=r||"a4",e=(""+(e||"P")).toLowerCase();var n,s=(""+r).toLowerCase(),i={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(t){case"pt":n=1;break;case"mm":n=72/25.4;break;case"cm":n=72/2.54;break;case"in":n=72;break;case"px":n=.75;break;case"pc":case"em":n=12;break;case"ex":n=6;break;default:throw"Invalid unit: "+t}var o,l=0,c=0;if(i.hasOwnProperty(s))l=i[s][1]/n,c=i[s][0]/n;else try{l=r[1],c=r[0]}catch(Hp){throw new Error("Invalid format: "+r)}if("p"===e||"portrait"===e)e="p",c>l&&(o=c,c=l,l=o);else{if("l"!==e&&"landscape"!==e)throw"Invalid orientation: "+e;e="l",l>c&&(o=c,c=l,l=o)}return{width:c,height:l,unit:t,k:n,orientation:e}},e.html=function(e,t){(t=t||{}).callback=t.callback||function(){},t.html2canvas=t.html2canvas||{},t.html2canvas.canvas=t.html2canvas.canvas||this.canvas,t.jsPDF=t.jsPDF||this,t.fontFaces=t.fontFaces?t.fontFaces.map(cy):null;var r=new o(t);return t.worker?r:r.from(e).doCallback()}}(px.API),px.API.addJS=function(e){return vy=e,this.internal.events.subscribe("postPutResources",function(){xy=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(xy+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),yy=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+vy+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){void 0!==xy&&void 0!==yy&&this.internal.out("/Names <</JavaScript "+xy+" 0 R>>")}),this},function(e){var t;e.events.push(["postPutResources",function(){var e=this,r=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var a=e.outline.render().split(/\r\n/),n=0;n<a.length;n++){var s=a[n],i=r.exec(s);if(null!=i){var o=i[1];e.internal.newObjectDeferredBegin(o,!1)}e.internal.write(s)}if(this.outline.createNamedDestinations){var l=this.internal.pages.length,c=[];for(n=0;n<l;n++){var d=e.internal.newObject();c.push(d);var u=e.internal.getPageInfo(n+1);e.internal.write("<< /D["+u.objId+" 0 R /XYZ null null null]>> endobj")}var h=e.internal.newObject();for(e.internal.write("<< /Names [ "),n=0;n<c.length;n++)e.internal.write("(page_"+(n+1)+")"+c[n]+" 0 R");e.internal.write(" ] >>","endobj"),t=e.internal.newObject(),e.internal.write("<< /Dests "+h+" 0 R"),e.internal.write(">>","endobj")}}]),e.events.push(["putCatalog",function(){var e=this;e.outline.root.children.length>0&&(e.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&e.internal.write("/Names "+t+" 0 R"))}]),e.events.push(["initialized",function(){var e=this;e.outline={createNamedDestinations:!1,root:{children:[]}},e.outline.add=function(e,t,r){var a={title:t,options:r,children:[]};return null==e&&(e=this.root),e.children.push(a),a},e.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=e,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},e.outline.genIds_r=function(t){t.id=e.internal.newObjectDeferred();for(var r=0;r<t.children.length;r++)this.genIds_r(t.children[r])},e.outline.renderRoot=function(e){this.objStart(e),this.line("/Type /Outlines"),e.children.length>0&&(this.line("/First "+this.makeRef(e.children[0])),this.line("/Last "+this.makeRef(e.children[e.children.length-1]))),this.line("/Count "+this.count_r({count:0},e)),this.objEnd()},e.outline.renderItems=function(t){for(var r=this.ctx.pdf.internal.getVerticalCoordinateString,a=0;a<t.children.length;a++){var n=t.children[a];this.objStart(n),this.line("/Title "+this.makeString(n.title)),this.line("/Parent "+this.makeRef(t)),a>0&&this.line("/Prev "+this.makeRef(t.children[a-1])),a<t.children.length-1&&this.line("/Next "+this.makeRef(t.children[a+1])),n.children.length>0&&(this.line("/First "+this.makeRef(n.children[0])),this.line("/Last "+this.makeRef(n.children[n.children.length-1])));var s=this.count=this.count_r({count:0},n);if(s>0&&this.line("/Count "+s),n.options&&n.options.pageNumber){var i=e.internal.getPageInfo(n.options.pageNumber);this.line("/Dest ["+i.objId+" 0 R /XYZ 0 "+r(0)+" 0]")}this.objEnd()}for(var o=0;o<t.children.length;o++)this.renderItems(t.children[o])},e.outline.line=function(e){this.ctx.val+=e+"\r\n"},e.outline.makeRef=function(e){return e.id+" 0 R"},e.outline.makeString=function(t){return"("+e.internal.pdfEscape(t)+")"},e.outline.objStart=function(e){this.ctx.val+="\r\n"+e.id+" 0 obj\r\n<<\r\n"},e.outline.objEnd=function(){this.ctx.val+=">> \r\nendobj\r\n"},e.outline.count_r=function(e,t){for(var r=0;r<t.children.length;r++)e.count++,this.count_r(e,t.children[r]);return e.count}}])}(px.API),function(e){var t=[192,193,194,195,196,197,198,199];e.processJPEG=function(e,r,a,n,s,i){var o,l=this.decode.DCT_DECODE,c=null;if("string"==typeof e||this.__addimage__.isArrayBuffer(e)||this.__addimage__.isArrayBufferView(e)){switch(e=s||e,e=this.__addimage__.isArrayBuffer(e)?new Uint8Array(e):e,o=function(e){for(var r,a=256*e.charCodeAt(4)+e.charCodeAt(5),n=e.length,s={width:0,height:0,numcomponents:1},i=4;i<n;i+=2){if(i+=a,-1!==t.indexOf(e.charCodeAt(i+1))){r=256*e.charCodeAt(i+5)+e.charCodeAt(i+6),s={width:256*e.charCodeAt(i+7)+e.charCodeAt(i+8),height:r,numcomponents:e.charCodeAt(i+9)};break}a=256*e.charCodeAt(i+2)+e.charCodeAt(i+3)}return s}(e=this.__addimage__.isArrayBufferView(e)?this.__addimage__.arrayBufferToBinaryString(e):e),o.numcomponents){case 1:i=this.color_spaces.DEVICE_GRAY;break;case 4:i=this.color_spaces.DEVICE_CMYK;break;case 3:i=this.color_spaces.DEVICE_RGB}c={data:e,width:o.width,height:o.height,colorSpace:i,bitsPerComponent:8,filter:l,index:r,alias:a}}return c}}(px.API),px.API.processPNG=function(e,t,r,a){if(this.__addimage__.isArrayBuffer(e)&&(e=new Uint8Array(e)),this.__addimage__.isArrayBufferView(e)){var n,s=new Lp(e,{checkCrc:!0}).decode(),i=s.width,o=s.height,l=s.channels,c=s.palette,d=s.depth;n=c&&1===l?function(e){for(var t=e.width,r=e.height,a=e.data,n=e.palette,s=e.depth,i=!1,o=[],l=[],c=void 0,d=!1,u=0,h=0;h<n.length;h++){var m=uh(n[h],4),f=m[0],g=m[1],p=m[2],x=m[3];o.push(f,g,p),null!=x&&(0===x?(u++,l.length<1&&l.push(h)):x<255&&(d=!0))}if(d||u>1){i=!0,l=void 0;var y=t*r;c=new Uint8Array(y);for(var v=new DataView(a.buffer),b=0;b<y;b++){var w=uh(n[Ly(v,b,s)],4)[3];c[b]=w}}else 0===u&&(l=void 0);return{colorSpace:"Indexed",colorsPerPixel:1,sMaskBitsPerComponent:i?8:void 0,colorBytes:a,alphaBytes:c,needSMask:i,palette:o,mask:l}}(s):2===l||4===l?function(e){for(var t=e.data,r=e.width,a=e.height,n=e.channels,s=e.depth,i=2===n?"DeviceGray":"DeviceRGB",o=n-1,l=r*a,c=o,d=l*c,u=1*l,h=Math.ceil(d*s/8),m=Math.ceil(u*s/8),f=new Uint8Array(h),g=new Uint8Array(m),p=new DataView(t.buffer),x=new DataView(f.buffer),y=new DataView(g.buffer),v=!1,b=0;b<l;b++){for(var w=b*n,k=0;k<c;k++)My(x,Ly(p,w+k,s),b*c+k,s);var N=Ly(p,w+c,s);N<(1<<s)-1&&(v=!0),My(y,N,1*b,s)}return{colorSpace:i,colorsPerPixel:o,sMaskBitsPerComponent:v?s:void 0,colorBytes:f,alphaBytes:g,needSMask:v}}(s):function(e){var t=e.data,r=1===e.channels?"DeviceGray":"DeviceRGB";return{colorSpace:r,colorsPerPixel:"DeviceGray"===r?1:3,colorBytes:t instanceof Uint16Array?function(e){for(var t=e.length,r=new Uint8Array(2*t),a=new DataView(r.buffer,r.byteOffset,r.byteLength),n=0;n<t;n++)a.setUint16(2*n,e[n],!1);return r}(t):t,needSMask:!1}}(s);var u,h,m,f=n,g=f.colorSpace,p=f.colorsPerPixel,x=f.sMaskBitsPerComponent,y=f.colorBytes,v=f.alphaBytes,b=f.needSMask,w=f.palette,k=f.mask,N=null;return a!==px.API.image_compression.NONE?(N=function(e){var t;switch(e){case px.API.image_compression.FAST:t=11;break;case px.API.image_compression.MEDIUM:t=13;break;case px.API.image_compression.SLOW:t=14;break;default:t=12}return t}(a),u=this.decode.FLATE_DECODE,h="/Predictor ".concat(N," /Colors ").concat(p," /BitsPerComponent ").concat(d," /Columns ").concat(i),e=Ey(y,Math.ceil(i*p*d/8),p,d,a),b&&(m=Ey(v,Math.ceil(i*x/8),1,x,a))):(u=void 0,h=void 0,e=y,b&&(m=v)),(this.__addimage__.isArrayBuffer(e)||this.__addimage__.isArrayBufferView(e))&&(e=this.__addimage__.arrayBufferToBinaryString(e)),(m&&this.__addimage__.isArrayBuffer(m)||this.__addimage__.isArrayBufferView(m))&&(m=this.__addimage__.arrayBufferToBinaryString(m)),{alias:r,data:e,index:t,filter:u,decodeParameters:h,transparency:k,palette:w,sMask:m,predictor:N,width:i,height:o,bitsPerComponent:d,sMaskBitsPerComponent:x,colorSpace:g}}},function(e){e.processGIF89A=function(t,r,a,n){var s=new Oy(t),i=s.width,o=s.height,l=[];s.decodeAndBlitFrameRGBA(0,l);var c={data:l,width:i,height:o},d=new zy(100).encode(c,100);return e.processJPEG.call(this,d,r,a,n)},e.processGIF87A=e.processGIF89A}(px.API),Uy.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,16===this.bitPP&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var e=0===this.colors?1<<this.bitPP:this.colors;this.palette=new Array(e);for(var t=0;t<e;t++){var r=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0);this.palette[t]={red:n,green:a,blue:r,quad:s}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},Uy.prototype.parseBGR=function(){this.pos=this.offset;try{var e="bit"+this.bitPP,t=this.width*this.height*4;this.data=new Uint8Array(t),this[e]()}catch(r){Bp.log("bit decode error:"+r)}},Uy.prototype.bit1=function(){var e,t=Math.ceil(this.width/8),r=t%4;for(e=this.height-1;e>=0;e--){for(var a=this.bottom_up?e:this.height-1-e,n=0;n<t;n++)for(var s=this.datav.getUint8(this.pos++,!0),i=a*this.width*4+8*n*4,o=0;o<8&&8*n+o<this.width;o++){var l=this.palette[s>>7-o&1];this.data[i+4*o]=l.blue,this.data[i+4*o+1]=l.green,this.data[i+4*o+2]=l.red,this.data[i+4*o+3]=255}0!==r&&(this.pos+=4-r)}},Uy.prototype.bit4=function(){for(var e=Math.ceil(this.width/2),t=e%4,r=this.height-1;r>=0;r--){for(var a=this.bottom_up?r:this.height-1-r,n=0;n<e;n++){var s=this.datav.getUint8(this.pos++,!0),i=a*this.width*4+2*n*4,o=s>>4,l=15&s,c=this.palette[o];if(this.data[i]=c.blue,this.data[i+1]=c.green,this.data[i+2]=c.red,this.data[i+3]=255,2*n+1>=this.width)break;c=this.palette[l],this.data[i+4]=c.blue,this.data[i+4+1]=c.green,this.data[i+4+2]=c.red,this.data[i+4+3]=255}0!==t&&(this.pos+=4-t)}},Uy.prototype.bit8=function(){for(var e=this.width%4,t=this.height-1;t>=0;t--){for(var r=this.bottom_up?t:this.height-1-t,a=0;a<this.width;a++){var n=this.datav.getUint8(this.pos++,!0),s=r*this.width*4+4*a;if(n<this.palette.length){var i=this.palette[n];this.data[s]=i.red,this.data[s+1]=i.green,this.data[s+2]=i.blue,this.data[s+3]=255}else this.data[s]=255,this.data[s+1]=255,this.data[s+2]=255,this.data[s+3]=255}0!==e&&(this.pos+=4-e)}},Uy.prototype.bit15=function(){for(var e=this.width%3,t=parseInt("11111",2),r=this.height-1;r>=0;r--){for(var a=this.bottom_up?r:this.height-1-r,n=0;n<this.width;n++){var s=this.datav.getUint16(this.pos,!0);this.pos+=2;var i=(s&t)/t*255|0,o=(s>>5&t)/t*255|0,l=(s>>10&t)/t*255|0,c=s>>15?255:0,d=a*this.width*4+4*n;this.data[d]=l,this.data[d+1]=o,this.data[d+2]=i,this.data[d+3]=c}this.pos+=e}},Uy.prototype.bit16=function(){for(var e=this.width%3,t=parseInt("11111",2),r=parseInt("111111",2),a=this.height-1;a>=0;a--){for(var n=this.bottom_up?a:this.height-1-a,s=0;s<this.width;s++){var i=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(i&t)/t*255|0,l=(i>>5&r)/r*255|0,c=(i>>11)/t*255|0,d=n*this.width*4+4*s;this.data[d]=c,this.data[d+1]=l,this.data[d+2]=o,this.data[d+3]=255}this.pos+=e}},Uy.prototype.bit24=function(){for(var e=this.height-1;e>=0;e--){for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var a=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),i=t*this.width*4+4*r;this.data[i]=s,this.data[i+1]=n,this.data[i+2]=a,this.data[i+3]=255}this.pos+=this.width%4}},Uy.prototype.bit32=function(){for(var e=this.height-1;e>=0;e--)for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var a=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),o=t*this.width*4+4*r;this.data[o]=s,this.data[o+1]=n,this.data[o+2]=a,this.data[o+3]=i}},Uy.prototype.getData=function(){return this.data},function(e){e.processBMP=function(t,r,a,n){var s=new Uy(t,!1),i=s.width,o=s.height,l={data:s.getData(),width:i,height:o},c=new zy(100).encode(l,100);return e.processJPEG.call(this,c,r,a,n)}}(px.API),Vy.prototype.getData=function(){return this.data},function(e){e.processWEBP=function(t,r,a,n){var s=new Vy(t),i=s.width,o=s.height,l={data:s.getData(),width:i,height:o},c=new zy(100).encode(l,100);return e.processJPEG.call(this,c,r,a,n)}}(px.API),px.API.processRGBA=function(e,t,r){for(var a=e.data,n=a.length,s=new Uint8Array(n/4*3),i=new Uint8Array(n/4),o=0,l=0,c=0;c<n;c+=4){var d=a[c],u=a[c+1],h=a[c+2],m=a[c+3];s[o++]=d,s[o++]=u,s[o++]=h,i[l++]=m}var f=this.__addimage__.arrayBufferToBinaryString(s);return{alpha:this.__addimage__.arrayBufferToBinaryString(i),data:f,index:t,alias:r,colorSpace:"DeviceRGB",bitsPerComponent:8,width:e.width,height:e.height}},px.API.setLanguage=function(e){return void 0===this.internal.languageSettings&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),void 0!=={af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[e]&&(this.internal.languageSettings.languageCode=e,!1===this.internal.languageSettings.isSubscribed&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},by=px.API,wy=by.getCharWidthsArray=function(e,t){var r,a,n=(t=t||{}).font||this.internal.getFont(),s=t.fontSize||this.internal.getFontSize(),i=t.charSpace||this.internal.getCharSpace(),o=t.widths?t.widths:n.metadata.Unicode.widths,l=o.fof?o.fof:1,c=t.kerning?t.kerning:n.metadata.Unicode.kerning,d=c.fof?c.fof:1,u=!1!==t.doKerning,h=0,m=e.length,f=0,g=o[0]||l,p=[];for(r=0;r<m;r++)a=e.charCodeAt(r),"function"==typeof n.metadata.widthOfString?p.push((n.metadata.widthOfGlyph(n.metadata.characterToGlyph(a))+i*(1e3/s)||0)/1e3):(h=u&&"object"===(0,ju.A)(c[a])&&!isNaN(parseInt(c[a][f],10))?c[a][f]/d:0,p.push((o[a]||g)/l+h)),f=a;return p},ky=by.getStringUnitWidth=function(e,t){var r=(t=t||{}).fontSize||this.internal.getFontSize(),a=t.font||this.internal.getFont(),n=t.charSpace||this.internal.getCharSpace();return by.processArabic&&(e=by.processArabic(e)),"function"==typeof a.metadata.widthOfString?a.metadata.widthOfString(e,r,n)/r:wy.apply(this,arguments).reduce(function(e,t){return e+t},0)},Ny=function(e,t,r,a){for(var n=[],s=0,i=e.length,o=0;s!==i&&o+t[s]<r;)o+=t[s],s++;n.push(e.slice(0,s));var l=s;for(o=0;s!==i;)o+t[s]>a&&(n.push(e.slice(l,s)),o=0,l=s),o+=t[s],s++;return l!==s&&n.push(e.slice(l,s)),n},jy=function(e,t,r){r||(r={});var a,n,s,i,o,l,c,d=[],u=[d],h=r.textIndent||0,m=0,f=0,g=e.split(" "),p=wy.apply(this,[" ",r])[0];if(l=-1===r.lineIndent?g[0].length+2:r.lineIndent||0){var x=Array(l).join(" "),y=[];g.map(function(e){(e=e.split(/\s*\n/)).length>1?y=y.concat(e.map(function(e,t){return(t&&e.length?"\n":"")+e})):y.push(e[0])}),g=y,l=ky.apply(this,[x,r])}for(s=0,i=g.length;s<i;s++){var v=0;if(a=g[s],l&&"\n"==a[0]&&(a=a.substr(1),v=1),h+m+(f=(n=wy.apply(this,[a,r])).reduce(function(e,t){return e+t},0))>t||v){if(f>t){for(o=Ny.apply(this,[a,n,t-(h+m),t]),d.push(o.shift()),d=[o.pop()];o.length;)u.push([o.shift()]);f=n.slice(a.length-(d[0]?d[0].length:0)).reduce(function(e,t){return e+t},0)}else d=[a];u.push(d),h=f+l,m=p}else d.push(a),h+=m+f,m=p}return c=l?function(e,t){return(t?x:"")+e.join(" ")}:function(e){return e.join(" ")},u.map(c)},by.splitTextToSize=function(e,t,r){var a,n=(r=r||{}).fontSize||this.internal.getFontSize(),s=function(e){if(e.widths&&e.kerning)return{widths:e.widths,kerning:e.kerning};var t=this.internal.getFont(e.fontName,e.fontStyle),r="Unicode";return t.metadata[r]?{widths:t.metadata[r].widths||{0:1},kerning:t.metadata[r].kerning||{}}:{font:t.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}.call(this,r);a=Array.isArray(e)?e:String(e).split(/\r?\n/);var i=1*this.internal.scaleFactor*t/n;s.textIndent=r.textIndent?1*r.textIndent*this.internal.scaleFactor/n:0,s.lineIndent=r.lineIndent;var o,l,c=[];for(o=0,l=a.length;o<l;o++)c=c.concat(jy.apply(this,[a[o],i,s]));return c},function(e){e.__fontmetrics__=e.__fontmetrics__||{};for(var t="0123456789abcdef",r="klmnopqrstuvwxyz",a={},n={},s=0;s<16;s++)a[r[s]]=t[s],n[t[s]]=r[s];var i=function(e){return"0x"+parseInt(e,10).toString(16)},o=e.__fontmetrics__.compress=function(e){var t,r,a,s,l=["{"];for(var c in e){if(t=e[c],isNaN(parseInt(c,10))?r="'"+c+"'":(c=parseInt(c,10),r=(r=i(c).slice(2)).slice(0,-1)+n[r.slice(-1)]),"number"==typeof t)t<0?(a=i(t).slice(3),s="-"):(a=i(t).slice(2),s=""),a=s+a.slice(0,-1)+n[a.slice(-1)];else{if("object"!==(0,ju.A)(t))throw new Error("Don't know what to do with value type "+(0,ju.A)(t)+".");a=o(t)}l.push(r+a)}return l.push("}"),l.join("")},l=e.__fontmetrics__.uncompress=function(e){if("string"!=typeof e)throw new Error("Invalid argument passed to uncompress.");for(var t,r,n,s,i={},o=1,l=i,c=[],d="",u="",h=e.length-1,m=1;m<h;m+=1)"'"==(s=e[m])?t?(n=t.join(""),t=void 0):t=[]:t?t.push(s):"{"==s?(c.push([l,n]),l={},n=void 0):"}"==s?((r=c.pop())[0][r[1]]=l,n=void 0,l=r[0]):"-"==s?o=-1:void 0===n?a.hasOwnProperty(s)?(d+=a[s],n=parseInt(d,16)*o,o=1,d=""):d+=s:a.hasOwnProperty(s)?(u+=a[s],l[n]=parseInt(u,16)*o,o=1,n=void 0,u=""):u+=s;return i},c={codePages:["WinAnsiEncoding"],WinAnsiEncoding:l("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},d={Unicode:{Courier:c,"Courier-Bold":c,"Courier-BoldOblique":c,"Courier-Oblique":c,Helvetica:c,"Helvetica-Bold":c,"Helvetica-BoldOblique":c,"Helvetica-Oblique":c,"Times-Roman":c,"Times-Bold":c,"Times-BoldItalic":c,"Times-Italic":c}},u={Unicode:{"Courier-Oblique":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":l("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":l("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":l("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:l("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:l("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":l("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:l("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":l("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":l("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":l("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};e.events.push(["addFont",function(e){var t=e.font,r=u.Unicode[t.postScriptName];r&&(t.metadata.Unicode={},t.metadata.Unicode.widths=r.widths,t.metadata.Unicode.kerning=r.kerning);var a=d.Unicode[t.postScriptName];a&&(t.metadata.Unicode.encoding=a,t.encoding=a.codePages[0])}])}(px.API),function(e){var t=function(e){for(var t=e.length,r=new Uint8Array(t),a=0;a<t;a++)r[a]=e.charCodeAt(a);return r};e.API.events.push(["addFont",function(r){var a=void 0,n=r.font,s=r.instance;if(!n.isStandardFont){if(void 0===s)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+n.postScriptName+"').");if("string"!=typeof(a=!1===s.existsFileInVFS(n.postScriptName)?s.loadFile(n.postScriptName):s.getFileFromVFS(n.postScriptName)))throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+n.postScriptName+"').");!function(r,a){a=/^\x00\x01\x00\x00/.test(a)?t(a):t(Gp(a)),r.metadata=e.API.TTFFont.open(a),r.metadata.Unicode=r.metadata.Unicode||{encoding:{},kerning:{},widths:[]},r.metadata.glyIdsUsed=[0]}(n,a)}}])}(px),px.API.addSvgAsImage=function(e,t,a,n,s,i,o,l){if(isNaN(t)||isNaN(a))throw Bp.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(n)||isNaN(s))throw Bp.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var c=document.createElement("canvas");c.width=n,c.height=s;var d=c.getContext("2d");d.fillStyle="#fff",d.fillRect(0,0,c.width,c.height);var u={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},h=this;return(Rp.canvg?Promise.resolve(Rp.canvg):r.e(239).then(r.bind(r,2239))).catch(function(e){return Promise.reject(new Error("Could not load canvg: "+e))}).then(function(e){return e.default?e.default:e}).then(function(t){return t.fromString(d,e,u)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(e){return e.render(u)}).then(function(){h.addImage(c.toDataURL("image/jpeg",1),t,a,n,s,o,l)})},px.API.putTotalPages=function(e){var t,r=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(t=new RegExp(e,"g"),r=this.internal.getNumberOfPages()):(t=new RegExp(this.pdfEscape16(e,this.internal.getFont()),"g"),r=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var a=1;a<=this.internal.getNumberOfPages();a++)for(var n=0;n<this.internal.pages[a].length;n++)this.internal.pages[a][n]=this.internal.pages[a][n].replace(t,r);return this},px.API.viewerPreferences=function(e,t){var r;e=e||{},t=t||!1;var a,n,s,i={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},o=Object.keys(i),l=[],c=0,d=0,u=0;function h(e,t){var r,a=!1;for(r=0;r<e.length;r+=1)e[r]===t&&(a=!0);return a}if(void 0===this.internal.viewerpreferences&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(i)),this.internal.viewerpreferences.isSubscribed=!1),r=this.internal.viewerpreferences.configuration,"reset"===e||!0===t){var m=o.length;for(u=0;u<m;u+=1)r[o[u]].value=r[o[u]].defaultValue,r[o[u]].explicitSet=!1}if("object"===(0,ju.A)(e))for(n in e)if(s=e[n],h(o,n)&&void 0!==s){if("boolean"===r[n].type&&"boolean"==typeof s)r[n].value=s;else if("name"===r[n].type&&h(r[n].valueSet,s))r[n].value=s;else if("integer"===r[n].type&&Number.isInteger(s))r[n].value=s;else if("array"===r[n].type){for(c=0;c<s.length;c+=1)if(a=!0,1===s[c].length&&"number"==typeof s[c][0])l.push(String(s[c]-1));else if(s[c].length>1){for(d=0;d<s[c].length;d+=1)"number"!=typeof s[c][d]&&(a=!1);!0===a&&l.push([s[c][0]-1,s[c][1]-1].join(" "))}r[n].value="["+l.join(" ")+"]"}else r[n].value=r[n].defaultValue;r[n].explicitSet=!0}return!1===this.internal.viewerpreferences.isSubscribed&&(this.internal.events.subscribe("putCatalog",function(){var e,t=[];for(e in r)!0===r[e].explicitSet&&("name"===r[e].type?t.push("/"+e+" /"+r[e].value):t.push("/"+e+" "+r[e].value));0!==t.length&&this.internal.write("/ViewerPreferences\n<<\n"+t.join("\n")+"\n>>")}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=r,this},function(e){var t=function(){var e='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',t=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),r=unescape(encodeURIComponent(e)),a=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),n=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),s=unescape(encodeURIComponent("</x:xmpmeta>")),i=r.length+a.length+n.length+t.length+s.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+i+" >>"),this.internal.write("stream"),this.internal.write(t+r+a+n+s),this.internal.write("endstream"),this.internal.write("endobj")},r=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};e.addMetadata=function(e,a){return void 0===this.internal.__metadata__&&(this.internal.__metadata__={metadata:e,namespaceuri:a||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",r),this.internal.events.subscribe("postPutResources",t)),this}}(px.API),function(e){var t=e.API,r=t.pdfEscape16=function(e,t){for(var r,a=t.metadata.Unicode.widths,n=["","0","00","000","0000"],s=[""],i=0,o=e.length;i<o;++i){if(r=t.metadata.characterToGlyph(e.charCodeAt(i)),t.metadata.glyIdsUsed.push(r),t.metadata.toUnicode[r]=e.charCodeAt(i),-1==a.indexOf(r)&&(a.push(r),a.push([parseInt(t.metadata.widthOfGlyph(r),10)])),"0"==r)return s.join("");r=r.toString(16),s.push(n[4-r.length],r)}return s.join("")},a=function(e){var t,r,a,n,s,i,o;for(s="/CIDInit /ProcSet findresource begin\n12 dict begin\nbegincmap\n/CIDSystemInfo <<\n  /Registry (Adobe)\n  /Ordering (UCS)\n  /Supplement 0\n>> def\n/CMapName /Adobe-Identity-UCS def\n/CMapType 2 def\n1 begincodespacerange\n<0000><ffff>\nendcodespacerange",a=[],i=0,o=(r=Object.keys(e).sort(function(e,t){return e-t})).length;i<o;i++)t=r[i],a.length>=100&&(s+="\n"+a.length+" beginbfchar\n"+a.join("\n")+"\nendbfchar",a=[]),void 0!==e[t]&&null!==e[t]&&"function"==typeof e[t].toString&&(n=("0000"+e[t].toString(16)).slice(-4),t=("0000"+(+t).toString(16)).slice(-4),a.push("<"+t+"><"+n+">"));return a.length&&(s+="\n"+a.length+" beginbfchar\n"+a.join("\n")+"\nendbfchar\n"),s+"endcmap\nCMapName currentdict /CMap defineresource pop\nend\nend"};t.events.push(["putFont",function(t){!function(t){var r=t.font,n=t.out,s=t.newObject,i=t.putStream;if(r.metadata instanceof e.API.TTFFont&&"Identity-H"===r.encoding){for(var o=r.metadata.Unicode.widths,l=r.metadata.subset.encode(r.metadata.glyIdsUsed,1),c="",d=0;d<l.length;d++)c+=String.fromCharCode(l[d]);var u=s();i({data:c,addLength1:!0,objectId:u}),n("endobj");var h=s();i({data:a(r.metadata.toUnicode),addLength1:!0,objectId:h}),n("endobj");var m=s();n("<<"),n("/Type /FontDescriptor"),n("/FontName /"+dx(r.fontName)),n("/FontFile2 "+u+" 0 R"),n("/FontBBox "+e.API.PDFObject.convert(r.metadata.bbox)),n("/Flags "+r.metadata.flags),n("/StemV "+r.metadata.stemV),n("/ItalicAngle "+r.metadata.italicAngle),n("/Ascent "+r.metadata.ascender),n("/Descent "+r.metadata.decender),n("/CapHeight "+r.metadata.capHeight),n(">>"),n("endobj");var f=s();n("<<"),n("/Type /Font"),n("/BaseFont /"+dx(r.fontName)),n("/FontDescriptor "+m+" 0 R"),n("/W "+e.API.PDFObject.convert(o)),n("/CIDToGIDMap /Identity"),n("/DW 1000"),n("/Subtype /CIDFontType2"),n("/CIDSystemInfo"),n("<<"),n("/Supplement 0"),n("/Registry (Adobe)"),n("/Ordering ("+r.encoding+")"),n(">>"),n(">>"),n("endobj"),r.objectNumber=s(),n("<<"),n("/Type /Font"),n("/Subtype /Type0"),n("/ToUnicode "+h+" 0 R"),n("/BaseFont /"+dx(r.fontName)),n("/Encoding /"+r.encoding),n("/DescendantFonts ["+f+" 0 R]"),n(">>"),n("endobj"),r.isAlreadyPutted=!0}}(t)}]),t.events.push(["putFont",function(t){!function(t){var r=t.font,n=t.out,s=t.newObject,i=t.putStream;if(r.metadata instanceof e.API.TTFFont&&"WinAnsiEncoding"===r.encoding){for(var o=r.metadata.rawData,l="",c=0;c<o.length;c++)l+=String.fromCharCode(o[c]);var d=s();i({data:l,addLength1:!0,objectId:d}),n("endobj");var u=s();i({data:a(r.metadata.toUnicode),addLength1:!0,objectId:u}),n("endobj");var h=s();n("<<"),n("/Descent "+r.metadata.decender),n("/CapHeight "+r.metadata.capHeight),n("/StemV "+r.metadata.stemV),n("/Type /FontDescriptor"),n("/FontFile2 "+d+" 0 R"),n("/Flags 96"),n("/FontBBox "+e.API.PDFObject.convert(r.metadata.bbox)),n("/FontName /"+dx(r.fontName)),n("/ItalicAngle "+r.metadata.italicAngle),n("/Ascent "+r.metadata.ascender),n(">>"),n("endobj"),r.objectNumber=s();for(var m=0;m<r.metadata.hmtx.widths.length;m++)r.metadata.hmtx.widths[m]=parseInt(r.metadata.hmtx.widths[m]*(1e3/r.metadata.head.unitsPerEm));n("<</Subtype/TrueType/Type/Font/ToUnicode "+u+" 0 R/BaseFont/"+dx(r.fontName)+"/FontDescriptor "+h+" 0 R/Encoding/"+r.encoding+" /FirstChar 29 /LastChar 255 /Widths "+e.API.PDFObject.convert(r.metadata.hmtx.widths)+">>"),n("endobj"),r.isAlreadyPutted=!0}}(t)}]);var n=function(e){var t,a=e.text||"",n=e.x,s=e.y,i=e.options||{},o=e.mutex||{},l=o.pdfEscape,c=o.activeFontKey,d=o.fonts,u=c,h="",m=0,f="",g=d[u].encoding;if("Identity-H"!==d[u].encoding)return{text:a,x:n,y:s,options:i,mutex:o};for(f=a,u=c,Array.isArray(a)&&(f=a[0]),m=0;m<f.length;m+=1)d[u].metadata.hasOwnProperty("cmap")&&(t=d[u].metadata.cmap.unicode.codeMap[f[m].charCodeAt(0)]),t||f[m].charCodeAt(0)<256&&d[u].metadata.hasOwnProperty("Unicode")?h+=f[m]:h+="";var p="";return parseInt(u.slice(1))<14||"WinAnsiEncoding"===g?p=l(h,u).split("").map(function(e){return e.charCodeAt(0).toString(16)}).join(""):"Identity-H"===g&&(p=r(h,d[u])),o.isHex=!0,{text:p,x:n,y:s,options:i,mutex:o}};t.events.push(["postProcessText",function(e){var t=e.text||"",r=[],a={text:t,x:e.x,y:e.y,options:e.options,mutex:e.mutex};if(Array.isArray(t)){var s=0;for(s=0;s<t.length;s+=1)Array.isArray(t[s])&&3===t[s].length?r.push([n(Object.assign({},a,{text:t[s][0]})).text,t[s][1],t[s][2]]):r.push(n(Object.assign({},a,{text:t[s]})).text);e.text=r}else e.text=n(Object.assign({},a,{text:t})).text}])}(px),function(e){var t=function(){return void 0===this.internal.vFS&&(this.internal.vFS={}),!0};e.existsFileInVFS=function(e){return t.call(this),void 0!==this.internal.vFS[e]},e.addFileToVFS=function(e,r){return t.call(this),this.internal.vFS[e]=r,this},e.getFileFromVFS=function(e){return t.call(this),void 0!==this.internal.vFS[e]?this.internal.vFS[e]:null}}(px.API),function(e){e.__bidiEngine__=e.prototype.__bidiEngine__=function(e){var r,a,n,s,i,o,l,c=t,d=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],u=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],h={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},m={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},f=["(",")","(","<",">","<","[","]","[","{","}","{","\xab","\xbb","\xab","\u2039","\u203a","\u2039","\u2045","\u2046","\u2045","\u207d","\u207e","\u207d","\u208d","\u208e","\u208d","\u2264","\u2265","\u2264","\u2329","\u232a","\u2329","\ufe59","\ufe5a","\ufe59","\ufe5b","\ufe5c","\ufe5b","\ufe5d","\ufe5e","\ufe5d","\ufe64","\ufe65","\ufe64"],g=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),p=!1,x=0;this.__bidiEngine__={};var y=function(e){var t=e.charCodeAt(),r=t>>8,a=m[r];return void 0!==a?c[256*a+(255&t)]:252===r||253===r?"AL":g.test(r)?"L":8===r?"R":"N"},v=function(e){for(var t,r=0;r<e.length;r++){if("L"===(t=y(e.charAt(r))))return!1;if("R"===t)return!0}return!1},b=function(e,t,i,o){var l,c,d,u,h=t[o];switch(h){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":p=!1;break;case"N":case"AN":break;case"EN":p&&(h="AN");break;case"AL":p=!0,h="R";break;case"WS":case"BN":h="N";break;case"CS":o<1||o+1>=t.length||"EN"!==(l=i[o-1])&&"AN"!==l||"EN"!==(c=t[o+1])&&"AN"!==c?h="N":p&&(c="AN"),h=c===l?c:"N";break;case"ES":h="EN"===(l=o>0?i[o-1]:"B")&&o+1<t.length&&"EN"===t[o+1]?"EN":"N";break;case"ET":if(o>0&&"EN"===i[o-1]){h="EN";break}if(p){h="N";break}for(d=o+1,u=t.length;d<u&&"ET"===t[d];)d++;h=d<u&&"EN"===t[d]?"EN":"N";break;case"NSM":if(n&&!s){for(u=t.length,d=o+1;d<u&&"NSM"===t[d];)d++;if(d<u){var m=e[o],f=m>=1425&&m<=2303||64286===m;if(l=t[d],f&&("R"===l||"AL"===l)){h="R";break}}}h=o<1||"B"===(l=t[o-1])?"N":i[o-1];break;case"B":p=!1,r=!0,h=x;break;case"S":a=!0,h="N"}return h},w=function(e,t,r){var a=e.split("");return r&&k(a,r,{hiLevel:x}),a.reverse(),t&&t.reverse(),a.join("")},k=function(e,t,n){var s,i,o,l,c,m=-1,f=e.length,g=0,v=[],w=x?u:d,k=[];for(p=!1,r=!1,a=!1,i=0;i<f;i++)k[i]=y(e[i]);for(o=0;o<f;o++){if(c=g,v[o]=b(e,k,v,o),s=240&(g=w[c][h[v[o]]]),g&=15,t[o]=l=w[g][5],s>0)if(16===s){for(i=m;i<o;i++)t[i]=1;m=-1}else m=-1;if(w[g][6])-1===m&&(m=o);else if(m>-1){for(i=m;i<o;i++)t[i]=l;m=-1}"B"===k[o]&&(t[o]=0),n.hiLevel|=l}a&&function(e,t,r){for(var a=0;a<r;a++)if("S"===e[a]){t[a]=x;for(var n=a-1;n>=0&&"WS"===e[n];n--)t[n]=x}}(k,t,f)},N=function(e,t,a,n,s){if(!(s.hiLevel<e)){if(1===e&&1===x&&!r)return t.reverse(),void(a&&a.reverse());for(var i,o,l,c,d=t.length,u=0;u<d;){if(n[u]>=e){for(l=u+1;l<d&&n[l]>=e;)l++;for(c=u,o=l-1;c<o;c++,o--)i=t[c],t[c]=t[o],t[o]=i,a&&(i=a[c],a[c]=a[o],a[o]=i);u=l}u++}}},j=function(e,t,r){var a=e.split(""),n={hiLevel:x};return r||(r=[]),k(a,r,n),function(e,t,r){if(0!==r.hiLevel&&l)for(var a,n=0;n<e.length;n++)1===t[n]&&(a=f.indexOf(e[n]))>=0&&(e[n]=f[a+1])}(a,r,n),N(2,a,t,r,n),N(1,a,t,r,n),a.join("")};return this.__bidiEngine__.doBidiReorder=function(e,t,r){if(function(e,t){if(t)for(var r=0;r<e.length;r++)t[r]=r;void 0===s&&(s=v(e)),void 0===o&&(o=v(e))}(e,t),n||!i||o)if(n&&i&&s^o)x=s?1:0,e=w(e,t,r);else if(!n&&i&&o)x=s?1:0,e=j(e,t,r),e=w(e,t);else if(!n||s||i||o){if(n&&!i&&s^o)e=w(e,t),s?(x=0,e=j(e,t,r)):(x=1,e=j(e,t,r),e=w(e,t));else if(n&&s&&!i&&o)x=1,e=j(e,t,r),e=w(e,t);else if(!n&&!i&&s^o){var a=l;s?(x=1,e=j(e,t,r),x=0,l=!1,e=j(e,t,r),l=a):(x=0,e=j(e,t,r),e=w(e,t),x=1,l=!1,e=j(e,t,r),l=a,e=w(e,t))}}else x=0,e=j(e,t,r);else x=s?1:0,e=j(e,t,r);return e},this.__bidiEngine__.setOptions=function(e){e&&(n=e.isInputVisual,i=e.isOutputVisual,s=e.isInputRtl,o=e.isOutputRtl,l=e.isSymmetricSwapping)},this.__bidiEngine__.setOptions(e),this.__bidiEngine__};var t=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],r=new e.__bidiEngine__({isInputVisual:!0});e.API.events.push(["postProcessText",function(e){var t=e.text;e.x,e.y;var a=e.options||{};e.mutex,a.lang;var n=[];if(a.isInputVisual="boolean"!=typeof a.isInputVisual||a.isInputVisual,r.setOptions(a),"[object Array]"===Object.prototype.toString.call(t)){var s=0;for(n=[],s=0;s<t.length;s+=1)"[object Array]"===Object.prototype.toString.call(t[s])?n.push([r.doBidiReorder(t[s][0]),t[s][1],t[s][2]]):n.push([r.doBidiReorder(t[s])]);e.text=n}else e.text=r.doBidiReorder(t);r.setOptions({isInputVisual:!0})}])}(px),px.API.TTFFont=function(){function e(e){var t;if(this.rawData=e,t=this.contents=new Hy(e),this.contents.pos=4,"ttcf"===t.readString(4))throw new Error("TTCF not supported.");t.pos=0,this.parse(),this.subset=new cv(this),this.registerTTF()}return e.open=function(t){return new e(t)},e.prototype.parse=function(){return this.directory=new Gy(this.contents),this.head=new Qy(this),this.name=new tv(this),this.cmap=new Xy(this),this.toUnicode={},this.hhea=new Jy(this),this.maxp=new rv(this),this.hmtx=new av(this),this.post=new $y(this),this.os2=new Zy(this),this.loca=new lv(this),this.glyf=new sv(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},e.prototype.registerTTF=function(){var e,t,r,a,n;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=function(){var t,r,a,n;for(n=[],t=0,r=(a=this.bbox).length;t<r;t++)e=a[t],n.push(Math.round(e*this.scaleFactor));return n}.call(this),this.stemV=0,this.post.exists?(r=255&(a=this.post.italic_angle),32768&(t=a>>16)&&(t=-(1+(65535^t))),this.italicAngle=+(t+"."+r)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=1===(n=this.familyClass)||2===n||3===n||4===n||5===n||7===n,this.isScript=10===this.familyClass,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),0!==this.italicAngle&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},e.prototype.characterToGlyph=function(e){var t;return(null!=(t=this.cmap.unicode)?t.codeMap[e]:void 0)||0},e.prototype.widthOfGlyph=function(e){var t;return t=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(e).advance*t},e.prototype.widthOfString=function(e,t,r){var a,n,s,i;for(s=0,n=0,i=(e=""+e).length;0<=i?n<i:n>i;n=0<=i?++n:--n)a=e.charCodeAt(n),s+=this.widthOfGlyph(this.characterToGlyph(a))+r*(1e3/t)||0;return s*(t/1e3)},e.prototype.lineHeight=function(e,t){var r;return null==t&&(t=!1),r=t?this.lineGap:0,(this.ascender+r-this.decender)/1e3*e},e}();var qy,Hy=function(){function e(e){this.data=null!=e?e:[],this.pos=0,this.length=this.data.length}return e.prototype.readByte=function(){return this.data[this.pos++]},e.prototype.writeByte=function(e){return this.data[this.pos++]=e},e.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},e.prototype.writeUInt32=function(e){return this.writeByte(e>>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e)},e.prototype.readInt32=function(){var e;return(e=this.readUInt32())>=2147483648?e-4294967296:e},e.prototype.writeInt32=function(e){return e<0&&(e+=4294967296),this.writeUInt32(e)},e.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},e.prototype.writeUInt16=function(e){return this.writeByte(e>>8&255),this.writeByte(255&e)},e.prototype.readInt16=function(){var e;return(e=this.readUInt16())>=32768?e-65536:e},e.prototype.writeInt16=function(e){return e<0&&(e+=65536),this.writeUInt16(e)},e.prototype.readString=function(e){var t,r;for(r=[],t=0;0<=e?t<e:t>e;t=0<=e?++t:--t)r[t]=String.fromCharCode(this.readByte());return r.join("")},e.prototype.writeString=function(e){var t,r,a;for(a=[],t=0,r=e.length;0<=r?t<r:t>r;t=0<=r?++t:--t)a.push(this.writeByte(e.charCodeAt(t)));return a},e.prototype.readShort=function(){return this.readInt16()},e.prototype.writeShort=function(e){return this.writeInt16(e)},e.prototype.readLongLong=function(){var e,t,r,a,n,s,i,o;return e=this.readByte(),t=this.readByte(),r=this.readByte(),a=this.readByte(),n=this.readByte(),s=this.readByte(),i=this.readByte(),o=this.readByte(),128&e?-1*(72057594037927940*(255^e)+281474976710656*(255^t)+1099511627776*(255^r)+4294967296*(255^a)+16777216*(255^n)+65536*(255^s)+256*(255^i)+(255^o)+1):72057594037927940*e+281474976710656*t+1099511627776*r+4294967296*a+16777216*n+65536*s+256*i+o},e.prototype.writeLongLong=function(e){var t,r;return t=Math.floor(e/4294967296),r=4294967295&e,this.writeByte(t>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t),this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r)},e.prototype.readInt=function(){return this.readInt32()},e.prototype.writeInt=function(e){return this.writeInt32(e)},e.prototype.read=function(e){var t,r;for(t=[],r=0;0<=e?r<e:r>e;r=0<=e?++r:--r)t.push(this.readByte());return t},e.prototype.write=function(e){var t,r,a,n;for(n=[],r=0,a=e.length;r<a;r++)t=e[r],n.push(this.writeByte(t));return n},e}(),Gy=function(){var e;function t(e){var t,r,a;for(this.scalarType=e.readInt(),this.tableCount=e.readShort(),this.searchRange=e.readShort(),this.entrySelector=e.readShort(),this.rangeShift=e.readShort(),this.tables={},r=0,a=this.tableCount;0<=a?r<a:r>a;r=0<=a?++r:--r)t={tag:e.readString(4),checksum:e.readInt(),offset:e.readInt(),length:e.readInt()},this.tables[t.tag]=t}return t.prototype.encode=function(t){var r,a,n,s,i,o,l,c,d,u,h,m,f;for(f in h=Object.keys(t).length,o=Math.log(2),d=16*Math.floor(Math.log(h)/o),s=Math.floor(d/o),c=16*h-d,(a=new Hy).writeInt(this.scalarType),a.writeShort(h),a.writeShort(d),a.writeShort(s),a.writeShort(c),n=16*h,l=a.pos+n,i=null,m=[],t)for(u=t[f],a.writeString(f),a.writeInt(e(u)),a.writeInt(l),a.writeInt(u.length),m=m.concat(u),"head"===f&&(i=l),l+=u.length;l%4;)m.push(0),l++;return a.write(m),r=2981146554-e(a.data),a.pos=i+8,a.writeUInt32(r),a.data},e=function(e){var t,r,a,n;for(e=nv.call(e);e.length%4;)e.push(0);for(a=new Hy(e),r=0,t=0,n=e.length;t<n;t=t+=4)r+=a.readUInt32();return 4294967295&r},t}(),Wy={}.hasOwnProperty,Ky=function(e,t){for(var r in t)Wy.call(t,r)&&(e[r]=t[r]);function a(){this.constructor=e}return a.prototype=t.prototype,e.prototype=new a,e.__super__=t.prototype,e};qy=function(){function e(e){var t;this.file=e,t=this.file.directory.tables[this.tag],this.exists=!!t,t&&(this.offset=t.offset,this.length=t.length,this.parse(this.file.contents))}return e.prototype.parse=function(){},e.prototype.encode=function(){},e.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},e}();var Qy=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Ky(e,qy),e.prototype.tag="head",e.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.revision=e.readInt(),this.checkSumAdjustment=e.readInt(),this.magicNumber=e.readInt(),this.flags=e.readShort(),this.unitsPerEm=e.readShort(),this.created=e.readLongLong(),this.modified=e.readLongLong(),this.xMin=e.readShort(),this.yMin=e.readShort(),this.xMax=e.readShort(),this.yMax=e.readShort(),this.macStyle=e.readShort(),this.lowestRecPPEM=e.readShort(),this.fontDirectionHint=e.readShort(),this.indexToLocFormat=e.readShort(),this.glyphDataFormat=e.readShort()},e.prototype.encode=function(e){var t;return(t=new Hy).writeInt(this.version),t.writeInt(this.revision),t.writeInt(this.checkSumAdjustment),t.writeInt(this.magicNumber),t.writeShort(this.flags),t.writeShort(this.unitsPerEm),t.writeLongLong(this.created),t.writeLongLong(this.modified),t.writeShort(this.xMin),t.writeShort(this.yMin),t.writeShort(this.xMax),t.writeShort(this.yMax),t.writeShort(this.macStyle),t.writeShort(this.lowestRecPPEM),t.writeShort(this.fontDirectionHint),t.writeShort(e),t.writeShort(this.glyphDataFormat),t.data},e}(),Yy=function(){function e(e,t){var r,a,n,s,i,o,l,c,d,u,h,m,f,g,p,x,y;switch(this.platformID=e.readUInt16(),this.encodingID=e.readShort(),this.offset=t+e.readInt(),d=e.pos,e.pos=this.offset,this.format=e.readUInt16(),this.length=e.readUInt16(),this.language=e.readUInt16(),this.isUnicode=3===this.platformID&&1===this.encodingID&&4===this.format||0===this.platformID&&4===this.format,this.codeMap={},this.format){case 0:for(o=0;o<256;++o)this.codeMap[o]=e.readByte();break;case 4:for(h=e.readUInt16(),u=h/2,e.pos+=6,n=function(){var t,r;for(r=[],o=t=0;0<=u?t<u:t>u;o=0<=u?++t:--t)r.push(e.readUInt16());return r}(),e.pos+=2,f=function(){var t,r;for(r=[],o=t=0;0<=u?t<u:t>u;o=0<=u?++t:--t)r.push(e.readUInt16());return r}(),l=function(){var t,r;for(r=[],o=t=0;0<=u?t<u:t>u;o=0<=u?++t:--t)r.push(e.readUInt16());return r}(),c=function(){var t,r;for(r=[],o=t=0;0<=u?t<u:t>u;o=0<=u?++t:--t)r.push(e.readUInt16());return r}(),a=(this.length-e.pos+this.offset)/2,i=function(){var t,r;for(r=[],o=t=0;0<=a?t<a:t>a;o=0<=a?++t:--t)r.push(e.readUInt16());return r}(),o=p=0,y=n.length;p<y;o=++p)for(g=n[o],r=x=m=f[o];m<=g?x<=g:x>=g;r=m<=g?++x:--x)0===c[o]?s=r+l[o]:0!==(s=i[c[o]/2+(r-m)-(u-o)]||0)&&(s+=l[o]),this.codeMap[r]=65535&s}e.pos=d}return e.encode=function(e,t){var r,a,n,s,i,o,l,c,d,u,h,m,f,g,p,x,y,v,b,w,k,N,j,S,_,E,A,C,I,T,D,P,F,L,M,R,O,B,z,U,V,q,H,G,W,K;switch(C=new Hy,s=Object.keys(e).sort(function(e,t){return e-t}),t){case"macroman":for(f=0,g=function(){var e=[];for(m=0;m<256;++m)e.push(0);return e}(),x={0:0},n={},I=0,F=s.length;I<F;I++)null==x[H=e[a=s[I]]]&&(x[H]=++f),n[a]={old:e[a],new:x[e[a]]},g[a]=x[e[a]];return C.writeUInt16(1),C.writeUInt16(0),C.writeUInt32(12),C.writeUInt16(0),C.writeUInt16(262),C.writeUInt16(0),C.write(g),{charMap:n,subtable:C.data,maxGlyphID:f+1};case"unicode":for(E=[],d=[],y=0,x={},r={},p=l=null,T=0,L=s.length;T<L;T++)null==x[b=e[a=s[T]]]&&(x[b]=++y),r[a]={old:b,new:x[b]},i=x[b]-a,null!=p&&i===l||(p&&d.push(p),E.push(a),l=i),p=a;for(p&&d.push(p),d.push(65535),E.push(65535),S=2*(j=E.length),N=2*Math.pow(Math.log(j)/Math.LN2,2),u=Math.log(N/2)/Math.LN2,k=2*j-N,o=[],w=[],h=[],m=D=0,M=E.length;D<M;m=++D){if(_=E[m],c=d[m],65535===_){o.push(0),w.push(0);break}if(_-(A=r[_].new)>=32768)for(o.push(0),w.push(2*(h.length+j-m)),a=P=_;_<=c?P<=c:P>=c;a=_<=c?++P:--P)h.push(r[a].new);else o.push(A-_),w.push(0)}for(C.writeUInt16(3),C.writeUInt16(1),C.writeUInt32(12),C.writeUInt16(4),C.writeUInt16(16+8*j+2*h.length),C.writeUInt16(0),C.writeUInt16(S),C.writeUInt16(N),C.writeUInt16(u),C.writeUInt16(k),V=0,R=d.length;V<R;V++)a=d[V],C.writeUInt16(a);for(C.writeUInt16(0),q=0,O=E.length;q<O;q++)a=E[q],C.writeUInt16(a);for(G=0,B=o.length;G<B;G++)i=o[G],C.writeUInt16(i);for(W=0,z=w.length;W<z;W++)v=w[W],C.writeUInt16(v);for(K=0,U=h.length;K<U;K++)f=h[K],C.writeUInt16(f);return{charMap:r,subtable:C.data,maxGlyphID:y+1}}},e}(),Xy=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Ky(e,qy),e.prototype.tag="cmap",e.prototype.parse=function(e){var t,r,a;for(e.pos=this.offset,this.version=e.readUInt16(),a=e.readUInt16(),this.tables=[],this.unicode=null,r=0;0<=a?r<a:r>a;r=0<=a?++r:--r)t=new Yy(e,this.offset),this.tables.push(t),t.isUnicode&&null==this.unicode&&(this.unicode=t);return!0},e.encode=function(e,t){var r,a;return null==t&&(t="macroman"),r=Yy.encode(e,t),(a=new Hy).writeUInt16(0),a.writeUInt16(1),r.table=a.data.concat(r.subtable),r},e}(),Jy=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Ky(e,qy),e.prototype.tag="hhea",e.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.ascender=e.readShort(),this.decender=e.readShort(),this.lineGap=e.readShort(),this.advanceWidthMax=e.readShort(),this.minLeftSideBearing=e.readShort(),this.minRightSideBearing=e.readShort(),this.xMaxExtent=e.readShort(),this.caretSlopeRise=e.readShort(),this.caretSlopeRun=e.readShort(),this.caretOffset=e.readShort(),e.pos+=8,this.metricDataFormat=e.readShort(),this.numberOfMetrics=e.readUInt16()},e}(),Zy=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Ky(e,qy),e.prototype.tag="OS/2",e.prototype.parse=function(e){if(e.pos=this.offset,this.version=e.readUInt16(),this.averageCharWidth=e.readShort(),this.weightClass=e.readUInt16(),this.widthClass=e.readUInt16(),this.type=e.readShort(),this.ySubscriptXSize=e.readShort(),this.ySubscriptYSize=e.readShort(),this.ySubscriptXOffset=e.readShort(),this.ySubscriptYOffset=e.readShort(),this.ySuperscriptXSize=e.readShort(),this.ySuperscriptYSize=e.readShort(),this.ySuperscriptXOffset=e.readShort(),this.ySuperscriptYOffset=e.readShort(),this.yStrikeoutSize=e.readShort(),this.yStrikeoutPosition=e.readShort(),this.familyClass=e.readShort(),this.panose=function(){var t,r;for(r=[],t=0;t<10;++t)r.push(e.readByte());return r}(),this.charRange=function(){var t,r;for(r=[],t=0;t<4;++t)r.push(e.readInt());return r}(),this.vendorID=e.readString(4),this.selection=e.readShort(),this.firstCharIndex=e.readShort(),this.lastCharIndex=e.readShort(),this.version>0&&(this.ascent=e.readShort(),this.descent=e.readShort(),this.lineGap=e.readShort(),this.winAscent=e.readShort(),this.winDescent=e.readShort(),this.codePageRange=function(){var t,r;for(r=[],t=0;t<2;t=++t)r.push(e.readInt());return r}(),this.version>1))return this.xHeight=e.readShort(),this.capHeight=e.readShort(),this.defaultChar=e.readShort(),this.breakChar=e.readShort(),this.maxContext=e.readShort()},e}(),$y=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Ky(e,qy),e.prototype.tag="post",e.prototype.parse=function(e){var t,r,a;switch(e.pos=this.offset,this.format=e.readInt(),this.italicAngle=e.readInt(),this.underlinePosition=e.readShort(),this.underlineThickness=e.readShort(),this.isFixedPitch=e.readInt(),this.minMemType42=e.readInt(),this.maxMemType42=e.readInt(),this.minMemType1=e.readInt(),this.maxMemType1=e.readInt(),this.format){case 65536:case 196608:break;case 131072:var n;for(r=e.readUInt16(),this.glyphNameIndex=[],n=0;0<=r?n<r:n>r;n=0<=r?++n:--n)this.glyphNameIndex.push(e.readUInt16());for(this.names=[],a=[];e.pos<this.offset+this.length;)t=e.readByte(),a.push(this.names.push(e.readString(t)));return a;case 151552:return r=e.readUInt16(),this.offsets=e.read(r);case 262144:return this.map=function(){var t,r,a;for(a=[],n=t=0,r=this.file.maxp.numGlyphs;0<=r?t<r:t>r;n=0<=r?++t:--t)a.push(e.readUInt32());return a}.call(this)}},e}(),ev=function(e,t){this.raw=e,this.length=e.length,this.platformID=t.platformID,this.encodingID=t.encodingID,this.languageID=t.languageID},tv=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Ky(e,qy),e.prototype.tag="name",e.prototype.parse=function(e){var t,r,a,n,s,i,o,l,c,d,u;for(e.pos=this.offset,e.readShort(),t=e.readShort(),i=e.readShort(),r=[],n=0;0<=t?n<t:n>t;n=0<=t?++n:--n)r.push({platformID:e.readShort(),encodingID:e.readShort(),languageID:e.readShort(),nameID:e.readShort(),length:e.readShort(),offset:this.offset+i+e.readShort()});for(o={},n=c=0,d=r.length;c<d;n=++c)a=r[n],e.pos=a.offset,l=e.readString(a.length),s=new ev(l,a),null==o[u=a.nameID]&&(o[u]=[]),o[a.nameID].push(s);this.strings=o,this.copyright=o[0],this.fontFamily=o[1],this.fontSubfamily=o[2],this.uniqueSubfamily=o[3],this.fontName=o[4],this.version=o[5];try{this.postscriptName=o[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch(Gp){this.postscriptName=o[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=o[7],this.manufacturer=o[8],this.designer=o[9],this.description=o[10],this.vendorUrl=o[11],this.designerUrl=o[12],this.license=o[13],this.licenseUrl=o[14],this.preferredFamily=o[15],this.preferredSubfamily=o[17],this.compatibleFull=o[18],this.sampleText=o[19]},e}(),rv=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Ky(e,qy),e.prototype.tag="maxp",e.prototype.parse=function(e){return e.pos=this.offset,this.version=e.readInt(),this.numGlyphs=e.readUInt16(),this.maxPoints=e.readUInt16(),this.maxContours=e.readUInt16(),this.maxCompositePoints=e.readUInt16(),this.maxComponentContours=e.readUInt16(),this.maxZones=e.readUInt16(),this.maxTwilightPoints=e.readUInt16(),this.maxStorage=e.readUInt16(),this.maxFunctionDefs=e.readUInt16(),this.maxInstructionDefs=e.readUInt16(),this.maxStackElements=e.readUInt16(),this.maxSizeOfInstructions=e.readUInt16(),this.maxComponentElements=e.readUInt16(),this.maxComponentDepth=e.readUInt16()},e}(),av=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Ky(e,qy),e.prototype.tag="hmtx",e.prototype.parse=function(e){var t,r,a,n,s,i,o;for(e.pos=this.offset,this.metrics=[],t=0,i=this.file.hhea.numberOfMetrics;0<=i?t<i:t>i;t=0<=i?++t:--t)this.metrics.push({advance:e.readUInt16(),lsb:e.readInt16()});for(a=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var r,n;for(n=[],t=r=0;0<=a?r<a:r>a;t=0<=a?++r:--r)n.push(e.readInt16());return n}(),this.widths=function(){var e,t,r,a;for(a=[],e=0,t=(r=this.metrics).length;e<t;e++)n=r[e],a.push(n.advance);return a}.call(this),r=this.widths[this.widths.length-1],o=[],t=s=0;0<=a?s<a:s>a;t=0<=a?++s:--s)o.push(this.widths.push(r));return o},e.prototype.forGlyph=function(e){return e in this.metrics?this.metrics[e]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[e-this.metrics.length]}},e}(),nv=[].slice,sv=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Ky(e,qy),e.prototype.tag="glyf",e.prototype.parse=function(){return this.cache={}},e.prototype.glyphFor=function(e){var t,r,a,n,s,i,o,l,c,d;return e in this.cache?this.cache[e]:(n=this.file.loca,t=this.file.contents,r=n.indexOf(e),0===(a=n.lengthOf(e))?this.cache[e]=null:(t.pos=this.offset+r,s=(i=new Hy(t.read(a))).readShort(),l=i.readShort(),d=i.readShort(),o=i.readShort(),c=i.readShort(),this.cache[e]=-1===s?new ov(i,l,d,o,c):new iv(i,s,l,d,o,c),this.cache[e]))},e.prototype.encode=function(e,t,r){var a,n,s,i,o;for(s=[],n=[],i=0,o=t.length;i<o;i++)a=e[t[i]],n.push(s.length),a&&(s=s.concat(a.encode(r)));return n.push(s.length),{table:s,offsets:n}},e}(),iv=function(){function e(e,t,r,a,n,s){this.raw=e,this.numberOfContours=t,this.xMin=r,this.yMin=a,this.xMax=n,this.yMax=s,this.compound=!1}return e.prototype.encode=function(){return this.raw.data},e}(),ov=function(){function e(e,t,r,a,n){var s,i;for(this.raw=e,this.xMin=t,this.yMin=r,this.xMax=a,this.yMax=n,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],s=this.raw;i=s.readShort(),this.glyphOffsets.push(s.pos),this.glyphIDs.push(s.readUInt16()),32&i;)s.pos+=1&i?4:2,128&i?s.pos+=8:64&i?s.pos+=4:8&i&&(s.pos+=2)}return e.prototype.encode=function(){var e,t,r;for(t=new Hy(nv.call(this.raw.data)),e=0,r=this.glyphIDs.length;e<r;++e)t.pos=this.glyphOffsets[e];return t.data},e}(),lv=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Ky(e,qy),e.prototype.tag="loca",e.prototype.parse=function(e){var t,r;return e.pos=this.offset,t=this.file.head.indexToLocFormat,this.offsets=0===t?function(){var t,a;for(a=[],r=0,t=this.length;r<t;r+=2)a.push(2*e.readUInt16());return a}.call(this):function(){var t,a;for(a=[],r=0,t=this.length;r<t;r+=4)a.push(e.readUInt32());return a}.call(this)},e.prototype.indexOf=function(e){return this.offsets[e]},e.prototype.lengthOf=function(e){return this.offsets[e+1]-this.offsets[e]},e.prototype.encode=function(e,t){for(var r=new Uint32Array(this.offsets.length),a=0,n=0,s=0;s<r.length;++s)if(r[s]=a,n<t.length&&t[n]==s){++n,r[s]=a;var i=this.offsets[s],o=this.offsets[s+1]-i;o>0&&(a+=o)}for(var l=new Array(4*r.length),c=0;c<r.length;++c)l[4*c+3]=255&r[c],l[4*c+2]=(65280&r[c])>>8,l[4*c+1]=(16711680&r[c])>>16,l[4*c]=(4278190080&r[c])>>24;return l},e}(),cv=function(){function e(e){this.font=e,this.subset={},this.unicodes={},this.next=33}return e.prototype.generateCmap=function(){var e,t,r,a,n;for(t in a=this.font.cmap.tables[0].codeMap,e={},n=this.subset)r=n[t],e[t]=a[r];return e},e.prototype.glyphsFor=function(e){var t,r,a,n,s,i,o;for(a={},s=0,i=e.length;s<i;s++)a[n=e[s]]=this.font.glyf.glyphFor(n);for(n in t=[],a)(null!=(r=a[n])?r.compound:void 0)&&t.push.apply(t,r.glyphIDs);if(t.length>0)for(n in o=this.glyphsFor(t))r=o[n],a[n]=r;return a},e.prototype.encode=function(e,t){var r,a,n,s,i,o,l,c,d,u,h,m,f,g,p;for(a in r=Xy.encode(this.generateCmap(),"unicode"),s=this.glyphsFor(e),h={0:0},p=r.charMap)h[(o=p[a]).old]=o.new;for(m in u=r.maxGlyphID,s)m in h||(h[m]=u++);return c=function(e){var t,r;for(t in r={},e)r[e[t]]=t;return r}(h),d=Object.keys(c).sort(function(e,t){return e-t}),f=function(){var e,t,r;for(r=[],e=0,t=d.length;e<t;e++)i=d[e],r.push(c[i]);return r}(),n=this.font.glyf.encode(s,f,h),l=this.font.loca.encode(n.offsets,f),g={cmap:this.font.cmap.raw(),glyf:n.table,loca:l,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(t)},this.font.os2.exists&&(g["OS/2"]=this.font.os2.raw()),this.font.directory.encode(g)},e}();px.API.PDFObject=function(){var e;function t(){}return e=function(e,t){return(Array(t+1).join("0")+e).slice(-t)},t.convert=function(r){var a,n,s,i;if(Array.isArray(r))return"["+function(){var e,n,s;for(s=[],e=0,n=r.length;e<n;e++)a=r[e],s.push(t.convert(a));return s}().join(" ")+"]";if("string"==typeof r)return"/"+r;if(null!=r?r.isString:void 0)return"("+r+")";if(r instanceof Date)return"(D:"+e(r.getUTCFullYear(),4)+e(r.getUTCMonth(),2)+e(r.getUTCDate(),2)+e(r.getUTCHours(),2)+e(r.getUTCMinutes(),2)+e(r.getUTCSeconds(),2)+"Z)";if("[object Object]"==={}.toString.call(r)){for(n in s=["<<"],r)i=r[n],s.push("/"+n+" "+t.convert(i));return s.push(">>"),s.join("\n")}return""+r},t}();const dv={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}};function uv(e){return function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const r=t.width?String(t.width):e.defaultWidth;return e.formats[r]||e.formats[e.defaultWidth]}}const hv={date:uv({formats:{full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},defaultWidth:"full"}),time:uv({formats:{full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},defaultWidth:"full"}),dateTime:uv({formats:{full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},defaultWidth:"full"})},mv={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"};function fv(e){return(t,r)=>{let a;if("formatting"===(null!==r&&void 0!==r&&r.context?String(r.context):"standalone")&&e.formattingValues){const t=e.defaultFormattingWidth||e.defaultWidth,n=null!==r&&void 0!==r&&r.width?String(r.width):t;a=e.formattingValues[n]||e.formattingValues[t]}else{const t=e.defaultWidth,n=null!==r&&void 0!==r&&r.width?String(r.width):e.defaultWidth;a=e.values[n]||e.values[t]}return a[e.argumentCallback?e.argumentCallback(t):t]}}const gv={ordinalNumber:(e,t)=>{const r=Number(e),a=r%100;if(a>20||a<10)switch(a%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},era:fv({values:{narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},defaultWidth:"wide"}),quarter:fv({values:{narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},defaultWidth:"wide",argumentCallback:e=>e-1}),month:fv({values:{narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},defaultWidth:"wide"}),day:fv({values:{narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},defaultWidth:"wide"}),dayPeriod:fv({values:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},defaultWidth:"wide",formattingValues:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},defaultFormattingWidth:"wide"})};function pv(e){return function(t){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const a=r.width,n=a&&e.matchPatterns[a]||e.matchPatterns[e.defaultMatchWidth],s=t.match(n);if(!s)return null;const i=s[0],o=a&&e.parsePatterns[a]||e.parsePatterns[e.defaultParseWidth],l=Array.isArray(o)?function(e,t){for(let r=0;r<e.length;r++)if(t(e[r]))return r;return}(o,e=>e.test(i)):function(e,t){for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t(e[r]))return r;return}(o,e=>e.test(i));let c;c=e.valueCallback?e.valueCallback(l):l,c=r.valueCallback?r.valueCallback(c):c;return{value:c,rest:t.slice(i.length)}}}function xv(e){return function(t){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const a=t.match(e.matchPattern);if(!a)return null;const n=a[0],s=t.match(e.parsePattern);if(!s)return null;let i=e.valueCallback?e.valueCallback(s[0]):s[0];i=r.valueCallback?r.valueCallback(i):i;return{value:i,rest:t.slice(n.length)}}}const yv={code:"en-US",formatDistance:(e,t,r)=>{let a;const n=dv[e];return a="string"===typeof n?n:1===t?n.one:n.other.replace("{{count}}",t.toString()),null!==r&&void 0!==r&&r.addSuffix?r.comparison&&r.comparison>0?"in "+a:a+" ago":a},formatLong:hv,formatRelative:(e,t,r,a)=>mv[e],localize:gv,match:{ordinalNumber:xv({matchPattern:/^(\d+)(th|st|nd|rd)?/i,parsePattern:/\d+/i,valueCallback:e=>parseInt(e,10)}),era:pv({matchPatterns:{narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},defaultMatchWidth:"wide",parsePatterns:{any:[/^b/i,/^(a|c)/i]},defaultParseWidth:"any"}),quarter:pv({matchPatterns:{narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},defaultMatchWidth:"wide",parsePatterns:{any:[/1/i,/2/i,/3/i,/4/i]},defaultParseWidth:"any",valueCallback:e=>e+1}),month:pv({matchPatterns:{narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},defaultParseWidth:"any"}),day:pv({matchPatterns:{narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},defaultParseWidth:"any"}),dayPeriod:pv({matchPatterns:{narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},defaultMatchWidth:"any",parsePatterns:{any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},defaultParseWidth:"any"})},options:{weekStartsOn:0,firstWeekContainsDate:1}};let vv={};function bv(){return vv}Math.pow(10,8);const wv=6048e5,kv=43200,Nv=Symbol.for("constructDateFrom");function jv(e,t){return"function"===typeof e?e(t):e&&"object"===typeof e&&Nv in e?e[Nv](t):e instanceof Date?new e.constructor(t):new Date(t)}function Sv(e,t){return jv(t||e,e)}function _v(e){const t=Sv(e),r=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return r.setUTCFullYear(t.getFullYear()),+e-+r}function Ev(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];const n=jv.bind(null,e||r.find(e=>"object"===typeof e));return r.map(n)}function Av(e,t){const r=Sv(e,null===t||void 0===t?void 0:t.in);return r.setHours(0,0,0,0),r}function Cv(e,t,r){const[a,n]=Ev(null===r||void 0===r?void 0:r.in,e,t),s=Av(a),i=Av(n),o=+s-_v(s),l=+i-_v(i);return Math.round((o-l)/864e5)}function Iv(e,t){const r=Sv(e,null===t||void 0===t?void 0:t.in);return r.setFullYear(r.getFullYear(),0,1),r.setHours(0,0,0,0),r}function Tv(e,t){const r=Sv(e,null===t||void 0===t?void 0:t.in);return Cv(r,Iv(r))+1}function Dv(e,t){var r,a,n,s,i,o;const l=bv(),c=null!==(r=null!==(a=null!==(n=null!==(s=null===t||void 0===t?void 0:t.weekStartsOn)&&void 0!==s?s:null===t||void 0===t||null===(i=t.locale)||void 0===i||null===(i=i.options)||void 0===i?void 0:i.weekStartsOn)&&void 0!==n?n:l.weekStartsOn)&&void 0!==a?a:null===(o=l.locale)||void 0===o||null===(o=o.options)||void 0===o?void 0:o.weekStartsOn)&&void 0!==r?r:0,d=Sv(e,null===t||void 0===t?void 0:t.in),u=d.getDay(),h=(u<c?7:0)+u-c;return d.setDate(d.getDate()-h),d.setHours(0,0,0,0),d}function Pv(e,t){return Dv(e,(0,n.A)((0,n.A)({},t),{},{weekStartsOn:1}))}function Fv(e,t){const r=Sv(e,null===t||void 0===t?void 0:t.in),a=r.getFullYear(),n=jv(r,0);n.setFullYear(a+1,0,4),n.setHours(0,0,0,0);const s=Pv(n),i=jv(r,0);i.setFullYear(a,0,4),i.setHours(0,0,0,0);const o=Pv(i);return r.getTime()>=s.getTime()?a+1:r.getTime()>=o.getTime()?a:a-1}function Lv(e,t){const r=Fv(e,t),a=jv((null===t||void 0===t?void 0:t.in)||e,0);return a.setFullYear(r,0,4),a.setHours(0,0,0,0),Pv(a)}function Mv(e,t){const r=Sv(e,null===t||void 0===t?void 0:t.in),a=+Pv(r)-+Lv(r);return Math.round(a/wv)+1}function Rv(e,t){var r,a,n,s,i,o;const l=Sv(e,null===t||void 0===t?void 0:t.in),c=l.getFullYear(),d=bv(),u=null!==(r=null!==(a=null!==(n=null!==(s=null===t||void 0===t?void 0:t.firstWeekContainsDate)&&void 0!==s?s:null===t||void 0===t||null===(i=t.locale)||void 0===i||null===(i=i.options)||void 0===i?void 0:i.firstWeekContainsDate)&&void 0!==n?n:d.firstWeekContainsDate)&&void 0!==a?a:null===(o=d.locale)||void 0===o||null===(o=o.options)||void 0===o?void 0:o.firstWeekContainsDate)&&void 0!==r?r:1,h=jv((null===t||void 0===t?void 0:t.in)||e,0);h.setFullYear(c+1,0,u),h.setHours(0,0,0,0);const m=Dv(h,t),f=jv((null===t||void 0===t?void 0:t.in)||e,0);f.setFullYear(c,0,u),f.setHours(0,0,0,0);const g=Dv(f,t);return+l>=+m?c+1:+l>=+g?c:c-1}function Ov(e,t){var r,a,n,s,i,o;const l=bv(),c=null!==(r=null!==(a=null!==(n=null!==(s=null===t||void 0===t?void 0:t.firstWeekContainsDate)&&void 0!==s?s:null===t||void 0===t||null===(i=t.locale)||void 0===i||null===(i=i.options)||void 0===i?void 0:i.firstWeekContainsDate)&&void 0!==n?n:l.firstWeekContainsDate)&&void 0!==a?a:null===(o=l.locale)||void 0===o||null===(o=o.options)||void 0===o?void 0:o.firstWeekContainsDate)&&void 0!==r?r:1,d=Rv(e,t),u=jv((null===t||void 0===t?void 0:t.in)||e,0);u.setFullYear(d,0,c),u.setHours(0,0,0,0);return Dv(u,t)}function Bv(e,t){const r=Sv(e,null===t||void 0===t?void 0:t.in),a=+Dv(r,t)-+Ov(r,t);return Math.round(a/wv)+1}function zv(e,t){return(e<0?"-":"")+Math.abs(e).toString().padStart(t,"0")}const Uv={y(e,t){const r=e.getFullYear(),a=r>0?r:1-r;return zv("yy"===t?a%100:a,t.length)},M(e,t){const r=e.getMonth();return"M"===t?String(r+1):zv(r+1,2)},d:(e,t)=>zv(e.getDate(),t.length),a(e,t){const r=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];default:return"am"===r?"a.m.":"p.m."}},h:(e,t)=>zv(e.getHours()%12||12,t.length),H:(e,t)=>zv(e.getHours(),t.length),m:(e,t)=>zv(e.getMinutes(),t.length),s:(e,t)=>zv(e.getSeconds(),t.length),S(e,t){const r=t.length,a=e.getMilliseconds();return zv(Math.trunc(a*Math.pow(10,r-3)),t.length)}},Vv="midnight",qv="noon",Hv="morning",Gv="afternoon",Wv="evening",Kv="night",Qv={G:function(e,t,r){const a=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return r.era(a,{width:"abbreviated"});case"GGGGG":return r.era(a,{width:"narrow"});default:return r.era(a,{width:"wide"})}},y:function(e,t,r){if("yo"===t){const t=e.getFullYear(),a=t>0?t:1-t;return r.ordinalNumber(a,{unit:"year"})}return Uv.y(e,t)},Y:function(e,t,r,a){const n=Rv(e,a),s=n>0?n:1-n;if("YY"===t){return zv(s%100,2)}return"Yo"===t?r.ordinalNumber(s,{unit:"year"}):zv(s,t.length)},R:function(e,t){return zv(Fv(e),t.length)},u:function(e,t){return zv(e.getFullYear(),t.length)},Q:function(e,t,r){const a=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(a);case"QQ":return zv(a,2);case"Qo":return r.ordinalNumber(a,{unit:"quarter"});case"QQQ":return r.quarter(a,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(a,{width:"narrow",context:"formatting"});default:return r.quarter(a,{width:"wide",context:"formatting"})}},q:function(e,t,r){const a=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(a);case"qq":return zv(a,2);case"qo":return r.ordinalNumber(a,{unit:"quarter"});case"qqq":return r.quarter(a,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(a,{width:"narrow",context:"standalone"});default:return r.quarter(a,{width:"wide",context:"standalone"})}},M:function(e,t,r){const a=e.getMonth();switch(t){case"M":case"MM":return Uv.M(e,t);case"Mo":return r.ordinalNumber(a+1,{unit:"month"});case"MMM":return r.month(a,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(a,{width:"narrow",context:"formatting"});default:return r.month(a,{width:"wide",context:"formatting"})}},L:function(e,t,r){const a=e.getMonth();switch(t){case"L":return String(a+1);case"LL":return zv(a+1,2);case"Lo":return r.ordinalNumber(a+1,{unit:"month"});case"LLL":return r.month(a,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(a,{width:"narrow",context:"standalone"});default:return r.month(a,{width:"wide",context:"standalone"})}},w:function(e,t,r,a){const n=Bv(e,a);return"wo"===t?r.ordinalNumber(n,{unit:"week"}):zv(n,t.length)},I:function(e,t,r){const a=Mv(e);return"Io"===t?r.ordinalNumber(a,{unit:"week"}):zv(a,t.length)},d:function(e,t,r){return"do"===t?r.ordinalNumber(e.getDate(),{unit:"date"}):Uv.d(e,t)},D:function(e,t,r){const a=Tv(e);return"Do"===t?r.ordinalNumber(a,{unit:"dayOfYear"}):zv(a,t.length)},E:function(e,t,r){const a=e.getDay();switch(t){case"E":case"EE":case"EEE":return r.day(a,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(a,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(a,{width:"short",context:"formatting"});default:return r.day(a,{width:"wide",context:"formatting"})}},e:function(e,t,r,a){const n=e.getDay(),s=(n-a.weekStartsOn+8)%7||7;switch(t){case"e":return String(s);case"ee":return zv(s,2);case"eo":return r.ordinalNumber(s,{unit:"day"});case"eee":return r.day(n,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(n,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(n,{width:"short",context:"formatting"});default:return r.day(n,{width:"wide",context:"formatting"})}},c:function(e,t,r,a){const n=e.getDay(),s=(n-a.weekStartsOn+8)%7||7;switch(t){case"c":return String(s);case"cc":return zv(s,t.length);case"co":return r.ordinalNumber(s,{unit:"day"});case"ccc":return r.day(n,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(n,{width:"narrow",context:"standalone"});case"cccccc":return r.day(n,{width:"short",context:"standalone"});default:return r.day(n,{width:"wide",context:"standalone"})}},i:function(e,t,r){const a=e.getDay(),n=0===a?7:a;switch(t){case"i":return String(n);case"ii":return zv(n,t.length);case"io":return r.ordinalNumber(n,{unit:"day"});case"iii":return r.day(a,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(a,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(a,{width:"short",context:"formatting"});default:return r.day(a,{width:"wide",context:"formatting"})}},a:function(e,t,r){const a=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(a,{width:"narrow",context:"formatting"});default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(e,t,r){const a=e.getHours();let n;switch(n=12===a?qv:0===a?Vv:a/12>=1?"pm":"am",t){case"b":case"bb":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(n,{width:"narrow",context:"formatting"});default:return r.dayPeriod(n,{width:"wide",context:"formatting"})}},B:function(e,t,r){const a=e.getHours();let n;switch(n=a>=17?Wv:a>=12?Gv:a>=4?Hv:Kv,t){case"B":case"BB":case"BBB":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(n,{width:"narrow",context:"formatting"});default:return r.dayPeriod(n,{width:"wide",context:"formatting"})}},h:function(e,t,r){if("ho"===t){let t=e.getHours()%12;return 0===t&&(t=12),r.ordinalNumber(t,{unit:"hour"})}return Uv.h(e,t)},H:function(e,t,r){return"Ho"===t?r.ordinalNumber(e.getHours(),{unit:"hour"}):Uv.H(e,t)},K:function(e,t,r){const a=e.getHours()%12;return"Ko"===t?r.ordinalNumber(a,{unit:"hour"}):zv(a,t.length)},k:function(e,t,r){let a=e.getHours();return 0===a&&(a=24),"ko"===t?r.ordinalNumber(a,{unit:"hour"}):zv(a,t.length)},m:function(e,t,r){return"mo"===t?r.ordinalNumber(e.getMinutes(),{unit:"minute"}):Uv.m(e,t)},s:function(e,t,r){return"so"===t?r.ordinalNumber(e.getSeconds(),{unit:"second"}):Uv.s(e,t)},S:function(e,t){return Uv.S(e,t)},X:function(e,t,r){const a=e.getTimezoneOffset();if(0===a)return"Z";switch(t){case"X":return Xv(a);case"XXXX":case"XX":return Jv(a);default:return Jv(a,":")}},x:function(e,t,r){const a=e.getTimezoneOffset();switch(t){case"x":return Xv(a);case"xxxx":case"xx":return Jv(a);default:return Jv(a,":")}},O:function(e,t,r){const a=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+Yv(a,":");default:return"GMT"+Jv(a,":")}},z:function(e,t,r){const a=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+Yv(a,":");default:return"GMT"+Jv(a,":")}},t:function(e,t,r){return zv(Math.trunc(+e/1e3),t.length)},T:function(e,t,r){return zv(+e,t.length)}};function Yv(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";const r=e>0?"-":"+",a=Math.abs(e),n=Math.trunc(a/60),s=a%60;return 0===s?r+String(n):r+String(n)+t+zv(s,2)}function Xv(e,t){if(e%60===0){return(e>0?"-":"+")+zv(Math.abs(e)/60,2)}return Jv(e,t)}function Jv(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";const r=e>0?"-":"+",a=Math.abs(e);return r+zv(Math.trunc(a/60),2)+t+zv(a%60,2)}const Zv=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});default:return t.date({width:"full"})}},$v=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});default:return t.time({width:"full"})}},eb={p:$v,P:(e,t)=>{const r=e.match(/(P+)(p+)?/)||[],a=r[1],n=r[2];if(!n)return Zv(e,t);let s;switch(a){case"P":s=t.dateTime({width:"short"});break;case"PP":s=t.dateTime({width:"medium"});break;case"PPP":s=t.dateTime({width:"long"});break;default:s=t.dateTime({width:"full"})}return s.replace("{{date}}",Zv(a,t)).replace("{{time}}",$v(n,t))}},tb=/^D+$/,rb=/^Y+$/,ab=["D","DD","YY","YYYY"];function nb(e){return e instanceof Date||"object"===typeof e&&"[object Date]"===Object.prototype.toString.call(e)}function sb(e){return!(!nb(e)&&"number"!==typeof e||isNaN(+Sv(e)))}const ib=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,ob=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,lb=/^'([^]*?)'?$/,cb=/''/g,ub=/[a-zA-Z]/;function hb(e,t,r){var a,n,s,i,o,l,c,d,u,h,m,f,g,p;const x=bv(),y=null!==(a=null!==(n=null===r||void 0===r?void 0:r.locale)&&void 0!==n?n:x.locale)&&void 0!==a?a:yv,v=null!==(s=null!==(i=null!==(o=null!==(l=null===r||void 0===r?void 0:r.firstWeekContainsDate)&&void 0!==l?l:null===r||void 0===r||null===(c=r.locale)||void 0===c||null===(c=c.options)||void 0===c?void 0:c.firstWeekContainsDate)&&void 0!==o?o:x.firstWeekContainsDate)&&void 0!==i?i:null===(d=x.locale)||void 0===d||null===(d=d.options)||void 0===d?void 0:d.firstWeekContainsDate)&&void 0!==s?s:1,b=null!==(u=null!==(h=null!==(m=null!==(f=null===r||void 0===r?void 0:r.weekStartsOn)&&void 0!==f?f:null===r||void 0===r||null===(g=r.locale)||void 0===g||null===(g=g.options)||void 0===g?void 0:g.weekStartsOn)&&void 0!==m?m:x.weekStartsOn)&&void 0!==h?h:null===(p=x.locale)||void 0===p||null===(p=p.options)||void 0===p?void 0:p.weekStartsOn)&&void 0!==u?u:0,w=Sv(e,null===r||void 0===r?void 0:r.in);if(!sb(w))throw new RangeError("Invalid time value");let k=t.match(ob).map(e=>{const t=e[0];if("p"===t||"P"===t){return(0,eb[t])(e,y.formatLong)}return e}).join("").match(ib).map(e=>{if("''"===e)return{isToken:!1,value:"'"};const t=e[0];if("'"===t)return{isToken:!1,value:mb(e)};if(Qv[t])return{isToken:!0,value:e};if(t.match(ub))throw new RangeError("Format string contains an unescaped latin alphabet character `"+t+"`");return{isToken:!1,value:e}});y.localize.preprocessor&&(k=y.localize.preprocessor(w,k));const N={firstWeekContainsDate:v,weekStartsOn:b,locale:y};return k.map(a=>{if(!a.isToken)return a.value;const n=a.value;(null!==r&&void 0!==r&&r.useAdditionalWeekYearTokens||!function(e){return rb.test(e)}(n))&&(null!==r&&void 0!==r&&r.useAdditionalDayOfYearTokens||!function(e){return tb.test(e)}(n))||function(e,t,r){const a=function(e,t,r){const a="Y"===e[0]?"years":"days of the month";return"Use `".concat(e.toLowerCase(),"` instead of `").concat(e,"` (in `").concat(t,"`) for formatting ").concat(a," to the input `").concat(r,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md")}(e,t,r);if(console.warn(a),ab.includes(e))throw new RangeError(a)}(n,t,String(e));return(0,Qv[n[0]])(w,n,y.localize,N)}).join("")}function mb(e){const t=e.match(lb);return t?t[1].replace(cb,"'"):e}const fb={lessThanXSeconds:{one:"menos de um segundo",other:"menos de {{count}} segundos"},xSeconds:{one:"1 segundo",other:"{{count}} segundos"},halfAMinute:"meio minuto",lessThanXMinutes:{one:"menos de um minuto",other:"menos de {{count}} minutos"},xMinutes:{one:"1 minuto",other:"{{count}} minutos"},aboutXHours:{one:"cerca de 1 hora",other:"cerca de {{count}} horas"},xHours:{one:"1 hora",other:"{{count}} horas"},xDays:{one:"1 dia",other:"{{count}} dias"},aboutXWeeks:{one:"cerca de 1 semana",other:"cerca de {{count}} semanas"},xWeeks:{one:"1 semana",other:"{{count}} semanas"},aboutXMonths:{one:"cerca de 1 m\xeas",other:"cerca de {{count}} meses"},xMonths:{one:"1 m\xeas",other:"{{count}} meses"},aboutXYears:{one:"cerca de 1 ano",other:"cerca de {{count}} anos"},xYears:{one:"1 ano",other:"{{count}} anos"},overXYears:{one:"mais de 1 ano",other:"mais de {{count}} anos"},almostXYears:{one:"quase 1 ano",other:"quase {{count}} anos"}},gb={date:uv({formats:{full:"EEEE, d 'de' MMMM 'de' y",long:"d 'de' MMMM 'de' y",medium:"d MMM y",short:"dd/MM/yyyy"},defaultWidth:"full"}),time:uv({formats:{full:"HH:mm:ss zzzz",long:"HH:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},defaultWidth:"full"}),dateTime:uv({formats:{full:"{{date}} '\xe0s' {{time}}",long:"{{date}} '\xe0s' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},defaultWidth:"full"})},pb={lastWeek:e=>{const t=e.getDay();return"'"+(0===t||6===t?"\xfaltimo":"\xfaltima")+"' eeee '\xe0s' p"},yesterday:"'ontem \xe0s' p",today:"'hoje \xe0s' p",tomorrow:"'amanh\xe3 \xe0s' p",nextWeek:"eeee '\xe0s' p",other:"P"},xb={ordinalNumber:(e,t)=>{const r=Number(e);return"week"===(null===t||void 0===t?void 0:t.unit)?r+"\xaa":r+"\xba"},era:fv({values:{narrow:["AC","DC"],abbreviated:["AC","DC"],wide:["antes de cristo","depois de cristo"]},defaultWidth:"wide"}),quarter:fv({values:{narrow:["1","2","3","4"],abbreviated:["T1","T2","T3","T4"],wide:["1\xba trimestre","2\xba trimestre","3\xba trimestre","4\xba trimestre"]},defaultWidth:"wide",argumentCallback:e=>e-1}),month:fv({values:{narrow:["j","f","m","a","m","j","j","a","s","o","n","d"],abbreviated:["jan","fev","mar","abr","mai","jun","jul","ago","set","out","nov","dez"],wide:["janeiro","fevereiro","mar\xe7o","abril","maio","junho","julho","agosto","setembro","outubro","novembro","dezembro"]},defaultWidth:"wide"}),day:fv({values:{narrow:["D","S","T","Q","Q","S","S"],short:["dom","seg","ter","qua","qui","sex","sab"],abbreviated:["domingo","segunda","ter\xe7a","quarta","quinta","sexta","s\xe1bado"],wide:["domingo","segunda-feira","ter\xe7a-feira","quarta-feira","quinta-feira","sexta-feira","s\xe1bado"]},defaultWidth:"wide"}),dayPeriod:fv({values:{narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"manh\xe3",afternoon:"tarde",evening:"tarde",night:"noite"},abbreviated:{am:"AM",pm:"PM",midnight:"meia-noite",noon:"meio-dia",morning:"manh\xe3",afternoon:"tarde",evening:"tarde",night:"noite"},wide:{am:"a.m.",pm:"p.m.",midnight:"meia-noite",noon:"meio-dia",morning:"manh\xe3",afternoon:"tarde",evening:"tarde",night:"noite"}},defaultWidth:"wide",formattingValues:{narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"da manh\xe3",afternoon:"da tarde",evening:"da tarde",night:"da noite"},abbreviated:{am:"AM",pm:"PM",midnight:"meia-noite",noon:"meio-dia",morning:"da manh\xe3",afternoon:"da tarde",evening:"da tarde",night:"da noite"},wide:{am:"a.m.",pm:"p.m.",midnight:"meia-noite",noon:"meio-dia",morning:"da manh\xe3",afternoon:"da tarde",evening:"da tarde",night:"da noite"}},defaultFormattingWidth:"wide"})},yb={code:"pt-BR",formatDistance:(e,t,r)=>{let a;const n=fb[e];return a="string"===typeof n?n:1===t?n.one:n.other.replace("{{count}}",String(t)),null!==r&&void 0!==r&&r.addSuffix?r.comparison&&r.comparison>0?"em "+a:"h\xe1 "+a:a},formatLong:gb,formatRelative:(e,t,r,a)=>{const n=pb[e];return"function"===typeof n?n(t):n},localize:xb,match:{ordinalNumber:xv({matchPattern:/^(\d+)[\xba\xaao]?/i,parsePattern:/\d+/i,valueCallback:e=>parseInt(e,10)}),era:pv({matchPatterns:{narrow:/^(ac|dc|a|d)/i,abbreviated:/^(a\.?\s?c\.?|d\.?\s?c\.?)/i,wide:/^(antes de cristo|depois de cristo)/i},defaultMatchWidth:"wide",parsePatterns:{any:[/^ac/i,/^dc/i],wide:[/^antes de cristo/i,/^depois de cristo/i]},defaultParseWidth:"any"}),quarter:pv({matchPatterns:{narrow:/^[1234]/i,abbreviated:/^T[1234]/i,wide:/^[1234](\xba)? trimestre/i},defaultMatchWidth:"wide",parsePatterns:{any:[/1/i,/2/i,/3/i,/4/i]},defaultParseWidth:"any",valueCallback:e=>e+1}),month:pv({matchPatterns:{narrow:/^[jfmajsond]/i,abbreviated:/^(jan|fev|mar|abr|mai|jun|jul|ago|set|out|nov|dez)/i,wide:/^(janeiro|fevereiro|mar\xe7o|abril|maio|junho|julho|agosto|setembro|outubro|novembro|dezembro)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^fev/i,/^mar/i,/^abr/i,/^mai/i,/^jun/i,/^jul/i,/^ago/i,/^set/i,/^out/i,/^nov/i,/^dez/i]},defaultParseWidth:"any"}),day:pv({matchPatterns:{narrow:/^(dom|[23456]\xaa?|s[a\xe1]b)/i,short:/^(dom|[23456]\xaa?|s[a\xe1]b)/i,abbreviated:/^(dom|seg|ter|qua|qui|sex|s[a\xe1]b)/i,wide:/^(domingo|(segunda|ter[c\xe7]a|quarta|quinta|sexta)([- ]feira)?|s[a\xe1]bado)/i},defaultMatchWidth:"wide",parsePatterns:{short:[/^d/i,/^2/i,/^3/i,/^4/i,/^5/i,/^6/i,/^s[a\xe1]/i],narrow:[/^d/i,/^2/i,/^3/i,/^4/i,/^5/i,/^6/i,/^s[a\xe1]/i],any:[/^d/i,/^seg/i,/^t/i,/^qua/i,/^qui/i,/^sex/i,/^s[a\xe1]b/i]},defaultParseWidth:"any"}),dayPeriod:pv({matchPatterns:{narrow:/^(a|p|mn|md|(da) (manh\xe3|tarde|noite))/i,any:/^([ap]\.?\s?m\.?|meia[-\s]noite|meio[-\s]dia|(da) (manh\xe3|tarde|noite))/i},defaultMatchWidth:"any",parsePatterns:{any:{am:/^a/i,pm:/^p/i,midnight:/^mn|^meia[-\s]noite/i,noon:/^md|^meio[-\s]dia/i,morning:/manh\xe3/i,afternoon:/tarde/i,evening:/tarde/i,night:/noite/i}},defaultParseWidth:"any"})},options:{weekStartsOn:0,firstWeekContainsDate:1}},vb=t=>{let{emprestimo:r,ferramenta:a,funcionario:n,empresa:s,setor:i,onClose:o}=t;const[l,c]=(0,e.useState)(null),[d,u]=(0,e.useState)(null),[h,m]=(0,e.useState)(!0),[f,g]=(0,e.useState)(!1);(0,e.useEffect)(()=>{p()},[r]);const p=async()=>{try{m(!0);const e=await(async(e,t,r,a,n)=>{var s;const i=new px,o=[41,128,185],l=[44,62,80],c=[127,140,141],d=[39,174,96];let u=20;i.setFillColor(...o),i.rect(0,0,210,35,"F"),i.setFontSize(28),i.setTextColor(255,255,255),i.setFont("helvetica","bold"),i.text("WorkFlow",105,15,{align:"center"}),i.setFontSize(10),i.setFont("helvetica","normal"),i.text("Sistema de Gest\xe3o de Ferramentas",105,22,{align:"center"}),i.setDrawColor(255,255,255),i.setLineWidth(.5),i.line(20,28,190,28),u=45,i.setFillColor(236,240,241),i.rect(0,u-5,210,12,"F"),i.setFontSize(16),i.setTextColor(...o),i.setFont("helvetica","bold"),i.text("COMPROVANTE DE EMPR\xc9STIMO",105,u+3,{align:"center"}),u+=20,i.setFontSize(9),i.setTextColor(...c),i.setFont("helvetica","normal");const h=hb(new Date,"dd/MM/yyyy '\xe0s' HH:mm",{locale:yb}),m="WF-".concat((null===(s=e.id)||void 0===s?void 0:s.substring(0,8).toUpperCase())||"XXXXXXXX");i.text("N\xba do Comprovante: ".concat(m),20,u),i.text("Gerado em: ".concat(h),150,u,{align:"right"}),u+=15,i.setFillColor(...o),i.rect(20,u-5,170,7,"F"),i.setFontSize(11),i.setTextColor(255,255,255),i.setFont("helvetica","bold"),i.text("DADOS DO SOLICITANTE",25,u),u+=10,i.setFontSize(10),i.setTextColor(...l),i.setFont("helvetica","normal"),[{label:"Nome:",valor:(null===r||void 0===r?void 0:r.nome)||"N\xe3o informado"},{label:"Matr\xedcula:",valor:(null===r||void 0===r?void 0:r.matricula)||"N/A"},{label:"Empresa:",valor:(null===a||void 0===a?void 0:a.nome)||"N/A"},{label:"Setor:",valor:(null===n||void 0===n?void 0:n.nome)||"N/A"}].forEach(e=>{i.setFont("helvetica","bold"),i.text(e.label,25,u),i.setFont("helvetica","normal"),i.text(e.valor,60,u),u+=6}),u+=5,i.setFillColor(...o),i.rect(20,u-5,170,7,"F"),i.setFontSize(11),i.setTextColor(255,255,255),i.setFont("helvetica","bold"),i.text("DADOS DA FERRAMENTA",25,u),u+=10,i.setFontSize(10),i.setTextColor(...l),i.setFont("helvetica","normal"),[{label:"Ferramenta:",valor:(null===t||void 0===t?void 0:t.nome)||"N\xe3o informado"},{label:"C\xf3digo:",valor:(null===t||void 0===t?void 0:t.codigo)||"N/A"},{label:"Categoria:",valor:(null===t||void 0===t?void 0:t.categoria)||"N/A"},{label:"Quantidade:",valor:"".concat(e.quantidade||1," unidade(s)")}].forEach(e=>{i.setFont("helvetica","bold"),i.text(e.label,25,u),i.setFont("helvetica","normal"),i.text(e.valor,60,u),u+=6}),u+=5,i.setFillColor(...o),i.rect(20,u-5,170,7,"F"),i.setFontSize(11),i.setTextColor(255,255,255),i.setFont("helvetica","bold"),i.text("HIST\xd3RICO DO EMPR\xc9STIMO",25,u),u+=10,i.setFontSize(10),i.setTextColor(...l),i.setFont("helvetica","normal");const f=e.dataEmprestimo||e.data?hb(new Date(e.dataEmprestimo||e.data),"dd/MM/yyyy '\xe0s' HH:mm",{locale:yb}):"N\xe3o informado",g=e.dataDevolucao?hb(new Date(e.dataDevolucao),"dd/MM/yyyy '\xe0s' HH:mm",{locale:yb}):"Pendente",p="devolvido"===e.status||e.devolvido?"DEVOLVIDO":"ATIVO",x=e.devolvido?d:[231,76,60],y=e.dataEmprestimo||e.data;if([{label:"Data de Retirada:",valor:f},{label:"Hor\xe1rio de Retirada:",valor:y?hb(new Date(y),"HH:mm",{locale:yb}):"N/A"},{label:"Data de Devolu\xe7\xe3o:",valor:g},{label:"Hor\xe1rio de Devolu\xe7\xe3o:",valor:e.dataDevolucao?hb(new Date(e.dataDevolucao),"HH:mm",{locale:yb}):"N/A"}].forEach(e=>{i.setFont("helvetica","bold"),i.text(e.label,25,u),i.setFont("helvetica","normal"),i.text(e.valor,65,u),u+=6}),u+=2,i.setFont("helvetica","bold"),i.text("Status:",25,u),i.setTextColor(...x),i.text(p,65,u),i.setTextColor(...l),u+=10,e.observacoes){i.setFont("helvetica","bold"),i.text("Observa\xe7\xf5es:",25,u),u+=5,i.setFont("helvetica","normal"),i.setFontSize(9);const t=i.splitTextToSize(e.observacoes,160);i.text(t,25,u),u+=4*t.length+5}u+=5,i.setFillColor(248,249,250),i.setDrawColor(...o),i.setLineWidth(1),i.rect(20,u,170,30,"FD"),u+=8,i.setFillColor(...d),i.circle(35,u+5,5,"F"),i.setFontSize(12),i.setTextColor(255,255,255),i.text("\u2713",35,u+7,{align:"center"}),i.setFontSize(10),i.setTextColor(...l),i.setFont("helvetica","bold"),i.text("DOCUMENTO AUTENTICADO E SEGURO",50,u+3),i.setFontSize(8),i.setFont("helvetica","normal"),i.setTextColor(...c);const v=i.splitTextToSize("Este comprovante foi gerado automaticamente pelo sistema WorkFlow e possui validade legal. As informa\xe7\xf5es contidas neste documento s\xe3o fidedignas e foram registradas em nosso banco de dados seguro.",135);i.text(v,50,u+9),u+=35,u+=5,i.setFontSize(8),i.setTextColor(...c),i.setFont("helvetica","italic"),i.text("Assinatura Digital WorkFlow",105,u,{align:"center"}),u+=4;const b="HASH: ".concat(m,"-").concat(Date.now().toString(36).toUpperCase());return i.text(b,105,u,{align:"center"}),u=280,i.setDrawColor(...c),i.setLineWidth(.3),i.line(20,u,190,u),u+=5,i.setFontSize(8),i.setTextColor(...c),i.setFont("helvetica","normal"),i.text("WorkFlow - Sistema de Gest\xe3o de Ferramentas",105,u,{align:"center"}),u+=4,i.text("Este documento foi gerado eletronicamente e n\xe3o requer assinatura manuscrita.",105,u,{align:"center"}),u+=4,i.text("P\xe1gina 1 de 1 | ".concat(m),105,u,{align:"center"}),i})(r,a,n,s,i);u(e);const t=(e=>e.output("dataurlstring"))(e);c(t)}catch(e){console.error("Erro ao gerar pr\xe9via do PDF:",e)}finally{m(!1)}};return(0,k.jsx)(Pr,{children:(0,k.jsx)(Cd.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/70 backdrop-blur-sm z-[200] flex items-center justify-center p-4",onClick:o,children:(0,k.jsxs)(Cd.div,{initial:{scale:.9,opacity:0,y:20},animate:{scale:1,opacity:1,y:0},exit:{scale:.9,opacity:0,y:20},transition:{type:"spring",duration:.5},className:"bg-white dark:bg-gray-900 rounded-2xl shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-hidden flex flex-col",onClick:e=>e.stopPropagation(),children:[(0,k.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700 bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-blue-950 dark:to-indigo-950",children:[(0,k.jsxs)("div",{className:"flex items-center gap-3",children:[(0,k.jsx)("div",{className:"w-12 h-12 rounded-full bg-gradient-to-br from-blue-500 to-indigo-600 flex items-center justify-center shadow-lg",children:(0,k.jsx)(A,{className:"w-6 h-6 text-white"})}),(0,k.jsxs)("div",{children:[(0,k.jsx)("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Comprovante de Empr\xe9stimo"}),(0,k.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Pr\xe9via do documento antes de baixar"})]})]}),(0,k.jsx)("button",{onClick:o,className:"p-2 rounded-full hover:bg-white/50 dark:hover:bg-gray-800/50 transition-colors",children:(0,k.jsx)(Id,{className:"w-6 h-6 text-gray-500 dark:text-gray-400"})})]}),(0,k.jsx)("div",{className:"px-6 py-4 bg-gray-50 dark:bg-gray-800/50 border-b border-gray-200 dark:border-gray-700",children:(0,k.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,k.jsxs)("div",{className:"flex items-center gap-2",children:[(0,k.jsx)("div",{className:"w-2 h-2 rounded-full bg-blue-500"}),(0,k.jsxs)("div",{children:[(0,k.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Funcion\xe1rio"}),(0,k.jsx)("p",{className:"text-sm font-semibold text-gray-900 dark:text-white truncate",children:(null===n||void 0===n?void 0:n.nome)||"N\xe3o informado"})]})]}),(0,k.jsxs)("div",{className:"flex items-center gap-2",children:[(0,k.jsx)("div",{className:"w-2 h-2 rounded-full bg-green-500"}),(0,k.jsxs)("div",{children:[(0,k.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Ferramenta"}),(0,k.jsx)("p",{className:"text-sm font-semibold text-gray-900 dark:text-white truncate",children:(null===a||void 0===a?void 0:a.nome)||"N\xe3o informado"})]})]}),(0,k.jsxs)("div",{className:"flex items-center gap-2",children:[(0,k.jsx)("div",{className:"w-2 h-2 rounded-full ".concat(r.devolvido?"bg-green-500":"bg-yellow-500")}),(0,k.jsxs)("div",{children:[(0,k.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Status"}),(0,k.jsx)("p",{className:"text-sm font-semibold text-gray-900 dark:text-white",children:r.devolvido?"Devolvido":"Ativo"})]})]})]})}),(0,k.jsx)("div",{className:"flex-1 overflow-auto bg-gray-100 dark:bg-gray-800 p-4",children:h?(0,k.jsxs)("div",{className:"flex flex-col items-center justify-center h-full gap-4",children:[(0,k.jsx)("div",{className:"w-16 h-16 border-4 border-blue-200 dark:border-blue-800 border-t-blue-600 dark:border-t-blue-400 rounded-full animate-spin"}),(0,k.jsx)("p",{className:"text-gray-600 dark:text-gray-400 font-medium",children:"Gerando comprovante..."})]}):l?(0,k.jsx)("div",{className:"flex justify-center",children:(0,k.jsx)("iframe",{src:l,className:"w-full h-[600px] border-0 rounded-lg shadow-xl bg-white",title:"Pr\xe9via do Comprovante"})}):(0,k.jsxs)("div",{className:"flex flex-col items-center justify-center h-full gap-4",children:[(0,k.jsx)(A,{className:"w-16 h-16 text-gray-400"}),(0,k.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"N\xe3o foi poss\xedvel gerar a pr\xe9via"})]})}),(0,k.jsxs)("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4 p-6 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-800/50",children:[(0,k.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-600 dark:text-gray-400",children:[(0,k.jsx)(Fd,{className:"w-4 h-4 text-green-500"}),(0,k.jsx)("span",{children:"Documento verificado e seguro"})]}),(0,k.jsxs)("div",{className:"flex items-center gap-3",children:[(0,k.jsx)("button",{onClick:o,className:"px-6 py-2.5 rounded-full bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 font-medium hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors",children:"Fechar"}),(0,k.jsxs)("button",{onClick:()=>{if(d){const e=d.output("blob"),t=URL.createObjectURL(e),r=window.open(t);r&&(r.onload=()=>{r.print()})}},disabled:h||!d,className:"px-6 py-2.5 rounded-full bg-indigo-500 text-white font-medium hover:bg-indigo-600 disabled:opacity-50 disabled:cursor-not-allowed transition-all flex items-center gap-2 shadow-lg hover:shadow-xl",children:[(0,k.jsx)(Nu,{className:"w-4 h-4"}),"Imprimir"]}),(0,k.jsx)("button",{onClick:()=>{if(d){var e;g(!0);const t="Comprovante_Emprestimo_".concat((null===(e=r.id)||void 0===e?void 0:e.substring(0,8))||"documento","_").concat(hb(new Date,"yyyyMMdd_HHmmss"),".pdf");((e,t)=>{e.save(t)})(d,t),setTimeout(()=>{g(!1)},1500)}},disabled:h||!d||f,className:"px-6 py-2.5 rounded-full bg-gradient-to-r from-blue-500 to-indigo-600 text-white font-medium hover:from-blue-600 hover:to-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed transition-all flex items-center gap-2 shadow-lg hover:shadow-xl",children:f?(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Baixando..."]}):(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(Gd,{className:"w-4 h-4"}),"Baixar PDF"]})})]})]})]})})})},bb=t=>{let{emprestimos:r,usuario:a,showEmptyMessage:i="Nenhum empr\xe9stimo encontrado",readOnly:o=!1}=t;const[l,c]=(0,e.useState)(null),[d,u]=(0,e.useState)([]),[h,m]=(0,e.useState)([]),[f,g]=(0,e.useState)(!1),[p,x]=(0,e.useState)(null),{funcionarios:y}=(0,e.useContext)(sr),v=Array.isArray(r)?r:[];(0,e.useEffect)(()=>{if(null===a||void 0===a||!a.id)return;const e=(0,s.P)((0,s.collection)(P.db,"transferencias"),(0,s._M)("funcionarioDestinoId","==",String(a.id)),(0,s._M)("status","==","pendente")),t=(0,s.P)((0,s.collection)(P.db,"transferencias"),(0,s._M)("funcionarioOrigemId","==",String(a.id)),(0,s._M)("status","==","pendente")),r=(0,s.aQ)(e,e=>{const t=e.docs.map(e=>(0,n.A)({id:e.id},e.data()));u(t)}),i=(0,s.aQ)(t,e=>{const t=e.docs.map(e=>(0,n.A)({id:e.id},e.data()));m(t)});return()=>{r(),i()}},[null===a||void 0===a?void 0:a.id]);const b=v.sort((e,t)=>{const r=new Date(e.dataEmprestimo);return new Date(t.dataEmprestimo)-r});return(0,k.jsxs)("div",{className:"space-y-6",children:[d.length>0&&(0,k.jsxs)("div",{children:[(0,k.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:["Transfer\xeancias Aguardando Sua Aprova\xe7\xe3o (",d.length,")"]}),(0,k.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:d.map(e=>(0,k.jsx)("div",{className:"bg-white dark:bg-gray-700 rounded-lg shadow-md overflow-hidden hover:shadow-lg transition-shadow duration-200",children:(0,k.jsxs)("div",{className:"p-4",children:[(0,k.jsx)("div",{className:"flex justify-between items-start mb-4",children:(0,k.jsxs)("div",{children:[(0,k.jsxs)("h4",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-1",children:["De: ",e.funcionarioOrigem]}),(0,k.jsxs)("div",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800",children:[(0,k.jsx)(xu,{className:"w-3 h-3 mr-1"}),"Aguardando aprova\xe7\xe3o"]})]})}),(0,k.jsxs)("div",{className:"space-y-2 mb-4",children:[(0,k.jsx)("h4",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Ferramentas:"}),(0,k.jsx)("div",{className:"space-y-1",children:(e.ferramentas||[]).map((e,t)=>(0,k.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-700 dark:text-gray-200",children:[(0,k.jsx)(yu,{className:"w-3 h-3"}),(0,k.jsxs)("span",{children:["string"===typeof e?e:(null===e||void 0===e?void 0:e.nome)||"Ferramenta sem nome",(null===e||void 0===e?void 0:e.quantidade)>1&&(0,k.jsxs)("span",{className:"text-gray-500 dark:text-gray-400 ml-1",children:["(",e.quantidade," unidades)"]})]})]},t))})]}),(0,k.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,k.jsx)("button",{onClick:()=>(async e=>{try{const t=(0,s.doc)(P.db,"transferencias",e.id);await(0,s.updateDoc)(t,{status:"recusado",dataRecusa:(new Date).toISOString()})}catch(t){console.error("Erro ao recusar transfer\xeancia:",t)}})(e),className:"px-4 py-2 text-sm text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-colors",children:"Recusar"}),(0,k.jsx)("button",{onClick:()=>(async e=>{try{const t=(0,s.doc)(P.db,"transferencias",e.id);if(await(0,s.updateDoc)(t,{status:"aceito",dataAceite:(new Date).toISOString()}),e.emprestimoId){const t=(0,s.doc)(P.db,"emprestimos",e.emprestimoId);await(0,s.updateDoc)(t,{funcionarioId:String(a.id),colaborador:a.nome})}}catch(t){console.error("Erro ao aceitar transfer\xeancia:",t)}})(e),className:"px-4 py-2 text-sm bg-blue-500 dark:bg-[#1D9BF0] text-gray-900 dark:text-white hover:bg-blue-600 dark:hover:bg-[#1a8cd8] rounded-lg transition-colors",children:"Aceitar"})]})]})},e.id))})]}),h.length>0&&(0,k.jsxs)("div",{children:[(0,k.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:["Transfer\xeancias Enviadas (",h.length,")"]}),(0,k.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:h.map(e=>(0,k.jsx)("div",{className:"bg-white dark:bg-gray-700 rounded-lg shadow-md overflow-hidden hover:shadow-lg transition-shadow duration-200",children:(0,k.jsxs)("div",{className:"p-4",children:[(0,k.jsx)("div",{className:"flex justify-between items-start mb-4",children:(0,k.jsxs)("div",{children:[(0,k.jsxs)("h4",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-1",children:["Para: ",e.funcionarioDestino]}),(0,k.jsxs)("div",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:[(0,k.jsx)(xu,{className:"w-3 h-3 mr-1"}),"Aguardando confirma\xe7\xe3o"]})]})}),(0,k.jsxs)("div",{className:"space-y-2 mb-4",children:[(0,k.jsx)("h4",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Ferramentas:"}),(0,k.jsx)("div",{className:"space-y-1",children:(e.ferramentas||[]).map((e,t)=>(0,k.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-700 dark:text-gray-200",children:[(0,k.jsx)(yu,{className:"w-3 h-3"}),(0,k.jsxs)("span",{children:["string"===typeof e?e:(null===e||void 0===e?void 0:e.nome)||"Ferramenta sem nome",(null===e||void 0===e?void 0:e.quantidade)>1&&(0,k.jsxs)("span",{className:"text-gray-500 dark:text-gray-400 ml-1",children:["(",e.quantidade," unidades)"]})]})]},t))})]}),(0,k.jsx)("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:e.dataSolicitacao&&"Enviado em ".concat(wu(e.dataSolicitacao))})]})},e.id))})]}),(0,k.jsx)("div",{children:0===b.length?(0,k.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 text-center border border-gray-200 dark:border-gray-600 dark:border-gray-600",children:[(0,k.jsx)(Md,{className:"w-12 h-12 text-gray-500 dark:text-gray-400 mx-auto mb-3"}),(0,k.jsx)("p",{className:"text-gray-500 dark:text-gray-400",children:i})]}):(0,k.jsxs)("div",{children:[(0,k.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,k.jsx)(lu,{className:"w-6 h-6 text-blue-500 dark:text-[#1D9BF0]"}),(0,k.jsxs)("h3",{className:"text-lg font-semibold text-white",children:["Hist\xf3rico de Empr\xe9stimos (",b.length,")"]})]}),(0,k.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:b.map(e=>{var t,r,a;return(0,k.jsxs)("div",{className:"relative bg-white dark:bg-gray-800 rounded-2xl p-6 shadow-lg border-2 border-gray-100 dark:border-gray-700 hover:border-blue-500 dark:hover:border-blue-500 transition-all duration-300 transform hover:-translate-y-1 hover:shadow-xl overflow-hidden group",children:[(0,k.jsx)("div",{className:"absolute top-0 right-0 w-32 h-32 rounded-full blur-3xl opacity-20 transition-opacity group-hover:opacity-30 ".concat("devolvido"===e.status?"bg-green-500":"bg-blue-500")}),(0,k.jsxs)("div",{className:"relative flex justify-between items-start mb-4",children:[(0,k.jsx)("div",{className:"flex-1",children:(0,k.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,k.jsx)("div",{className:"p-3 rounded-xl ".concat("devolvido"===e.status?"bg-gradient-to-br from-green-400 to-emerald-500":"bg-gradient-to-br from-blue-400 to-indigo-500"," shadow-lg"),children:(0,k.jsx)(lu,{className:"w-6 h-6 text-white"})}),(0,k.jsxs)("div",{children:[(0,k.jsxs)("h3",{className:"text-xl font-bold text-gray-900 dark:text-white",children:[null===(t=e.ferramentas)||void 0===t?void 0:t.length," ",1===(null===(r=e.ferramentas)||void 0===r?void 0:r.length)?"Ferramenta":"Ferramentas"]}),(0,k.jsx)("div",{className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-semibold mt-1 ".concat("devolvido"===e.status?"bg-gradient-to-r from-green-500 to-emerald-500 text-white shadow-md shadow-green-500/30":"bg-gradient-to-r from-blue-500 to-indigo-500 text-white shadow-md shadow-blue-500/30"),children:"devolvido"===e.status?(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(Fd,{className:"w-3.5 h-3.5 mr-1"}),"Devolvido"]}):(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(Md,{className:"w-3.5 h-3.5 mr-1"}),"Em uso"]})})]})]})}),!o&&"devolvido"!==e.status&&(0,k.jsxs)("button",{onClick:()=>c(e),className:"relative z-10 bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-xl flex items-center gap-2 text-sm font-medium transition-all duration-300 shadow-md hover:shadow-lg transform hover:scale-105",children:[(0,k.jsx)(vu,{className:"w-4 h-4"}),"Transferir"]})]}),(0,k.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-900/50 rounded-xl p-4 mb-4 space-y-2",children:[e.colaborador&&(0,k.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-700 dark:text-gray-300",children:[(0,k.jsx)("div",{className:"bg-purple-100 dark:bg-purple-900/30 p-1.5 rounded-lg",children:(0,k.jsx)(mu,{className:"w-4 h-4 text-purple-600 dark:text-purple-400"})}),(0,k.jsx)("span",{className:"font-medium",children:"Emprestado para"}),(0,k.jsx)("span",{className:"text-gray-900 dark:text-white font-semibold",children:e.colaborador})]}),(0,k.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-700 dark:text-gray-300",children:[(0,k.jsx)("div",{className:"bg-blue-100 dark:bg-blue-900/30 p-1.5 rounded-lg",children:(0,k.jsx)(xu,{className:"w-4 h-4 text-blue-600 dark:text-blue-400"})}),(0,k.jsx)("span",{className:"font-medium",children:"Retirada em"}),(0,k.jsx)("span",{className:"text-gray-900 dark:text-white font-semibold",children:wu(e.dataEmprestimo)})]}),"devolvido"===e.status&&(0,k.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-700 dark:text-gray-300",children:[(0,k.jsx)("div",{className:"bg-green-100 dark:bg-green-900/30 p-1.5 rounded-lg",children:(0,k.jsx)(Fd,{className:"w-4 h-4 text-green-600 dark:text-green-400"})}),(0,k.jsx)("span",{className:"font-medium",children:"Devolvido em"}),(0,k.jsx)("span",{className:"text-gray-900 dark:text-white font-semibold",children:wu(e.dataDevolucao)})]})]}),(0,k.jsxs)("div",{className:"space-y-2 mb-4",children:[(0,k.jsx)("h4",{className:"text-sm font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wide",children:"Ferramentas:"}),(0,k.jsx)("div",{className:"space-y-2",children:null===(a=e.ferramentas)||void 0===a?void 0:a.map((e,t)=>(0,k.jsxs)("div",{className:"flex items-center gap-3 p-2 bg-white dark:bg-gray-700/50 rounded-lg border border-gray-200 dark:border-gray-600",children:[(0,k.jsx)("div",{className:"bg-gray-100 dark:bg-gray-600 p-2 rounded-lg",children:(0,k.jsx)(yu,{className:"w-4 h-4 text-gray-600 dark:text-gray-300"})}),(0,k.jsx)("span",{className:"text-sm font-medium text-gray-900 dark:text-white flex-1",children:e.nome||e}),e.quantidade>1&&(0,k.jsxs)("span",{className:"px-2 py-1 bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 text-xs font-bold rounded-lg",children:[e.quantidade,"x"]})]},t))})]}),e.observacoes&&(0,k.jsx)("div",{className:"bg-amber-50 dark:bg-amber-900/20 rounded-xl p-4 mb-4 border border-amber-200 dark:border-amber-800",children:(0,k.jsxs)("div",{className:"flex items-start gap-2",children:[(0,k.jsx)("div",{className:"bg-amber-100 dark:bg-amber-900/40 p-1.5 rounded-lg mt-0.5",children:(0,k.jsx)(A,{className:"w-4 h-4 text-amber-600 dark:text-amber-400"})}),(0,k.jsxs)("div",{className:"flex-1",children:[(0,k.jsx)("h4",{className:"text-sm font-semibold text-amber-900 dark:text-amber-200 mb-1",children:"Observa\xe7\xf5es:"}),(0,k.jsx)("p",{className:"text-sm text-amber-800 dark:text-amber-300 whitespace-pre-wrap",children:e.observacoes})]})]})}),(0,k.jsxs)("button",{onClick:()=>(e=>{x(e),g(!0)})(e),className:"w-full flex items-center justify-center gap-2 px-4 py-2.5 bg-purple-600 hover:bg-purple-700 text-white rounded-lg transition-colors duration-200 font-medium text-sm",children:[(0,k.jsx)(A,{className:"w-4 h-4"}),"Ver Comprovante"]})]},e.id)})})]})}),l&&(0,k.jsx)(ku,{emprestimo:l,onClose:()=>c(null)}),f&&p&&(0,k.jsx)(vb,{emprestimo:p,onClose:()=>{g(!1),x(null)}})]})};!function(e){if(!e||"undefined"==typeof document)return;let t=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",t.firstChild?t.insertBefore(r,t.firstChild):t.appendChild(r),r.styleSheet?r.styleSheet.cssText=e:r.appendChild(document.createTextNode(e))}(':root{--toastify-color-light: #fff;--toastify-color-dark: #121212;--toastify-color-info: #3498db;--toastify-color-success: #07bc0c;--toastify-color-warning: #f1c40f;--toastify-color-error: hsl(6, 78%, 57%);--toastify-color-transparent: rgba(255, 255, 255, .7);--toastify-icon-color-info: var(--toastify-color-info);--toastify-icon-color-success: var(--toastify-color-success);--toastify-icon-color-warning: var(--toastify-color-warning);--toastify-icon-color-error: var(--toastify-color-error);--toastify-container-width: fit-content;--toastify-toast-width: 320px;--toastify-toast-offset: 16px;--toastify-toast-top: max(var(--toastify-toast-offset), env(safe-area-inset-top));--toastify-toast-right: max(var(--toastify-toast-offset), env(safe-area-inset-right));--toastify-toast-left: max(var(--toastify-toast-offset), env(safe-area-inset-left));--toastify-toast-bottom: max(var(--toastify-toast-offset), env(safe-area-inset-bottom));--toastify-toast-background: #fff;--toastify-toast-padding: 14px;--toastify-toast-min-height: 64px;--toastify-toast-max-height: 800px;--toastify-toast-bd-radius: 6px;--toastify-toast-shadow: 0px 4px 12px rgba(0, 0, 0, .1);--toastify-font-family: sans-serif;--toastify-z-index: 9999;--toastify-text-color-light: #757575;--toastify-text-color-dark: #fff;--toastify-text-color-info: #fff;--toastify-text-color-success: #fff;--toastify-text-color-warning: #fff;--toastify-text-color-error: #fff;--toastify-spinner-color: #616161;--toastify-spinner-color-empty-area: #e0e0e0;--toastify-color-progress-light: linear-gradient(to right, #4cd964, #5ac8fa, #007aff, #34aadc, #5856d6, #ff2d55);--toastify-color-progress-dark: #bb86fc;--toastify-color-progress-info: var(--toastify-color-info);--toastify-color-progress-success: var(--toastify-color-success);--toastify-color-progress-warning: var(--toastify-color-warning);--toastify-color-progress-error: var(--toastify-color-error);--toastify-color-progress-bgo: .2}.Toastify__toast-container{z-index:var(--toastify-z-index);-webkit-transform:translate3d(0,0,var(--toastify-z-index));position:fixed;width:var(--toastify-container-width);box-sizing:border-box;color:#fff;display:flex;flex-direction:column}.Toastify__toast-container--top-left{top:var(--toastify-toast-top);left:var(--toastify-toast-left)}.Toastify__toast-container--top-center{top:var(--toastify-toast-top);left:50%;transform:translate(-50%);align-items:center}.Toastify__toast-container--top-right{top:var(--toastify-toast-top);right:var(--toastify-toast-right);align-items:end}.Toastify__toast-container--bottom-left{bottom:var(--toastify-toast-bottom);left:var(--toastify-toast-left)}.Toastify__toast-container--bottom-center{bottom:var(--toastify-toast-bottom);left:50%;transform:translate(-50%);align-items:center}.Toastify__toast-container--bottom-right{bottom:var(--toastify-toast-bottom);right:var(--toastify-toast-right);align-items:end}.Toastify__toast{--y: 0;position:relative;touch-action:none;width:var(--toastify-toast-width);min-height:var(--toastify-toast-min-height);box-sizing:border-box;margin-bottom:1rem;padding:var(--toastify-toast-padding);border-radius:var(--toastify-toast-bd-radius);box-shadow:var(--toastify-toast-shadow);max-height:var(--toastify-toast-max-height);font-family:var(--toastify-font-family);z-index:0;display:flex;flex:1 auto;align-items:center;word-break:break-word}@media only screen and (max-width: 480px){.Toastify__toast-container{width:100vw;left:env(safe-area-inset-left);margin:0}.Toastify__toast-container--top-left,.Toastify__toast-container--top-center,.Toastify__toast-container--top-right{top:env(safe-area-inset-top);transform:translate(0)}.Toastify__toast-container--bottom-left,.Toastify__toast-container--bottom-center,.Toastify__toast-container--bottom-right{bottom:env(safe-area-inset-bottom);transform:translate(0)}.Toastify__toast-container--rtl{right:env(safe-area-inset-right);left:initial}.Toastify__toast{--toastify-toast-width: 100%;margin-bottom:0;border-radius:0}}.Toastify__toast-container[data-stacked=true]{width:var(--toastify-toast-width)}.Toastify__toast--stacked{position:absolute;width:100%;transform:translate3d(0,var(--y),0) scale(var(--s));transition:transform .3s}.Toastify__toast--stacked[data-collapsed] .Toastify__toast-body,.Toastify__toast--stacked[data-collapsed] .Toastify__close-button{transition:opacity .1s}.Toastify__toast--stacked[data-collapsed=false]{overflow:visible}.Toastify__toast--stacked[data-collapsed=true]:not(:last-child)>*{opacity:0}.Toastify__toast--stacked:after{content:"";position:absolute;left:0;right:0;height:calc(var(--g) * 1px);bottom:100%}.Toastify__toast--stacked[data-pos=top]{top:0}.Toastify__toast--stacked[data-pos=bot]{bottom:0}.Toastify__toast--stacked[data-pos=bot].Toastify__toast--stacked:before{transform-origin:top}.Toastify__toast--stacked[data-pos=top].Toastify__toast--stacked:before{transform-origin:bottom}.Toastify__toast--stacked:before{content:"";position:absolute;left:0;right:0;bottom:0;height:100%;transform:scaleY(3);z-index:-1}.Toastify__toast--rtl{direction:rtl}.Toastify__toast--close-on-click{cursor:pointer}.Toastify__toast-icon{margin-inline-end:10px;width:22px;flex-shrink:0;display:flex}.Toastify--animate{animation-fill-mode:both;animation-duration:.5s}.Toastify--animate-icon{animation-fill-mode:both;animation-duration:.3s}.Toastify__toast-theme--dark{background:var(--toastify-color-dark);color:var(--toastify-text-color-dark)}.Toastify__toast-theme--light,.Toastify__toast-theme--colored.Toastify__toast--default{background:var(--toastify-color-light);color:var(--toastify-text-color-light)}.Toastify__toast-theme--colored.Toastify__toast--info{color:var(--toastify-text-color-info);background:var(--toastify-color-info)}.Toastify__toast-theme--colored.Toastify__toast--success{color:var(--toastify-text-color-success);background:var(--toastify-color-success)}.Toastify__toast-theme--colored.Toastify__toast--warning{color:var(--toastify-text-color-warning);background:var(--toastify-color-warning)}.Toastify__toast-theme--colored.Toastify__toast--error{color:var(--toastify-text-color-error);background:var(--toastify-color-error)}.Toastify__progress-bar-theme--light{background:var(--toastify-color-progress-light)}.Toastify__progress-bar-theme--dark{background:var(--toastify-color-progress-dark)}.Toastify__progress-bar--info{background:var(--toastify-color-progress-info)}.Toastify__progress-bar--success{background:var(--toastify-color-progress-success)}.Toastify__progress-bar--warning{background:var(--toastify-color-progress-warning)}.Toastify__progress-bar--error{background:var(--toastify-color-progress-error)}.Toastify__progress-bar-theme--colored.Toastify__progress-bar--info,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--success,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--warning,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--error{background:var(--toastify-color-transparent)}.Toastify__close-button{color:#fff;position:absolute;top:6px;right:6px;background:transparent;outline:none;border:none;padding:0;cursor:pointer;opacity:.7;transition:.3s ease;z-index:1}.Toastify__toast--rtl .Toastify__close-button{left:6px;right:unset}.Toastify__close-button--light{color:#000;opacity:.3}.Toastify__close-button>svg{fill:currentColor;height:16px;width:14px}.Toastify__close-button:hover,.Toastify__close-button:focus{opacity:1}@keyframes Toastify__trackProgress{0%{transform:scaleX(1)}to{transform:scaleX(0)}}.Toastify__progress-bar{position:absolute;bottom:0;left:0;width:100%;height:100%;z-index:1;opacity:.7;transform-origin:left}.Toastify__progress-bar--animated{animation:Toastify__trackProgress linear 1 forwards}.Toastify__progress-bar--controlled{transition:transform .2s}.Toastify__progress-bar--rtl{right:0;left:initial;transform-origin:right;border-bottom-left-radius:initial}.Toastify__progress-bar--wrp{position:absolute;overflow:hidden;bottom:0;left:0;width:100%;height:5px;border-bottom-left-radius:var(--toastify-toast-bd-radius);border-bottom-right-radius:var(--toastify-toast-bd-radius)}.Toastify__progress-bar--wrp[data-hidden=true]{opacity:0}.Toastify__progress-bar--bg{opacity:var(--toastify-color-progress-bgo);width:100%;height:100%}.Toastify__spinner{width:20px;height:20px;box-sizing:border-box;border:2px solid;border-radius:100%;border-color:var(--toastify-spinner-color-empty-area);border-right-color:var(--toastify-spinner-color);animation:Toastify__spin .65s linear infinite}@keyframes Toastify__bounceInRight{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(3000px,0,0)}60%{opacity:1;transform:translate3d(-25px,0,0)}75%{transform:translate3d(10px,0,0)}90%{transform:translate3d(-5px,0,0)}to{transform:none}}@keyframes Toastify__bounceOutRight{20%{opacity:1;transform:translate3d(-20px,var(--y),0)}to{opacity:0;transform:translate3d(2000px,var(--y),0)}}@keyframes Toastify__bounceInLeft{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(-3000px,0,0)}60%{opacity:1;transform:translate3d(25px,0,0)}75%{transform:translate3d(-10px,0,0)}90%{transform:translate3d(5px,0,0)}to{transform:none}}@keyframes Toastify__bounceOutLeft{20%{opacity:1;transform:translate3d(20px,var(--y),0)}to{opacity:0;transform:translate3d(-2000px,var(--y),0)}}@keyframes Toastify__bounceInUp{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(0,3000px,0)}60%{opacity:1;transform:translate3d(0,-20px,0)}75%{transform:translate3d(0,10px,0)}90%{transform:translate3d(0,-5px,0)}to{transform:translateZ(0)}}@keyframes Toastify__bounceOutUp{20%{transform:translate3d(0,calc(var(--y) - 10px),0)}40%,45%{opacity:1;transform:translate3d(0,calc(var(--y) + 20px),0)}to{opacity:0;transform:translate3d(0,-2000px,0)}}@keyframes Toastify__bounceInDown{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(0,-3000px,0)}60%{opacity:1;transform:translate3d(0,25px,0)}75%{transform:translate3d(0,-10px,0)}90%{transform:translate3d(0,5px,0)}to{transform:none}}@keyframes Toastify__bounceOutDown{20%{transform:translate3d(0,calc(var(--y) - 10px),0)}40%,45%{opacity:1;transform:translate3d(0,calc(var(--y) + 20px),0)}to{opacity:0;transform:translate3d(0,2000px,0)}}.Toastify__bounce-enter--top-left,.Toastify__bounce-enter--bottom-left{animation-name:Toastify__bounceInLeft}.Toastify__bounce-enter--top-right,.Toastify__bounce-enter--bottom-right{animation-name:Toastify__bounceInRight}.Toastify__bounce-enter--top-center{animation-name:Toastify__bounceInDown}.Toastify__bounce-enter--bottom-center{animation-name:Toastify__bounceInUp}.Toastify__bounce-exit--top-left,.Toastify__bounce-exit--bottom-left{animation-name:Toastify__bounceOutLeft}.Toastify__bounce-exit--top-right,.Toastify__bounce-exit--bottom-right{animation-name:Toastify__bounceOutRight}.Toastify__bounce-exit--top-center{animation-name:Toastify__bounceOutUp}.Toastify__bounce-exit--bottom-center{animation-name:Toastify__bounceOutDown}@keyframes Toastify__zoomIn{0%{opacity:0;transform:scale3d(.3,.3,.3)}50%{opacity:1}}@keyframes Toastify__zoomOut{0%{opacity:1}50%{opacity:0;transform:translate3d(0,var(--y),0) scale3d(.3,.3,.3)}to{opacity:0}}.Toastify__zoom-enter{animation-name:Toastify__zoomIn}.Toastify__zoom-exit{animation-name:Toastify__zoomOut}@keyframes Toastify__flipIn{0%{transform:perspective(400px) rotateX(90deg);animation-timing-function:ease-in;opacity:0}40%{transform:perspective(400px) rotateX(-20deg);animation-timing-function:ease-in}60%{transform:perspective(400px) rotateX(10deg);opacity:1}80%{transform:perspective(400px) rotateX(-5deg)}to{transform:perspective(400px)}}@keyframes Toastify__flipOut{0%{transform:translate3d(0,var(--y),0) perspective(400px)}30%{transform:translate3d(0,var(--y),0) perspective(400px) rotateX(-20deg);opacity:1}to{transform:translate3d(0,var(--y),0) perspective(400px) rotateX(90deg);opacity:0}}.Toastify__flip-enter{animation-name:Toastify__flipIn}.Toastify__flip-exit{animation-name:Toastify__flipOut}@keyframes Toastify__slideInRight{0%{transform:translate3d(110%,0,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInLeft{0%{transform:translate3d(-110%,0,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInUp{0%{transform:translate3d(0,110%,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInDown{0%{transform:translate3d(0,-110%,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideOutRight{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(110%,var(--y),0)}}@keyframes Toastify__slideOutLeft{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(-110%,var(--y),0)}}@keyframes Toastify__slideOutDown{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(0,500px,0)}}@keyframes Toastify__slideOutUp{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(0,-500px,0)}}.Toastify__slide-enter--top-left,.Toastify__slide-enter--bottom-left{animation-name:Toastify__slideInLeft}.Toastify__slide-enter--top-right,.Toastify__slide-enter--bottom-right{animation-name:Toastify__slideInRight}.Toastify__slide-enter--top-center{animation-name:Toastify__slideInDown}.Toastify__slide-enter--bottom-center{animation-name:Toastify__slideInUp}.Toastify__slide-exit--top-left,.Toastify__slide-exit--bottom-left{animation-name:Toastify__slideOutLeft;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--top-right,.Toastify__slide-exit--bottom-right{animation-name:Toastify__slideOutRight;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--top-center{animation-name:Toastify__slideOutUp;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--bottom-center{animation-name:Toastify__slideOutDown;animation-timing-function:ease-in;animation-duration:.3s}@keyframes Toastify__spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}\n');var wb=e=>"number"==typeof e&&!isNaN(e),kb=e=>"string"==typeof e,Nb=e=>"function"==typeof e,jb=t=>(0,e.isValidElement)(t)||kb(t)||Nb(t)||wb(t);function Sb(t){let{enter:r,exit:a,appendPosition:n=!1,collapse:s=!0,collapseDuration:i=300}=t;return function(t){let{children:o,position:l,preventExitTransition:c,done:d,nodeRef:u,isIn:h,playToast:m}=t,f=n?"".concat(r,"--").concat(l):r,g=n?"".concat(a,"--").concat(l):a,p=(0,e.useRef)(0);return(0,e.useLayoutEffect)(()=>{let e=u.current,t=f.split(" "),r=a=>{a.target===u.current&&(m(),e.removeEventListener("animationend",r),e.removeEventListener("animationcancel",r),0===p.current&&"animationcancel"!==a.type&&e.classList.remove(...t))};e.classList.add(...t),e.addEventListener("animationend",r),e.addEventListener("animationcancel",r)},[]),(0,e.useEffect)(()=>{let e=u.current,t=()=>{e.removeEventListener("animationend",t),s?function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:300,{scrollHeight:a,style:n}=e;requestAnimationFrame(()=>{n.minHeight="initial",n.height=a+"px",n.transition="all ".concat(r,"ms"),requestAnimationFrame(()=>{n.height="0",n.padding="0",n.margin="0",setTimeout(t,r)})})}(e,d,i):d()};h||(c?t():(p.current=1,e.className+=" ".concat(g),e.addEventListener("animationend",t)))},[h]),e.createElement(e.Fragment,null,o)}}var _b=1,Eb=()=>"".concat(_b++);var Ab=new Map,Cb=[],Ib=new Set,Tb=()=>Ab.size>0;function Db(e,t){var r;if(t)return!(null==(r=Ab.get(t))||!r.isToastActive(e));let a=!1;return Ab.forEach(t=>{t.isToastActive(e)&&(a=!0)}),a}function Pb(e){if(Tb()){if(null==e||(e=>kb(e)||wb(e))(e))Ab.forEach(t=>{t.removeToast(e)});else if(e&&("containerId"in e||"id"in e)){let t=Ab.get(e.containerId);t?t.removeToast(e.id):Ab.forEach(t=>{t.removeToast(e.id)})}}else Cb=Cb.filter(t=>null!=e&&t.options.toastId!==e)}function Fb(e,t){jb(e)&&(Tb()||Cb.push({content:e,options:t}),Ab.forEach(r=>{r.buildToast(e,t)}))}function Lb(e,t){Ab.forEach(r=>{(null==t||null==t||!t.containerId||(null==t?void 0:t.containerId)===r.id)&&r.toggle(e,null==t?void 0:t.id)})}function Mb(e){return e&&(kb(e.toastId)||wb(e.toastId))?e.toastId:Eb()}function Rb(e,t){return Fb(e,t),t.toastId}function Ob(e,t){return(0,n.A)((0,n.A)({},t),{},{type:t&&t.type||e,toastId:Mb(t)})}function Bb(e){return(t,r)=>Rb(t,Ob(e,r))}function zb(e,t){return Rb(e,Ob("default",t))}zb.loading=(e,t)=>Rb(e,Ob("default",(0,n.A)({isLoading:!0,autoClose:!1,closeOnClick:!1,closeButton:!1,draggable:!1},t))),zb.promise=function(e,t,r){let a,{pending:s,error:i,success:o}=t;s&&(a=kb(s)?zb.loading(s,r):zb.loading(s.render,(0,n.A)((0,n.A)({},r),s)));let l={isLoading:null,autoClose:null,closeOnClick:null,closeButton:null,draggable:null},c=(e,t,s)=>{if(null==t)return void zb.dismiss(a);let i=(0,n.A)((0,n.A)((0,n.A)({type:e},l),r),{},{data:s}),o=kb(t)?{render:t}:t;return a?zb.update(a,(0,n.A)((0,n.A)({},i),o)):zb(o.render,(0,n.A)((0,n.A)({},i),o)),s},d=Nb(e)?e():e;return d.then(e=>c("success",o,e)).catch(e=>c("error",i,e)),d},zb.success=Bb("success"),zb.info=Bb("info"),zb.error=Bb("error"),zb.warning=Bb("warning"),zb.warn=zb.warning,zb.dark=(e,t)=>Rb(e,Ob("default",(0,n.A)({theme:"dark"},t))),zb.dismiss=function(e){Pb(e)},zb.clearWaitingQueue=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Ab.forEach(t=>{t.props.limit&&(!e.containerId||t.id===e.containerId)&&t.clearQueue()})},zb.isActive=Db,zb.update=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=((e,t)=>{let{containerId:r}=t;var a;return null==(a=Ab.get(r||1))?void 0:a.toasts.get(e)})(e,t);if(r){let{props:a,content:s}=r,i=(0,n.A)((0,n.A)((0,n.A)({delay:100},a),t),{},{toastId:t.toastId||e,updateId:Eb()});i.toastId!==e&&(i.staleId=e);let o=i.render||s;delete i.render,Rb(o,i)}},zb.done=e=>{zb.update(e,{progress:1})},zb.onChange=function(e){return Ib.add(e),()=>{Ib.delete(e)}},zb.play=e=>Lb(!0,e),zb.pause=e=>Lb(!1,e);"undefined"!=typeof window?e.useLayoutEffect:e.useEffect;var Ub=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return{enter:"Toastify--animate Toastify__".concat(e,"-enter"),exit:"Toastify--animate Toastify__".concat(e,"-exit"),appendPosition:t}};Sb(Ub("bounce",!0)),Sb(Ub("slide",!0)),Sb(Ub("zoom")),Sb(Ub("flip"));new class{constructor(e){this.collectionName=e,this.collectionRef=(0,s.collection)(P.db,e)}async add(e){try{const t=V(this.collectionName),r=z(e,t);return await(0,s.gS)(this.collectionRef,(0,n.A)((0,n.A)({},r),{},{id:t,createdAt:Date.now()})),t}catch(t){throw console.error("Erro ao adicionar documento em ".concat(this.collectionName,":"),t),t}}async update(e,t){try{const r=(0,s.doc)(P.db,this.collectionName,e),a=z(t,e);await(0,s.updateDoc)(r,(0,n.A)((0,n.A)({},a),{},{updatedAt:Date.now()}))}catch(r){throw console.error("Erro ao atualizar documento em ".concat(this.collectionName,":"),r),r}}async delete(e){try{const t=(0,s.doc)(P.db,this.collectionName,e);await(0,s.deleteDoc)(t)}catch(t){throw console.error("Erro ao excluir documento em ".concat(this.collectionName,":"),t),t}}async getAll(){try{return(await(0,s.GG)(this.collectionRef)).docs.map(e=>{const t=e.data();try{const e=U(t,t.id);return(0,n.A)({id:t.id},e)}catch(r){return console.error("Erro ao decriptar documento ".concat(e.id,":"),r),null}}).filter(Boolean)}catch(e){throw console.error("Erro ao buscar documentos em ".concat(this.collectionName,":"),e),e}}onSnapshot(e){return(0,s.aQ)(this.collectionRef,t=>{const r=t.docs.map(e=>{const t=e.data();try{const e=U(t,t.id);return(0,n.A)({id:t.id},e)}catch(r){return console.error("Erro ao decriptar documento ".concat(e.id,":"),r),null}}).filter(Boolean);e(r)})}async getById(e){try{const t=(0,s.doc)(P.db,this.collectionName,e),r=await t.get();if(r.exists){const t=r.data();return U(t,e)}return null}catch(t){throw console.error("Erro ao buscar documento por ID em ".concat(this.collectionName,":"),t),t}}async query(e){try{const t=(0,s.P)(this.collectionRef,...e);return(await(0,s.GG)(t)).docs.map(e=>{const t=e.data();try{const e=U(t,t.id);return(0,n.A)({id:t.id},e)}catch(r){return console.error("Erro ao decriptar documento ".concat(e.id,":"),r),null}}).filter(Boolean)}catch(t){throw console.error("Erro ao consultar documentos em ".concat(this.collectionName,":"),t),t}}}("emprestimos");const Vb=t=>{let{emprestimos:r,readOnly:a=!1,showEmptyMessage:i}=t;const{usuario:o}=Nt(),[l,c]=(0,e.useState)([]),[d,u]=(0,e.useState)(!0),[h,m]=(0,e.useState)(""),[f,g]=(0,e.useState)("todos"),[p,x]=(0,e.useState)("mais-recente");(0,e.useEffect)(()=>{let e=()=>{};return(async()=>{if(null===o||void 0===o||!o.id)return;const t=(0,s.P)((0,s.collection)(P.db,"transferencias"),(0,s._M)("funcionarioDestinoId","==",String(o.id)),(0,s._M)("status","==","pendente"));e=(0,s.aQ)(t,e=>{const t=e.docs.map(e=>(0,n.A)({id:e.id},e.data()));console.log("Transfer\xeancias pendentes carregadas:",t),c(t),u(!1)})})(),()=>e()},[o]),console.log("MeuInventarioTab - Estado:",{"ID do usu\xe1rio":null===o||void 0===o?void 0:o.id,"Total de empr\xe9stimos recebidos":Array.isArray(r)?r.length:"N/A","Empr\xe9stimos ativos":Array.isArray(r)?r.filter(e=>"devolvido"!==e.status&&"cancelado"!==e.status).length:"N/A","Detalhes dos empr\xe9stimos":r,"Total de transfer\xeancias":l.length});const y=(0,e.useMemo)(()=>{if(!Array.isArray(r))return[];let e=[...r];if(h.trim()){const t=h.toLowerCase();e=e.filter(e=>{var r,a,n,s,i;return(null===(r=e.ferramenta)||void 0===r||null===(a=r.nome)||void 0===a?void 0:a.toLowerCase().includes(t))||(null===(n=e.funcionario)||void 0===n||null===(s=n.nome)||void 0===s?void 0:s.toLowerCase().includes(t))||(null===(i=e.observacoes)||void 0===i?void 0:i.toLowerCase().includes(t))})}return"todos"!==f&&(e=e.filter(e=>e.status===f)),e.sort((e,t)=>{var r,a,n,s;switch(p){case"mais-recente":return new Date(t.dataEmprestimo)-new Date(e.dataEmprestimo);case"mais-antigo":return new Date(e.dataEmprestimo)-new Date(t.dataEmprestimo);case"ferramenta-az":return((null===(r=e.ferramenta)||void 0===r?void 0:r.nome)||"").localeCompare((null===(a=t.ferramenta)||void 0===a?void 0:a.nome)||"");case"ferramenta-za":return((null===(n=t.ferramenta)||void 0===n?void 0:n.nome)||"").localeCompare((null===(s=e.ferramenta)||void 0===s?void 0:s.nome)||"");default:return 0}}),e},[r,h,f,p]),v=(0,k.jsx)("div",{className:"space-y-6",children:o||a?Array.isArray(r)?(0,k.jsxs)(k.Fragment,{children:[r.length>0&&(0,k.jsx)("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-gray-800 dark:to-gray-700 border border-blue-200 dark:border-blue-800 rounded-xl p-4 mb-6 shadow-sm",children:(0,k.jsxs)("div",{className:"flex items-center gap-3",children:[(0,k.jsx)("div",{className:"bg-blue-500 rounded-lg p-1.5",children:(0,k.jsx)(Md,{className:"w-4 h-4 text-white"})}),(0,k.jsxs)("div",{className:"flex-1",children:[(0,k.jsxs)("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:["Total de ",r.length," empr\xe9stimo",1!==r.length?"s":""," registrado",1!==r.length?"s":""]}),(0,k.jsx)("p",{className:"text-xs text-gray-600 dark:text-gray-400 mt-0.5",children:"Use os filtros abaixo para encontrar rapidamente"})]})]})}),(0,k.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg p-4 mb-6 border border-gray-200 dark:border-gray-700",children:[(0,k.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,k.jsxs)("div",{className:"md:col-span-3",children:[(0,k.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Buscar"}),(0,k.jsx)("input",{type:"text",value:h,onChange:e=>m(e.target.value),placeholder:"Buscar por ferramenta, funcion\xe1rio ou observa\xe7\xf5es...",className:"w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-xl bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 dark:focus:ring-blue-400 focus:border-transparent transition-all duration-200"})]}),(0,k.jsxs)("div",{children:[(0,k.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2 flex items-center gap-2",children:[(0,k.jsx)(gu,{className:"w-4 h-4"}),"Status"]}),(0,k.jsxs)("select",{value:f,onChange:e=>g(e.target.value),className:"w-full px-4 py-3 h-12 border border-gray-300 dark:border-gray-600 rounded-xl bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 dark:focus:ring-blue-400 focus:border-transparent transition-all duration-200",children:[(0,k.jsx)("option",{value:"todos",children:"Todos os status"}),(0,k.jsx)("option",{value:"ativo",children:"Ativos"}),(0,k.jsx)("option",{value:"devolvido",children:"Devolvidos"}),(0,k.jsx)("option",{value:"atrasado",children:"Atrasados"}),(0,k.jsx)("option",{value:"cancelado",children:"Cancelados"})]})]}),(0,k.jsxs)("div",{className:"md:col-span-2",children:[(0,k.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2 flex items-center gap-2",children:[(0,k.jsx)(pu,{className:"w-4 h-4"}),"Ordenar por"]}),(0,k.jsxs)("select",{value:p,onChange:e=>x(e.target.value),className:"w-full px-4 py-3 h-12 border border-gray-300 dark:border-gray-600 rounded-xl bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 dark:focus:ring-blue-400 focus:border-transparent transition-all duration-200",children:[(0,k.jsx)("option",{value:"mais-recente",children:"Mais recentes primeiro"}),(0,k.jsx)("option",{value:"mais-antigo",children:"Mais antigos primeiro"}),(0,k.jsx)("option",{value:"ferramenta-az",children:"Ferramenta (A-Z)"}),(0,k.jsx)("option",{value:"ferramenta-za",children:"Ferramenta (Z-A)"})]})]})]}),(h||"todos"!==f)&&(0,k.jsx)("div",{className:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-700",children:(0,k.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[(0,k.jsx)("span",{className:"font-semibold text-blue-600 dark:text-blue-400",children:y.length})," ","resultado",1!==y.length?"s":""," encontrado",1!==y.length?"s":"",h&&' para "'.concat(h,'"')]})})]}),l.length>0&&(0,k.jsxs)("div",{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-600 dark:border-gray-600 hover:border-blue-500 dark:border-[#1D9BF0] rounded-xl p-4 mb-6 transition-colors",children:[(0,k.jsx)("div",{className:"flex items-center gap-2 mb-3",children:(0,k.jsxs)("h3",{className:"text-lg font-semibold text-white",children:["Transfer\xeancias Pendentes (",l.length,")"]})}),(0,k.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-4",children:"Voc\xea tem ferramentas aguardando sua confirma\xe7\xe3o de recebimento."})]}),(0,k.jsx)(bb,{emprestimos:y,transferencias:l,usuario:o,isLoadingTransferencias:d,showEmptyMessage:i,readOnly:a})]}):(0,k.jsxs)("div",{className:"bg-white dark:bg-gray-700 rounded-lg p-6 text-center shadow-md",children:[(0,k.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500 dark:border-[#1D9BF0] mx-auto"}),(0,k.jsx)("p",{className:"mt-2 text-gray-500 dark:text-gray-400",children:"Carregando empr\xe9stimos..."})]}):(0,k.jsx)("div",{className:"bg-white dark:bg-gray-700 rounded-lg p-6 text-center shadow-md",children:(0,k.jsx)("p",{className:"text-gray-500 dark:text-gray-400",children:"Voc\xea precisa estar logado para ver seus empr\xe9stimos."})})});return a?v:(0,k.jsx)(ir,{children:v})},qb=y("shopping-cart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]),Hb=y("wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.106-3.105c.32-.322.863-.22.983.218a6 6 0 0 1-8.259 7.057l-7.91 7.91a1 1 0 0 1-2.999-3l7.91-7.91a6 6 0 0 1 7.057-8.259c.438.12.54.662.219.984z",key:"1ngwbx"}]]),Gb=y("clipboard-check",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"m9 14 2 2 4-4",key:"df797q"}]]),Wb=y("building-2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]),Kb=y("briefcase",[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]]),Qb=y("arrow-down",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]),Yb=y("warehouse",[["path",{d:"M18 21V10a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1v11",key:"pb2vm6"}],["path",{d:"M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V8a2 2 0 0 1 1.132-1.803l7.95-3.974a2 2 0 0 1 1.837 0l7.948 3.974A2 2 0 0 1 22 8z",key:"doq5xv"}],["path",{d:"M6 13h12",key:"yf64js"}],["path",{d:"M6 17h12",key:"1jwigz"}]]),Xb=y("sparkles",[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]]),Jb=t=>{let{item:r,empresa:a,setor:n,destino:s,onComplete:i}=t;const[o,l]=(0,e.useState)("start");(0,e.useEffect)(()=>{const e=[{phase:"start",duration:600},{phase:"creating",duration:1800},{phase:"moving",duration:2e3},{phase:"storing",duration:1200},{phase:"complete",duration:800}];let t=0;const r=()=>{if(t<e.length){const a=e[t];l(a.phase),setTimeout(()=>{t++,r()},a.duration)}else setTimeout(()=>{null===i||void 0===i||i()},500)};r()},[i]);const c=Array.from({length:20}).map((e,t)=>({id:t,angle:t/20*Math.PI*2,delay:.05*t}));return(0,k.jsx)("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:(0,k.jsx)("div",{className:"relative w-full max-w-4xl",children:(0,k.jsxs)(Cd.div,{className:"bg-gradient-to-br from-blue-50 to-indigo-50 dark:from-gray-800 dark:to-gray-900 rounded-3xl shadow-2xl p-8 relative overflow-hidden",initial:{scale:.8,opacity:0,rotateX:-20},animate:{scale:1,opacity:1,rotateX:0},transition:{type:"spring",duration:.6},children:[(0,k.jsx)(Cd.div,{className:"absolute inset-0 bg-gradient-to-br from-blue-500/10 to-indigo-500/10",animate:{opacity:[.3,.6,.3]},transition:{duration:2,repeat:1/0}}),(0,k.jsxs)("div",{className:"relative z-10",children:[(0,k.jsxs)(Cd.div,{className:"text-center mb-8",initial:{y:-20,opacity:0},animate:{y:0,opacity:1},children:[(0,k.jsx)("h2",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:"Adicionando Novo Item"}),(0,k.jsxs)("p",{className:"text-gray-600 dark:text-gray-400",children:["start"===o&&"Preparando cadastro...","creating"===o&&"Criando registro do item...","moving"===o&&"Adicionando ao ".concat("empresa"===s?"invent\xe1rio da empresa":"almoxarifado do setor","..."),"storing"===o&&"Finalizando cadastro...","complete"===o&&"Item adicionado com sucesso!"]})]}),(0,k.jsxs)("div",{className:"flex flex-col items-center gap-8",children:[(0,k.jsxs)(Cd.div,{className:"relative",animate:{scale:"creating"===o?[1,1.05,1]:1},transition:{duration:.8,repeat:"creating"===o?1/0:0},children:[(0,k.jsxs)("div",{className:"w-32 h-32 bg-gradient-to-br from-blue-400 to-blue-600 rounded-3xl flex items-center justify-center shadow-2xl relative",children:[(0,k.jsx)(Pr,{mode:"wait",children:"creating"===o?(0,k.jsx)(Cd.div,{initial:{scale:0,rotate:-180},animate:{scale:1,rotate:0},exit:{scale:0,rotate:180},children:(0,k.jsx)(D,{className:"w-16 h-16 text-white"})},"plus"):(0,k.jsx)(Cd.div,{initial:{scale:0},animate:{scale:1,rotate:[0,10,-10,0]},transition:{rotate:{duration:.5,repeat:"moving"===o?1/0:0}},children:(0,k.jsx)(Md,{className:"w-16 h-16 text-white"})},"package")}),"creating"===o&&(0,k.jsx)("div",{className:"absolute inset-0",children:c.map(e=>(0,k.jsx)(Cd.div,{className:"absolute w-3 h-3 bg-blue-400 rounded-full",style:{left:"50%",top:"50%"},animate:{x:80*Math.cos(e.angle),y:80*Math.sin(e.angle),scale:[0,1,0],opacity:[0,1,0]},transition:{duration:1.5,delay:e.delay,repeat:1/0}},e.id))}),"creating"===o&&(0,k.jsx)(k.Fragment,{children:[0,1,2].map(e=>(0,k.jsx)(Cd.div,{className:"absolute inset-0 border-4 border-blue-400 rounded-3xl",initial:{scale:1,opacity:.6},animate:{scale:2,opacity:0},transition:{duration:1.5,delay:.5*e,repeat:1/0}},e))})]}),(0,k.jsxs)(Cd.div,{className:"mt-4 text-center",initial:{opacity:0},animate:{opacity:1},transition:{delay:.5},children:[(0,k.jsx)("p",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300",children:(null===r||void 0===r?void 0:r.nome)||"Novo Item"}),(null===r||void 0===r?void 0:r.quantidade)&&(0,k.jsxs)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Quantidade: ",r.quantidade]})]})]}),(0,k.jsxs)(Cd.div,{className:"relative",animate:{y:"moving"===o?[0,15,0]:0,opacity:"moving"===o?1:.3},transition:{duration:1,repeat:"moving"===o?1/0:0},children:[(0,k.jsx)(Qb,{className:"w-12 h-12 text-blue-500"}),"moving"===o&&(0,k.jsx)(k.Fragment,{children:Array.from({length:8}).map((e,t)=>(0,k.jsx)(Cd.div,{className:"absolute left-1/2 top-0 w-2 h-2 bg-blue-400 rounded-full",animate:{y:[0,80],opacity:[0,1,0],scale:[0,1,0]},transition:{duration:1.2,delay:.15*t,repeat:1/0}},t))})]}),(0,k.jsxs)(Cd.div,{className:"relative",animate:{scale:"storing"===o?[1,1.05,1]:1},transition:{duration:.6,repeat:"storing"===o?1/0:0},children:[(0,k.jsx)("div",{className:"flex items-center gap-6",children:(0,k.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-6 shadow-xl border-2 border-gray-200 dark:border-gray-700 min-w-[300px]",children:[(0,k.jsxs)("div",{className:"flex items-center gap-4 mb-4",children:[(0,k.jsx)(Cd.div,{className:"w-16 h-16 rounded-xl flex items-center justify-center ".concat("empresa"===s?"bg-gradient-to-br from-purple-400 to-purple-600":"bg-gradient-to-br from-green-400 to-green-600"),animate:{boxShadow:"storing"===o?"empresa"===s?["0 10px 30px rgba(168, 85, 247, 0.3)","0 10px 50px rgba(168, 85, 247, 0.6)","0 10px 30px rgba(168, 85, 247, 0.3)"]:["0 10px 30px rgba(34, 197, 94, 0.3)","0 10px 50px rgba(34, 197, 94, 0.6)","0 10px 30px rgba(34, 197, 94, 0.3)"]:"0 10px 30px rgba(0, 0, 0, 0.3)"},transition:{duration:1,repeat:"storing"===o?1/0:0},children:"empresa"===s?(0,k.jsx)(Wb,{className:"w-8 h-8 text-white"}):(0,k.jsx)(Yb,{className:"w-8 h-8 text-white"})}),(0,k.jsxs)("div",{className:"flex-1",children:[(0,k.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 uppercase font-semibold",children:"empresa"===s?"Empresa":"Almoxarifado"}),(0,k.jsx)("h3",{className:"text-lg font-bold text-gray-900 dark:text-white",children:"empresa"===s?a:n})]})]}),(0,k.jsx)(Cd.div,{className:"inline-flex items-center gap-2 px-3 py-1.5 rounded-full text-xs font-semibold ".concat("empresa"===s?"bg-purple-100 dark:bg-purple-900/30 text-purple-700 dark:text-purple-400":"bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400"),animate:{scale:"storing"===o?[1,1.1,1]:1},transition:{duration:.6,repeat:"storing"===o?1/0:0},children:"complete"===o?(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(Fd,{className:"w-3 h-3"}),"Adicionado"]}):(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(Cd.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},children:(0,k.jsx)(Md,{className:"w-3 h-3"})}),"Processando"]})})]})}),"storing"===o&&(0,k.jsx)(k.Fragment,{children:[0,1,2].map(e=>(0,k.jsx)(Cd.div,{className:"absolute inset-0 border-4 rounded-2xl ".concat("empresa"===s?"border-purple-400":"border-green-400"),initial:{scale:1.2,opacity:0},animate:{scale:1,opacity:.6},exit:{scale:1,opacity:0},transition:{duration:1.5,delay:.5*e,repeat:1/0}},e))})]})]}),(0,k.jsxs)(Cd.div,{className:"mt-8 bg-white dark:bg-gray-800 rounded-xl p-6 shadow-inner",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},children:[(0,k.jsx)("h4",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-3",children:"Detalhes do item:"}),(0,k.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,k.jsxs)("div",{className:"flex justify-between",children:[(0,k.jsx)("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Nome:"}),(0,k.jsx)("span",{className:"text-sm font-semibold text-gray-900 dark:text-white",children:(null===r||void 0===r?void 0:r.nome)||"N/A"})]}),(null===r||void 0===r?void 0:r.quantidade)&&(0,k.jsxs)("div",{className:"flex justify-between",children:[(0,k.jsx)("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Quantidade:"}),(0,k.jsx)("span",{className:"text-sm font-semibold text-gray-900 dark:text-white",children:r.quantidade})]}),(null===r||void 0===r?void 0:r.categoria)&&(0,k.jsxs)("div",{className:"flex justify-between",children:[(0,k.jsx)("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Categoria:"}),(0,k.jsx)("span",{className:"text-sm font-semibold text-gray-900 dark:text-white",children:r.categoria})]}),(0,k.jsxs)("div",{className:"flex justify-between",children:[(0,k.jsx)("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Destino:"}),(0,k.jsx)("span",{className:"text-sm font-semibold text-gray-900 dark:text-white",children:"empresa"===s?"Invent\xe1rio da Empresa":"Almoxarifado do Setor"})]})]})]}),(0,k.jsx)("div",{className:"mt-6 h-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden",children:(0,k.jsx)(Cd.div,{className:"h-full bg-gradient-to-r from-blue-500 to-indigo-600",initial:{width:"0%"},animate:{width:"start"===o?"20%":"creating"===o?"40%":"moving"===o?"70%":"storing"===o?"90%":"100%"},transition:{duration:.5}})}),"complete"===o&&(0,k.jsx)("div",{className:"absolute inset-0 pointer-events-none",children:Array.from({length:30}).map((e,t)=>(0,k.jsx)(Cd.div,{className:"absolute w-2 h-2 rounded-full",style:{backgroundColor:["#3B82F6","#8B5CF6","#10B981","#F59E0B"][t%4],left:"50%",top:"50%"},initial:{scale:0,x:0,y:0},animate:{scale:[0,1,0],x:600*(Math.random()-.5),y:400*(Math.random()-.5),opacity:[1,1,0]},transition:{duration:1.5,delay:.03*t}},t))}),"complete"===o&&(0,k.jsx)("div",{className:"absolute inset-0 pointer-events-none",children:Array.from({length:15}).map((e,t)=>(0,k.jsx)(Cd.div,{className:"absolute",style:{left:"50%",top:"30%"},initial:{scale:0,x:0,y:0,opacity:1},animate:{scale:[0,1,0],x:400*(Math.random()-.5),y:300*(Math.random()-.5),opacity:[1,1,0]},transition:{duration:1.2,delay:.05*t},children:(0,k.jsx)(Xb,{className:"w-4 h-4 text-blue-500"})},t))})]})]})})})},Zb=t=>{let{adicionarItem:r}=t;const{usuario:a}=Nt(),i=At(null===a||void 0===a?void 0:a.nivel)||It(null===a||void 0===a?void 0:a.nivel),[o,l]=(0,e.useState)({nome:"",quantidade:"",categoria:""}),[c,d]=(0,e.useState)([]),[u,h]=(0,e.useState)([]),[m,f]=(0,e.useState)(""),[g,p]=(0,e.useState)(""),[x,y]=(0,e.useState)(!1),[v,b]=(0,e.useState)(!1),[w,N]=(0,e.useState)(!1),[j,S]=(0,e.useState)(null);(0,e.useEffect)(()=>{i?_():(f((null===a||void 0===a?void 0:a.empresaId)||""),p((null===a||void 0===a?void 0:a.setorId)||""))},[i,a]),(0,e.useEffect)(()=>{m&&i&&E(m)},[m,i]);const _=async()=>{try{y(!0);const e=(0,s.collection)(P.db,"empresas"),t=(await(0,s.GG)(e)).docs.map(e=>(0,n.A)({id:e.id},e.data()));d(t.filter(e=>!1!==e.ativo))}catch(e){console.error("Erro ao carregar empresas:",e)}finally{y(!1)}},E=async e=>{try{b(!0);const t=(0,s.collection)(P.db,"setores"),r=(0,s.P)(t,(0,s._M)("empresaId","==",e)),a=(await(0,s.GG)(r)).docs.map(e=>(0,n.A)({id:e.id},e.data()));h(a.filter(e=>!1!==e.ativo)),p("")}catch(t){console.error("Erro ao carregar setores:",t)}finally{b(!1)}};return(0,k.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-sm p-6 border border-gray-200 dark:border-gray-600",children:[i&&(0,k.jsxs)("div",{className:"mb-4 space-y-3",children:[(0,k.jsxs)("div",{className:"flex items-center gap-2 text-sm text-blue-600 dark:text-blue-400 font-medium",children:[(0,k.jsx)(Wb,{className:"w-4 h-4"}),(0,k.jsx)("span",{children:"Modo Administrador: Escolha a empresa e setor para registrar a ferramenta"})]}),(0,k.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,k.jsxs)("div",{className:"space-y-2",children:[(0,k.jsxs)("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-700 dark:text-gray-300",children:[(0,k.jsx)(Wb,{className:"w-4 h-4"}),"Empresa *"]}),(0,k.jsxs)("select",{value:m,onChange:e=>f(e.target.value),disabled:x,className:"w-full bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 text-gray-900 dark:text-white rounded-lg px-4 py-2.5 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-[#1D9BF0] transition-colors appearance-none",children:[(0,k.jsx)("option",{value:"",className:"bg-white dark:bg-gray-800",children:x?"Carregando...":"Selecione a empresa"}),c.map(e=>(0,k.jsx)("option",{value:e.id,className:"bg-white dark:bg-gray-800",children:e.nome},e.id))]})]}),(0,k.jsxs)("div",{className:"space-y-2",children:[(0,k.jsxs)("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-700 dark:text-gray-300",children:[(0,k.jsx)(Kb,{className:"w-4 h-4"}),"Setor *"]}),(0,k.jsxs)("select",{value:g,onChange:e=>p(e.target.value),disabled:!m||v,className:"w-full bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 text-gray-900 dark:text-white rounded-lg px-4 py-2.5 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-[#1D9BF0] transition-colors appearance-none disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,k.jsx)("option",{value:"",className:"bg-white dark:bg-gray-800",children:m?v?"Carregando...":"Selecione o setor":"Selecione uma empresa primeiro"}),u.map(e=>(0,k.jsx)("option",{value:e.id,className:"bg-white dark:bg-gray-800",children:e.nome},e.id))]})]})]})]}),!i&&a&&(0,k.jsxs)("div",{className:"mb-4 flex items-center gap-2 text-sm",children:[(0,k.jsxs)("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-700 rounded-full",children:[(0,k.jsx)("span",{className:"text-green-600 dark:text-green-400 font-medium",children:"\ud83c\udfe2"}),(0,k.jsx)("span",{className:"text-green-700 dark:text-green-300",children:a.empresaNome||"Zendaya"})]}),(0,k.jsxs)("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-700 rounded-full",children:[(0,k.jsx)("span",{className:"text-blue-600 dark:text-blue-400 font-medium",children:"\ud83c\udf31"}),(0,k.jsx)("span",{className:"text-blue-700 dark:text-blue-300",children:a.setorNome||"Jardinagem"})]}),(0,k.jsx)("span",{className:"text-gray-500 dark:text-gray-400 text-xs italic",children:"(ser\xe1 registrado automaticamente)"})]}),(0,k.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,k.jsx)("input",{type:"text",placeholder:"Nome do item",value:o.nome,onChange:e=>l((0,n.A)((0,n.A)({},o),{},{nome:e.target.value})),className:"w-full bg-white dark:bg-gray-800 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 dark:border-gray-600 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 rounded-full px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-[#1D9BF0] transition-colors"}),(0,k.jsx)("input",{type:"number",min:"1",placeholder:"Quantidade",value:o.quantidade,onChange:e=>l((0,n.A)((0,n.A)({},o),{},{quantidade:e.target.value})),className:"w-full bg-white dark:bg-gray-800 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 dark:border-gray-600 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 rounded-full px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-[#1D9BF0] transition-colors"}),(0,k.jsxs)("select",{value:o.categoria,onChange:e=>l((0,n.A)((0,n.A)({},o),{},{categoria:e.target.value})),className:"w-full bg-white dark:bg-gray-800 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 dark:border-gray-600 text-gray-900 dark:text-white rounded-full px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-[#1D9BF0] transition-colors appearance-none",children:[(0,k.jsx)("option",{value:"",className:"bg-white dark:bg-gray-800",children:"Selecione a categoria"}),(0,k.jsx)("option",{value:"Plantas & Mudas",className:"bg-white dark:bg-gray-800",children:"\ud83c\udf31 Plantas & Mudas"}),(0,k.jsx)("option",{value:"Sementes",className:"bg-white dark:bg-gray-800",children:"\ud83c\udf3e Sementes"}),(0,k.jsx)("option",{value:"Fertilizantes & Adubos",className:"bg-white dark:bg-gray-800",children:"Fertilizantes & Adubos"}),(0,k.jsx)("option",{value:"Terra & Substratos",className:"bg-white dark:bg-gray-800",children:"Terra & Substratos"}),(0,k.jsx)("option",{value:"Vasos & Recipientes",className:"bg-white dark:bg-gray-800",children:"Vasos & Recipientes"}),(0,k.jsx)("option",{value:"Ferramentas",className:"bg-white dark:bg-gray-800",children:"Ferramentas"}),(0,k.jsx)("option",{value:"Equipamentos",className:"bg-white dark:bg-gray-800",children:"Equipamentos"}),(0,k.jsx)("option",{value:"Insumos",className:"bg-white dark:bg-gray-800",children:"Insumos"}),(0,k.jsx)("option",{value:"EPI",className:"bg-white dark:bg-gray-800",children:"EPI"})]}),(0,k.jsxs)("button",{onClick:()=>{if(!o.nome||!o.quantidade||!o.categoria)return;if(i&&(!m||!g))return void alert("Por favor, selecione a empresa e o setor para registrar a ferramenta.");let e,t;if(i){const r=c.find(e=>e.id===m),a=u.find(e=>e.id===g);e=(null===r||void 0===r?void 0:r.nome)||"",t=(null===a||void 0===a?void 0:a.nome)||""}else e=(null===a||void 0===a?void 0:a.empresaNome)||"Zendaya",t=(null===a||void 0===a?void 0:a.setorNome)||"Jardinagem";const r=(0,n.A)((0,n.A)({},o),{},{empresa:e,setor:t,empresaId:i?m:(null===a||void 0===a?void 0:a.empresaId)||"",setorId:i?g:(null===a||void 0===a?void 0:a.setorId)||"",criadoPor:(null===a||void 0===a?void 0:a.username)||"Sistema",criadoEm:(new Date).toISOString()});console.log("\ud83c\udf31 Criando novo item com informa\xe7\xf5es da empresa e setor:",{nome:r.nome,empresa:r.empresa,setor:r.setor,empresaId:r.empresaId,setorId:r.setorId,criadoPor:r.criadoPor}),S({item:{nome:r.nome,quantidade:parseInt(r.quantidade),categoria:r.categoria},empresa:r.empresa,setor:r.setor,destino:"almoxarifado",itemCompleto:r}),N(!0)},disabled:!o.nome||!o.quantidade||!o.categoria||i&&(!m||!g),className:"bg-blue-500 dark:bg-[#1D9BF0] text-gray-900 dark:text-white rounded-full px-4 py-2 flex items-center justify-center gap-2 hover:bg-blue-600 dark:hover:bg-[#1a8cd8] transition-colors disabled:bg-[#38444D] disabled:text-gray-500 dark:text-gray-400 disabled:cursor-not-allowed",children:[(0,k.jsx)(D,{className:"w-4 h-4"}),"Adicionar Item"]})]}),w&&j&&(0,k.jsx)(Jb,{item:j.item,empresa:j.empresa,setor:j.setor,destino:j.destino,onComplete:()=>{if(j){r(j.itemCompleto)&&l({nome:"",quantidade:"",categoria:""})}N(!1),S(null)}})]})},$b=y("arrow-up-narrow-wide",[["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}],["path",{d:"M11 12h4",key:"q8tih4"}],["path",{d:"M11 16h7",key:"uosisv"}],["path",{d:"M11 20h10",key:"jvxblo"}]]),ew=y("arrow-down-wide-narrow",[["path",{d:"m3 16 4 4 4-4",key:"1co6wj"}],["path",{d:"M7 20V4",key:"1yoxec"}],["path",{d:"M11 4h10",key:"1w87gc"}],["path",{d:"M11 8h7",key:"djye34"}],["path",{d:"M11 12h4",key:"q8tih4"}]]),tw=y("funnel",[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]]),rw=y("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),aw=y("pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]),nw=y("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]),sw=t=>{let{item:r,onRemover:a,onEditar:n,detalhesEmprestimos:s}=t;const[i,o]=(0,e.useState)(!1),l=0===r.disponivel?{icon:(0,k.jsx)(w,{className:"w-3 h-3 mr-1"}),text:"Indispon\xedvel",bgColor:"bg-red-100",textColor:"text-red-800"}:r.disponivel<.3*r.quantidade?{icon:(0,k.jsx)(rw,{className:"w-3 h-3 mr-1"}),text:"Estoque Baixo",bgColor:"bg-yellow-100",textColor:"text-yellow-800"}:{icon:(0,k.jsx)(v,{className:"w-3 h-3 mr-1"}),text:"Dispon\xedvel",bgColor:"bg-green-100",textColor:"text-green-800"};return(0,k.jsx)("div",{className:"bg-white dark:bg-gray-700 rounded-lg shadow-md overflow-hidden hover:shadow-lg transition-shadow duration-200",children:(0,k.jsxs)("div",{className:"p-4",children:[(0,k.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,k.jsxs)("div",{children:[(0,k.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-1",children:r.nome}),(0,k.jsxs)("div",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat(l.bgColor," ").concat(l.textColor),children:[l.icon,l.text]})]}),(0,k.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,k.jsx)("button",{onClick:()=>n(r),className:"p-1.5 rounded-full hover:bg-gray-100 dark:hover:bg-gray-600 text-gray-500 dark:text-gray-400",children:(0,k.jsx)(aw,{className:"w-4 h-4"})}),(0,k.jsx)("button",{onClick:()=>a(r.id),className:"p-1.5 rounded-full hover:bg-red-50 dark:hover:bg-red-900/20 text-red-500",children:(0,k.jsx)(nw,{className:"w-4 h-4"})})]})]}),(0,k.jsxs)("div",{className:"space-y-2 mb-4",children:[(0,k.jsxs)("div",{className:"flex justify-between items-center text-sm text-gray-600 dark:text-gray-300",children:[(0,k.jsx)("span",{children:"Categoria"}),(0,k.jsx)("span",{className:"font-medium",children:r.categoria})]}),(0,k.jsxs)("div",{className:"flex justify-between items-center text-sm text-gray-600 dark:text-gray-300",children:[(0,k.jsx)("span",{children:"Total"}),(0,k.jsx)("span",{className:"font-medium",children:r.quantidade})]}),(0,k.jsxs)("div",{className:"flex justify-between items-center text-sm text-gray-600 dark:text-gray-300",children:[(0,k.jsx)("span",{children:"Dispon\xedvel"}),(0,k.jsxs)("span",{className:"font-medium",children:[r.disponivel," (",Math.round(r.disponivel/r.quantidade*100),"%)"]})]}),r.valorUnitario&&parseFloat(r.valorUnitario)>0&&(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)("div",{className:"h-px bg-gray-200 dark:bg-gray-600 my-2"}),(0,k.jsxs)("div",{className:"flex justify-between items-center text-sm text-gray-600 dark:text-gray-300",children:[(0,k.jsx)("span",{children:"Valor Unit\xe1rio"}),(0,k.jsx)("span",{className:"font-medium text-blue-600 dark:text-blue-400",children:parseFloat(r.valorUnitario).toLocaleString("pt-BR",{style:"currency",currency:"BRL"})})]}),(0,k.jsxs)("div",{className:"flex justify-between items-center text-sm font-semibold text-gray-800 dark:text-gray-200",children:[(0,k.jsx)("span",{children:"Valor Total"}),(0,k.jsx)("span",{className:"text-green-600 dark:text-green-400",children:(parseFloat(r.valorUnitario)*parseInt(r.quantidade)).toLocaleString("pt-BR",{style:"currency",currency:"BRL"})})]})]})]}),(0,k.jsx)("div",{className:"w-full bg-gray-200 dark:bg-gray-600 rounded-full h-2 mb-4",children:(0,k.jsx)("div",{className:"h-2 rounded-full transition-all duration-300 ".concat(0===r.disponivel?"bg-red-500":r.disponivel<.3*r.quantidade?"bg-yellow-500":"bg-green-500"),style:{width:"".concat(Math.round(r.disponivel/r.quantidade*100),"%")}})}),s&&s.length>0&&(0,k.jsxs)("div",{children:[(0,k.jsx)("button",{onClick:()=>o(!i),className:"w-full text-left text-sm font-medium text-[#1D9BF0] hover:text-[#1A8CD8] dark:text-blue-400 dark:hover:text-blue-300 mb-2",children:i?"Ocultar detalhes":"Ver ".concat(s.length," empr\xe9stimo(s)")}),i&&(0,k.jsx)("div",{className:"mt-2 space-y-2",children:s.map((e,t)=>(0,k.jsxs)("div",{className:"text-xs p-2 rounded bg-gray-50 dark:bg-gray-600/50 border border-gray-100 dark:border-gray-600",children:[(0,k.jsx)("div",{className:"font-medium text-gray-900 dark:text-white",children:e.nomeFuncionario||e.funcionario||e.colaborador}),(0,k.jsxs)("div",{className:"text-gray-500 dark:text-gray-400",children:["Desde ",e.dataEmprestimo?new Date(e.dataEmprestimo).toLocaleDateString("pt-BR"):"Data n\xe3o dispon\xedvel",e.horaEmprestimo?" \xe0s ".concat(e.horaEmprestimo):""]})]},t))})]})]})})},iw=y("tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]),ow=y("hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]),lw=y("dollar-sign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]),cw=t=>{let{item:r,onSalvar:a,onFechar:s}=t;const[i,o]=(0,e.useState)({nome:"",categoria:"",quantidade:0,disponivel:0,valorUnitario:""});(0,e.useEffect)(()=>{r&&o({nome:r.nome,categoria:r.categoria,quantidade:r.quantidade,disponivel:r.disponivel||0,valorUnitario:r.valorUnitario||""})},[r]);const l=i.valorUnitario&&i.quantidade?(parseFloat(i.valorUnitario)*parseInt(i.quantidade)).toLocaleString("pt-BR",{style:"currency",currency:"BRL"}):"R$ 0,00";return(0,k.jsx)("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4 animate-fadeIn",children:(0,k.jsxs)("div",{className:"bg-gradient-to-br from-white to-gray-50 dark:from-gray-800 dark:to-gray-900 rounded-2xl shadow-2xl max-w-2xl w-full border-2 border-gray-200 dark:border-gray-700 overflow-hidden animate-slideUp",children:[(0,k.jsx)("div",{className:"bg-gradient-to-r from-sky-500 to-sky-600 dark:from-sky-500 dark:to-sky-600 px-6 py-5 border-b border-sky-600 dark:border-sky-700",children:(0,k.jsxs)("div",{className:"flex justify-between items-center",children:[(0,k.jsxs)("div",{className:"flex items-center gap-3",children:[(0,k.jsx)("div",{className:"bg-white/20 p-2 rounded-lg backdrop-blur-sm",children:(0,k.jsx)(Md,{className:"w-6 h-6 text-white"})}),(0,k.jsxs)("div",{children:[(0,k.jsx)("h2",{className:"text-2xl font-bold text-white",children:"Editar Item"}),(0,k.jsx)("p",{className:"text-sky-100 text-sm",children:"Atualize as informa\xe7\xf5es do item"})]})]}),(0,k.jsx)("button",{onClick:s,className:"text-white/80 hover:text-white hover:bg-white/20 p-2 rounded-lg transition-all duration-200",children:(0,k.jsx)(Id,{className:"w-6 h-6"})})]})}),(0,k.jsxs)("form",{onSubmit:e=>{e.preventDefault(),a(r.id,i)},className:"p-6 space-y-5",children:[(0,k.jsxs)("div",{className:"group",children:[(0,k.jsxs)("label",{className:"flex items-center gap-2 text-sm font-semibold text-gray-700 dark:text-gray-200 mb-2",children:[(0,k.jsx)(Md,{className:"w-4 h-4 text-blue-500"}),"Nome do Item"]}),(0,k.jsx)("input",{type:"text",value:i.nome,onChange:e=>o((0,n.A)((0,n.A)({},i),{},{nome:e.target.value})),className:"w-full bg-white dark:bg-gray-800 border-2 border-gray-300 dark:border-gray-600 text-gray-900 dark:text-white placeholder-gray-400 dark:placeholder-gray-500 rounded-xl px-4 py-3 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 shadow-sm hover:shadow-md",placeholder:"Digite o nome do item",required:!0})]}),(0,k.jsxs)("div",{className:"group",children:[(0,k.jsxs)("label",{className:"flex items-center gap-2 text-sm font-semibold text-gray-700 dark:text-gray-200 mb-2",children:[(0,k.jsx)(iw,{className:"w-4 h-4 text-purple-500"}),"Categoria"]}),(0,k.jsxs)("select",{value:i.categoria,onChange:e=>o((0,n.A)((0,n.A)({},i),{},{categoria:e.target.value})),className:"w-full bg-white dark:bg-gray-800 border-2 border-gray-300 dark:border-gray-600 text-gray-900 dark:text-white rounded-xl px-4 py-3 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition-all duration-200 shadow-sm hover:shadow-md cursor-pointer",required:!0,children:[(0,k.jsx)("option",{value:"",children:"Selecione uma categoria"}),(0,k.jsx)("option",{value:"Plantas & Mudas",children:"\ud83c\udf31 Plantas & Mudas"}),(0,k.jsx)("option",{value:"Sementes",children:"\ud83c\udf3e Sementes"}),(0,k.jsx)("option",{value:"Fertilizantes & Adubos",children:"Fertilizantes & Adubos"}),(0,k.jsx)("option",{value:"Terra & Substratos",children:"Terra & Substratos"}),(0,k.jsx)("option",{value:"Vasos & Recipientes",children:"Vasos & Recipientes"}),(0,k.jsx)("option",{value:"Ferramentas",children:"Ferramentas"}),(0,k.jsx)("option",{value:"Equipamentos",children:"Equipamentos"}),(0,k.jsx)("option",{value:"Insumos",children:"Insumos"}),(0,k.jsx)("option",{value:"EPI",children:"EPI"})]})]}),(0,k.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,k.jsxs)("div",{className:"group",children:[(0,k.jsxs)("label",{className:"flex items-center gap-2 text-sm font-semibold text-gray-700 dark:text-gray-200 mb-2",children:[(0,k.jsx)(ow,{className:"w-4 h-4 text-orange-500"}),"Quantidade Total"]}),(0,k.jsx)("input",{type:"number",min:"1",value:i.quantidade,onChange:e=>o((0,n.A)((0,n.A)({},i),{},{quantidade:parseInt(e.target.value)||0})),className:"w-full bg-white dark:bg-gray-800 border-2 border-gray-300 dark:border-gray-600 text-gray-900 dark:text-white placeholder-gray-400 dark:placeholder-gray-500 rounded-xl px-4 py-3 focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-orange-500 transition-all duration-200 shadow-sm hover:shadow-md",placeholder:"0",required:!0})]}),(0,k.jsxs)("div",{className:"group",children:[(0,k.jsxs)("label",{className:"flex items-center gap-2 text-sm font-semibold text-gray-700 dark:text-gray-200 mb-2",children:[(0,k.jsx)(Fd,{className:"w-4 h-4 text-green-500"}),"Quantidade Dispon\xedvel"]}),(0,k.jsx)("input",{type:"number",min:"0",max:i.quantidade,value:i.disponivel,onChange:e=>{const t=parseInt(e.target.value)||0,r=Math.min(t,i.quantidade);o((0,n.A)((0,n.A)({},i),{},{disponivel:r}))},className:"w-full bg-white dark:bg-gray-800 border-2 border-gray-300 dark:border-gray-600 text-gray-900 dark:text-white placeholder-gray-400 dark:placeholder-gray-500 rounded-xl px-4 py-3 focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-500 transition-all duration-200 shadow-sm hover:shadow-md",placeholder:"0",required:!0})]})]}),(0,k.jsxs)("div",{className:"group",children:[(0,k.jsxs)("label",{className:"flex items-center gap-2 text-sm font-semibold text-gray-700 dark:text-gray-200 mb-2",children:[(0,k.jsx)(lw,{className:"w-4 h-4 text-green-600"}),"Valor Unit\xe1rio"]}),(0,k.jsxs)("div",{className:"flex items-center gap-2",children:[(0,k.jsx)("span",{className:"text-lg font-bold text-green-600 dark:text-green-400",children:"R$"}),(0,k.jsx)("input",{type:"number",min:"0",step:"0.01",value:i.valorUnitario,onChange:e=>o((0,n.A)((0,n.A)({},i),{},{valorUnitario:e.target.value})),className:"flex-1 bg-white dark:bg-gray-800 border-2 border-gray-300 dark:border-gray-600 text-gray-900 dark:text-white placeholder-gray-400 dark:placeholder-gray-500 rounded-xl pl-4 pr-4 py-3 focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-500 transition-all duration-200 shadow-sm hover:shadow-md",placeholder:"0,00"})]})]}),i.valorUnitario&&parseFloat(i.valorUnitario)>0&&(0,k.jsx)("div",{className:"bg-gradient-to-br from-green-50 to-green-100 dark:from-green-900/20 dark:to-green-800/20 border-2 border-green-300 dark:border-green-700 rounded-xl px-4 py-3",children:(0,k.jsxs)("div",{className:"flex items-center justify-between",children:[(0,k.jsxs)("div",{className:"flex items-center gap-2",children:[(0,k.jsx)("div",{className:"bg-green-500 p-2 rounded-lg",children:(0,k.jsx)(lw,{className:"w-5 h-5 text-white"})}),(0,k.jsxs)("div",{children:[(0,k.jsx)("p",{className:"text-xs font-medium text-green-700 dark:text-green-300",children:"Valor Total do Estoque"}),(0,k.jsxs)("p",{className:"text-xs text-green-600 dark:text-green-400",children:[i.quantidade," unidade(s)"]})]})]}),(0,k.jsx)("p",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:l})]})}),(0,k.jsxs)("div",{className:"flex justify-end gap-3 pt-4 border-t-2 border-gray-200 dark:border-gray-700",children:[(0,k.jsx)("button",{type:"button",onClick:s,className:"px-6 py-3 text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-800 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-xl font-medium transition-all duration-200 shadow-sm hover:shadow-md",children:"Cancelar"}),(0,k.jsxs)("button",{type:"submit",className:"px-6 py-3 bg-gradient-to-r from-sky-500 to-sky-600 hover:from-sky-600 hover:to-sky-700 text-white rounded-xl font-semibold transition-all duration-200 shadow-lg hover:shadow-xl transform hover:-translate-y-0.5 flex items-center gap-2",children:[(0,k.jsx)(Fd,{className:"w-5 h-5"}),"Salvar Altera\xe7\xf5es"]})]})]})]})})},dw=t=>{let{inventario:r,emprestimos:a,removerItem:n,atualizarItem:s,obterDetalhesEmprestimos:i}=t;const[o,l]=(0,e.useState)(""),[c,d]=(0,e.useState)(null),[u,h]=(0,e.useState)("nome-asc"),[m,f]=(0,e.useState)(""),{showToast:g}=_(),p=[...r.filter(e=>{const t=e.nome.toLowerCase().includes(o.toLowerCase())||e.categoria.toLowerCase().includes(o.toLowerCase()),r=!m||e.categoria===m;return t&&r})].sort((e,t)=>{switch(u){case"nome-asc":return e.nome.localeCompare(t.nome);case"nome-desc":return t.nome.localeCompare(e.nome);case"qtd-asc":return e.quantidade-t.quantidade;case"qtd-desc":return t.quantidade-e.quantidade;case"valor-asc":return(parseFloat(e.valorUnitario)||0)*(parseInt(e.quantidade)||0)-(parseFloat(t.valorUnitario)||0)*(parseInt(t.quantidade)||0);case"valor-desc":const r=(parseFloat(e.valorUnitario)||0)*(parseInt(e.quantidade)||0);return(parseFloat(t.valorUnitario)||0)*(parseInt(t.quantidade)||0)-r;default:return 0}}),x=e=>{n(e,a)};return(0,k.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 max-w-7xl mx-auto",children:[(0,k.jsx)("div",{className:"flex justify-between items-center mb-6",children:(0,k.jsxs)("div",{className:"flex items-center gap-4",children:[(0,k.jsx)(Ft,{className:"w-5 h-5 text-gray-400 dark:text-gray-500"}),(0,k.jsx)("input",{type:"text",placeholder:"Buscar por item...",value:o,onChange:e=>l(e.target.value),className:"w-full h-10 px-4 border border-gray-200 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#1D9BF0] dark:bg-gray-700 dark:text-white dark:placeholder-gray-500"}),(0,k.jsxs)("div",{className:"flex items-center gap-2",children:[(0,k.jsxs)("select",{value:m,onChange:e=>f(e.target.value),className:"border-2 border-gray-300 dark:border-gray-600 bg-gray-50 dark:bg-gray-800 rounded-lg px-4 py-2 text-gray-700 dark:text-gray-200 font-medium shadow-sm hover:border-blue-400 dark:hover:border-blue-500 hover:bg-white dark:hover:bg-gray-750 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 cursor-pointer",children:[(0,k.jsx)("option",{value:"",children:"Todas as categorias"}),(0,k.jsx)("option",{value:"Ferramentas",children:"Ferramentas"}),(0,k.jsx)("option",{value:"Equipamentos",children:"Equipamentos"}),(0,k.jsx)("option",{value:"EPI",children:"EPI"}),(0,k.jsx)("option",{value:"Outros",children:"Outros"})]}),(0,k.jsxs)("div",{className:"flex items-center gap-1 border border-gray-300 dark:border-gray-600 rounded-lg p-1 bg-gray-50 dark:bg-gray-800 shadow-sm",children:[(0,k.jsx)("button",{onClick:()=>h("nome-asc"),className:"p-2 rounded-md transition-all duration-200 ".concat("nome-asc"===u?"bg-blue-500 dark:bg-blue-600 text-white shadow-md scale-105":"text-gray-600 dark:text-gray-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 hover:text-blue-600 dark:hover:text-blue-400"),title:"Ordenar por nome (A-Z)",children:(0,k.jsx)($b,{className:"w-4 h-4"})}),(0,k.jsx)("button",{onClick:()=>h("nome-desc"),className:"p-2 rounded-md transition-all duration-200 ".concat("nome-desc"===u?"bg-blue-500 dark:bg-blue-600 text-white shadow-md scale-105":"text-gray-600 dark:text-gray-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 hover:text-blue-600 dark:hover:text-blue-400"),title:"Ordenar por nome (Z-A)",children:(0,k.jsx)(ew,{className:"w-4 h-4"})}),(0,k.jsx)("button",{onClick:()=>h("qtd-asc"===u?"qtd-desc":"qtd-asc"),className:"p-2 rounded-md transition-all duration-200 ".concat(u.startsWith("qtd-")?"bg-purple-500 dark:bg-purple-600 text-white shadow-md scale-105":"text-gray-600 dark:text-gray-400 hover:bg-purple-50 dark:hover:bg-purple-900/20 hover:text-purple-600 dark:hover:text-purple-400"),title:"Ordenar por quantidade",children:(0,k.jsx)(tw,{className:"w-4 h-4"})}),(0,k.jsx)("button",{onClick:()=>h("valor-desc"===u?"valor-asc":"valor-desc"),className:"p-2 rounded-md transition-all duration-200 ".concat(u.startsWith("valor-")?"bg-green-500 dark:bg-green-600 text-white shadow-md scale-105":"text-gray-600 dark:text-gray-400 hover:bg-green-50 dark:hover:bg-green-900/20 hover:text-green-600 dark:hover:text-green-400"),title:"Ordenar por valor total",children:"\ud83d\udcb0"})]})]})]})}),(0,k.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:p.map(e=>(0,k.jsx)(sw,{item:e,onRemover:x,onEditar:()=>d(e),detalhesEmprestimos:i(e.nome)},e.id))}),c&&(0,k.jsx)(cw,{item:c,onFechar:()=>d(null),onSalvar:async(e,t)=>{try{await s(e,t),g("Item atualizado com sucesso!","success"),d(null)}catch(r){console.error("Erro ao atualizar item:",r),g(r.message||"Erro ao atualizar item","error")}}})]})},uw=y("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]),hw={colors:{background:"#15202B",card:"#192734",input:"#253341",hover:"#20304A",modal:"#192734",primary:"#4776E6",primaryHover:"#3D63C4",secondary:"#253341",secondaryHover:"#2C3D4F",danger:"#F4212E",dangerHover:"#dc1e29",success:"#4776E6",successHover:"#3D63C4",warning:"#FFD700",warningHover:"#E6C200",text:"#FFFFFF",textSecondary:"#8899A6",textMuted:"#536471",border:"#38444D"},classes:{background:"bg-[#15202B]",card:"bg-[#192734] border border-[#38444D] rounded-xl shadow-sm",modal:"bg-[#192734] border border-[#38444D] rounded-xl shadow-xl",text:"text-white",textSecondary:"text-[#8899A6]",textMuted:"text-[#536471]",button:{base:"rounded-full font-medium transition-colors focus:outline-none focus:ring-2 focus:ring-[#4776E6] focus:ring-offset-2 focus:ring-offset-[#15202B] disabled:opacity-50",primary:"bg-[#4776E6] hover:bg-[#3D63C4] text-white",secondary:"bg-[#253341] hover:bg-[#2C3D4F] text-white",danger:"bg-[#F4212E] hover:bg-[#dc1e29] text-white",outline:"border border-[#38444D] hover:bg-[#253341] text-white",sizes:{sm:"px-3 py-1.5 text-sm",md:"px-4 py-2",lg:"px-6 py-3 text-lg"}},input:{base:"w-full rounded-full bg-[#253341] border border-[#38444D] text-white placeholder-[#8899A6] transition-all",focus:"focus:outline-none focus:ring-2 focus:ring-[#1DA1F2] focus:border-[#1DA1F2]",error:"border-[#F4212E] focus:ring-[#F4212E]",sizes:{sm:"px-3 py-1.5 text-sm",md:"px-4 py-2",lg:"px-5 py-3 text-lg"}},table:{wrapper:"border border-[#38444D] rounded-xl overflow-hidden",header:"bg-[#253341] text-[#8899A6]",row:"border-t border-[#38444D] hover:bg-[#253341]",cell:"px-4 py-3"},badge:{base:"inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-medium",info:"bg-[#1DA1F2] bg-opacity-10 text-[#1DA1F2]",success:"bg-[#1DA1F2] bg-opacity-10 text-[#1DA1F2]",warning:"bg-[#FFD700] bg-opacity-10 text-[#FFD700]",danger:"bg-[#F4212E] bg-opacity-10 text-[#F4212E]"},dropdown:{button:"inline-flex items-center justify-center gap-2 rounded-full bg-[#253341] px-4 py-2 text-sm text-white hover:bg-[#2C3D4F] focus:outline-none focus:ring-2 focus:ring-[#1DA1F2]",items:"absolute right-0 mt-2 w-56 origin-top-right rounded-xl bg-[#192734] border border-[#38444D] shadow-lg focus:outline-none",item:"block px-4 py-2 text-sm text-white hover:bg-[#253341]"},form:{group:"space-y-2",label:"block text-sm font-medium text-[#8899A6]",error:"mt-1 text-sm text-[#F4212E]",hint:"mt-1 text-sm text-[#8899A6]"}}},mw=y("minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]),fw=y("arrow-up",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]),gw=y("square-pen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]),pw=e=>{let{isOpen:t,onClose:r,onConfirm:a,titulo:n,mensagem:s}=e;const{colors:i,classes:o}=hw;return t?(0,k.jsx)("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center bg-black bg-opacity-50",children:(0,k.jsxs)("div",{className:"".concat(o.card," w-full max-w-md p-6 bg-white dark:bg-gray-800 dark:bg-[#15202B]"),children:[(0,k.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,k.jsx)(rw,{className:"w-6 h-6 text-[#F4212E]"}),(0,k.jsx)("h3",{className:"text-xl font-medium ".concat(i.text),children:n})]}),(0,k.jsx)("p",{className:"".concat(i.textSecondary," mb-6"),children:s}),(0,k.jsxs)("div",{className:"flex justify-end gap-4",children:[(0,k.jsx)("button",{onClick:r,className:"px-4 py-2 rounded-full border ".concat(i.border," ").concat(i.text," hover:bg-opacity-10 hover:bg-[#1D9BF0] transition-colors"),children:"Cancelar"}),(0,k.jsx)("button",{onClick:()=>{a(),r()},className:"px-4 py-2 rounded-full bg-[#F4212E] text-gray-900 dark:text-white hover:bg-[#DC1F2B] transition-colors",children:"Confirmar"})]})]})}):null},xw={solicitado:"Solicitado",aprovado:"Aprovado",pedido_enviado:"Pedido Enviado",recebido:"Recebido",cancelado:"Cancelado"},yw={solicitado:"bg-blue-100 text-blue-800 dark:bg-blue-900/50 dark:text-blue-300",aprovado:"bg-green-100 text-green-800 dark:bg-green-900/50 dark:text-green-300",pedido_enviado:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/50 dark:text-yellow-300",recebido:"bg-purple-100 text-purple-800 dark:bg-purple-900/50 dark:text-purple-300",cancelado:"bg-red-100 text-red-800 dark:bg-red-900/50 dark:text-red-300"},vw={baixa:"Baixa",media:"M\xe9dia",alta:"Alta",urgente:"Urgente"},bw={baixa:"bg-gray-100 text-gray-800 dark:bg-gray-900/50 dark:text-gray-300",media:"bg-blue-100 text-blue-800 dark:bg-blue-900/50 dark:text-blue-300",alta:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/50 dark:text-yellow-300",urgente:"bg-red-100 text-red-800 dark:bg-red-900/50 dark:text-red-300"},ww=t=>{let{compra:r,onEdit:a,onDelete:s,onUpdate:i,readonly:o}=t;const[l,c]=(0,e.useState)(!1),[d,u]=(0,e.useState)(!1),[h,m]=(0,e.useState)(!1),f=e=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(e),g=e=>{switch(e){case"baixa":return(0,k.jsx)(Qb,{className:"w-3 h-3 mr-1"});case"media":return(0,k.jsx)(mw,{className:"w-3 h-3 mr-1"});case"alta":return(0,k.jsx)(fw,{className:"w-3 h-3 mr-1"});case"urgente":return(0,k.jsx)(rw,{className:"w-3 h-3 mr-1"});default:return null}};return(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)("div",{className:"bg-gray-200 dark:bg-gray-700 rounded-lg shadow-md overflow-hidden hover:shadow-lg transition-shadow duration-200",children:(0,k.jsxs)("div",{className:"p-4 h-[22rem] relative",children:[(0,k.jsxs)("div",{className:"mb-4",children:[(0,k.jsxs)("div",{className:"flex justify-between items-center",children:[(0,k.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white flex-1",children:r.descricao}),!o&&(0,k.jsxs)("div",{className:"flex items-center gap-2 ml-4",children:[(0,k.jsx)("button",{onClick:()=>a(r),className:"p-1.5 text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-600 rounded-full transition-colors",title:"Editar",children:(0,k.jsx)(gw,{className:"w-4 h-4"})}),(0,k.jsx)("button",{onClick:e=>{e.preventDefault(),e.stopPropagation(),m(!0)},className:"p-1.5 text-red-500 hover:bg-red-500/10 rounded-full transition-colors",title:"Excluir",children:(0,k.jsx)(nw,{className:"w-4 h-4"})})]})]}),(0,k.jsx)("div",{className:"flex items-center gap-4 mt-2",children:(0,k.jsxs)("div",{className:"flex items-center justify-between",children:[(0,k.jsxs)("div",{className:"relative",children:[(0,k.jsxs)("button",{onClick:()=>!o&&c(!l),className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat(yw[r.status]," ").concat(!o&&"cursor-pointer hover:ring-2 hover:ring-offset-2 hover:ring-offset-white dark:hover:ring-offset-gray-700 hover:ring-blue-500/50"),children:[(0,k.jsx)(qb,{className:"w-3 h-3 mr-1"}),xw[r.status],!o&&(0,k.jsx)(Mt,{className:"w-3 h-3 ml-1"})]}),l&&!o&&(0,k.jsx)("div",{className:"absolute top-full left-0 mt-1 w-40 bg-gray-50 dark:bg-gray-800 rounded-md shadow-lg ring-1 ring-black ring-opacity-5 z-10",children:(0,k.jsx)("div",{className:"py-1",children:Object.entries(xw).map(e=>{let[t,a]=e;return(0,k.jsx)("button",{onClick:()=>{return e=t,void(o||(i((0,n.A)((0,n.A)({},r),{},{status:e})),c(!1)));var e},className:"block w-full text-left px-4 py-2 text-sm ".concat(t===r.status?"bg-blue-50 text-blue-700 dark:bg-blue-900/50 dark:text-blue-300":"text-gray-700 hover:bg-gray-50 dark:text-gray-300 dark:hover:bg-gray-700/50"),children:a},t)})})})]}),(0,k.jsxs)("div",{className:"relative",children:[(0,k.jsxs)("button",{onClick:()=>!o&&u(!d),className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat(bw[r.prioridade]," ").concat(!o&&"cursor-pointer hover:ring-2 hover:ring-offset-2 hover:ring-offset-white dark:hover:ring-offset-gray-700 hover:ring-blue-500/50"),children:[g(r.prioridade),vw[r.prioridade],!o&&(0,k.jsx)(Mt,{className:"w-3 h-3 ml-1"})]}),d&&!o&&(0,k.jsx)("div",{className:"absolute top-full left-0 mt-1 w-32 bg-gray-50 dark:bg-gray-800 rounded-md shadow-lg ring-1 ring-black ring-opacity-5 z-10",children:(0,k.jsx)("div",{className:"py-1",children:Object.entries(vw).map(e=>{let[t,a]=e;return(0,k.jsx)("button",{onClick:()=>{return e=t,void(o||(i((0,n.A)((0,n.A)({},r),{},{prioridade:e})),u(!1)));var e},className:"block w-full text-left px-4 py-2 text-sm ".concat(t===r.prioridade?"bg-blue-50 text-blue-700 dark:bg-blue-900/50 dark:text-blue-300":"text-gray-700 hover:bg-gray-50 dark:text-gray-300 dark:hover:bg-gray-700/50"),children:(0,k.jsxs)("div",{className:"flex items-center",children:[g(t),a]})},t)})})})]})]})})]}),(0,k.jsxs)("div",{className:"space-y-2 mb-4",children:[(0,k.jsxs)("div",{className:"flex justify-between items-center text-sm text-gray-600 dark:text-gray-300",children:[(0,k.jsx)("span",{children:"Quantidade"}),(0,k.jsx)("span",{className:"font-medium",children:r.quantidade})]}),(0,k.jsxs)("div",{className:"flex justify-between items-center text-sm text-gray-600 dark:text-gray-300",children:[(0,k.jsx)("span",{children:"Valor unit\xe1rio"}),(0,k.jsx)("span",{className:"font-medium",children:f(r.valorUnitario)})]}),(0,k.jsxs)("div",{className:"flex justify-between items-center text-sm text-gray-600 dark:text-gray-300",children:[(0,k.jsx)("span",{children:"Frete"}),(0,k.jsx)("span",{className:"font-medium",children:r.valorFrete?f(r.valorFrete):(0,k.jsx)("span",{className:"text-green-600 dark:text-green-400",children:"Gr\xe1tis"})})]}),(0,k.jsxs)("div",{className:"flex justify-between items-center text-sm text-gray-600 dark:text-gray-300",children:[(0,k.jsx)("span",{children:"Valor total"}),(0,k.jsx)("span",{className:"font-medium",children:f(r.quantidade*r.valorUnitario+(r.valorFrete||0))})]}),r.fornecedor&&(0,k.jsxs)("div",{className:"flex justify-between items-center text-sm text-gray-600 dark:text-gray-300",children:[(0,k.jsx)("span",{children:"Fornecedor"}),(0,k.jsx)("span",{className:"font-medium",children:r.fornecedor})]}),(0,k.jsxs)("div",{className:"flex justify-between items-center text-sm text-gray-600 dark:text-gray-300",children:[(0,k.jsx)("span",{children:"Solicitante"}),(0,k.jsx)("span",{className:"font-medium",children:r.solicitante})]})]}),r.link&&r.link.startsWith("https")&&(0,k.jsxs)("a",{href:r.link,target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-center gap-2 px-4 py-2 bg-blue-500 dark:bg-blue-600 text-white rounded-full hover:bg-blue-600 dark:hover:bg-blue-700 transition-colors",children:[(0,k.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"w-4 h-4",children:[(0,k.jsx)("path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"}),(0,k.jsx)("polyline",{points:"15 3 21 3 21 9"}),(0,k.jsx)("line",{x1:"10",y1:"14",x2:"21",y2:"3"})]}),(0,k.jsx)("span",{className:"text-sm",children:"Ver produto"})]})]})}),(0,k.jsx)(pw,{isOpen:h,onClose:()=>m(!1),onConfirm:()=>{s(r),m(!1)},titulo:"Confirmar exclus\xe3o",mensagem:'Tem certeza que deseja excluir a compra "'.concat(r.descricao,'"? Esta a\xe7\xe3o n\xe3o pode ser desfeita.')})]})},kw=y("credit-card",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]),Nw=y("truck",[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]]),jw=t=>{var r,a;let{compra:n,onComplete:s}=t;const[i,o]=(0,e.useState)("start");(0,e.useEffect)(()=>{const e=[{phase:"start",duration:600},{phase:"ordering",duration:1800},{phase:"shipping",duration:2200},{phase:"receiving",duration:1500},{phase:"complete",duration:800}];let t=0;const r=()=>{if(t<e.length){const a=e[t];o(a.phase),setTimeout(()=>{t++,r()},a.duration)}else setTimeout(()=>{null===s||void 0===s||s()},500)};r()},[s]);const l=Array.from({length:15}).map((e,t)=>({id:t,angle:t/15*Math.PI*2,delay:.1*t}));return(0,k.jsx)("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:(0,k.jsx)("div",{className:"relative w-full max-w-5xl",children:(0,k.jsxs)(Cd.div,{className:"bg-gradient-to-br from-green-50 to-emerald-50 dark:from-gray-800 dark:to-gray-900 rounded-3xl shadow-2xl p-8 relative overflow-hidden",initial:{scale:.8,opacity:0,y:50},animate:{scale:1,opacity:1,y:0},transition:{type:"spring",duration:.6},children:[(0,k.jsx)(Cd.div,{className:"absolute inset-0 bg-gradient-to-br from-green-500/10 to-emerald-500/10",animate:{opacity:[.3,.6,.3]},transition:{duration:2,repeat:1/0}}),(0,k.jsxs)("div",{className:"relative z-10",children:[(0,k.jsxs)(Cd.div,{className:"text-center mb-8",initial:{y:-20,opacity:0},animate:{y:0,opacity:1},children:[(0,k.jsx)("h2",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:"Processando Compra"}),(0,k.jsxs)("p",{className:"text-gray-600 dark:text-gray-400",children:["start"===i&&"Iniciando pedido de compra...","ordering"===i&&"Processando pagamento...","shipping"===i&&"Aguardando entrega...","receiving"===i&&"Recebendo itens...","complete"===i&&"Compra finalizada com sucesso!"]})]}),(0,k.jsxs)("div",{className:"grid grid-cols-3 gap-8 items-center",children:[(0,k.jsxs)("div",{className:"flex flex-col items-center gap-6",children:[(0,k.jsxs)(Cd.div,{className:"relative",animate:{scale:"ordering"===i?[1,1.1,1]:1},transition:{duration:.8,repeat:"ordering"===i?1/0:0},children:[(0,k.jsxs)("div",{className:"w-32 h-32 bg-gradient-to-br from-green-400 to-emerald-600 rounded-3xl flex items-center justify-center shadow-2xl",children:[(0,k.jsx)(Pr,{mode:"wait",children:"start"===i||"ordering"===i?(0,k.jsx)(Cd.div,{initial:{scale:0,rotate:-180},animate:{scale:1,rotate:0},exit:{scale:0,rotate:180},children:(0,k.jsx)(qb,{className:"w-16 h-16 text-white"})},"cart"):(0,k.jsx)(Cd.div,{initial:{scale:0},animate:{scale:1},children:(0,k.jsx)(Fd,{className:"w-16 h-16 text-white"})},"check")}),"ordering"===i&&(0,k.jsx)("div",{className:"absolute inset-0",children:l.map(e=>(0,k.jsx)(Cd.div,{className:"absolute",style:{left:"50%",top:"50%"},animate:{x:100*Math.cos(e.angle),y:100*Math.sin(e.angle),scale:[0,1,0],rotate:[0,360],opacity:[0,1,0]},transition:{duration:1.5,delay:e.delay,repeat:1/0},children:(0,k.jsx)(lw,{className:"w-4 h-4 text-yellow-400"})},e.id))})]}),"ordering"===i&&(0,k.jsx)(k.Fragment,{children:[0,1,2].map(e=>(0,k.jsx)(Cd.div,{className:"absolute inset-0 border-4 border-green-400 rounded-3xl",initial:{scale:1,opacity:.6},animate:{scale:2,opacity:0},transition:{duration:1.5,delay:.5*e,repeat:1/0}},e))})]}),(0,k.jsxs)(Cd.div,{className:"bg-gradient-to-r from-green-500 to-emerald-600 rounded-xl p-4 shadow-xl w-48",initial:{rotateY:0},animate:{rotateY:"ordering"===i?[0,180,360]:0},transition:{duration:2,repeat:"ordering"===i?1/0:0},children:[(0,k.jsx)(kw,{className:"w-8 h-8 text-white mb-2"}),(0,k.jsx)("div",{className:"text-white text-xs font-mono",children:"\u2022\u2022\u2022\u2022 \u2022\u2022\u2022\u2022 \u2022\u2022\u2022\u2022 \u2022\u2022\u2022\u2022"}),(0,k.jsxs)("div",{className:"flex justify-between items-center mt-2",children:[(0,k.jsx)("span",{className:"text-white text-xs",children:"Valor:"}),(0,k.jsxs)("span",{className:"text-white text-sm font-bold",children:["R$ ",(null===n||void 0===n||null===(r=n.valor)||void 0===r?void 0:r.toFixed(2))||"0.00"]})]})]}),(0,k.jsx)("p",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300 text-center",children:"Processando Pagamento"})]}),(0,k.jsxs)("div",{className:"flex flex-col items-center gap-4",children:[(0,k.jsxs)(Cd.div,{className:"relative w-full h-32 flex items-center justify-center",animate:{x:"shipping"===i?[0,20,0]:0},transition:{duration:1.5,repeat:"shipping"===i?1/0:0,ease:"easeInOut"},children:[(0,k.jsx)("div",{className:"w-24 h-24 bg-gradient-to-br from-blue-400 to-blue-600 rounded-2xl flex items-center justify-center shadow-2xl",children:(0,k.jsx)(Nw,{className:"w-12 h-12 text-white"})}),"shipping"===i&&(0,k.jsx)(k.Fragment,{children:Array.from({length:5}).map((e,t)=>(0,k.jsx)(Cd.div,{className:"absolute left-0 bottom-4 w-6 h-6 bg-gray-400 rounded-full",initial:{scale:.2,opacity:.6,x:0},animate:{scale:1.5,opacity:0,x:-50},transition:{duration:1,delay:.3*t,repeat:1/0}},t))}),(0,k.jsx)("div",{className:"absolute bottom-0 left-0 right-0 h-1 bg-gray-300 dark:bg-gray-600",children:"shipping"===i&&(0,k.jsx)(Cd.div,{className:"h-full w-1/4 bg-white",animate:{x:["0%","400%"]},transition:{duration:1,repeat:1/0,ease:"linear"}})})]}),(0,k.jsxs)(Cd.div,{className:"bg-white dark:bg-gray-800 rounded-xl p-3 shadow-lg",animate:{scale:"shipping"===i?[1,1.05,1]:1},transition:{duration:1,repeat:"shipping"===i?1/0:0},children:[(0,k.jsxs)("div",{className:"flex items-center gap-2",children:[(0,k.jsx)(Md,{className:"w-5 h-5 text-blue-500"}),(0,k.jsxs)("span",{className:"text-lg font-bold text-gray-900 dark:text-white",children:[(null===n||void 0===n?void 0:n.quantidade)||0,"x"]})]}),(0,k.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Em Transporte"})]}),"shipping"===i&&(0,k.jsx)("div",{className:"w-full",children:(0,k.jsx)("div",{className:"h-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden",children:(0,k.jsx)(Cd.div,{className:"h-full bg-gradient-to-r from-blue-500 to-blue-600",initial:{width:"0%"},animate:{width:"100%"},transition:{duration:2,repeat:1/0}})})}),(0,k.jsx)("p",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300 text-center",children:"Transporte em Andamento"})]}),(0,k.jsxs)("div",{className:"flex flex-col items-center gap-6",children:[(0,k.jsx)(Cd.div,{className:"relative",animate:{scale:"receiving"===i?[1,1.05,1]:1},transition:{duration:.8,repeat:"receiving"===i?1/0:0},children:(0,k.jsxs)("div",{className:"w-40 h-40 bg-gradient-to-br from-emerald-400 to-green-600 rounded-3xl flex items-center justify-center shadow-2xl relative overflow-hidden",children:[(0,k.jsx)(Md,{className:"w-20 h-20 text-white z-10"}),"receiving"===i&&(0,k.jsx)(k.Fragment,{children:Array.from({length:8}).map((e,t)=>(0,k.jsx)(Cd.div,{className:"absolute w-6 h-6 bg-white/30 rounded-md",style:{left:"".concat(20+10*t,"%"),top:"-10%"},animate:{y:[0,180],opacity:[0,1,0],rotate:[0,180]},transition:{duration:1.5,delay:.2*t,repeat:1/0}},t))}),"receiving"===i&&(0,k.jsx)(k.Fragment,{children:[0,1,2].map(e=>(0,k.jsx)(Cd.div,{className:"absolute inset-0 border-4 border-white rounded-3xl",initial:{scale:.8,opacity:.6},animate:{scale:1.3,opacity:0},transition:{duration:1.5,delay:.5*e,repeat:1/0}},e))}),"complete"===i&&(0,k.jsx)(Cd.div,{className:"absolute inset-0 bg-white/20 backdrop-blur-sm flex items-center justify-center",initial:{scale:0},animate:{scale:1},children:(0,k.jsx)(Fd,{className:"w-24 h-24 text-white"})})]})}),(0,k.jsxs)(Cd.div,{className:"bg-white dark:bg-gray-800 rounded-xl p-4 shadow-xl min-w-[200px]",initial:{opacity:0,y:20},animate:{opacity:1,y:0},children:[(0,k.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,k.jsx)("span",{className:"text-xs text-gray-500 dark:text-gray-400 uppercase font-semibold",children:"Status"}),(0,k.jsx)(Cd.div,{className:"w-3 h-3 rounded-full ".concat("complete"===i?"bg-green-500":"bg-yellow-500"),animate:{scale:"complete"!==i?[1,1.5,1]:1},transition:{duration:1,repeat:"complete"!==i?1/0:0}})]}),(0,k.jsx)("p",{className:"text-sm font-bold text-gray-900 dark:text-white",children:"complete"===i?"Recebido":"Processando"})]}),(0,k.jsx)("p",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300 text-center",children:"Recebimento"})]})]}),(0,k.jsxs)(Cd.div,{className:"mt-8 bg-white dark:bg-gray-800 rounded-xl p-6 shadow-inner",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},children:[(0,k.jsx)("h4",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-3",children:"Detalhes da compra:"}),(0,k.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,k.jsxs)("div",{className:"flex flex-col",children:[(0,k.jsx)("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Item:"}),(0,k.jsx)("span",{className:"text-sm font-semibold text-gray-900 dark:text-white",children:(null===n||void 0===n?void 0:n.item)||"N/A"})]}),(0,k.jsxs)("div",{className:"flex flex-col",children:[(0,k.jsx)("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Quantidade:"}),(0,k.jsx)("span",{className:"text-sm font-semibold text-gray-900 dark:text-white",children:(null===n||void 0===n?void 0:n.quantidade)||0})]}),(0,k.jsxs)("div",{className:"flex flex-col",children:[(0,k.jsx)("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Valor Total:"}),(0,k.jsxs)("span",{className:"text-sm font-semibold text-gray-900 dark:text-white",children:["R$ ",(null===n||void 0===n||null===(a=n.valor)||void 0===a?void 0:a.toFixed(2))||"0.00"]})]}),(null===n||void 0===n?void 0:n.fornecedor)&&(0,k.jsxs)("div",{className:"flex flex-col",children:[(0,k.jsx)("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Fornecedor:"}),(0,k.jsx)("span",{className:"text-sm font-semibold text-gray-900 dark:text-white",children:n.fornecedor})]})]})]}),(0,k.jsx)("div",{className:"mt-6 h-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden",children:(0,k.jsx)(Cd.div,{className:"h-full bg-gradient-to-r from-green-500 to-emerald-600",initial:{width:"0%"},animate:{width:"start"===i?"15%":"ordering"===i?"35%":"shipping"===i?"70%":"receiving"===i?"90%":"100%"},transition:{duration:.5}})}),"complete"===i&&(0,k.jsx)("div",{className:"absolute inset-0 pointer-events-none",children:Array.from({length:40}).map((e,t)=>(0,k.jsx)(Cd.div,{className:"absolute w-3 h-3 rounded-full",style:{backgroundColor:["#10B981","#34D399","#6EE7B7","#F59E0B"][t%4],left:"50%",top:"20%"},initial:{scale:0,x:0,y:0},animate:{scale:[0,1,0],x:700*(Math.random()-.5),y:500*(Math.random()-.5),opacity:[1,1,0]},transition:{duration:1.8,delay:.02*t}},t))}),"complete"===i&&(0,k.jsx)("div",{className:"absolute inset-0 pointer-events-none",children:Array.from({length:20}).map((e,t)=>(0,k.jsx)(Cd.div,{className:"absolute",style:{left:"50%",top:"30%"},initial:{scale:0,x:0,y:0,opacity:1},animate:{scale:[0,1.5,0],x:500*(Math.random()-.5),y:400*(Math.random()-.5),opacity:[1,1,0]},transition:{duration:1.5,delay:.04*t},children:(0,k.jsx)(Xb,{className:"w-5 h-5 text-green-500"})},t))})]})]})})})},Sw=y("ban",[["path",{d:"M4.929 4.929 19.07 19.071",key:"196cmz"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),_w=t=>{var r,a;let{compra:n,onComplete:s}=t;const[i,o]=(0,e.useState)("start");(0,e.useEffect)(()=>{const e=[{phase:"start",duration:600},{phase:"rejecting",duration:1800},{phase:"returning",duration:2200},{phase:"canceling",duration:1500},{phase:"complete",duration:800}];let t=0;const r=()=>{if(t<e.length){const a=e[t];o(a.phase),setTimeout(()=>{t++,r()},a.duration)}else setTimeout(()=>{null===s||void 0===s||s()},500)};r()},[s]);const l=Array.from({length:20}).map((e,t)=>({id:t,angle:t/20*Math.PI*2,delay:.08*t}));return(0,k.jsx)("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:(0,k.jsx)("div",{className:"relative w-full max-w-5xl",children:(0,k.jsxs)(Cd.div,{className:"bg-gradient-to-br from-red-50 to-orange-50 dark:from-gray-800 dark:to-gray-900 rounded-3xl shadow-2xl p-8 relative overflow-hidden",initial:{scale:.8,opacity:0,y:50},animate:{scale:1,opacity:1,y:0},transition:{type:"spring",duration:.6},children:[(0,k.jsx)(Cd.div,{className:"absolute inset-0 bg-gradient-to-br from-red-500/15 to-orange-500/15",animate:{opacity:[.3,.6,.3]},transition:{duration:1.5,repeat:1/0}}),(0,k.jsxs)("div",{className:"relative z-10",children:[(0,k.jsxs)(Cd.div,{className:"text-center mb-8",initial:{y:-20,opacity:0},animate:{y:0,opacity:1},children:[(0,k.jsxs)(Cd.div,{className:"inline-flex items-center gap-3 mb-3",animate:{scale:"rejecting"===i?[1,1.05,1]:1},transition:{duration:.8,repeat:"rejecting"===i?1/0:0},children:[(0,k.jsx)(rw,{className:"w-10 h-10 text-red-600"}),(0,k.jsx)("h2",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Cancelando Compra"}),(0,k.jsx)(rw,{className:"w-10 h-10 text-red-600"})]}),(0,k.jsxs)("p",{className:"text-gray-600 dark:text-gray-400",children:["start"===i&&"Iniciando cancelamento...","rejecting"===i&&"Rejeitando pagamento...","returning"===i&&"Devolvendo ao fornecedor...","canceling"===i&&"Removendo registro...","complete"===i&&"Compra cancelada com sucesso!"]})]}),(0,k.jsxs)("div",{className:"grid grid-cols-3 gap-8 items-center",children:[(0,k.jsxs)("div",{className:"flex flex-col items-center gap-6",children:[(0,k.jsx)(Cd.div,{className:"relative",animate:{scale:"returning"===i?[1,1.05,1]:1},transition:{duration:.8,repeat:"returning"===i?1/0:0},children:(0,k.jsxs)("div",{className:"w-48 h-48 bg-gradient-to-br from-gray-400 to-gray-600 rounded-3xl flex items-center justify-center shadow-2xl relative overflow-hidden",children:[(0,k.jsx)(Md,{className:"w-20 h-20 text-white z-10"}),"returning"===i&&(0,k.jsx)(k.Fragment,{children:Array.from({length:8}).map((e,t)=>(0,k.jsx)(Cd.div,{className:"absolute w-6 h-6 bg-white/30 rounded-md",style:{left:"".concat(20+10*t,"%"),bottom:"10%"},animate:{y:[0,-180],opacity:[0,1,0],rotate:[0,-180]},transition:{duration:1.5,delay:.2*t,repeat:1/0}},t))}),"returning"===i&&(0,k.jsx)(k.Fragment,{children:[0,1,2].map(e=>(0,k.jsx)(Cd.div,{className:"absolute inset-0 border-4 border-red-400 rounded-3xl",initial:{scale:1.3,opacity:0},animate:{scale:.8,opacity:.6},exit:{scale:.8,opacity:0},transition:{duration:1.5,delay:.5*e,repeat:1/0}},e))}),"complete"===i&&(0,k.jsx)(Cd.div,{className:"absolute inset-0 bg-red-500/90 backdrop-blur-sm flex items-center justify-center rounded-3xl",initial:{scale:0,rotate:-180},animate:{scale:1,rotate:0},children:(0,k.jsx)(b,{className:"w-28 h-28 text-white"})})]})}),(0,k.jsx)(Cd.div,{className:"bg-white dark:bg-gray-800 rounded-xl p-4 shadow-lg",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},children:(0,k.jsxs)("div",{className:"flex items-center gap-3",children:[(0,k.jsx)(Cd.div,{className:"w-4 h-4 rounded-full ".concat("returning"===i?"bg-orange-500":"complete"===i?"bg-red-500":"bg-gray-500"),animate:{scale:"returning"===i?[1,1.5,1]:1},transition:{duration:1,repeat:"returning"===i?1/0:0}}),(0,k.jsx)("span",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300",children:"returning"===i?"Devolvendo...":"complete"===i?"Cancelado":"Aguardando"})]})}),(0,k.jsx)("p",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300 text-center",children:"Almoxarifado"})]}),(0,k.jsxs)("div",{className:"flex flex-col items-center gap-4",children:[(0,k.jsxs)(Cd.div,{className:"relative w-full h-32 flex items-center justify-center",animate:{x:"returning"===i?[0,-20,0]:0,scaleX:-1},transition:{duration:1.5,repeat:"returning"===i?1/0:0,ease:"easeInOut"},children:[(0,k.jsx)("div",{className:"w-24 h-24 bg-gradient-to-br from-red-400 to-red-600 rounded-2xl flex items-center justify-center shadow-2xl",children:(0,k.jsx)(Nw,{className:"w-12 h-12 text-white",style:{transform:"scaleX(-1)"}})}),"returning"===i&&(0,k.jsx)(k.Fragment,{children:Array.from({length:5}).map((e,t)=>(0,k.jsx)(Cd.div,{className:"absolute right-0 bottom-4 w-6 h-6 bg-red-400 rounded-full",initial:{scale:.2,opacity:.6,x:0},animate:{scale:1.5,opacity:0,x:50},transition:{duration:1,delay:.3*t,repeat:1/0}},t))}),(0,k.jsx)("div",{className:"absolute bottom-0 left-0 right-0 h-1 bg-gray-300 dark:bg-gray-600",children:"returning"===i&&(0,k.jsx)(Cd.div,{className:"h-full w-1/4 bg-red-500",animate:{x:["400%","0%"]},transition:{duration:1,repeat:1/0,ease:"linear"}})})]}),(0,k.jsxs)(Cd.div,{className:"bg-white dark:bg-gray-800 rounded-xl p-3 shadow-lg",animate:{scale:"returning"===i?[1,1.05,1]:1},transition:{duration:1,repeat:"returning"===i?1/0:0},children:[(0,k.jsxs)("div",{className:"flex items-center gap-2",children:[(0,k.jsx)(b,{className:"w-5 h-5 text-red-500"}),(0,k.jsxs)("span",{className:"text-lg font-bold text-gray-900 dark:text-white",children:[(null===n||void 0===n?void 0:n.quantidade)||0,"x"]})]}),(0,k.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Em Devolu\xe7\xe3o"})]}),"returning"===i&&(0,k.jsx)("div",{className:"w-full",children:(0,k.jsx)("div",{className:"h-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden",children:(0,k.jsx)(Cd.div,{className:"h-full bg-gradient-to-r from-red-600 to-red-500",initial:{width:"100%"},animate:{width:"0%"},transition:{duration:2,repeat:1/0}})})}),(0,k.jsx)("p",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300 text-center",children:"Devolu\xe7\xe3o em Andamento"})]}),(0,k.jsxs)("div",{className:"flex flex-col items-center gap-6",children:[(0,k.jsxs)(Cd.div,{className:"relative",animate:{scale:"rejecting"===i?[1,1.1,1]:1,rotate:"rejecting"===i?[0,-5,5,-5,5,0]:0},transition:{duration:.8,repeat:"rejecting"===i?1/0:0},children:[(0,k.jsxs)("div",{className:"w-32 h-32 bg-gradient-to-br from-red-400 to-red-600 rounded-3xl flex items-center justify-center shadow-2xl relative",children:[(0,k.jsx)(Pr,{mode:"wait",children:"start"===i||"rejecting"===i?(0,k.jsxs)(Cd.div,{className:"relative",initial:{scale:1},animate:{scale:1},children:[(0,k.jsx)(qb,{className:"w-16 h-16 text-white"}),(0,k.jsx)(Cd.div,{className:"absolute inset-0 flex items-center justify-center",initial:{scale:0,rotate:-180},animate:{scale:1,rotate:0},transition:{delay:.2},children:(0,k.jsx)("div",{className:"w-20 h-20 bg-white rounded-full flex items-center justify-center",children:(0,k.jsx)(Id,{className:"w-16 h-16 text-red-600",strokeWidth:3})})})]},"cart"):(0,k.jsx)(Cd.div,{initial:{scale:0,rotate:180},animate:{scale:1,rotate:0},children:(0,k.jsx)(Sw,{className:"w-16 h-16 text-white"})},"ban")}),"rejecting"===i&&(0,k.jsx)("div",{className:"absolute inset-0",children:l.map(e=>(0,k.jsx)(Cd.div,{className:"absolute",style:{left:"50%",top:"50%"},animate:{x:100*Math.cos(e.angle),y:100*Math.sin(e.angle),scale:[0,1,0],rotate:[0,360],opacity:[0,1,0]},transition:{duration:1.5,delay:e.delay,repeat:1/0},children:(0,k.jsx)(Id,{className:"w-4 h-4 text-red-600",strokeWidth:3})},e.id))})]}),"rejecting"===i&&(0,k.jsx)(k.Fragment,{children:[0,1,2].map(e=>(0,k.jsx)(Cd.div,{className:"absolute inset-0 border-4 border-red-500 rounded-3xl",initial:{scale:1,opacity:.6},animate:{scale:2,opacity:0},transition:{duration:1.5,delay:.5*e,repeat:1/0}},e))})]}),(0,k.jsxs)(Cd.div,{className:"bg-gradient-to-r from-red-500 to-red-600 rounded-xl p-4 shadow-xl w-48 relative",initial:{rotateY:0},animate:{rotateY:"rejecting"===i?[0,180,360]:0,scale:"rejecting"===i?[1,1.05,1]:1},transition:{duration:2,repeat:"rejecting"===i?1/0:0},children:[(0,k.jsx)(Cd.div,{className:"absolute inset-0 flex items-center justify-center",initial:{scale:0,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.3},children:(0,k.jsx)(Id,{className:"w-24 h-24 text-white",strokeWidth:4})}),(0,k.jsx)(kw,{className:"w-8 h-8 text-white/50 mb-2"}),(0,k.jsx)("div",{className:"text-white/50 text-xs font-mono line-through",children:"\u2022\u2022\u2022\u2022 \u2022\u2022\u2022\u2022 \u2022\u2022\u2022\u2022 \u2022\u2022\u2022\u2022"}),(0,k.jsxs)("div",{className:"flex justify-between items-center mt-2",children:[(0,k.jsx)("span",{className:"text-white/50 text-xs line-through",children:"Valor:"}),(0,k.jsxs)("span",{className:"text-white text-sm font-bold line-through",children:["R$ ",(null===n||void 0===n||null===(r=n.valor)||void 0===r?void 0:r.toFixed(2))||"0.00"]})]}),(0,k.jsxs)("div",{className:"mt-2 flex items-center justify-center gap-1",children:[(0,k.jsx)(b,{className:"w-4 h-4 text-white"}),(0,k.jsx)("span",{className:"text-white text-xs font-bold uppercase",children:"NEGADO"})]})]}),(0,k.jsx)("p",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300 text-center",children:"Pagamento Rejeitado"})]})]}),(0,k.jsx)(Cd.div,{className:"mt-8 bg-red-100 dark:bg-red-900/20 border-2 border-red-500 rounded-2xl p-6",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.6},children:(0,k.jsxs)("div",{className:"flex items-start gap-4",children:[(0,k.jsx)(Sw,{className:"w-6 h-6 text-red-600 dark:text-red-400 flex-shrink-0 mt-1"}),(0,k.jsxs)("div",{className:"flex-1",children:[(0,k.jsx)("h4",{className:"text-sm font-bold text-red-900 dark:text-red-300 mb-2",children:"Compra Cancelada"}),(0,k.jsx)("p",{className:"text-xs text-red-700 dark:text-red-400",children:"A compra foi rejeitada e os itens est\xe3o sendo devolvidos ao fornecedor. O registro ser\xe1 removido do sistema."})]})]})}),(0,k.jsxs)(Cd.div,{className:"mt-6 bg-white dark:bg-gray-800 rounded-xl p-6 shadow-inner opacity-50",initial:{opacity:0,y:20},animate:{opacity:.5,y:0},transition:{delay:.7},children:[(0,k.jsx)("h4",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-3 line-through",children:"Detalhes da compra cancelada:"}),(0,k.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,k.jsxs)("div",{className:"flex flex-col",children:[(0,k.jsx)("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Item:"}),(0,k.jsx)("span",{className:"text-sm font-semibold text-gray-900 dark:text-white line-through",children:(null===n||void 0===n?void 0:n.item)||"N/A"})]}),(0,k.jsxs)("div",{className:"flex flex-col",children:[(0,k.jsx)("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Quantidade:"}),(0,k.jsx)("span",{className:"text-sm font-semibold text-gray-900 dark:text-white line-through",children:(null===n||void 0===n?void 0:n.quantidade)||0})]}),(0,k.jsxs)("div",{className:"flex flex-col",children:[(0,k.jsx)("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Valor Total:"}),(0,k.jsxs)("span",{className:"text-sm font-semibold text-gray-900 dark:text-white line-through",children:["R$ ",(null===n||void 0===n||null===(a=n.valor)||void 0===a?void 0:a.toFixed(2))||"0.00"]})]}),(null===n||void 0===n?void 0:n.fornecedor)&&(0,k.jsxs)("div",{className:"flex flex-col",children:[(0,k.jsx)("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:"Fornecedor:"}),(0,k.jsx)("span",{className:"text-sm font-semibold text-gray-900 dark:text-white line-through",children:n.fornecedor})]})]})]}),(0,k.jsx)("div",{className:"mt-6 h-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden",children:(0,k.jsx)(Cd.div,{className:"h-full bg-gradient-to-r from-red-600 to-red-500",initial:{width:"0%"},animate:{width:"start"===i?"15%":"rejecting"===i?"35%":"returning"===i?"70%":"canceling"===i?"90%":"100%"},transition:{duration:.5}})}),"complete"===i&&(0,k.jsx)("div",{className:"absolute inset-0 pointer-events-none",children:Array.from({length:50}).map((e,t)=>(0,k.jsx)(Cd.div,{className:"absolute",style:{left:"50%",top:"20%"},initial:{scale:0,x:0,y:0},animate:{scale:[0,1,0],x:700*(Math.random()-.5),y:500*(Math.random()-.5),opacity:[1,1,0],rotate:[0,720*Math.random()]},transition:{duration:1.8,delay:.02*t},children:(0,k.jsx)(Id,{className:"w-6 h-6 text-red-600",strokeWidth:3})},t))}),"complete"===i&&(0,k.jsx)("div",{className:"absolute inset-0 pointer-events-none",children:Array.from({length:15}).map((e,t)=>(0,k.jsx)(Cd.div,{className:"absolute",style:{left:"50%",top:"30%"},initial:{scale:0,x:0,y:0,opacity:1},animate:{scale:[0,1.5,0],x:500*(Math.random()-.5),y:400*(Math.random()-.5),opacity:[1,1,0],rotate:[0,360]},transition:{duration:1.5,delay:.04*t},children:(0,k.jsx)(Sw,{className:"w-8 h-8 text-red-600"})},t))})]})]})})})},Ew="solicitado",Aw={solicitado:"Solicitado",aprovado:"Aprovado",pedido_enviado:"Pedido Enviado",recebido:"Recebido",cancelado:"Cancelado"},Cw="media",Iw={baixa:"Baixa",media:"M\xe9dia",alta:"Alta",urgente:"Urgente"},Tw=t=>{let{compras:r,inventario:a,funcionarios:s,adicionarCompra:i,removerCompra:o,atualizarCompra:l,readonly:c=!1}=t;const{colors:d,classes:u}=hw,{usuario:h}=Nt(),{canViewAllSectors:m}=cu(),f=m,g=(0,e.useMemo)(()=>f?r:Dt.filterBySector(r,h),[r,h,f]),[p,x]=(0,e.useState)(""),[y,v]=(0,e.useState)("todos"),[b,w]=(0,e.useState)("todas"),[N,j]=(0,e.useState)(!1),[S,_]=(0,e.useState)(!1),[E,A]=(0,e.useState)(null),[C,T]=(0,e.useState)(null),[P,F]=(0,e.useState)({descricao:"",quantidade:1,valorUnitario:"",valorFrete:"",fornecedor:"",prioridade:Cw,solicitante:"",observacoes:"",link:"",status:Ew}),[L,M]=(0,e.useState)(null),[R,O]=(0,e.useState)(!1),[B,z]=(0,e.useState)(null),[U,V]=(0,e.useState)(!1),[q,H]=(0,e.useState)(null),G=g.filter(e=>{var t,r,a;const n=""===p||(null===(t=e.descricao)||void 0===t?void 0:t.toLowerCase().includes(p.toLowerCase()))||(null===(r=e.fornecedor)||void 0===r?void 0:r.toLowerCase().includes(p.toLowerCase()))||(null===(a=e.solicitante)||void 0===a?void 0:a.toLowerCase().includes(p.toLowerCase())),s="todos"===y||e.status===y,i="todas"===b||e.prioridade===b;return n&&s&&i}),W=G.reduce((e,t)=>(e.total++,e[t.status]=(e[t.status]||0)+1,e.valorTotal+=t.quantidade*t.valorUnitario+(t.valorFrete||0),e),{total:0,solicitado:0,aprovado:0,pedido_enviado:0,recebido:0,cancelado:0,valorTotal:0}),K=e=>{T(e),F({id:e.id,descricao:e.descricao,quantidade:e.quantidade,valorUnitario:e.valorUnitario,valorFrete:e.valorFrete||"",fornecedor:e.fornecedor||"",prioridade:e.prioridade,solicitante:e.solicitante,observacoes:e.observacoes||"",link:e.link||"",status:e.status}),j(!0)},Q=e=>{A(e),_(!0)};return(0,k.jsxs)("div",{className:"space-y-4",children:[!f&&(null===h||void 0===h?void 0:h.setor)&&(0,k.jsxs)("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-3 flex items-center gap-2",children:[(0,k.jsx)(I,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"}),(0,k.jsxs)("p",{className:"text-sm text-blue-800 dark:text-blue-300",children:[(0,k.jsx)("strong",{children:"Visualiza\xe7\xe3o por setor:"})," Voc\xea est\xe1 vendo apenas as compras do setor ",(0,k.jsx)("strong",{children:h.setor}),"."]})]}),(0,k.jsxs)("div",{className:"flex justify-between items-center",children:[(0,k.jsx)("h2",{className:"text-xl font-semibold ".concat(d.text),children:"Compras"}),!c&&(0,k.jsxs)("button",{onClick:()=>j(!0),className:"flex items-center gap-2 px-4 py-2 bg-blue-500 dark:bg-blue-600 text-white rounded-full hover:bg-blue-600 dark:hover:bg-blue-700 transition-colors",children:[(0,k.jsx)(D,{className:"w-4 h-4"}),"Nova Compra"]})]}),(0,k.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-4",children:[(0,k.jsx)("div",{className:"bg-gray-200 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-xl shadow-sm p-4",children:(0,k.jsxs)("div",{className:"flex flex-col",children:[(0,k.jsx)("p",{className:"text-sm font-medium ".concat(d.textSecondary),children:"Total"}),(0,k.jsx)("p",{className:"text-xl font-bold ".concat(d.text),children:W.total})]})}),(0,k.jsx)("div",{className:"bg-gray-200 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-xl shadow-sm p-4",children:(0,k.jsxs)("div",{className:"flex flex-col",children:[(0,k.jsx)("p",{className:"text-sm font-medium ".concat(d.textSecondary),children:"Solicitado"}),(0,k.jsx)("p",{className:"text-xl font-bold ".concat(d.text),children:W.solicitado})]})}),(0,k.jsx)("div",{className:"bg-gray-200 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-xl shadow-sm p-4",children:(0,k.jsxs)("div",{className:"flex flex-col",children:[(0,k.jsx)("p",{className:"text-sm font-medium ".concat(d.textSecondary),children:"Aprovado"}),(0,k.jsx)("p",{className:"text-xl font-bold ".concat(d.text),children:W.aprovado})]})}),(0,k.jsx)("div",{className:"bg-gray-200 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-xl shadow-sm p-4",children:(0,k.jsxs)("div",{className:"flex flex-col",children:[(0,k.jsx)("p",{className:"text-sm font-medium ".concat(d.textSecondary),children:"Enviado"}),(0,k.jsx)("p",{className:"text-xl font-bold ".concat(d.text),children:W.pedido_enviado})]})}),(0,k.jsx)("div",{className:"bg-gray-200 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-xl shadow-sm p-4",children:(0,k.jsxs)("div",{className:"flex flex-col",children:[(0,k.jsx)("p",{className:"text-sm font-medium ".concat(d.textSecondary),children:"Recebido"}),(0,k.jsx)("p",{className:"text-xl font-bold ".concat(d.text),children:W.recebido})]})})]}),(0,k.jsx)("div",{className:"bg-gray-200 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-xl shadow-sm p-4 space-y-4",children:(0,k.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,k.jsxs)("div",{className:"relative",children:[(0,k.jsx)(Ft,{className:"w-4 h-4 absolute left-3 top-1/2 -translate-y-1/2 text-gray-500 dark:text-gray-400"}),(0,k.jsx)("input",{type:"text",placeholder:"     Pesquisar compras...",value:p,onChange:e=>x(e.target.value),className:"h-10 w-full pl-10 pr-4 bg-gray-50 dark:bg-gray-800 border border-gray-200 dark:border-gray-600 rounded-full text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-gray-400 dark:focus:ring-gray-500 text-sm"})]}),(0,k.jsxs)("select",{value:y,onChange:e=>v(e.target.value),className:"bg-white dark:bg-gray-700 border border-gray-200 dark:border-gray-600 text-gray-900 dark:text-white rounded-full px-4 h-10 focus:outline-none focus:ring-2 focus:ring-gray-400 dark:focus:ring-gray-500 text-sm [&>option]:bg-white [&>option]:dark:bg-gray-700",children:[(0,k.jsx)("option",{value:"todos",children:"Todos os status"}),Object.entries(Aw).map(e=>{let[t,r]=e;return(0,k.jsx)("option",{value:t,children:r},t)})]}),(0,k.jsxs)("select",{value:b,onChange:e=>w(e.target.value),className:"bg-white dark:bg-gray-700 border border-gray-200 dark:border-gray-600 text-gray-900 dark:text-white rounded-full px-4 h-10 focus:outline-none focus:ring-2 focus:ring-gray-400 dark:focus:ring-gray-500 text-sm [&>option]:bg-white [&>option]:dark:bg-gray-700",children:[(0,k.jsx)("option",{value:"todas",children:"Todas as prioridades"}),Object.entries(Iw).map(e=>{let[t,r]=e;return(0,k.jsx)("option",{value:t,children:r},t)})]})]})}),(0,k.jsx)("div",{className:"mt-4 ".concat(0===G.length?"text-center p-4":""),children:G.length>0?(0,k.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:G.map(e=>(0,k.jsx)(ww,{compra:e,onEdit:K,onDelete:Q,onUpdate:e=>l(e.id,e),readonly:c},e.id))}):(0,k.jsx)("p",{className:"text-sm ".concat(d.textSecondary),children:"Nenhuma compra encontrada"})}),N&&(0,k.jsx)("div",{className:"fixed inset-0 bg-black/50 dark:bg-black/70 flex items-center justify-center z-50",children:(0,k.jsx)("div",{className:"bg-gray-200 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-xl shadow-sm p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:(0,k.jsxs)("form",{onSubmit:e=>{if(e.preventDefault(),!P.descricao||!P.quantidade||!P.valorUnitario||!P.solicitante)return void alert("Por favor, preencha todos os campos obrigat\xf3rios.");const t=(0,n.A)((0,n.A)({},P),{},{quantidade:parseInt(P.quantidade),valorUnitario:parseFloat(P.valorUnitario),valorFrete:P.valorFrete?parseFloat(P.valorFrete):0,status:P.status||Ew});if(C)l(C.id,t),j(!1),T(null),F({descricao:"",quantidade:1,valorUnitario:"",valorFrete:"",fornecedor:"",prioridade:Cw,solicitante:"",observacoes:"",link:"",status:Ew});else{const e=t.quantidade*t.valorUnitario+t.valorFrete;z({item:t.descricao,quantidade:t.quantidade,valor:e,fornecedor:t.fornecedor||"Fornecedor n\xe3o especificado",compraCompleta:t}),j(!1),O(!0)}},className:"space-y-4",children:[(0,k.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,k.jsx)("h3",{className:"text-lg font-medium ".concat(d.text),children:C?"Editar Compra":"Nova Solicita\xe7\xe3o de Compra"}),(0,k.jsx)("button",{type:"button",onClick:()=>{j(!1),T(null),F({descricao:"",quantidade:1,valorUnitario:"",fornecedor:"",prioridade:Cw,solicitante:"",observacoes:"",link:"",status:Ew})},className:"".concat(d.textSecondary," hover:").concat(d.text),children:"\u2715"})]}),(0,k.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,k.jsxs)("div",{className:"md:col-span-2",children:[(0,k.jsx)("label",{className:"block text-sm font-medium ".concat(d.text," mb-2"),children:"Descri\xe7\xe3o do Item *"}),(0,k.jsx)("input",{type:"text",value:P.descricao,onChange:e=>F((0,n.A)((0,n.A)({},P),{},{descricao:e.target.value})),className:"w-full px-4 py-2 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-gray-400 dark:focus:ring-gray-500",placeholder:"Ex: Furadeira el\xe9trica 1/2",required:!0})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium ".concat(d.text," mb-2"),children:"Quantidade *"}),(0,k.jsx)("input",{type:"number",min:"1",value:P.quantidade,onChange:e=>F((0,n.A)((0,n.A)({},P),{},{quantidade:e.target.value})),className:"w-full px-4 py-2 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-gray-400 dark:focus:ring-gray-500",required:!0})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium ".concat(d.text," mb-2"),children:"Valor Unit\xe1rio *"}),(0,k.jsx)("input",{type:"number",min:"0",step:"0.01",value:P.valorUnitario,onChange:e=>F((0,n.A)((0,n.A)({},P),{},{valorUnitario:e.target.value})),className:"w-full px-4 py-2 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-gray-400 dark:focus:ring-gray-500",required:!0})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium ".concat(d.text," mb-2"),children:"Valor do Frete"}),(0,k.jsx)("input",{type:"number",min:"0",step:"0.01",value:P.valorFrete,onChange:e=>F((0,n.A)((0,n.A)({},P),{},{valorFrete:e.target.value})),className:"w-full px-4 py-2 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-gray-400 dark:focus:ring-gray-500",placeholder:"Deixe vazio para frete gr\xe1tis"})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium ".concat(d.text," mb-2"),children:"Fornecedor"}),(0,k.jsx)("input",{type:"text",value:P.fornecedor,onChange:e=>F((0,n.A)((0,n.A)({},P),{},{fornecedor:e.target.value})),className:"w-full px-4 py-2 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-gray-400 dark:focus:ring-gray-500",placeholder:"Nome do fornecedor"})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium ".concat(d.text," mb-2"),children:"Solicitante *"}),(0,k.jsx)("input",{type:"text",value:P.solicitante,onChange:e=>F((0,n.A)((0,n.A)({},P),{},{solicitante:e.target.value})),className:"w-full px-4 py-2 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-gray-400 dark:focus:ring-gray-500",required:!0})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium ".concat(d.text," mb-2"),children:"Status"}),(0,k.jsx)("select",{value:P.status,onChange:e=>F((0,n.A)((0,n.A)({},P),{},{status:e.target.value})),className:"w-full h-[38px] appearance-none bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg px-4 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-gray-400 dark:focus:ring-gray-500",style:{backgroundImage:"url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='%238899A6'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M19 9l-7 7-7-7'%3E%3C/path%3E%3C/svg%3E\")",backgroundRepeat:"no-repeat",backgroundPosition:"right 10px center",backgroundSize:"20px"},children:Object.entries(Aw).map(e=>{let[t,r]=e;return(0,k.jsx)("option",{value:t,className:"bg-gray-50 dark:bg-gray-700",children:r},t)})})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium ".concat(d.text," mb-2"),children:"Prioridade *"}),(0,k.jsx)("select",{value:P.prioridade,onChange:e=>F((0,n.A)((0,n.A)({},P),{},{prioridade:e.target.value})),className:"w-full h-[38px] appearance-none bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg px-4 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-gray-400 dark:focus:ring-gray-500",style:{backgroundImage:"url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='%238899A6'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M19 9l-7 7-7-7'%3E%3C/path%3E%3C/svg%3E\")",backgroundRepeat:"no-repeat",backgroundPosition:"right 10px center",backgroundSize:"20px"},required:!0,children:Object.entries(Iw).map(e=>{let[t,r]=e;return(0,k.jsx)("option",{value:t,className:"bg-white dark:bg-gray-700 dark:bg-gray-700",children:r},t)})})]}),(0,k.jsxs)("div",{className:"md:col-span-2",children:[(0,k.jsx)("label",{className:"block text-sm font-medium ".concat(d.text," mb-2"),children:"Link do Produto"}),(0,k.jsx)("input",{type:"url",value:P.link,onChange:e=>F((0,n.A)((0,n.A)({},P),{},{link:e.target.value})),className:"w-full px-4 py-2 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-gray-400 dark:focus:ring-gray-500",placeholder:"https://..."})]}),(0,k.jsxs)("div",{className:"md:col-span-2",children:[(0,k.jsx)("label",{className:"block text-sm font-medium ".concat(d.text," mb-2"),children:"Observa\xe7\xf5es"}),(0,k.jsx)("textarea",{value:P.observacoes,onChange:e=>F((0,n.A)((0,n.A)({},P),{},{observacoes:e.target.value})),className:"w-full h-24 resize-none px-4 py-2 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-gray-400 dark:focus:ring-gray-500",placeholder:"Informa\xe7\xf5es adicionais sobre a compra..."})]})]}),(0,k.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,k.jsxs)("button",{type:"button",onClick:()=>{j(!1),T(null),F({descricao:"",quantidade:1,valorUnitario:"",fornecedor:"",prioridade:Cw,solicitante:"",observacoes:"",link:"",status:Ew})},className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-600 transition-colors duration-200",children:[(0,k.jsx)(Id,{className:"w-4 h-4"}),"Cancelar"]}),(0,k.jsx)("button",{type:"submit",className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-blue-500 dark:bg-blue-600 rounded-lg hover:bg-blue-600 dark:hover:bg-blue-700 transition-colors duration-200",children:C?(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(uw,{className:"w-4 h-4"}),"Salvar Altera\xe7\xf5es"]}):(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(D,{className:"w-4 h-4"}),"Adicionar Compra"]})})]})]})})}),S&&(0,k.jsx)("div",{className:"fixed inset-0 bg-black/50 dark:bg-black/70 flex items-center justify-center z-50",children:(0,k.jsxs)("div",{className:"bg-gray-200 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-xl shadow-sm p-6 max-w-md",children:[(0,k.jsx)("h3",{className:"text-lg font-medium ".concat(d.text," mb-4"),children:"Confirmar Exclus\xe3o"}),(0,k.jsx)("p",{className:"".concat(d.textSecondary," mb-6"),children:"Tem certeza que deseja excluir esta compra?"}),(0,k.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,k.jsxs)("button",{onClick:()=>{_(!1),A(null)},className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-600 transition-colors duration-200",children:[(0,k.jsx)(Id,{className:"w-4 h-4"}),"Cancelar"]}),(0,k.jsxs)("button",{onClick:()=>{if(E){const e=E.quantidade*E.valorUnitario+(E.valorFrete||0);H({item:E.descricao,quantidade:E.quantidade,valor:e,fornecedor:E.fornecedor||"Fornecedor n\xe3o especificado",compraId:E.id}),_(!1),V(!0)}},className:"flex items-center gap-2 px-4 py-2 text-sm font-medium text-white bg-red-600 dark:bg-red-500 rounded-lg hover:bg-red-700 dark:hover:bg-red-400 transition-colors duration-200",children:[(0,k.jsx)(nw,{className:"w-4 h-4"}),"Excluir"]})]})]})}),R&&B&&(0,k.jsx)(jw,{compra:{item:B.item,quantidade:B.quantidade,valor:B.valor,fornecedor:B.fornecedor},onComplete:()=>{B&&(i(B.compraCompleta),F({descricao:"",quantidade:1,valorUnitario:"",valorFrete:"",fornecedor:"",prioridade:Cw,solicitante:"",observacoes:"",link:"",status:Ew})),O(!1),z(null)}}),U&&q&&(0,k.jsx)(_w,{compra:{item:q.item,quantidade:q.quantidade,valor:q.valor,fornecedor:q.fornecedor},onComplete:()=>{q&&"function"===typeof o&&o(q.compraId),V(!1),H(null),A(null)}})]})},Dw=y("flame",[["path",{d:"M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z",key:"96xj49"}]]),Pw=t=>{var r;let{ferramenta:a,onComplete:n}=t;const[s,i]=(0,e.useState)("start");(0,e.useEffect)(()=>{const e=[{phase:"start",duration:500},{phase:"detecting",duration:1500},{phase:"breaking",duration:2e3},{phase:"reporting",duration:1500},{phase:"complete",duration:800}];let t=0;const r=()=>{if(t<e.length){const a=e[t];i(a.phase),setTimeout(()=>{t++,r()},a.duration)}else setTimeout(()=>{null===n||void 0===n||n()},500)};r()},[n]);const o=Array.from({length:25}).map((e,t)=>({id:t,angle:t/25*Math.PI*2,distance:80+60*Math.random(),delay:.05*t})),l=Array.from({length:8}).map((e,t)=>({id:t,angle:t/8*Math.PI*2}));return(0,k.jsx)("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:(0,k.jsx)("div",{className:"relative w-full max-w-4xl",children:(0,k.jsxs)(Cd.div,{className:"bg-gradient-to-br from-red-50 to-orange-50 dark:from-gray-800 dark:to-gray-900 rounded-3xl shadow-2xl p-8 relative overflow-hidden",initial:{scale:.9,opacity:0,rotate:-5},animate:{scale:1,opacity:1,rotate:0},transition:{type:"spring",duration:.6},children:[(0,k.jsx)(Cd.div,{className:"absolute inset-0 bg-gradient-to-br from-red-500/20 to-orange-500/20",animate:{opacity:"detecting"===s||"breaking"===s?[.2,.5,.2]:.2},transition:{duration:1,repeat:1/0}}),(0,k.jsxs)("div",{className:"relative z-10",children:[(0,k.jsxs)(Cd.div,{className:"text-center mb-8",initial:{y:-20,opacity:0},animate:{y:0,opacity:1},children:[(0,k.jsxs)(Cd.div,{className:"inline-flex items-center gap-3 mb-3",animate:{scale:"detecting"===s?[1,1.1,1]:1},transition:{duration:.8,repeat:"detecting"===s?1/0:0},children:[(0,k.jsx)(rw,{className:"w-10 h-10 text-red-600"}),(0,k.jsx)("h2",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Ferramenta Danificada"}),(0,k.jsx)(rw,{className:"w-10 h-10 text-red-600"})]}),(0,k.jsxs)("p",{className:"text-gray-600 dark:text-gray-400",children:["start"===s&&"Iniciando registro...","detecting"===s&&"Detectando problema...","breaking"===s&&"Registrando dano...","reporting"===s&&"Gerando relat\xf3rio...","complete"===s&&"Dano registrado com sucesso!"]})]}),(0,k.jsxs)("div",{className:"flex flex-col items-center gap-8",children:[(0,k.jsxs)("div",{className:"relative",children:[(0,k.jsxs)(Cd.div,{className:"w-48 h-48 bg-gradient-to-br from-gray-400 to-gray-600 rounded-3xl flex items-center justify-center shadow-2xl relative overflow-hidden",animate:{rotate:"breaking"===s?[0,-5,5,-5,5,0]:0,scale:"breaking"===s?[1,.95,1.05,.95,1]:1},transition:{duration:.5,repeat:"breaking"===s?1/0:0},children:["breaking"===s&&(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(Cd.div,{className:"absolute top-1/4 left-0 right-0 h-1 bg-red-600",initial:{scaleX:0,opacity:0},animate:{scaleX:1,opacity:1},transition:{duration:.5}}),(0,k.jsx)(Cd.div,{className:"absolute top-0 bottom-0 left-1/3 w-1 bg-red-600",initial:{scaleY:0,opacity:0},animate:{scaleY:1,opacity:1},transition:{duration:.5,delay:.2}}),(0,k.jsx)(Cd.div,{className:"absolute top-2/3 left-0 right-0 h-1 bg-red-600",initial:{scaleX:0,opacity:0},animate:{scaleX:1,opacity:1},transition:{duration:.5,delay:.4}})]}),(0,k.jsx)(Hb,{className:"w-24 h-24 text-white z-10"}),"breaking"===s&&(0,k.jsx)("div",{className:"absolute inset-0",children:o.map(e=>(0,k.jsx)(Cd.div,{className:"absolute w-2 h-2 bg-red-600 rounded-sm",style:{left:"50%",top:"50%"},animate:{x:Math.cos(e.angle)*e.distance,y:Math.sin(e.angle)*e.distance,scale:[1,.5,0],rotate:[0,360*Math.random()],opacity:[1,.7,0]},transition:{duration:1.5,delay:e.delay,repeat:1/0}},e.id))}),"breaking"===s&&(0,k.jsx)(k.Fragment,{children:[0,1,2,3].map(e=>(0,k.jsx)(Cd.div,{className:"absolute inset-0 border-4 border-red-500 rounded-3xl",initial:{scale:1,opacity:.8},animate:{scale:1.5,opacity:0},transition:{duration:1,delay:.25*e,repeat:1/0}},e))}),"breaking"===s&&(0,k.jsx)(k.Fragment,{children:Array.from({length:6}).map((e,t)=>(0,k.jsx)(Cd.div,{className:"absolute",style:{left:"".concat(15+15*t,"%"),bottom:"-10%"},animate:{y:[0,-100],opacity:[0,1,0],scale:[.5,1,.5]},transition:{duration:1.5,delay:.2*t,repeat:1/0},children:(0,k.jsx)(Dw,{className:"w-6 h-6 text-orange-500"})},t))})]}),"detecting"===s&&(0,k.jsx)("div",{className:"absolute inset-0",children:l.map(e=>(0,k.jsx)(Cd.div,{className:"absolute left-1/2 top-1/2 w-1 h-24 bg-gradient-to-t from-red-500 to-transparent origin-bottom",style:{transform:"rotate(".concat(180*e.angle/Math.PI,"deg) translateY(-50%)")},animate:{opacity:[0,1,0],scaleY:[.5,1,.5]},transition:{duration:1.5,repeat:1/0,delay:.1*e.id}},e.id))}),"complete"===s&&(0,k.jsx)(Cd.div,{className:"absolute inset-0 flex items-center justify-center",initial:{scale:0,rotate:-180},animate:{scale:1,rotate:0},children:(0,k.jsx)("div",{className:"w-32 h-32 bg-red-600/90 rounded-full flex items-center justify-center",children:(0,k.jsx)(b,{className:"w-20 h-20 text-white"})})})]}),(0,k.jsxs)(Cd.div,{className:"bg-white dark:bg-gray-800 rounded-2xl p-6 shadow-xl min-w-[400px]",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},children:[(0,k.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,k.jsx)("span",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300",children:"N\xedvel de Gravidade:"}),(0,k.jsx)(Cd.div,{className:"px-4 py-2 rounded-full font-bold text-sm ".concat("alta"===(null===a||void 0===a?void 0:a.gravidade)?"bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-400":"m\xe9dia"===(null===a||void 0===a?void 0:a.gravidade)?"bg-orange-100 dark:bg-orange-900/30 text-orange-700 dark:text-orange-400":"bg-yellow-100 dark:bg-yellow-900/30 text-yellow-700 dark:text-yellow-400"),animate:{scale:"detecting"===s||"breaking"===s?[1,1.1,1]:1},transition:{duration:.8,repeat:"detecting"===s||"breaking"===s?1/0:0},children:(null===a||void 0===a||null===(r=a.gravidade)||void 0===r?void 0:r.toUpperCase())||"INDEFINIDA"})]}),(0,k.jsx)("div",{className:"space-y-2",children:["Baixa","M\xe9dia","Alta"].map((e,t)=>(0,k.jsxs)("div",{className:"flex items-center gap-3",children:[(0,k.jsx)("span",{className:"text-xs text-gray-600 dark:text-gray-400 w-12",children:e}),(0,k.jsx)("div",{className:"flex-1 h-3 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden",children:(0,k.jsx)(Cd.div,{className:"h-full ".concat(0===t?"bg-yellow-500":1===t?"bg-orange-500":"bg-red-500"),initial:{width:"0%"},animate:{width:"alta"===(null===a||void 0===a?void 0:a.gravidade)&&2===t||"m\xe9dia"===(null===a||void 0===a?void 0:a.gravidade)&&1===t||"baixa"===(null===a||void 0===a?void 0:a.gravidade)&&0===t?"100%":"0%"},transition:{duration:.8,delay:.5+.2*t}})})]},e))})]}),(0,k.jsxs)(Cd.div,{className:"bg-white dark:bg-gray-800 rounded-2xl p-6 shadow-xl w-full",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5},children:[(0,k.jsx)("h4",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-4",children:"Informa\xe7\xf5es do Dano:"}),(0,k.jsxs)("div",{className:"grid grid-cols-2 gap-6",children:[(0,k.jsxs)("div",{className:"flex flex-col",children:[(0,k.jsx)("span",{className:"text-xs text-gray-600 dark:text-gray-400 mb-1",children:"Ferramenta:"}),(0,k.jsx)("span",{className:"text-base font-semibold text-gray-900 dark:text-white",children:(null===a||void 0===a?void 0:a.nome)||"N/A"})]}),(0,k.jsxs)("div",{className:"flex flex-col",children:[(0,k.jsx)("span",{className:"text-xs text-gray-600 dark:text-gray-400 mb-1",children:"Status:"}),(0,k.jsx)("span",{className:"text-base font-semibold text-red-600 dark:text-red-400",children:"DANIFICADA"})]}),(null===a||void 0===a?void 0:a.motivo)&&(0,k.jsxs)("div",{className:"flex flex-col col-span-2",children:[(0,k.jsx)("span",{className:"text-xs text-gray-600 dark:text-gray-400 mb-1",children:"Motivo do Dano:"}),(0,k.jsx)("span",{className:"text-sm text-gray-900 dark:text-white",children:a.motivo})]})]})]})]}),(0,k.jsx)("div",{className:"mt-8 h-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden",children:(0,k.jsx)(Cd.div,{className:"h-full bg-gradient-to-r from-red-500 to-orange-600",initial:{width:"0%"},animate:{width:"start"===s?"20%":"detecting"===s?"40%":"breaking"===s?"70%":"reporting"===s?"90%":"100%"},transition:{duration:.5}})}),"complete"===s&&(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)("div",{className:"absolute inset-0 pointer-events-none",children:Array.from({length:12}).map((e,t)=>(0,k.jsx)(Cd.div,{className:"absolute left-1/2 top-1/2 w-2 h-40 bg-gradient-to-t from-red-500 to-transparent origin-bottom",style:{transform:"rotate(".concat(30*t,"deg)")},initial:{opacity:0,scaleY:0},animate:{opacity:[0,1,0],scaleY:[0,1,0]},transition:{duration:1,delay:.05*t}},t))}),(0,k.jsx)("div",{className:"absolute inset-0 pointer-events-none",children:Array.from({length:25}).map((e,t)=>(0,k.jsx)(Cd.div,{className:"absolute",style:{left:"50%",top:"50%"},initial:{scale:0,x:0,y:0},animate:{scale:[0,1,0],x:600*(Math.random()-.5),y:400*(Math.random()-.5),opacity:[1,1,0]},transition:{duration:1.2,delay:.03*t},children:(0,k.jsx)(rw,{className:"w-4 h-4 text-red-600"})},t))})]})]})]})})})},{classes:Fw,colors:Lw}=hw,Mw=t=>{let{ferramentasDanificadas:r=[],inventario:a=[],adicionarFerramentaDanificada:s=()=>{},atualizarFerramentaDanificada:i=()=>{},removerFerramentaDanificada:o=()=>{},readonly:l=!1}=t;const{usuario:c}=Nt(),d="funcionario"===(null===c||void 0===c?void 0:c.nivel),{canViewAllSectors:u}=cu(),h=u,m=(0,e.useMemo)(()=>h?r:Dt.filterBySector(r,c),[r,c,h]),[f,g]=(0,e.useState)({nomeItem:"",categoria:"",descricaoProblema:"",responsavel:"",localUltimaVez:"",dataDanificacao:(new Date).toISOString().split("T")[0],valorReparo:"",statusReparo:"aguardando_reparo",observacoes:"",prioridade:"media"}),[p,x]=(0,e.useState)(""),[y,v]=(0,e.useState)("todos"),[b,N]=(0,e.useState)(!1),[j,S]=(0,e.useState)(!1),[_,E]=(0,e.useState)(null),[C,T]=(0,e.useState)(!1),[P,F]=(0,e.useState)(null),[L,M]=(0,e.useState)(!1),[R,O]=(0,e.useState)(null),B=()=>{E(null),S(!1)},z=()=>{F(null),T(!1)},U=m.filter(e=>{const t=(e.nomeItem||"").toLowerCase().includes(p.toLowerCase())||(e.descricaoProblema||"").toLowerCase().includes(p.toLowerCase())||(e.responsavel||"").toLowerCase().includes(p.toLowerCase())||(e.localUltimaVez||"").toLowerCase().includes(p.toLowerCase()),r="todos"===y||(e.statusReparo||"")===y;return t&&r}),V=e=>{switch(e){case"aguardando_reparo":return"bg-[#FFD700] bg-opacity-100 text-black font-semibold hover:bg-[#FFD700] hover:bg-opacity-90";case"em_reparo":return"bg-[#1D9BF0] bg-opacity-100 text-gray-900 dark:text-white font-semibold hover:bg-[#1D9BF0] hover:bg-opacity-90";case"reparada":return"bg-[#00BA7C] bg-opacity-100 text-gray-900 dark:text-white font-semibold hover:bg-[#00BA7C] hover:bg-opacity-90";case"irreparavel":return"bg-[#F4212E] bg-opacity-100 text-gray-900 dark:text-white font-semibold hover:bg-[#F4212E] hover:bg-opacity-90";case"substituida":return"bg-[#8A2BE2] bg-opacity-100 text-gray-900 dark:text-white font-semibold hover:bg-[#8A2BE2] hover:bg-opacity-90";default:return"bg-[#8899A6] bg-opacity-100 text-gray-900 dark:text-white font-semibold hover:bg-[#8899A6] hover:bg-opacity-90"}},q=e=>{switch(e){case"aguardando_reparo":return"Aguardando Reparo";case"em_reparo":return"Em Reparo";case"reparada":return"Reparada";case"irreparavel":return"Irrepar\xe1vel";case"substituida":return"Substitu\xedda";default:return e}},H=e=>{if(!e)return 0;const t=new Date,r=new Date(e);if(isNaN(r.getTime()))return 0;const a=t-r,n=Math.floor(a/864e5);return n>=0?n:0},G=e=>{switch(e){case"baixa":return"bg-[#00BA7C] text-gray-900 dark:text-white font-semibold";case"media":return"bg-[#FFD700] text-black font-semibold";case"alta":return"bg-[#F4212E] text-gray-900 dark:text-white font-semibold";default:return"bg-[#8899A6] text-gray-900 dark:text-white font-semibold"}},W=(()=>{const e=r.length,t=r.filter(e=>"aguardando_reparo"===(e.statusReparo||"")).length,a=r.filter(e=>"em_reparo"===(e.statusReparo||"")).length,n=r.filter(e=>"reparada"===(e.statusReparo||"")).length,s=r.filter(e=>"irreparavel"===(e.statusReparo||"")).length,i=r.filter(e=>"substituida"===(e.statusReparo||"")).length,o=r.filter(e=>"irreparavel"===(e.statusReparo||"")).reduce((e,t)=>e+(t.valorReparo||0),0);return{total:e,aguardandoReparo:t,emReparo:a,reparadas:n,irreparaveis:s,substituidas:i,valorTotalDanos:o}})();return(0,k.jsxs)("div",{className:"space-y-6",children:[!h&&(null===c||void 0===c?void 0:c.setor)&&(0,k.jsxs)("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-3 flex items-center gap-2",children:[(0,k.jsx)(I,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"}),(0,k.jsxs)("p",{className:"text-sm text-blue-800 dark:text-blue-300",children:[(0,k.jsx)("strong",{children:"Visualiza\xe7\xe3o por setor:"})," Voc\xea est\xe1 vendo apenas as ferramentas danificadas do setor ",(0,k.jsx)("strong",{children:c.setor}),"."]})]}),(0,k.jsxs)("div",{className:"bg-gray-200 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-xl shadow-sm p-6",children:[(0,k.jsx)("div",{className:"flex items-center justify-end mb-6",children:!d&&!l&&(0,k.jsxs)("button",{onClick:()=>N(!0),className:"bg-blue-500 dark:bg-[#1D9BF0] text-white rounded-full px-4 py-2 flex items-center justify-center gap-2 hover:bg-blue-600 dark:hover:bg-[#1a8cd8] transition-colors",children:[(0,k.jsx)(D,{className:"w-4 h-4"}),"Registrar Dano"]})}),(0,k.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-6 gap-4 mb-6",children:[(0,k.jsx)("div",{className:"bg-gray-200 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-xl shadow-sm p-4",children:(0,k.jsxs)("div",{className:"flex items-center",children:[(0,k.jsx)("div",{className:"bg-blue-500 dark:bg-[#1D9BF0] bg-opacity-10 p-3 rounded-full",children:(0,k.jsx)(w,{className:"w-5 h-5 text-blue-500 dark:text-[#1D9BF0]"})}),(0,k.jsxs)("div",{className:"ml-3",children:[(0,k.jsx)("p",{className:"text-sm ".concat(Lw.textSecondary),children:"Total"}),(0,k.jsx)("p",{className:"text-xl font-bold ".concat(Lw.text),children:W.total})]})]})}),(0,k.jsx)("div",{className:"bg-gray-200 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-xl shadow-sm p-4",children:(0,k.jsxs)("div",{className:"flex flex-col",children:[(0,k.jsx)("p",{className:"text-sm ".concat(Lw.textSecondary),children:"Aguardando Reparo"}),(0,k.jsx)("p",{className:"text-xl font-bold text-[#FFD700]",children:W.aguardandoReparo})]})}),(0,k.jsx)("div",{className:"bg-gray-200 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-xl shadow-sm p-4",children:(0,k.jsxs)("div",{className:"flex flex-col",children:[(0,k.jsx)("p",{className:"text-sm ".concat(Lw.textSecondary),children:"Em Reparo"}),(0,k.jsx)("p",{className:"text-xl font-bold text-[#1D9BF0]",children:W.emReparo})]})}),(0,k.jsx)("div",{className:"bg-gray-200 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-xl shadow-sm p-4",children:(0,k.jsxs)("div",{className:"flex flex-col",children:[(0,k.jsx)("p",{className:"text-sm ".concat(Lw.textSecondary),children:"Reparadas"}),(0,k.jsx)("p",{className:"text-xl font-bold text-[#00BA7C]",children:W.reparadas})]})}),(0,k.jsx)("div",{className:"bg-gray-200 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-xl shadow-sm p-4",children:(0,k.jsxs)("div",{className:"flex flex-col",children:[(0,k.jsx)("p",{className:"text-sm ".concat(Lw.textSecondary),children:"Irrepar\xe1veis"}),(0,k.jsx)("p",{className:"text-xl font-bold text-[#F4212E]",children:W.irreparaveis})]})}),(0,k.jsx)("div",{className:"bg-gray-200 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-xl shadow-sm p-4",children:(0,k.jsxs)("div",{className:"flex flex-col",children:[(0,k.jsx)("p",{className:"text-sm ".concat(Lw.textSecondary),children:"Substitu\xeddas"}),(0,k.jsx)("p",{className:"text-xl font-bold text-[#8A2BE2]",children:W.substituidas})]})}),(0,k.jsx)("div",{className:"bg-gray-200 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-xl shadow-sm p-4",children:(0,k.jsxs)("div",{className:"flex flex-col",children:[(0,k.jsx)("p",{className:"text-sm ".concat(Lw.textSecondary),children:"Valor em Danos"}),(0,k.jsxs)("p",{className:"text-xl font-bold text-[#F4212E]",children:["R$ ",W.valorTotalDanos.toLocaleString("pt-BR",{minimumFractionDigits:2})]})]})})]}),(0,k.jsxs)("div",{className:"flex flex-col md:flex-row gap-4",children:[(0,k.jsxs)("div",{className:"flex-1 relative",children:[(0,k.jsx)("div",{className:"absolute inset-y-0 left-0 flex items-center z-10",children:(0,k.jsx)(Ft,{className:"w-5 h-5 ml-3 ".concat(Lw.textSecondary)})}),(0,k.jsx)("div",{className:"absolute inset-y-0 left-14 flex items-center pointer-events-none",children:!p&&(0,k.jsx)("span",{className:"text-gray-500",children:"Buscar por ferramenta, descri\xe7\xe3o, respons\xe1vel ou local..."})}),(0,k.jsx)("input",{type:"text",value:p,onChange:e=>x(e.target.value),className:"\n                pl-12 w-full py-2 \n                ".concat(Fw.input," \n                focus:ring-2 focus:ring-blue-500 dark:focus:ring-[#1D9BF0] focus:border-transparent\n              ")})]}),(0,k.jsxs)("select",{value:y,onChange:e=>v(e.target.value),className:"w-full md:w-48 px-4 py-2 rounded-lg text-xs font-medium focus:outline-none focus:ring-2 transition-colors appearance-none cursor-pointer ".concat("todos"===y?"bg-white dark:bg-gray-700 text-white":"aguardando_reparo"===y?"bg-[#FFD700] text-black":"em_reparo"===y?"bg-[#1D9BF0] text-white":"reparada"===y?"bg-[#00BA7C] text-white":"irreparavel"===y?"bg-[#F4212E] text-white":"substituida"===y?"bg-[#8A2BE2] text-white":"bg-[#8899A6] text-white"),style:{colorScheme:"dark"},children:[(0,k.jsx)("option",{value:"todos",style:{backgroundColor:"#192734",color:"white"},className:"font-semibold",children:"Todos os Status"}),(0,k.jsx)("option",{value:"aguardando_reparo",style:{backgroundColor:"#192734",color:"#FFD700"},className:"font-semibold",children:"Aguardando Reparo"}),(0,k.jsx)("option",{value:"em_reparo",style:{backgroundColor:"#192734",color:"#1D9BF0"},className:"font-semibold",children:"Em Reparo"}),(0,k.jsx)("option",{value:"reparada",style:{backgroundColor:"#192734",color:"#00BA7C"},className:"font-semibold",children:"Reparada"}),(0,k.jsx)("option",{value:"irreparavel",style:{backgroundColor:"#192734",color:"#F4212E"},className:"font-semibold",children:"Irrepar\xe1vel"}),(0,k.jsx)("option",{value:"substituida",style:{backgroundColor:"#192734",color:"#8A2BE2"},className:"font-semibold",children:"Substitu\xedda"})]})]})]}),(0,k.jsx)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:U.map(e=>(0,k.jsxs)("div",{className:"bg-gray-200 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-xl shadow-sm p-6",children:[(0,k.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,k.jsxs)("div",{className:"flex-1",children:[(0,k.jsxs)("h3",{className:"font-bold ".concat(Lw.text," text-lg flex items-center gap-2"),children:[(0,k.jsx)(w,{className:"w-5 h-5 text-[#F4212E]"}),e.nomeItem]}),e.categoria&&(0,k.jsx)("p",{className:"text-sm ".concat(Lw.textSecondary),children:e.categoria})]}),(0,k.jsx)("div",{className:"flex flex-col gap-2 items-end",children:(0,k.jsxs)("div",{className:"flex items-center gap-2",children:[(0,k.jsxs)("div",{className:"flex items-center gap-2",children:[!l&&(0,k.jsxs)("select",{className:"px-3 py-1 rounded-lg text-xs font-medium focus:outline-none focus:ring-2 transition-colors appearance-none cursor-pointer ".concat(V(e.statusReparo)),value:e.statusReparo,onChange:t=>i(e.id,{statusReparo:t.target.value}),style:{colorScheme:"dark",backgroundColor:"aguardando_reparo"===e.statusReparo?"#FFD700":"em_reparo"===e.statusReparo?"#1D9BF0":"reparada"===e.statusReparo?"#00BA7C":"irreparavel"===e.statusReparo?"#F4212E":"substituida"===e.statusReparo?"#8A2BE2":"#8899A6",color:"aguardando_reparo"===e.statusReparo?"black":"white"},children:[(0,k.jsx)("option",{value:"aguardando_reparo",style:{backgroundColor:"#192734",color:"#FFD700"},className:"font-semibold",children:"Aguardando Reparo"}),(0,k.jsx)("option",{value:"em_reparo",style:{backgroundColor:"#192734",color:"#1D9BF0"},className:"font-semibold",children:"Em Reparo"}),(0,k.jsx)("option",{value:"reparada",style:{backgroundColor:"#192734",color:"#00BA7C"},className:"font-semibold",children:"Reparada"}),(0,k.jsx)("option",{value:"irreparavel",style:{backgroundColor:"#192734",color:"#F4212E"},className:"font-semibold",children:"Irrepar\xe1vel"}),(0,k.jsx)("option",{value:"substituida",style:{backgroundColor:"#192734",color:"#8A2BE2"},className:"font-semibold",children:"Substitu\xedda"})]}),l&&(0,k.jsx)("span",{className:"px-3 py-1 rounded-lg text-xs font-medium ".concat(V(e.statusReparo)),children:q(e.statusReparo)}),(0,k.jsx)("span",{className:"px-3 py-1 rounded-lg text-xs font-medium ".concat(G(e.prioridade)),children:e.prioridade.charAt(0).toUpperCase()+e.prioridade.slice(1)})]}),!l&&(0,k.jsxs)("div",{className:"flex gap-2",children:[(0,k.jsx)("button",{onClick:()=>(E(e),void S(!0)),className:"text-blue-500 dark:text-[#1D9BF0] hover:text-gray-700 dark:hover:text-white transition-colors text-sm",title:"Editar",children:(0,k.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,k.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})})}),(0,k.jsx)("button",{onClick:()=>{return t=e.id,F(t),void T(!0);var t},className:"text-[#F4212E] hover:text-gray-700 dark:hover:text-white transition-colors text-sm",title:"Excluir",children:(0,k.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,k.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]})})]}),(0,k.jsxs)("div",{className:"space-y-3 text-sm",children:[(0,k.jsxs)("div",{className:"bg-gray-200 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-xl shadow-sm p-3 bg-[#F4212E] bg-opacity-5",children:[(0,k.jsxs)("div",{className:"flex items-center gap-2 font-medium text-[#F4212E] mb-1",children:[(0,k.jsx)(A,{className:"w-4 h-4"}),"Descri\xe7\xe3o do Problema"]}),(0,k.jsx)("p",{className:"text-[#F4212E]",children:e.descricaoProblema})]}),(0,k.jsxs)("div",{className:"grid grid-cols-1 gap-2",children:[(0,k.jsxs)("div",{className:"flex items-center gap-2 ".concat(Lw.text),children:[(0,k.jsx)(mu,{className:"w-4 h-4"}),(0,k.jsxs)("span",{children:[(0,k.jsx)("strong",{children:"Respons\xe1vel:"})," ",e.responsavel]})]}),(0,k.jsxs)("div",{className:"flex items-center gap-2 ".concat(Lw.text),children:[(0,k.jsx)(iu,{className:"w-4 h-4"}),(0,k.jsxs)("span",{children:[(0,k.jsx)("strong",{children:"Data do Dano:"})," ",new Date(e.dataDanificacao).toLocaleDateString("pt-BR")]})]}),e.localUltimaVez&&(0,k.jsxs)("div",{className:"flex items-center gap-2 ".concat(Lw.text),children:[(0,k.jsx)(Dd,{className:"w-4 h-4"}),(0,k.jsxs)("span",{children:[(0,k.jsx)("strong",{children:"\xdaltimo local visto:"})," ",e.localUltimaVez]})]})]}),e.valorReparo>0&&(0,k.jsxs)("div",{className:"bg-gray-200 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-xl shadow-sm p-2 bg-[#FFD700] bg-opacity-5 flex items-center gap-2",children:[(0,k.jsx)(lw,{className:"w-4 h-4 text-[#FFD700]"}),(0,k.jsxs)("span",{className:"text-[#FFD700]",children:[(0,k.jsx)("strong",{children:"Valor Estimado:"}),(0,k.jsxs)("span",{className:"ml-1",children:["R$ ",e.valorReparo.toLocaleString("pt-BR",{minimumFractionDigits:2})]})]})]}),e.observacoes&&(0,k.jsxs)("div",{className:"bg-gray-200 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-xl shadow-sm p-2",children:[(0,k.jsx)("strong",{className:Lw.text,children:"Observa\xe7\xf5es:"}),(0,k.jsx)("p",{className:Lw.textSecondary,children:e.observacoes})]}),(0,k.jsxs)("div",{className:"text-xs ".concat(Lw.textSecondary," border-t pt-2"),children:["Danificada h\xe1 ",H(e.dataDanificacao)," dias"]})]})]},e.id))}),0===U.length&&(0,k.jsxs)("div",{className:"bg-gray-200 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-xl shadow-sm p-8 text-center",children:[(0,k.jsx)(Ft,{className:"w-16 h-16 mx-auto ".concat(Lw.textSecondary," mb-4")}),(0,k.jsx)("p",{className:"text-lg font-medium ".concat(Lw.text),children:p||"todos"!==y?"Nenhuma ferramenta danificada encontrada":"Nenhuma ferramenta danificada registrada"}),(0,k.jsx)("p",{className:"".concat(Lw.textSecondary," mt-2"),children:p||"todos"!==y?"Tente alterar os filtros de busca":'Clique em "Registrar Dano" para adicionar uma ocorr\xeancia'})]}),b&&(0,k.jsx)("div",{className:"fixed inset-0 bg-black/50 dark:bg-black/70 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:(0,k.jsx)("div",{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-600 dark:border-gray-600 rounded-xl shadow-xl max-w-3xl w-full max-h-[90vh] overflow-y-auto",children:(0,k.jsxs)("div",{className:"p-6",children:[(0,k.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,k.jsxs)("h3",{className:"text-lg font-bold text-gray-900 dark:text-white flex items-center gap-2",children:[(0,k.jsx)(Ft,{className:"w-5 h-5 text-[#F4212E]"}),"Registrar Ferramenta Danificada"]}),(0,k.jsx)("button",{onClick:()=>N(!1),className:"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-white transition-colors",children:"\u2715"})]}),(0,k.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),!f.nomeItem||!f.descricaoProblema)return void zb.error("Por favor, preencha os campos obrigat\xf3rios:\n- Nome da Ferramenta\n- Descri\xe7\xe3o da Perda\n\nOs campos obrigat\xf3rios est\xe3o marcados com *",{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"dark",style:{background:"#192734",color:"#ffffff",borderRadius:"1rem",border:"1px solid #38444D"}});f.nomeItem,f.descricaoProblema,f.categoria;const t=(0,n.A)((0,n.A)({},f),{},{valorReparo:f.valorReparo?parseFloat(f.valorReparo):0});O(t),N(!1),M(!0)},className:"space-y-4",children:[(0,k.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium text-gray-900 dark:text-white text-center mb-2",children:"Nome da Ferramenta *"}),(0,k.jsx)("input",{type:"text",value:f.nomeItem,onChange:e=>g((0,n.A)((0,n.A)({},f),{},{nomeItem:e.target.value})),className:"w-full bg-white dark:bg-gray-800 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 dark:border-gray-600 text-gray-900 dark:text-white rounded-full px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-[#1D9BF0] transition-colors text-center",placeholder:"Ex: Martelo Tramontina 25mm",list:"inventario-list",required:!0}),(0,k.jsx)("datalist",{id:"inventario-list",children:[...a].sort((e,t)=>e.nome.localeCompare(t.nome)).map(e=>(0,k.jsx)("option",{value:e.nome},e.id))})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium text-gray-900 dark:text-white text-center mb-2",children:"Categoria"}),(0,k.jsx)("input",{type:"text",value:f.categoria,onChange:e=>g((0,n.A)((0,n.A)({},f),{},{categoria:e.target.value})),className:"w-full bg-white dark:bg-gray-800 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 dark:border-gray-600 text-gray-900 dark:text-white rounded-full px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-[#1D9BF0] transition-colors text-center",placeholder:"Ex: Ferramenta Manual"})]})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium text-gray-900 dark:text-white text-center mb-2",children:"Descri\xe7\xe3o da Perda *"}),(0,k.jsx)("textarea",{value:f.descricaoProblema,onChange:e=>g((0,n.A)((0,n.A)({},f),{},{descricaoProblema:e.target.value})),className:"w-full bg-white dark:bg-gray-800 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 dark:border-gray-600 text-gray-900 dark:text-white rounded-xl px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-[#1D9BF0] transition-colors text-center h-24",placeholder:"Descreva detalhadamente as circunst\xe2ncias da perda...",required:!0})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium text-gray-900 dark:text-white text-center mb-2",children:"\xdaltimo Local Visto"}),(0,k.jsx)("input",{type:"text",value:f.localUltimaVez,onChange:e=>g((0,n.A)((0,n.A)({},f),{},{localUltimaVez:e.target.value})),className:"w-full bg-white dark:bg-gray-800 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 dark:border-gray-600 text-gray-900 dark:text-white rounded-full px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-[#1D9BF0] transition-colors text-center",placeholder:"Ex: Obra da Rua A, Almoxarifado, Canteiro 3..."})]}),(0,k.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium text-gray-900 dark:text-white text-center mb-2",children:"Valor Estimado (R$)"}),(0,k.jsx)("input",{type:"number",step:"0.01",min:"0",value:f.valorReparo,onChange:e=>g((0,n.A)((0,n.A)({},f),{},{valorReparo:e.target.value})),className:"w-full bg-white dark:bg-gray-800 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 dark:border-gray-600 text-gray-900 dark:text-white rounded-full px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-[#1D9BF0] transition-colors text-center",placeholder:"0,00"})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium text-gray-900 dark:text-white text-center mb-2",children:"Status do Reparo"}),(0,k.jsxs)("select",{value:f.statusReparo,onChange:e=>g((0,n.A)((0,n.A)({},f),{},{statusReparo:e.target.value})),className:"w-full bg-white dark:bg-gray-800 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 dark:border-gray-600 text-gray-900 dark:text-white rounded-full px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-[#1D9BF0] transition-colors appearance-none text-center",children:[(0,k.jsx)("option",{value:"aguardando_reparo",className:"bg-white dark:bg-gray-800",children:"Aguardando Reparo"}),(0,k.jsx)("option",{value:"em_reparo",children:"Em Reparo"}),(0,k.jsx)("option",{value:"reparada",children:"Reparada"}),(0,k.jsx)("option",{value:"irreparavel",children:"Irrepar\xe1vel"}),(0,k.jsx)("option",{value:"substituida",children:"Substitu\xedda"})]})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium text-gray-900 dark:text-white text-center mb-2",children:"Prioridade"}),(0,k.jsxs)("select",{value:f.prioridade,onChange:e=>g((0,n.A)((0,n.A)({},f),{},{prioridade:e.target.value})),className:"w-full bg-white dark:bg-gray-800 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 dark:border-gray-600 text-gray-900 dark:text-white rounded-full px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-[#1D9BF0] transition-colors appearance-none text-center",children:[(0,k.jsx)("option",{value:"baixa",className:"bg-white dark:bg-gray-800",children:"Baixa"}),(0,k.jsx)("option",{value:"media",children:"M\xe9dia"}),(0,k.jsx)("option",{value:"alta",children:"Alta"})]})]})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium text-gray-900 dark:text-white text-center mb-2",children:"Observa\xe7\xf5es e A\xe7\xf5es Tomadas"}),(0,k.jsx)("textarea",{value:f.observacoes,onChange:e=>g((0,n.A)((0,n.A)({},f),{},{observacoes:e.target.value})),className:"w-full bg-white dark:bg-gray-800 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 dark:border-gray-600 text-gray-900 dark:text-white rounded-xl px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-[#1D9BF0] transition-colors text-center h-20 resize-none",placeholder:"Ex: J\xe1 foi feita busca no almoxarifado, verificado com outros funcion\xe1rios..."})]}),(0,k.jsxs)("div",{className:"bg-blue-500 dark:bg-[#1D9BF0] bg-opacity-5 p-4 rounded-lg border border-blue-500 dark:border-[#1D9BF0] border-opacity-10",children:[(0,k.jsxs)("div",{className:"flex items-center gap-2 text-blue-500 dark:text-[#1D9BF0] mb-2",children:[(0,k.jsx)(w,{className:"w-4 h-4"}),(0,k.jsx)("span",{className:"font-medium",children:"Dicas para recupera\xe7\xe3o:"})]}),(0,k.jsxs)("ul",{className:"text-sm text-blue-500 dark:text-[#1D9BF0] space-y-1",children:[(0,k.jsx)("li",{children:"\u2022 Verifique os locais de trabalho recentes"}),(0,k.jsx)("li",{children:"\u2022 Consulte outros funcion\xe1rios da equipe"}),(0,k.jsx)("li",{children:"\u2022 Confira ve\xedculos e equipamentos utilizados"}),(0,k.jsx)("li",{children:"\u2022 Examine \xe1reas de armazenamento tempor\xe1rio"})]})]}),(0,k.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,k.jsx)("button",{type:"submit",className:"flex-1 bg-blue-500 dark:bg-[#1D9BF0] text-gray-900 dark:text-white font-bold py-2 px-4 rounded-full hover:bg-blue-600 dark:hover:bg-[#1a8cd8] transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-[#1D9BF0] focus:ring-offset-2 focus:ring-offset-[#15202B]",children:"Registrar Ferramenta Danificada"}),(0,k.jsx)("button",{type:"button",onClick:()=>N(!1),className:"flex-1 border border-blue-500 dark:border-[#1D9BF0] text-blue-500 dark:text-[#1D9BF0] font-bold py-2 px-4 rounded-full hover:bg-blue-500 dark:bg-[#1D9BF0] hover:bg-opacity-10 transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-[#1D9BF0] focus:ring-offset-2 focus:ring-offset-[#15202B]",children:"Cancelar"})]})]})]})})}),j&&_&&(0,k.jsx)("div",{className:"fixed inset-0 bg-black/50 dark:bg-black/70 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:(0,k.jsx)("div",{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-600 dark:border-gray-600 rounded-xl shadow-xl max-w-3xl w-full max-h-[90vh] overflow-y-auto",children:(0,k.jsxs)("div",{className:"p-6",children:[(0,k.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,k.jsxs)("h3",{className:"text-lg font-bold text-gray-900 dark:text-white flex items-center gap-2",children:[(0,k.jsx)(Ft,{className:"w-5 h-5 text-blue-500 dark:text-[#1D9BF0]"}),"Editar Ferramenta Danificada"]}),(0,k.jsx)("button",{onClick:B,className:"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-white transition-colors",children:"\u2715"})]}),(0,k.jsxs)("form",{onSubmit:e=>{e.preventDefault();i(_.id,_)?(B(),zb.success("Ferramenta danificada atualizada com sucesso!",{position:"top-right",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"dark",style:{background:"#192734",color:"#ffffff",borderRadius:"1rem",border:"1px solid #38444D"}})):zb.error("Erro ao atualizar ferramenta danificada. Tente novamente.",{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"dark",style:{background:"#192734",color:"#ffffff",borderRadius:"1rem",border:"1px solid #38444D"}})},className:"space-y-4",children:[(0,k.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium text-gray-900 dark:text-white text-center mb-2",children:"Nome da Ferramenta *"}),(0,k.jsx)("input",{type:"text",value:_.nomeItem,onChange:e=>E((0,n.A)((0,n.A)({},_),{},{nomeItem:e.target.value})),className:"w-full bg-white dark:bg-gray-800 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 dark:border-gray-600 text-gray-900 dark:text-white rounded-full px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-[#1D9BF0] transition-colors text-center",placeholder:"Ex: Martelo Tramontina 25mm",list:"inventario-list",required:!0})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium text-gray-900 dark:text-white text-center mb-2",children:"Categoria"}),(0,k.jsx)("input",{type:"text",value:_.categoria,onChange:e=>E((0,n.A)((0,n.A)({},_),{},{categoria:e.target.value})),className:"w-full bg-white dark:bg-gray-800 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 dark:border-gray-600 text-gray-900 dark:text-white rounded-full px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-[#1D9BF0] transition-colors text-center",placeholder:"Ex: Ferramenta Manual"})]})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium text-gray-900 dark:text-white text-center mb-2",children:"Descri\xe7\xe3o da Perda *"}),(0,k.jsx)("textarea",{value:_.descricaoProblema,onChange:e=>E((0,n.A)((0,n.A)({},_),{},{descricaoProblema:e.target.value})),className:"w-full bg-white dark:bg-gray-800 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 dark:border-gray-600 text-gray-900 dark:text-white rounded-xl px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-[#1D9BF0] transition-colors text-center h-24",placeholder:"Descreva detalhadamente as circunst\xe2ncias da perda...",required:!0})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium text-gray-900 dark:text-white text-center mb-2",children:"\xdaltimo Local Visto"}),(0,k.jsx)("input",{type:"text",value:_.localUltimaVez,onChange:e=>E((0,n.A)((0,n.A)({},_),{},{localUltimaVez:e.target.value})),className:"w-full bg-white dark:bg-gray-800 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 dark:border-gray-600 text-gray-900 dark:text-white rounded-full px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-[#1D9BF0] transition-colors text-center",placeholder:"Ex: Obra da Rua A, Almoxarifado, Canteiro 3..."})]}),(0,k.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium text-gray-900 dark:text-white text-center mb-2",children:"Valor Estimado (R$)"}),(0,k.jsx)("input",{type:"number",step:"0.01",min:"0",value:_.valorReparo,onChange:e=>E((0,n.A)((0,n.A)({},_),{},{valorReparo:e.target.value})),className:"w-full bg-white dark:bg-gray-800 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 dark:border-gray-600 text-gray-900 dark:text-white rounded-full px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-[#1D9BF0] transition-colors text-center",placeholder:"0,00"})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium text-gray-900 dark:text-white text-center mb-2",children:"Status do Reparo"}),(0,k.jsxs)("select",{value:_.statusReparo,onChange:e=>E((0,n.A)((0,n.A)({},_),{},{statusReparo:e.target.value})),className:"w-full bg-white dark:bg-gray-800 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 dark:border-gray-600 text-gray-900 dark:text-white rounded-full px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-[#1D9BF0] transition-colors appearance-none text-center",children:[(0,k.jsx)("option",{value:"aguardando_reparo",className:"bg-white dark:bg-gray-800",children:"Aguardando Reparo"}),(0,k.jsx)("option",{value:"em_reparo",children:"Em Reparo"}),(0,k.jsx)("option",{value:"reparada",children:"Reparada"}),(0,k.jsx)("option",{value:"irreparavel",children:"Irrepar\xe1vel"}),(0,k.jsx)("option",{value:"substituida",children:"Substitu\xedda"})]})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium text-gray-900 dark:text-white text-center mb-2",children:"Prioridade"}),(0,k.jsxs)("select",{value:_.prioridade,onChange:e=>E((0,n.A)((0,n.A)({},_),{},{prioridade:e.target.value})),className:"w-full bg-white dark:bg-gray-800 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 dark:border-gray-600 text-gray-900 dark:text-white rounded-full px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-[#1D9BF0] transition-colors appearance-none text-center",children:[(0,k.jsx)("option",{value:"baixa",className:"bg-white dark:bg-gray-800",children:"Baixa"}),(0,k.jsx)("option",{value:"media",children:"M\xe9dia"}),(0,k.jsx)("option",{value:"alta",children:"Alta"})]})]})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium text-gray-900 dark:text-white text-center mb-2",children:"Observa\xe7\xf5es e A\xe7\xf5es Tomadas"}),(0,k.jsx)("textarea",{value:_.observacoes,onChange:e=>E((0,n.A)((0,n.A)({},_),{},{observacoes:e.target.value})),className:"w-full bg-white dark:bg-gray-800 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 dark:border-gray-600 text-gray-900 dark:text-white rounded-xl px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-[#1D9BF0] transition-colors text-center h-20 resize-none",placeholder:"Ex: J\xe1 foi feita busca no almoxarifado, verificado com outros funcion\xe1rios..."})]}),(0,k.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,k.jsx)("button",{type:"submit",className:"flex-1 bg-blue-500 dark:bg-[#1D9BF0] text-gray-900 dark:text-white font-bold py-2 px-4 rounded-full hover:bg-blue-600 dark:hover:bg-[#1a8cd8] transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-[#1D9BF0] focus:ring-offset-2 focus:ring-offset-[#15202B]",children:"Salvar Altera\xe7\xf5es"}),(0,k.jsx)("button",{type:"button",onClick:B,className:"flex-1 border border-blue-500 dark:border-[#1D9BF0] text-blue-500 dark:text-[#1D9BF0] font-bold py-2 px-4 rounded-full hover:bg-blue-500 dark:bg-[#1D9BF0] hover:bg-opacity-10 transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-[#1D9BF0] focus:ring-offset-2 focus:ring-offset-[#15202B]",children:"Cancelar"})]})]})]})})}),C&&(0,k.jsx)("div",{className:"fixed inset-0 bg-black/50 dark:bg-black/70 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:(0,k.jsx)("div",{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-600 dark:border-gray-600 rounded-xl shadow-xl max-w-md w-full",children:(0,k.jsxs)("div",{className:"p-6",children:[(0,k.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,k.jsx)("div",{className:"w-10 h-10 bg-[#F4212E] bg-opacity-10 rounded-full flex items-center justify-center",children:(0,k.jsx)(w,{className:"w-6 h-6 text-[#F4212E]"})}),(0,k.jsx)("h3",{className:"text-lg font-bold text-white",children:"Confirmar Exclus\xe3o"})]}),(0,k.jsx)("p",{className:"".concat(Lw.text," mb-6"),children:"Tem certeza que deseja excluir este registro de ferramenta danificada? Esta a\xe7\xe3o n\xe3o pode ser desfeita."}),(0,k.jsxs)("div",{className:"flex gap-3",children:[(0,k.jsx)("button",{onClick:async()=>{await o(P)?(z(),zb.success("Registro removido com sucesso!",{position:"top-right",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"dark",style:{background:"#192734",color:"#ffffff",borderRadius:"1rem",border:"1px solid #38444D"}})):zb.error("Erro ao remover registro. Tente novamente.",{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"dark",style:{background:"#192734",color:"#ffffff",borderRadius:"1rem",border:"1px solid #38444D"}})},className:"flex-1 bg-[#F4212E] text-gray-900 dark:text-white font-bold py-2 px-4 rounded-full hover:bg-[#d91d28] transition-colors focus:outline-none focus:ring-2 focus:ring-[#F4212E] focus:ring-offset-2 focus:ring-offset-[#15202B]",children:"Excluir"}),(0,k.jsx)("button",{onClick:z,className:"flex-1 border border-gray-200 dark:border-gray-600 dark:border-gray-600 text-gray-900 dark:text-white font-bold py-2 px-4 rounded-full hover:bg-[#38444D] hover:bg-opacity-10 transition-colors focus:outline-none focus:ring-2 focus:ring-[#38444D] focus:ring-offset-2 focus:ring-offset-[#15202B]",children:"Cancelar"})]})]})})}),L&&R&&(0,k.jsx)(Pw,{item:{nome:R.nomeItem,descricao:R.descricaoProblema,categoria:R.categoria},onComplete:async()=>{try{await s(R)?(g({nomeItem:"",categoria:"",descricaoProblema:"",responsavel:"",localUltimaVez:"",dataDanificacao:(new Date).toISOString().split("T")[0],valorReparo:"",statusReparo:"aguardando_reparo",observacoes:"",prioridade:"media"}),M(!1),O(null),zb.success("Ferramenta danificada registrada com sucesso!",{position:"top-right",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"dark",style:{background:"#192734",color:"#ffffff",borderRadius:"1rem",border:"1px solid #38444D"}})):(M(!1),O(null),zb.error("Erro ao registrar ferramenta danificada. Tente novamente.",{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"dark",style:{background:"#192734",color:"#ffffff",borderRadius:"1rem",border:"1px solid #38444D"}}))}catch(e){console.error("Erro ao finalizar registro:",e),M(!1),O(null),zb.error("Erro ao registrar ferramenta danificada.",{position:"top-right",autoClose:3e3,theme:"dark",style:{background:"#192734",color:"#ffffff",borderRadius:"1rem",border:"1px solid #38444D"}})}}})]})},{classes:Rw,colors:Ow}=hw,Bw=t=>{let{ferramentasPerdidas:r,inventario:a,adicionarFerramentaPerdida:s,atualizarFerramentaPerdida:i,removerFerramentaPerdida:o,readonly:l}=t;const{usuario:c}=Nt(),d="funcionario"===(null===c||void 0===c?void 0:c.nivel),{canViewAllSectors:u}=cu(),h=u,m=(0,e.useMemo)(()=>h?r:Dt.filterBySector(r,c),[r,c,h]),[f,g]=(0,e.useState)({nomeItem:"",categoria:"",descricaoPerda:"",responsavel:"",localUltimaVez:"",dataPerdida:(new Date).toISOString().split("T")[0],valorEstimado:"",statusBusca:"buscando",observacoes:"",prioridade:"media"}),[p,x]=(0,e.useState)(""),[y,v]=(0,e.useState)("todos"),[b,N]=(0,e.useState)(!1),[j,S]=(0,e.useState)(!1),[_,E]=(0,e.useState)(null),[C,T]=(0,e.useState)(!1),[P,F]=(0,e.useState)(null),L=()=>{E(null),S(!1)},M=()=>{F(null),T(!1)},R=m.filter(e=>{const t=e.nomeItem.toLowerCase().includes(p.toLowerCase())||e.descricaoPerda.toLowerCase().includes(p.toLowerCase())||e.responsavel.toLowerCase().includes(p.toLowerCase())||e.localUltimaVez.toLowerCase().includes(p.toLowerCase()),r="todos"===y||e.statusBusca===y;return t&&r}),O=e=>{switch(e){case"buscando":return"bg-yellow-500 dark:bg-[#FFD700] bg-opacity-100 text-black font-semibold hover:bg-yellow-600 dark:hover:bg-[#FFD700] hover:bg-opacity-90";case"encontrada":return"bg-green-500 dark:bg-[#00BA7C] bg-opacity-100 text-gray-900 dark:text-white font-semibold hover:bg-green-600 dark:hover:bg-[#00BA7C] hover:bg-opacity-90";case"perdida_definitiva":return"bg-red-500 dark:bg-[#F4212E] bg-opacity-100 text-gray-900 dark:text-white font-semibold hover:bg-red-600 dark:hover:bg-[#F4212E] hover:bg-opacity-90";case"substituida":return"bg-blue-500 dark:bg-[#1D9BF0] bg-opacity-100 text-gray-900 dark:text-white font-semibold hover:bg-blue-600 dark:hover:bg-[#1D9BF0] hover:bg-opacity-90";default:return"bg-gray-500 dark:bg-[#8899A6] bg-opacity-100 text-gray-900 dark:text-white font-semibold hover:bg-gray-600 dark:hover:bg-[#8899A6] hover:bg-opacity-90"}},B=e=>{switch(e){case"buscando":return"Buscando";case"encontrada":return"Encontrada";case"perdida_definitiva":return"Perda Definitiva";case"substituida":return"Substitu\xedda";default:return e}},z=e=>{switch(e){case"baixa":return"bg-green-500 dark:bg-[#00BA7C] text-gray-900 dark:text-white font-semibold";case"media":return"bg-yellow-500 dark:bg-[#FFD700] text-black font-semibold";case"alta":return"bg-red-500 dark:bg-[#F4212E] text-gray-900 dark:text-white font-semibold";default:return"bg-gray-500 dark:bg-[#8899A6] text-gray-900 dark:text-white font-semibold"}},U=(()=>{const e=r.length,t=r.filter(e=>"buscando"===e.statusBusca).length,a=r.filter(e=>"encontrada"===e.statusBusca).length,n=r.filter(e=>"perdida_definitiva"===e.statusBusca).length,s=r.filter(e=>"substituida"===e.statusBusca).length,i=r.filter(e=>"perdida_definitiva"===e.statusBusca).reduce((e,t)=>e+(t.valorEstimado||0),0);return{total:e,buscando:t,encontradas:a,perdidasDefinitivas:n,substituidas:s,valorTotalPerdido:i}})();return(0,k.jsxs)("div",{className:"space-y-6",children:[!h&&(null===c||void 0===c?void 0:c.setor)&&(0,k.jsxs)("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-3 flex items-center gap-2",children:[(0,k.jsx)(I,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"}),(0,k.jsxs)("p",{className:"text-sm text-blue-800 dark:text-blue-300",children:[(0,k.jsx)("strong",{children:"Visualiza\xe7\xe3o por setor:"})," Voc\xea est\xe1 vendo apenas as ferramentas perdidas do setor ",(0,k.jsx)("strong",{children:c.setor}),"."]})]}),(0,k.jsxs)("div",{className:"bg-gray-200 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-xl shadow-sm p-6",children:[(0,k.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,k.jsxs)("div",{className:"flex items-center gap-3",children:[(0,k.jsx)("div",{className:"w-10 h-10 bg-red-100 dark:bg-[#F4212E] dark:bg-opacity-10 rounded-lg flex items-center justify-center",children:(0,k.jsx)(w,{className:"w-5 h-5 text-red-500 dark:text-[#F4212E]"})}),(0,k.jsx)("div",{children:(0,k.jsx)("p",{className:"text-sm ".concat(Ow.textSecondary),children:"Controle e rastreamento de ferramentas perdidas"})})]}),!d&&!l&&(0,k.jsxs)("button",{onClick:()=>N(!0),className:"bg-blue-500 dark:bg-[#1D9BF0] text-white rounded-full px-4 py-2 flex items-center justify-center gap-2 hover:bg-blue-600 dark:hover:bg-[#1a8cd8] transition-colors",children:[(0,k.jsx)(D,{className:"w-4 h-4"}),"Registrar Perda"]})]}),(0,k.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-6 gap-4 mb-6",children:[(0,k.jsx)("div",{className:"bg-gray-200 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-xl shadow-sm p-4",children:(0,k.jsxs)("div",{className:"flex items-center",children:[(0,k.jsx)("div",{className:"bg-blue-100 dark:bg-blue-500 dark:bg-[#1D9BF0] dark:bg-opacity-10 p-3 rounded-full",children:(0,k.jsx)(w,{className:"w-5 h-5 text-blue-500 dark:text-blue-500 dark:text-[#1D9BF0]"})}),(0,k.jsxs)("div",{className:"ml-3",children:[(0,k.jsx)("p",{className:"text-sm ".concat(Ow.textSecondary),children:"Total"}),(0,k.jsx)("p",{className:"text-xl font-bold ".concat(Ow.text),children:U.total})]})]})}),(0,k.jsx)("div",{className:"bg-gray-200 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-xl shadow-sm p-4",children:(0,k.jsxs)("div",{className:"flex flex-col",children:[(0,k.jsx)("p",{className:"text-sm ".concat(Ow.textSecondary),children:"Buscando"}),(0,k.jsx)("p",{className:"text-xl font-bold text-yellow-500 dark:text-[#FFD700]",children:U.buscando})]})}),(0,k.jsx)("div",{className:"bg-gray-200 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-xl shadow-sm p-4",children:(0,k.jsxs)("div",{className:"flex flex-col",children:[(0,k.jsx)("p",{className:"text-sm ".concat(Ow.textSecondary),children:"Encontradas"}),(0,k.jsx)("p",{className:"text-xl font-bold text-green-500 dark:text-[#00BA7C]",children:U.encontradas})]})}),(0,k.jsx)("div",{className:"bg-gray-200 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-xl shadow-sm p-4",children:(0,k.jsxs)("div",{className:"flex flex-col",children:[(0,k.jsx)("p",{className:"text-sm ".concat(Ow.textSecondary),children:"Perdidas"}),(0,k.jsx)("p",{className:"text-xl font-bold text-red-500 dark:text-[#F4212E]",children:U.perdidasDefinitivas})]})}),(0,k.jsx)("div",{className:"bg-gray-200 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-xl shadow-sm p-4",children:(0,k.jsxs)("div",{className:"flex flex-col",children:[(0,k.jsx)("p",{className:"text-sm ".concat(Ow.textSecondary),children:"Substitu\xeddas"}),(0,k.jsx)("p",{className:"text-xl font-bold text-blue-500 dark:text-[#1D9BF0]",children:U.substituidas})]})}),(0,k.jsx)("div",{className:"bg-gray-200 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-xl shadow-sm p-4",children:(0,k.jsxs)("div",{className:"flex flex-col",children:[(0,k.jsx)("p",{className:"text-sm ".concat(Ow.textSecondary),children:"Valor Perdido"}),(0,k.jsxs)("p",{className:"text-xl font-bold text-red-500 dark:text-[#F4212E]",children:["R$ ",U.valorTotalPerdido.toLocaleString("pt-BR",{minimumFractionDigits:2})]})]})})]}),(0,k.jsx)("div",{className:"bg-gradient-to-br from-red-50 to-red-100 dark:from-red-900/30 dark:to-red-800/30 border-2 border-red-300 dark:border-red-600 rounded-xl px-6 py-4 shadow-lg mb-6",children:(0,k.jsxs)("div",{className:"flex items-center justify-between",children:[(0,k.jsxs)("div",{className:"flex items-center gap-3",children:[(0,k.jsx)("div",{className:"bg-red-500 dark:bg-red-600 p-3 rounded-xl shadow-md",children:(0,k.jsx)(w,{className:"w-6 h-6 text-white"})}),(0,k.jsxs)("div",{children:[(0,k.jsx)("p",{className:"text-sm font-medium text-red-700 dark:text-red-300",children:"Valor Total em Ferramentas Perdidas"}),(0,k.jsxs)("p",{className:"text-xs text-red-600 dark:text-red-400",children:[U.buscando+U.perdidasDefinitivas," ferramentas n\xe3o localizadas"]})]})]}),(0,k.jsxs)("div",{className:"text-right",children:[(0,k.jsx)("p",{className:"text-3xl font-bold text-red-600 dark:text-red-400",children:(()=>{const e=m.filter(e=>"buscando"===e.statusBusca||"perdida_definitiva"===e.statusBusca).reduce((e,t)=>e+(parseFloat(t.valorEstimado)||0),0);return e.toLocaleString("pt-BR",{style:"currency",currency:"BRL"})})()}),(0,k.jsx)("p",{className:"text-xs text-red-500 dark:text-red-500 mt-1",children:"Preju\xedzo total"})]})]})}),(0,k.jsxs)("div",{className:"flex flex-col md:flex-row gap-4",children:[(0,k.jsxs)("div",{className:"flex-1 relative",children:[(0,k.jsx)("div",{className:"absolute inset-y-0 left-0 flex items-center z-10",children:(0,k.jsx)(Ft,{className:"w-5 h-5 ml-3 ".concat(Ow.textSecondary)})}),(0,k.jsx)("div",{className:"absolute inset-y-0 left-14 flex items-center pointer-events-none",children:!p&&(0,k.jsx)("span",{className:"text-gray-500",children:"Buscar por ferramenta, descri\xe7\xe3o, respons\xe1vel ou local..."})}),(0,k.jsx)("input",{type:"text",value:p,onChange:e=>x(e.target.value),className:"\n                pl-12 w-full py-2 \n                ".concat(Rw.input," \n                focus:ring-2 focus:ring-blue-500 dark:focus:ring-[#1D9BF0] focus:border-transparent\n              ")})]}),(0,k.jsxs)("select",{value:y,onChange:e=>v(e.target.value),className:"w-full md:w-48 px-4 py-2 rounded-lg text-xs font-medium focus:outline-none focus:ring-2 transition-colors appearance-none cursor-pointer ".concat("todos"===y?"bg-gray-500 dark:bg-gray-700 text-white":"buscando"===y?"bg-yellow-500 dark:bg-[#FFD700] text-black":"encontrada"===y?"bg-green-500 dark:bg-[#00BA7C] text-white":"perdida_definitiva"===y?"bg-red-500 dark:bg-[#F4212E] text-white":"substituida"===y?"bg-blue-500 dark:bg-[#1D9BF0] text-white":"bg-gray-500 dark:bg-[#8899A6] text-white"),style:{colorScheme:"dark"},children:[(0,k.jsx)("option",{value:"todos",className:"bg-white dark:bg-gray-800 text-gray-900 dark:text-white font-semibold",children:"Todos os Status"}),(0,k.jsx)("option",{value:"buscando",className:"bg-white dark:bg-gray-800 text-yellow-500 font-semibold",children:"Buscando"}),(0,k.jsx)("option",{value:"encontrada",className:"bg-white dark:bg-gray-800 text-green-500 font-semibold",children:"Encontrada"}),(0,k.jsx)("option",{value:"perdida_definitiva",className:"bg-white dark:bg-gray-800 text-red-500 font-semibold",children:"Perda Definitiva"}),(0,k.jsx)("option",{value:"substituida",style:{backgroundColor:"#192734",color:"#1D9BF0"},className:"font-semibold",children:"Substitu\xedda"})]})]})]}),(0,k.jsx)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:R.map(e=>(0,k.jsxs)("div",{className:"bg-gray-200 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-xl shadow-sm p-6",children:[(0,k.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,k.jsxs)("div",{className:"flex-1",children:[(0,k.jsxs)("h3",{className:"font-bold ".concat(Ow.text," text-lg flex items-center gap-2"),children:[(0,k.jsx)(w,{className:"w-5 h-5 text-red-500 dark:text-[#F4212E]"}),e.nomeItem]}),e.categoria&&(0,k.jsx)("p",{className:"text-sm ".concat(Ow.textSecondary),children:e.categoria})]}),(0,k.jsx)("div",{className:"flex flex-col gap-2 items-end",children:(0,k.jsxs)("div",{className:"flex items-center gap-2",children:[(0,k.jsxs)("div",{className:"flex items-center gap-2",children:[!l&&(0,k.jsxs)("select",{className:"px-3 py-1 rounded-lg text-xs font-medium focus:outline-none focus:ring-2 transition-colors appearance-none cursor-pointer ".concat(O(e.statusBusca)),value:e.statusBusca,onChange:t=>i(e.id,{statusBusca:t.target.value}),style:{colorScheme:"dark",backgroundColor:"buscando"===e.statusBusca?"#FFD700":"encontrada"===e.statusBusca?"#00BA7C":"perdida_definitiva"===e.statusBusca?"#F4212E":"substituida"===e.statusBusca?"#1D9BF0":"#8899A6",color:"buscando"===e.statusBusca?"black":"white"},children:[(0,k.jsx)("option",{value:"buscando",className:"bg-white dark:bg-gray-800 text-yellow-500 font-semibold",children:"Buscando"}),(0,k.jsx)("option",{value:"encontrada",className:"bg-white dark:bg-gray-800 text-green-500 font-semibold",children:"Encontrada"}),(0,k.jsx)("option",{value:"perdida_definitiva",className:"bg-white dark:bg-gray-800 text-red-500 font-semibold",children:"Perda Definitiva"}),(0,k.jsx)("option",{value:"substituida",style:{backgroundColor:"#192734",color:"#1D9BF0"},className:"font-semibold",children:"Substitu\xedda"})]}),l&&(0,k.jsx)("span",{className:"px-3 py-1 rounded-lg text-xs font-medium ".concat(O(e.statusBusca)),children:B(e.statusBusca)}),(0,k.jsx)("span",{className:"px-3 py-1 rounded-lg text-xs font-medium ".concat(z(e.prioridade)),children:e.prioridade.charAt(0).toUpperCase()+e.prioridade.slice(1)})]}),!l&&(0,k.jsxs)("div",{className:"flex gap-2",children:[(0,k.jsx)("button",{onClick:()=>(E(e),void S(!0)),className:"text-blue-500 dark:text-blue-500 dark:text-[#1D9BF0] hover:text-gray-700 dark:hover:text-white transition-colors text-sm",title:"Editar",children:(0,k.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,k.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})})}),(0,k.jsx)("button",{onClick:()=>{return t=e.id,F(t),void T(!0);var t},className:"text-red-500 dark:text-[#F4212E] hover:text-gray-700 dark:hover:text-white transition-colors text-sm",title:"Excluir",children:(0,k.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,k.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]})})]}),(0,k.jsxs)("div",{className:"space-y-3 text-sm",children:[(0,k.jsxs)("div",{className:"bg-gray-200 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-xl shadow-sm p-3 bg-red-50 dark:bg-[#F4212E] dark:bg-opacity-5",children:[(0,k.jsxs)("div",{className:"flex items-center gap-2 font-medium text-red-500 dark:text-[#F4212E] mb-1",children:[(0,k.jsx)(A,{className:"w-4 h-4"}),"Descri\xe7\xe3o da Perda"]}),(0,k.jsx)("p",{className:"text-red-500 dark:text-[#F4212E]",children:e.descricaoPerda})]}),(0,k.jsxs)("div",{className:"grid grid-cols-1 gap-2",children:[(0,k.jsxs)("div",{className:"flex items-center gap-2 ".concat(Ow.text),children:[(0,k.jsx)(mu,{className:"w-4 h-4"}),(0,k.jsxs)("span",{children:[(0,k.jsx)("strong",{children:"Respons\xe1vel:"})," ",e.responsavel]})]}),(0,k.jsxs)("div",{className:"flex items-center gap-2 ".concat(Ow.text),children:[(0,k.jsx)(iu,{className:"w-4 h-4"}),(0,k.jsxs)("span",{children:[(0,k.jsx)("strong",{children:"Data da Perda:"})," ",new Date(e.dataPerdida).toLocaleDateString("pt-BR")]})]}),e.localUltimaVez&&(0,k.jsxs)("div",{className:"flex items-center gap-2 ".concat(Ow.text),children:[(0,k.jsx)(Dd,{className:"w-4 h-4"}),(0,k.jsxs)("span",{children:[(0,k.jsx)("strong",{children:"\xdaltimo local visto:"})," ",e.localUltimaVez]})]})]}),e.valorEstimado>0&&(0,k.jsxs)("div",{className:"bg-gray-200 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-xl shadow-sm p-2 bg-yellow-50 dark:bg-[#FFD700] dark:bg-opacity-5 flex items-center gap-2",children:[(0,k.jsx)(lw,{className:"w-4 h-4 text-yellow-500 dark:text-[#FFD700]"}),(0,k.jsxs)("span",{className:"text-yellow-500 dark:text-[#FFD700]",children:[(0,k.jsx)("strong",{children:"Valor Estimado:"}),(0,k.jsxs)("span",{className:"ml-1",children:["R$ ",e.valorEstimado.toLocaleString("pt-BR",{minimumFractionDigits:2})]})]})]}),e.observacoes&&(0,k.jsxs)("div",{className:"bg-gray-200 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-xl shadow-sm p-2",children:[(0,k.jsx)("strong",{className:Ow.text,children:"Observa\xe7\xf5es:"}),(0,k.jsx)("p",{className:Ow.textSecondary,children:e.observacoes})]}),(0,k.jsxs)("div",{className:"text-xs ".concat(Ow.textSecondary," border-t pt-2"),children:["Perdida h\xe1 ",Math.floor((new Date-new Date(e.dataPerdida))/864e5)," dias"]})]})]},e.id))}),0===R.length&&(0,k.jsxs)("div",{className:"bg-gray-200 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-xl shadow-sm p-8 text-center",children:[(0,k.jsx)(Ft,{className:"w-16 h-16 mx-auto ".concat(Ow.textSecondary," mb-4")}),(0,k.jsx)("p",{className:"text-lg font-medium ".concat(Ow.text),children:p||"todos"!==y?"Nenhuma ferramenta perdida encontrada":"Nenhuma ferramenta perdida registrada"}),(0,k.jsx)("p",{className:"".concat(Ow.textSecondary," mt-2"),children:p||"todos"!==y?"Tente alterar os filtros de busca":'Clique em "Registrar Perda" para adicionar uma ocorr\xeancia'})]}),b&&(0,k.jsx)("div",{className:"fixed inset-0 bg-black/50 dark:bg-black/70 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:(0,k.jsx)("div",{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-600 rounded-xl shadow-xl max-w-3xl w-full max-h-[90vh] overflow-y-auto",children:(0,k.jsxs)("div",{className:"p-6",children:[(0,k.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,k.jsxs)("h3",{className:"text-lg font-bold text-gray-900 dark:text-white flex items-center gap-2",children:[(0,k.jsx)(Ft,{className:"w-5 h-5 text-red-500 dark:text-[#F4212E]"}),"Registrar Ferramenta Perdida"]}),(0,k.jsx)("button",{onClick:()=>N(!1),className:"text-gray-500 dark:text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-white transition-colors",children:"\u2715"})]}),(0,k.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),!f.nomeItem||!f.descricaoPerda)return void zb.error("Por favor, preencha os campos obrigat\xf3rios:\n- Nome da Ferramenta\n- Descri\xe7\xe3o da Perda\n\nOs campos obrigat\xf3rios est\xe3o marcados com *",{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"dark",className:"bg-white dark:bg-gray-800 text-gray-900 dark:text-white rounded-2xl border border-gray-200 dark:border-gray-600"});const t=(0,n.A)((0,n.A)({},f),{},{valorEstimado:f.valorEstimado?parseFloat(f.valorEstimado):0});await s(t)?(g({nomeItem:"",categoria:"",descricaoPerda:"",responsavel:"",localUltimaVez:"",dataPerdida:(new Date).toISOString().split("T")[0],valorEstimado:"",statusBusca:"buscando",observacoes:"",prioridade:"media"}),N(!1),zb.success("Ferramenta perdida registrada com sucesso!",{position:"top-right",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"dark",style:{background:"#192734",color:"#ffffff",borderRadius:"1rem",border:"1px solid #38444D"}})):zb.error("Erro ao registrar ferramenta perdida. Tente novamente.",{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"dark",style:{background:"#192734",color:"#ffffff",borderRadius:"1rem",border:"1px solid #38444D"}})},className:"space-y-4",children:[(0,k.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-white text-center mb-2",children:"Nome da Ferramenta *"}),(0,k.jsx)("input",{type:"text",value:f.nomeItem,onChange:e=>g((0,n.A)((0,n.A)({},f),{},{nomeItem:e.target.value})),className:"w-full bg-white dark:bg-gray-800 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 dark:border-gray-600 text-gray-900 dark:text-white rounded-full px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-[#1D9BF0] transition-colors text-center",placeholder:"Ex: Martelo Tramontina 25mm",list:"inventario-list",required:!0}),(0,k.jsx)("datalist",{id:"inventario-list",children:[...a].sort((e,t)=>e.nome.localeCompare(t.nome)).map(e=>(0,k.jsx)("option",{value:e.nome},e.id))})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-white text-center mb-2",children:"Categoria"}),(0,k.jsx)("input",{type:"text",value:f.categoria,onChange:e=>g((0,n.A)((0,n.A)({},f),{},{categoria:e.target.value})),className:"w-full bg-white dark:bg-gray-800 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 dark:border-gray-600 text-gray-900 dark:text-white rounded-full px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-[#1D9BF0] transition-colors text-center",placeholder:"Ex: Ferramenta Manual"})]})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-white text-center mb-2",children:"Descri\xe7\xe3o da Perda *"}),(0,k.jsx)("textarea",{value:f.descricaoPerda,onChange:e=>g((0,n.A)((0,n.A)({},f),{},{descricaoPerda:e.target.value})),className:"w-full bg-white dark:bg-gray-800 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 dark:border-gray-600 text-gray-900 dark:text-white rounded-xl px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-[#1D9BF0] transition-colors text-center h-24",placeholder:"Descreva detalhadamente as circunst\xe2ncias da perda...",required:!0})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-white text-center mb-2",children:"\xdaltimo Local Visto"}),(0,k.jsx)("input",{type:"text",value:f.localUltimaVez,onChange:e=>g((0,n.A)((0,n.A)({},f),{},{localUltimaVez:e.target.value})),className:"w-full bg-white dark:bg-gray-800 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 dark:border-gray-600 text-gray-900 dark:text-white rounded-full px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-[#1D9BF0] transition-colors text-center",placeholder:"Ex: Obra da Rua A, Almoxarifado, Canteiro 3..."})]}),(0,k.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-white text-center mb-2",children:"Valor Estimado (R$)"}),(0,k.jsx)("input",{type:"number",step:"0.01",min:"0",value:f.valorEstimado,onChange:e=>g((0,n.A)((0,n.A)({},f),{},{valorEstimado:e.target.value})),className:"w-full bg-white dark:bg-gray-800 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 dark:border-gray-600 text-gray-900 dark:text-white rounded-full px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-[#1D9BF0] transition-colors text-center",placeholder:"0,00"})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-white text-center mb-2",children:"Status da Busca"}),(0,k.jsxs)("select",{value:f.statusBusca,onChange:e=>g((0,n.A)((0,n.A)({},f),{},{statusBusca:e.target.value})),className:"w-full bg-white dark:bg-gray-800 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 dark:border-gray-600 text-gray-900 dark:text-white rounded-full px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-[#1D9BF0] transition-colors appearance-none text-center",children:[(0,k.jsx)("option",{value:"buscando",className:"bg-white dark:bg-gray-800",children:"Buscando"}),(0,k.jsx)("option",{value:"encontrada",children:"Encontrada"}),(0,k.jsx)("option",{value:"perdida_definitiva",children:"Perda Definitiva"}),(0,k.jsx)("option",{value:"substituida",children:"Substitu\xedda"})]})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-white text-center mb-2",children:"Prioridade"}),(0,k.jsxs)("select",{value:f.prioridade,onChange:e=>g((0,n.A)((0,n.A)({},f),{},{prioridade:e.target.value})),className:"w-full bg-white dark:bg-gray-800 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 dark:border-gray-600 text-gray-900 dark:text-white rounded-full px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-[#1D9BF0] transition-colors appearance-none text-center",children:[(0,k.jsx)("option",{value:"baixa",className:"bg-white dark:bg-gray-800",children:"Baixa"}),(0,k.jsx)("option",{value:"media",children:"M\xe9dia"}),(0,k.jsx)("option",{value:"alta",children:"Alta"})]})]})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-white text-center mb-2",children:"Observa\xe7\xf5es e A\xe7\xf5es Tomadas"}),(0,k.jsx)("textarea",{value:f.observacoes,onChange:e=>g((0,n.A)((0,n.A)({},f),{},{observacoes:e.target.value})),className:"w-full bg-white dark:bg-gray-800 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 dark:border-gray-600 text-gray-900 dark:text-white rounded-xl px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-[#1D9BF0] transition-colors text-center h-20 resize-none",placeholder:"Ex: J\xe1 foi feita busca no almoxarifado, verificado com outros funcion\xe1rios..."})]}),(0,k.jsxs)("div",{className:"bg-blue-500 dark:bg-[#1D9BF0] bg-opacity-5 p-4 rounded-lg border border-blue-500 dark:border-[#1D9BF0] border-opacity-10",children:[(0,k.jsxs)("div",{className:"flex items-center gap-2 text-blue-500 dark:text-[#1D9BF0] mb-2",children:[(0,k.jsx)(w,{className:"w-4 h-4"}),(0,k.jsx)("span",{className:"font-medium",children:"Dicas para recupera\xe7\xe3o:"})]}),(0,k.jsxs)("ul",{className:"text-sm text-blue-500 dark:text-[#1D9BF0] space-y-1",children:[(0,k.jsx)("li",{children:"\u2022 Verifique os locais de trabalho recentes"}),(0,k.jsx)("li",{children:"\u2022 Consulte outros funcion\xe1rios da equipe"}),(0,k.jsx)("li",{children:"\u2022 Confira ve\xedculos e equipamentos utilizados"}),(0,k.jsx)("li",{children:"\u2022 Examine \xe1reas de armazenamento tempor\xe1rio"})]})]}),(0,k.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,k.jsx)("button",{type:"submit",className:"flex-1 bg-blue-500 dark:bg-blue-500 dark:bg-[#1D9BF0] text-gray-900 dark:text-white font-bold py-2 px-4 rounded-full hover:bg-blue-600 dark:hover:bg-blue-600 dark:hover:bg-[#1a8cd8] transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-[#1D9BF0] focus:ring-offset-2 focus:ring-offset-white dark:focus:ring-offset-[#15202B]",children:"Registrar Ferramenta Perdida"}),(0,k.jsx)("button",{type:"button",onClick:()=>N(!1),className:"flex-1 border border-blue-500 dark:border-blue-500 dark:border-[#1D9BF0] text-blue-500 dark:text-blue-500 dark:text-[#1D9BF0] font-bold py-2 px-4 rounded-full hover:bg-blue-100 dark:hover:bg-blue-500 dark:bg-[#1D9BF0] dark:hover:bg-opacity-10 transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-[#1D9BF0] focus:ring-offset-2 focus:ring-offset-white dark:focus:ring-offset-[#15202B]",children:"Cancelar"})]})]})]})})}),j&&_&&(0,k.jsx)("div",{className:"fixed inset-0 bg-black/50 dark:bg-black/70 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:(0,k.jsx)("div",{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-600 rounded-xl shadow-xl max-w-3xl w-full max-h-[90vh] overflow-y-auto",children:(0,k.jsxs)("div",{className:"p-6",children:[(0,k.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,k.jsxs)("h3",{className:"text-lg font-bold text-gray-900 dark:text-white flex items-center gap-2",children:[(0,k.jsx)(Ft,{className:"w-5 h-5 text-blue-500 dark:text-[#1D9BF0]"}),"Editar Ferramenta Perdida"]}),(0,k.jsx)("button",{onClick:L,className:"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-white transition-colors",children:"\u2715"})]}),(0,k.jsxs)("form",{onSubmit:e=>{e.preventDefault();i(_.id,_)?(L(),zb.success("Ferramenta perdida atualizada com sucesso!",{position:"top-right",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"dark",style:{background:"#192734",color:"#ffffff",borderRadius:"1rem",border:"1px solid #38444D"}})):zb.error("Erro ao atualizar ferramenta perdida. Tente novamente.",{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"dark",style:{background:"#192734",color:"#ffffff",borderRadius:"1rem",border:"1px solid #38444D"}})},className:"space-y-4",children:[(0,k.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-white text-center mb-2",children:"Nome da Ferramenta *"}),(0,k.jsx)("input",{type:"text",value:_.nomeItem,onChange:e=>E((0,n.A)((0,n.A)({},_),{},{nomeItem:e.target.value})),className:"w-full bg-white dark:bg-gray-800 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 dark:border-gray-600 text-gray-900 dark:text-white rounded-full px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-[#1D9BF0] transition-colors text-center",placeholder:"Ex: Martelo Tramontina 25mm",list:"inventario-list",required:!0})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-white text-center mb-2",children:"Categoria"}),(0,k.jsx)("input",{type:"text",value:_.categoria,onChange:e=>E((0,n.A)((0,n.A)({},_),{},{categoria:e.target.value})),className:"w-full bg-white dark:bg-gray-800 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 dark:border-gray-600 text-gray-900 dark:text-white rounded-full px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-[#1D9BF0] transition-colors text-center",placeholder:"Ex: Ferramenta Manual"})]})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-white text-center mb-2",children:"Descri\xe7\xe3o da Perda *"}),(0,k.jsx)("textarea",{value:_.descricaoPerda,onChange:e=>E((0,n.A)((0,n.A)({},_),{},{descricaoPerda:e.target.value})),className:"w-full bg-white dark:bg-gray-800 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 dark:border-gray-600 text-gray-900 dark:text-white rounded-xl px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-[#1D9BF0] transition-colors text-center h-24",placeholder:"Descreva detalhadamente as circunst\xe2ncias da perda...",required:!0})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-white text-center mb-2",children:"\xdaltimo Local Visto"}),(0,k.jsx)("input",{type:"text",value:_.localUltimaVez,onChange:e=>E((0,n.A)((0,n.A)({},_),{},{localUltimaVez:e.target.value})),className:"w-full bg-white dark:bg-gray-800 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 dark:border-gray-600 text-gray-900 dark:text-white rounded-full px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-[#1D9BF0] transition-colors text-center",placeholder:"Ex: Obra da Rua A, Almoxarifado, Canteiro 3..."})]}),(0,k.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-white text-center mb-2",children:"Valor Estimado (R$)"}),(0,k.jsx)("input",{type:"number",step:"0.01",min:"0",value:_.valorEstimado,onChange:e=>E((0,n.A)((0,n.A)({},_),{},{valorEstimado:e.target.value})),className:"w-full bg-white dark:bg-gray-800 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 dark:border-gray-600 text-gray-900 dark:text-white rounded-full px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-[#1D9BF0] transition-colors text-center",placeholder:"0,00"})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-white text-center mb-2",children:"Status da Busca"}),(0,k.jsxs)("select",{value:_.statusBusca,onChange:e=>E((0,n.A)((0,n.A)({},_),{},{statusBusca:e.target.value})),className:"w-full bg-white dark:bg-gray-800 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 dark:border-gray-600 text-gray-900 dark:text-white rounded-full px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-[#1D9BF0] transition-colors appearance-none text-center",children:[(0,k.jsx)("option",{value:"buscando",className:"bg-white dark:bg-gray-800",children:"Buscando"}),(0,k.jsx)("option",{value:"encontrada",children:"Encontrada"}),(0,k.jsx)("option",{value:"perdida_definitiva",children:"Perda Definitiva"}),(0,k.jsx)("option",{value:"substituida",children:"Substitu\xedda"})]})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-white text-center mb-2",children:"Prioridade"}),(0,k.jsxs)("select",{value:_.prioridade,onChange:e=>E((0,n.A)((0,n.A)({},_),{},{prioridade:e.target.value})),className:"w-full bg-white dark:bg-gray-800 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 dark:border-gray-600 text-gray-900 dark:text-white rounded-full px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-[#1D9BF0] transition-colors appearance-none text-center",children:[(0,k.jsx)("option",{value:"baixa",className:"bg-white dark:bg-gray-800",children:"Baixa"}),(0,k.jsx)("option",{value:"media",children:"M\xe9dia"}),(0,k.jsx)("option",{value:"alta",children:"Alta"})]})]})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-white text-center mb-2",children:"Observa\xe7\xf5es e A\xe7\xf5es Tomadas"}),(0,k.jsx)("textarea",{value:_.observacoes,onChange:e=>E((0,n.A)((0,n.A)({},_),{},{observacoes:e.target.value})),className:"w-full bg-white dark:bg-gray-800 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 dark:border-gray-600 text-gray-900 dark:text-white rounded-xl px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-[#1D9BF0] transition-colors text-center h-20 resize-none",placeholder:"Ex: J\xe1 foi feita busca no almoxarifado, verificado com outros funcion\xe1rios..."})]}),(0,k.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,k.jsx)("button",{type:"submit",className:"flex-1 bg-blue-500 dark:bg-blue-500 dark:bg-[#1D9BF0] text-gray-900 dark:text-white font-bold py-2 px-4 rounded-full hover:bg-blue-600 dark:hover:bg-blue-600 dark:hover:bg-[#1a8cd8] transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-[#1D9BF0] focus:ring-offset-2 focus:ring-offset-white dark:focus:ring-offset-[#15202B]",children:"Salvar Altera\xe7\xf5es"}),(0,k.jsx)("button",{type:"button",onClick:L,className:"flex-1 border border-blue-500 dark:border-blue-500 dark:border-[#1D9BF0] text-blue-500 dark:text-blue-500 dark:text-[#1D9BF0] font-bold py-2 px-4 rounded-full hover:bg-blue-100 dark:hover:bg-blue-500 dark:bg-[#1D9BF0] dark:hover:bg-opacity-10 transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-[#1D9BF0] focus:ring-offset-2 focus:ring-offset-white dark:focus:ring-offset-[#15202B]",children:"Cancelar"})]})]})]})})}),C&&(0,k.jsx)("div",{className:"fixed inset-0 bg-black/50 dark:bg-black/70 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:(0,k.jsx)("div",{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-600 rounded-xl shadow-xl max-w-md w-full",children:(0,k.jsxs)("div",{className:"p-6",children:[(0,k.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,k.jsx)("div",{className:"w-10 h-10 bg-red-100 dark:bg-[#F4212E] dark:bg-opacity-10 rounded-full flex items-center justify-center",children:(0,k.jsx)(w,{className:"w-6 h-6 text-red-500 dark:text-[#F4212E]"})}),(0,k.jsx)("h3",{className:"text-lg font-bold text-gray-900 dark:text-white",children:"Confirmar Exclus\xe3o"})]}),(0,k.jsx)("p",{className:"".concat(Ow.text," mb-6"),children:"Tem certeza que deseja excluir este registro de ferramenta perdida? Esta a\xe7\xe3o n\xe3o pode ser desfeita."}),(0,k.jsxs)("div",{className:"flex gap-3",children:[(0,k.jsx)("button",{onClick:async()=>{await o(P)?(M(),zb.success("Registro removido com sucesso!",{position:"top-right",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"dark",style:{background:"#192734",color:"#ffffff",borderRadius:"1rem",border:"1px solid #38444D"}})):zb.error("Erro ao remover registro. Tente novamente.",{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"dark",style:{background:"#192734",color:"#ffffff",borderRadius:"1rem",border:"1px solid #38444D"}})},className:"flex-1 bg-[#F4212E] text-gray-900 dark:text-white font-bold py-2 px-4 rounded-full hover:bg-[#d91d28] transition-colors focus:outline-none focus:ring-2 focus:ring-[#F4212E] focus:ring-offset-2 focus:ring-offset-white dark:focus:ring-offset-[#15202B]",children:"Excluir"}),(0,k.jsx)("button",{onClick:M,className:"flex-1 border border-gray-200 dark:border-gray-600 dark:border-gray-600 text-gray-900 dark:text-white font-bold py-2 px-4 rounded-full hover:bg-[#38444D] hover:bg-opacity-10 transition-colors focus:outline-none focus:ring-2 focus:ring-[#38444D] focus:ring-offset-2 focus:ring-offset-white dark:focus:ring-offset-[#15202B]",children:"Cancelar"})]})]})})})]})},zw=y("trending-down",[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]]),Uw=y("history",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]),Vw=e=>{let{verificacoes:t,onClose:r}=e;const a=t.reduce((e,t)=>{const r=t.mes;return e[r]||(e[r]={data:t.dataVerificacao,responsavel:t.responsavel,itens:Object.entries(t.itens).length,diferencas:Object.entries(t.itens).filter(e=>{let[t,r]=e;return r.quantidade!==r.esperado}).length}),e},{}),n=Object.keys(a).sort().reverse(),s=e=>{const[t,r]=e.split("-");return new Date(t,parseInt(r)-1).toLocaleDateString("pt-BR",{month:"long",year:"numeric"})};return(0,k.jsx)("div",{className:"fixed inset-0 bg-black/50 dark:bg-black/70 flex items-center justify-center z-50 p-4",children:(0,k.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 max-w-2xl w-full max-h-[80vh] overflow-y-auto",children:[(0,k.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,k.jsx)("h3",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Hist\xf3rico de Verifica\xe7\xf5es"}),(0,k.jsx)("button",{onClick:r,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-full transition-colors",children:(0,k.jsx)(Id,{className:"w-5 h-5"})})]}),(0,k.jsx)("div",{className:"space-y-4",children:n.length>0?n.map(e=>{const t=a[e];return(0,k.jsxs)("div",{className:"p-4 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[(0,k.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,k.jsx)("h4",{className:"font-semibold text-gray-900 dark:text-white",children:s(e)}),(0,k.jsxs)("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:["Por: ",t.responsavel]})]}),(0,k.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,k.jsxs)("div",{className:"flex items-center gap-2",children:[(0,k.jsx)("span",{className:"text-gray-600 dark:text-gray-300",children:"Total de itens:"}),(0,k.jsx)("span",{className:"font-medium text-gray-900 dark:text-white",children:t.itens})]}),(0,k.jsxs)("div",{className:"flex items-center gap-2",children:[(0,k.jsx)("span",{className:"text-gray-600 dark:text-gray-300",children:"Itens com diferen\xe7a:"}),(0,k.jsx)("span",{className:"font-medium text-gray-900 dark:text-white",children:t.diferencas})]})]})]},e)}):(0,k.jsx)("p",{className:"text-center text-gray-500 dark:text-gray-400",children:"Nenhuma verifica\xe7\xe3o encontrada."})})]})})},qw=["children","variant","className","size","icon","disabled","loading","onClick","type"],Hw=e=>{let{children:t,variant:r="primary",className:s="",size:i="md",icon:o,disabled:l=!1,loading:c=!1,onClick:d,type:u="button"}=e,h=(0,a.A)(e,qw);const m=hw.classes;return(0,k.jsx)("button",(0,n.A)((0,n.A)({type:u,onClick:d,className:"\n        ".concat(m.button.base,"\n        ").concat((()=>{switch(r){case"primary":default:return m.button.primary;case"secondary":return m.button.secondary;case"danger":return m.button.danger;case"outline":return m.button.outline}})(),"\n        ").concat(m.button.sizes[i],"\n        ").concat(s,"\n      "),disabled:l||c},h),{},{children:(0,k.jsxs)("span",{className:"flex items-center justify-center gap-2",children:[c&&(0,k.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-current border-t-transparent"}),o&&!c&&(0,k.jsx)(o,{className:"sm"===i?"w-4 h-4":"w-5 h-5"}),c?"Carregando...":t]})}))},Gw=()=>{const[t,r]=(0,e.useState)([]),[a,i]=(0,e.useState)([]),[o,l]=(0,e.useState)((new Date).toISOString().slice(0,7)),[c,d]=(0,e.useState)(!1),[u,h]=(0,e.useState)({}),[m,f]=(0,e.useState)(null),[g,p]=(0,e.useState)(!1),[x,y]=(0,e.useState)([]),[v,b]=(0,e.useState)({}),[N,j]=(0,e.useState)(!1),[S,E]=(0,e.useState)([]),{usuario:A}=Nt(),{showToast:C}=_(),{canViewAllSectors:T}=cu(),D=T,F=(0,e.useMemo)(()=>D?t:Dt.filterBySector(t,A),[t,A,D]);(0,e.useEffect)(()=>{L()},[o]);const L=async()=>{d(!0);try{await Promise.all([M(),R(),O()])}catch(e){console.error("Erro ao carregar dados:",e),C("Erro ao carregar dados. Tente novamente.","error")}finally{d(!1)}},M=async()=>{try{const e=(await(0,s.GG)((0,s.collection)(P.db,"inventario"))).docs.map(e=>(0,n.A)({id:e.id},e.data()));r(e)}catch(e){throw console.error("Erro ao carregar invent\xe1rio:",e),e}},R=async()=>{try{const e=(0,s.P)((0,s.collection)(P.db,"emprestimos"),(0,s._M)("status","==","emprestado")),t=(await(0,s.GG)(e)).docs.map(e=>(0,n.A)({id:e.id},e.data()));E(t)}catch(e){throw console.error("Erro ao carregar empr\xe9stimos:",e),e}},O=async()=>{try{const e=(0,s.collection)(P.db,"verificacoes_mensais"),r=(0,s.P)(e,(0,s._M)("mes","==",o)),a=await(0,s.GG)(r);if(a.empty){i([]);const e={};t.forEach(t=>{e[t.id]=t.disponivel||0}),h(e)}else{const e=a.docs[0],t=e.data();i([(0,n.A)({id:e.id},t)]);const r={};Object.keys(t.itens||{}).forEach(e=>{r[e]=t.itens[e].quantidade}),h(r)}const[l,c]=o.split("-"),d="01"===c?"".concat(parseInt(l)-1,"-12"):"".concat(l,"-").concat(String(parseInt(c)-1).padStart(2,"0")),u=(0,s.P)(e,(0,s._M)("mes","==",d)),m=await(0,s.GG)(u);if(m.empty)b({});else{const e=m.docs[0].data();b(e.itens||{})}}catch(e){throw console.error("Erro ao carregar verifica\xe7\xf5es:",e),e}},B=e=>e>0?(0,k.jsx)(Pd,{className:"w-4 h-4 text-green-500"}):e<0?(0,k.jsx)(zw,{className:"w-4 h-4 text-red-500"}):(0,k.jsx)(mw,{className:"w-4 h-4 text-gray-400"}),z=e=>e>0?"text-green-600 dark:text-green-400 bg-green-50 dark:bg-green-900/20":e<0?"text-red-600 dark:text-red-400 bg-red-50 dark:bg-red-900/20":"text-gray-600 dark:text-gray-400 bg-gray-50 dark:bg-gray-800";return(0,k.jsxs)("div",{className:"space-y-6 p-6",children:[!D&&(null===A||void 0===A?void 0:A.setor)&&(0,k.jsxs)("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-700 rounded-xl px-4 py-3 flex items-center gap-3",children:[(0,k.jsx)(I,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"}),(0,k.jsxs)("p",{className:"text-sm text-blue-800 dark:text-blue-300",children:[(0,k.jsx)("strong",{children:"Setor:"})," ",A.setor," - Visualizando apenas itens do seu setor"]})]}),(0,k.jsxs)("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[(0,k.jsxs)("div",{className:"flex items-center gap-3",children:[(0,k.jsx)(iu,{className:"w-6 h-6 text-[#1D9BF0]"}),(0,k.jsx)("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Verifica\xe7\xe3o Mensal"})]}),(0,k.jsxs)("div",{className:"flex items-center gap-3",children:[(0,k.jsx)("input",{type:"month",value:o,onChange:e=>l(e.target.value),className:"rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 px-4 py-2 text-gray-900 dark:text-white focus:ring-2 focus:ring-[#1D9BF0] focus:border-transparent"}),(0,k.jsx)("button",{onClick:async()=>{try{d(!0);const e=(0,s.collection)(P.db,"verificacoes_mensais"),t=(0,s.P)(e,(0,s.My)("mes","desc")),r=(await(0,s.GG)(t)).docs.map(e=>(0,n.A)({id:e.id},e.data()));y(r),p(!0)}catch(e){console.error("Erro ao carregar hist\xf3rico:",e),C("Erro ao carregar hist\xf3rico.","error")}finally{d(!1)}},className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",title:"Ver hist\xf3rico",children:(0,k.jsx)(Uw,{className:"w-5 h-5 text-gray-600 dark:text-gray-400"})}),(0,k.jsxs)(Hw,{onClick:()=>j(!0),className:"bg-[#1D9BF0] hover:bg-[#1a8cd8] text-white px-6 py-2 rounded-lg flex items-center gap-2 transition-colors",children:[(0,k.jsx)(fu,{className:"w-5 h-5"}),"Nova Verifica\xe7\xe3o"]})]})]}),(0,k.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,k.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700",children:(0,k.jsxs)("div",{className:"flex items-center justify-between",children:[(0,k.jsxs)("div",{children:[(0,k.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Total de Itens"}),(0,k.jsx)("p",{className:"text-3xl font-bold text-gray-900 dark:text-white mt-1",children:F.length})]}),(0,k.jsx)(Md,{className:"w-12 h-12 text-blue-500 opacity-20"})]})}),(0,k.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700",children:(0,k.jsxs)("div",{className:"flex items-center justify-between",children:[(0,k.jsxs)("div",{children:[(0,k.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Emprestados"}),(0,k.jsx)("p",{className:"text-3xl font-bold text-orange-600 dark:text-orange-400 mt-1",children:S.length})]}),(0,k.jsx)(fu,{className:"w-12 h-12 text-orange-500 opacity-20"})]})}),(0,k.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700",children:(0,k.jsxs)("div",{className:"flex items-center justify-between",children:[(0,k.jsxs)("div",{children:[(0,k.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Verifica\xe7\xf5es"}),(0,k.jsx)("p",{className:"text-3xl font-bold text-green-600 dark:text-green-400 mt-1",children:a.length})]}),(0,k.jsx)(Fd,{className:"w-12 h-12 text-green-500 opacity-20"})]})})]}),(0,k.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 overflow-hidden",children:(0,k.jsx)("div",{className:"overflow-x-auto",children:(0,k.jsxs)("table",{className:"w-full",children:[(0,k.jsx)("thead",{className:"bg-gray-50 dark:bg-gray-700 border-b border-gray-200 dark:border-gray-600",children:(0,k.jsxs)("tr",{children:[(0,k.jsx)("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase tracking-wider",children:"Item"}),(0,k.jsx)("th",{className:"px-6 py-4 text-center text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase tracking-wider",children:"M\xeas Anterior"}),(0,k.jsx)("th",{className:"px-6 py-4 text-center text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase tracking-wider",children:"Dispon\xedvel"}),(0,k.jsx)("th",{className:"px-6 py-4 text-center text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase tracking-wider",children:"Emprestado"}),(0,k.jsx)("th",{className:"px-6 py-4 text-center text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase tracking-wider",children:"Atual"}),(0,k.jsx)("th",{className:"px-6 py-4 text-center text-xs font-semibold text-gray-700 dark:text-gray-300 uppercase tracking-wider",children:"Diferen\xe7a"})]})}),(0,k.jsx)("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:F.sort((e,t)=>e.nome.localeCompare(t.nome)).map(e=>{var t;const r=(null===(t=v[e.id])||void 0===t?void 0:t.quantidade)||0,a=u[e.id]||e.disponivel||0,s=(e=>{const t=e.trim().toLowerCase();let r=0;return S.forEach(e=>{var a;null===(a=e.ferramentas)||void 0===a||a.forEach(e=>{if(("string"===typeof e?e:e.nome).trim().toLowerCase()===t){const t="string"===typeof e?1:e.quantidade||1;r+=t}})}),r})(e.nome),i=a-r,o=(e=>{const t=e.trim().toLowerCase();return S.filter(e=>{var r;return null===(r=e.ferramentas)||void 0===r?void 0:r.some(e=>("string"===typeof e?e:e.nome).trim().toLowerCase()===t)})})(e.nome);return(0,k.jsxs)("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors",children:[(0,k.jsx)("td",{className:"px-6 py-4",children:(0,k.jsxs)("div",{className:"flex items-center gap-3",children:[(0,k.jsx)("div",{className:"w-10 h-10 rounded-lg bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center text-white font-bold",children:e.nome.charAt(0).toUpperCase()}),(0,k.jsxs)("div",{children:[(0,k.jsx)("p",{className:"font-medium text-gray-900 dark:text-white",children:e.nome}),e.setorNome&&(0,k.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:e.setorNome})]})]})}),(0,k.jsx)("td",{className:"px-6 py-4 text-center",children:(0,k.jsx)("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300",children:r})}),(0,k.jsx)("td",{className:"px-6 py-4 text-center",children:(0,k.jsx)("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400",children:e.disponivel||0})}),(0,k.jsx)("td",{className:"px-6 py-4 text-center",children:(0,k.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,k.jsx)("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ".concat(s>0?"bg-orange-100 dark:bg-orange-900/30 text-orange-700 dark:text-orange-400":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300"),children:s}),o.length>0&&(0,k.jsxs)("span",{className:"text-xs text-gray-500 dark:text-gray-400 cursor-help",title:"".concat(o.length," empr\xe9stimo(s) ativo(s)"),children:["(",o.length,")"]})]})}),(0,k.jsx)("td",{className:"px-6 py-4 text-center",children:(0,k.jsx)("input",{type:"number",min:"0",value:a,onChange:t=>((e,t)=>{const r=parseInt(t)||0;h(t=>(0,n.A)((0,n.A)({},t),{},{[e]:r}))})(e.id,t.target.value),className:"w-20 px-3 py-1.5 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-center text-gray-900 dark:text-white focus:ring-2 focus:ring-[#1D9BF0] focus:border-transparent"})}),(0,k.jsx)("td",{className:"px-6 py-4 text-center",children:(0,k.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[B(i),(0,k.jsxs)("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-semibold ".concat(z(i)),children:[i>0?"+":"",i]})]})})]},e.id)})})]})})}),N&&(0,k.jsx)("div",{className:"fixed inset-0 bg-black/60 dark:bg-black/80 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:(0,k.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-hidden",children:[(0,k.jsx)("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:(0,k.jsxs)("div",{className:"flex items-center justify-between",children:[(0,k.jsxs)("div",{className:"flex items-center gap-3",children:[(0,k.jsx)("div",{className:"w-12 h-12 rounded-xl bg-[#1D9BF0]/10 flex items-center justify-center",children:(0,k.jsx)(uw,{className:"w-6 h-6 text-[#1D9BF0]"})}),(0,k.jsxs)("div",{children:[(0,k.jsx)("h3",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Salvar Verifica\xe7\xe3o"}),(0,k.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Confirme os dados antes de salvar"})]})]}),(0,k.jsx)("button",{onClick:()=>j(!1),className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:(0,k.jsx)(Id,{className:"w-5 h-5 text-gray-500 dark:text-gray-400"})})]})}),(0,k.jsxs)("div",{className:"p-6 max-h-[60vh] overflow-y-auto",children:[(0,k.jsxs)("p",{className:"text-gray-700 dark:text-gray-300 mb-4",children:["Voc\xea est\xe1 prestes a salvar a verifica\xe7\xe3o mensal de ",(0,k.jsx)("strong",{children:new Date(o+"-01").toLocaleDateString("pt-BR",{month:"long",year:"numeric"})}),"."]}),(0,k.jsxs)("div",{className:"space-y-2 mb-6",children:[(0,k.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[(0,k.jsx)("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Total de itens"}),(0,k.jsx)("span",{className:"font-semibold text-gray-900 dark:text-white",children:F.length})]}),(0,k.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[(0,k.jsx)("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Respons\xe1vel"}),(0,k.jsx)("span",{className:"font-semibold text-gray-900 dark:text-white",children:A.nome})]}),(0,k.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[(0,k.jsx)("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Data"}),(0,k.jsx)("span",{className:"font-semibold text-gray-900 dark:text-white",children:(new Date).toLocaleDateString("pt-BR")})]})]}),(0,k.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Esta a\xe7\xe3o salvar\xe1 as quantidades atuais e criar\xe1 um registro hist\xf3rico da verifica\xe7\xe3o."})]}),(0,k.jsxs)("div",{className:"p-6 border-t border-gray-200 dark:border-gray-700 flex items-center justify-end gap-3",children:[(0,k.jsx)("button",{onClick:()=>j(!1),disabled:c,className:"px-6 py-2.5 text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 rounded-lg font-medium transition-colors disabled:opacity-50",children:"Cancelar"}),(0,k.jsx)("button",{onClick:async()=>{try{d(!0);const e={mes:o,dataVerificacao:(new Date).toISOString(),responsavel:A.nome,itens:{}};F.forEach(t=>{var r;const a=u[t.id]||0,n=(null===(r=v[t.id])||void 0===r?void 0:r.quantidade)||0,s=a-n;e.itens[t.id]={nome:t.nome,quantidade:a,quantidadeAnterior:n,diferenca:s,setorId:t.setorId,setorNome:t.setorNome}}),a.length>0?(await(0,s.updateDoc)((0,s.doc)(P.db,"verificacoes_mensais",a[0].id),e),C("Verifica\xe7\xe3o atualizada com sucesso!","success")):(await(0,s.gS)((0,s.collection)(P.db,"verificacoes_mensais"),e),C("Verifica\xe7\xe3o salva com sucesso!","success")),j(!1),await O()}catch(e){console.error("Erro ao salvar verifica\xe7\xe3o:",e),C("Erro ao salvar verifica\xe7\xe3o. Tente novamente.","error")}finally{d(!1)}},disabled:c,className:"px-6 py-2.5 bg-[#1D9BF0] hover:bg-[#1a8cd8] text-white rounded-lg font-medium flex items-center gap-2 transition-colors disabled:opacity-50",children:c?(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Salvando..."]}):(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(uw,{className:"w-5 h-5"}),"Salvar Verifica\xe7\xe3o"]})})]})]})}),g&&(0,k.jsx)(Vw,{verificacoes:x,onClose:()=>p(!1)}),m&&(0,k.jsx)("div",{className:"fixed inset-0 bg-black/60 dark:bg-black/80 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:(0,k.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-2xl w-full max-w-md",children:(0,k.jsxs)("div",{className:"p-6",children:[(0,k.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,k.jsx)("div",{className:"w-12 h-12 rounded-xl bg-red-100 dark:bg-red-900/30 flex items-center justify-center",children:(0,k.jsx)(w,{className:"w-6 h-6 text-red-600 dark:text-red-400"})}),(0,k.jsx)("h3",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Confirmar Remo\xe7\xe3o"})]}),(0,k.jsxs)("p",{className:"text-gray-700 dark:text-gray-300 mb-6",children:["Tem certeza que deseja remover ",(0,k.jsx)("strong",{children:m.nome}),"? Esta a\xe7\xe3o n\xe3o pode ser desfeita."]}),(0,k.jsxs)("div",{className:"flex items-center justify-end gap-3",children:[(0,k.jsx)("button",{onClick:()=>f(null),className:"px-6 py-2.5 text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 rounded-lg font-medium transition-colors",children:"Cancelar"}),(0,k.jsx)("button",{onClick:async()=>{try{await(0,s.deleteDoc)((0,s.doc)(P.db,"inventario",m.id)),r(e=>e.filter(e=>e.id!==m.id)),C("Item removido com sucesso!","success"),f(null)}catch(e){console.error("Erro ao remover item:",e),C("Erro ao remover item.","error")}},className:"px-6 py-2.5 bg-red-600 hover:bg-red-700 text-white rounded-lg font-medium transition-colors",children:"Remover"})]})]})})})]})},Ww="inventario",Kw="compras",Qw="danificadas",Yw="perdidas",Xw="verificacao",Jw=t=>{let{inventario:r,emprestimos:a,adicionarItem:n,removerItem:s,atualizarItem:i,obterDetalhesEmprestimos:o,compras:l,funcionarios:c,adicionarCompra:d,removerCompra:u,atualizarCompra:h,ferramentasDanificadas:m,adicionarFerramentaDanificada:f,atualizarFerramentaDanificada:g,removerFerramentaDanificada:p,ferramentasPerdidas:x,adicionarFerramentaPerdida:y,atualizarFerramentaPerdida:v,removerFerramentaPerdida:b}=t;const{usuario:N}=Nt(),{filterBySector:j,canViewAllSectors:S,userSetorNome:_,getPermissionScope:E}=cu(),[A,C]=(0,e.useState)(Ww),T=1===(null===N||void 0===N?void 0:N.nivel),D=(0,e.useMemo)(()=>j(r),[r,j]),P=(0,e.useMemo)(()=>j(a),[a,j]),F=(0,e.useMemo)(()=>({inventario:D.length,compras:(null===l||void 0===l?void 0:l.filter(e=>"solicitado"===e.status||"aprovado"===e.status).length)||0,danificadas:(null===m||void 0===m?void 0:m.filter(e=>"reparada"!==e.statusReparo&&"substituida"!==e.statusReparo).length)||0,perdidas:(null===x||void 0===x?void 0:x.filter(e=>"buscando"===e.statusBusca).length)||0,verificacao:0}),[D,l,m,x]),L=(0,e.useMemo)(()=>{const e=D.reduce((e,t)=>e+(parseFloat(t.valorUnitario)||0)*(parseInt(t.quantidade)||0),0),t=(null===l||void 0===l?void 0:l.filter(e=>"solicitado"===e.status||"aprovado"===e.status).reduce((e,t)=>e+(parseFloat(t.valorUnitario)||0)*(parseInt(t.quantidade)||0),0))||0,r=(null===m||void 0===m?void 0:m.filter(e=>"reparada"!==e.statusReparo&&"substituida"!==e.statusReparo).reduce((e,t)=>e+(parseFloat(t.valorUnitario)||0),0))||0,a=(null===x||void 0===x?void 0:x.filter(e=>"buscando"===e.statusBusca||"perdida_definitiva"===e.statusBusca).reduce((e,t)=>e+(parseFloat(t.valorUnitario)||0),0))||0;return{inventario:e-r-a,inventarioBruto:e,compras:t,danificadas:r,perdidas:a}},[D,l,m,x]),M=[{id:Ww,label:"Invent\xe1rio",icon:Md,badge:F.inventario,color:"blue"},{id:Kw,label:"Compras",icon:qb,badge:F.compras,color:"green"},{id:Qw,label:"Danificadas",icon:Hb,badge:F.danificadas,color:"orange"},{id:Yw,label:"Perdidas",icon:w,badge:F.perdidas,color:"red"},{id:Xw,label:"Verifica\xe7\xe3o",icon:Gb,badge:F.verificacao,color:"purple"}];return(0,k.jsxs)("div",{className:"bg-gray-50 dark:bg-[#15202B] text-gray-900 dark:text-white min-h-screen",children:[(0,k.jsx)("div",{className:"sticky top-0 z-40 bg-white/80 dark:bg-[#192734]/80 backdrop-blur-xl border-b border-gray-200 dark:border-gray-800",children:(0,k.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,k.jsx)("div",{className:"hidden md:flex items-center justify-start px-4 overflow-x-auto",children:M.map(e=>{const t=e.icon,r=A===e.id;return(0,k.jsxs)("button",{onClick:()=>C(e.id),className:"\n                    relative flex items-center gap-2 px-6 py-4 font-medium text-sm\n                    transition-all duration-200 whitespace-nowrap\n                    ".concat(r?"text-[#1D9BF0] dark:text-[#1D9BF0]":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200","\n                  "),children:[(0,k.jsx)(t,{className:"w-5 h-5"}),(0,k.jsx)("span",{children:e.label}),e.badge>0&&(0,k.jsx)("span",{className:"\n                      ml-1 px-2 py-0.5 text-xs font-bold rounded-full\n                      ".concat(r?"bg-[#1D9BF0] text-white":"bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300","\n                    "),children:e.badge}),r&&(0,k.jsx)("div",{className:"absolute bottom-0 left-0 right-0 h-1 bg-[#1D9BF0] rounded-t-full"})]},e.id)})}),(0,k.jsx)("div",{className:"md:hidden flex overflow-x-auto px-2 py-2 gap-2",children:M.map(e=>{const t=e.icon,r=A===e.id;return(0,k.jsxs)("button",{onClick:()=>C(e.id),className:"\n                    relative flex flex-col items-center justify-center gap-1 px-4 py-3 rounded-xl\n                    transition-all duration-200 min-w-[80px]\n                    ".concat(r?"bg-[#1D9BF0]/10 text-[#1D9BF0] dark:bg-[#1D9BF0]/20":"bg-transparent text-gray-600 dark:text-gray-400","\n                  "),children:[(0,k.jsxs)("div",{className:"relative",children:[(0,k.jsx)(t,{className:"w-6 h-6"}),e.badge>0&&(0,k.jsx)("span",{className:"absolute -top-1 -right-1 w-4 h-4 bg-red-500 text-white text-[10px] font-bold rounded-full flex items-center justify-center",children:e.badge>9?"9+":e.badge})]}),(0,k.jsx)("span",{className:"text-xs font-medium",children:e.label})]},e.id)})})]})}),(0,k.jsx)("div",{className:"p-4 max-w-7xl mx-auto",children:(()=>{switch(A){case Ww:return(0,k.jsxs)("div",{className:"space-y-6",children:[!S&&(0,k.jsxs)("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-700 rounded-lg px-4 py-3 flex items-center gap-3",children:[(0,k.jsx)(Wb,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"}),(0,k.jsxs)("div",{className:"flex-1",children:[(0,k.jsx)("p",{className:"text-sm font-medium text-blue-800 dark:text-blue-300",children:E()}),(0,k.jsxs)("p",{className:"text-xs text-blue-600 dark:text-blue-400 mt-0.5",children:["Voc\xea est\xe1 visualizando apenas os itens do seu setor (",D.length," itens)"]})]})]}),S&&(0,k.jsxs)("div",{className:"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-700 rounded-lg px-4 py-3 flex items-center gap-3",children:[(0,k.jsx)(I,{className:"w-5 h-5 text-green-600 dark:text-green-400"}),(0,k.jsxs)("div",{className:"flex-1",children:[(0,k.jsx)("p",{className:"text-sm font-medium text-green-800 dark:text-green-300",children:"Modo Administrador - Visualizando todos os setores"}),(0,k.jsxs)("p",{className:"text-xs text-green-600 dark:text-green-400 mt-0.5",children:["Total de ",D.length," itens em todos os setores"]})]})]}),(0,k.jsx)("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 dark:from-blue-900/30 dark:to-blue-800/30 border-2 border-blue-300 dark:border-blue-600 rounded-xl px-6 py-4 shadow-lg",children:(0,k.jsxs)("div",{className:"flex items-center justify-between",children:[(0,k.jsxs)("div",{className:"flex items-center gap-3",children:[(0,k.jsx)("div",{className:"bg-blue-500 dark:bg-blue-600 p-3 rounded-xl shadow-md",children:(0,k.jsx)(Md,{className:"w-6 h-6 text-white"})}),(0,k.jsxs)("div",{children:[(0,k.jsx)("p",{className:"text-sm font-medium text-blue-700 dark:text-blue-300",children:"Valor Total do Invent\xe1rio"}),(0,k.jsxs)("p",{className:"text-xs text-blue-600 dark:text-blue-400",children:[D.length," itens em estoque"]})]})]}),(0,k.jsxs)("div",{className:"text-right",children:[(0,k.jsx)("p",{className:"text-3xl font-bold text-blue-600 dark:text-blue-400",children:L.inventario.toLocaleString("pt-BR",{style:"currency",currency:"BRL"})}),(L.danificadas>0||L.perdidas>0)&&(0,k.jsxs)("div",{className:"text-xs text-blue-500 dark:text-blue-500 mt-1 space-y-0.5",children:[(0,k.jsxs)("p",{className:"text-gray-500 dark:text-gray-400",children:["Valor bruto: ",L.inventarioBruto.toLocaleString("pt-BR",{style:"currency",currency:"BRL"})]}),L.danificadas>0&&(0,k.jsxs)("p",{className:"text-orange-600 dark:text-orange-400",children:["- Danificadas: ",L.danificadas.toLocaleString("pt-BR",{style:"currency",currency:"BRL"})]}),L.perdidas>0&&(0,k.jsxs)("p",{className:"text-red-600 dark:text-red-400",children:["- Perdidas: ",L.perdidas.toLocaleString("pt-BR",{style:"currency",currency:"BRL"})]})]}),!(L.danificadas>0||L.perdidas>0)&&(0,k.jsx)("p",{className:"text-xs text-blue-500 dark:text-blue-500 mt-1",children:"Valor patrimonial"})]})]})}),!T&&(0,k.jsx)(Zb,{adicionarItem:n,userSetorId:null===N||void 0===N?void 0:N.setorId,userSetorNome:_}),(0,k.jsx)(dw,{inventario:D,emprestimos:P,removerItem:s,atualizarItem:i,readonly:T,obterDetalhesEmprestimos:o})]});case Kw:return(0,k.jsx)(Tw,{compras:l,inventario:r,funcionarios:c,adicionarCompra:d,removerCompra:u,atualizarCompra:h,readonly:T});case Qw:return(0,k.jsx)(Mw,{ferramentasDanificadas:m,inventario:r,adicionarFerramentaDanificada:f,atualizarFerramentaDanificada:g,removerFerramentaDanificada:p,readonly:T});case Yw:return(0,k.jsx)(Bw,{ferramentasPerdidas:x,inventario:r,adicionarFerramentaPerdida:y,atualizarFerramentaPerdida:v,removerFerramentaPerdida:b,readonly:T});case Xw:return(0,k.jsx)(Gw,{});default:return null}})()})]})},Zw=y("backpack",[["path",{d:"M4 10a4 4 0 0 1 4-4h8a4 4 0 0 1 4 4v10a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2z",key:"1ol0lm"}],["path",{d:"M8 10h8",key:"c7uz4u"}],["path",{d:"M8 18h8",key:"1no2b1"}],["path",{d:"M8 22v-6a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v6",key:"1fr6do"}],["path",{d:"M9 6V4a2 2 0 0 1 2-2h2a2 2 0 0 1 2 2v2",key:"donm21"}]]);const $w=function(e){let{ferramentasDisponiveis:t,onAdicionarFerramenta:r}=e;return(0,k.jsxs)("div",{className:"relative w-full",children:[(0,k.jsxs)("select",{onChange:e=>{e.target.value&&(r(e.target.value),e.target.value="")},className:"h-[36px] w-full text-sm font-medium rounded-lg appearance-none pl-4 pr-10 bg-white dark:bg-gray-800 hover:bg-gray-50 dark:bg-gray-800 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-200 border border-gray-200 dark:border-gray-600 dark:border-gray-300 dark:border-gray-600 focus:outline-none focus:ring-2 focus:ring-[#1D9BF0]",children:[(0,k.jsx)("option",{value:"",children:"Selecione uma ferramenta..."}),t.sort((e,t)=>e.nome.localeCompare(t.nome)).map(e=>(0,k.jsxs)("option",{value:e.nome,children:[e.nome," (",e.disponivel," dispon\xedveis)"]},e.nome))]}),(0,k.jsx)("div",{className:"absolute inset-y-0 right-0 flex items-center px-2 pointer-events-none",children:(0,k.jsx)(Mt,{className:"h-4 w-4 text-gray-400"})})]})},ek=t=>{let{ferramentas:r,funcionarioNome:a,funcionarioFoto:n,onComplete:s}=t;const[i,o]=(0,e.useState)(0),[l,c]=(0,e.useState)(0),[d,u]=(0,e.useState)([]);(0,e.useEffect)(()=>{const e=Array.from({length:20},(e,t)=>({id:t,x:100*Math.random(),y:100*Math.random(),size:4*Math.random()+2,delay:.5*Math.random(),duration:2*Math.random()+1}));u(e);const t=[{step:0,duration:800},{step:1,duration:1500},{step:2,duration:1200},{step:3,duration:1e3},{step:4,duration:800}];let a=0;t.forEach(e=>{let{step:t,duration:n}=e;setTimeout(()=>{3===t&&l<r.length-1?(c(e=>e+1),o(0)):o(t)},a),a+=n});const n=t.reduce((e,t)=>{let{duration:r}=t;return e+r},0);setTimeout(()=>{null===s||void 0===s||s()},n*r.length+500)},[l]);const h=r[l];return(0,k.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 backdrop-blur-sm",children:(0,k.jsxs)("div",{className:"relative w-full h-full max-w-6xl max-h-screen flex items-center justify-center p-8",children:[(0,k.jsx)("div",{className:"absolute inset-0 overflow-hidden",children:d.map(e=>(0,k.jsx)(Cd.div,{className:"absolute rounded-full bg-blue-400/30",style:{width:e.size,height:e.size,left:"".concat(e.x,"%"),top:"".concat(e.y,"%")},animate:{scale:[0,1,0],opacity:[0,1,0],y:[0,-50,-100]},transition:{duration:e.duration,repeat:1/0,delay:e.delay,ease:"easeInOut"}},e.id))}),(0,k.jsxs)("div",{className:"relative w-full h-full flex items-center justify-between",children:[(0,k.jsxs)(Cd.div,{className:"relative flex flex-col items-center gap-4 z-10",initial:{opacity:0,x:-100},animate:{opacity:1,x:0},transition:{duration:.5},children:[(0,k.jsx)(Cd.div,{className:"w-40 h-40 rounded-3xl bg-gradient-to-br from-blue-500 to-blue-700 shadow-2xl flex items-center justify-center ".concat(1===i?"ring-8 ring-blue-300 ring-opacity-50":""),animate:1===i?{scale:[1,1.1,.95,1],rotate:[0,-5,5,0]}:{},transition:{duration:.6},children:(0,k.jsx)(Md,{className:"w-20 h-20 text-white"})}),(0,k.jsxs)("div",{className:"text-center",children:[(0,k.jsx)("h3",{className:"text-2xl font-bold text-white mb-1",children:"Almoxarifado"}),(0,k.jsx)("p",{className:"text-blue-200 text-sm",children:"Estoque Principal"})]}),1===i&&(0,k.jsx)(Cd.div,{className:"absolute inset-0 rounded-3xl border-4 border-blue-400",animate:{scale:[1,1.5,2],opacity:[.8,.4,0]},transition:{duration:1.5,repeat:1/0,ease:"easeOut"}})]}),(0,k.jsxs)("div",{className:"flex-1 flex items-center justify-center relative h-full",children:[(0,k.jsx)(Pr,{mode:"wait",children:i>=1&&i<=3&&(0,k.jsx)(Cd.div,{className:"absolute",initial:{x:-400,y:0,scale:0,rotate:-180,opacity:0},animate:{x:1===i?-200:2===i?0:200,y:2===i?[-20,-60,-20]:0,scale:2===i?[1,1.3,1]:1,rotate:2===i?[0,360,720]:0,opacity:1},exit:{x:400,scale:0,opacity:0,rotate:180},transition:{duration:2===i?1.2:.8,ease:"easeInOut"},children:(0,k.jsxs)(Cd.div,{className:"relative",animate:{y:[0,-10,0]},transition:{duration:2,repeat:1/0,ease:"easeInOut"},children:[(0,k.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-2xl p-6 min-w-[250px] border-4 border-yellow-400",children:[(0,k.jsx)(Cd.div,{className:"absolute inset-0 rounded-2xl bg-gradient-to-r from-transparent via-white to-transparent opacity-30",animate:{x:[-250,250]},transition:{duration:1.5,repeat:1/0,repeatDelay:.5}}),(0,k.jsxs)("div",{className:"relative z-10",children:[(0,k.jsx)("div",{className:"flex items-center justify-center mb-4",children:(0,k.jsx)("div",{className:"w-16 h-16 rounded-full bg-gradient-to-br from-yellow-400 to-orange-500 flex items-center justify-center",children:(0,k.jsx)(Hb,{className:"w-8 h-8 text-white"})})}),(0,k.jsx)("h4",{className:"text-lg font-bold text-gray-900 dark:text-white text-center mb-2",children:null===h||void 0===h?void 0:h.nome}),(0,k.jsx)("div",{className:"flex items-center justify-center gap-2",children:(0,k.jsxs)("span",{className:"bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200 text-sm font-bold px-3 py-1 rounded-full",children:[null===h||void 0===h?void 0:h.quantidade,"x"]})})]})]}),2===i&&(0,k.jsx)(k.Fragment,{children:[...Array(8)].map((e,t)=>(0,k.jsx)(Cd.div,{className:"absolute top-1/2 left-1/2",initial:{scale:0,opacity:0},animate:{x:60*Math.cos(t*Math.PI*2/8),y:60*Math.sin(t*Math.PI*2/8),scale:[0,1,0],opacity:[0,1,0]},transition:{duration:1,repeat:1/0,delay:.1*t},children:(0,k.jsx)(Xb,{className:"w-4 h-4 text-yellow-400"})},t))})]})},"ferramenta-".concat(l))}),(0,k.jsx)(Cd.div,{className:"absolute top-1/2 left-0 right-0 h-1 bg-gradient-to-r from-blue-500 via-yellow-400 to-green-500 opacity-30",initial:{scaleX:0},animate:{scaleX:i>=1?1:0},transition:{duration:.8},style:{transformOrigin:"left"}}),2===i&&(0,k.jsx)("div",{className:"absolute inset-0 flex items-center justify-center overflow-hidden",children:[...Array(12)].map((e,t)=>(0,k.jsx)(Cd.div,{className:"absolute w-32 h-0.5 bg-gradient-to-r from-transparent via-blue-400 to-transparent",style:{rotate:"".concat(360*t/12,"deg"),originX:.5,originY:.5},animate:{scaleX:[0,2,0],opacity:[0,1,0]},transition:{duration:.8,repeat:1/0,delay:.05*t}},t))})]}),(0,k.jsxs)(Cd.div,{className:"relative flex flex-col items-center gap-4 z-10",initial:{opacity:0,x:100},animate:{opacity:1,x:0},transition:{duration:.5,delay:.2},children:[(0,k.jsxs)(Cd.div,{className:"w-40 h-40 rounded-3xl overflow-hidden shadow-2xl flex items-center justify-center relative ".concat(3===i?"ring-8 ring-green-300 ring-opacity-50":""),animate:3===i?{scale:[1,1.15,1],rotate:[0,5,-5,0]}:{},transition:{duration:.8},children:[n?(0,k.jsx)("img",{src:n,alt:a,className:"w-full h-full object-cover"}):(0,k.jsx)("div",{className:"w-full h-full bg-gradient-to-br from-green-500 to-green-700 flex items-center justify-center",children:(0,k.jsx)(mu,{className:"w-20 h-20 text-white"})}),3===i&&(0,k.jsx)(Cd.div,{className:"absolute inset-0 bg-green-500/30",initial:{opacity:0},animate:{opacity:[0,.6,0]},transition:{duration:1}})]}),(0,k.jsxs)("div",{className:"text-center",children:[(0,k.jsx)("h3",{className:"text-2xl font-bold text-white mb-1",children:a}),(0,k.jsx)("p",{className:"text-green-200 text-sm",children:"Funcion\xe1rio"})]}),3===i&&(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(Cd.div,{className:"absolute inset-0 rounded-3xl border-4 border-green-400",animate:{scale:[1,1.5,2],opacity:[.8,.4,0]},transition:{duration:1.5,repeat:1/0,ease:"easeOut"}}),[...Array(30)].map((e,t)=>(0,k.jsx)(Cd.div,{className:"absolute w-2 h-2 rounded-full",style:{backgroundColor:["#3b82f6","#10b981","#f59e0b","#ef4444","#8b5cf6"][t%5]},initial:{y:0,x:0,opacity:1},animate:{y:200*Math.random()-100,x:200*Math.random()-100,opacity:0,rotate:360*Math.random()},transition:{duration:1.5,delay:.3*Math.random()}},t))]})]})]}),(0,k.jsx)("div",{className:"absolute bottom-8 left-1/2 transform -translate-x-1/2 bg-white/90 dark:bg-gray-800/90 backdrop-blur-md rounded-2xl shadow-2xl px-8 py-4 border-2 border-gray-200 dark:border-gray-700",children:(0,k.jsxs)("div",{className:"flex items-center gap-4",children:[(0,k.jsx)(Cd.div,{animate:{rotate:360},transition:{duration:2,repeat:1/0,ease:"linear"},children:(0,k.jsx)(Wd,{className:"w-6 h-6 text-yellow-500"})}),(0,k.jsxs)("div",{children:[(0,k.jsxs)("p",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300",children:["Transferindo ferramenta ",l+1," de ",r.length]}),(0,k.jsx)("div",{className:"flex items-center gap-2 mt-1",children:r.map((e,t)=>(0,k.jsx)("div",{className:"h-2 rounded-full transition-all duration-300 ".concat(t<l?"w-8 bg-green-500":t===l?"w-12 bg-blue-500":"w-6 bg-gray-300 dark:bg-gray-600")},t))})]})]})}),(0,k.jsx)(Pr,{children:4===i&&l===r.length-1&&(0,k.jsx)(Cd.div,{className:"absolute inset-0 flex items-center justify-center bg-black/80 backdrop-blur-sm",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:(0,k.jsxs)(Cd.div,{className:"bg-white dark:bg-gray-800 rounded-3xl shadow-2xl p-12 text-center",initial:{scale:0,rotate:-180},animate:{scale:1,rotate:0},transition:{type:"spring",duration:.8},children:[(0,k.jsx)(Cd.div,{className:"w-24 h-24 mx-auto mb-6 rounded-full bg-gradient-to-br from-green-400 to-green-600 flex items-center justify-center",animate:{scale:[1,1.2,1]},transition:{duration:.5,repeat:2},children:(0,k.jsx)(Fd,{className:"w-12 h-12 text-white"})}),(0,k.jsx)("h2",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:"Empr\xe9stimo Conclu\xeddo!"}),(0,k.jsxs)("p",{className:"text-gray-600 dark:text-gray-400 text-lg",children:[r.length," ",1===r.length?"ferramenta transferida":"ferramentas transferidas"," com sucesso"]})]})})})]})})},tk=t=>{let{inventario:r,adicionarEmprestimo:a,atualizarDisponibilidade:i}=t;const[o,l]=(0,e.useState)([]),[c,d]=(0,e.useState)(""),[u,h]=(0,e.useState)(!1),[m,f]=(0,e.useState)(!1),[g,p]=(0,e.useState)(null);(0,e.useEffect)(()=>{const e=(0,s.P)((0,s.collection)(P.db,"usuarios"),(0,s._M)("nivel","==",jt.FUNCIONARIO)),t=(0,s.aQ)(e,e=>{const t=e.docs.map(e=>(0,n.A)({id:e.id},e.data()));l(t)});return()=>t()},[]);const[x,y]=(0,e.useState)({colaborador:"",ferramentas:[]}),v=r.filter(e=>e.disponivel>0);return(0,k.jsxs)(k.Fragment,{children:[m&&g&&(0,k.jsx)(ek,{ferramentas:g.ferramentas,funcionarioNome:g.funcionarioNome,funcionarioFoto:g.funcionarioFoto,onComplete:()=>{const e=o.find(e=>e.nome===x.colaborador),t=(0,n.A)((0,n.A)({},x),{},{status:"emprestado",dataEmprestimo:(new Date).toISOString(),dataDevolucao:null,funcionarioId:e.id,nomeFuncionario:e.nome,nomeFerramentas:x.ferramentas.map(e=>e.nome),ferramentas:x.ferramentas.map(e=>({nome:e.nome,quantidade:e.quantidade}))});a(t,i)&&(f(!1),p(null),y({colaborador:"",ferramentas:[]}))}}),(0,k.jsxs)("div",{className:"bg-gradient-to-br from-white to-gray-50 dark:from-gray-800 dark:to-gray-800/80 rounded-2xl shadow-xl border border-gray-200 dark:border-gray-700 p-6",children:[(0,k.jsxs)("div",{className:"mb-6",children:[(0,k.jsxs)("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white flex items-center gap-2",children:[(0,k.jsx)(D,{className:"w-7 h-7 text-blue-600 dark:text-blue-400"}),"Novo Empr\xe9stimo"]}),(0,k.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:"Preencha os dados para registrar um novo empr\xe9stimo"})]}),(0,k.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[(0,k.jsxs)("div",{className:"space-y-6",children:[(0,k.jsxs)("div",{className:"space-y-3",children:[(0,k.jsxs)("label",{className:"flex items-center gap-2 text-sm font-semibold text-gray-700 dark:text-gray-300",children:[(0,k.jsx)(mu,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"}),"Funcion\xe1rio Respons\xe1vel"]}),(0,k.jsxs)("div",{className:"relative",children:[(0,k.jsxs)("select",{value:x.colaborador,onChange:e=>{const t=e.target.value;y((0,n.A)((0,n.A)({},x),{},{colaborador:t})),d(t)},className:"h-12 w-full bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 border-2 border-gray-200 dark:border-gray-600 rounded-xl hover:border-blue-300 dark:hover:border-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all appearance-none px-4 pr-10 font-medium shadow-sm",required:!0,children:[(0,k.jsx)("option",{value:"",className:"dark:bg-gray-800",children:"Selecione um funcion\xe1rio..."}),[...o].sort((e,t)=>e.nome.localeCompare(t.nome)).map(e=>(0,k.jsx)("option",{value:e.nome,className:"dark:bg-gray-800",children:e.nome},e.id))]}),(0,k.jsx)("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none",children:(0,k.jsx)("svg",{className:"w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,k.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})})})]})]}),(0,k.jsxs)("div",{className:"space-y-3",children:[(0,k.jsxs)("label",{className:"flex items-center gap-2 text-sm font-semibold text-gray-700 dark:text-gray-300",children:[(0,k.jsx)(Hb,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"}),"Selecionar Ferramenta"]}),(0,k.jsxs)("div",{className:"bg-blue-50 dark:bg-blue-900/20 border-2 border-blue-200 dark:border-blue-700/50 rounded-xl p-4",children:[(0,k.jsx)($w,{ferramentasDisponiveis:v,onAdicionarFerramenta:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(!e)return;const a=r.find(t=>t.nome.toLowerCase()===e.toLowerCase()&&t.disponivel>0);if(!a)return;const s=x.ferramentas.find(e=>e.nome===a.nome);s||(t>a.disponivel&&(t=a.disponivel),y(e=>(0,n.A)((0,n.A)({},e),{},{ferramentas:[...e.ferramentas,{nome:a.nome,quantidade:t,disponivel:a.disponivel}]})))}}),(0,k.jsxs)("div",{className:"mt-3 flex items-center gap-2 text-xs text-blue-600 dark:text-blue-400",children:[(0,k.jsx)(Rt,{className:"w-4 h-4"}),(0,k.jsx)("span",{children:"Selecione ferramentas dispon\xedveis no invent\xe1rio"})]})]}),(0,k.jsx)("div",{className:"flex justify-end",children:(0,k.jsxs)("button",{onClick:()=>h(!0),className:"inline-flex items-center gap-2 px-4 py-2 text-sm font-medium text-blue-600 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300 bg-blue-50 dark:bg-blue-900/30 hover:bg-blue-100 dark:hover:bg-blue-900/50 rounded-lg transition-all",children:[(0,k.jsx)(Rt,{className:"w-4 h-4"}),"Como funciona?"]})})]})]}),u&&(0,k.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 dark:bg-black/70",children:(0,k.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-lg w-full mx-4 max-h-[90vh] overflow-y-auto",children:[(0,k.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700",children:[(0,k.jsx)("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:"Como realizar um empr\xe9stimo"}),(0,k.jsx)("button",{onClick:()=>h(!1),className:"text-gray-400 hover:text-gray-500 dark:hover:text-gray-300 transition-colors",children:(0,k.jsx)(Id,{className:"w-5 h-5"})})]}),(0,k.jsx)("div",{className:"p-4 space-y-4",children:(0,k.jsxs)("div",{className:"space-y-3",children:[(0,k.jsxs)("div",{className:"flex items-start gap-3",children:[(0,k.jsx)("div",{className:"w-6 h-6 rounded-full bg-blue-100 dark:bg-blue-900/50 flex items-center justify-center text-blue-600 dark:text-blue-400 text-sm font-medium",children:"1"}),(0,k.jsx)("p",{className:"text-gray-600 dark:text-gray-300",children:"Selecione o funcion\xe1rio respons\xe1vel pelo empr\xe9stimo no campo de funcion\xe1rio."})]}),(0,k.jsxs)("div",{className:"flex items-start gap-3",children:[(0,k.jsx)("div",{className:"w-6 h-6 rounded-full bg-blue-100 dark:bg-blue-900/50 flex items-center justify-center text-blue-600 dark:text-blue-400 text-sm font-medium",children:"2"}),(0,k.jsx)("p",{className:"text-gray-600 dark:text-gray-300",children:"No campo de ferramentas, escolha a ferramenta desejada na lista de ferramentas dispon\xedveis."})]}),(0,k.jsxs)("div",{className:"flex items-start gap-3",children:[(0,k.jsx)("div",{className:"w-6 h-6 rounded-full bg-blue-100 dark:bg-blue-900/50 flex items-center justify-center text-blue-600 dark:text-blue-400 text-sm font-medium",children:"3"}),(0,k.jsx)("p",{className:"text-gray-600 dark:text-gray-300",children:"Ap\xf3s selecionar uma ferramenta, voc\xea pode ajustar a quantidade necess\xe1ria no campo espec\xedfico."})]}),(0,k.jsxs)("div",{className:"flex items-start gap-3",children:[(0,k.jsx)("div",{className:"w-6 h-6 rounded-full bg-blue-100 dark:bg-blue-900/50 flex items-center justify-center text-blue-600 dark:text-blue-400 text-sm font-medium",children:"4"}),(0,k.jsx)("p",{className:"text-gray-600 dark:text-gray-300",children:"Repita o processo para adicionar mais ferramentas ao mesmo empr\xe9stimo, se necess\xe1rio."})]}),(0,k.jsxs)("div",{className:"flex items-start gap-3",children:[(0,k.jsx)("div",{className:"w-6 h-6 rounded-full bg-blue-100 dark:bg-blue-900/50 flex items-center justify-center text-blue-600 dark:text-blue-400 text-sm font-medium",children:"5"}),(0,k.jsx)("p",{className:"text-gray-600 dark:text-gray-300",children:"Voc\xea pode alterar a quantidade de qualquer ferramenta j\xe1 selecionada ou remov\xea-la usando o \xedcone de lixeira."})]}),(0,k.jsxs)("div",{className:"flex items-start gap-3",children:[(0,k.jsx)("div",{className:"w-6 h-6 rounded-full bg-blue-100 dark:bg-blue-900/50 flex items-center justify-center text-blue-600 dark:text-blue-400 text-sm font-medium",children:"6"}),(0,k.jsx)("p",{className:"text-gray-600 dark:text-gray-300",children:'Quando estiver tudo pronto, clique em "Registrar Empr\xe9stimo" para finalizar.'})]})]})}),(0,k.jsx)("div",{className:"p-4 border-t border-gray-200 dark:border-gray-700 flex justify-end",children:(0,k.jsx)("button",{onClick:()=>h(!1),className:"px-4 py-2 bg-gray-100 hover:bg-gray-200 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-200 rounded-lg transition-colors",children:"Fechar"})})]})}),(0,k.jsxs)("div",{className:"space-y-4",children:[(0,k.jsxs)("div",{className:"space-y-3",children:[(0,k.jsxs)("div",{className:"flex items-center justify-between",children:[(0,k.jsxs)("h3",{className:"flex items-center gap-2 text-sm font-semibold text-gray-700 dark:text-gray-300",children:[(0,k.jsx)(Zw,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"}),"Ferramentas Selecionadas"]}),x.ferramentas.length>0&&(0,k.jsxs)("span",{className:"bg-blue-100 dark:bg-blue-900/50 text-blue-700 dark:text-blue-300 text-xs font-bold px-3 py-1 rounded-full",children:[x.ferramentas.length," ",1===x.ferramentas.length?"item":"itens"]})]}),(0,k.jsx)("div",{className:"border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-xl p-4 min-h-[200px] max-h-[calc(50vh-4rem)] overflow-y-auto bg-white dark:bg-gray-800/50 backdrop-blur-sm",children:0===x.ferramentas.length?(0,k.jsxs)("div",{className:"h-full flex flex-col items-center justify-center py-12",children:[(0,k.jsx)(Zw,{className:"w-16 h-16 text-gray-300 dark:text-gray-600 mb-4"}),(0,k.jsx)("p",{className:"text-gray-400 dark:text-gray-500 text-sm font-medium",children:"Nenhuma ferramenta selecionada"}),(0,k.jsx)("p",{className:"text-gray-300 dark:text-gray-600 text-xs mt-1",children:"Selecione ferramentas acima para iniciar"})]}):(0,k.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:x.ferramentas.map((e,t)=>(0,k.jsx)("div",{className:"flex flex-col p-4 rounded-xl border-2 border-gray-200 dark:border-gray-600 bg-gradient-to-br from-white to-gray-50 dark:from-gray-800 dark:to-gray-800/80 hover:shadow-md hover:border-blue-300 dark:hover:border-blue-600 transition-all duration-200",children:(0,k.jsxs)("div",{className:"flex flex-col h-full",children:[(0,k.jsxs)("div",{className:"flex items-start justify-between gap-2 mb-3",children:[(0,k.jsx)("span",{className:"text-sm font-semibold text-gray-800 dark:text-gray-200 break-words flex-1",title:e.nome,children:e.nome}),(0,k.jsxs)("span",{className:"text-xs bg-green-100 dark:bg-green-900/50 text-green-700 dark:text-green-300 px-2 py-1 rounded-lg font-medium whitespace-nowrap",children:[e.disponivel," disp."]})]}),(0,k.jsxs)("div",{className:"flex items-center gap-2 mt-auto",children:[(0,k.jsxs)("div",{className:"flex-1",children:[(0,k.jsx)("label",{className:"text-xs text-gray-500 dark:text-gray-400 mb-1 block font-medium",children:"Quantidade:"}),(0,k.jsx)("select",{value:e.quantidade,onChange:t=>{return r=e.nome,a=t.target.value,void y(e=>(0,n.A)((0,n.A)({},e),{},{ferramentas:e.ferramentas.map(e=>e.nome===r?(0,n.A)((0,n.A)({},e),{},{quantidade:parseInt(a)}):e)}));var r,a},className:"h-10 w-full bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 text-gray-800 dark:text-gray-200 border-2 border-gray-200 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 px-3 transition-all font-semibold",children:[...Array(e.disponivel)].map((e,t)=>(0,k.jsxs)("option",{value:t+1,children:[t+1," ",t+1===1?"unidade":"unidades"]},t+1))})]}),(0,k.jsx)("button",{onClick:()=>(e=>{y(t=>(0,n.A)((0,n.A)({},t),{},{ferramentas:t.ferramentas.filter(t=>t.nome!==e)}))})(e.nome),className:"h-10 w-10 flex items-center justify-center text-red-600 hover:text-white dark:text-red-400 dark:hover:text-white rounded-lg border-2 border-red-200 dark:border-red-900/50 hover:bg-red-500 dark:hover:bg-red-500 hover:border-red-500 transition-all mt-5",title:"Remover ferramenta",children:(0,k.jsx)(nw,{className:"w-4 h-4"})})]})]})},t))})})]}),(0,k.jsxs)("button",{onClick:()=>{if(!x.colaborador)return void alert("Por favor, selecione um funcion\xe1rio");if(0===x.ferramentas.length)return void alert("Por favor, selecione pelo menos uma ferramenta");const e=o.find(e=>e.nome===x.colaborador);if(e){for(const e of x.ferramentas){const t=r.find(t=>t.nome===e.nome);if(!t||e.quantidade>t.disponivel)return void alert("Quantidade indispon\xedvel para ".concat(e.nome))}p({ferramentas:x.ferramentas,funcionarioNome:x.colaborador,funcionarioFoto:e.photoURL||null}),f(!0)}else alert("Funcion\xe1rio n\xe3o encontrado")},disabled:!x.colaborador||0===x.ferramentas.length,className:"h-14 w-full flex items-center justify-center gap-3 bg-gradient-to-r from-blue-600 to-blue-500 hover:from-blue-700 hover:to-blue-600 disabled:from-gray-300 disabled:to-gray-300 dark:disabled:from-gray-700 dark:disabled:to-gray-700 disabled:cursor-not-allowed text-white font-bold rounded-xl transition-all shadow-lg hover:shadow-xl disabled:shadow-none text-base",children:[(0,k.jsx)(D,{className:"w-5 h-5"}),"Registrar Empr\xe9stimo"]})]})]})]})]})},rk=y("package-2",[["path",{d:"M12 3v6",key:"1holv5"}],["path",{d:"M16.76 3a2 2 0 0 1 1.8 1.1l2.23 4.479a2 2 0 0 1 .21.891V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V9.472a2 2 0 0 1 .211-.894L5.45 4.1A2 2 0 0 1 7.24 3z",key:"187q7i"}],["path",{d:"M3.054 9.013h17.893",key:"grwhos"}]]),ak=y("circle-user",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}],["path",{d:"M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662",key:"154egf"}]]),nk=y("arrow-right-left",[["path",{d:"m16 3 4 4-4 4",key:"1x1c3m"}],["path",{d:"M20 7H4",key:"zbl0bi"}],["path",{d:"m8 21-4-4 4-4",key:"h9nckh"}],["path",{d:"M4 17h16",key:"g4d7ey"}]]),sk=e=>{if(!e)return"-";return new Date(e).toLocaleDateString("pt-BR")},ik=e=>{if(!e)return"-";return new Date(e).toLocaleString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})},ok=t=>{let{emprestimo:r,onConfirm:a,onClose:n}=t;const[s,i]=(0,e.useState)([]),[o,l]=(0,e.useState)(!1),c=e=>{s.includes(e)?i(t=>t.filter(t=>t!==e)):i(t=>[...t,e])};return(0,k.jsx)("div",{className:"fixed inset-0 bg-black/50 dark:bg-black/70 flex items-center justify-center z-50 p-4",children:(0,k.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-2xl max-w-xl w-full p-6",children:[(0,k.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,k.jsx)("h3",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Devolu\xe7\xe3o de Ferramentas"}),(0,k.jsx)("button",{onClick:n,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 transition-colors",children:(0,k.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"w-5 h-5",children:[(0,k.jsx)("path",{d:"M18 6 6 18"}),(0,k.jsx)("path",{d:"m6 6 12 12"})]})})]}),(0,k.jsxs)("div",{className:"space-y-4",children:[(0,k.jsx)("div",{className:"border-2 border-blue-200 dark:border-blue-800 bg-blue-50 dark:bg-blue-900/20 rounded-lg p-4 mb-4",children:(0,k.jsxs)("div",{className:"flex gap-3 items-start",children:[(0,k.jsx)(rw,{className:"w-5 h-5 text-blue-600 dark:text-blue-400 mt-0.5 flex-shrink-0"}),(0,k.jsxs)("div",{className:"space-y-2",children:[(0,k.jsx)("p",{className:"text-sm text-gray-900 dark:text-white font-semibold",children:"Instru\xe7\xf5es para devolu\xe7\xe3o:"}),(0,k.jsxs)("ul",{className:"text-sm text-gray-700 dark:text-gray-300 space-y-1 list-disc pl-4",children:[(0,k.jsx)("li",{children:"Selecione cada ferramenta que est\xe1 sendo devolvida individualmente"}),(0,k.jsx)("li",{children:"Verifique o estado de cada ferramenta antes de confirmar a devolu\xe7\xe3o"}),(0,k.jsx)("li",{children:"Em caso de dano ou perda, informe ao respons\xe1vel do almoxarifado"})]})]})]})}),(0,k.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,k.jsxs)("span",{className:"text-sm font-semibold text-gray-900 dark:text-white",children:[s.length," de ",r.ferramentas.length," selecionada(s)"]}),(0,k.jsx)("button",{type:"button",onClick:()=>{s.length===r.ferramentas.length?i([]):i([...r.ferramentas])},className:"text-sm font-semibold text-blue-600 dark:text-blue-400 hover:text-blue-700 dark:hover:text-blue-300 transition-colors",children:s.length===r.ferramentas.length?"Desmarcar Todas":"Selecionar Todas"})]}),(0,k.jsx)("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:r.ferramentas.map((e,t)=>(0,k.jsxs)("div",{className:"flex items-center p-3 rounded-lg border-2 cursor-pointer transition-all ".concat(s.includes(e)?"border-blue-500 dark:border-blue-400 bg-blue-50 dark:bg-blue-900/30":"border-gray-300 dark:border-gray-600 hover:border-blue-400 dark:hover:border-blue-500 bg-white dark:bg-gray-700/50"),onClick:()=>c(e),children:[(0,k.jsx)("input",{type:"checkbox",checked:s.includes(e),onChange:()=>c(e),className:"h-5 w-5 text-blue-600 dark:text-blue-500 rounded border-gray-300 dark:border-gray-600 focus:ring-blue-500 cursor-pointer"}),(0,k.jsx)("div",{className:"ml-3 flex-1",children:(0,k.jsx)("span",{className:"text-sm font-semibold text-gray-900 dark:text-white",children:"object"===typeof e?e.nome:e})}),s.includes(e)&&(0,k.jsx)(Fd,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"})]},t))}),(0,k.jsxs)("label",{className:"flex items-start gap-3 cursor-pointer mt-4 p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg border border-gray-200 dark:border-gray-600 hover:border-gray-300 dark:hover:border-gray-500 transition-colors",children:[(0,k.jsx)("input",{type:"checkbox",checked:o,onChange:e=>l(e.target.checked),className:"mt-1 h-5 w-5 text-blue-600 dark:text-blue-500 border-gray-300 dark:border-gray-600 rounded focus:ring-blue-500 cursor-pointer"}),(0,k.jsxs)("div",{className:"space-y-1",children:[(0,k.jsx)("span",{className:"text-sm font-semibold text-gray-900 dark:text-white",children:"Devolvido por terceiros"}),(0,k.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Marque esta op\xe7\xe3o se a ferramenta foi devolvida por outra pessoa que n\xe3o o respons\xe1vel pelo empr\xe9stimo."})]})]})]}),(0,k.jsxs)("div",{className:"flex justify-end gap-3 mt-6 pt-4 border-t border-gray-200 dark:border-gray-700",children:[(0,k.jsx)("button",{onClick:n,className:"px-5 py-2.5 text-sm font-semibold text-gray-700 dark:text-gray-300 bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 rounded-lg transition-colors focus:outline-none focus:ring-2 focus:ring-gray-400",children:"Cancelar"}),(0,k.jsxs)("button",{onClick:()=>{a({ferramentas:s,devolvidoPorTerceiros:o,emprestimoId:r.id})},disabled:0===s.length,className:"px-5 py-2.5 text-sm font-semibold text-white bg-green-600 hover:bg-green-700 dark:bg-green-600 dark:hover:bg-green-700 rounded-lg transition-colors focus:outline-none focus:ring-2 focus:ring-green-500 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:bg-green-600",children:["Confirmar Devolu\xe7\xe3o (",s.length,")"]})]})]})})},lk=y("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]),ck=t=>{var r;let{emprestimo:a,ferramentasDevolvidas:n,devolvidoPorTerceiros:s,onComplete:i}=t;const[o,l]=(0,e.useState)("start"),[c,d]=(0,e.useState)(0);return(0,e.useEffect)(()=>{const e=[{phase:"start",duration:500},{phase:"returning",duration:2e3},{phase:"storing",duration:1200},{phase:"complete",duration:800}];let t=0;const r=()=>{if(t<e.length){const a=e[t];l(a.phase),setTimeout(()=>{t++,r()},a.duration)}else setTimeout(()=>{null===i||void 0===i||i()},500)};r()},[i]),(0,e.useEffect)(()=>{if("returning"===o&&n){const e=setInterval(()=>{d(e=>(e+1)%n.length)},400);return()=>clearInterval(e)}},[o,n]),(0,k.jsx)("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:(0,k.jsx)("div",{className:"relative w-full max-w-3xl",children:(0,k.jsxs)(Cd.div,{className:"bg-gradient-to-br from-green-50 to-emerald-50 dark:from-gray-800 dark:to-gray-900 rounded-3xl shadow-2xl p-8 relative overflow-hidden",initial:{scale:.8,opacity:0,y:50},animate:{scale:1,opacity:1,y:0},transition:{type:"spring",duration:.6},children:[(0,k.jsx)(Cd.div,{className:"absolute inset-0 bg-gradient-to-br from-green-500/10 to-emerald-500/10",animate:{opacity:[.5,.8,.5]},transition:{duration:2,repeat:1/0}}),(0,k.jsxs)("div",{className:"relative z-10",children:[(0,k.jsxs)(Cd.div,{className:"text-center mb-8",initial:{y:-20,opacity:0},animate:{y:0,opacity:1},children:[(0,k.jsx)("h2",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:"Devolu\xe7\xe3o de Ferramentas"}),(0,k.jsxs)("p",{className:"text-gray-600 dark:text-gray-400",children:["start"===o&&"Iniciando processo de devolu\xe7\xe3o...","returning"===o&&"Recebendo ferramentas de volta...","storing"===o&&"Registrando no almoxarifado...","complete"===o&&"Devolu\xe7\xe3o conclu\xedda com sucesso!"]})]}),(0,k.jsxs)("div",{className:"flex items-center justify-center gap-12 mb-8",children:[(0,k.jsxs)(Cd.div,{className:"flex flex-col items-center",animate:{scale:"returning"===o?[1,.95,1]:1},transition:{duration:.8,repeat:"returning"===o?1/0:0},children:[(0,k.jsxs)("div",{className:"relative mb-4",children:[(0,k.jsx)("div",{className:"w-32 h-32 rounded-full bg-gradient-to-br from-blue-400 to-blue-600 flex items-center justify-center shadow-xl",children:null!==a&&void 0!==a&&a.funcionarioFoto?(0,k.jsx)("img",{src:a.funcionarioFoto,alt:a.nomeFuncionario,className:"w-full h-full rounded-full object-cover"}):(0,k.jsx)("span",{className:"text-4xl text-white font-bold",children:(null===a||void 0===a||null===(r=a.nomeFuncionario)||void 0===r?void 0:r.charAt(0))||"F"})}),"returning"===o&&(0,k.jsx)(k.Fragment,{children:[0,1,2].map(e=>(0,k.jsx)(Cd.div,{className:"absolute inset-0 border-4 border-green-400 rounded-full",initial:{scale:1,opacity:.6},animate:{scale:1.5,opacity:0},transition:{duration:1.5,delay:.5*e,repeat:1/0}},e))})]}),(0,k.jsx)("h3",{className:"text-lg font-bold text-gray-900 dark:text-white text-center",children:(null===a||void 0===a?void 0:a.nomeFuncionario)||"Funcion\xe1rio"}),(0,k.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Devolvendo"})]}),(0,k.jsxs)("div",{className:"relative flex flex-col items-center gap-4",children:[(0,k.jsxs)(Cd.div,{className:"relative",animate:{y:"returning"===o?[0,100,0]:0},transition:{duration:2,repeat:"returning"===o?1/0:0,ease:"easeInOut"},children:[(0,k.jsx)(Cd.div,{className:"w-24 h-24 bg-gradient-to-br from-green-400 to-green-600 rounded-2xl flex items-center justify-center shadow-2xl",animate:{rotate:"returning"===o?[0,10,-10,0]:0,scale:"storing"===o?[1,1.2,1]:1},transition:{rotate:{duration:1,repeat:"returning"===o?1/0:0},scale:{duration:.6,repeat:"storing"===o?1/0:0}},children:(0,k.jsx)(Pr,{mode:"wait",children:"complete"===o?(0,k.jsx)(Cd.div,{initial:{scale:0,rotate:-180},animate:{scale:1,rotate:0},children:(0,k.jsx)(lk,{className:"w-12 h-12 text-white"})},"check"):(0,k.jsx)(Cd.div,{children:(0,k.jsx)(Md,{className:"w-12 h-12 text-white"})},"package")})}),"returning"===o&&(0,k.jsx)("div",{className:"absolute inset-0",children:Array.from({length:8}).map((e,t)=>(0,k.jsx)(Cd.div,{className:"absolute left-1/2 top-0 w-2 h-2 bg-green-400 rounded-full",animate:{y:[0,120],opacity:[0,1,0],scale:[0,1,0]},transition:{duration:1.5,delay:.2*t,repeat:1/0}},t))})]}),(0,k.jsx)(Cd.div,{animate:{y:"returning"===o?[0,10,0]:0,opacity:"returning"===o?1:.3},transition:{duration:.8,repeat:"returning"===o?1/0:0},children:(0,k.jsx)(Qb,{className:"w-8 h-8 text-green-500"})}),n&&(0,k.jsxs)(Cd.div,{className:"bg-green-500 text-white px-4 py-2 rounded-full font-bold shadow-lg",animate:{scale:"returning"===o?[1,1.1,1]:1},transition:{duration:.8,repeat:"returning"===o?1/0:0},children:[n.length," ",1===n.length?"item":"itens"]})]}),(0,k.jsxs)(Cd.div,{className:"flex flex-col items-center",animate:{scale:"storing"===o?[1,1.05,1]:1},transition:{duration:.6,repeat:"storing"===o?1/0:0},children:[(0,k.jsxs)("div",{className:"relative mb-4",children:[(0,k.jsx)(Cd.div,{className:"w-32 h-32 bg-gradient-to-br from-gray-700 to-gray-900 dark:from-gray-600 dark:to-gray-800 rounded-2xl flex items-center justify-center shadow-xl",animate:{boxShadow:"storing"===o?["0 10px 30px rgba(34, 197, 94, 0.3)","0 10px 50px rgba(34, 197, 94, 0.6)","0 10px 30px rgba(34, 197, 94, 0.3)"]:"0 10px 30px rgba(0, 0, 0, 0.3)"},transition:{duration:1,repeat:"storing"===o?1/0:0},children:(0,k.jsx)(Md,{className:"w-16 h-16 text-white"})}),"storing"===o&&(0,k.jsx)(k.Fragment,{children:[0,1,2].map(e=>(0,k.jsx)(Cd.div,{className:"absolute inset-0 border-4 border-green-400 rounded-2xl",initial:{scale:1.5,opacity:0},animate:{scale:1,opacity:.6},exit:{scale:1,opacity:0},transition:{duration:1.5,delay:.5*e,repeat:1/0}},e))})]}),(0,k.jsx)("h3",{className:"text-lg font-bold text-gray-900 dark:text-white",children:"Almoxarifado"}),(0,k.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Recebendo"})]})]}),(0,k.jsxs)(Cd.div,{className:"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-inner mb-6",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},children:[s&&(0,k.jsx)("div",{className:"mb-4 p-3 bg-yellow-50 dark:bg-yellow-900/20 rounded-lg border border-yellow-200 dark:border-yellow-800",children:(0,k.jsx)("p",{className:"text-sm text-yellow-800 dark:text-yellow-200 font-medium",children:"\u26a0\ufe0f Devolu\xe7\xe3o realizada por terceiros"})}),(0,k.jsx)("h4",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-3",children:"returning"===o?"Devolvendo:":"Ferramentas devolvidas:"}),(0,k.jsx)("div",{className:"grid grid-cols-2 gap-2 max-h-40 overflow-y-auto",children:null===n||void 0===n?void 0:n.map((e,t)=>(0,k.jsxs)(Cd.div,{className:"flex items-center gap-2 p-2 rounded-lg text-sm transition-all ".concat("returning"===o&&t===c?"bg-green-100 dark:bg-green-900/30 border-2 border-green-500":"bg-gray-50 dark:bg-gray-700/50"),initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.5+.1*t},children:[(0,k.jsx)(Cd.div,{className:"w-5 h-5 rounded-full border-2 border-green-500 flex items-center justify-center",animate:{backgroundColor:"complete"===o||"storing"===o&&t<=c?"#22C55E":"transparent"},children:("complete"===o||"storing"===o&&t<=c)&&(0,k.jsx)(lk,{className:"w-3 h-3 text-white"})}),(0,k.jsx)("span",{className:"text-gray-700 dark:text-gray-300 truncate",children:"object"===typeof e?e.nome:e})]},t))})]}),(0,k.jsx)("div",{className:"h-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden",children:(0,k.jsx)(Cd.div,{className:"h-full bg-gradient-to-r from-green-400 to-green-600",initial:{width:"0%"},animate:{width:"start"===o?"25%":"returning"===o?"50%":"storing"===o?"75%":"100%"},transition:{duration:.5}})}),"complete"===o&&(0,k.jsx)("div",{className:"absolute inset-0 pointer-events-none",children:Array.from({length:25}).map((e,t)=>(0,k.jsx)(Cd.div,{className:"absolute",style:{left:"50%",top:"50%"},initial:{scale:0,x:0,y:0,opacity:1},animate:{scale:[0,1,0],x:500*(Math.random()-.5),y:400*(Math.random()-.5),opacity:[1,1,0]},transition:{duration:1.5,delay:.04*t},children:(0,k.jsx)(Xb,{className:"w-4 h-4 text-green-500"})},t))})]})]})})})},dk=t=>{let{onClose:r,onConfirm:a,emprestimo:n,funcionarios:s}=t;const[i,o]=(0,e.useState)(""),[l,c]=(0,e.useState)("");return(0,k.jsx)("div",{className:"fixed inset-0 bg-black/50 dark:bg-black/70 flex items-center justify-center z-50",children:(0,k.jsxs)("div",{className:"bg-gray-100 dark:bg-white dark:bg-gray-800 rounded-lg shadow-lg max-w-md w-full p-6",children:[(0,k.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,k.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Transferir Ferramentas"}),(0,k.jsx)("button",{onClick:r,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:(0,k.jsx)(Id,{className:"w-5 h-5"})})]}),(0,k.jsxs)("div",{className:"mb-6 space-y-4",children:[(0,k.jsxs)("div",{children:[(0,k.jsx)("h4",{className:"text-base font-medium text-gray-900 dark:text-white mb-2",children:"Ferramenta a ser transferida:"}),(0,k.jsx)("div",{className:"space-y-4",children:null===n||void 0===n?void 0:n.ferramentas.map(e=>(0,k.jsx)("div",{className:"flex items-center justify-between gap-3 p-2 bg-white dark:bg-gray-800 dark:bg-gray-700 rounded-lg",children:(0,k.jsxs)("span",{className:"text-sm text-white",children:[e.nome," (",e.quantidade," ",e.quantidade>1?"unidades":"unidade",")"]})},e.id))})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("h4",{className:"text-base font-medium text-gray-900 dark:text-white mb-2",children:"Selecione o funcion\xe1rio que receber\xe1 as ferramentas:"}),(0,k.jsxs)("select",{value:i,onChange:e=>o(e.target.value),className:"w-full bg-white dark:bg-gray-800 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 dark:border-gray-600 text-gray-900 dark:text-white rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-[#1D9BF0] transition-colors hover:bg-[#2C3640]",children:[(0,k.jsx)("option",{value:"",className:"bg-white dark:bg-gray-800",children:"Selecione um funcion\xe1rio"}),null===s||void 0===s?void 0:s.map(e=>(0,k.jsx)("option",{value:e.id,className:"bg-white dark:bg-gray-800",disabled:e.id===(null===n||void 0===n?void 0:n.funcionarioId),children:e.nome},e.id))]})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("h4",{className:"text-base font-medium text-gray-900 dark:text-white mb-2",children:"Observa\xe7\xe3o (opcional):"}),(0,k.jsx)("textarea",{value:l,onChange:e=>c(e.target.value),placeholder:"Adicione uma observa\xe7\xe3o sobre a transfer\xeancia...",className:"w-full px-3 py-2 border border-gray-200 dark:border-gray-600 dark:border-gray-600 rounded-lg text-gray-900 dark:text-white bg-white dark:bg-gray-800 dark:bg-[#22303c] focus:ring-[#1D9BF0] focus:border-[#1D9BF0] h-24 resize-none"})]})]}),(0,k.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,k.jsx)("button",{onClick:r,className:"px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-[#22303c] hover:bg-gray-200 dark:hover:bg-[#2C3C4C] rounded-lg",children:"Cancelar"}),(0,k.jsx)("button",{onClick:()=>{i?(a({ferramentas:n.ferramentas,funcionarioDestino:i,observacao:l}),r()):alert("Selecione um funcion\xe1rio para receber a ferramenta")},className:"px-4 py-2 text-sm font-medium text-gray-900 dark:text-white bg-[#1D9BF0] hover:bg-[#1A8CD8] dark:bg-[#1A8CD8] dark:hover:bg-[#1A8CD8]/80 rounded-lg",children:"Confirmar Transfer\xeancia"})]})]})})},uk=y("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]]),hk=t=>{let{emprestimoOrigem:r,funcionarioDestino:a,ferramentas:n,onComplete:s}=t;const[i,o]=(0,e.useState)("start");(0,e.useEffect)(()=>{const e=[{phase:"start",duration:600},{phase:"moving",duration:2e3},{phase:"transferring",duration:1200},{phase:"complete",duration:800}];let t=0;const r=()=>{if(t<e.length){const a=e[t];o(a.phase),setTimeout(()=>{t++,r()},a.duration)}else setTimeout(()=>{null===s||void 0===s||s()},500)};r()},[s]);const l=Array.from({length:15}).map((e,t)=>({id:t,delay:.08*t}));return(0,k.jsx)("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:(0,k.jsx)("div",{className:"relative w-full max-w-4xl",children:(0,k.jsxs)(Cd.div,{className:"bg-gradient-to-br from-gray-50 to-gray-100 dark:from-gray-800 dark:to-gray-900 rounded-3xl shadow-2xl p-8 relative overflow-hidden",initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{type:"spring",duration:.6},children:[(0,k.jsxs)(Cd.div,{className:"text-center mb-8",initial:{y:-20,opacity:0},animate:{y:0,opacity:1},children:[(0,k.jsx)("h2",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:"Transfer\xeancia de Ferramentas"}),(0,k.jsxs)("p",{className:"text-gray-600 dark:text-gray-400",children:["start"===i&&"Preparando transfer\xeancia...","moving"===i&&"Movendo ferramentas...","transferring"===i&&"Atualizando registros...","complete"===i&&"Transfer\xeancia conclu\xedda!"]})]}),(0,k.jsxs)("div",{className:"flex items-center justify-between gap-8 mb-8",children:[(0,k.jsxs)(Cd.div,{className:"flex-1 relative",animate:{scale:"moving"===i?[1,.95,1]:1},transition:{duration:.5,repeat:"moving"===i?1/0:0},children:[(0,k.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-6 shadow-lg border-2 border-gray-200 dark:border-gray-700",children:[(0,k.jsxs)("div",{className:"flex items-center gap-4 mb-4",children:[(0,k.jsx)("div",{className:"w-16 h-16 rounded-full bg-gradient-to-br from-red-400 to-red-600 flex items-center justify-center",children:null!==r&&void 0!==r&&r.funcionarioFoto?(0,k.jsx)("img",{src:r.funcionarioFoto,alt:"Origem",className:"w-full h-full rounded-full object-cover"}):(0,k.jsx)(uk,{className:"w-8 h-8 text-white"})}),(0,k.jsxs)("div",{className:"flex-1",children:[(0,k.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 uppercase font-semibold",children:"De"}),(0,k.jsx)("h3",{className:"text-lg font-bold text-gray-900 dark:text-white",children:(null===r||void 0===r?void 0:r.nomeFuncionario)||"Funcion\xe1rio"})]})]}),(0,k.jsxs)(Cd.div,{className:"inline-flex items-center gap-2 px-3 py-1.5 bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-400 rounded-full text-xs font-semibold",animate:{scale:"moving"===i?[1,1.1,1]:1},transition:{duration:.5,repeat:"moving"===i?1/0:0},children:[(0,k.jsx)(nk,{className:"w-3 h-3"}),"Enviando"]})]}),"moving"===i&&(0,k.jsx)(k.Fragment,{children:[0,1,2].map(e=>(0,k.jsx)(Cd.div,{className:"absolute inset-0 border-4 border-yellow-400 rounded-2xl pointer-events-none",initial:{scale:1,opacity:.6},animate:{scale:1.5,opacity:0},transition:{duration:1.5,delay:.5*e,repeat:1/0}},e))})]}),(0,k.jsxs)("div",{className:"relative flex flex-col items-center gap-4",children:[(0,k.jsx)("div",{className:"relative w-32 h-32",children:l.map(e=>(0,k.jsx)(Cd.div,{className:"absolute w-3 h-3 bg-yellow-400 rounded-full",style:{left:"50%",top:"50%"},animate:{x:"moving"===i?[0,120,0]:0,y:"moving"===i?[0,40*(Math.random()-.5),0]:0,scale:"moving"===i?[0,1,0]:0,opacity:"moving"===i?[0,1,0]:0},transition:{duration:1.5,delay:e.delay,repeat:"moving"===i?1/0:0,ease:"easeInOut"}},e.id))}),(0,k.jsx)(Cd.div,{className:"relative w-20 h-20 bg-gradient-to-br from-yellow-400 to-yellow-600 rounded-full flex items-center justify-center shadow-xl z-10",animate:{rotate:"moving"===i?360:0,scale:"transferring"===i?[1,1.2,1]:1},transition:{rotate:{duration:2,repeat:"moving"===i?1/0:0,ease:"linear"},scale:{duration:.5,repeat:"transferring"===i?1/0:0}},children:(0,k.jsx)(Pr,{mode:"wait",children:"complete"===i?(0,k.jsx)(Cd.div,{initial:{scale:0,rotate:-180},animate:{scale:1,rotate:0},children:(0,k.jsx)(Fd,{className:"w-10 h-10 text-white"})},"check"):(0,k.jsx)(Cd.div,{children:(0,k.jsx)(nk,{className:"w-10 h-10 text-white"})},"arrow")})}),(0,k.jsxs)(Cd.div,{className:"bg-yellow-500 text-white px-4 py-2 rounded-full font-bold shadow-lg",animate:{scale:"moving"===i?[1,1.1,1]:1},transition:{duration:.8,repeat:"moving"===i?1/0:0},children:[(null===n||void 0===n?void 0:n.length)||0," ",1===(null===n||void 0===n?void 0:n.length)?"ferramenta":"ferramentas"]})]}),(0,k.jsxs)(Cd.div,{className:"flex-1 relative",animate:{scale:"transferring"===i?[1,1.05,1]:1},transition:{duration:.5,repeat:"transferring"===i?1/0:0},children:[(0,k.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-6 shadow-lg border-2 border-gray-200 dark:border-gray-700",children:[(0,k.jsxs)("div",{className:"flex items-center gap-4 mb-4",children:[(0,k.jsx)("div",{className:"w-16 h-16 rounded-full bg-gradient-to-br from-green-400 to-green-600 flex items-center justify-center",children:null!==a&&void 0!==a&&a.photoURL?(0,k.jsx)("img",{src:a.photoURL,alt:"Destino",className:"w-full h-full rounded-full object-cover"}):(0,k.jsx)(uk,{className:"w-8 h-8 text-white"})}),(0,k.jsxs)("div",{className:"flex-1",children:[(0,k.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 uppercase font-semibold",children:"Para"}),(0,k.jsx)("h3",{className:"text-lg font-bold text-gray-900 dark:text-white",children:(null===a||void 0===a?void 0:a.nome)||"Novo Funcion\xe1rio"})]})]}),(0,k.jsxs)(Cd.div,{className:"inline-flex items-center gap-2 px-3 py-1.5 bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400 rounded-full text-xs font-semibold",animate:{scale:"transferring"===i?[1,1.1,1]:1},transition:{duration:.5,repeat:"transferring"===i?1/0:0},children:[(0,k.jsx)(Wd,{className:"w-3 h-3"}),"Recebendo"]})]}),"transferring"===i&&(0,k.jsx)(k.Fragment,{children:[0,1,2].map(e=>(0,k.jsx)(Cd.div,{className:"absolute inset-0 border-4 border-green-400 rounded-2xl pointer-events-none",initial:{scale:1.5,opacity:0},animate:{scale:1,opacity:.6},exit:{scale:1,opacity:0},transition:{duration:1.5,delay:.5*e,repeat:1/0}},e))})]})]}),(0,k.jsxs)(Cd.div,{className:"bg-white dark:bg-gray-800 rounded-xl p-4 shadow-inner",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},children:[(0,k.jsx)("h4",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-3",children:"Ferramentas em transfer\xeancia:"}),(0,k.jsx)("div",{className:"grid grid-cols-2 gap-2 max-h-32 overflow-y-auto",children:null===n||void 0===n?void 0:n.map((e,t)=>(0,k.jsxs)(Cd.div,{className:"flex items-center gap-2 p-2 bg-gray-50 dark:bg-gray-700/50 rounded-lg text-sm",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.5+.1*t},children:[(0,k.jsx)("div",{className:"w-2 h-2 bg-yellow-500 rounded-full"}),(0,k.jsx)("span",{className:"text-gray-700 dark:text-gray-300 truncate",children:"object"===typeof e?e.nome:e})]},t))})]}),(0,k.jsx)("div",{className:"mt-6 h-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden",children:(0,k.jsx)(Cd.div,{className:"h-full bg-gradient-to-r from-yellow-400 to-yellow-600",initial:{width:"0%"},animate:{width:"start"===i?"25%":"moving"===i?"50%":"transferring"===i?"75%":"100%"},transition:{duration:.5}})}),"complete"===i&&(0,k.jsx)("div",{className:"absolute inset-0 pointer-events-none",children:Array.from({length:30}).map((e,t)=>(0,k.jsx)(Cd.div,{className:"absolute w-2 h-2 rounded-full",style:{backgroundColor:["#FCD34D","#10B981","#3B82F6","#EF4444"][t%4],left:"50%",top:"50%"},initial:{scale:0,x:0,y:0},animate:{scale:[0,1,0],x:600*(Math.random()-.5),y:400*(Math.random()-.5),opacity:[1,1,0]},transition:{duration:1.5,delay:.03*t}},t))})]})})})},mk=t=>{let{emprestimo:r,onClose:a,onSave:s}=t;const[i,o]=(0,e.useState)([]),[l,c]=(0,e.useState)(null);(0,e.useEffect)(()=>{if(r){const e=JSON.parse(JSON.stringify(r)),t=e.ferramentas.map(e=>(0,n.A)((0,n.A)({},e),{},{id:e.id,nome:e.nome||"Ferramenta sem nome",quantidade:e.quantidade||1,quantidadeOriginal:e.quantidade||1,codigo:e.codigo,descricao:e.descricao}));o(t),c(e)}},[r]);return(0,k.jsx)("div",{className:"fixed inset-0 bg-black/50 dark:bg-black/70 flex items-center justify-center z-50",children:(0,k.jsxs)("div",{className:"bg-white dark:bg-gray-800 text-gray-900 dark:text-white rounded-lg p-6 w-full max-w-2xl",children:[(0,k.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,k.jsx)("h2",{className:"text-xl font-bold",children:"Editar Empr\xe9stimo"}),(0,k.jsx)("button",{onClick:a,className:"p-2 hover:bg-white dark:bg-gray-700 rounded-full transition-colors",children:(0,k.jsx)(Id,{size:24})})]}),(0,k.jsx)("div",{className:"space-y-4",children:i.map(e=>(0,k.jsxs)("div",{className:"flex items-center space-x-4 bg-white dark:bg-gray-800 dark:bg-gray-700 p-4 rounded-lg",children:[(0,k.jsx)("div",{className:"flex-grow",children:(0,k.jsx)("h3",{className:"font-medium",children:e.nome})}),(0,k.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,k.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,k.jsx)("label",{htmlFor:"quantity-".concat(e.id),className:"text-sm",children:"Quantidade:"}),(0,k.jsx)("input",{id:"quantity-".concat(e.id),type:"number",min:"1",max:e.quantidadeOriginal,value:e.quantidade,onChange:t=>((e,t)=>{var r;const a=(null===(r=i.find(t=>t.id===e))||void 0===r?void 0:r.quantidadeOriginal)||0,s=Math.min(Math.max(1,parseInt(t)||0),a);o(t=>t.map(t=>t.id===e?(0,n.A)((0,n.A)({},t),{},{quantidade:s,nome:t.nome,codigo:t.codigo,descricao:t.descricao}):t))})(e.id,t.target.value),className:"bg-[#38444D] border border-gray-200 dark:border-gray-600 dark:border-gray-600 text-gray-900 dark:text-white rounded px-2 py-1 w-20"}),(0,k.jsxs)("span",{className:"text-sm text-gray-400",children:["(max: ",e.quantidadeOriginal,")"]})]}),(0,k.jsx)("button",{onClick:()=>{return t=e.id,void o(e=>e.filter(e=>e.id!==t));var t},className:"p-2 hover:bg-[#38444D] rounded-full transition-colors text-red-500",title:"Remover ferramenta",children:(0,k.jsx)(nw,{size:20})})]})]},e.id))}),(0,k.jsxs)("div",{className:"flex justify-end mt-6 space-x-4",children:[(0,k.jsx)("button",{onClick:a,className:"px-4 py-2 bg-white dark:bg-gray-800 dark:bg-gray-700 hover:bg-[#38444D] rounded-lg transition-colors",children:"Cancelar"}),(0,k.jsxs)("button",{onClick:()=>{if(!l)return;const e=(0,n.A)((0,n.A)({},l),{},{ferramentas:i.map(e=>({id:e.id,nome:e.nome,quantidade:e.quantidade,codigo:e.codigo,descricao:e.descricao}))});console.log("Salvando empr\xe9stimo atualizado:",e),s(e),a()},className:"px-4 py-2 bg-blue-500 dark:bg-[#1D9BF0] hover:bg-blue-600 dark:hover:bg-[#1a8cd8] rounded-lg transition-colors flex items-center space-x-2",children:[(0,k.jsx)(uw,{size:20}),(0,k.jsx)("span",{children:"Salvar Altera\xe7\xf5es"})]})]})]})})},fk="MOST_LOANS",gk="MOST_ACTIVE",pk="MOST_COMPLETED",xk="ALPHABETICAL",yk={[fk]:"Mais Empr\xe9stimos",[gk]:"Mais Ativos",[pk]:"Mais Conclu\xeddos",[xk]:"Ordem Alfab\xe9tica"},vk=t=>{var r;let{emprestimos:a=[],devolverFerramentas:i=()=>{},removerEmprestimo:o=()=>{},atualizarDisponibilidade:l=()=>!0,funcionarios:c=[],readonly:d=!1}=t;const[u,h]=(0,e.useState)(""),[m,f]=(0,e.useState)("hoje"),[g,p]=(0,e.useState)("emprestado"),[x,y]=(0,e.useState)(xk),[v,b]=(0,e.useState)(!1),[w,N]=(0,e.useState)(!1),[j,S]=(0,e.useState)(null),[_,E]=(0,e.useState)(!1),[C,T]=(0,e.useState)(null),[D,F]=(0,e.useState)(new Set),[L,M]=(0,e.useState)(null),[R,O]=(0,e.useState)({}),[B,z]=(0,e.useState)(!1),[U,V]=(0,e.useState)(null),[q,H]=(0,e.useState)(!1),[G,W]=(0,e.useState)(null),[K,Q]=(0,e.useState)(!1),[Y,X]=(0,e.useState)(null),[J,Z]=(0,e.useState)(!1),[$,ee]=(0,e.useState)(null),[te,re]=(0,e.useState)(!1),[ae,ne]=(0,e.useState)(null),{usuario:se}=Nt(),ie=se&&se.nivel>=jt.SUPERVISOR,oe=(e,t)=>{if(!e)return!1;const r=new Date,a=new Date(e);switch(t){case"hoje":return a.getDate()===r.getDate()&&a.getMonth()===r.getMonth()&&a.getFullYear()===r.getFullYear();case"semana":const e=new Date(r);return e.setDate(r.getDate()-7),a>=e;case"mes":const t=new Date(r);return t.setMonth(r.getMonth()-1),a>=t;default:return!0}},{canViewAllSectors:le}=cu(),ce=le,de=(0,e.useMemo)(()=>ce?a:Dt.filterBySector(a,se),[a,se,ce]).filter(e=>{if(!e||!e.dataEmprestimo)return!1;if(!oe(e.dataEmprestimo,m))return!1;if("todos"!==g&&e.status!==g)return!1;if(u){const t=u.toLowerCase(),r=(e.nomeFuncionario||e.colaborador||"").toLowerCase(),a=e.nomeFerramentas||[];return r.includes(t)||a.some(e=>e.toLowerCase().includes(t))}return!0}).sort((e,t)=>{const r=null!==e&&void 0!==e&&e.dataEmprestimo?new Date(e.dataEmprestimo):new Date;return(null!==t&&void 0!==t&&t.dataEmprestimo?new Date(t.dataEmprestimo):new Date)-r}),ue=de.reduce((e,t)=>{const r=t.nomeFuncionario||t.colaborador||"Sem nome";return e[r]||(e[r]={emprestimos:[],totalEmprestimos:0,emprestimosAtivos:0,emprestimosDevolvidos:0}),e[r].emprestimos.push(t),e[r].totalEmprestimos+=t.ferramentas.length,e[r].emprestimosAtivos+="emprestado"===t.status?1:0,e[r].emprestimosDevolvidos+="devolvido"===t.status?1:0,e},{}),he=Object.entries(ue).sort((e,t)=>{let[r,a]=e,[n,s]=t;switch(x){case fk:return s.totalEmprestimos-a.totalEmprestimos;case gk:return s.emprestimosAtivos-a.emprestimosAtivos;case pk:return s.emprestimosDevolvidos-a.emprestimosDevolvidos;case xk:return r.localeCompare(n);default:return 0}}).reduce((e,t)=>{let[r,a]=t;return e[r]=a.emprestimos,e},{}),me=e=>{if(!e||!Array.isArray(a))return void console.error("ID inv\xe1lido ou empr\xe9stimos n\xe3o \xe9 um array:",{id:e,emprestimos:a});const t=a.find(t=>t.id===e);if(!t)return void console.error("Empr\xe9stimo n\xe3o encontrado com o ID:",e);if(!Array.isArray(t.ferramentas))return void console.error("Empr\xe9stimo sem array de ferramentas v\xe1lido:",t);const r=JSON.parse(JSON.stringify(t));0!==r.ferramentas.length?(console.log("Abrindo modal de devolu\xe7\xe3o para empr\xe9stimo:",r),S(r),N(!0)):console.error("Empr\xe9stimo sem ferramentas para devolver:",r)},fe=e=>{T(e),E(!0)},ge=e=>{console.log("\ud83d\udcc4 Gerando comprovante para empr\xe9stimo:",e),ne(e),re(!0)},pe=e=>{console.log("Abrindo modal de transfer\xeancia:",{emprestimo:e});const t=JSON.parse(JSON.stringify(e));V(t),(async()=>{try{const e=(0,s.collection)(P.db,"funcionarios"),t=(await(0,s.GG)(e)).docs.map(e=>(0,n.A)({id:e.id},e.data()));setFuncionarios(t)}catch(e){console.error("Erro ao carregar funcion\xe1rios:",e)}})(),z(!0)},xe=e=>e.ferramentas&&e.ferramentas.length>0,ye=async(e,t)=>{if(null===t||void 0===t||t.stopPropagation(),e&&ie)try{const t=R[e.id];if(t===e.observacao)return void M(null);const r=(0,s.doc)(P.db,"emprestimos",e.id);await(0,s.updateDoc)(r,{observacao:t,ultimaAtualizacao:(new Date).toISOString(),usuarioUltimaAtualizacao:se.email}),M(null)}catch(r){console.error("Erro ao atualizar observa\xe7\xe3o:",r)}},ve=(e,t)=>{t.stopPropagation(),M(null),O(t=>{const r=(0,n.A)({},t);return delete r[e],r})};return(0,k.jsxs)("div",{className:"space-y-4",children:[!ce&&(null===se||void 0===se?void 0:se.setor)&&(0,k.jsxs)("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-3 flex items-center gap-2",children:[(0,k.jsx)(I,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"}),(0,k.jsxs)("p",{className:"text-sm text-blue-800 dark:text-blue-300",children:[(0,k.jsx)("strong",{children:"Visualiza\xe7\xe3o por setor:"})," Voc\xea est\xe1 vendo apenas os empr\xe9stimos do setor ",(0,k.jsx)("strong",{children:se.setor}),"."]})]}),(0,k.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700 p-6",children:[(0,k.jsx)("div",{className:"flex justify-between items-center mb-4",children:(0,k.jsxs)("div",{className:"flex gap-4 items-center flex-wrap",children:[(0,k.jsxs)("div",{className:"relative w-64",children:[(0,k.jsx)(Ft,{className:"w-4 h-4 absolute left-2.5 top-1/2 -translate-y-1/2 text-gray-400"}),(0,k.jsx)("input",{type:"text",placeholder:"     Buscar...",value:u,onChange:e=>h(e.target.value),className:"h-[36px] w-full px-4 pl-8 text-sm font-medium text-gray-700 dark:text-gray-200 bg-white dark:bg-gray-800 dark:bg-gray-800 border border-gray-200 dark:border-gray-600 dark:border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-[#1D9BF0]"})]}),(0,k.jsxs)("select",{value:g,onChange:e=>p(e.target.value),className:"h-[36px] w-48 inline-flex items-center px-4 text-sm font-medium text-gray-700 dark:text-gray-200 bg-white dark:bg-gray-800 dark:bg-gray-800 border border-gray-200 dark:border-gray-600 dark:border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-[#1D9BF0]",children:[(0,k.jsx)("option",{value:"todos",children:"Todos"}),(0,k.jsx)("option",{value:"emprestado",children:"N\xe3o devolvidos"}),(0,k.jsx)("option",{value:"devolvido",children:"Devolvidos"})]}),(0,k.jsxs)("select",{value:m,onChange:e=>f(e.target.value),className:"h-[36px] w-44 inline-flex items-center px-4 text-sm font-medium text-gray-700 dark:text-gray-200 bg-white dark:bg-gray-800 dark:bg-gray-800 border border-gray-200 dark:border-gray-600 dark:border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-[#1D9BF0]",children:[(0,k.jsx)("option",{value:"hoje",children:"Hoje"}),(0,k.jsx)("option",{value:"semana",children:"\xdaltima semana"}),(0,k.jsx)("option",{value:"mes",children:"\xdaltimo m\xeas"}),(0,k.jsx)("option",{value:"todos",children:"Todo per\xedodo"})]}),(0,k.jsxs)("div",{className:"relative",children:[(0,k.jsxs)("button",{onClick:()=>b(!v),className:"h-[36px] inline-flex items-center px-4 text-sm font-medium text-gray-700 dark:text-gray-200 bg-white dark:bg-gray-800 dark:bg-gray-800 border border-gray-200 dark:border-gray-600 dark:border-gray-300 dark:border-gray-600 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-[#1D9BF0]",children:[(0,k.jsxs)("span",{children:["Ordenar por: ",yk[x]]}),(0,k.jsx)("svg",{className:"w-4 h-4 ml-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,k.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})})]}),v&&(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)("div",{className:"fixed inset-0 z-10",onClick:()=>b(!1)}),(0,k.jsx)("div",{className:"absolute right-0 mt-2 w-56 rounded-md shadow-lg bg-white dark:bg-gray-800 dark:bg-gray-800 ring-1 ring-black ring-opacity-5 z-20",children:(0,k.jsx)("div",{className:"py-1",children:Object.entries(yk).map(e=>{let[t,r]=e;return(0,k.jsx)("button",{onClick:()=>{y(t),b(!1)},className:"block w-full text-left px-4 py-2 text-sm ".concat(x===t?"bg-gray-100 dark:bg-gray-700 text-gray-900 dark:text-white":"text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-700"),children:r},t)})})})]})]})]})}),(0,k.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4 mb-6",children:[(0,k.jsx)("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 dark:from-blue-900/20 dark:to-blue-800/20 rounded-xl p-6 shadow-sm border border-blue-200 dark:border-blue-700/50",children:(0,k.jsxs)("div",{className:"flex items-center justify-between",children:[(0,k.jsxs)("div",{children:[(0,k.jsx)("p",{className:"text-sm font-medium text-blue-600 dark:text-blue-400 mb-1",children:"Total de Empr\xe9stimos"}),(0,k.jsx)("p",{className:"text-3xl font-bold text-blue-900 dark:text-blue-100",children:de.length})]}),(0,k.jsx)(rk,{className:"w-12 h-12 text-blue-400 dark:text-blue-600 opacity-50"})]})}),(0,k.jsx)("div",{className:"bg-gradient-to-br from-yellow-50 to-yellow-100 dark:from-yellow-900/20 dark:to-yellow-800/20 rounded-xl p-6 shadow-sm border border-yellow-200 dark:border-yellow-700/50",children:(0,k.jsxs)("div",{className:"flex items-center justify-between",children:[(0,k.jsxs)("div",{children:[(0,k.jsx)("p",{className:"text-sm font-medium text-yellow-600 dark:text-yellow-400 mb-1",children:"Empr\xe9stimos Ativos"}),(0,k.jsx)("p",{className:"text-3xl font-bold text-yellow-900 dark:text-yellow-100",children:de.filter(e=>"emprestado"===e.status).length})]}),(0,k.jsx)(xu,{className:"w-12 h-12 text-yellow-400 dark:text-yellow-600 opacity-50"})]})}),(0,k.jsx)("div",{className:"bg-gradient-to-br from-green-50 to-green-100 dark:from-green-900/20 dark:to-green-800/20 rounded-xl p-6 shadow-sm border border-green-200 dark:border-green-700/50",children:(0,k.jsxs)("div",{className:"flex items-center justify-between",children:[(0,k.jsxs)("div",{children:[(0,k.jsx)("p",{className:"text-sm font-medium text-green-600 dark:text-green-400 mb-1",children:"Devolvidos"}),(0,k.jsx)("p",{className:"text-3xl font-bold text-green-900 dark:text-green-100",children:de.filter(e=>"devolvido"===e.status).length})]}),(0,k.jsx)(Fd,{className:"w-12 h-12 text-green-400 dark:text-green-600 opacity-50"})]})})]}),(0,k.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:Object.entries(he).map(e=>{var t,r;let[a,s]=e;const i=s.some(e=>"emprestado"===e.status),o=s.reduce((e,t)=>{var r;return e+((null===(r=t.ferramentas)||void 0===r?void 0:r.length)||0)},0);return(0,k.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-md hover:shadow-xl transition-all duration-300 border-2 overflow-hidden ".concat(D.has(a)?"ring-4 ring-blue-400/30 dark:ring-blue-500/40 border-blue-400 dark:border-blue-500":i?"border-yellow-200 dark:border-yellow-700/50":"border-gray-200 dark:border-gray-700"),children:[(0,k.jsxs)("div",{className:"cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors p-5",onClick:()=>(e=>{const t=new Set(D);t.has(e)?t.delete(e):t.add(e),F(t)})(a),children:[(0,k.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,k.jsxs)("div",{className:"flex items-center gap-3 flex-1",children:[(0,k.jsxs)("div",{className:"relative",children:[null!==(t=c.find(e=>e.nome===a))&&void 0!==t&&t.photoURL?(0,k.jsx)("img",{src:null===(r=c.find(e=>e.nome===a))||void 0===r?void 0:r.photoURL,alt:a,className:"w-14 h-14 rounded-full object-cover border-3 border-white dark:border-gray-700 shadow-md"}):(0,k.jsx)("div",{className:"w-14 h-14 rounded-full bg-gradient-to-br from-blue-100 to-blue-200 dark:from-blue-900 dark:to-blue-800 flex items-center justify-center border-3 border-white dark:border-gray-700 shadow-md",children:(0,k.jsx)(ak,{className:"w-8 h-8 text-blue-600 dark:text-blue-400"})}),i&&(0,k.jsx)("div",{className:"absolute -top-1 -right-1 w-5 h-5 bg-yellow-400 rounded-full border-2 border-white dark:border-gray-800 animate-pulse"})]}),(0,k.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,k.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white truncate",children:a}),(0,k.jsxs)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[o," ferramenta",1!==o?"s":""]})]})]}),(0,k.jsx)("button",{className:"flex-shrink-0 p-2 rounded-lg transition-all duration-200 ".concat(D.has(a)?"bg-blue-100 dark:bg-blue-900/50 text-blue-600 dark:text-blue-400":"text-gray-400 dark:text-gray-500 hover:bg-gray-100 dark:hover:bg-gray-700"),children:(0,k.jsx)("svg",{className:"w-5 h-5 transition-transform duration-200 ".concat(D.has(a)?"rotate-180":""),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,k.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})})})]}),(0,k.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,k.jsxs)("div",{className:"flex items-center gap-1.5 bg-blue-50 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 px-3 py-1.5 rounded-lg text-sm font-medium",children:[(0,k.jsx)(rk,{className:"w-4 h-4"}),s.length," total"]}),s.filter(e=>"emprestado"===e.status).length>0&&(0,k.jsxs)("div",{className:"flex items-center gap-1.5 bg-yellow-50 dark:bg-yellow-900/30 text-yellow-700 dark:text-yellow-300 px-3 py-1.5 rounded-lg text-sm font-medium animate-pulse",children:[(0,k.jsx)(xu,{className:"w-4 h-4"}),s.filter(e=>"emprestado"===e.status).length," ativo",1!==s.filter(e=>"emprestado"===e.status).length?"s":""]}),s.filter(e=>"devolvido"===e.status).length>0&&(0,k.jsxs)("div",{className:"flex items-center gap-1.5 bg-green-50 dark:bg-green-900/30 text-green-700 dark:text-green-300 px-3 py-1.5 rounded-lg text-sm font-medium",children:[(0,k.jsx)(Fd,{className:"w-4 h-4"}),s.filter(e=>"devolvido"===e.status).length," devolvido",1!==s.filter(e=>"devolvido"===e.status).length?"s":""]})]})]}),D.has(a)&&(0,k.jsx)("div",{className:"border-t-2 border-gray-100 dark:border-gray-700 bg-gradient-to-b from-gray-50 to-white dark:from-gray-700/50 dark:to-gray-800/50",children:(0,k.jsx)("div",{className:"max-h-[36rem] overflow-y-auto scrollbar-thin scrollbar-thumb-gray-300 dark:scrollbar-thumb-gray-600 scrollbar-track-gray-100 dark:scrollbar-track-gray-800",children:(0,k.jsx)("div",{className:"p-4 space-y-3",children:s.map(e=>(0,k.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm hover:shadow-lg transition-all duration-200 border-l-4 overflow-hidden ".concat("emprestado"===e.status?"border-l-yellow-400 dark:border-l-yellow-500":"border-l-green-400 dark:border-l-green-500"),children:(0,k.jsxs)("div",{className:"p-4",children:[(0,k.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,k.jsxs)("div",{className:"flex-1",children:[(0,k.jsx)("div",{className:"flex items-center gap-2 mb-2",children:(0,k.jsx)("div",{className:"inline-flex items-center gap-1.5 px-3 py-1.5 rounded-full text-xs font-semibold ".concat("emprestado"===e.status?"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/50 dark:text-yellow-200":"bg-green-100 text-green-800 dark:bg-green-900/50 dark:text-green-200"),children:"emprestado"===e.status?(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(xu,{className:"w-3.5 h-3.5"}),"Em Andamento"]}):(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(Fd,{className:"w-3.5 h-3.5"}),"Conclu\xeddo"]})})}),(0,k.jsxs)("div",{className:"flex items-center gap-2 text-xs text-gray-500 dark:text-gray-400",children:[(0,k.jsx)(xu,{className:"w-3.5 h-3.5"}),(0,k.jsx)("span",{className:"font-medium",children:"Empr\xe9stimo:"}),(0,k.jsx)("span",{children:ik(e.dataEmprestimo)})]})]}),"emprestado"===e.status&&xe(e)&&(0,k.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,k.jsxs)("div",{className:"grid grid-cols-3 gap-1 bg-gray-100 dark:bg-gray-700/50 rounded-lg p-1 border border-gray-200 dark:border-gray-600",children:[(0,k.jsx)("button",{onClick:t=>{t.stopPropagation(),(e=>{console.log("Iniciando edi\xe7\xe3o do empr\xe9stimo:",e);const t=JSON.parse(JSON.stringify(e));W(t),H(!0)})(e)},className:"p-2 text-blue-600 hover:text-blue-700 dark:text-blue-400 dark:hover:text-blue-300 hover:bg-blue-50 dark:hover:bg-blue-900/30 rounded-md transition-all duration-200",title:"Editar empr\xe9stimo",children:(0,k.jsx)(gw,{className:"w-4 h-4"})}),(0,k.jsx)("button",{onClick:t=>{t.stopPropagation(),pe(e)},className:"p-2 text-yellow-600 hover:text-yellow-700 dark:text-yellow-400 dark:hover:text-yellow-300 hover:bg-yellow-50 dark:hover:bg-yellow-900/30 rounded-md transition-all duration-200",title:"Transferir ferramentas",children:(0,k.jsx)(nk,{className:"w-4 h-4"})}),(0,k.jsx)("button",{onClick:t=>{t.stopPropagation(),ge(e)},className:"p-2 text-purple-600 hover:text-purple-700 dark:text-purple-400 dark:hover:text-purple-300 hover:bg-purple-50 dark:hover:bg-purple-900/30 rounded-md transition-all duration-200",title:"Gerar comprovante PDF",children:(0,k.jsx)(A,{className:"w-4 h-4"})})]}),(0,k.jsxs)("div",{className:"grid grid-cols-2 gap-1 bg-gray-100 dark:bg-gray-700/50 rounded-lg p-1 border border-gray-200 dark:border-gray-600",children:[(0,k.jsx)("button",{onClick:t=>{t.stopPropagation(),me(e.id)},className:"p-2 text-green-600 hover:text-green-700 dark:text-green-400 dark:hover:text-green-300 hover:bg-green-50 dark:hover:bg-green-900/30 rounded-md transition-all duration-200",title:"Devolver ferramentas",children:(0,k.jsx)(Fd,{className:"w-4 h-4"})}),ie&&(0,k.jsx)("button",{onClick:t=>{t.stopPropagation(),fe(e)},className:"p-2 text-red-600 hover:text-red-700 dark:text-red-400 dark:hover:text-red-300 hover:bg-red-50 dark:hover:bg-red-900/30 rounded-md transition-all duration-200",title:"Remover registro",children:(0,k.jsx)(nw,{className:"w-4 h-4"})})]})]}),"emprestado"!==e.status&&(0,k.jsxs)("div",{className:"flex items-center gap-1 bg-gray-100 dark:bg-gray-700/50 rounded-lg p-1 border border-gray-200 dark:border-gray-600",children:[(0,k.jsx)("button",{onClick:t=>{t.stopPropagation(),ge(e)},className:"p-2 text-purple-600 hover:text-purple-700 dark:text-purple-400 dark:hover:text-purple-300 hover:bg-purple-50 dark:hover:bg-purple-900/30 rounded-md transition-all duration-200",title:"Gerar comprovante PDF",children:(0,k.jsx)(A,{className:"w-4 h-4"})}),ie&&(0,k.jsx)("button",{onClick:t=>{t.stopPropagation(),fe(e)},className:"p-2 text-red-600 hover:text-red-700 dark:text-red-400 dark:hover:text-red-300 hover:bg-red-50 dark:hover:bg-red-900/30 rounded-md transition-all duration-200",title:"Remover registro",children:(0,k.jsx)(nw,{className:"w-4 h-4"})})]})]}),(0,k.jsxs)("div",{className:"mb-4",children:[(0,k.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,k.jsx)(rk,{className:"w-4 h-4 text-gray-500 dark:text-gray-400"}),(0,k.jsxs)("h4",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300",children:["Ferramentas (",Array.isArray(null===e||void 0===e?void 0:e.ferramentas)?e.ferramentas.length:0,")"]})]}),(0,k.jsx)("div",{className:"space-y-2",children:Array.isArray(null===e||void 0===e?void 0:e.ferramentas)&&e.ferramentas.length>0?e.ferramentas.map((t,r)=>{const a="devolvido"===e.status;return(0,k.jsxs)("div",{className:"flex items-center justify-between p-2.5 rounded-lg transition-colors ".concat(a?"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-700/30":"bg-gray-50 dark:bg-gray-700/50 border border-gray-200 dark:border-gray-600"),children:[(0,k.jsxs)("div",{className:"flex items-center gap-2 flex-1",children:[(0,k.jsx)("div",{className:"w-2 h-2 rounded-full ".concat(a?"bg-green-500":"bg-yellow-500 animate-pulse")}),(0,k.jsx)("span",{className:"text-sm font-medium ".concat(a?"text-green-700 dark:text-green-300 line-through":"text-gray-800 dark:text-gray-200"),children:t.nome})]}),t.quantidade>1&&(0,k.jsxs)("span",{className:"text-xs font-semibold px-2 py-1 rounded-full ".concat(a?"bg-green-200 dark:bg-green-800 text-green-800 dark:text-green-200":"bg-blue-100 dark:bg-blue-900/50 text-blue-700 dark:text-blue-300"),children:[t.quantidade,"x"]})]},r)}):(0,k.jsx)("div",{className:"text-sm text-gray-500 dark:text-gray-400 italic p-2 text-center bg-gray-50 dark:bg-gray-700/30 rounded-lg",children:"Nenhuma ferramenta registrada"})})]}),(0,k.jsx)("div",{className:"mb-4",children:e.dataDevolucao?(0,k.jsxs)("div",{className:"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-700/30 rounded-lg p-3",children:[(0,k.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,k.jsx)(Fd,{className:"w-4 h-4 text-green-600 dark:text-green-400"}),(0,k.jsx)("span",{className:"text-sm font-semibold text-green-700 dark:text-green-300",children:"Devolu\xe7\xe3o Confirmada"})]}),(0,k.jsxs)("div",{className:"flex items-center gap-2 text-xs text-green-600 dark:text-green-400 ml-6",children:[(0,k.jsx)(xu,{className:"w-3.5 h-3.5"}),ik(e.dataDevolucao)]}),e.devolvidoPorTerceiros&&(0,k.jsxs)("div",{className:"mt-2 flex items-center gap-1.5 text-xs bg-orange-100 dark:bg-orange-900/30 text-orange-700 dark:text-orange-300 px-2 py-1 rounded ml-6 w-fit",children:[(0,k.jsx)(I,{className:"w-3 h-3"}),"Devolvido por terceiros"]})]}):(0,k.jsx)("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-700/30 rounded-lg p-3",children:(0,k.jsxs)("div",{className:"flex items-center gap-2",children:[(0,k.jsx)(xu,{className:"w-4 h-4 text-yellow-600 dark:text-yellow-400 animate-pulse"}),(0,k.jsx)("span",{className:"text-sm font-semibold text-yellow-700 dark:text-yellow-300",children:"Aguardando Devolu\xe7\xe3o"})]})})}),(0,k.jsxs)("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-3 mt-3",children:[(0,k.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,k.jsx)(aw,{className:"w-4 h-4 text-gray-500 dark:text-gray-400"}),(0,k.jsx)("span",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300",children:"Observa\xe7\xf5es"})]}),L===e.id?(0,k.jsxs)("div",{className:"bg-blue-50 dark:bg-blue-900/20 rounded-lg p-3 border border-blue-200 dark:border-blue-700/30",children:[(0,k.jsx)("textarea",{value:R[e.id]||"",onChange:t=>{return r=e.id,a=t.target.value,void O(e=>(0,n.A)((0,n.A)({},e),{},{[r]:a}));var r,a},onKeyDown:t=>((e,t)=>{"Enter"!==t.key||t.shiftKey?"Escape"===t.key&&ve(e.id,t):(t.preventDefault(),ye(e,t))})(e,t),onClick:e=>e.stopPropagation(),className:"w-full p-3 text-sm border-0 bg-white dark:bg-gray-800 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 dark:text-white resize-y min-h-[80px] shadow-inner",placeholder:"Digite suas observa\xe7\xf5es aqui...",autoFocus:!0}),(0,k.jsxs)("div",{className:"flex justify-end gap-2 mt-2",children:[(0,k.jsx)("button",{onClick:t=>ve(e.id,t),className:"px-3 py-1.5 text-sm text-gray-600 hover:text-gray-800 dark:text-gray-400 dark:hover:text-gray-200 bg-white dark:bg-gray-700 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-600 transition-colors",children:"Cancelar"}),(0,k.jsx)("button",{onClick:t=>ye(e,t),className:"px-3 py-1.5 text-sm bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors shadow-sm",children:"Salvar"})]})]}):(0,k.jsxs)("div",{className:"relative group bg-gray-50 dark:bg-gray-700/30 rounded-lg p-3 border border-gray-200 dark:border-gray-600 ".concat(ie?"cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-700/50 hover:border-blue-300 dark:hover:border-blue-600 transition-all":""),onClick:t=>{ie&&((e,t)=>{t.stopPropagation(),M(e.id),O(t=>(0,n.A)((0,n.A)({},t),{},{[e.id]:e.observacao||""}))})(e,t)},children:[(0,k.jsx)("p",{className:"text-sm text-gray-700 dark:text-gray-300 whitespace-pre-wrap break-words min-h-[40px]",children:e.observacao||(0,k.jsxs)("span",{className:"text-gray-400 dark:text-gray-500 italic flex items-center gap-2",children:[(0,k.jsx)(aw,{className:"w-3.5 h-3.5"}),ie?"Clique para adicionar observa\xe7\xf5es":"Sem observa\xe7\xf5es"]})}),e.ultimaAtualizacao&&(0,k.jsxs)("div",{className:"mt-2 pt-2 border-t border-gray-200 dark:border-gray-600 text-xs text-gray-500 dark:text-gray-400 flex items-center gap-1",children:[(0,k.jsx)(xu,{className:"w-3 h-3"}),ik(e.ultimaAtualizacao),e.usuarioUltimaAtualizacao&&(0,k.jsxs)("span",{className:"ml-1",children:["\u2022 ",e.usuarioUltimaAtualizacao]})]}),ie&&(0,k.jsx)("div",{className:"absolute right-2 top-2 opacity-0 group-hover:opacity-100 transition-opacity bg-blue-100 dark:bg-blue-900/50 p-1.5 rounded-lg",children:(0,k.jsx)(aw,{className:"w-3.5 h-3.5 text-blue-600 dark:text-blue-400"})})]})]})]})},e.id))})})})]},a)})}),w&&j&&(0,k.jsx)(ok,{emprestimo:j,onClose:()=>{N(!1),S(null)},onConfirm:async e=>{let{ferramentas:t,devolvidoPorTerceiros:r,emprestimoId:n}=e;try{if(!n||!t||0===t.length)return void console.error("Dados inv\xe1lidos para devolu\xe7\xe3o");N(!1);const e=a.find(e=>e.id===n);return e?(X({emprestimo:e,ferramentasDevolvidas:t,devolvidoPorTerceiros:r}),void Q(!0)):void console.error("Empr\xe9stimo n\xe3o encontrado")}catch(s){console.error("Erro ao preparar devolu\xe7\xe3o:",s),alert("Erro ao preparar a devolu\xe7\xe3o. Por favor, tente novamente.")}}}),_&&(0,k.jsx)("div",{className:"fixed inset-0 bg-black/50 dark:bg-black/70 flex items-center justify-center z-50",children:(0,k.jsxs)("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700 max-w-md w-full",children:[(0,k.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Confirmar exclus\xe3o"}),(0,k.jsx)("p",{className:"mb-6",children:"Tem certeza que deseja remover este registro de empr\xe9stimo?"}),(0,k.jsxs)("div",{className:"flex justify-end gap-4",children:[(0,k.jsx)("button",{onClick:()=>{E(!1),T(null)},className:"h-[36px] px-4 text-gray-700 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-600 dark:border-gray-300 dark:border-gray-600 hover:bg-gray-100 rounded-lg transition-colors duration-200",children:"Cancelar"}),(0,k.jsx)("button",{onClick:()=>{C&&o(C.id,l),E(!1),T(null)},className:"h-[36px] px-4 bg-red-600 text-gray-900 dark:text-white border border-gray-200 dark:border-gray-600 dark:border-gray-300 dark:border-gray-600 rounded-lg hover:bg-red-700 transition-colors duration-200",children:"Excluir"})]})]})}),B&&U&&(0,k.jsx)(dk,{emprestimo:U,funcionarios:c,onClose:()=>{z(!1),V(null)},onConfirm:async e=>{let{ferramentas:t,funcionarioDestino:r,observacao:a}=e;try{return U&&r&&t.length?(console.log("Iniciando transfer\xeancia de ferramentas:",{ferramentas:t,funcionarioDestino:r,observacao:a}),z(!1),ee({emprestimoOrigem:U,funcionarioDestino:r,ferramentas:t,observacao:a}),void Z(!0)):void console.error("Dados inv\xe1lidos para transfer\xeancia")}catch(n){console.error("Erro ao preparar transfer\xeancia:",n),alert("Erro ao preparar a transfer\xeancia. Por favor, tente novamente.")}}}),q&&G&&(0,k.jsx)(mk,{emprestimo:G,onClose:()=>{H(!1),W(null)},onSave:async e=>{try{if(!e||!e.id)throw new Error("Empr\xe9stimo inv\xe1lido");if(!e.ferramentas.every(e=>e.id&&e.nome&&"number"===typeof e.quantidade))throw new Error("Dados de ferramentas inv\xe1lidos");console.log("Salvando edi\xe7\xf5es do empr\xe9stimo:",e);const t=(new Date).toISOString(),r=(0,n.A)((0,n.A)({},e),{},{dataAtualizacao:t,usuarioAtualizacao:(null===se||void 0===se?void 0:se.email)||"sistema",ferramentas:e.ferramentas.map(e=>({id:e.id,nome:e.nome,quantidade:e.quantidade,codigo:e.codigo,descricao:e.descricao})),historicoEdicoes:[...e.historicoEdicoes||[],{dataEdicao:t,usuarioEdicao:(null===se||void 0===se?void 0:se.email)||"sistema",tipoEdicao:"EDICAO_FERRAMENTAS"}]}),a=(0,s.doc)(P.db,"emprestimos",e.id);await(0,s.updateDoc)(a,r),console.log("Empr\xe9stimo atualizado com sucesso"),await l(),H(!1),W(null)}catch(t){console.error("Erro ao salvar edi\xe7\xf5es do empr\xe9stimo:",t),alert("Erro ao salvar as altera\xe7\xf5es. Por favor, tente novamente.")}}}),K&&Y&&(0,k.jsx)(ck,{emprestimo:Y.emprestimo,ferramentasDevolvidas:Y.ferramentasDevolvidas,devolvidoPorTerceiros:Y.devolvidoPorTerceiros,onComplete:async()=>{try{if(!Y)return;const{emprestimo:e,ferramentasDevolvidas:t,devolvidoPorTerceiros:r}=Y,n=e.id,o=a.find(e=>e.id===n);if(!o)return void console.error("Empr\xe9stimo n\xe3o encontrado");const c=(0,s.doc)(P.db,"emprestimos",n),d=(new Date).toISOString();if(t.length===o.ferramentas.length)console.log("Devolu\xe7\xe3o total do empr\xe9stimo"),"function"===typeof i&&await i(n,l,r);else{console.log("Devolu\xe7\xe3o parcial - ferramentas:",t);const e=o.ferramentas.filter(e=>!t.includes(e)),a=t.map(e=>({ferramenta:"object"===typeof e?e.nome:e,dataDevolucao:d,devolvidoPorTerceiros:r}));await(0,s.updateDoc)(c,{ferramentas:e,historicoFerramentas:(0,s.hq)(...a)}),await l()}S(null),X(null),Q(!1)}catch(e){console.error("Erro ao devolver ferramentas:",e),alert("Erro ao devolver as ferramentas. Por favor, tente novamente."),Q(!1),X(null)}}}),J&&$&&(0,k.jsx)(hk,{emprestimoOrigem:$.emprestimoOrigem,funcionarioDestino:$.funcionarioDestino,ferramentas:$.ferramentas,onComplete:async()=>{try{if(!$)return;const{emprestimoOrigem:e,funcionarioDestino:t,ferramentas:r,observacao:a}=$;console.log("Finalizando transfer\xeancia de ferramentas:",{ferramentas:r,funcionarioDestino:t,observacao:a});const n=(new Date).toISOString(),i=e.ferramentas.find(e=>e.id===r[0].id);if(!i)throw new Error("Ferramenta n\xe3o encontrada no empr\xe9stimo original");const o=e.ferramentas.filter(e=>e.id!==r[0].id),c=(0,s.doc)(P.db,"emprestimos",e.id);await(0,s.updateDoc)(c,{ferramentas:o,ferramentasTransferidas:(0,s.hq)({ferramenta:i,funcionarioDestinoId:t.id,funcionarioDestinoNome:t.nome,dataTransferencia:n,observacao:a,usuarioTransferencia:(null===se||void 0===se?void 0:se.email)||"sistema"}),dataAtualizacao:n,usuarioAtualizacao:(null===se||void 0===se?void 0:se.email)||"sistema"});const d={funcionarioId:t.id,nomeFuncionario:t.nome,ferramentas:[i],dataEmprestimo:n,dataCriacao:n,status:"emprestado",observacao:"Transferido de ".concat(e.nomeFuncionario,". ").concat(a?"Observa\xe7\xe3o: ".concat(a):""),emprestimoOriginalId:e.id,usuarioCriacao:(null===se||void 0===se?void 0:se.email)||"sistema",historicoTransferencias:[{dataTransferencia:n,funcionarioOrigemId:e.funcionarioId,funcionarioOrigemNome:e.nomeFuncionario,observacao:a}]};await(0,s.gS)((0,s.collection)(P.db,"emprestimos"),d),console.log("Transfer\xeancia conclu\xedda com sucesso"),await l(),V(null),ee(null),Z(!1)}catch(e){console.error("Erro ao transferir ferramentas:",e),alert("Erro ao transferir ferramentas. Por favor, tente novamente."),Z(!1),ee(null)}}}),te&&ae&&(0,k.jsx)(vb,{emprestimo:ae,ferramenta:(null===(r=ae.ferramentas)||void 0===r?void 0:r[0])||{},funcionario:c.find(e=>e.id===ae.funcionarioId)||{nome:ae.nomeFuncionario},empresa:{nome:ae.empresaNome||"N/A"},setor:{nome:ae.setorNome||"N/A"},onClose:()=>{re(!1),ne(null)}})]})]})},bk=e=>{let{emprestimos:t,inventario:r,adicionarEmprestimo:a,devolverFerramentas:n,removerEmprestimo:s,atualizarDisponibilidade:i,funcionarios:o}=e;const{usuario:l}=Nt(),c="funcionario"===(null===l||void 0===l?void 0:l.nivel);return(0,k.jsxs)("div",{className:"space-y-6",children:[!c&&(0,k.jsx)(tk,{inventario:r,adicionarEmprestimo:a,atualizarDisponibilidade:i,emprestimos:t}),(0,k.jsx)(vk,{emprestimos:t,devolverFerramentas:n,removerEmprestimo:s,atualizarDisponibilidade:i,readonly:c,funcionarios:o})]})},wk=t=>{let{inventario:r,emprestimos:a,adicionarItem:n,removerItem:s,atualizarItem:i,reimportarInventario:o,corrigirInventario:l,obterDetalhesEmprestimos:c,compras:d,adicionarCompra:u,removerCompra:h,atualizarCompra:m,ferramentasDanificadas:f,adicionarFerramentaDanificada:g,atualizarFerramentaDanificada:p,removerFerramentaDanificada:x,ferramentasPerdidas:y,adicionarFerramentaPerdida:v,atualizarFerramentaPerdida:b,removerFerramentaPerdida:w,funcionarios:N,adicionarEmprestimo:j,removerEmprestimo:S,atualizarEmprestimo:_,devolverFerramentas:E,emprestimosCarregados:A}=t;const[C,I]=(0,e.useState)("emprestimos"),{usuario:T}=Nt(),D=[{id:"emprestimos",nome:"Empr\xe9stimos",icone:mu,descricao:"Registre e controle empr\xe9stimos de ferramentas",permissao:()=>(null===T||void 0===T?void 0:T.nivel)===jt.ADMIN||(null===T||void 0===T?void 0:T.nivel)!==jt.FUNCIONARIO&&(null===T||void 0===T?void 0:T.nivel)<=jt.GERENTE_SETOR},{id:"inventario-geral",nome:"Invent\xe1rio Geral",icone:Md,descricao:"Gerencie o estoque completo de ferramentas",permissao:()=>(null===T||void 0===T?void 0:T.nivel)===jt.ADMIN||(null===T||void 0===T?void 0:T.nivel)!==jt.FUNCIONARIO&&(null===T||void 0===T?void 0:T.nivel)<=jt.GERENTE_SETOR},{id:"historico-emprestimos",nome:"Hist\xf3rico de Empr\xe9stimos",icone:fu,descricao:"Consulte o hist\xf3rico completo de empr\xe9stimos realizados",permissao:()=>!0}].filter(e=>e.permissao());return(0,k.jsxs)("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 p-4 md:p-6",children:[(0,k.jsx)("div",{className:"max-w-7xl mx-auto mb-6",children:(0,k.jsx)("div",{className:"bg-gradient-to-r from-blue-500 to-blue-600 rounded-2xl p-6 shadow-xl",children:(0,k.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,k.jsx)("div",{className:"p-3 bg-white/20 rounded-xl backdrop-blur-sm",children:(0,k.jsx)(Md,{className:"w-8 h-8 text-white"})}),(0,k.jsxs)("div",{children:[(0,k.jsx)("h1",{className:"text-2xl md:text-3xl font-bold text-white",children:"Invent\xe1rio & Empr\xe9stimos"}),(0,k.jsx)("p",{className:"text-blue-100 text-sm md:text-base",children:"Gerencie ferramentas, estoque e empr\xe9stimos em um s\xf3 lugar"})]})]})})}),(0,k.jsx)("div",{className:"max-w-7xl mx-auto mb-6",children:(0,k.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg p-2",children:(0,k.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2",children:D.map(e=>{const t=e.icone,r=C===e.id;return(0,k.jsxs)("button",{onClick:()=>I(e.id),className:"\n                    flex items-center gap-3 p-4 rounded-lg transition-all duration-200\n                    ".concat(r?"bg-gradient-to-r from-blue-500 to-blue-600 text-white shadow-lg scale-105":"bg-gray-50 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-600","\n                  "),children:[(0,k.jsx)("div",{className:"\n                    p-2 rounded-lg\n                    ".concat(r?"bg-white/20":"bg-white dark:bg-gray-600","\n                  "),children:(0,k.jsx)(t,{className:"w-5 h-5 ".concat(r?"text-white":"text-blue-600 dark:text-blue-400")})}),(0,k.jsxs)("div",{className:"text-left flex-1",children:[(0,k.jsx)("div",{className:"font-semibold ".concat(r?"text-white":"text-gray-900 dark:text-white"),children:e.nome}),(0,k.jsx)("div",{className:"text-xs ".concat(r?"text-white/80":"text-gray-500 dark:text-gray-400"),children:e.descricao})]})]},e.id)})})})}),(0,k.jsx)("div",{className:"max-w-7xl mx-auto",children:(()=>{switch(C){case"historico-emprestimos":return(0,k.jsx)(Vb,{emprestimos:A?a:null});case"inventario-geral":return(0,k.jsx)(Jw,{inventario:r,emprestimos:a,adicionarItem:n,removerItem:s,atualizarItem:i,reimportarInventario:o,corrigirInventario:l,obterDetalhesEmprestimos:c,compras:d,funcionarios:N,adicionarCompra:u,removerCompra:h,atualizarCompra:m,ferramentasDanificadas:f,adicionarFerramentaDanificada:g,atualizarFerramentaDanificada:p,removerFerramentaDanificada:x,ferramentasPerdidas:y,adicionarFerramentaPerdida:v,atualizarFerramentaPerdida:b,removerFerramentaPerdida:w});case"emprestimos":return(0,k.jsx)(ir,{children:(0,k.jsx)(bk,{emprestimos:a,inventario:r,funcionarios:N,adicionarEmprestimo:j,removerEmprestimo:S,atualizarEmprestimo:_,devolverFerramentas:E,readonly:!Dt.canManageOperational(null===T||void 0===T?void 0:T.nivel)})});default:return null}})()})]})},kk=[{id:1,nome:"Mudas de Rosa Vermelha",quantidade:50,disponivel:45,categoria:"Plantas & Mudas",setor:"jardinagem"},{id:2,nome:"Mudas de Rosa Branca",quantidade:40,disponivel:38,categoria:"Plantas & Mudas",setor:"jardinagem"},{id:3,nome:"Mudas de Lavanda",quantidade:60,disponivel:55,categoria:"Plantas & Mudas",setor:"jardinagem"},{id:4,nome:"Mudas de Girassol",quantidade:30,disponivel:28,categoria:"Plantas & Mudas",setor:"jardinagem"},{id:5,nome:"Mudas de Orqu\xeddea Phalaenopsis",quantidade:25,disponivel:20,categoria:"Plantas & Mudas",setor:"jardinagem"},{id:6,nome:"Mudas de Suculenta Mista",quantidade:100,disponivel:92,categoria:"Plantas & Mudas",setor:"jardinagem"},{id:7,nome:"Mudas de Cacto Variado",quantidade:80,disponivel:75,categoria:"Plantas & Mudas",setor:"jardinagem"},{id:8,nome:"Mudas de Hort\xeansia Azul",quantidade:35,disponivel:30,categoria:"Plantas & Mudas",setor:"jardinagem"},{id:9,nome:"Mudas de Hort\xeansia Rosa",quantidade:35,disponivel:32,categoria:"Plantas & Mudas",setor:"jardinagem"},{id:10,nome:"Mudas de Violeta Africana",quantidade:45,disponivel:42,categoria:"Plantas & Mudas",setor:"jardinagem"},{id:11,nome:"Mudas de Tulipa Mix",quantidade:50,disponivel:45,categoria:"Plantas & Mudas",setor:"jardinagem"},{id:12,nome:"Mudas de Beg\xf4nia",quantidade:40,disponivel:35,categoria:"Plantas & Mudas",setor:"jardinagem"},{id:13,nome:"Sementes de Girassol 500g",quantidade:20,disponivel:18,categoria:"Sementes",setor:"jardinagem"},{id:14,nome:"Sementes de Flores Silvestres Mix 1kg",quantidade:15,disponivel:13,categoria:"Sementes",setor:"jardinagem"},{id:15,nome:"Sementes de Manjeric\xe3o",quantidade:30,disponivel:28,categoria:"Sementes",setor:"jardinagem"},{id:16,nome:"Sementes de Cenoura",quantidade:25,disponivel:22,categoria:"Sementes",setor:"jardinagem"},{id:17,nome:"Sementes de Alface",quantidade:35,disponivel:30,categoria:"Sementes",setor:"jardinagem"},{id:18,nome:"Sementes de Tomate Cereja",quantidade:40,disponivel:35,categoria:"Sementes",setor:"jardinagem"},{id:19,nome:"Fertilizante NPK 10-10-10 (25kg)",quantidade:15,disponivel:12,categoria:"Fertilizantes & Adubos",setor:"jardinagem"},{id:20,nome:"Fertilizante NPK 20-20-20 (25kg)",quantidade:12,disponivel:10,categoria:"Fertilizantes & Adubos",setor:"jardinagem"},{id:21,nome:"Adubo Org\xe2nico Composto (50kg)",quantidade:20,disponivel:15,categoria:"Fertilizantes & Adubos",setor:"jardinagem"},{id:22,nome:"H\xfamus de Minhoca (10kg)",quantidade:30,disponivel:25,categoria:"Fertilizantes & Adubos",setor:"jardinagem"},{id:23,nome:"Esterco Bovino Curtido (50kg)",quantidade:25,disponivel:20,categoria:"Fertilizantes & Adubos",setor:"jardinagem"},{id:24,nome:"Fertilizante L\xedquido para Flores 1L",quantidade:40,disponivel:35,categoria:"Fertilizantes & Adubos",setor:"jardinagem"},{id:25,nome:"Calc\xe1rio Agr\xedcola (25kg)",quantidade:18,disponivel:15,categoria:"Fertilizantes & Adubos",setor:"jardinagem"},{id:26,nome:"Terra Vegetal Premium (50L)",quantidade:60,disponivel:50,categoria:"Terra & Substratos",setor:"jardinagem"},{id:27,nome:"Substrato para Orqu\xeddeas (10L)",quantidade:40,disponivel:35,categoria:"Terra & Substratos",setor:"jardinagem"},{id:28,nome:"Substrato para Suculentas (10L)",quantidade:45,disponivel:40,categoria:"Terra & Substratos",setor:"jardinagem"},{id:29,nome:"Substrato para Mudas (50L)",quantidade:35,disponivel:30,categoria:"Terra & Substratos",setor:"jardinagem"},{id:30,nome:"Turfa (50L)",quantidade:25,disponivel:20,categoria:"Terra & Substratos",setor:"jardinagem"},{id:31,nome:"Vermiculita Expandida (10L)",quantidade:30,disponivel:25,categoria:"Terra & Substratos",setor:"jardinagem"},{id:32,nome:"Vaso de Barro 15cm",quantidade:100,disponivel:85,categoria:"Vasos & Recipientes",setor:"jardinagem"},{id:33,nome:"Vaso de Barro 20cm",quantidade:80,disponivel:70,categoria:"Vasos & Recipientes",setor:"jardinagem"},{id:34,nome:"Vaso de Barro 30cm",quantidade:60,disponivel:50,categoria:"Vasos & Recipientes",setor:"jardinagem"},{id:35,nome:"Vaso Pl\xe1stico Preto 15cm",quantidade:150,disponivel:130,categoria:"Vasos & Recipientes",setor:"jardinagem"},{id:36,nome:"Vaso Pl\xe1stico Preto 20cm",quantidade:120,disponivel:100,categoria:"Vasos & Recipientes",setor:"jardinagem"},{id:37,nome:"Cachep\xf4 Decorativo M\xe9dio",quantidade:40,disponivel:35,categoria:"Vasos & Recipientes",setor:"jardinagem"},{id:38,nome:"Cachep\xf4 Decorativo Grande",quantidade:30,disponivel:25,categoria:"Vasos & Recipientes",setor:"jardinagem"},{id:39,nome:"Jardineira 60cm",quantidade:35,disponivel:30,categoria:"Vasos & Recipientes",setor:"jardinagem"},{id:40,nome:"Bandeja para Mudas 128 c\xe9lulas",quantidade:50,disponivel:45,categoria:"Vasos & Recipientes",setor:"jardinagem"},{id:41,nome:"P\xe1 de Jardinagem Pequena",quantidade:25,disponivel:22,categoria:"Ferramentas",setor:"jardinagem"},{id:42,nome:"P\xe1 de Jardinagem Grande",quantidade:18,disponivel:15,categoria:"Ferramentas",setor:"jardinagem"},{id:43,nome:"Enxada de Jardim",quantidade:20,disponivel:18,categoria:"Ferramentas",setor:"jardinagem"},{id:44,nome:"Ancinho de Metal",quantidade:15,disponivel:13,categoria:"Ferramentas",setor:"jardinagem"},{id:45,nome:"Tesoura de Poda Profissional",quantidade:30,disponivel:25,categoria:"Ferramentas",setor:"jardinagem"},{id:46,nome:"Tesoura de Poda Telesc\xf3pica",quantidade:12,disponivel:10,categoria:"Ferramentas",setor:"jardinagem"},{id:47,nome:"Regador 5L",quantidade:40,disponivel:35,categoria:"Ferramentas",setor:"jardinagem"},{id:48,nome:"Regador 10L",quantidade:30,disponivel:25,categoria:"Ferramentas",setor:"jardinagem"},{id:49,nome:"Pulverizador Manual 2L",quantidade:35,disponivel:30,categoria:"Ferramentas",setor:"jardinagem"},{id:50,nome:"Pulverizador Costal 20L",quantidade:10,disponivel:8,categoria:"Ferramentas",setor:"jardinagem"},{id:51,nome:"Carrinho de M\xe3o para Jardim",quantidade:8,disponivel:7,categoria:"Ferramentas",setor:"jardinagem"},{id:52,nome:"Mangueira de Jardim 30m",quantidade:15,disponivel:12,categoria:"Ferramentas",setor:"jardinagem"},{id:53,nome:"Bico para Mangueira Regul\xe1vel",quantidade:25,disponivel:20,categoria:"Ferramentas",setor:"jardinagem"},{id:54,nome:"Luvas de Jardinagem Tecido",quantidade:50,disponivel:45,categoria:"Ferramentas",setor:"jardinagem"},{id:55,nome:"Luvas de Jardinagem Couro",quantidade:30,disponivel:25,categoria:"Ferramentas",setor:"jardinagem"},{id:56,nome:"Escarificador Manual",quantidade:15,disponivel:13,categoria:"Ferramentas",setor:"jardinagem"},{id:57,nome:"Sacho de Jardinagem",quantidade:20,disponivel:18,categoria:"Ferramentas",setor:"jardinagem"},{id:58,nome:"Kit Mini Ferramentas (3 pe\xe7as)",quantidade:40,disponivel:35,categoria:"Ferramentas",setor:"jardinagem"},{id:59,nome:"Cortador de Grama El\xe9trico",quantidade:5,disponivel:4,categoria:"Equipamentos",setor:"jardinagem"},{id:60,nome:"Ro\xe7adeira a Gasolina",quantidade:4,disponivel:3,categoria:"Equipamentos",setor:"jardinagem"},{id:61,nome:"Soprador de Folhas El\xe9trico",quantidade:6,disponivel:5,categoria:"Equipamentos",setor:"jardinagem"},{id:62,nome:"Motosserra El\xe9trica",quantidade:3,disponivel:2,categoria:"Equipamentos",setor:"jardinagem"},{id:63,nome:"Aparador de Cerca Viva",quantidade:4,disponivel:3,categoria:"Equipamentos",setor:"jardinagem"},{id:64,nome:"Arame para Amarra\xe7\xe3o 1kg",quantidade:25,disponivel:20,categoria:"Insumos",setor:"jardinagem"},{id:65,nome:"Barbante para Jardim 500m",quantidade:30,disponivel:25,categoria:"Insumos",setor:"jardinagem"},{id:66,nome:"Etiquetas para Plantas (100un)",quantidade:50,disponivel:45,categoria:"Insumos",setor:"jardinagem"},{id:67,nome:"Tela de Sombreamento 2x3m",quantidade:20,disponivel:18,categoria:"Insumos",setor:"jardinagem"},{id:68,nome:"Manta de Drenagem 1x10m",quantidade:15,disponivel:12,categoria:"Insumos",setor:"jardinagem"},{id:69,nome:"Geomanta para Prote\xe7\xe3o",quantidade:12,disponivel:10,categoria:"Insumos",setor:"jardinagem"},{id:70,nome:"Sacos para Mudas 15x20cm (100un)",quantidade:40,disponivel:35,categoria:"Insumos",setor:"jardinagem"},{id:71,nome:"Botas de Borracha",quantidade:15,disponivel:12,categoria:"EPI",setor:"jardinagem"},{id:72,nome:"\xd3culos de Prote\xe7\xe3o",quantidade:20,disponivel:18,categoria:"EPI",setor:"jardinagem"},{id:73,nome:"Avental de Jardinagem",quantidade:18,disponivel:15,categoria:"EPI",setor:"jardinagem"},{id:74,nome:"Chap\xe9u de Palha",quantidade:25,disponivel:22,categoria:"EPI",setor:"jardinagem"},{id:75,nome:"Protetor Solar FPS 50",quantidade:30,disponivel:25,categoria:"EPI",setor:"jardinagem"}],Nk=y("pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]),jk=y("phone",[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]]),Sk=t=>{let{value:r,onChange:a,className:i}=t;const[o,l]=(0,e.useState)([]),[c,d]=(0,e.useState)(!1),[u,h]=(0,e.useState)(""),[m,f]=(0,e.useState)(null),[g,p]=(0,e.useState)(!1);(0,e.useEffect)(()=>{(async()=>{try{const e=(0,s.collection)(P.db,"cargos"),t=(await(0,s.GG)(e)).docs.map(e=>(0,n.A)({id:e.id},e.data()));l(t)}catch(e){console.error("Erro ao carregar cargos:",e)}})()},[]);return(0,k.jsxs)("div",{className:"relative",children:[(0,k.jsxs)("div",{className:"flex items-center gap-2",children:[(0,k.jsxs)("select",{value:r||"",onChange:e=>a(e.target.value),className:"bg-white dark:bg-gray-700 text-gray-900 dark:text-white rounded-lg px-4 py-2 w-full focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-[#1D9BF0] ".concat(i),children:[(0,k.jsx)("option",{value:"",children:"Selecione um cargo"}),o.map(e=>(0,k.jsx)("option",{value:e.nome,children:e.nome},e.id))]}),(0,k.jsx)("button",{onClick:()=>d(!0),className:"bg-white dark:bg-gray-700 p-2 rounded-lg hover:bg-[#2C3E50] transition-colors",title:"Gerenciar cargos",children:(0,k.jsx)(D,{className:"w-5 h-5 text-blue-500 dark:text-[#1D9BF0]"})})]}),c&&(0,k.jsx)("div",{className:"fixed inset-0 bg-black/50 dark:bg-black/70 dark:bg-black/70 flex items-center justify-center z-50",children:(0,k.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 w-full max-w-md",children:[(0,k.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,k.jsx)("h3",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Gerenciar Cargos"}),(0,k.jsx)("button",{onClick:()=>{d(!1),f(null),h(""),p(!1)},className:"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-white transition-colors",children:(0,k.jsx)(Id,{className:"w-5 h-5"})})]}),(0,k.jsx)("div",{className:"mb-4",children:(0,k.jsxs)("div",{className:"flex gap-2",children:[(0,k.jsx)("input",{type:"text",value:u,onChange:e=>h(e.target.value),placeholder:g?"Editar cargo":"Novo cargo",className:"flex-1 bg-white dark:bg-gray-700 text-gray-900 dark:text-white rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-[#1D9BF0]"}),(0,k.jsx)("button",{onClick:g?async()=>{if(m&&u.trim())try{const e=(0,s.doc)(P.db,"cargos",m.id);await(0,s.updateDoc)(e,{nome:u,updatedAt:(new Date).toISOString()}),l(e=>e.map(e=>e.id===m.id?(0,n.A)((0,n.A)({},e),{},{nome:u}):e)),f(null),h(""),p(!1)}catch(e){console.error("Erro ao editar cargo:",e)}}:async()=>{if(u.trim())try{const e=(0,s.collection)(P.db,"cargos"),t=await(0,s.gS)(e,{nome:u,createdAt:(new Date).toISOString()});l(e=>[...e,{id:t.id,nome:u}]),h("")}catch(e){console.error("Erro ao adicionar cargo:",e)}},disabled:!u.trim(),className:"bg-blue-500 dark:bg-[#1D9BF0] text-gray-900 dark:text-white px-4 py-2 rounded-lg hover:bg-blue-600 dark:hover:bg-[#1a8cd8] transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:g?(0,k.jsx)(lk,{className:"w-5 h-5"}):(0,k.jsx)(D,{className:"w-5 h-5"})})]})}),(0,k.jsx)("div",{className:"space-y-2 max-h-[300px] overflow-y-auto",children:o.map(e=>(0,k.jsxs)("div",{className:"flex items-center justify-between bg-white dark:bg-gray-700 p-3 rounded-lg",children:[(0,k.jsx)("span",{className:"text-gray-900 dark:text-white",children:e.nome}),(0,k.jsxs)("div",{className:"flex items-center gap-2",children:[(0,k.jsx)("button",{onClick:()=>{f(e),h(e.nome),p(!0)},className:"text-blue-500 dark:text-[#1D9BF0] hover:text-blue-600 dark:hover:text-[#1a8cd8] transition-colors",children:(0,k.jsx)(Nk,{className:"w-4 h-4"})}),(0,k.jsx)("button",{onClick:()=>(async e=>{if(window.confirm("Tem certeza que deseja excluir este cargo?"))try{await(0,s.deleteDoc)((0,s.doc)(P.db,"cargos",e)),l(t=>t.filter(t=>t.id!==e))}catch(t){console.error("Erro ao excluir cargo:",t)}})(e.id),className:"text-red-500 hover:text-red-600 transition-colors",children:(0,k.jsx)(Id,{className:"w-4 h-4"})})]})]},e.id))})]})})]})},_k=y("circle-play",[["path",{d:"M9 9.003a1 1 0 0 1 1.517-.859l4.997 2.997a1 1 0 0 1 0 1.718l-4.997 2.997A1 1 0 0 1 9 14.996z",key:"kmsa83"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),Ek=y("circle-pause",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"10",x2:"10",y1:"15",y2:"9",key:"c1nkhi"}],["line",{x1:"14",x2:"14",y1:"15",y2:"9",key:"h65svq"}]]),Ak=y("pause",[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]]),Ck=y("list-checks",[["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"m3 7 2 2 4-4",key:"1obspn"}],["path",{d:"M13 6h8",key:"15sg57"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 18h8",key:"oe0vm4"}]]),Ik=[{id:"limpeza-almoxarifado",titulo:"Limpeza do Almoxarifado",descricao:"Realizar limpeza geral do almoxarifado incluindo:\n- Varrer o ch\xe3o\n- Limpar prateleiras\n- Organizar ferramentas\n- Verificar itens fora do lugar",prioridade:"media",tipo:"Manuten\xe7\xe3o",tempoEstimado:"2h"},{id:"inventario-mensal",titulo:"Invent\xe1rio Mensal",descricao:"Realizar contagem do invent\xe1rio:\n- Conferir todas as ferramentas\n- Atualizar quantidades no sistema\n- Reportar discrep\xe2ncias\n- Identificar itens com baixo estoque",prioridade:"alta",tipo:"Invent\xe1rio",tempoEstimado:"4h"},{id:"manutencao-ferramentas",titulo:"Manuten\xe7\xe3o de Ferramentas",descricao:"Realizar manuten\xe7\xe3o preventiva nas ferramentas:\n- Limpar equipamentos\n- Lubrificar partes m\xf3veis\n- Verificar condi\xe7\xf5es gerais\n- Separar itens que precisam de reparo",prioridade:"media",tipo:"Manuten\xe7\xe3o",tempoEstimado:"3h"},{id:"organizacao-prateleiras",titulo:"Organiza\xe7\xe3o das Prateleiras",descricao:"Reorganizar prateleiras do almoxarifado:\n- Agrupar itens por categoria\n- Atualizar etiquetas\n- Verificar disposi\xe7\xe3o das ferramentas\n- Otimizar espa\xe7o dispon\xedvel",prioridade:"baixa",tipo:"Organiza\xe7\xe3o",tempoEstimado:"2h"},{id:"recebimento-material",titulo:"Recebimento de Material",descricao:"Processo de recebimento de novos materiais:\n- Conferir nota fiscal\n- Verificar quantidade e qualidade\n- Registrar no sistema\n- Armazenar adequadamente",prioridade:"alta",tipo:"Log\xedstica",tempoEstimado:"1h"},{id:"auditoria-seguranca",titulo:"Auditoria de Seguran\xe7a",descricao:"Realizar auditoria de seguran\xe7a:\n- Verificar EPIs\n- Conferir sinaliza\xe7\xf5es\n- Checar extintores\n- Avaliar condi\xe7\xf5es de risco",prioridade:"alta",tipo:"Seguran\xe7a",tempoEstimado:"2h"}],Tk=y("flag",[["path",{d:"M4 22V4a1 1 0 0 1 .4-.8A6 6 0 0 1 8 2c3 0 5 2 7.333 2q2 0 3.067-.8A1 1 0 0 1 20 4v10a1 1 0 0 1-.4.8A6 6 0 0 1 16 16c-3 0-5-2-8-2a6 6 0 0 0-4 1.528",key:"1jaruq"}]]),Dk=t=>{let{onClose:r,templateParaEditar:a}=t;const{showToast:i}=_(),[o,l]=(0,e.useState)({titulo:"",descricao:"",prioridade:"media",tipo:"",tempoEstimado:""});(0,e.useEffect)(()=>{a&&l({titulo:a.titulo,descricao:a.descricao,prioridade:a.prioridade,tipo:a.tipo,tempoEstimado:a.tempoEstimado})},[a]);return(0,k.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:(0,k.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 w-full max-w-md relative",children:[(0,k.jsx)("button",{onClick:r,className:"absolute right-4 top-4 text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-white transition-colors",children:(0,k.jsx)(Id,{className:"w-6 h-6"})}),(0,k.jsx)("h2",{className:"text-xl font-bold text-gray-900 dark:text-white mb-6",children:a?"Editar Modelo de Tarefa":"Criar Modelo de Tarefa"}),(0,k.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),!o.titulo||!o.descricao||!o.tipo||!o.tempoEstimado)return void i("Preencha todos os campos obrigat\xf3rios","error");let t;a?(t=await(async(e,t)=>{try{const r=Ik.find(t=>t.id===e);if(r){const a=(0,n.A)((0,n.A)((0,n.A)({},r),t),{},{originalId:e,dataCriacao:(new Date).toISOString(),dataAtualizacao:(new Date).toISOString(),personalizado:!0});return delete a.id,{success:!0,newId:(await(0,s.gS)((0,s.collection)(P.db,"templates"),a)).id}}const a=(0,s.doc)(P.db,"templates",e);return await(0,s.updateDoc)(a,(0,n.A)((0,n.A)({},t),{},{dataAtualizacao:(new Date).toISOString()})),{success:!0}}catch(r){return console.error("Erro ao atualizar template:",r),{success:!1}}})(a.id,o),t.success?(i("Template atualizado com sucesso!","success"),r()):i("Erro ao atualizar template","error")):(t=await(async e=>{try{return await(0,s.gS)((0,s.collection)(P.db,"templates"),(0,n.A)((0,n.A)({},e),{},{dataCriacao:(new Date).toISOString(),personalizado:!0})),!0}catch(t){return console.error("Erro ao salvar template:",t),!1}})(o),t?(i("Template salvo com sucesso!","success"),r()):i("Erro ao salvar template","error"))},className:"space-y-4",children:[(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{htmlFor:"titulo",className:"block text-sm font-medium text-gray-500 dark:text-gray-400 mb-1",children:"T\xedtulo"}),(0,k.jsx)("input",{type:"text",id:"titulo",value:o.titulo,onChange:e=>l((0,n.A)((0,n.A)({},o),{},{titulo:e.target.value})),className:"w-full px-4 py-2 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-[#1D9BF0]",placeholder:"Digite o t\xedtulo do modelo"})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{htmlFor:"descricao",className:"block text-sm font-medium text-gray-500 dark:text-gray-400 mb-1",children:"Descri\xe7\xe3o"}),(0,k.jsx)("textarea",{id:"descricao",value:o.descricao,onChange:e=>l((0,n.A)((0,n.A)({},o),{},{descricao:e.target.value})),className:"w-full px-4 py-2 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-[#1D9BF0] min-h-[100px]",placeholder:"Digite a descri\xe7\xe3o do modelo. Use - para criar t\xf3picos."}),(0,k.jsx)("p",{className:"text-gray-500 dark:text-gray-400 text-xs mt-1",children:"Dica: Use - no in\xedcio da linha para criar t\xf3picos"})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{htmlFor:"tipo",className:"block text-sm font-medium text-gray-500 dark:text-gray-400 mb-1",children:"Tipo"}),(0,k.jsx)("input",{type:"text",id:"tipo",value:o.tipo,onChange:e=>l((0,n.A)((0,n.A)({},o),{},{tipo:e.target.value})),className:"w-full px-4 py-2 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-[#1D9BF0]",placeholder:"Ex: Manuten\xe7\xe3o, Invent\xe1rio, etc."})]}),(0,k.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{htmlFor:"prioridade",className:"block text-sm font-medium text-gray-500 dark:text-gray-400 mb-1",children:"Prioridade"}),(0,k.jsxs)("select",{id:"prioridade",value:o.prioridade,onChange:e=>l((0,n.A)((0,n.A)({},o),{},{prioridade:e.target.value})),className:"w-full px-4 py-2 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-[#1D9BF0]",children:[(0,k.jsx)("option",{value:"baixa",children:"Baixa"}),(0,k.jsx)("option",{value:"media",children:"M\xe9dia"}),(0,k.jsx)("option",{value:"alta",children:"Alta"})]})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{htmlFor:"tempoEstimado",className:"block text-sm font-medium text-gray-500 dark:text-gray-400 mb-1",children:"Tempo Estimado"}),(0,k.jsx)("input",{type:"text",id:"tempoEstimado",value:o.tempoEstimado,onChange:e=>l((0,n.A)((0,n.A)({},o),{},{tempoEstimado:e.target.value})),className:"w-full px-4 py-2 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-[#1D9BF0]",placeholder:"Ex: 2h, 30min"})]})]}),(0,k.jsx)("button",{type:"submit",className:"w-full py-2 px-4 bg-blue-500 dark:bg-[#1D9BF0] text-gray-900 dark:text-white rounded-full hover:bg-blue-600 dark:hover:bg-[#1a8cd8] transition-colors font-medium",children:a?"Atualizar Modelo":"Salvar Modelo"})]})]})})},Pk=t=>{let{onSelect:r,onClose:a}=t;const{usuario:i}=Nt(),{showToast:o}=_(),[l,c]=(0,e.useState)([]),[d,u]=(0,e.useState)(!1),[h,m]=(0,e.useState)(null),[f,g]=(0,e.useState)({show:!1,templateId:null});(0,e.useEffect)(()=>{try{const e=(e=>{const t=(0,s.P)((0,s.collection)(P.db,"templates"),(0,s.My)("dataCriacao","desc"));return(0,s.aQ)(t,t=>{const r=t.docs.map(e=>(0,n.A)({id:e.id},e.data()));e(r)})})(e=>{console.log("Templates carregados:",e),c(e)});return()=>e()}catch(e){console.error("Erro ao carregar templates:",e),o("Erro ao carregar templates personalizados","error")}},[o]);const[p,x]=(0,e.useState)(!1),y=Ik.filter(e=>!l.some(t=>t.originalId===e.id)),v=p?[...y,...l]:l,b=[...new Set(v.map(e=>e.tipo))].sort();return(0,k.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:(0,k.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 w-full max-w-4xl max-h-[90vh] overflow-y-auto",children:[(0,k.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,k.jsxs)("div",{children:[(0,k.jsx)("h2",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Selecione um Modelo de Tarefa"}),(0,k.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Escolha um modelo existente ou crie um novo"})]}),(0,k.jsx)("div",{className:"flex items-center gap-2",children:(0,k.jsxs)("div",{className:"flex items-center gap-4",children:[(0,k.jsxs)("label",{className:"flex items-center gap-2 text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-white cursor-pointer",children:[(0,k.jsx)("input",{type:"checkbox",checked:p,onChange:e=>x(e.target.checked),className:"w-4 h-4 rounded border-gray-300 dark:border-gray-600 text-blue-500 dark:text-[#1D9BF0] focus:ring-blue-500 dark:focus:ring-[#1D9BF0] focus:ring-offset-0 bg-white dark:bg-gray-700"}),(0,k.jsx)("span",{className:"text-sm",children:"Mostrar modelos do sistema"})]}),i.nivel>=2&&(0,k.jsxs)("button",{onClick:()=>u(!0),className:"flex items-center gap-2 px-4 py-2 bg-blue-500 dark:bg-[#1D9BF0] text-gray-900 dark:text-white rounded-full hover:bg-blue-600 dark:hover:bg-[#1a8cd8] transition-colors",children:[(0,k.jsx)(D,{className:"w-4 h-4"}),"Criar Modelo"]}),(0,k.jsx)("button",{onClick:a,className:"p-2 text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-white hover:bg-white/10 rounded-full transition-colors",children:"\xd7"})]})})]}),(0,k.jsx)("div",{className:"space-y-6",children:b.map(e=>(0,k.jsxs)("div",{children:[(0,k.jsx)("h3",{className:"text-lg font-medium text-gray-500 dark:text-gray-400 mb-3",children:e}),(0,k.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:v.filter(t=>t.tipo===e).sort((e,t)=>e.personalizado===t.personalizado?0:e.personalizado?1:-1).map(e=>(0,k.jsxs)("button",{onClick:()=>r(e),className:"text-left p-4 bg-[#22303C] rounded-xl border ".concat(e.personalizado?"border-blue-500 dark:border-[#1D9BF0]/30 hover:border-blue-500 dark:border-[#1D9BF0]":"border-gray-300 dark:border-gray-600 hover:border-blue-500 dark:border-[#1D9BF0]"," transition-colors"),children:[(0,k.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,k.jsx)("h4",{className:"text-gray-900 dark:text-white font-medium",children:e.titulo}),(0,k.jsxs)("div",{className:"flex items-center gap-2",children:[(0,k.jsxs)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat("alta"===e.prioridade?"bg-red-500/10 text-red-500":"media"===e.prioridade?"bg-yellow-500/10 text-yellow-500":"bg-green-500/10 text-green-500"),children:[(0,k.jsx)(Tk,{className:"w-3 h-3 inline-block mr-1"}),e.prioridade.charAt(0).toUpperCase()+e.prioridade.slice(1)]}),i.nivel>=2&&(0,k.jsxs)("div",{className:"flex items-center gap-1",children:[(0,k.jsx)("button",{onClick:t=>{t.stopPropagation(),m(e),u(!0)},className:"p-1 text-blue-500 dark:text-[#1D9BF0] hover:bg-blue-500 dark:bg-[#1D9BF0]/10 rounded-full transition-colors",title:e.personalizado?"Editar modelo":"Criar c\xf3pia personalizada",children:(0,k.jsx)(aw,{className:"w-4 h-4"})}),e.personalizado&&(0,k.jsx)("button",{onClick:t=>(async(e,t)=>{e.stopPropagation(),g({show:!0,templateId:t})})(t,e.id),className:"p-1 text-red-500 hover:bg-red-500/10 rounded-full transition-colors",title:"Excluir modelo",children:(0,k.jsx)(nw,{className:"w-4 h-4"})})]})]})]}),(0,k.jsx)("p",{className:"text-gray-500 dark:text-gray-400 text-sm whitespace-pre-line mb-3",children:e.descricao}),(0,k.jsxs)("div",{className:"flex items-center text-gray-500 dark:text-gray-400 text-xs",children:[(0,k.jsx)(xu,{className:"w-3 h-3 mr-1"}),"Tempo estimado: ",e.tempoEstimado]})]},e.id))})]},e))}),d&&(0,k.jsx)(Dk,{onClose:()=>{u(!1),m(null)},templateParaEditar:h}),f.show&&(0,k.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[60]",children:(0,k.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 max-w-md w-full",children:[(0,k.jsx)("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-4",children:"Confirmar Exclus\xe3o"}),(0,k.jsx)("p",{className:"text-gray-500 dark:text-gray-400 mb-6",children:"Tem certeza que deseja excluir este modelo de tarefa? Esta a\xe7\xe3o n\xe3o pode ser desfeita."}),(0,k.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,k.jsx)("button",{onClick:()=>g({show:!1,templateId:null}),className:"px-4 py-2 text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-white transition-colors",children:"Cancelar"}),(0,k.jsx)("button",{onClick:async()=>{await(async e=>{try{return await(0,s.deleteDoc)((0,s.doc)(P.db,"templates",e)),!0}catch(t){return console.error("Erro ao excluir template:",t),!1}})(f.templateId)?o("Modelo exclu\xeddo com sucesso!","success"):o("Erro ao excluir modelo","error"),g({show:!1,templateId:null})},className:"px-4 py-2 bg-red-500 text-gray-900 dark:text-white rounded-lg hover:bg-red-600 transition-colors",children:"Excluir"})]})]})})]})})},Fk=async function(e,t,r,a){let n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};try{const i={usuarioId:e,tipo:t,titulo:r,mensagem:a,dados:n,lida:!1,timestamp:(0,s.O5)(),criadaEm:(new Date).toISOString()},o=await(0,s.gS)((0,s.collection)(P.db,"notificacoes"),i);return"Notification"in window&&"granted"===Notification.permission&&new Notification(r,{body:a,icon:"/logo192.png",tag:n.tarefaId||"notif"}),o.id}catch(i){throw console.error("Erro criar notifica\xe7\xe3o:",i),i}},Lk=async(e,t,r,a)=>{const n="".concat({alta:"\ud83d\udd34",media:"\ud83d\udfe1",baixa:"\ud83d\udfe2"}[r]||"\ud83d\udccb"," Nova Tarefa Atribu\xedda"),s='Voc\xea recebeu uma nova tarefa: "'.concat(t,'"');await Fk(e,"tarefa",n,s,{tarefaId:a.id,tituloTarefa:t,prioridade:r,acao:"nova_tarefa"})},Mk=t=>{let{onClose:r}=t;const{usuario:a}=Nt(),{showToast:i}=_(),{funcionarios:o}=or(),[l,c]=(0,e.useState)({titulo:"",descricao:"",prioridade:"",funcionariosIds:[]}),[d,u]=(0,e.useState)([]),[h,m]=(0,e.useState)(!1),[f,g]=(0,e.useState)(!1);return(0,k.jsxs)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:[(0,k.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 w-full max-w-md relative",children:[(0,k.jsx)("button",{onClick:r,className:"absolute right-4 top-4 text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-white transition-colors",children:(0,k.jsx)(Id,{className:"w-6 h-6"})}),(0,k.jsx)("h2",{className:"text-xl font-bold text-gray-900 dark:text-white mb-6",children:"Nova Tarefa"}),(0,k.jsxs)("button",{type:"button",onClick:()=>g(!0),className:"w-full mb-4 py-2 px-4 bg-white dark:bg-gray-700 text-gray-500 dark:text-gray-400 rounded-lg border border-gray-300 dark:border-gray-600 hover:bg-[#2C3E50] transition-colors flex items-center justify-center gap-2",children:[(0,k.jsx)(Ck,{className:"w-5 h-5"}),"Usar Modelo de Tarefa"]}),(0,k.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),l.titulo&&l.descricao&&0!==l.funcionariosIds.length&&l.prioridade){m(!0);try{const e={titulo:l.titulo,descricao:l.descricao,prioridade:l.prioridade,funcionariosIds:l.funcionariosIds,funcionarios:d.map(e=>({id:e.id,nome:e.nome||e.username||e.email||"Sem nome"})),status:"pendente",dataCriacao:(new Date).toISOString(),criadoPor:{id:a.id,nome:a.nome}},o=await(0,s.gS)((0,s.collection)(P.db,"tarefas"),e);try{console.log("\ud83d\udd14 Criando notifica\xe7\xf5es para funcion\xe1rios:",l.funcionariosIds);for(const t of l.funcionariosIds){const r=d.find(e=>e.id===t),a=r?r.nome||r.username||r.email:"Funcion\xe1rio";console.log("\ud83d\udcec Enviando notifica\xe7\xe3o para: ".concat(a," (ID: ").concat(t,")")),await Lk(t,l.titulo,l.prioridade,(0,n.A)({id:o.id},e))}console.log("\u2705 Todas as notifica\xe7\xf5es foram criadas com sucesso")}catch(t){console.error("\u274c Erro ao criar notifica\xe7\xf5es da tarefa:",t)}i("Tarefa criada com sucesso!","success"),r()}catch(o){console.error("Erro ao criar tarefa:",o),i("Erro ao criar tarefa","error")}m(!1)}else i("Preencha todos os campos obrigat\xf3rios","error")},className:"space-y-4",children:[(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{htmlFor:"titulo",className:"block text-sm font-medium text-gray-500 dark:text-gray-400 mb-1",children:"T\xedtulo"}),(0,k.jsx)("input",{type:"text",id:"titulo",value:l.titulo,onChange:e=>c((0,n.A)((0,n.A)({},l),{},{titulo:e.target.value})),className:"w-full px-4 py-2 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-[#1D9BF0]",placeholder:"Digite o t\xedtulo da tarefa"})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{htmlFor:"descricao",className:"block text-sm font-medium text-gray-500 dark:text-gray-400 mb-1",children:"Descri\xe7\xe3o"}),(0,k.jsx)("textarea",{id:"descricao",value:l.descricao,onChange:e=>c((0,n.A)((0,n.A)({},l),{},{descricao:e.target.value})),className:"w-full px-4 py-2 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-lg text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-[#1D9BF0] min-h-[100px]",placeholder:"Digite a descri\xe7\xe3o da tarefa. Use @ para mencionar usu\xe1rios (ex: @Jo\xe3o)"}),(0,k.jsx)("p",{className:"text-gray-500 dark:text-gray-400 text-xs mt-1",children:"Dica: Use @ para mencionar outros funcion\xe1rios (ex: @Jo\xe3o)"})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{htmlFor:"prioridade",className:"block text-sm font-medium text-gray-500 dark:text-gray-400 mb-1",children:"Prioridade"}),(0,k.jsxs)("select",{id:"prioridade",value:l.prioridade,onChange:e=>c((0,n.A)((0,n.A)({},l),{},{prioridade:e.target.value})),className:"w-full bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 text-gray-900 dark:text-white rounded-full px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-[#1D9BF0] transition-colors appearance-none",required:!0,children:[(0,k.jsx)("option",{value:"",className:"bg-white dark:bg-gray-800",children:"Selecione a prioridade"}),(0,k.jsx)("option",{value:"baixa",className:"bg-white dark:bg-gray-800",children:"Baixa"}),(0,k.jsx)("option",{value:"media",className:"bg-white dark:bg-gray-800",children:"M\xe9dia"}),(0,k.jsx)("option",{value:"alta",className:"bg-white dark:bg-gray-800",children:"Alta"})]})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{htmlFor:"funcionarios",className:"block text-sm font-medium text-gray-500 dark:text-gray-400 mb-1",children:"Funcion\xe1rios Respons\xe1veis"}),(0,k.jsxs)("div",{className:"space-y-3",children:[(0,k.jsx)("div",{className:"relative",children:(0,k.jsxs)("select",{id:"funcionarios",value:"",onChange:e=>{const t=e.target.value;if(t&&!l.funcionariosIds.includes(t)){const e=o.find(e=>e.id===t);e&&(c((0,n.A)((0,n.A)({},l),{},{funcionariosIds:[...l.funcionariosIds,t]})),u([...d,e]))}e.target.value=""},className:"w-full bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 text-gray-900 dark:text-white rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-[#1D9BF0] transition-colors",required:0===l.funcionariosIds.length,children:[(0,k.jsx)("option",{value:"",className:"bg-white dark:bg-gray-800",children:"Selecione os funcion\xe1rios"}),o.filter(e=>!l.funcionariosIds.includes(e.id)).sort((e,t)=>(e.nome||e.username||"").localeCompare(t.nome||t.username||"")).map(e=>(0,k.jsx)("option",{value:e.id,className:"bg-white dark:bg-gray-800 p-2",children:e.nome||e.username||e.email||"Sem nome"},e.id))]})}),d.length>0&&(0,k.jsx)("div",{className:"flex flex-wrap gap-2",children:d.map(e=>(0,k.jsxs)("div",{className:"inline-flex items-center gap-1 px-3 py-1 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-full text-gray-900 dark:text-white text-sm",children:[e.nome||e.username||e.email||"Sem nome",(0,k.jsx)("button",{type:"button",onClick:()=>{c((0,n.A)((0,n.A)({},l),{},{funcionariosIds:l.funcionariosIds.filter(t=>t!==e.id)})),u(d.filter(t=>t.id!==e.id))},className:"ml-1 p-1 hover:text-red-500 rounded-full transition-colors",children:(0,k.jsx)(Id,{className:"w-3 h-3"})})]},e.id))})]})]}),(0,k.jsxs)("div",{className:"flex justify-end gap-3 mt-6",children:[(0,k.jsx)("button",{type:"button",onClick:r,className:"px-4 py-2 text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-white transition-colors",children:"Cancelar"}),(0,k.jsx)("button",{type:"submit",disabled:h,className:"px-4 py-2 bg-blue-500 dark:bg-[#1D9BF0] text-gray-900 dark:text-white rounded-lg hover:bg-blue-600 dark:hover:bg-[#1a8cd8] transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:h?"Criando...":"Criar Tarefa"})]})]})]}),f&&(0,k.jsx)(Pk,{onSelect:e=>{c((0,n.A)((0,n.A)({},l),{},{titulo:e.titulo,descricao:e.descricao,prioridade:e.prioridade})),g(!1)},onClose:()=>g(!1)})]})},Rk=t=>{var r;let{tarefa:a,onClose:n,onConcluir:s,readOnly:i=!1}=t;const{usuario:o}=Nt(),{showToast:l}=_(),[c,d]=e.useState(0),[u,h]=e.useState(!1);e.useEffect(()=>{if(!a.dataInicio||"em_andamento"!==a.status)return;const e=()=>{const e=new Date(a.dataInicio);let t=new Date-e;return a.tempoPausado&&(t-=a.tempoPausado),t};d(e());const t=setInterval(()=>{d(e())},1e3);return()=>clearInterval(t)},[a]);const m=e=>{if(!e)return"-";const t=new Date(e);return new Intl.DateTimeFormat("pt-BR",{dateStyle:"medium",timeStyle:"short"}).format(t)},f=e=>{if(!e)return"-";const t=Math.floor(e/1e3),r=Math.floor(t/60),a=Math.floor(r/60);return a>0?"".concat(a,"h ").concat(r%60,"m"):r>0?"".concat(r,"m ").concat(t%60,"s"):"".concat(t,"s")};return(0,k.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:(0,k.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 w-full max-w-2xl relative max-h-[90vh] overflow-y-auto",children:[(0,k.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,k.jsx)("h2",{className:"text-xl font-bold text-gray-900 dark:text-white",children:a.titulo}),(0,k.jsxs)("div",{className:"flex items-center gap-2",children:[!i&&(0,k.jsxs)(k.Fragment,{children:[o.nivel>=jt.FUNCIONARIO&&"concluida"!==a.status&&(0,k.jsxs)("button",{onClick:()=>null===s||void 0===s?void 0:s(a),className:"px-4 py-2 bg-blue-500 dark:bg-[#1D9BF0] text-gray-900 dark:text-white rounded-full hover:bg-blue-600 dark:hover:bg-[#1a8cd8] transition-colors flex items-center gap-2",children:[(0,k.jsx)(Ld,{className:"w-4 h-4"}),"Concluir e Avaliar"]}),Tt(o.nivel)&&(0,k.jsx)("button",{onClick:async()=>{o.nivel<jt.SUPERVISOR||h(!0)},className:"p-2 text-red-500 hover:bg-red-500/10 rounded-full transition-colors",title:"Excluir tarefa",children:(0,k.jsx)(nw,{className:"w-5 h-5"})})]}),(0,k.jsx)("button",{onClick:n,className:"p-2 text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-white hover:bg-white/10 rounded-full transition-colors",title:"Fechar",children:(0,k.jsx)(Id,{className:"w-5 h-5"})})]})]}),(0,k.jsxs)("div",{className:"space-y-6",children:[(0,k.jsxs)("div",{className:"flex flex-wrap gap-3",children:[(0,k.jsx)("span",{className:"px-3 py-1 rounded-full text-sm font-medium ".concat("pendente"===a.status?"bg-yellow-500/10 text-yellow-500":"em_andamento"===a.status?"bg-blue-500/10 text-blue-500":"pausada"===a.status?"bg-orange-500/10 text-orange-500":"bg-green-500/10 text-green-500"),children:"pendente"===a.status?"Pendente":"em_andamento"===a.status?"Em Andamento":"pausada"===a.status?"Pausada":"Conclu\xedda"}),(0,k.jsxs)("span",{className:"px-3 py-1 rounded-full text-sm font-medium ".concat("alta"===a.prioridade?"bg-red-500/10 text-red-500":"media"===a.prioridade?"bg-yellow-500/10 text-yellow-500":"bg-green-500/10 text-green-500"),children:["Prioridade ",a.prioridade.charAt(0).toUpperCase()+a.prioridade.slice(1)]})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("h3",{className:"text-sm font-medium text-gray-500 dark:text-gray-400 mb-2",children:"Descri\xe7\xe3o"}),(0,k.jsx)("p",{className:"text-gray-900 dark:text-white whitespace-pre-wrap",children:a.descricao.split(/(@\w+)/).map((e,t)=>e.startsWith("@")?(0,k.jsx)("span",{className:"text-blue-600 dark:text-[#60A5FA]",children:e},t):e)})]}),(0,k.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,k.jsxs)("div",{children:[(0,k.jsx)("h3",{className:"text-sm font-medium text-gray-500 dark:text-gray-400 mb-2",children:"Datas"}),(0,k.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,k.jsxs)("p",{children:[(0,k.jsx)("span",{className:"text-gray-500 dark:text-gray-400",children:"Cria\xe7\xe3o: "}),(0,k.jsx)("span",{className:"text-gray-900 dark:text-white",children:m(a.dataCriacao)})]}),a.dataInicio&&(0,k.jsxs)("p",{children:[(0,k.jsx)("span",{className:"text-gray-500 dark:text-gray-400",children:"In\xedcio: "}),(0,k.jsx)("span",{className:"text-gray-900 dark:text-white",children:m(a.dataInicio)})]}),"concluida"===a.status&&(0,k.jsxs)("p",{children:[(0,k.jsx)("span",{className:"text-gray-500 dark:text-gray-400",children:"Conclus\xe3o: "}),(0,k.jsx)("span",{className:"text-gray-900 dark:text-white",children:m(a.dataConclusao)})]})]})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("h3",{className:"text-sm font-medium text-gray-500 dark:text-gray-400 mb-2",children:"concluida"===a.status?"Tempo Total":"Tempo Decorrido"}),(0,k.jsx)("p",{className:"text-gray-900 dark:text-white",children:"concluida"===a.status?f(a.tempoTotal):"em_andamento"===a.status?f(c):f(a.tempoPausado||0)})]})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("h3",{className:"text-sm font-medium text-gray-500 dark:text-gray-400 mb-2",children:"Funcion\xe1rios Atribu\xeddos"}),(0,k.jsx)("div",{className:"flex flex-wrap gap-2 mb-2",children:null===(r=a.funcionarios)||void 0===r?void 0:r.map(e=>(0,k.jsx)("span",{className:"bg-white dark:bg-gray-700 px-3 py-1 rounded-full text-gray-900 dark:text-white text-sm",children:e.nome},e.nome))})]}),"concluida"===a.status&&(0,k.jsxs)("div",{className:"space-y-4",children:[(0,k.jsx)("h3",{className:"text-sm font-medium text-gray-500 dark:text-gray-400 mb-2",children:"Avalia\xe7\xf5es"}),a.avaliacaoFuncionario&&(0,k.jsxs)("div",{className:"border border-gray-300 dark:border-gray-600 rounded-lg p-4",children:[(0,k.jsx)("div",{className:"text-gray-500 dark:text-gray-400 text-sm mb-2",children:"Avalia\xe7\xe3o do Funcion\xe1rio"}),(0,k.jsx)("div",{className:"flex items-center gap-1 mb-2",children:[1,2,3,4,5].map(e=>(0,k.jsx)(Ld,{className:"w-5 h-5 ".concat(e<=a.avaliacaoFuncionario?"text-yellow-500 fill-yellow-500":"text-[#38444D]")},e))}),a.comentarioFuncionario&&(0,k.jsx)("p",{className:"text-white text-sm",children:a.comentarioFuncionario})]}),a.avaliacaoSupervisor&&o.nivel>jt.FUNCIONARIO&&(0,k.jsxs)("div",{className:"border border-gray-300 dark:border-gray-600 rounded-lg p-4",children:[(0,k.jsx)("div",{className:"text-gray-500 dark:text-gray-400 text-sm mb-2",children:"Avalia\xe7\xe3o do Supervisor"}),(0,k.jsx)("div",{className:"flex items-center gap-1 mb-2",children:[1,2,3,4,5].map(e=>(0,k.jsx)(Ld,{className:"w-5 h-5 ".concat(e<=a.avaliacaoSupervisor?"text-yellow-500 fill-yellow-500":"text-[#38444D]")},e))}),a.comentarioSupervisor&&(0,k.jsx)("p",{className:"text-white text-sm",children:a.comentarioSupervisor})]}),Tt(o.nivel)&&!a.avaliacaoSupervisor&&(0,k.jsxs)("button",{onClick:()=>null===s||void 0===s?void 0:s(a),className:"w-full px-4 py-2 bg-blue-500 dark:bg-[#1D9BF0] text-gray-900 dark:text-white rounded-full hover:bg-blue-600 dark:hover:bg-[#1a8cd8] transition-colors flex items-center justify-center gap-2 mt-4",children:[(0,k.jsx)(Ld,{className:"w-4 h-4"}),"Avaliar Desempenho"]})]})]}),(0,k.jsx)(ConfirmDialog,{isOpen:u,title:"Excluir Tarefa",message:"Tem certeza que deseja excluir esta tarefa? Esta a\xe7\xe3o n\xe3o pode ser desfeita.",onConfirm:async()=>{try{await deleteDoc(doc(db,"tarefas",a.id)),l("Tarefa exclu\xedda com sucesso!","success"),n()}catch(e){console.error("Erro ao excluir tarefa:",e),l("Erro ao excluir tarefa","error")}h(!1)},onCancel:()=>h(!1)})]})})},Ok=t=>{let{isOpen:r,onClose:a,onConfirm:n,titulo:s,tipoAvaliacao:i="colaborador"}=t;const[o,l]=(0,e.useState)(0),[c,d]=(0,e.useState)(0),[u,h]=(0,e.useState)("");return r?(0,k.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:(0,k.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 w-full max-w-md",children:[(0,k.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,k.jsx)("h3",{className:"text-xl font-bold text-white",children:s}),(0,k.jsx)("button",{onClick:a,className:"p-2 text-gray-500 dark:text-gray-400 hover:bg-[#283340] rounded-full transition-colors",children:(0,k.jsx)(Id,{className:"w-5 h-5"})})]}),(0,k.jsxs)("form",{onSubmit:e=>{e.preventDefault(),0!==o?u.trim()?(n(o,u),l(0),h(""),a()):alert("Por favor, adicione um coment\xe1rio"):alert("Por favor, selecione uma avalia\xe7\xe3o")},className:"space-y-6",children:[(0,k.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,k.jsx)("span",{className:"text-gray-500 dark:text-gray-400 text-sm",children:"colaborador"===i?"Como voc\xea avalia esta tarefa?":"Como voc\xea avalia o desempenho do colaborador?"}),(0,k.jsx)("div",{className:"flex gap-1",children:[1,2,3,4,5].map(e=>(0,k.jsx)("button",{type:"button",onClick:()=>l(e),onMouseEnter:()=>d(e),onMouseLeave:()=>d(0),className:"p-1 transition-transform hover:scale-110",children:(0,k.jsx)(Ld,{className:"w-8 h-8 ".concat((c?e<=c:e<=o)?"text-yellow-500 fill-yellow-500":"text-[#38444D]")})},e))})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm text-gray-500 dark:text-gray-400 mb-2",children:"colaborador"===i?"Compartilhe sua experi\xeancia com esta tarefa":"Deixe um feedback sobre o desempenho"}),(0,k.jsx)("textarea",{value:u,onChange:e=>h(e.target.value),className:"w-full h-32 px-4 py-2 bg-white dark:bg-gray-700 text-gray-900 dark:text-white border border-gray-300 dark:border-gray-600 rounded-lg resize-none focus:border-blue-500 dark:border-[#1D9BF0] focus:ring-1 focus:ring-blue-500 dark:focus:ring-[#1D9BF0] outline-none transition-colors",placeholder:"colaborador"===i?"Descreva sua experi\xeancia, dificuldades encontradas e aprendizados...":"Deixe um feedback construtivo sobre o trabalho realizado..."})]}),(0,k.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,k.jsx)("button",{type:"button",onClick:a,className:"px-4 py-2 text-gray-500 dark:text-gray-400 hover:bg-[#283340] rounded-full transition-colors",children:"Cancelar"}),(0,k.jsx)("button",{type:"submit",className:"px-4 py-2 bg-blue-500 dark:bg-[#1D9BF0] text-gray-900 dark:text-white rounded-full hover:bg-blue-600 dark:hover:bg-[#1a8cd8] transition-colors disabled:opacity-50 disabled:cursor-not-allowed",disabled:0===o||!u.trim(),children:"Enviar Avalia\xe7\xe3o"})]})]})]})}):null},Bk=e=>{let{isOpen:t,title:r,message:a,onConfirm:n,onCancel:s}=e;return t?(0,k.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[60]",children:(0,k.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 w-full max-w-md relative",children:[(0,k.jsxs)("div",{className:"flex items-start mb-6",children:[(0,k.jsx)("div",{className:"flex-shrink-0 mr-4",children:(0,k.jsx)(rw,{className:"w-6 h-6 text-red-500"})}),(0,k.jsxs)("div",{children:[(0,k.jsx)("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:r}),(0,k.jsx)("p",{className:"text-gray-500 dark:text-gray-400",children:a})]})]}),(0,k.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,k.jsx)("button",{onClick:s,className:"px-4 py-2 text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-white transition-colors",children:"Cancelar"}),(0,k.jsx)("button",{onClick:n,className:"px-4 py-2 bg-red-500 text-gray-900 dark:text-white rounded-lg hover:bg-red-600 transition-colors",children:"Excluir"})]})]})}):null},zk=t=>{let{funcionarios:r=[],showOnlyUserTasks:a=!1,showAddButton:i=!0,userFilter:o=null,readOnly:l=!1,defaultFiltros:c=null}=t;const{usuario:d}=Nt(),{showToast:u}=_(),[h,m]=(0,e.useState)([]),[f,g]=(0,e.useState)(!1),[p,x]=(0,e.useState)((null===c||void 0===c?void 0:c.status)||"todas"),[y,v]=(0,e.useState)((null===c||void 0===c?void 0:c.periodo)||"todos"),[b,N]=(0,e.useState)((null===c||void 0===c?void 0:c.avaliacao)||"todas"),[j,S]=(0,e.useState)(null),[E,A]=(0,e.useState)({}),[C,T]=(0,e.useState)(!1),[F,L]=(0,e.useState)(null),[M,R]=(0,e.useState)(!1),[O,B]=(0,e.useState)(10),[z,U]=(0,e.useState)("");(0,e.useEffect)(()=>{const e=(0,s.P)((0,s.collection)(P.db,"tarefas"),(0,s.My)("dataCriacao","desc")),t=(0,s.aQ)(e,e=>{const t=e.docs.map(e=>(0,n.A)({id:e.id},e.data()));m(t);const r={};t.forEach(e=>{if("em_andamento"===e.status&&e.dataInicio){const t=new Date(e.dataInicio);let a=new Date-t;e.tempoPausado&&(a-=e.tempoPausado),r[e.id]=a}}),A(r)});return()=>t()},[]),(0,e.useEffect)(()=>{const e=setInterval(()=>{A(e=>{const t=(0,n.A)({},e);return h.forEach(e=>{if("em_andamento"===e.status&&e.dataInicio){const r=new Date(e.dataInicio);let a=new Date-r;e.tempoPausado&&(a-=e.tempoPausado),t[e.id]=a}}),t})},1e3);return()=>clearInterval(e)},[h]);const V=async e=>{try{await(0,s.updateDoc)((0,s.doc)(P.db,"tarefas",e),{status:"em_andamento",dataInicio:(new Date).toISOString()}),u("Tarefa iniciada com sucesso!","success")}catch(t){console.error("Erro ao iniciar tarefa:",t),u("Erro ao iniciar tarefa","error")}},q=async()=>{if(F)try{const e=(0,s.doc)(P.db,"tarefas",F.id),t=(e=>{if(!e.dataInicio)return 0;const t=new Date(e.dataInicio);let r=new Date-t;return e.tempoPausado&&(r-=e.tempoPausado),r})(F);await(0,s.updateDoc)(e,{status:"concluida",dataConclusao:(new Date).toISOString(),tempoTotal:t}),((null===d||void 0===d?void 0:d.nivel)===jt.FUNCIONARIO||Tt(null===d||void 0===d?void 0:d.nivel))&&T(!0),u("Tarefa conclu\xedda com sucesso!","success")}catch(e){console.error("Erro ao concluir tarefa:",e),u("Erro ao concluir tarefa","error"),L(null)}},H=e=>{if(!e)return"-";const t=Math.floor(e/1e3),r=Math.floor(t/60),a=Math.floor(r/60);return a>0?"".concat(a,"h ").concat(r%60,"m"):r>0?"".concat(r,"m ").concat(t%60,"s"):"".concat(t,"s")},{canViewAllSectors:G}=cu(),W=G,K=(0,e.useMemo)(()=>W?h:Dt.filterBySector(h,d),[h,d,W]).filter(e=>{if(a&&!(e=>{var t,r,n;if(!d)return!1;const s=null===d||void 0===d||null===(t=d.nome)||void 0===t?void 0:t.toLowerCase(),i=null===d||void 0===d?void 0:d.id,l=null===d||void 0===d||null===(r=d.email)||void 0===r?void 0:r.toLowerCase(),c=e=>{if(!e)return!1;const t=String(e).toLowerCase();return t===i||!(!s||t!==s)||!(!s||!t.includes(s))||!(!s||!s.includes(t))||!(!l||t!==l)};if(o){var u;const t=o.toLowerCase(),r=e=>!!e&&String(e).toLowerCase().includes(t);return r(e.funcionario)||r(e.responsavel)||(null===(u=e.funcionariosIds)||void 0===u?void 0:u.some(r))}const h=null===(n=e.funcionariosIds)||void 0===n?void 0:n.some(c),m=c(e.responsavel),f=c(e.funcionario),g=h||m||f;return!g&&a&&console.log("\u274c Tarefa N\xc3O atribu\xedda ao usu\xe1rio:",{tarefaTitulo:e.titulo,funcionariosIds:e.funcionariosIds,funcionario:e.funcionario,responsavel:e.responsavel,usuarioId:i,usuarioNome:s,usuarioEmail:l}),g})(e))return!1;if("todas"!==p&&e.status!==p)return!1;if("todos"!==y&&!((e,t)=>{if(!e)return!1;const r=new Date(e),a=new Date;switch(t){case"hoje":return r.getDate()===a.getDate()&&r.getMonth()===a.getMonth()&&r.getFullYear()===a.getFullYear();case"semana":const e=new Date(a);return e.setDate(a.getDate()-7),r>=e;case"mes":const t=new Date(a);return t.setMonth(a.getMonth()-1),r>=t;default:return!0}})(e.dataCriacao,y))return!1;if("todas"!==b){const t=Number(e.avaliacaoSupervisor);switch(b){case"excelente":if(t<5)return!1;break;case"boa":if(t<4||t>=5)return!1;break;case"regular":if(t<3||t>=4)return!1;break;case"ruim":if(t>=3)return!1;break;case"pendente":if("concluida"===e.status&&t)return!1}}if(z){var t,r;const a=z.toLowerCase();return e.titulo.toLowerCase().includes(a)||(null===(t=e.descricao)||void 0===t?void 0:t.toLowerCase().includes(a))||(null===(r=e.funcionario)||void 0===r?void 0:r.toLowerCase().includes(a))}return!0}).slice(0,O);return(0,k.jsxs)("div",{className:"space-y-6",children:[!W&&(null===d||void 0===d?void 0:d.setor)&&(0,k.jsxs)("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-blue-900/20 dark:to-indigo-900/20 border border-blue-200 dark:border-blue-700 rounded-xl p-4 flex items-center gap-3 shadow-sm",children:[(0,k.jsx)("div",{className:"p-2 bg-blue-100 dark:bg-blue-800/50 rounded-lg",children:(0,k.jsx)(I,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"})}),(0,k.jsxs)("p",{className:"text-sm text-blue-800 dark:text-blue-200",children:[(0,k.jsx)("strong",{children:"Visualiza\xe7\xe3o por setor:"})," Voc\xea est\xe1 vendo apenas as tarefas do setor ",(0,k.jsx)("strong",{children:d.setor}),"."]})]}),(0,k.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg border border-gray-100 dark:border-gray-700 p-6",children:(0,k.jsxs)("div",{className:"flex flex-wrap gap-4",children:[(0,k.jsxs)("div",{className:"relative flex-1 min-w-[250px]",children:[(0,k.jsx)("div",{className:"absolute left-3 top-1/2 -translate-y-1/2 p-1.5 bg-blue-50 dark:bg-blue-900/30 rounded-lg",children:(0,k.jsx)(Ft,{className:"w-4 h-4 text-blue-600 dark:text-blue-400"})}),(0,k.jsx)("input",{type:"text",placeholder:"\ud83d\udd0d Buscar tarefas...",value:z,onChange:e=>U(e.target.value),className:"w-full h-12 pl-14 pr-4 border-2 border-gray-200 dark:border-gray-600 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:focus:ring-blue-400 dark:focus:border-blue-400 dark:bg-gray-700 dark:text-white transition-all placeholder:text-gray-400 dark:placeholder:text-gray-500"})]}),(0,k.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 w-full",children:[(0,k.jsxs)("select",{value:p,onChange:e=>x(e.target.value),className:"w-full h-12 border-2 border-gray-200 dark:border-gray-600 rounded-xl px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:focus:ring-blue-400 dark:focus:border-blue-400 dark:bg-gray-700 dark:text-white hover:bg-gray-50 dark:hover:bg-gray-600 transition-all cursor-pointer",children:[(0,k.jsx)("option",{value:"todas",children:"Todos os status"}),(0,k.jsx)("option",{value:"pendente",children:"\u23f3 Pendentes"}),(0,k.jsx)("option",{value:"em_andamento",children:"\u26a1 Em andamento"}),(0,k.jsx)("option",{value:"pausada",children:"\u23f8\ufe0f Pausadas"}),(0,k.jsx)("option",{value:"concluida",children:"\u2705 Conclu\xeddas"})]}),(0,k.jsxs)("select",{value:y,onChange:e=>v(e.target.value),className:"w-full h-12 border-2 border-gray-200 dark:border-gray-600 rounded-xl px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:focus:ring-blue-400 dark:focus:border-blue-400 dark:bg-gray-700 dark:text-white hover:bg-gray-50 dark:hover:bg-gray-600 transition-all cursor-pointer",children:[(0,k.jsx)("option",{value:"todos",children:"Todos os per\xedodos"}),(0,k.jsx)("option",{value:"hoje",children:"\ud83d\udcc5 Hoje"}),(0,k.jsx)("option",{value:"semana",children:"\ud83d\udcc6 \xdaltimos 7 dias"}),(0,k.jsx)("option",{value:"mes",children:"\ud83d\udcca \xdaltimo m\xeas"})]}),(0,k.jsxs)("select",{value:b,onChange:e=>N(e.target.value),className:"w-full border border-gray-300 dark:border-gray-600 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-[#1D9BF0] dark:bg-gray-700 dark:text-white hover:bg-gray-50 dark:hover:bg-[#2C3640]",children:[(0,k.jsx)("option",{value:"todas",children:"Todas as avalia\xe7\xf5es"}),(0,k.jsx)("option",{value:"excelente",children:"Excelente (5\u2605)"}),(0,k.jsx)("option",{value:"boa",children:"Boa (4\u2605)"}),(0,k.jsx)("option",{value:"regular",children:"Regular (3\u2605)"}),(0,k.jsx)("option",{value:"ruim",children:"Ruim (\u2264 2\u2605)"}),(0,k.jsx)("option",{value:"pendente",children:"Pendente de avalia\xe7\xe3o"})]}),i&&Tt(d.nivel)&&(0,k.jsxs)("button",{onClick:()=>g(!0),className:"flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white rounded-xl shadow-lg hover:shadow-xl hover:shadow-blue-500/30 transition-all duration-200 transform hover:scale-105 font-semibold",children:[(0,k.jsx)(D,{className:"w-5 h-5"})," Nova Tarefa"]})]})]})}),(0,k.jsx)("div",{className:"bg-gradient-to-br from-gray-50 to-gray-100 dark:from-gray-900 dark:to-gray-800 rounded-2xl shadow-inner border border-gray-200 dark:border-gray-700 p-6",children:0===K.length?(0,k.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-12 text-center border-2 border-dashed border-gray-300 dark:border-gray-600 shadow-sm",children:[(0,k.jsx)("div",{className:"p-4 bg-gray-100 dark:bg-gray-700 rounded-full w-20 h-20 flex items-center justify-center mx-auto mb-4",children:(0,k.jsx)(xu,{className:"w-10 h-10 text-gray-400 dark:text-gray-500"})}),(0,k.jsx)("p",{className:"text-lg font-medium text-gray-600 dark:text-gray-300 mb-1",children:"Nenhuma tarefa encontrada"}),(0,k.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:z?"Tente ajustar sua busca":o?"N\xe3o h\xe1 tarefas para ".concat(o):"Crie uma nova tarefa para come\xe7ar"})]}):(0,k.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-5",children:K.map(e=>{const t=(e=>{switch(e.status){case"pendente":return{icon:(0,k.jsx)(xu,{className:"w-3 h-3 mr-1"}),text:"Pendente",bgColor:"bg-yellow-100",textColor:"text-yellow-800"};case"em_andamento":return{icon:(0,k.jsx)(_k,{className:"w-3 h-3 mr-1"}),text:"Em Andamento",bgColor:"bg-blue-100",textColor:"text-blue-800"};case"pausada":return{icon:(0,k.jsx)(Ek,{className:"w-3 h-3 mr-1"}),text:"Pausada",bgColor:"bg-orange-100",textColor:"text-orange-800"};case"concluida":return{icon:(0,k.jsx)(Fd,{className:"w-3 h-3 mr-1"}),text:"Conclu\xedda",bgColor:"bg-green-100",textColor:"text-green-800"};default:return{icon:(0,k.jsx)(w,{className:"w-3 h-3 mr-1"}),text:"Status Desconhecido",bgColor:"bg-gray-100",textColor:"text-gray-800"}}})(e);return(0,k.jsx)("div",{className:"group bg-white dark:bg-gray-800 rounded-2xl p-6 border-2 border-gray-200 dark:border-gray-700 hover:border-blue-500 dark:hover:border-blue-400 hover:shadow-xl hover:shadow-blue-500/10 dark:hover:shadow-blue-400/10 transition-all duration-300 cursor-pointer transform hover:-translate-y-1",onClick:()=>S(e),children:(0,k.jsxs)("div",{children:[(0,k.jsx)("div",{className:"flex justify-between items-start mb-4",children:(0,k.jsxs)("div",{className:"flex-1",children:[(0,k.jsx)("div",{className:"flex items-center gap-2 mb-3",children:(0,k.jsx)("h3",{className:"text-lg font-bold text-gray-900 dark:text-white group-hover:text-blue-600 dark:group-hover:text-blue-400 transition-colors",children:e.titulo})}),(0,k.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,k.jsxs)("div",{className:"flex items-center gap-1.5 px-3 py-1.5 rounded-full font-medium ".concat(t.bgColor," ").concat(t.textColor),children:[t.icon,(0,k.jsx)("span",{children:t.text})]}),!l&&"em_andamento"===e.status&&(0,k.jsxs)("div",{className:"flex items-center gap-1.5 px-3 py-1.5 rounded-full bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 font-medium",children:[(0,k.jsx)(xu,{className:"w-3.5 h-3.5"}),H(E[e.id])]})]})]})}),e.descricao&&(0,k.jsx)("div",{className:"mb-4 p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg border border-gray-200 dark:border-gray-600",children:(0,k.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-300 line-clamp-2 leading-relaxed",children:e.descricao})}),(0,k.jsxs)("div",{className:"space-y-4",children:[(0,k.jsx)("div",{children:(0,k.jsx)("div",{className:"flex flex-wrap gap-2",children:e.funcionarios&&e.funcionarios.length>0?e.funcionarios.map((e,t)=>(0,k.jsxs)("div",{className:"inline-flex items-center gap-1.5 px-3 py-1.5 bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-blue-900/30 dark:to-indigo-900/30 border border-blue-300 dark:border-blue-600 rounded-full text-xs font-medium text-blue-700 dark:text-blue-300 shadow-sm",children:[(0,k.jsx)(mu,{className:"w-3.5 h-3.5"}),e.nome||e.username||e.email||"Sem nome"]},t)):(e.funcionariosIds||[]).map((e,t)=>{const a=r.find(t=>t.id===e),n=a?a.nome||a.username||a.email||"Sem nome":e;return(0,k.jsxs)("div",{className:"inline-flex items-center gap-1.5 px-3 py-1.5 bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-blue-900/30 dark:to-indigo-900/30 border border-blue-300 dark:border-blue-600 rounded-full text-xs font-medium text-blue-700 dark:text-blue-300 shadow-sm",children:[(0,k.jsx)(mu,{className:"w-3.5 h-3.5"}),n]},t)})})}),e.prioridade&&(0,k.jsx)("div",{className:"flex items-center gap-2 mt-4",children:(0,k.jsx)("span",{className:"px-3 py-1.5 rounded-full text-xs font-bold ".concat("alta"===e.prioridade?"bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-300 border border-red-300 dark:border-red-700":"m\xe9dia"===e.prioridade?"bg-yellow-100 dark:bg-yellow-900/30 text-yellow-700 dark:text-yellow-300 border border-yellow-300 dark:border-yellow-700":"bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300 border border-green-300 dark:border-green-700"),children:"alta"===e.prioridade?"\ud83d\udd25 Alta":"m\xe9dia"===e.prioridade?"\u26a1 M\xe9dia":"\u2713 Baixa"})}),"concluida"===e.status&&(0,k.jsxs)("div",{className:"space-y-2 mt-4",children:[e.avaliacaoSupervisor&&(0,k.jsxs)("div",{className:"flex items-center gap-1",children:[(0,k.jsx)("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Supervisor:"}),(0,k.jsx)("div",{className:"flex items-center",children:[...Array(5)].map((t,r)=>(0,k.jsx)(Ld,{className:"w-3.5 h-3.5 ".concat(r<e.avaliacaoSupervisor?"text-yellow-400 fill-yellow-400":"text-[#38444D]")},r))})]}),e.avaliacaoFuncionario&&(0,k.jsxs)("div",{className:"flex items-center gap-1",children:[(0,k.jsx)("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Funcion\xe1rio:"}),(0,k.jsx)("div",{className:"flex items-center",children:[...Array(5)].map((t,r)=>(0,k.jsx)(Ld,{className:"w-3.5 h-3.5 ".concat(r<e.avaliacaoFuncionario?"text-yellow-400 fill-yellow-400":"text-[#38444D]")},r))})]})]})]}),(0,k.jsx)("div",{className:"mt-4 text-sm text-gray-500 dark:text-gray-400",children:(0,k.jsxs)("div",{className:"flex items-center gap-1",children:[(0,k.jsx)(iu,{className:"w-4 h-4"}),(0,k.jsxs)("span",{children:["Criada em ",wu(e.dataCriacao)]})]})}),!l&&(0,k.jsxs)("div",{className:"mt-4 flex justify-end gap-2",children:["pendente"===e.status&&(0,k.jsxs)("button",{onClick:t=>{t.stopPropagation(),V(e.id)},className:"px-3 py-1 text-sm bg-blue-500 dark:bg-[#1D9BF0] text-gray-900 dark:text-white rounded-full flex items-center gap-1 hover:bg-blue-600 dark:hover:bg-[#1a8cd8] transition-colors",children:[(0,k.jsx)(_k,{className:"w-4 h-4"}),"Iniciar"]}),"em_andamento"===e.status&&(0,k.jsxs)(k.Fragment,{children:[(0,k.jsxs)("button",{onClick:t=>{t.stopPropagation(),(async e=>{try{const t=h.find(t=>t.id===e),r=t.tempoPausado||0,a=new Date-new Date(t.dataInicio);await(0,s.updateDoc)((0,s.doc)(P.db,"tarefas",e),{status:"pausada",dataPausa:(new Date).toISOString(),tempoPausado:r+a}),u("Tarefa pausada com sucesso!","success")}catch(t){console.error("Erro ao pausar tarefa:",t),u("Erro ao pausar tarefa","error")}})(e.id)},className:"px-3 py-1 text-sm bg-[#F7BE38] text-gray-900 dark:text-white rounded-full flex items-center gap-1 hover:bg-[#f0b730] transition-colors",children:[(0,k.jsx)(Ak,{className:"w-4 h-4"}),"Pausar"]}),(0,k.jsxs)("button",{onClick:t=>{t.stopPropagation(),L(e),q()},className:"px-3 py-1 text-sm bg-[#4CAF50] text-gray-900 dark:text-white rounded-full flex items-center gap-1 hover:bg-[#43a047] transition-colors",children:[(0,k.jsx)(Fd,{className:"w-4 h-4"}),"Concluir"]})]}),"pausada"===e.status&&(0,k.jsxs)("button",{onClick:t=>{t.stopPropagation(),V(e.id)},className:"px-3 py-1 text-sm bg-blue-500 dark:bg-[#1D9BF0] text-gray-900 dark:text-white rounded-full flex items-center gap-1 hover:bg-blue-600 dark:hover:bg-[#1a8cd8] transition-colors",children:[(0,k.jsx)(_k,{className:"w-4 h-4"}),"Retomar"]}),"concluida"===e.status&&!e.avaliacaoSupervisor&&Tt(null===d||void 0===d?void 0:d.nivel)&&(0,k.jsxs)("button",{onClick:t=>{t.stopPropagation(),L(e),T(!0)},className:"px-3 py-1 text-sm bg-blue-500 dark:bg-[#1D9BF0] text-gray-900 dark:text-white rounded-full flex items-center gap-1 hover:bg-blue-600 dark:hover:bg-[#1a8cd8] transition-colors",children:[(0,k.jsx)(Ld,{className:"w-4 h-4"}),"Avaliar"]})]})]})},e.id)})})}),O<h.length&&(0,k.jsx)("div",{className:"flex justify-center mt-8",children:(0,k.jsx)("button",{onClick:()=>B(e=>e+10),className:"px-8 py-3 text-blue-600 dark:text-blue-400 bg-white dark:bg-gray-800 border-2 border-blue-200 dark:border-blue-700 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-xl transition-all duration-200 font-medium shadow-sm hover:shadow-md transform hover:-translate-y-0.5",children:"Carregar mais tarefas"})}),f&&(0,k.jsx)(Mk,{onClose:()=>g(!1),funcionarios:r}),j&&(0,k.jsx)(Rk,{tarefa:j,onClose:()=>S(null),tempoDecorrido:E[j.id],onConcluir:l?void 0:()=>{L(j),q()}}),C&&F&&(0,k.jsx)(Ok,{isOpen:C,onClose:()=>{T(!1),L(null)},onConfirm:async(e,t)=>{if(F)try{const r=(0,s.doc)(P.db,"tarefas",F.id),a={};d.nivel===jt.FUNCIONARIO?(a.avaliacaoFuncionario=e,a.comentarioFuncionario=t):Tt(d.nivel)&&(a.avaliacaoSupervisor=e,a.comentarioSupervisor=t),await(0,s.updateDoc)(r,a),u("Avalia\xe7\xe3o registrada com sucesso!","success"),d.nivel===jt.FUNCIONARIO&&T(!1),L(null),S(null)}catch(r){console.error("Erro ao registrar avalia\xe7\xe3o:",r),u("Erro ao registrar avalia\xe7\xe3o","error")}},titulo:Tt(d.nivel)?"Avaliar Tarefa":"Autoavalia\xe7\xe3o",tipoAvaliacao:Tt(d.nivel)?"supervisor":"colaborador"}),M&&(0,k.jsx)(Bk,{message:"Tem certeza que deseja excluir esta tarefa?",onConfirm:async()=>{try{await(0,s.deleteDoc)((0,s.doc)(P.db,"tarefas",j.id)),u("Tarefa exclu\xedda com sucesso!","success"),S(null)}catch(e){console.error("Erro ao excluir tarefa:",e),u("Erro ao excluir tarefa","error")}R(!1)},onCancel:()=>R(!1)})]})},Uk=[{valor:"positiva",label:"Positiva",cor:"text-green-500 bg-green-500/20"},{valor:"negativa",label:"Negativa",cor:"text-red-500 bg-red-500/20"},{valor:"neutro",label:"Neutro",cor:"text-gray-500 bg-gray-500/20"},{valor:"melhoria",label:"Melhoria Necess\xe1ria",cor:"text-yellow-500 bg-yellow-500/20"},{valor:"destaque",label:"Destaque",cor:"text-purple-500 bg-purple-500/20"}],Vk=e=>Uk.find(t=>t.valor===e)||{valor:"outro",label:"Tarefa",cor:"text-[#1DA1F2] bg-[#1DA1F2]/20"};const qk=function(t){let{funcionario:r,pontosDesempenho:a=0}=t;const{usuario:i,loading:o}=Nt(),{showToast:l}=_(),[c,d]=(0,e.useState)(null),[u,h]=(0,e.useState)(!1),[m,f]=(0,e.useState)({mediaEstrelas:0,totalAvaliacoes:0,avaliacoesPositivas:0,avaliacoesNegativas:0,ultimaAvaliacao:null}),[g,p]=(0,e.useState)({tarefas:{total:0,media:0},desempenho:{total:0,media:0}}),[x,y]=(0,e.useState)([]),[v,b]=(0,e.useState)(!1),[w,N]=(0,e.useState)(0),j=new Date,S="".concat(String(j.getHours()).padStart(2,"0"),":").concat(String(j.getMinutes()).padStart(2,"0")),[E,A]=(0,e.useState)({data:j.toISOString().split("T")[0],hora:S,estrelas:0,comentario:"",tipo:"positiva",anonima:!1}),C=!o&&i&&i.nivel>=jt.SUPERVISOR,I=e=>2*e,T=async()=>{if(null!==r&&void 0!==r&&r.id)try{const e=(0,s.collection)(P.db,"avaliacoes"),t=(0,s.P)(e,(0,s._M)("funcionarioId","==",String(r.id)),(0,s._M)("tipo","==","avaliacao_supervisor"),(0,s._M)("status","==","ativa")),a=(await(0,s.GG)(t)).docs.map(e=>{const t=e.data(),r=new Date(t.data+"T"+(t.hora||"00:00"));return{id:e.id,data:t.data,hora:t.hora,dataCompleta:r,estrelas:Number(t.estrelas),comentario:t.comentario,supervisorNome:t.supervisorNome,supervisorCargo:t.supervisorCargo||"",tipo:t.tipo,origemAvaliacao:"avaliacao_supervisor"===t.tipo?"Avalia\xe7\xe3o de Desempenho":"Avalia\xe7\xe3o de Tarefa",status:t.status}});y(a);const n=a.reduce((e,t)=>{e.somaEstrelas+=t.estrelas,t.estrelas>=4&&e.avaliacoesPositivas++,t.estrelas<=2&&e.avaliacoesNegativas++;const r="avaliacao_supervisor"===t.tipo?"desempenho":"tarefas";e.porTipo[r]||(e.porTipo[r]={total:0,somaEstrelas:0}),e.porTipo[r].total++,e.porTipo[r].somaEstrelas+=t.estrelas;const a=new Date(t.data+"T"+(t.hora||"00:00"));return(!e.ultimaAvaliacao||a>new Date(e.ultimaAvaliacao.data+"T"+(e.ultimaAvaliacao.hora||"00:00")))&&(e.ultimaAvaliacao=t),e},{somaEstrelas:0,avaliacoesPositivas:0,avaliacoesNegativas:0,porTipo:{tarefas:{total:0,somaEstrelas:0},desempenho:{total:0,somaEstrelas:0}},ultimaAvaliacao:null});f({mediaEstrelas:a.length>0?n.somaEstrelas/a.length:0,totalAvaliacoes:a.length,avaliacoesPositivas:n.avaliacoesPositivas,avaliacoesNegativas:n.avaliacoesNegativas,ultimaAvaliacao:n.ultimaAvaliacao}),p({tarefas:{total:n.porTipo.tarefas.total,media:n.porTipo.tarefas.total>0?n.porTipo.tarefas.somaEstrelas/n.porTipo.tarefas.total:0},desempenho:{total:n.porTipo.desempenho.total,media:n.porTipo.desempenho.total>0?n.porTipo.desempenho.somaEstrelas/n.porTipo.desempenho.total:0}})}catch(e){console.error("Erro ao carregar avalia\xe7\xf5es:",e)}};return(0,e.useEffect)(()=>{null!==r&&void 0!==r&&r.id&&T()},[null===r||void 0===r?void 0:r.id]),(0,k.jsxs)("div",{className:"space-y-8",children:[(0,k.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,k.jsx)("h2",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Avalia\xe7\xf5es"}),!o&&C&&(0,k.jsxs)("button",{onClick:()=>{i?b(!0):alert("Por favor, fa\xe7a login para adicionar uma avalia\xe7\xe3o")},className:"px-4 py-2 bg-blue-500 dark:bg-[#1D9BF0] text-gray-900 dark:text-white rounded-full hover:bg-blue-600 dark:hover:bg-[#1a8cd8] transition-colors flex items-center gap-2",children:[(0,k.jsx)(D,{className:"w-4 h-4"}),"Nova Avalia\xe7\xe3o"]})]}),(0,k.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-600",children:[(0,k.jsxs)("h3",{className:"text-lg font-semibold mb-4 text-gray-900 dark:text-white flex items-center gap-2",children:[(0,k.jsx)(ou,{className:"w-5 h-5 text-blue-500 dark:text-[#1D9BF0]"}),"Avalia\xe7\xe3o Geral"]}),(0,k.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,k.jsxs)("div",{className:"flex items-center gap-4",children:[(0,k.jsx)("div",{className:"flex gap-1",children:[1,2,3,4,5].map(e=>(0,k.jsx)(Ld,{className:"w-6 h-6 ".concat(e<=Math.round(m.mediaEstrelas)?"text-yellow-500 fill-yellow-500":"text-gray-300 dark:text-gray-600")},e))}),(0,k.jsxs)("div",{children:[(0,k.jsx)("div",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:m.mediaEstrelas.toFixed(1)}),(0,k.jsxs)("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:[m.totalAvaliacoes," ",1===m.totalAvaliacoes?"avalia\xe7\xe3o":"avalia\xe7\xf5es"]}),(0,k.jsxs)("div",{className:"text-sm font-medium text-blue-500 dark:text-[#1D9BF0]",children:[a," pontos"]})]})]}),(0,k.jsx)("div",{className:"flex items-center gap-4",children:(0,k.jsxs)("div",{className:"flex-1",children:[(0,k.jsxs)("div",{className:"flex justify-between text-sm mb-1",children:[(0,k.jsx)("span",{className:"text-red-600 dark:text-red-400",children:"Negativas"}),(0,k.jsx)("span",{className:"text-green-600 dark:text-green-400",children:"Positivas"})]}),(0,k.jsx)("div",{className:"h-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden",children:(0,k.jsx)("div",{className:"h-full bg-green-500",style:{width:"".concat(m.totalAvaliacoes>0?m.avaliacoesPositivas/m.totalAvaliacoes*100:0,"%")}})})]})})]})]}),(0,k.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,k.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-600",children:[(0,k.jsxs)("h4",{className:"text-base font-medium mb-3 text-gray-900 dark:text-white flex items-center gap-2",children:[(0,k.jsx)(Pd,{className:"w-4 h-4 text-blue-500 dark:text-[#1D9BF0]"}),"Avalia\xe7\xf5es de Tarefas"]}),(0,k.jsxs)("div",{className:"flex items-center gap-3",children:[(0,k.jsx)("div",{className:"flex gap-1",children:[1,2,3,4,5].map(e=>(0,k.jsx)(Ld,{className:"w-4 h-4 ".concat(e<=Math.round(g.tarefas.media)?"text-yellow-500 fill-yellow-500":"text-gray-300 dark:text-gray-600")},e))}),(0,k.jsxs)("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:[g.tarefas.total," avalia\xe7\xf5es"]})]})]}),(0,k.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-600",children:[(0,k.jsxs)("h4",{className:"text-base font-medium mb-3 text-gray-900 dark:text-white flex items-center gap-2",children:[(0,k.jsx)(Rd,{className:"w-4 h-4 text-blue-500 dark:text-[#1D9BF0]"}),"Avalia\xe7\xf5es de Desempenho"]}),(0,k.jsxs)("div",{className:"flex items-center gap-3",children:[(0,k.jsx)("div",{className:"flex gap-1",children:[1,2,3,4,5].map(e=>(0,k.jsx)(Ld,{className:"w-4 h-4 ".concat(e<=Math.round(g.desempenho.media)?"text-yellow-500 fill-yellow-500":"text-gray-300 dark:text-gray-600")},e))}),(0,k.jsxs)("div",{className:"flex flex-col",children:[(0,k.jsxs)("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:[g.desempenho.total," avalia\xe7\xf5es"]}),(0,k.jsxs)("span",{className:"text-sm font-medium text-blue-500 dark:text-[#1D9BF0]",children:[a," pontos"]})]})]})]})]}),!C&&m.totalAvaliacoes>0&&(0,k.jsxs)("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4 flex items-start gap-3",children:[(0,k.jsx)(rw,{className:"w-5 h-5 text-blue-600 dark:text-blue-400 flex-shrink-0 mt-0.5"}),(0,k.jsxs)("div",{className:"flex-1",children:[(0,k.jsx)("h4",{className:"text-sm font-medium text-blue-800 dark:text-blue-300",children:"Acesso Limitado"}),(0,k.jsx)("p",{className:"mt-1 text-sm text-blue-700 dark:text-blue-400",children:"Voc\xea pode ver apenas o resumo das avalia\xe7\xf5es. Para ver detalhes e coment\xe1rios, \xe9 necess\xe1rio ter n\xedvel de supervisor ou superior."})]})]}),C&&m.totalAvaliacoes>0&&(0,k.jsx)("div",{children:x.map(e=>{var t,r,a;return(0,k.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-600 mb-4",children:[(0,k.jsxs)("div",{className:"flex items-start justify-between",children:[(0,k.jsxs)("div",{className:"flex-1",children:[(0,k.jsx)("div",{className:"flex items-center gap-2 mb-2",children:[1,2,3,4,5].map(t=>(0,k.jsx)(Ld,{className:"w-5 h-5 ".concat(t<=e.estrelas?"text-yellow-500 fill-yellow-500":"text-[#38444D]")},t))}),(0,k.jsx)("p",{className:"text-gray-500 dark:text-gray-400 mt-2",children:e.comentario})]}),(0,k.jsx)("button",{onClick:()=>(async e=>{C?(d(e),h(!0)):l("Voc\xea n\xe3o tem permiss\xe3o para excluir avalia\xe7\xf5es","error")})(e.id),className:"p-2 text-red-500 hover:text-red-600 hover:bg-red-500/10 rounded-full transition-colors",title:"Excluir avalia\xe7\xe3o",children:(0,k.jsx)(nw,{className:"w-5 h-5"})})]}),(0,k.jsxs)("div",{className:"mt-4 flex items-center gap-4 text-sm text-gray-500 dark:text-gray-400",children:[(0,k.jsxs)("div",{className:"flex items-center gap-1",children:[(0,k.jsx)(iu,{className:"w-4 h-4"}),(0,k.jsx)("span",{children:sk(e.data)})]}),(0,k.jsxs)("div",{className:"flex items-center gap-1",children:[(0,k.jsx)(xu,{className:"w-4 h-4"}),(0,k.jsx)("span",{children:(a=e.hora,a||"-")})]}),(0,k.jsx)("div",{className:"flex items-center gap-1",children:(0,k.jsxs)("span",{children:["por ",e.anonima?"An\xf4nimo":e.supervisorNome,!e.anonima&&e.supervisorCargo&&" (".concat(e.supervisorCargo,")")]})}),(0,k.jsx)("div",{className:"flex items-center gap-1",children:(0,k.jsx)("span",{children:e.origemAvaliacao})}),e.tipoAvaliacao&&(0,k.jsx)("div",{className:"px-2 py-0.5 rounded-full text-sm ".concat((null===(t=Uk.find(t=>t.valor===e.tipoAvaliacao))||void 0===t?void 0:t.cor)||"text-blue-400 bg-blue-400/20"),children:(null===(r=Uk.find(t=>t.valor===e.tipoAvaliacao))||void 0===r?void 0:r.label)||"Avalia\xe7\xe3o"}),(0,k.jsxs)("div",{className:"mt-2 flex items-center justify-between gap-2 text-sm text-gray-500 dark:text-gray-400 bg-white dark:bg-gray-800 rounded-lg p-2",children:[(0,k.jsxs)("div",{className:"flex items-center gap-2",children:[(0,k.jsx)(iu,{className:"w-4 h-4"}),(0,k.jsx)("span",{children:sk(e.data)}),(0,k.jsx)(xu,{className:"w-4 h-4 ml-2"}),(0,k.jsx)("span",{children:e.hora||"00:00"})]}),(0,k.jsx)("div",{className:"flex items-center gap-1",children:(0,k.jsxs)("span",{children:["por ",e.anonima?"An\xf4nimo":e.supervisorNome]})})]})]})]},e.id)})}),u&&(0,k.jsx)("div",{className:"fixed inset-0 bg-black/50 dark:bg-black/70 flex items-center justify-center z-50",children:(0,k.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 w-full max-w-md mx-4",children:[(0,k.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,k.jsx)("h3",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Confirmar Exclus\xe3o"}),(0,k.jsx)("button",{onClick:()=>{h(!1),d(null)},className:"p-2 text-gray-500 dark:text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-[#283340] rounded-full transition-colors",children:(0,k.jsx)(Id,{className:"w-5 h-5"})})]}),(0,k.jsxs)("div",{className:"mb-6",children:[(0,k.jsx)("p",{className:"text-gray-600 dark:text-gray-500 dark:text-gray-400 mb-4",children:"Tem certeza que deseja excluir esta avalia\xe7\xe3o? Esta a\xe7\xe3o n\xe3o pode ser desfeita."}),(0,k.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,k.jsx)("button",{onClick:()=>{h(!1),d(null)},className:"px-4 py-2 text-gray-600 dark:text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-[#283340] rounded-full transition-colors",children:"Cancelar"}),(0,k.jsxs)("button",{onClick:async()=>{try{const e=(0,s.doc)(P.db,"avaliacoes",c),t=await(0,s.x7)(e);if(!t.exists())throw new Error("Avalia\xe7\xe3o n\xe3o encontrada");const a=t.data(),n=I(a.estrelas),i=(0,s.doc)(P.db,"funcionarios",r.id),o=await(0,s.x7)(i);if(!o.exists())throw new Error("Funcion\xe1rio n\xe3o encontrado");const u=o.data().pontos||0;await(0,s.updateDoc)(i,{pontos:Math.max(0,u-n)}),await(0,s.deleteDoc)(e),await T(),l("Avalia\xe7\xe3o exclu\xedda e pontos atualizados com sucesso!","success"),h(!1),d(null)}catch(e){console.error("Erro ao excluir avalia\xe7\xe3o:",e),l("Erro ao excluir avalia\xe7\xe3o. Por favor, tente novamente.","error")}},className:"px-4 py-2 bg-red-500 text-gray-900 dark:text-white rounded-full hover:bg-red-600 transition-colors flex items-center gap-2",children:[(0,k.jsx)(nw,{className:"w-4 h-4"}),"Excluir Avalia\xe7\xe3o"]})]})]})]})}),v&&(0,k.jsx)("div",{className:"fixed inset-0 bg-black/50 dark:bg-black/70 flex items-center justify-center z-50",children:(0,k.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 w-full max-w-md mx-4",children:[(0,k.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,k.jsx)("h3",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Nova Avalia\xe7\xe3o"}),(0,k.jsx)("button",{onClick:()=>b(!1),className:"p-2 text-gray-500 dark:text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-[#283340] rounded-full transition-colors",children:(0,k.jsx)(Id,{className:"w-5 h-5"})})]}),(0,k.jsxs)("div",{className:"space-y-6",children:[(0,k.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,k.jsx)("span",{className:"text-gray-600 dark:text-gray-500 dark:text-gray-400 text-sm",children:"Avalia\xe7\xe3o"}),(0,k.jsx)("div",{className:"flex gap-1",children:[1,2,3,4,5].map(e=>(0,k.jsx)("button",{type:"button",onClick:()=>A(t=>(0,n.A)((0,n.A)({},t),{},{estrelas:e})),onMouseEnter:()=>N(e),onMouseLeave:()=>N(0),className:"p-1 transition-transform hover:scale-110",children:(0,k.jsx)(Ld,{className:"w-8 h-8 ".concat((w?e<=w:e<=E.estrelas)?"text-yellow-500 fill-yellow-500":"text-gray-300 dark:text-[#38444D]")})},e))})]}),(0,k.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm text-gray-600 dark:text-gray-500 dark:text-gray-400 mb-2",children:"Data"}),(0,k.jsx)("input",{type:"date",value:E.data,onChange:e=>A(t=>(0,n.A)((0,n.A)({},t),{},{data:e.target.value})),className:"w-full px-3 py-2 bg-white dark:bg-white dark:bg-gray-700 text-gray-900 dark:text-white border border-gray-300 dark:border-gray-200 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:focus:ring-[#1D9BF0] focus:border-transparent outline-none",required:!0})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm text-gray-600 dark:text-gray-500 dark:text-gray-400 mb-2",children:"Hora"}),(0,k.jsx)("input",{type:"time",value:E.hora,onChange:e=>A(t=>(0,n.A)((0,n.A)({},t),{},{hora:e.target.value})),className:"w-full px-3 py-2 bg-white dark:bg-white dark:bg-gray-700 text-gray-900 dark:text-white border border-gray-300 dark:border-gray-200 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:focus:ring-[#1D9BF0] focus:border-transparent outline-none",required:!0})]})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm text-gray-600 dark:text-gray-500 dark:text-gray-400 mb-2",children:"Tipo de Avalia\xe7\xe3o"}),(0,k.jsx)("div",{className:"grid grid-cols-2 gap-2",children:Uk.map(e=>(0,k.jsx)("button",{type:"button",onClick:()=>A(t=>(0,n.A)((0,n.A)({},t),{},{tipo:e.valor})),className:"px-3 py-2 rounded-lg text-sm font-medium transition-colors ".concat(E.tipo===e.valor?e.cor+" ring-2 ring-offset-2 ring-offset-[#192734] ring-current":"bg-white dark:bg-gray-700 text-gray-500 dark:text-gray-400 hover:bg-[#283340]"),children:e.label},e.valor))})]}),(0,k.jsxs)("div",{className:"flex items-center gap-2",children:[(0,k.jsx)("input",{type:"checkbox",id:"avaliacaoAnonima",checked:E.anonima,onChange:e=>A(t=>(0,n.A)((0,n.A)({},t),{},{anonima:e.target.checked})),className:"w-4 h-4 text-blue-500 dark:text-[#1D9BF0] bg-white dark:bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-200 dark:border-gray-600 rounded focus:ring-2 focus:ring-blue-500 dark:focus:ring-[#1D9BF0] focus:border-transparent"}),(0,k.jsx)("label",{htmlFor:"avaliacaoAnonima",className:"text-sm text-gray-600 dark:text-gray-500 dark:text-gray-400 cursor-pointer",children:"Tornar avalia\xe7\xe3o an\xf4nima"})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm text-gray-600 dark:text-gray-500 dark:text-gray-400 mb-2",children:"Coment\xe1rio"}),(0,k.jsx)("textarea",{value:E.comentario,onChange:e=>A(t=>(0,n.A)((0,n.A)({},t),{},{comentario:e.target.value})),className:"w-full h-32 px-4 py-2 bg-white dark:bg-white dark:bg-gray-700 text-gray-900 dark:text-white border border-gray-300 dark:border-gray-200 dark:border-gray-600 rounded-lg resize-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-[#1D9BF0] focus:border-transparent outline-none",placeholder:"Deixe um feedback sobre o desempenho do funcion\xe1rio...",required:!0})]}),(0,k.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,k.jsx)("button",{type:"button",onClick:()=>b(!1),className:"px-4 py-2 text-gray-600 dark:text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-[#283340] rounded-full transition-colors",children:"Cancelar"}),(0,k.jsxs)("button",{type:"button",onClick:async()=>{if(console.log("Dados do usu\xe1rio:",i),console.log("Dados do funcion\xe1rio:",r),null!==r&&void 0!==r&&r.id&&null!==i&&void 0!==i&&i.id){if(!C)return console.error("Usu\xe1rio sem permiss\xe3o para avaliar"),void l("Voc\xea n\xe3o tem permiss\xe3o para realizar avalia\xe7\xf5es","error");if(0!==E.estrelas)if(E.estrelas)try{const e=(0,s.collection)(P.db,"avaliacoes"),t={funcionarioId:String(r.id),funcionarioNome:r.nome,supervisorId:i.id,supervisorNome:E.anonima?"An\xf4nimo":i.nome,data:E.data,hora:E.hora,estrelas:Number(E.estrelas),comentario:E.comentario,status:"ativa",tipo:"avaliacao_supervisor",tipoAvaliacao:E.tipo,anonima:E.anonima,dataCriacao:(0,s.O5)()};console.log("Dados a serem salvos:",t),await(0,s.gS)(e,t);const a=(0,s.doc)(P.db,"funcionarios",r.id),n=await(0,s.x7)(a);if(n.exists()){const e=n.data(),r=(e.pontos||0)+I(t.estrelas);await(0,s.updateDoc)(a,{pontos:r})}l("Avalia\xe7\xe3o salva e pontos atualizados com sucesso!","success"),b(!1);const o=new Date;A({data:o.toISOString().split("T")[0],hora:"".concat(String(o.getHours()).padStart(2,"0"),":").concat(String(o.getMinutes()).padStart(2,"0")),estrelas:0,comentario:"",tipo:"positiva",anonima:!1}),await T()}catch(e){console.error("Erro ao salvar:",e),l("Erro ao salvar avalia\xe7\xe3o. Por favor, tente novamente.","error")}else l("Por favor, selecione uma quantidade de estrelas","warning");else l("Por favor, selecione uma avalia\xe7\xe3o em estrelas","warning")}else l("Erro ao salvar avalia\xe7\xe3o. Por favor, tente novamente.","error")},disabled:0===E.estrelas,className:"px-4 py-2 bg-blue-500 dark:bg-[#1D9BF0] text-gray-900 dark:text-white rounded-full hover:bg-blue-600 dark:hover:bg-[#1a8cd8] transition-colors flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,k.jsx)(lk,{className:"w-4 h-4"}),"Salvar Avalia\xe7\xe3o"]})]})]})]})})]})},Hk=t=>{let{funcionario:r,onClose:a}=t;const{usuario:i}=Nt(),[o,l]=(null===i||void 0===i||i.nivel,(0,e.useState)(!1)),[c,d]=(0,e.useState)(r.cargo||""),[u,h]=(0,e.useState)("inventario"),[m,f]=(0,e.useState)([]),[g,p]=(0,e.useState)(""),[x,y]=(0,e.useState)("todos"),[v,b]=(0,e.useState)("todos"),[w,N]=(0,e.useState)({desempenho:!1,tarefas:!1,autoavaliacoes:!1}),[j,S]=(0,e.useState)({tarefasConcluidas:0,tarefasEmAndamento:0,emprestimosAtivos:0,mediaAvaliacoes:0,totalAvaliacoes:0,avaliacoes:[],pontosDesempenho:0});return(0,e.useEffect)(()=>{if(null===r||void 0===r||!r.id||null===r||void 0===r||!r.nome)return;const e=(0,s.collection)(P.db,"emprestimos"),t=(0,s.collection)(P.db,"avaliacoes"),a=(0,s.collection)(P.db,"avaliacoesDesempenho"),i=[...[(0,s.P)(e,(0,s._M)("funcionarioId","==",String(r.id))),(0,s.P)(e,(0,s._M)("funcionarioId","==",Number(r.id))),(0,s.P)(e,(0,s._M)("funcionario","==",r.nome)),(0,s.P)(e,(0,s._M)("colaborador","==",r.nome)),(0,s.P)(e,(0,s._M)("responsavel","==",r.nome.toLowerCase())),(0,s.P)(e,(0,s._M)("responsavel","==",r.nome))],...[(0,s.P)(t,(0,s._M)("funcionarioId","==",r.id))],...[(0,s.P)(a,(0,s._M)("funcionarioId","==",r.id))]].map(e=>(0,s.aQ)(e,e=>{const t=e.docs.map(e=>(0,n.A)({id:e.id},e.data()));if(t.length>0){const e=t.length>0&&("status"in t[0]||"dataEmprestimo"in t[0]),r=t.length>0&&("nota"in t[0]||"avaliacao"in t[0]);if(e)f(e=>{const r=[...e];return t.forEach(e=>{r.some(t=>t.id===e.id)||r.push(e)}),r});else if(r){const e=t.map(e=>(0,n.A)((0,n.A)({},e),{},{tipo:e.tipo||("avaliacaoDesempenho"in e?"desempenho":"regular"),nota:Number(e.nota||e.estrelas||e.avaliacao||0),data:e.data||(new Date).toISOString()}));S(t=>{const r=[...t.avaliacoes||[]];e.forEach(e=>{r.some(t=>t.id===e.id)||r.push(e)}),r.sort((e,t)=>new Date(t.data)-new Date(e.data));const a=r.filter(e=>"desempenho"===e.tipo),s=r.filter(e=>"regular"===e.tipo),i=a.reduce((e,t)=>e+10*(t.estrelas||t.nota||0),0),o=a.length>0?a.reduce((e,t)=>e+(t.estrelas||t.nota||0),0)/a.length:0,l=s.length>0?s.reduce((e,t)=>e+(t.estrelas||t.nota||0),0)/s.length:0;return(0,n.A)((0,n.A)({},t),{},{avaliacoes:r,mediaAvaliacoes:(o+l)/2||0,totalAvaliacoes:r.length,pontosDesempenho:i})})}}}));return()=>{i.forEach(e=>e()),f([])}},[null===r||void 0===r?void 0:r.id,null===r||void 0===r?void 0:r.nome]),(0,e.useEffect)(()=>{null!==r&&void 0!==r&&r.id&&(async()=>{try{const e=(0,s.collection)(P.db,"tarefas"),t=(0,s.collection)(P.db,"avaliacoes"),[a,i,o,l,c,d]=await Promise.all([(0,s.GG)((0,s.P)(e,(0,s._M)("funcionariosIds","array-contains",r.nome))),(0,s.GG)((0,s.P)(e,(0,s._M)("funcionario","==",r.nome))),(0,s.GG)((0,s.P)(e,(0,s._M)("funcionario","==",r.nome.toLowerCase()))),(0,s.GG)((0,s.P)(e,(0,s._M)("responsavel","==",r.nome))),(0,s.GG)((0,s.P)(e,(0,s._M)("responsavel","==",r.nome.toLowerCase()))),(0,s.GG)((0,s.P)(t,(0,s._M)("funcionarioId","==",r.id)))]);let u=0,h=0,f=0,g=0;const p=d.docs.map(e=>{const t=e.data();return(0,n.A)((0,n.A)({id:e.id},t),{},{nota:Number(t.estrelas||t.nota||t.avaliacao||0),tipo:t.tipo||(t.avaliacaoDesempenho?"desempenho":"regular")})}),x=e=>{e.forEach(e=>{const t=e.data();"concluida"===t.status?(u++,t.avaliacaoSupervisor&&(f+=Number(t.avaliacaoSupervisor),g++)):"em_andamento"===t.status&&h++})};x(a),x(i),x(o),x(l),x(c);const y=m.filter(e=>"ativo"===e.status||"emprestado"===e.status).length,v=p.filter(e=>"desempenho"===e.tipo).reduce((e,t)=>e+10*(t.estrelas||t.nota||0),0);S({tarefasConcluidas:u,tarefasEmAndamento:h,emprestimosAtivos:y,mediaAvaliacoes:g>0?f/g:0,totalAvaliacoes:g,avaliacoes:p,pontosDesempenho:v})}catch(e){console.error("Erro ao buscar estat\xedsticas:",e)}})()},[null===r||void 0===r?void 0:r.id,null===r||void 0===r?void 0:r.nome,m]),(0,k.jsx)("div",{className:"fixed inset-0 bg-black/50 dark:bg-black/70 dark:bg-black/70 flex items-center justify-center z-50",onClick:a,children:(0,k.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-2xl max-w-6xl w-full mx-4 max-h-[90vh] overflow-y-auto relative",onClick:e=>e.stopPropagation(),children:[(0,k.jsx)("div",{className:"sticky top-0 right-0 z-10 flex justify-end p-4 bg-white dark:bg-gray-800",children:(0,k.jsx)("button",{onClick:a,className:"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-white transition-colors p-2 hover:bg-gray-50 dark:hover:bg-gray-700 rounded-lg",children:(0,k.jsx)(Id,{className:"w-5 h-5"})})}),(0,k.jsxs)("div",{className:"relative",children:[(0,k.jsx)("div",{className:"h-32 bg-blue-500 dark:bg-[#1D9BF0]/10"}),(0,k.jsx)("div",{className:"absolute -bottom-16 left-6",children:(0,k.jsx)("div",{className:"w-32 h-32 rounded-full border-4 border-[#192734] bg-white dark:bg-gray-700 flex items-center justify-center overflow-hidden",children:r.photoURL?(0,k.jsx)("img",{src:r.photoURL,alt:r.nome,className:"w-full h-full object-cover"}):(0,k.jsx)(uk,{className:"w-16 h-16 text-gray-500 dark:text-gray-400"})})})]}),(0,k.jsxs)("div",{className:"mt-20 px-6",children:[(0,k.jsx)("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:r.nome}),(0,k.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[(0,k.jsx)(Kb,{className:"w-4 h-4 text-gray-500 dark:text-gray-400"}),(0,k.jsx)("div",{className:"flex-1",children:o?(0,k.jsx)(Sk,{value:c,onChange:d,className:"bg-white dark:bg-gray-700 text-gray-500 dark:text-gray-400"}):(0,k.jsxs)("div",{className:"flex items-center gap-2",children:[(0,k.jsx)("span",{className:"text-gray-500 dark:text-gray-400",children:r.cargo||"Cargo n\xe3o definido"}),(null===i||void 0===i?void 0:i.nivel)>=2&&(0,k.jsx)("button",{onClick:e=>{e.stopPropagation(),l(!0),d(r.cargo||"")},className:"p-1 hover:bg-gray-50 dark:hover:bg-gray-700 rounded transition-colors",children:(0,k.jsx)(Nk,{className:"w-3 h-3 text-blue-500 dark:text-[#1D9BF0]"})})]})})]}),o&&(0,k.jsxs)("div",{className:"flex gap-2 mt-2",children:[(0,k.jsx)("button",{onClick:async e=>{e.stopPropagation();try{const e=doc(P.db,"funcionarios",r.id);await updateDoc(e,{cargo:c}),l(!1)}catch(t){console.error("Erro ao atualizar cargo:",t)}},className:"px-3 py-1 bg-green-500 text-gray-900 dark:text-white rounded-lg text-sm hover:bg-green-600 transition-colors",children:"Salvar"}),(0,k.jsx)("button",{onClick:e=>{e.stopPropagation(),l(!1),d(r.cargo||"")},className:"px-3 py-1 bg-red-500 text-gray-900 dark:text-white rounded-lg text-sm hover:bg-red-600 transition-colors",children:"Cancelar"})]}),(0,k.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[(0,k.jsx)(jk,{className:"w-4 h-4 text-gray-500 dark:text-gray-400"}),(0,k.jsx)("span",{className:"text-gray-500 dark:text-gray-400",children:r.telefone})]})]}),(0,k.jsx)("div",{className:"mt-6 border-b border-[#2F3336]",children:(0,k.jsxs)("div",{className:"flex px-6",children:[(0,k.jsxs)("button",{className:"px-6 py-4 font-medium text-sm relative ".concat("inventario"===u?"text-blue-500 dark:text-[#1D9BF0] font-bold":"text-gray-500 dark:text-gray-400"),onClick:()=>h("inventario"),children:["Invent\xe1rio","inventario"===u&&(0,k.jsx)("div",{className:"absolute bottom-0 left-0 right-0 h-1 bg-blue-500 dark:bg-[#1D9BF0] rounded-full"})]}),(0,k.jsxs)("button",{className:"px-6 py-4 font-medium text-sm relative ".concat("tarefas"===u?"text-blue-500 dark:text-[#1D9BF0] font-bold":"text-gray-500 dark:text-gray-400"),onClick:()=>h("tarefas"),children:["Tarefas","tarefas"===u&&(0,k.jsx)("div",{className:"absolute bottom-0 left-0 right-0 h-1 bg-blue-500 dark:bg-[#1D9BF0] rounded-full"})]}),(null===i||void 0===i?void 0:i.nivel)>=2&&(0,k.jsxs)("button",{className:"px-6 py-4 font-medium text-sm relative ".concat("avaliacoes"===u?"text-blue-500 dark:text-[#1D9BF0] font-bold":"text-gray-500 dark:text-gray-400"),onClick:()=>h("avaliacoes"),children:["Avalia\xe7\xf5es","avaliacoes"===u&&(0,k.jsx)("div",{className:"absolute bottom-0 left-0 right-0 h-1 bg-blue-500 dark:bg-[#1D9BF0] rounded-full"})]})]})}),(0,k.jsxs)("div",{className:"mt-4 px-6 pb-6",children:["inventario"===u&&(0,k.jsxs)(k.Fragment,{children:[(0,k.jsxs)("div",{className:"flex gap-4 items-center mb-4",children:[(0,k.jsxs)("div",{className:"relative flex-1 min-w-[350px]",children:[(0,k.jsx)(Ft,{className:"w-4 h-4 absolute left-3 top-1/2 -translate-y-1/2 text-gray-500 dark:text-gray-400"}),(0,k.jsx)("input",{type:"text",placeholder:"Buscar por ferramenta...",value:g,onChange:e=>p(e.target.value),className:"w-full h-10 pl-10 pr-4 border border-gray-200 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-[#1D9BF0] bg-white dark:bg-gray-700 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 text-sm"})]}),(0,k.jsxs)("select",{value:x,onChange:e=>y(e.target.value),className:"border border-gray-200 dark:border-gray-600 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-[#1D9BF0] bg-white dark:bg-gray-700 text-gray-900 dark:text-white hover:bg-gray-100 dark:hover:bg-gray-600",children:[(0,k.jsx)("option",{value:"todos",children:"Todos os per\xedodos"}),(0,k.jsx)("option",{value:"hoje",children:"Hoje"}),(0,k.jsx)("option",{value:"semana",children:"\xdaltimos 7 dias"}),(0,k.jsx)("option",{value:"mes",children:"\xdaltimo m\xeas"})]}),(0,k.jsxs)("select",{value:v,onChange:e=>b(e.target.value),className:"border border-gray-200 dark:border-gray-600 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-[#1D9BF0] bg-white dark:bg-gray-700 text-gray-900 dark:text-white hover:bg-gray-100 dark:hover:bg-gray-600",children:[(0,k.jsx)("option",{value:"todos",children:"Todos os status"}),(0,k.jsx)("option",{value:"emprestado",children:"N\xe3o devolvidos"}),(0,k.jsx)("option",{value:"devolvido",children:"Devolvidos"})]})]}),(0,k.jsx)("div",{className:"text-sm text-gray-500 dark:text-gray-400 mb-4",children:0===m.length?"Nenhum empr\xe9stimo encontrado para este funcion\xe1rio":"".concat(m.length," empr\xe9stimo").concat(1!==m.length?"s":""," encontrado").concat(1!==m.length?"s":"")}),(0,k.jsx)(ir,{children:(0,k.jsx)(Vb,{emprestimos:m.filter(e=>{var t;if(g&&(null===(t=e.ferramentas)||void 0===t||!t.some(e=>e.nome.toLowerCase().includes(g.toLowerCase()))))return!1;if("emprestado"===v&&"ativo"!==e.status)return!1;if("devolvido"===v&&"devolvido"!==e.status)return!1;if("todos"!==x){const t=new Date(e.dataEmprestimo),r=new Date;switch(x){case"hoje":return t.getDate()===r.getDate()&&t.getMonth()===r.getMonth()&&t.getFullYear()===r.getFullYear();case"semana":const e=new Date(r);return e.setDate(r.getDate()-7),t>=e;case"mes":const a=new Date(r);return a.setMonth(r.getMonth()-1),t>=a;default:return!0}}return!0}),readOnly:!0,showEmptyMessage:"Nenhum empr\xe9stimo encontrado para ".concat(r.nome)})})]}),"tarefas"===u&&(0,k.jsxs)(k.Fragment,{children:[(0,k.jsxs)("div",{className:"text-sm text-gray-500 dark:text-gray-400 mb-4",children:[j.tarefasConcluidas>0&&"".concat(j.tarefasConcluidas," tarefa").concat(1!==j.tarefasConcluidas?"s":""),j.totalAvaliacoes>0&&" \u2022 M\xe9dia de avalia\xe7\xe3o: ".concat(j.mediaAvaliacoes.toFixed(1)," ")]}),(0,k.jsx)(ir,{children:(0,k.jsx)(zk,{showOnlyUserTasks:!0,showAddButton:!1,userFilter:r.nome,readOnly:!0,defaultFiltros:{status:"todas",periodo:"todos",avaliacao:"todas"}})})]}),"avaliacoes"===u&&(0,k.jsx)(qk,{funcionario:r,pontosDesempenho:j.pontosDesempenho})]})]})})},Gk=y("user-x",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]),Wk=t=>{let{isOpen:r,onClose:a,funcionarios:i}=t;const{usuario:o}=Nt(),[l,c]=(0,e.useState)([]),[d,u]=(0,e.useState)({nome:"",funcionarios:[]}),[h,m]=(0,e.useState)("lista"),[f,g]=(0,e.useState)(null),[p,x]=(0,e.useState)("");(0,e.useEffect)(()=>{r&&(async()=>{try{const e=(0,s.collection)(P.db,"grupos"),t=(0,s.P)(e,(0,s._M)("criadoPor","==",o.id)),r=(await(0,s.GG)(t)).docs.map(e=>(0,n.A)({id:e.id},e.data()));c(r)}catch(e){console.error("Erro ao carregar grupos:",e)}})()},[r,o.id]);const y=i.filter(e=>{var t;return e.nome.toLowerCase().includes(p.toLowerCase())||(null===(t=e.cargo)||void 0===t?void 0:t.toLowerCase().includes(p.toLowerCase()))});return r?(0,k.jsx)("div",{className:"fixed inset-0 bg-black/50 dark:bg-black/70 dark:bg-black/70 flex items-center justify-center z-50",children:(0,k.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 w-full max-w-2xl",children:[(0,k.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,k.jsx)("h3",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"lista"===h?"Grupos de Funcion\xe1rios":"criar"===h?"Criar Novo Grupo":"Editar Grupo"}),(0,k.jsx)("button",{onClick:a,className:"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-white transition-colors",children:(0,k.jsx)(Id,{className:"w-5 h-5"})})]}),"lista"===h?(0,k.jsxs)(k.Fragment,{children:[(0,k.jsxs)("button",{onClick:()=>{u({nome:"",funcionarios:[]}),m("criar")},className:"mb-4 bg-blue-500 dark:bg-[#1D9BF0] text-gray-900 dark:text-white px-4 py-2 rounded-lg hover:bg-blue-600 dark:hover:bg-[#1a8cd8] transition-colors flex items-center gap-2",children:[(0,k.jsx)(D,{className:"w-4 h-4"}),"Criar Novo Grupo"]}),(0,k.jsxs)("div",{className:"space-y-3",children:[l.map(e=>(0,k.jsxs)("div",{className:"bg-white dark:bg-gray-700 rounded-lg p-4",children:[(0,k.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,k.jsxs)("div",{className:"flex items-center gap-2",children:[(0,k.jsx)(uk,{className:"w-5 h-5 text-blue-500 dark:text-[#1D9BF0]"}),(0,k.jsx)("h4",{className:"text-gray-900 dark:text-white font-medium",children:e.nome})]}),(0,k.jsxs)("div",{className:"flex items-center gap-2",children:[(0,k.jsx)("button",{onClick:()=>{g(e),u({nome:e.nome,funcionarios:e.funcionarios}),m("editar")},className:"text-blue-500 dark:text-[#1D9BF0] hover:text-blue-600 dark:hover:text-[#1a8cd8] transition-colors p-1",children:"Editar"}),(0,k.jsx)("button",{onClick:()=>(async e=>{if(window.confirm("Tem certeza que deseja excluir este grupo?"))try{await(0,s.deleteDoc)((0,s.doc)(P.db,"grupos",e)),c(t=>t.filter(t=>t.id!==e))}catch(t){console.error("Erro ao excluir grupo:",t)}})(e.id),className:"text-red-500 hover:text-red-600 transition-colors p-1",children:"Excluir"})]})]}),(0,k.jsxs)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[e.funcionarios.length," funcion\xe1rio",1!==e.funcionarios.length?"s":""]})]},e.id)),0===l.length&&(0,k.jsx)("p",{className:"text-gray-500 dark:text-gray-400 text-center py-4",children:"Nenhum grupo criado ainda"})]})]}):(0,k.jsxs)(k.Fragment,{children:[(0,k.jsxs)("div",{className:"mb-4",children:[(0,k.jsx)("label",{className:"block text-sm font-medium text-gray-500 dark:text-gray-400 mb-2",children:"Nome do Grupo"}),(0,k.jsx)("input",{type:"text",value:d.nome,onChange:e=>u(t=>(0,n.A)((0,n.A)({},t),{},{nome:e.target.value})),placeholder:"Digite o nome do grupo",className:"w-full bg-white dark:bg-gray-700 text-gray-900 dark:text-white rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-[#1D9BF0]"})]}),(0,k.jsxs)("div",{className:"mb-4",children:[(0,k.jsx)("label",{className:"block text-sm font-medium text-gray-500 dark:text-gray-400 mb-2",children:"Buscar Funcion\xe1rios"}),(0,k.jsxs)("div",{className:"relative",children:[(0,k.jsx)(Ft,{className:"w-4 h-4 absolute left-3 top-1/2 -translate-y-1/2 text-gray-500 dark:text-gray-400"}),(0,k.jsx)("input",{type:"text",value:p,onChange:e=>x(e.target.value),placeholder:"Buscar por nome ou cargo...",className:"w-full bg-white dark:bg-gray-700 text-gray-900 dark:text-white rounded-lg pl-10 pr-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-[#1D9BF0]"})]})]}),(0,k.jsx)("div",{className:"max-h-[300px] overflow-y-auto mb-4",children:y.map(e=>(0,k.jsxs)("div",{className:"flex items-center gap-3 p-2 hover:bg-gray-50 dark:hover:bg-gray-700 rounded-lg cursor-pointer",onClick:()=>{u(t=>{const r=t.funcionarios.includes(e.id);return(0,n.A)((0,n.A)({},t),{},{funcionarios:r?t.funcionarios.filter(t=>t!==e.id):[...t.funcionarios,e.id]})})},children:[(0,k.jsx)("div",{className:"w-5 h-5 border-2 rounded flex items-center justify-center bg-white dark:bg-gray-700",children:d.funcionarios.includes(e.id)&&(0,k.jsx)(lk,{className:"w-4 h-4 text-blue-500 dark:text-[#1D9BF0]"})}),(0,k.jsxs)("div",{children:[(0,k.jsx)("p",{className:"text-gray-900 dark:text-white",children:e.nome}),e.cargo&&(0,k.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:e.cargo})]})]},e.id))}),(0,k.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,k.jsx)("button",{onClick:()=>{u({nome:"",funcionarios:[]}),g(null),m("lista")},className:"px-4 py-2 text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-white transition-colors",children:"Cancelar"}),(0,k.jsx)("button",{onClick:"criar"===h?async()=>{try{if(!d.nome.trim()||0===d.funcionarios.length)return void alert("Por favor, preencha o nome do grupo e selecione pelo menos um funcion\xe1rio.");const e={nome:d.nome,funcionarios:d.funcionarios,criadoPor:o.id,criadoEm:(new Date).toISOString()},t=(0,s.collection)(P.db,"grupos"),r=await(0,s.gS)(t,e);c(t=>[...t,(0,n.A)({id:r.id},e)]),u({nome:"",funcionarios:[]}),m("lista")}catch(e){console.error("Erro ao criar grupo:",e)}}:async()=>{try{if(!d.nome.trim()||0===d.funcionarios.length)return void alert("Por favor, preencha o nome do grupo e selecione pelo menos um funcion\xe1rio.");const e=(0,s.doc)(P.db,"grupos",f.id);await(0,s.updateDoc)(e,{nome:d.nome,funcionarios:d.funcionarios,atualizadoEm:(new Date).toISOString()}),c(e=>e.map(e=>e.id===f.id?(0,n.A)((0,n.A)({},e),{},{nome:d.nome,funcionarios:d.funcionarios}):e)),u({nome:"",funcionarios:[]}),g(null),m("lista")}catch(e){console.error("Erro ao atualizar grupo:",e)}},className:"bg-blue-500 dark:bg-[#1D9BF0] text-gray-900 dark:text-white px-4 py-2 rounded-lg hover:bg-blue-600 dark:hover:bg-[#1a8cd8] transition-colors",children:"criar"===h?"Criar Grupo":"Salvar Altera\xe7\xf5es"})]})]})]})}):null},Kk=y("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]]),Qk=t=>{let{onSubmit:r,loading:a,formatarTelefone:i}=t;const{showToast:o}=_(),l=(0,e.useRef)(),[c,d]=(0,e.useState)({nome:"",cargo:"",telefone:"",empresaId:"",empresaNome:"",setorId:"",setorNome:"",photoURL:""}),[u,h]=(0,e.useState)(null),[m,f]=(0,e.useState)(null),[g,p]=(0,e.useState)([]),[x,y]=(0,e.useState)([]),[v,b]=(0,e.useState)([]);(0,e.useEffect)(()=>{w(),N()},[]),(0,e.useEffect)(()=>{if(c.empresaId){const e=x.filter(e=>e.empresaId===c.empresaId&&!1!==e.ativo);b(e)}else b([])},[c.empresaId,x]);const w=async()=>{try{const e=(0,s.collection)(P.db,"empresas"),t=(await(0,s.GG)(e)).docs.map(e=>(0,n.A)({id:e.id},e.data())).filter(e=>!1!==e.ativo);p(t)}catch(e){console.error("Erro ao carregar empresas:",e)}},N=async()=>{try{const e=(0,s.collection)(P.db,"setores"),t=(await(0,s.GG)(e)).docs.map(e=>(0,n.A)({id:e.id},e.data()));y(t)}catch(e){console.error("Erro ao carregar setores:",e)}},j=()=>{f(null),h(null),l.current&&(l.current.value="")};return(0,k.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-6",children:[(0,k.jsxs)("div",{className:"flex items-center gap-3 mb-5",children:[(0,k.jsx)("div",{className:"w-10 h-10 rounded-lg bg-blue-100 dark:bg-blue-900/30 flex items-center justify-center",children:(0,k.jsx)(D,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"})}),(0,k.jsxs)("div",{children:[(0,k.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Adicionar Novo Funcion\xe1rio"}),(0,k.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Preencha os dados para cadastrar"})]})]}),(0,k.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),!c.empresaId)return void o("Selecione uma empresa","warning");if(!c.setorId)return void o("Selecione um setor","warning");let t="";m&&(t=await(async()=>{if(!m)return null;try{const e=Date.now(),t="funcionarios/".concat(e,"_").concat(m.name),r=(0,xt.KR)(P.storage,t);return await(0,xt.D)(r,m),await(0,xt.qk)(r)}catch(e){return console.error("Erro ao fazer upload da foto:",e),o("Erro ao fazer upload da foto","error"),null}})(),!t)||(r((0,n.A)((0,n.A)({},c),{},{photoURL:t})),d({nome:"",cargo:"",telefone:"",empresaId:"",empresaNome:"",setorId:"",setorNome:"",photoURL:""}),j())},className:"space-y-4",children:[u&&(0,k.jsxs)("div",{className:"flex items-center gap-4 p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-200 dark:border-blue-800",children:[(0,k.jsx)("img",{src:u,alt:"Preview",className:"w-16 h-16 rounded-lg object-cover ring-2 ring-blue-300 dark:ring-blue-700"}),(0,k.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,k.jsx)("p",{className:"text-sm font-medium text-gray-900 dark:text-white truncate",children:"Foto selecionada"}),(0,k.jsx)("p",{className:"text-xs text-gray-600 dark:text-gray-400 truncate",children:null===m||void 0===m?void 0:m.name})]}),(0,k.jsx)("button",{type:"button",onClick:j,className:"p-2 text-red-500 hover:bg-red-100 dark:hover:bg-red-900/30 rounded-lg transition-colors flex-shrink-0",children:(0,k.jsx)(Id,{className:"w-5 h-5"})})]}),(0,k.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1.5",children:"Nome Completo *"}),(0,k.jsx)("input",{type:"text",placeholder:"Ex: Jo\xe3o Silva",value:c.nome,onChange:e=>d((0,n.A)((0,n.A)({},c),{},{nome:e.target.value})),className:"w-full px-4 py-2.5 rounded-lg text-sm bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 text-gray-900 dark:text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",required:!0})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1.5",children:"Cargo *"}),(0,k.jsx)("input",{type:"text",placeholder:"Ex: Analista",value:c.cargo,onChange:e=>d((0,n.A)((0,n.A)({},c),{},{cargo:e.target.value})),className:"w-full px-4 py-2.5 rounded-lg text-sm bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 text-gray-900 dark:text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",required:!0})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1.5",children:"Telefone *"}),(0,k.jsx)("input",{type:"text",placeholder:"(00) 00000-0000",value:c.telefone?i(c.telefone):"",onChange:e=>{const t=e.target.value.replace(/[^0-9]/g,"");d((0,n.A)((0,n.A)({},c),{},{telefone:t}))},className:"w-full px-4 py-2.5 rounded-lg text-sm bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 text-gray-900 dark:text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",required:!0,maxLength:15})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1.5",children:"Empresa *"}),(0,k.jsxs)("select",{value:c.empresaId,onChange:e=>{const t=e.target.value,r=g.find(e=>e.id===t);d((0,n.A)((0,n.A)({},c),{},{empresaId:t,empresaNome:(null===r||void 0===r?void 0:r.nome)||"",setorId:"",setorNome:""}))},className:"w-full px-4 py-2.5 rounded-lg text-sm bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",required:!0,children:[(0,k.jsx)("option",{value:"",children:"Selecione a Empresa"}),g.map(e=>(0,k.jsx)("option",{value:e.id,children:e.nome},e.id))]})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1.5",children:"Setor *"}),(0,k.jsxs)("select",{value:c.setorId,onChange:e=>{const t=e.target.value,r=x.find(e=>e.id===t);d((0,n.A)((0,n.A)({},c),{},{setorId:t,setorNome:(null===r||void 0===r?void 0:r.nome)||""}))},className:"w-full px-4 py-2.5 rounded-lg text-sm bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all disabled:opacity-50 disabled:cursor-not-allowed",required:!0,disabled:!c.empresaId,children:[(0,k.jsx)("option",{value:"",children:"Selecione o Setor"}),v.map(e=>(0,k.jsx)("option",{value:e.id,children:e.nome},e.id))]})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1.5",children:"Foto (Opcional)"}),(0,k.jsx)("input",{ref:l,type:"file",accept:"image/*",onChange:e=>{const t=e.target.files[0];if(t){if(!t.type.startsWith("image/"))return void o("Selecione apenas imagens","error");if(t.size>5242880)return void o("Imagem deve ter no m\xe1ximo 5MB","error");f(t);const e=new FileReader;e.onloadend=()=>{h(e.result)},e.readAsDataURL(t)}},className:"hidden",id:"foto-funcionario"}),(0,k.jsxs)("label",{htmlFor:"foto-funcionario",className:"flex items-center justify-center gap-2 w-full px-4 py-2.5 bg-gray-50 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-600 transition-colors text-sm cursor-pointer border border-gray-300 dark:border-gray-600",children:[(0,k.jsx)(Kk,{className:"w-4 h-4"})," Escolher Foto"]})]})]}),(0,k.jsx)("div",{className:"flex justify-end pt-2",children:(0,k.jsx)("button",{type:"submit",className:"flex items-center gap-2 px-6 py-2.5 bg-blue-600 hover:bg-blue-700 dark:bg-blue-600 dark:hover:bg-blue-700 text-white rounded-lg transition-colors text-sm font-medium shadow-sm disabled:opacity-50 disabled:cursor-not-allowed",disabled:a,children:a?(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),(0,k.jsx)("span",{children:"Adicionando..."})]}):(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(D,{className:"w-4 h-4"}),(0,k.jsx)("span",{children:"Adicionar Funcion\xe1rio"})]})})})]})]})},Yk=y("hammer",[["path",{d:"m15 12-9.373 9.373a1 1 0 0 1-3.001-3L12 9",key:"1hayfq"}],["path",{d:"m18 15 4-4",key:"16gjal"}],["path",{d:"m21.5 11.5-1.914-1.914A2 2 0 0 1 19 8.172v-.344a2 2 0 0 0-.586-1.414l-1.657-1.657A6 6 0 0 0 12.516 3H9l1.243 1.243A6 6 0 0 1 12 8.485V10l2 2h1.172a2 2 0 0 1 1.414.586L18.5 14.5",key:"15ts47"}]]),Xk=y("users-round",[["path",{d:"M18 21a8 8 0 0 0-16 0",key:"3ypg7q"}],["circle",{cx:"10",cy:"8",r:"5",key:"o932ke"}],["path",{d:"M22 20c0-3.37-2-6.5-4-8a5 5 0 0 0-.45-8.3",key:"10s06x"}]]),Jk=t=>{let{filtroAtual:r,setFiltroAtual:a,searchTerm:n,setSearchTerm:s,onManageGroups:i,showGroupsButton:o=!0}=t;const[l,c]=(0,e.useState)(!1),[d,u]=(0,e.useState)(!1),h=[{value:"nome",label:"Nome A-Z",icon:uk,color:"from-blue-500 to-blue-600"},{value:"pontos",label:"Mais Pontos",icon:Xb,color:"from-yellow-500 to-orange-500"},{value:"avaliacao",label:"Melhor Avaliados",icon:Ld,color:"from-yellow-400 to-yellow-600"},{value:"tarefas",label:"Mais Tarefas",icon:Fd,color:"from-green-500 to-emerald-600"},{value:"emprestimos",label:"Mais Empr\xe9stimos",icon:Yk,color:"from-purple-500 to-violet-600"},{value:"demitidos",label:"Funcion\xe1rios Inativos",icon:Gk,color:"from-red-500 to-red-600"}],m=h.find(e=>e.value===r);return(0,k.jsxs)("div",{className:"flex flex-col lg:flex-row items-stretch lg:items-center gap-4",children:[(0,k.jsxs)(Cd.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.3},className:"relative flex-1 max-w-lg",children:[(0,k.jsx)("div",{className:"absolute left-4 top-1/2 transform -translate-y-1/2 z-10",children:(0,k.jsx)(Ft,{className:"w-5 h-5 text-gray-400"})}),(0,k.jsx)("input",{type:"text",placeholder:"Buscar funcion\xe1rios...",value:n,onChange:e=>s(e.target.value),className:"w-full pl-12 pr-4 py-3.5 rounded-2xl text-sm bg-white/80 backdrop-blur-sm dark:bg-gray-800/80 border border-white/20 dark:border-gray-700/50 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500/50 focus:border-blue-500/50 focus:bg-white dark:focus:bg-gray-800 transition-all duration-300 shadow-lg shadow-blue-500/10 dark:shadow-blue-500/5"}),n&&(0,k.jsx)(Cd.button,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},whileHover:{scale:1.1},whileTap:{scale:.9},onClick:()=>s(""),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors",children:(0,k.jsx)(Id,{className:"w-4 h-4"})})]}),(0,k.jsxs)(Cd.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{duration:.3,delay:.1},className:"flex items-center gap-3",children:[(0,k.jsxs)("div",{className:"relative",children:[(0,k.jsxs)(Cd.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>u(!d),className:"flex items-center gap-3 px-4 py-3 rounded-xl bg-gradient-to-r ".concat((null===m||void 0===m?void 0:m.color)||"from-gray-500 to-gray-600"," text-white shadow-lg hover:shadow-xl transition-all duration-300 min-w-[160px]"),children:[(0,k.jsx)(m.icon,{className:"w-4 h-4"}),(0,k.jsx)("span",{className:"text-sm font-medium truncate",children:null===m||void 0===m?void 0:m.label}),(0,k.jsx)(tw,{className:"w-4 h-4 ml-auto"})]}),(0,k.jsx)(Pr,{children:d&&(0,k.jsx)(Cd.div,{initial:{opacity:0,scale:.95,y:-10},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:-10},transition:{duration:.2},className:"absolute top-full left-0 mt-2 w-64 bg-white/95 backdrop-blur-sm dark:bg-gray-800/95 border border-white/20 dark:border-gray-700/50 rounded-2xl shadow-2xl shadow-black/10 dark:shadow-black/25 py-2 z-50",children:h.map((e,t)=>(0,k.jsxs)(Cd.button,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{duration:.2,delay:.05*t},whileHover:{x:4,scale:1.02},onClick:()=>{a(e.value),u(!1)},className:"w-full px-4 py-3 text-left text-sm font-medium rounded-xl mx-2 transition-all duration-200 flex items-center gap-3 ".concat(r===e.value?"bg-gradient-to-r ".concat(e.color," text-white shadow-lg"):"text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700/50"),children:[(0,k.jsx)(e.icon,{className:"w-4 h-4 ".concat(r===e.value?"text-white":"text-gray-600 dark:text-gray-400")}),(0,k.jsx)("span",{children:e.label}),r===e.value&&(0,k.jsx)(Cd.div,{initial:{scale:0},animate:{scale:1},className:"ml-auto w-2 h-2 bg-white rounded-full"})]},e.value))})})]}),o&&(0,k.jsxs)(Cd.button,{whileHover:{scale:1.05,y:-2},whileTap:{scale:.95},onClick:i,className:"flex items-center gap-2 px-4 py-3 rounded-xl bg-gradient-to-r from-indigo-500 to-purple-600 hover:from-indigo-600 hover:to-purple-700 text-white shadow-lg hover:shadow-xl transition-all duration-300 font-medium",title:"Gerenciar grupos de funcion\xe1rios",children:[(0,k.jsx)(Xk,{className:"w-4 h-4"}),(0,k.jsx)("span",{className:"hidden sm:inline",children:"Grupos"})]}),(0,k.jsx)(Cd.button,{whileHover:{scale:1.1,rotate:15},whileTap:{scale:.9},onClick:()=>c(!0),className:"p-3 text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200 transition-colors",title:"Ajuda",children:(0,k.jsx)(Rt,{className:"w-5 h-5"})})]}),(0,k.jsx)(Pr,{children:l&&(0,k.jsx)(Cd.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4",onClick:()=>c(!1),children:(0,k.jsxs)(Cd.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},className:"bg-white/95 backdrop-blur-sm dark:bg-gray-800/95 rounded-3xl p-8 max-w-3xl w-full mx-4 relative border border-white/20 dark:border-gray-700/50 shadow-2xl",onClick:e=>e.stopPropagation(),children:[(0,k.jsx)(Cd.button,{whileHover:{scale:1.1,rotate:90},whileTap:{scale:.9},onClick:()=>c(!1),className:"absolute top-6 right-6 p-2 text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200 transition-colors",children:(0,k.jsx)(Id,{className:"w-5 h-5"})}),(0,k.jsxs)("div",{className:"flex items-center gap-4 mb-8",children:[(0,k.jsx)(Xb,{className:"w-8 h-8 text-blue-600 dark:text-blue-400"}),(0,k.jsxs)("div",{children:[(0,k.jsx)("h2",{className:"text-3xl font-bold bg-gradient-to-r from-gray-900 to-gray-700 dark:from-white dark:to-gray-200 bg-clip-text text-transparent",children:"Guia do Sistema"}),(0,k.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"Entenda como funciona a gest\xe3o de funcion\xe1rios"})]})]}),(0,k.jsxs)("div",{className:"grid md:grid-cols-2 gap-6",children:[(0,k.jsxs)(Cd.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.2},className:"space-y-4",children:[(0,k.jsxs)("div",{className:"flex items-start gap-3",children:[(0,k.jsx)(Ld,{className:"w-6 h-6 text-yellow-600 dark:text-yellow-400 flex-shrink-0 mt-1"}),(0,k.jsxs)("div",{children:[(0,k.jsx)("h3",{className:"font-semibold text-gray-900 dark:text-white mb-1",children:"Sistema de Avalia\xe7\xf5es"}),(0,k.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Medidor circular mostra a m\xe9dia de avalia\xe7\xf5es de desempenho. Martelo representa avalia\xe7\xf5es de tarefas espec\xedficas."})]})]}),(0,k.jsxs)("div",{className:"flex items-start gap-3",children:[(0,k.jsx)(Pd,{className:"w-6 h-6 text-green-600 dark:text-green-400 flex-shrink-0 mt-1"}),(0,k.jsxs)("div",{children:[(0,k.jsx)("h3",{className:"font-semibold text-gray-900 dark:text-white mb-1",children:"Estat\xedsticas"}),(0,k.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Acompanhe tarefas conclu\xeddas, em andamento e empr\xe9stimos ativos em tempo real."})]})]})]}),(0,k.jsxs)(Cd.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{delay:.3},className:"space-y-4",children:[(0,k.jsxs)("div",{className:"flex items-start gap-3",children:[(0,k.jsx)(Wd,{className:"w-6 h-6 text-purple-600 dark:text-purple-400 flex-shrink-0 mt-1"}),(0,k.jsxs)("div",{children:[(0,k.jsx)("h3",{className:"font-semibold text-gray-900 dark:text-white mb-1",children:"Sistema de Pontos"}),(0,k.jsxs)("ul",{className:"text-sm text-gray-600 dark:text-gray-400 space-y-1",children:[(0,k.jsx)("li",{children:"\u2022 20 pontos por ferramenta devolvida"}),(0,k.jsx)("li",{children:"\u2022 50 pontos por tarefa conclu\xedda"}),(0,k.jsx)("li",{children:"\u2022 At\xe9 50 pontos por avalia\xe7\xe3o m\xe9dia"})]})]})]}),(0,k.jsxs)("div",{className:"flex items-start gap-3",children:[(0,k.jsx)(tw,{className:"w-5 h-5 text-blue-600 dark:text-blue-400 flex-shrink-0"}),(0,k.jsxs)("div",{children:[(0,k.jsx)("h3",{className:"font-semibold text-gray-900 dark:text-white mb-1",children:"Filtros Inteligentes"}),(0,k.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Use os filtros para encontrar rapidamente funcion\xe1rios por desempenho, atividade ou status."})]})]})]})]}),(0,k.jsxs)(Cd.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},className:"mt-8 p-4 bg-gradient-to-r from-blue-50 to-purple-50 dark:from-blue-900/20 dark:to-purple-900/20 rounded-2xl border border-blue-200/50 dark:border-blue-700/30",children:[(0,k.jsx)("h4",{className:"font-semibold text-blue-900 dark:text-blue-300 mb-2",children:"\ud83d\udca1 Dica Pro"}),(0,k.jsx)("p",{className:"text-sm text-blue-800 dark:text-blue-400",children:"Clique em qualquer funcion\xe1rio para ver seu perfil detalhado com hist\xf3rico completo de atividades e desempenho."})]})]})})})]})},Zk=y("target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]),$k=y("ellipsis-vertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]),eN=y("gauge",[["path",{d:"m12 14 4-4",key:"9kzdfg"}],["path",{d:"M3.34 19a10 10 0 1 1 17.32 0",key:"19p75a"}]]),tN=y("thumbs-up",[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2a3.13 3.13 0 0 1 3 3.88Z",key:"emmmcr"}]]),rN=e=>{let{rating:t}=e;const r=Math.min(Math.max(t/5*100,0),100);return(0,k.jsx)("div",{className:"flex items-center",children:(0,k.jsxs)("div",{className:"relative w-3.5 h-3.5",children:[(0,k.jsx)(Ld,{className:"w-3.5 h-3.5 absolute text-yellow-400",strokeWidth:1.5}),(0,k.jsx)("div",{className:"absolute w-full h-full overflow-hidden",style:{clipPath:"inset(0 ".concat(100-r,"% 0 0)")},children:(0,k.jsx)(Ld,{className:"w-3.5 h-3.5 text-yellow-400 fill-yellow-400",strokeWidth:1.5})})]})})},aN=e=>{let{avaliacoes:t,tipo:r,avaliacoesExpandidas:a,setAvaliacoesExpandidas:n,funcionarioId:s,calcularMediaAvaliacoesDesempenho:i}=e;const o=t.filter(e=>"desempenho"===r?"desempenho"===e.tipo:"autoavaliacao"===r?!0===e.isAutoAvaliacao:"regular"===e.tipo&&!e.isAutoAvaliacao);if(0===o.length)return null;"desempenho"===r&&o.length>0&&(o.reduce((e,t)=>e+(t.nota||0),0)/o.length).toFixed(1);return(0,k.jsxs)("div",{className:"bg-white dark:bg-gray-700 rounded-xl p-3 mb-3",children:[(0,k.jsx)("button",{onClick:e=>{e.stopPropagation(),n(a===s?null:s)},className:"w-full hover:bg-[#2C3E50] rounded-lg transition-colors p-2",children:(0,k.jsxs)("div",{className:"flex items-center justify-between",children:[(0,k.jsxs)("div",{className:"flex items-center gap-2",children:["autoavaliacao"===r?(0,k.jsx)(uk,{className:"w-5 h-5 text-blue-500 dark:text-[#1D9BF0]"}):"desempenho"===r?(0,k.jsx)(eN,{className:"w-5 h-5 text-blue-500 dark:text-[#1D9BF0]"}):(0,k.jsx)(tN,{className:"w-5 h-5 text-blue-500 dark:text-[#1D9BF0]"}),(0,k.jsx)("span",{className:"text-sm font-bold text-gray-900 dark:text-white",children:"desempenho"===r?"Avalia\xe7\xf5es de Desempenho":"autoavaliacao"===r?"Autoavalia\xe7\xf5es":"Avalia\xe7\xf5es de Tarefas"}),(0,k.jsx)("div",{className:"flex items-center",children:(0,k.jsx)("span",{className:"text-xs text-gray-500 dark:text-gray-400 ml-2",children:a===s?"Clique para recolher":"Clique para ver (".concat(o.length,")")})})]}),(0,k.jsx)("svg",{className:"w-5 h-5 text-gray-500 dark:text-gray-400 transform transition-transform duration-200 ".concat(a===s?"rotate-180":""),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,k.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})}),a===s&&(0,k.jsx)("div",{className:"mt-3",children:(0,k.jsx)("div",{className:"max-h-[400px] overflow-y-auto scrollbar-thin scrollbar-thumb-[#38444D] scrollbar-track-[#192734]",children:o.sort((e,t)=>new Date(t.data)-new Date(e.data)).map((e,t)=>(0,k.jsxs)("div",{className:"bg-[#1E2732] rounded-lg p-3 border border-gray-200 dark:border-gray-600 min-h-[180px] flex flex-col",children:[(0,k.jsxs)("div",{className:"space-y-2 mb-3",children:[e.tipoAvaliacao&&(0,k.jsx)("div",{children:(0,k.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,k.jsxs)("div",{className:"flex items-center gap-2",children:[(0,k.jsx)("span",{className:"text-xs px-2 py-1 rounded-md font-medium ".concat(e.isAutoAvaliacao?"bg-blue-500/20 text-blue-400":Vk(e.tipoAvaliacao).cor),children:e.isAutoAvaliacao?"Autoavalia\xe7\xe3o":Vk(e.tipoAvaliacao).label}),"tarefa"===e.tipoAvaliacao&&e.nomeTarefa&&(0,k.jsxs)("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:["- ",e.nomeTarefa]})]}),"tarefa"===e.tipoAvaliacao&&e.descricaoTarefa&&(0,k.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 leading-relaxed pl-2",children:e.descricaoTarefa})]})}),(0,k.jsxs)("div",{className:"flex flex-col space-y-2",children:["                      ",(0,k.jsxs)("div",{className:"flex items-center gap-2",children:[(0,k.jsxs)("div",{className:"flex items-center gap-1 bg-white dark:bg-gray-700 px-2 py-1 rounded-md",children:[(0,k.jsx)(xu,{className:"w-3 h-3 text-blue-500 dark:text-[#1D9BF0]"}),(0,k.jsxs)("span",{className:"text-xs text-gray-900 dark:text-white",children:[new Date(e.data).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"2-digit"}),", ",e.hora||"00:00"]})]}),(0,k.jsxs)("div",{className:"flex items-center justify-between flex-1 bg-white dark:bg-gray-700 px-2 py-1 rounded-md",children:[(0,k.jsxs)("div",{className:"flex items-center gap-1",children:[(0,k.jsx)(uk,{className:"w-3 h-3 text-blue-500 dark:text-[#1D9BF0]"}),(0,k.jsx)("span",{className:"text-xs text-gray-900 dark:text-white",children:e.anonimo||e.anonima?"An\xf4nimo":e.avaliador||e.autor||e.supervisorNome})]}),(0,k.jsxs)("div",{className:"flex items-center gap-1",children:[(0,k.jsx)(rN,{rating:Number(e.nota||e.estrelas||0)}),(0,k.jsx)("span",{className:"text-xs text-gray-900 dark:text-white",children:(e.nota||e.estrelas||0).toFixed(1)})]})]})]})]})]}),e.comentario&&(0,k.jsx)("div",{className:"bg-white dark:bg-gray-700 rounded-md p-2",children:(0,k.jsx)("p",{className:"text-gray-500 dark:text-gray-400 text-sm leading-relaxed",children:e.comentario})})]},t))})})]})},nN=y("copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]),sN=e=>{let t=e.replace(/\D/g,"").match(/^(\d{2})(\d{4,5})(\d{4})$/);return t?"(".concat(t[1],") ").concat(t[2],"-").concat(t[3]):e},iN=e=>{const t=e.replace(/\D/g,"");return"https://wa.me/55".concat(t)},oN=t=>{let{funcionario:r}=t;const[a,n]=(0,e.useState)(!1);return r?(0,k.jsxs)("div",{className:"space-y-2 pt-3 border-t border-gray-200 dark:border-gray-600",children:[r.setor&&(0,k.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,k.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-gray-500 dark:text-gray-400",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:(0,k.jsx)("path",{d:"M19 21V5a2 2 0 0 0-2-2H7a2 2 0 0 0-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5m4 0v-5a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v5m-4 0h4"})}),(0,k.jsx)("span",{className:"text-gray-500 dark:text-gray-400",children:r.setor})]}),r.email&&(0,k.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,k.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-gray-500 dark:text-gray-400",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:(0,k.jsx)("path",{d:"M21.75 6.75v10.5a2.25 2.25 0 01-2.25 2.25h-15a2.25 2.25 0 01-2.25-2.25V6.75m19.5 0A2.25 2.25 0 0019.5 4.5h-15a2.25 2.25 0 00-2.25 2.25m19.5 0v.243a2.25 2.25 0 01-1.07 1.916l-7.5 4.615a2.25 2.25 0 01-2.36 0L3.32 8.91a2.25 2.25 0 01-1.07-1.916V6.75"})}),(0,k.jsx)("span",{className:"text-gray-500 dark:text-gray-400 truncate",children:r.email})]}),r.telefone&&(0,k.jsxs)("div",{className:"flex items-center gap-2 text-sm bg-white dark:bg-gray-700 rounded-xl p-3",children:[(0,k.jsx)("a",{href:iN(r.telefone),target:"_blank",rel:"noopener noreferrer",onClick:e=>e.stopPropagation(),className:"w-8 h-8 rounded-lg bg-green-500/10 flex items-center justify-center hover:bg-green-500/20 transition-colors",title:"Abrir conversa no WhatsApp",children:(0,k.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",className:"w-5 h-5",children:[(0,k.jsx)("path",{fill:"#25D366",d:"M256.064,0h-0.128C114.784,0,0,114.816,0,256c0,56,18.048,107.904,48.736,150.048l-31.904,95.104  l98.4-31.456C155.712,496.512,204,512,256.064,512C397.216,512,512,397.152,512,256S397.216,0,256.064,0z"}),(0,k.jsx)("path",{fill:"#FFFFFF",d:"M405.024,361.504c-6.176,17.44-30.688,31.904-50.24,36.128c-13.376,2.848-30.848,5.12-89.664-19.264  c-75.232-31.168-123.68-107.616-127.456-112.576c-3.616-4.96-30.4-40.48-30.4-77.216s18.656-54.624,26.176-62.304  c6.176-6.304,16.384-9.184,26.176-9.184c3.168,0,6.016,0.16,8.576,0.288c7.52,0.32,11.296,0.768,16.256,12.64  c6.176,14.88,21.216,51.616,23.008,55.392c1.824,3.776,3.648,8.896,1.088,13.856c-2.4,5.12-4.512,7.392-8.288,11.744  c-3.776,4.352-7.36,7.68-11.136,12.352c-3.456,4.064-7.36,8.416-3.008,15.936c4.352,7.36,19.392,31.904,41.536,51.616  c28.576,25.44,51.744,33.568,60.032,37.024c6.176,2.56,13.536,1.952,18.048-2.848c5.728-6.176,12.8-16.416,20-26.496  c5.12-7.232,11.584-8.128,18.368-5.568c6.912,2.4,43.488,20.48,51.008,24.224c7.52,3.776,12.48,5.568,14.304,8.736  C411.2,329.152,411.2,344.032,405.024,361.504z"})]})}),(0,k.jsxs)("div",{className:"flex-1",children:[(0,k.jsx)("span",{className:"text-gray-500 dark:text-gray-400 text-xs",children:"WhatsApp"}),(0,k.jsx)("p",{className:"text-gray-900 dark:text-white font-medium",children:sN(r.telefone)})]}),(0,k.jsx)("button",{onClick:e=>{e.stopPropagation(),(async e=>{try{await navigator.clipboard.writeText(e),n(!0),setTimeout(()=>n(!1),2e3)}catch(t){console.error("Erro ao copiar:",t)}})(r.telefone)},className:"w-8 h-8 rounded-lg bg-blue-500 dark:bg-[#1D9BF0]/10 flex items-center justify-center hover:bg-blue-500 dark:bg-[#1D9BF0]/20 transition-colors",title:"Copiar n\xfamero",children:a?(0,k.jsx)(lk,{className:"w-4 h-4 text-green-500"}):(0,k.jsx)(nN,{className:"w-4 h-4 text-blue-500 dark:text-[#1D9BF0]"})})]})]}):null},lN=t=>{var r,a;let{funcionario:n,funcionariosStats:s,funcionariosPontos:i,isFuncionario:o,readonly:l,avaliacoesExpandidas:c,avaliacoesDesempenhoExpandidas:d,setAvaliacoesExpandidas:u,setAvaliacoesDesempenhoExpandidas:h,handleEditar:m,confirmarExclusao:f,calcularMediaAvaliacoesDesempenho:g,onClick:p,demitirFuncionario:x,reintegrarFuncionario:y,filtroAtual:b}=t;const[w,N]=(0,e.useState)(!1),j=(0,e.useRef)(null);(0,e.useEffect)(()=>{const e=e=>{j.current&&!j.current.contains(e.target)&&N(!1)};return w&&document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[w]);const S=s[n.id]||{},_=i[n.id]||{},E=Number(S.mediaAvaliacao)||0,A=S.tarefasConcluidas||0,C=S.emprestimosAtivos||0;return(0,k.jsxs)(Cd.div,{whileHover:{y:-8,scale:1.02},transition:{duration:.3,ease:"easeOut"},className:"group relative overflow-hidden bg-white/80 backdrop-blur-sm dark:bg-gray-800/80 rounded-2xl border border-white/20 dark:border-gray-700/50 hover:border-blue-400/50 dark:hover:border-blue-500/50 transition-all duration-500 hover:shadow-2xl hover:shadow-blue-500/25 dark:hover:shadow-blue-500/10 cursor-pointer ".concat(n.demitido&&"demitidos"!==b?"opacity-60":""),onClick:p,children:[(0,k.jsx)("div",{className:"absolute inset-0 bg-gradient-to-br from-blue-50/50 via-white/50 to-purple-50/50 dark:from-blue-900/10 dark:via-gray-800/50 dark:to-purple-900/10 opacity-0 group-hover:opacity-100 transition-opacity duration-500"}),(0,k.jsx)("div",{className:"absolute left-0 top-0 bottom-0 w-1.5 rounded-l-2xl ".concat(n.demitido?"bg-gradient-to-b from-red-400 to-red-600":"bg-gradient-to-b from-blue-400 via-purple-500 to-blue-600"," shadow-lg"),children:(0,k.jsx)("div",{className:"absolute inset-0 bg-gradient-to-b from-white/30 to-transparent rounded-l-2xl"})}),(0,k.jsxs)("div",{className:"relative pl-6 pr-5 py-6",children:[(0,k.jsxs)("div",{className:"flex items-start justify-between mb-6",children:[(0,k.jsxs)("div",{className:"flex items-start gap-4 flex-1 min-w-0",children:[(0,k.jsxs)(Cd.div,{whileHover:{scale:1.1,rotate:5},transition:{duration:.2},className:"relative flex-shrink-0",children:[n.photoURL?(0,k.jsxs)("div",{className:"relative",children:[(0,k.jsx)("img",{src:n.photoURL,alt:n.nome,className:"w-16 h-16 rounded-2xl object-cover ring-4 ring-white/50 dark:ring-gray-700/50 shadow-xl"}),(0,k.jsx)("div",{className:"absolute inset-0 rounded-2xl bg-gradient-to-t from-black/20 via-transparent to-white/20"})]}):(0,k.jsx)("div",{className:"w-16 h-16 bg-gradient-to-br from-blue-100 to-purple-100 dark:from-blue-900/50 dark:to-purple-900/50 rounded-2xl flex items-center justify-center relative ring-4 ring-white/50 dark:ring-gray-700/50 shadow-xl",children:(0,k.jsx)("span",{className:"text-blue-600 dark:text-blue-400 text-xl font-bold",children:(null===(r=n.nome)||void 0===r||null===(a=r.charAt(0))||void 0===a?void 0:a.toUpperCase())||"F"})}),n.demitido?(0,k.jsx)(Cd.div,{initial:{scale:0},animate:{scale:1},className:"absolute -top-2 -right-2",children:(0,k.jsx)(Gk,{className:"w-5 h-5 text-red-500 dark:text-red-400"})}):(0,k.jsx)(Cd.div,{animate:{scale:[1,1.2,1],opacity:[.7,1,.7]},transition:{duration:2,repeat:1/0,ease:"easeInOut"},className:"absolute -top-1 -right-1 w-3 h-3 bg-green-400 rounded-full"})]}),(0,k.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,k.jsxs)(Cd.div,{whileHover:{x:4},transition:{duration:.2},className:"flex items-center gap-3 mb-2",children:[(0,k.jsx)("h3",{className:"text-xl font-bold bg-gradient-to-r from-gray-900 to-gray-700 dark:from-white dark:to-gray-200 bg-clip-text text-transparent truncate hover:from-blue-600 hover:to-purple-600 dark:hover:from-blue-400 dark:hover:to-purple-400 transition-all duration-300",children:n.nome}),n.demitido&&(0,k.jsxs)(Cd.span,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},className:"inline-flex items-center gap-1 px-3 py-1 rounded-full text-xs font-semibold bg-gradient-to-r from-red-100 to-red-200 text-red-700 dark:from-red-900/30 dark:to-red-800/30 dark:text-red-400 shadow-sm",children:[(0,k.jsx)(Gk,{className:"w-3 h-3"}),"Inativo"]})]}),(0,k.jsxs)("div",{className:"space-y-2",children:[(0,k.jsxs)("div",{className:"flex items-center gap-2",children:[(0,k.jsx)(Kb,{className:"w-4 h-4 text-blue-600 dark:text-blue-400"}),(0,k.jsx)("p",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300 truncate",children:n.cargo||"Cargo n\xe3o definido"})]}),n.matricula&&(0,k.jsxs)("div",{className:"flex items-center gap-2",children:[(0,k.jsx)(Zk,{className:"w-4 h-4 text-green-600 dark:text-green-400"}),(0,k.jsxs)("p",{className:"text-xs font-medium text-gray-600 dark:text-gray-400",children:["ID: ",n.matricula]})]})]})]})]}),!o&&!l&&(0,k.jsxs)("div",{className:"relative flex-shrink-0",ref:j,children:[(0,k.jsx)(Cd.button,{whileHover:{scale:1.1},whileTap:{scale:.9},onClick:e=>{e.stopPropagation(),N(!w)},className:"p-2 text-gray-500 hover:text-gray-700 dark:hover:text-gray-300 transition-colors",title:"Op\xe7\xf5es",children:(0,k.jsx)($k,{className:"w-5 h-5"})}),(0,k.jsx)(Pr,{children:w&&(0,k.jsxs)(Cd.div,{initial:{opacity:0,scale:.95,y:-10},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:-10},transition:{duration:.2},className:"absolute top-full right-0 mt-2 w-56 bg-white/95 backdrop-blur-sm dark:bg-gray-800/95 border border-white/20 dark:border-gray-700/50 rounded-2xl shadow-2xl shadow-black/10 dark:shadow-black/25 py-2 z-50",children:[(0,k.jsxs)(Cd.button,{whileHover:{x:4,backgroundColor:"rgba(59, 130, 246, 0.1)"},transition:{duration:.2},onClick:e=>{e.stopPropagation(),N(!1),m(n)},className:"w-full px-4 py-3 text-left text-sm font-medium text-gray-700 dark:text-gray-300 rounded-xl mx-2 transition-all duration-200 flex items-center gap-3",children:[(0,k.jsx)(gw,{className:"w-4 h-4 text-blue-600 dark:text-blue-400"}),(0,k.jsx)("span",{children:"Editar Funcion\xe1rio"})]}),n.demitido?(0,k.jsxs)(Cd.button,{whileHover:{x:4,backgroundColor:"rgba(34, 197, 94, 0.1)"},transition:{duration:.2},onClick:e=>{e.stopPropagation(),N(!1),y(n)},className:"w-full px-4 py-3 text-left text-sm font-medium text-gray-700 dark:text-gray-300 rounded-xl mx-2 transition-all duration-200 flex items-center gap-3",children:[(0,k.jsx)(T,{className:"w-4 h-4 text-green-600 dark:text-green-400"}),(0,k.jsx)("span",{children:"Reintegrar"})]}):(0,k.jsxs)(Cd.button,{whileHover:{x:4,backgroundColor:"rgba(234, 179, 8, 0.1)"},transition:{duration:.2},onClick:e=>{e.stopPropagation(),N(!1),x(n)},className:"w-full px-4 py-3 text-left text-sm font-medium text-gray-700 dark:text-gray-300 rounded-xl mx-2 transition-all duration-200 flex items-center gap-3",children:[(0,k.jsx)(Gk,{className:"w-4 h-4 text-yellow-600 dark:text-yellow-400"}),(0,k.jsx)("span",{children:"Demitir"})]}),(0,k.jsxs)(Cd.button,{whileHover:{x:4,backgroundColor:"rgba(239, 68, 68, 0.1)"},transition:{duration:.2},onClick:e=>{e.stopPropagation(),N(!1),f(n)},className:"w-full px-4 py-3 text-left text-sm font-medium text-gray-700 dark:text-gray-300 rounded-xl mx-2 transition-all duration-200 flex items-center gap-3",children:[(0,k.jsx)(nw,{className:"w-4 h-4 text-red-600 dark:text-red-400"}),(0,k.jsx)("span",{children:"Excluir"})]})]})})]})]}),(0,k.jsxs)("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3 mb-6",children:[(0,k.jsxs)(Cd.div,{whileHover:{scale:1.05},className:"flex flex-col items-center p-3 bg-gradient-to-br from-yellow-50 to-orange-50 dark:from-yellow-900/20 dark:to-orange-900/20 rounded-xl border border-yellow-200/50 dark:border-yellow-700/30",children:[(0,k.jsxs)("div",{className:"flex items-center gap-1 mb-1",children:[(0,k.jsx)(Ld,{className:"w-4 h-4 text-yellow-600 dark:text-yellow-400"}),(0,k.jsx)("span",{className:"text-lg font-bold text-yellow-700 dark:text-yellow-300",children:E.toFixed(1)})]}),(0,k.jsx)("span",{className:"text-xs font-medium text-yellow-600 dark:text-yellow-400",children:"Avalia\xe7\xe3o"})]}),(0,k.jsxs)(Cd.div,{whileHover:{scale:1.05},className:"flex flex-col items-center p-3 bg-gradient-to-br from-blue-50 to-indigo-50 dark:from-blue-900/20 dark:to-indigo-900/20 rounded-xl border border-blue-200/50 dark:border-blue-700/30",children:[(0,k.jsxs)("div",{className:"flex items-center gap-1 mb-1",children:[(0,k.jsx)(v,{className:"w-4 h-4 text-blue-600 dark:text-blue-400"}),(0,k.jsx)("span",{className:"text-lg font-bold text-blue-700 dark:text-blue-300",children:A})]}),(0,k.jsx)("span",{className:"text-xs font-medium text-blue-600 dark:text-blue-400",children:"Tarefas"})]}),(0,k.jsxs)(Cd.div,{whileHover:{scale:1.05},className:"flex flex-col items-center p-3 bg-gradient-to-br from-purple-50 to-violet-50 dark:from-purple-900/20 dark:to-violet-900/20 rounded-xl border border-purple-200/50 dark:border-purple-700/30",children:[(0,k.jsxs)("div",{className:"flex items-center gap-1 mb-1",children:[(0,k.jsx)(Yk,{className:"w-4 h-4 text-purple-600 dark:text-purple-400"}),(0,k.jsx)("span",{className:"text-lg font-bold text-purple-700 dark:text-purple-300",children:C})]}),(0,k.jsx)("span",{className:"text-xs font-medium text-purple-600 dark:text-purple-400",children:"Ativos"})]}),(0,k.jsxs)(Cd.div,{whileHover:{scale:1.05},className:"flex flex-col items-center p-3 bg-gradient-to-br from-emerald-50 to-green-50 dark:from-emerald-900/20 dark:to-green-900/20 rounded-xl border border-emerald-200/50 dark:border-emerald-700/30",children:[(0,k.jsxs)("div",{className:"flex items-center gap-1 mb-1",children:[(0,k.jsx)(nu,{className:"w-4 h-4 text-emerald-600 dark:text-emerald-400"}),(0,k.jsx)("span",{className:"text-lg font-bold text-emerald-700 dark:text-emerald-300",children:_.total||0})]}),(0,k.jsx)("span",{className:"text-xs font-medium text-emerald-600 dark:text-emerald-400",children:"Pontos"})]})]}),(0,k.jsx)(oN,{funcionario:n}),n.avaliacoes&&n.avaliacoes.length>0&&(0,k.jsx)("div",{className:"mt-4",children:(0,k.jsx)(aN,{func:n,avaliacoesExpandidas:c,setAvaliacoesExpandidas:u,avaliacoesDesempenhoExpandidas:d,setAvaliacoesDesempenhoExpandidas:h,calcularMediaAvaliacoesDesempenho:g})})]})]})},cN=y("camera",[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]),dN=e=>{let t=e.replace(/\D/g,"").match(/^(\d{2})(\d{4,5})(\d{4})$/);return t?"(".concat(t[1],") ").concat(t[2],"-").concat(t[3]):e},uN=e=>{let{editando:t,formEdit:r,setFormEdit:a,handleSalvarEdicao:s,setEditando:i,preview:o,setPreview:l,fileInputRef:c,loading:d}=e;return(0,k.jsx)("div",{className:"fixed inset-0 bg-black/50 dark:bg-black/70 dark:bg-black/70 flex items-center justify-center z-50",children:(0,k.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-2xl max-w-md w-full mx-4 p-6 border border-gray-200 dark:border-gray-600",children:[(0,k.jsx)("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-6",children:"Editar Funcion\xe1rio"}),(0,k.jsxs)("div",{className:"space-y-4",children:[(0,k.jsx)("div",{className:"flex justify-center mb-6",children:(0,k.jsxs)("div",{className:"relative",children:[o?(0,k.jsxs)("div",{className:"relative",children:[(0,k.jsx)("img",{src:o,alt:"Preview",className:"w-32 h-32 rounded-full object-cover border-4 border-gray-200 dark:border-gray-600",onError:e=>{e.target.onerror=null,l(null),a(e=>(0,n.A)((0,n.A)({},e),{},{photoURL:""}))}}),(0,k.jsx)("button",{onClick:e=>{e.preventDefault(),l(null),a(e=>(0,n.A)((0,n.A)({},e),{},{photoURL:""})),c.current&&(c.current.value="")},className:"absolute -top-2 -right-2 bg-red-500 text-gray-900 dark:text-white rounded-full p-1 hover:bg-red-600 transition-colors",title:"Remover imagem",children:(0,k.jsx)(Id,{className:"w-4 h-4"})})]}):(0,k.jsx)("div",{className:"w-32 h-32 rounded-full bg-white dark:bg-gray-700 flex items-center justify-center border-4 border-gray-200 dark:border-gray-600",children:(0,k.jsx)(uk,{className:"w-16 h-16 text-gray-500 dark:text-gray-400"})}),(0,k.jsx)("button",{onClick:()=>{var e;return null===(e=c.current)||void 0===e?void 0:e.click()},className:"absolute bottom-0 right-0 bg-blue-500 dark:bg-[#1D9BF0] text-gray-900 dark:text-white rounded-full p-2.5 hover:bg-blue-600 dark:hover:bg-[#1a8cd8] transition-colors",children:(0,k.jsx)(cN,{className:"w-5 h-5"})}),(0,k.jsx)("input",{type:"file",ref:c,onChange:e=>{const t=e.target.files[0];if(t){const e=new FileReader;e.onloadend=()=>{l(e.result)},e.readAsDataURL(t)}},accept:"image/*",className:"hidden"})]})}),(0,k.jsxs)("div",{className:"space-y-2",children:[(0,k.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"URL da Imagem"}),(0,k.jsx)("input",{type:"url",placeholder:"https://exemplo.com/imagem.jpg",value:r.photoURL||"",onChange:e=>{const t=e.target.value.trim();a(e=>(0,n.A)((0,n.A)({},e),{},{photoURL:t})),l(t||null)},className:"w-full px-4 py-2 rounded-lg text-sm bg-white dark:bg-gray-700 border border-gray-200 dark:border-gray-600 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-[#1D9BF0]"}),(0,k.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"ou"})]}),(0,k.jsx)("input",{type:"text",placeholder:"Nome",value:r.nome,onChange:e=>a((0,n.A)((0,n.A)({},r),{},{nome:e.target.value})),className:"w-full px-4 py-2 rounded-lg text-sm bg-white dark:bg-gray-700 border border-gray-200 dark:border-gray-600 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-[#1D9BF0]"}),(0,k.jsx)("input",{type:"text",placeholder:"Cargo",value:r.cargo,onChange:e=>a((0,n.A)((0,n.A)({},r),{},{cargo:e.target.value})),className:"w-full px-4 py-2 rounded-lg text-sm bg-white dark:bg-gray-700 border border-gray-200 dark:border-gray-600 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-[#1D9BF0]"}),(0,k.jsx)("input",{type:"text",placeholder:"(00) 00000-0000",value:r.telefone?dN(r.telefone):"",onChange:e=>a((0,n.A)((0,n.A)({},r),{},{telefone:e.target.value.replace(/[^0-9]/g,"")})),className:"w-full px-4 py-2 rounded-lg text-sm bg-white dark:bg-gray-700 border border-gray-200 dark:border-gray-600 text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-[#1D9BF0]",maxLength:15})]}),(0,k.jsxs)("div",{className:"flex justify-end gap-3 mt-6",children:[(0,k.jsx)("button",{onClick:()=>i(null),className:"px-4 py-2 text-gray-500 dark:text-gray-400 bg-gray-50 dark:bg-gray-700 hover:bg-gray-100 dark:hover:bg-gray-600 rounded-lg transition-colors",children:"Cancelar"}),(0,k.jsx)("button",{onClick:()=>s(r),className:"px-4 py-2 bg-blue-500 dark:bg-[#1D9BF0] hover:bg-blue-600 dark:hover:bg-[#1a8cd8] text-gray-900 dark:text-white rounded-lg transition-colors",disabled:d,children:d?"Salvando...":"Salvar"})]})]})})},hN=e=>{let{funcionario:t,onCancel:r,onConfirm:a,loading:n}=e;return(0,k.jsx)("div",{className:"fixed inset-0 bg-black/50 dark:bg-black/70 dark:bg-black/70 flex items-center justify-center z-50",children:(0,k.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-6 w-full max-w-md border border-gray-200 dark:border-gray-600",children:[(0,k.jsx)("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-4",children:"Confirmar Exclus\xe3o"}),(0,k.jsxs)("p",{className:"text-sm text-gray-500 dark:text-gray-400 mb-4",children:['Tem certeza que deseja excluir o funcion\xe1rio "',t.nome,'"? Esta a\xe7\xe3o n\xe3o pode ser desfeita.']}),(0,k.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,k.jsx)("button",{onClick:r,className:"px-4 py-2 text-sm text-gray-500 dark:text-gray-400 bg-gray-50 dark:bg-gray-700 hover:bg-gray-100 dark:hover:bg-gray-600 rounded-lg transition-colors",disabled:n,children:"Cancelar"}),(0,k.jsx)("button",{onClick:a,className:"px-4 py-2 text-sm text-gray-900 dark:text-white bg-red-600 hover:bg-red-700 rounded-lg transition-colors",disabled:n,children:n?"Excluindo...":"Excluir"})]})]})})},mN=e=>{let t=e.replace(/\D/g,"").match(/^(\d{2})(\d{4,5})(\d{4})$/);return t?"(".concat(t[1],") ").concat(t[2],"-").concat(t[3]):e},fN=t=>{let{funcionarios:r=[],adicionarFuncionario:a,removerFuncionario:i,atualizarFuncionario:o,readonly:l}=t;const[c,d]=(0,e.useState)({nome:"",cargo:"",telefone:""}),[u,h]=(0,e.useState)(!1),{showToast:m}=_(),[f,g]=(0,e.useState)(!1),[p,x]=(0,e.useState)(null),[y,v]=(0,e.useState)({nome:"",cargo:"",telefone:"",photoURL:""}),[b,w]=(0,e.useState)(!1),[N,j]=(0,e.useState)(null),[S,E]=(0,e.useState)(null),[A,C]=(0,e.useState)(null),[I,T]=(0,e.useState)(""),[F,L]=(0,e.useState)({}),[M,R]=(0,e.useState)({}),[O,B]=(0,e.useState)("nome"),[z,U]=(0,e.useState)(null),[V,q]=(0,e.useState)(null),H=(0,e.useRef)(),[G,W]=(0,e.useState)([]),[K,Q]=(0,e.useState)([]),[Y,X]=(0,e.useState)("todas"),[J,Z]=(0,e.useState)("todos"),$=e=>{const t=20*(e.ferramentasDevolvidas||0),r=50*(e.tarefasConcluidas||0),a=e.mediaAvaliacao?Math.round(10*e.mediaAvaliacao):0;return{total:t+r+a,detalhes:{ferramentas:t,tarefas:r,avaliacao:a}}},ee=(e,t)=>e.nome.localeCompare(t.nome),te=(e,t)=>{var r,a;return((null===(r=F[t.id])||void 0===r?void 0:r.mediaAvaliacao)||0)-((null===(a=F[e.id])||void 0===a?void 0:a.mediaAvaliacao)||0)},re=(e,t)=>{var r,a;return((null===(r=F[t.id])||void 0===r?void 0:r.tarefasConcluidas)||0)-((null===(a=F[e.id])||void 0===a?void 0:a.tarefasConcluidas)||0)},ae=(e,t)=>{var r,a;return((null===(r=F[t.id])||void 0===r?void 0:r.emprestimosAtivos)||0)-((null===(a=F[e.id])||void 0===a?void 0:a.emprestimosAtivos)||0)},ne=(e,t)=>{var r,a;return((null===(r=M[t.id])||void 0===r?void 0:r.total)||0)-((null===(a=M[e.id])||void 0===a?void 0:a.total)||0)},se=async e=>{try{const t=(0,n.A)((0,n.A)({},e),{},{demitido:!0,dataDemissao:(new Date).toISOString()});await o(e.id,t),m("Funcion\xe1rio demitido com sucesso!","success")}catch(t){console.error("Erro ao demitir funcion\xe1rio:",t),m("Erro ao demitir funcion\xe1rio","error")}},ie=async e=>{try{const t=(0,n.A)((0,n.A)({},e),{},{demitido:!1,dataDemissao:null,dataReintegracao:(new Date).toISOString()});await o(e.id,t),m("Funcion\xe1rio reintegrado com sucesso!","success")}catch(t){console.error("Erro ao reintegrar funcion\xe1rio:",t),m("Erro ao reintegrar funcion\xe1rio","error")}},oe=e=>{if(!e||0===e.length)return 0;const t=e.filter(e=>"desempenho"===e.tipo);if(0===t.length)return 0;return(t.reduce((e,t)=>e+(t.nota||t.estrelas||0),0)/t.length).toFixed(1)},le=(e=>{if(!e)return[];const t=I.toLowerCase();return e.filter(e=>{var r,a,n,s,i,o;const l=(null===(r=e.nome)||void 0===r?void 0:r.toLowerCase().includes(t))||(null===(a=e.cargo)||void 0===a?void 0:a.toLowerCase().includes(t))||(null===(n=e.telefone)||void 0===n?void 0:n.includes(I))||(null===(s=e.email)||void 0===s?void 0:s.toLowerCase().includes(t))||(null===(i=e.matricula)||void 0===i?void 0:i.toLowerCase().includes(t))||(null===(o=e.setor)||void 0===o?void 0:o.toLowerCase().includes(t)),c="todas"===Y||e.empresaId===Y,d="todos"===J||e.setorId===J;return"demitidos"===O?l&&c&&d&&!0===e.demitido:l&&c&&d&&!e.demitido})})(r),ce="todas"===Y?K:K.filter(e=>e.empresaId===Y),{usuario:de}=Nt(),ue="funcionario"===(null===de||void 0===de?void 0:de.nivel);(0,e.useEffect)(()=>{(async()=>{try{const[e,t]=await Promise.all([(0,s.GG)((0,s.collection)(P.db,"empresas")),(0,s.GG)((0,s.collection)(P.db,"setores"))]);W(e.docs.map(e=>(0,n.A)({id:e.id},e.data()))),Q(t.docs.map(e=>(0,n.A)({id:e.id},e.data())))}catch(e){console.error("Erro ao carregar empresas e setores:",e)}})()},[]),(0,e.useEffect)(()=>{r.length>0&&(async()=>{const e={};for(const t of r){const r=(0,s.collection)(P.db,"tarefas"),a=(0,s.collection)(P.db,"emprestimos"),i=(0,s.collection)(P.db,"avaliacoes"),o=(0,s.collection)(P.db,"avaliacoesDesempenho"),[l,c,d,u,h,m,f]=await Promise.all([(0,s.GG)((0,s.P)(r,(0,s._M)("funcionariosIds","array-contains",t.nome))),(0,s.GG)((0,s.P)(r,(0,s._M)("funcionario","==",t.nome))),(0,s.GG)((0,s.P)(r,(0,s._M)("funcionario","==",t.nome.toLowerCase()))),(0,s.GG)((0,s.P)(r,(0,s._M)("responsavel","==",t.nome))),(0,s.GG)((0,s.P)(r,(0,s._M)("responsavel","==",t.nome.toLowerCase()))),(0,s.GG)((0,s.P)(i,(0,s._M)("funcionarioId","==",t.id))),(0,s.GG)((0,s.P)(o,(0,s._M)("funcionarioId","==",t.id)))]);let g=0,p=0,x=0,y=0;const v=[];m.forEach(e=>{const t=e.data(),r="avaliacao_supervisor"===t.tipo;v.push((0,n.A)((0,n.A)({},t),{},{id:e.id,tipo:r?"desempenho":"regular",nota:Number(t.estrelas||t.nota||0),data:t.data||(new Date).toISOString()}))}),f.forEach(e=>{const t=e.data();v.push((0,n.A)((0,n.A)({},t),{},{id:e.id,tipo:"desempenho",nota:Number(t.estrelas||t.nota||0),comentario:t.comentario||"Avalia\xe7\xe3o de Desempenho",data:t.data||(new Date).toISOString()}))}),v.sort((e,t)=>new Date(t.data)-new Date(e.data));const b=e=>{e.forEach(e=>{const r=e.data();"concluida"===r.status?(g++,r.avaliacaoFuncionario&&v.push({id:"tarefa-".concat(e.id,"-auto"),tipo:"regular",nota:Number(r.avaliacaoFuncionario),comentario:r.comentarioFuncionario||"Autoavalia\xe7\xe3o",data:r.dataAutoavaliacao||r.dataConclusao||(new Date).toISOString(),hora:new Date(r.dataAutoavaliacao||r.dataConclusao||new Date).toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"}),avaliador:t.nome,tipoAvaliacao:"tarefa",nomeTarefa:r.nome||r.titulo,descricaoTarefa:r.descricao,isAutoAvaliacao:!0}),r.avaliacaoSupervisor&&(v.push({id:"tarefa-".concat(e.id),tipo:"regular",nota:Number(r.avaliacaoSupervisor),comentario:r.comentarioSupervisor||"Avalia\xe7\xe3o de Tarefa",data:r.dataConclusao||(new Date).toISOString(),hora:new Date(r.dataConclusao||new Date).toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"}),avaliador:r.avaliadorNome||de.nome,tipoAvaliacao:"tarefa",nomeTarefa:r.nome||r.titulo,descricaoTarefa:r.descricao}),x+=Number(r.avaliacaoSupervisor),y++)):"em_andamento"===r.status&&p++})};b(l),b(c),L(e=>(0,n.A)((0,n.A)({},e),{},{[t.id]:(0,n.A)((0,n.A)({},e[t.id]),{},{avaliacoes:v,tarefasConcluidas:g,tarefasEmAndamento:p})})),b(d),b(u),b(h);const[w,k,N,j,S]=await Promise.all([(0,s.GG)((0,s.P)(a,(0,s._M)("funcionarioId","==",String(t.id)))),(0,s.GG)((0,s.P)(a,(0,s._M)("funcionario","==",t.nome))),(0,s.GG)((0,s.P)(a,(0,s._M)("colaborador","==",t.nome))),(0,s.GG)((0,s.P)(a,(0,s._M)("responsavel","==",t.nome))),(0,s.GG)((0,s.P)(a,(0,s._M)("responsavel","==",t.nome.toLowerCase())))]),_=new Set([...w.docs,...k.docs,...N.docs,...j.docs,...S.docs].map(e=>(0,n.A)({id:e.id},e.data())).filter(e=>"ativo"===e.status||"emprestado"===e.status)).size;let E=0;[w,k,N,j,S].forEach(e=>{e.docs.forEach(e=>{const t=e.data();var r;"devolvido"===t.status&&(E+=(null===(r=t.ferramentas)||void 0===r?void 0:r.length)||0)})});const A={emprestimosAtivos:_,mediaAvaliacao:y>0?x/y:0,totalAvaliacoes:y,tarefasConcluidas:g,tarefasEmAndamento:p,ferramentasDevolvidas:E,avaliacoes:v};e[t.id]=A;const C=$({ferramentasDevolvidas:E,tarefasConcluidas:g,avaliacao:A.mediaAvaliacao});R(e=>(0,n.A)((0,n.A)({},e),{},{[t.id]:C}))}L(e)})()},[r]);const he=e=>{x(e);const t={nome:e.nome||"",cargo:e.cargo||"",telefone:e.telefone||"",photoURL:e.photoURL||null};v(t),E(e.photoURL||null)},me=e=>{j(e),w(!0)};return(0,k.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-blue-50/30 to-indigo-50/50 dark:from-gray-900 dark:via-slate-900 dark:to-blue-900/20",children:[(0,k.jsxs)("div",{className:"relative overflow-hidden",children:[(0,k.jsx)("div",{className:"absolute inset-0 bg-gradient-to-r from-blue-500 via-blue-600 to-blue-700 opacity-95"}),(0,k.jsx)("div",{className:"absolute inset-0 opacity-30",children:(0,k.jsx)("div",{className:"absolute inset-0 bg-white/5",style:{backgroundImage:"url(\"data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='0.05'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E\")"}})}),(0,k.jsxs)("div",{className:"relative max-w-7xl mx-auto px-6 py-12",children:[(0,k.jsxs)(Cd.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"text-center mb-8",children:[(0,k.jsx)("div",{className:"inline-flex items-center justify-center w-20 h-20 bg-white/20 backdrop-blur-sm rounded-2xl mb-6",children:(0,k.jsx)(uk,{className:"w-10 h-10 text-white"})}),(0,k.jsx)("h1",{className:"text-4xl lg:text-5xl font-bold text-white mb-4",children:"Gest\xe3o de Talentos"}),(0,k.jsx)("p",{className:"text-xl text-blue-100 max-w-2xl mx-auto",children:"Acompanhe, gerencie e desenvolva sua equipe com ferramentas modernas e intuitivas"})]}),(0,k.jsxs)(Cd.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.6,delay:.2},className:"grid grid-cols-2 md:grid-cols-4 gap-4 max-w-4xl mx-auto",children:[(0,k.jsxs)("div",{className:"bg-white/20 backdrop-blur-sm rounded-xl p-4 text-center",children:[(0,k.jsx)("div",{className:"text-3xl font-bold text-white mb-1",children:r.filter(e=>!e.demitido).length}),(0,k.jsx)("div",{className:"text-blue-100 text-sm font-medium",children:"Funcion\xe1rios Ativos"})]}),(0,k.jsxs)("div",{className:"bg-white/20 backdrop-blur-sm rounded-xl p-4 text-center",children:[(0,k.jsx)("div",{className:"text-3xl font-bold text-white mb-1",children:Object.keys(F).length}),(0,k.jsx)("div",{className:"text-blue-100 text-sm font-medium",children:"Com Avalia\xe7\xf5es"})]}),(0,k.jsxs)("div",{className:"bg-white/20 backdrop-blur-sm rounded-xl p-4 text-center",children:[(0,k.jsx)("div",{className:"text-3xl font-bold text-white mb-1",children:Object.values(F).reduce((e,t)=>e+(t.tarefasConcluidas||0),0)}),(0,k.jsx)("div",{className:"text-blue-100 text-sm font-medium",children:"Tarefas Conclu\xeddas"})]}),(0,k.jsxs)("div",{className:"bg-white/20 backdrop-blur-sm rounded-xl p-4 text-center",children:[(0,k.jsx)("div",{className:"text-3xl font-bold text-white mb-1",children:(Object.values(F).reduce((e,t)=>e+(t.mediaAvaliacao||0),0)/Object.keys(F).length||0).toFixed(1)}),(0,k.jsx)("div",{className:"text-blue-100 text-sm font-medium",children:"Avalia\xe7\xe3o M\xe9dia"})]})]}),(0,k.jsx)(Cd.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.6,delay:.4},className:"mt-8 max-w-4xl mx-auto",children:(0,k.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,k.jsxs)("div",{className:"relative",children:[(0,k.jsxs)("label",{className:"block text-sm font-medium text-blue-100 mb-2",children:[(0,k.jsx)(Wb,{className:"w-4 h-4 inline mr-2"}),"Filtrar por Empresa"]}),(0,k.jsxs)("div",{className:"relative",children:[(0,k.jsxs)("select",{value:Y,onChange:e=>{X(e.target.value),Z("todos")},className:"w-full bg-white/20 backdrop-blur-sm border border-white/30 rounded-xl px-4 py-3 text-white placeholder-blue-200 focus:outline-none focus:ring-2 focus:ring-white/50 appearance-none",children:[(0,k.jsx)("option",{value:"todas",className:"bg-blue-600 text-white",children:"Todas as Empresas"}),G.map(e=>(0,k.jsx)("option",{value:e.id,className:"bg-blue-600 text-white",children:e.nome},e.id))]}),(0,k.jsx)(Mt,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-blue-200 pointer-events-none"})]})]}),(0,k.jsxs)("div",{className:"relative",children:[(0,k.jsxs)("label",{className:"block text-sm font-medium text-blue-100 mb-2",children:[(0,k.jsx)(tw,{className:"w-4 h-4 inline mr-2"}),"Filtrar por Setor"]}),(0,k.jsxs)("div",{className:"relative",children:[(0,k.jsxs)("select",{value:J,onChange:e=>Z(e.target.value),disabled:"todas"===Y,className:"w-full bg-white/20 backdrop-blur-sm border border-white/30 rounded-xl px-4 py-3 text-white placeholder-blue-200 focus:outline-none focus:ring-2 focus:ring-white/50 appearance-none ".concat("todas"===Y?"opacity-50 cursor-not-allowed":""),children:[(0,k.jsx)("option",{value:"todos",className:"bg-blue-600 text-white",children:"todas"===Y?"Selecione uma empresa primeiro":"Todos os Setores"}),ce.map(e=>(0,k.jsx)("option",{value:e.id,className:"bg-blue-600 text-white",children:e.nome},e.id))]}),(0,k.jsx)(Mt,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-blue-200 pointer-events-none"})]})]})]})})]})]}),(0,k.jsx)("div",{className:"sticky top-0 z-30 bg-white/80 backdrop-blur-md border-b border-gray-200/50 dark:bg-gray-900/80 dark:border-gray-700/50 shadow-sm",children:(0,k.jsx)("div",{className:"max-w-7xl mx-auto px-6 py-4",children:(0,k.jsxs)(Cd.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5},className:"flex flex-col lg:flex-row items-center justify-between gap-4",children:[(0,k.jsxs)("div",{className:"flex items-center gap-3",children:[(0,k.jsxs)("div",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:[le.length," de ",r.length," funcion\xe1rios"]}),"demitidos"===O&&(0,k.jsxs)("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-red-100 text-red-700 text-xs font-medium rounded-full",children:[(0,k.jsx)(Gk,{className:"w-3 h-3"}),"Inativos"]})]}),(0,k.jsx)(Jk,{filtroAtual:O,setFiltroAtual:B,searchTerm:I,setSearchTerm:T,onManageGroups:()=>h(!0),showGroupsButton:!l&&(null===de||void 0===de?void 0:de.nivel)>=2})]})})}),(0,k.jsxs)("div",{className:"max-w-7xl mx-auto px-6 py-8",children:[!ue&&!l&&(0,k.jsx)(Cd.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"mb-8",children:(0,k.jsxs)("div",{className:"bg-white/70 backdrop-blur-sm dark:bg-gray-800/70 rounded-2xl border border-white/20 dark:border-gray-700/50 shadow-xl shadow-blue-500/10 dark:shadow-blue-500/5 p-6",children:[(0,k.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,k.jsx)("div",{className:"flex items-center justify-center w-10 h-10 bg-gradient-to-r from-blue-500 to-purple-500 rounded-xl",children:(0,k.jsx)(D,{className:"w-5 h-5 text-white"})}),(0,k.jsx)("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"Adicionar Novo Funcion\xe1rio"})]}),(0,k.jsx)(Qk,{onSubmit:async e=>{g(!0),await a((0,n.A)((0,n.A)({},e),{},{photoURL:y.photoURL||""})),d({nome:"",cargo:"",telefone:""}),v(e=>(0,n.A)((0,n.A)({},e),{},{photoURL:""})),E(null),g(!1)},loading:f,formatarTelefone:mN})]})}),(0,k.jsx)(Pr,{children:0===le.length?(0,k.jsx)(Cd.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.3},className:"bg-white/70 backdrop-blur-sm dark:bg-gray-800/70 rounded-2xl border border-white/20 dark:border-gray-700/50 shadow-xl shadow-blue-500/10 dark:shadow-blue-500/5 p-12",children:(0,k.jsxs)("div",{className:"flex flex-col items-center justify-center text-center",children:[(0,k.jsxs)("div",{className:"relative mb-6",children:[(0,k.jsx)("div",{className:"w-24 h-24 bg-gradient-to-br from-blue-100 to-purple-100 dark:from-blue-900/50 dark:to-purple-900/50 rounded-2xl flex items-center justify-center",children:"demitidos"===O?(0,k.jsx)(Gk,{className:"w-12 h-12 text-blue-600 dark:text-blue-400"}):(0,k.jsx)(uk,{className:"w-12 h-12 text-blue-600 dark:text-blue-400"})}),(0,k.jsx)("div",{className:"absolute -top-2 -right-2 w-6 h-6 bg-gradient-to-r from-yellow-400 to-orange-400 rounded-full flex items-center justify-center",children:(0,k.jsx)(Xb,{className:"w-3 h-3 text-white"})})]}),(0,k.jsx)("h3",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-3",children:"demitidos"===O?"Nenhum funcion\xe1rio inativo":"Nenhum funcion\xe1rio encontrado"}),(0,k.jsx)("p",{className:"text-gray-600 dark:text-gray-400 max-w-md leading-relaxed",children:"demitidos"===O?"N\xe3o h\xe1 funcion\xe1rios inativos no sistema. Que \xf3tima not\xedcia!":I?'N\xe3o foram encontrados funcion\xe1rios que correspondam ao termo "'.concat(I,'". Tente ajustar os filtros ou buscar por outros termos.'):"Comece adicionando seu primeiro funcion\xe1rio ao sistema e construa sua equipe dos sonhos!"}),!O.includes("demitidos")&&!I&&!ue&&!l&&(0,k.jsxs)(Cd.button,{whileHover:{scale:1.05},whileTap:{scale:.95},className:"mt-6 inline-flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-blue-500 to-purple-500 text-white font-medium rounded-xl hover:from-blue-600 hover:to-purple-600 transition-all duration-200 shadow-lg",onClick:()=>window.scrollTo({top:0,behavior:"smooth"}),children:[(0,k.jsx)(D,{className:"w-4 h-4"}),"Adicionar Funcion\xe1rio"]})]})}):(0,k.jsx)(Cd.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},className:"grid grid-cols-1 lg:grid-cols-2 2xl:grid-cols-3 gap-6",children:[...le].sort((()=>{switch(O){case"avaliacao":return te;case"tarefas":return re;case"emprestimos":return ae;case"pontos":return ne;default:return ee}})()).map((e,t)=>(0,k.jsx)(Cd.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:.1*t},children:(0,k.jsx)(lN,{funcionario:e,funcionariosStats:F,funcionariosPontos:M,isFuncionario:ue,readonly:l,avaliacoesExpandidas:z,avaliacoesDesempenhoExpandidas:V,setAvaliacoesExpandidas:U,setAvaliacoesDesempenhoExpandidas:q,handleEditar:he,confirmarExclusao:me,calcularMediaAvaliacoesDesempenho:oe,onClick:()=>C(e),demitirFuncionario:se,reintegrarFuncionario:ie,filtroAtual:O})},e.id))})})]}),A&&(0,k.jsx)(Hk,{funcionario:A,onClose:()=>C(null)}),(0,k.jsx)(Wk,{isOpen:u,onClose:()=>h(!1),funcionarios:r}),!ue&&p&&(0,k.jsx)(uN,{editando:p,formEdit:y,setFormEdit:v,preview:S,setPreview:E,loading:f,fileInputRef:H,handleFileChange:async e=>{const t=e.target.files[0];if(t){const e=new FileReader;e.onloadend=()=>{E(e.result)},e.readAsDataURL(t);try{g(!0);const e=(0,xt.KR)(P.storage,"funcionarios/".concat((null===p||void 0===p?void 0:p.id)||Date.now())),r=await(0,xt.D)(e,t),a=await(0,xt.qk)(r.ref);v(e=>(0,n.A)((0,n.A)({},e),{},{photoURL:a})),p&&await o(p.id,(0,n.A)((0,n.A)({},y),{},{photoURL:a}))}catch(r){console.error("Erro ao fazer upload da imagem:",r)}finally{g(!1)}}},handleSalvarEdicao:async e=>{try{g(!0),await o(p.id,e),x(null),E(null),m("Funcion\xe1rio atualizado com sucesso!","success")}catch(t){console.error("Erro ao atualizar funcion\xe1rio:",t),m("Erro ao atualizar funcion\xe1rio","error")}finally{g(!1)}},setEditando:x,formatarTelefone:mN}),b&&N&&(0,k.jsx)(hN,{funcionario:N,loading:f,onConfirm:async()=>{try{g(!0),await i(N.id),w(!1),j(null)}catch(e){alert("Erro ao excluir funcion\xe1rio: "+e.message)}finally{g(!1)}},onCancel:()=>{w(!1),j(null)}})]})},gN=y("settings",[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),pN=y("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]),xN=y("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),yN=y("sticky-note",[["path",{d:"M16 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V8Z",key:"qazsjp"}],["path",{d:"M15 3v4a2 2 0 0 0 2 2h4",key:"40519r"}]]),vN=t=>{var r,a,i,o,l,c,d;let{usuarioAtual:u}=t;const[h,m]=(0,e.useState)(new Date),[f,g]=(0,e.useState)(new Date),[p,x]=(0,e.useState)([]),[y,v]=(0,e.useState)({}),[b,w]=(0,e.useState)({}),[N,j]=(0,e.useState)({}),[S,_]=(0,e.useState)({}),[E,A]=(0,e.useState)([]),[C,I]=(0,e.useState)("todas"),[T,D]=(0,e.useState)("todos"),[F,L]=(0,e.useState)([]),[M,R]=(0,e.useState)([]),[O,B]=(0,e.useState)(!0),[z,U]=(0,e.useState)(!1),[V,q]=(0,e.useState)("diario"),[H,G]=(0,e.useState)({aberto:!1,tipo:null,funcionarioId:null,dia:null,anotacao:""}),[W,K]=(0,e.useState)({aberto:!1,dia:null,anotacao:""}),[Q,Y]=(0,e.useState)(!1),[X,J]=(0,e.useState)(!1),[Z,$]=(0,e.useState)({}),[ee,te]=(0,e.useState)(0),[re,ae]=(0,e.useState)(!1),[ne,se]=(0,e.useState)(new Date),[ie,oe]=(0,e.useState)({aberto:!1,tipo:null,dados:[]}),[le,ce]=(0,e.useState)(null),[de,ue]=(0,e.useState)(null),[he,me]=(0,e.useState)(null),[fe,ge]=(0,e.useState)({estrelas:0,comentario:""}),[pe,xe]=(0,e.useState)(0),[ye,ve]=(0,e.useState)(!1),[be,we]=(0,e.useState)("horarios"),[ke,Ne]=(0,e.useState)({}),[je,Se]=(0,e.useState)({nome:"",descricao:"",setor:""}),_e={M:{label:"M",descricao:"6x1 Segunda a Sexta 07:20-16:20, S\xe1bado/Domingo 07:20-13:20",cor:"bg-green-500 dark:bg-green-600",corTexto:"text-white",corBorda:"border-green-600"},M1:{label:"M1",descricao:"6x1 Hor\xe1rio 07:00-15:20, almo\xe7o 12:00-13:00",cor:"bg-blue-500 dark:bg-blue-600",corTexto:"text-white",corBorda:"border-blue-600"},M4:{label:"M4",descricao:"5x2 Segunda a Sexta 06:00-15:40, almo\xe7o 10:30-11:30",cor:"bg-purple-500 dark:bg-purple-600",corTexto:"text-white",corBorda:"border-purple-600"},FOLGA:{label:"FOLGA",descricao:"Dia de folga",cor:"bg-yellow-400 dark:bg-yellow-500",corTexto:"text-gray-900 dark:text-gray-900",corBorda:"border-yellow-500"},FERIAS:{label:"F\xc9RIAS",descricao:"Per\xedodo de f\xe9rias",cor:"bg-orange-500 dark:bg-orange-600",corTexto:"text-white",corBorda:"border-orange-600"},ATESTADO:{label:"ATESTADO",descricao:"Atestado m\xe9dico",cor:"bg-red-500 dark:bg-red-600",corTexto:"text-white",corBorda:"border-red-600"},FOLGA_EXTRA:{label:"FOLGA EXTRA",descricao:"Folga extra concedida",cor:"bg-cyan-500 dark:bg-cyan-600",corTexto:"text-white",corBorda:"border-cyan-600"},VAZIO:{label:"-",descricao:"N\xe3o marcado",cor:"bg-gray-200 dark:bg-gray-700",corTexto:"text-gray-600 dark:text-gray-400",corBorda:"border-gray-300"}},Ee={2025:["01-01","03-04","04-18","04-21","05-01","06-19","09-07","10-12","10-15","11-02","11-15","11-20","12-25"],2026:["01-01","02-17","04-03","04-21","05-01","06-04","09-07","10-12","10-15","11-02","11-15","11-20","12-25"]},Ae=(e,t,r)=>{const a=Ee[e]||[],n="".concat(String(t).padStart(2,"0"),"-").concat(String(r).padStart(2,"0"));return a.includes(n)},Ce=e=>{if(!e)return"";const t=e.replace(/\D/g,"").match(/^(\d{2})(\d{4,5})(\d{4})$/);return t?"(".concat(t[1],") ").concat(t[2],"-").concat(t[3]):e},Ie=e=>{if(!e)return"#";const t=e.replace(/\D/g,"");return"https://wa.me/55".concat(t)},Te=()=>{const e=f.getDate(),t=Math.ceil(e/7),r=7*(t-1)+1,a=Math.min(7*t,new Date(f.getFullYear(),f.getMonth()+1,0).getDate());new Date(f.getFullYear(),f.getMonth(),r),new Date(f.getFullYear(),f.getMonth(),a);return{numeroSemana:t,primeiroDia:r,ultimoDia:a,textoIntervalo:"".concat(r," a ").concat(a," de ").concat(f.toLocaleDateString("pt-BR",{month:"long"}))}},De=e=>{let t=[],r="";switch(e){case"feriados":t=(()=>{const e=f.getFullYear(),t=f.getMonth()+1,r=[],a={"01-01":"Ano Novo","03-04":"Carnaval","04-18":"Sexta-feira Santa","04-21":"Tiradentes","05-01":"Dia do Trabalho","06-19":"Corpus Christi","09-07":"Independ\xeancia do Brasil","10-12":"Nossa Senhora Aparecida","10-15":"Dia do Professor (Municipal B\xfazios)","11-02":"Finados","11-15":"Proclama\xe7\xe3o da Rep\xfablica","11-20":"Dia da Consci\xeancia Negra","12-25":"Natal","02-17":"Carnaval (2026)","04-03":"Sexta-feira Santa (2026)","06-04":"Corpus Christi (2026)"};return Me.forEach(n=>{let{dia:s}=n;if(Ae(e,t,s)){const n="".concat(String(t).padStart(2,"0"),"-").concat(String(s).padStart(2,"0")),i=new Date(e,t-1,s).toLocaleDateString("pt-BR",{weekday:"long"});r.push({dia:s,nome:a[n]||"Feriado",diaSemana:i.charAt(0).toUpperCase()+i.slice(1),data:"".concat(String(s).padStart(2,"0"),"/").concat(String(t).padStart(2,"0"),"/").concat(e)})}}),r})(),r="Feriados do M\xeas";break;case"uteis":t=Me.filter(e=>!e.ehFimDeSemana).map(e=>{let{dia:t,diaSemana:r}=e;return{dia:t,diaSemana:r,data:"".concat(String(t).padStart(2,"0"),"/").concat(String(f.getMonth()+1).padStart(2,"0"),"/").concat(f.getFullYear())}}),r="Dias \xdateis do M\xeas";break;case"finsdesemana":t=Me.filter(e=>e.ehFimDeSemana).map(e=>{let{dia:t,diaSemana:r}=e;return{dia:t,diaSemana:r,data:"".concat(String(t).padStart(2,"0"),"/").concat(String(f.getMonth()+1).padStart(2,"0"),"/").concat(f.getFullYear())}}),r="Fins de Semana do M\xeas";break;default:return}oe({aberto:!0,tipo:e,dados:t,titulo:r})};(0,e.useEffect)(()=>{(async()=>{try{const e=(await(0,s.GG)((0,s.collection)(P.db,"empresas"))).docs.map(e=>(0,n.A)({id:e.id},e.data()));L(e)}catch(e){console.error("Erro ao carregar empresas:",e)}})()},[]),(0,e.useEffect)(()=>{const e=(0,s.aQ)((0,s.collection)(P.db,"horarios_personalizados"),e=>{const t={};e.docs.forEach(e=>{const r=e.data();!1!==r.ativo&&(t[e.id]=(0,n.A)({id:e.id},r))}),Ne(t)},e=>{console.error("Erro ao carregar hor\xe1rios personalizados:",e)});return()=>e()},[]),(0,e.useEffect)(()=>{const e=(0,s.aQ)((0,s.collection)(P.db,"funcionarios"),e=>{const t=e.docs.map(e=>(0,n.A)({id:e.id},e.data()));x(t);const r=[...new Set(t.map(e=>e.setor).filter(Boolean))];R(r.sort()),B(!1)},e=>{console.error("Erro ao carregar funcion\xe1rios:",e),B(!1)});return()=>e()},[]),(0,e.useEffect)(()=>{const e=(0,s.aQ)((0,s.collection)(P.db,"configuracoes_escala"),e=>{const t={};e.docs.forEach(e=>{t[e.id]=e.data()}),$(t)},e=>{console.error("Erro ao carregar configura\xe7\xf5es:",e)});return()=>e()},[]),(0,e.useEffect)(()=>{const e="".concat(f.getFullYear(),"-").concat(String(f.getMonth()+1).padStart(2,"0")),t=(0,s.aQ)((0,s.collection)(P.db,"escalas",e,"registros"),e=>{const t={};e.docs.forEach(e=>{t[e.id]=e.data()}),v(t)},e=>{console.error("Erro ao carregar escalas:",e)});return()=>t()},[f]),(0,e.useEffect)(()=>{const e="".concat(f.getFullYear(),"-").concat(String(f.getMonth()+1).padStart(2,"0")),t=(0,s.aQ)((0,s.collection)(P.db,"presencas",e,"registros"),e=>{const t={};e.docs.forEach(e=>{t[e.id]=e.data()}),w(t)},e=>{console.error("Erro ao carregar presen\xe7as:",e)});return()=>t()},[f]),(0,e.useEffect)(()=>{const e="".concat(f.getFullYear(),"-").concat(String(f.getMonth()+1).padStart(2,"0")),t=(0,s.aQ)((0,s.collection)(P.db,"anotacoes_funcionarios",e,"registros"),e=>{const t={};e.docs.forEach(e=>{t[e.id]=e.data()}),j(t)},e=>{console.error("Erro ao carregar anota\xe7\xf5es de funcion\xe1rios:",e)});return()=>t()},[f]),(0,e.useEffect)(()=>{const e="".concat(f.getFullYear(),"-").concat(String(f.getMonth()+1).padStart(2,"0")),t=(0,s.aQ)((0,s.collection)(P.db,"anotacoes_dias",e,"registros"),e=>{const t={};e.docs.forEach(e=>{t[e.id]=e.data()}),_(t)},e=>{console.error("Erro ao carregar anota\xe7\xf5es de dias:",e)});return()=>t()},[f]);const Pe=(0,e.useMemo)(()=>!!u&&Tt(u.nivel),[u]),Fe=(0,e.useMemo)(()=>{let e=p;return"todas"!==C&&(e=e.filter(e=>e.empresa===C)),"todos"!==T&&(e=e.filter(e=>e.setor===T)),e=e.filter(e=>!E.includes(e.id)),e.sort((e,t)=>{const r=(e.nome||"").toLowerCase(),a=(t.nome||"").toLowerCase();return r.localeCompare(a,"pt-BR")}),e},[p,C,T,E]),Le=(0,e.useMemo)(()=>{if("todas"===C)return M;const e=p.filter(e=>e.empresa===C).map(e=>e.setor).filter(Boolean);return[...new Set(e)].sort()},[p,C,M]),Me=(0,e.useMemo)(()=>{const e=f.getFullYear(),t=f.getMonth(),r=[];if("diario"===V){const a=f.getDate(),n=new Date(e,t,a),s=n.toLocaleDateString("pt-BR",{weekday:"short"}).toUpperCase();r.push({dia:a,data:n,diaSemana:s.replace(".",""),ehFimDeSemana:0===n.getDay()||6===n.getDay()})}else if("semanal"===V){const a=f.getDate();for(let n=0;n<7;n++){const s=new Date(e,t,a+n),i=s.toLocaleDateString("pt-BR",{weekday:"short"}).toUpperCase();r.push({dia:s.getDate(),data:s,diaSemana:i.replace(".",""),ehFimDeSemana:0===s.getDay()||6===s.getDay()})}}else{const a=new Date(e,t+1,0);for(let n=1;n<=a.getDate();n++){const a=new Date(e,t,n),s=a.toLocaleDateString("pt-BR",{weekday:"short"}).toUpperCase();r.push({dia:n,data:a,diaSemana:s.replace(".",""),ehFimDeSemana:0===a.getDay()||6===a.getDay()})}}return r},[f,V]),Re=async(e,t,r,a)=>{if(Pe){if("FOLGA"===r&&a){const r=p.find(t=>t.id===e);ue({funcionarioId:e,dia:t,tipo:"folga",funcionario:r,fase:"scanning"}),setTimeout(()=>{ue(e=>e?(0,n.A)((0,n.A)({},e),{},{fase:"analyzing"}):null)},1e3),setTimeout(()=>{ue(e=>e?(0,n.A)((0,n.A)({},e),{},{fase:"verifying"}):null)},2e3),setTimeout(()=>{ue(e=>e?(0,n.A)((0,n.A)({},e),{},{fase:"confirmed"}):null)},3e3),setTimeout(()=>{ue(null)},4e3)}try{const a="".concat(f.getFullYear(),"-").concat(String(f.getMonth()+1).padStart(2,"0")),n="".concat(a,"-").concat(String(t).padStart(2,"0")),i="".concat(e,"_").concat(n),o={funcionarioId:e,data:n,tipo:r,marcadoPor:(null===u||void 0===u?void 0:u.email)||"Sistema",marcadoEm:new Date};await(0,s.setDoc)((0,s.doc)(P.db,"escalas",a,"registros",i),o)}catch(i){console.error("Erro ao marcar escala:",i),zb.error("Erro ao salvar escala. Tente novamente.",{position:"top-right",autoClose:4e3})}}else zb.warning("Voc\xea n\xe3o tem permiss\xe3o para editar a escala.",{position:"top-right",autoClose:3e3})},Oe=async(e,t,r,a)=>{if(Pe){if(null!==r){const a=p.find(t=>t.id===e);ue({funcionarioId:e,dia:t,tipo:r?"presente":"ausente",funcionario:a,fase:"scanning"}),setTimeout(()=>{ue(e=>e?(0,n.A)((0,n.A)({},e),{},{fase:"analyzing"}):null)},1e3),setTimeout(()=>{ue(e=>e?(0,n.A)((0,n.A)({},e),{},{fase:"verifying"}):null)},2e3),setTimeout(()=>{ue(e=>e?(0,n.A)((0,n.A)({},e),{},{fase:"confirmed"}):null)},3e3),setTimeout(()=>{ue(null)},4e3)}try{const a="".concat(f.getFullYear(),"-").concat(String(f.getMonth()+1).padStart(2,"0")),n="".concat(a,"-").concat(String(t).padStart(2,"0")),i="".concat(e,"_").concat(n);if(null===r)await(0,s.deleteDoc)((0,s.doc)(P.db,"presencas",a,"registros",i));else{const t={funcionarioId:e,data:n,presente:r,marcadoPor:(null===u||void 0===u?void 0:u.email)||"Sistema",marcadoEm:new Date};await(0,s.setDoc)((0,s.doc)(P.db,"presencas",a,"registros",i),t)}}catch(i){console.error("Erro ao marcar presen\xe7a:",i),zb.error("Erro ao salvar presen\xe7a. Tente novamente.",{position:"top-right",autoClose:4e3}),ue(null)}}else zb.warning("Voc\xea n\xe3o tem permiss\xe3o para marcar presen\xe7a.",{position:"top-right",autoClose:3e3})},Be=(e,t)=>{const r="".concat(f.getFullYear(),"-").concat(String(f.getMonth()+1).padStart(2,"0")),a="".concat(r,"-").concat(String(t).padStart(2,"0")),n="".concat(e,"_").concat(a),s=b[n];return null===s||void 0===s?void 0:s.presente},ze=(e,t)=>{var r;const a="".concat(f.getFullYear(),"-").concat(String(f.getMonth()+1).padStart(2,"0")),n="".concat(a,"-").concat(String(t).padStart(2,"0")),s="".concat(e,"_").concat(n);return(null===(r=N[s])||void 0===r?void 0:r.anotacao)||""},Ue=e=>{var t;const r="".concat(f.getFullYear(),"-").concat(String(f.getMonth()+1).padStart(2,"0")),a="".concat(r,"-").concat(String(e).padStart(2,"0"));return(null===(t=S[a])||void 0===t?void 0:t.anotacao)||""},Ve=(e,t)=>{const r=ze(e,t);G({aberto:!0,tipo:"funcionario",funcionarioId:e,dia:t,anotacao:r})},qe=async(e,t)=>{try{await(0,s.setDoc)((0,s.doc)(P.db,"configuracoes_escala",e),{funcionarioId:e,tipoEscala:t,atualizadoPor:(null===u||void 0===u?void 0:u.email)||"Sistema",atualizadoEm:new Date}),zb.success("Configura\xe7\xe3o salva com sucesso!",{position:"top-right",autoClose:3e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0})}catch(r){console.error("Erro ao salvar configura\xe7\xe3o:",r),zb.error("Erro ao salvar configura\xe7\xe3o. Tente novamente.",{position:"top-right",autoClose:4e3})}},He=(e,t)=>{var r,a;const n="".concat(f.getFullYear(),"-").concat(String(f.getMonth()+1).padStart(2,"0")),s="".concat(n,"-").concat(String(t).padStart(2,"0")),i="".concat(e,"_").concat(s);return null!==(r=y[i])&&void 0!==r&&r.tipo?y[i].tipo:(null===(a=Z[e])||void 0===a?void 0:a.tipoEscala)||"VAZIO"},Ge=e=>{let t=0,r=0,a=0,n=0,s=0,i=0,o=0;const l=f.getFullYear(),c=f.getMonth()+1;return Me.forEach(d=>{let{dia:u}=d;Ae(l,c,u)&&o++;const h=He(e,u);"M"===h||"M1"===h||"M4"===h?t++:"FOLGA"===h||"FOLGA_EXTRA"===h?r++:"FERIAS"===h?a++:"ATESTADO"===h&&n++;const m=Be(e,u);!0===m?s++:!1===m&&i++}),{diasTrabalhados:t,folgas:r,ferias:a,atestados:n,presencas:s,faltas:i,feriados:o}};return O?(0,k.jsx)("div",{className:"flex items-center justify-center h-screen bg-gray-50 dark:bg-gray-900",children:(0,k.jsxs)("div",{className:"text-center",children:[(0,k.jsx)("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-green-600 mx-auto mb-4"}),(0,k.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"Carregando escala..."})]})}):Pe?(0,k.jsxs)("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 p-4",children:[(0,k.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 mb-6",children:[(0,k.jsxs)("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[(0,k.jsxs)("div",{children:[(0,k.jsxs)("h1",{className:"text-3xl font-bold text-gray-800 dark:text-white flex items-center gap-3",children:[(0,k.jsx)(iu,{className:"w-8 h-8 text-green-600"}),"Escala de Trabalho"]}),(0,k.jsx)("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:"Gerencie a escala de trabalho e folgas dos funcion\xe1rios"})]}),(0,k.jsx)("div",{className:"flex items-center justify-center",children:(0,k.jsx)("button",{onClick:()=>ae(!0),className:"px-6 py-3 bg-gray-800 dark:bg-gray-700 text-white rounded-lg hover:bg-gray-700 dark:hover:bg-gray-600 transition-colors shadow-lg",children:(0,k.jsxs)("div",{className:"text-center min-w-[200px]",children:[(0,k.jsx)("div",{className:"text-2xl font-bold",children:"diario"===V?f.toLocaleDateString("pt-BR",{day:"2-digit",month:"long"}):"semanal"===V?"Semana ".concat(Te().numeroSemana):f.toLocaleDateString("pt-BR",{month:"long"})}),(0,k.jsx)("div",{className:"text-sm text-gray-300",children:"semanal"===V?Te().textoIntervalo:f.getFullYear()})]})})})]}),(0,k.jsx)("div",{className:"mt-4 bg-gradient-to-r from-gray-50 to-gray-100 dark:from-gray-800 dark:to-gray-750 rounded-lg p-3 shadow-md",children:(0,k.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[(0,k.jsxs)("button",{onClick:()=>oe({aberto:!0,tipo:"diasmes",dados:Me,titulo:"Dias no M\xeas"}),className:"bg-white dark:bg-gray-700 rounded-lg p-2 text-center hover:bg-gray-50 dark:hover:bg-gray-600 transition-colors cursor-pointer",children:[(0,k.jsx)("div",{className:"text-xs text-gray-600 dark:text-gray-400 mb-1",children:"Dias no M\xeas"}),(0,k.jsx)("div",{className:"text-lg font-bold text-gray-800 dark:text-white",children:Me.length})]}),(0,k.jsxs)("button",{onClick:()=>De("uteis"),className:"bg-white dark:bg-gray-700 rounded-lg p-2 text-center hover:bg-gray-50 dark:hover:bg-gray-600 transition-colors cursor-pointer",children:[(0,k.jsx)("div",{className:"text-xs text-gray-600 dark:text-gray-400 mb-1",children:"Dias \xdateis"}),(0,k.jsx)("div",{className:"text-lg font-bold text-green-600 dark:text-green-400",children:Me.filter(e=>!e.ehFimDeSemana).length})]}),(0,k.jsxs)("button",{onClick:()=>De("finsdesemana"),className:"bg-white dark:bg-gray-700 rounded-lg p-2 text-center hover:bg-gray-50 dark:hover:bg-gray-600 transition-colors cursor-pointer",children:[(0,k.jsx)("div",{className:"text-xs text-gray-600 dark:text-gray-400 mb-1",children:"Fins de Semana"}),(0,k.jsx)("div",{className:"text-lg font-bold text-blue-600 dark:text-blue-400",children:Me.filter(e=>e.ehFimDeSemana).length})]}),(0,k.jsxs)("button",{onClick:()=>De("feriados"),className:"bg-white dark:bg-gray-700 rounded-lg p-2 text-center hover:bg-gray-50 dark:hover:bg-gray-600 transition-colors cursor-pointer",children:[(0,k.jsx)("div",{className:"text-xs text-gray-600 dark:text-gray-400 mb-1",children:"Feriados"}),(0,k.jsx)("div",{className:"text-lg font-bold text-orange-600 dark:text-orange-400",children:(()=>{const e=f.getFullYear(),t=f.getMonth()+1;let r=0;return Me.forEach(a=>{let{dia:n}=a;Ae(e,t,n)&&r++}),r})()})]})]})}),(0,k.jsxs)("div",{className:"mt-6 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Modo de Visualiza\xe7\xe3o"}),(0,k.jsxs)("select",{value:V,onChange:e=>q(e.target.value),className:"w-full px-4 py-2 rounded-lg bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 font-medium focus:ring-2 focus:ring-green-500 focus:border-transparent",children:[(0,k.jsx)("option",{value:"diario",children:"\ud83d\udcc5 Di\xe1rio"}),(0,k.jsx)("option",{value:"semanal",children:"\ud83d\udcc6 Semanal"}),(0,k.jsx)("option",{value:"mensal",children:"\ud83d\uddd3\ufe0f Mensal"})]})]}),It(null===u||void 0===u?void 0:u.nivel)&&(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Filtros Avan\xe7ados"}),(0,k.jsxs)("button",{onClick:()=>ve(!0),className:"w-full px-4 py-2 rounded-lg font-medium transition-all flex items-center justify-center gap-2 ".concat("todas"!==C||"todos"!==T?"bg-blue-600 text-white hover:bg-blue-700 ring-2 ring-blue-300":"bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300 border border-gray-300 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-600"),children:[(0,k.jsx)(tw,{className:"w-5 h-5"}),(0,k.jsx)("span",{children:"Filtrar Empresa/Setor"}),("todas"!==C||"todos"!==T)&&(0,k.jsx)("span",{className:"bg-white text-blue-600 px-2 py-0.5 rounded-full text-xs font-bold",children:"\u2713"})]})]}),(0,k.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,k.jsxs)("button",{onClick:()=>J(!0),className:"flex items-center justify-center gap-2 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors",title:"Gerenciar funcion\xe1rios e configurar hor\xe1rios de escala",children:[(0,k.jsx)(gN,{className:"w-5 h-5"}),(0,k.jsx)("span",{className:"text-sm",children:"Gerenciar Funcion\xe1rios e Hor\xe1rios"})]}),E.length>0&&(0,k.jsxs)("button",{onClick:()=>A([]),className:"flex items-center justify-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",title:"Mostrar todos os funcion\xe1rios",children:[(0,k.jsx)(pr,{className:"w-5 h-5"}),(0,k.jsxs)("span",{className:"text-sm",children:["Mostrar Todos (",E.length,")"]})]})]})]})]}),"diario"===V&&window.innerWidth<768&&Fe.length>0&&(0,k.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 mb-6",children:[(0,k.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,k.jsx)("button",{onClick:()=>te(e=>Math.max(0,e-1)),disabled:0===ee,className:"p-2 rounded-lg bg-gray-100 dark:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors",children:(0,k.jsx)(pN,{className:"w-6 h-6"})}),(0,k.jsx)("div",{className:"text-center flex-1",children:(0,k.jsxs)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[ee+1," de ",Fe.length]})}),(0,k.jsx)("button",{onClick:()=>te(e=>Math.min(Fe.length-1,e+1)),disabled:ee===Fe.length-1,className:"p-2 rounded-lg bg-gray-100 dark:bg-gray-700 disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors",children:(0,k.jsx)(xN,{className:"w-6 h-6"})})]}),((e,t)=>{const r=Fe[ee];if(!r)return null;const a=f.getDate(),i=He(r.id,a),o=_e[i]||_e.VAZIO,l=Be(r.id,a),c=Ge(r.id);return(0,k.jsxs)("div",{className:"space-y-2",children:[(0,k.jsxs)("div",{className:"bg-gradient-to-r from-green-50 to-blue-50 dark:from-green-900/20 dark:to-blue-900/20 rounded-lg p-2 border border-green-200 dark:border-green-700",children:[(0,k.jsxs)("div",{className:"flex items-center gap-2",children:[(0,k.jsx)("div",{className:"flex-shrink-0",children:r.photoURL?(0,k.jsx)("img",{src:r.photoURL,alt:r.nome,className:"w-12 h-12 rounded-full object-cover border-2 border-white dark:border-gray-700 shadow"}):(0,k.jsx)("div",{className:"w-12 h-12 rounded-full bg-gradient-to-br from-green-400 to-blue-500 flex items-center justify-center border-2 border-white dark:border-gray-700 shadow",children:(0,k.jsx)("span",{className:"text-lg font-bold text-white",children:(null===(e=r.nome)||void 0===e||null===(t=e.charAt(0))||void 0===t?void 0:t.toUpperCase())||"?"})})}),(0,k.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,k.jsx)("h3",{className:"text-base font-bold text-gray-800 dark:text-white truncate",children:r.nome}),(0,k.jsxs)("div",{className:"flex flex-wrap gap-1 mt-0.5",children:[(0,k.jsx)("span",{className:"px-1.5 py-0.5 rounded-full bg-blue-500 text-white text-[10px] font-medium",children:r.cargo||"N/A"}),r.setor&&(0,k.jsx)("span",{className:"px-1.5 py-0.5 rounded-full bg-purple-500 text-white text-[10px] font-medium",children:r.setor})]})]}),(0,k.jsxs)("div",{className:"flex-shrink-0 text-right",children:[(0,k.jsx)("div",{"data-funcionario-dia":"".concat(r.id,"-").concat(a),className:"px-2 py-1 rounded text-[10px] font-bold mb-0.5 ".concat(o.cor," ").concat(o.corTexto),children:o.label}),(0,k.jsxs)("div",{className:"text-[9px] text-gray-600 dark:text-gray-400 font-medium",children:["M"===i&&"07:20-16:20","M1"===i&&"07:00-15:20","M4"===i&&"06:00-15:40",("FOLGA"===i||"FOLGA_EXTRA"===i)&&"Folga","FERIAS"===i&&"F\xe9rias","ATESTADO"===i&&"Atestado","VAZIO"===i&&"-"]})]})]}),(0,k.jsxs)("div",{className:"grid grid-cols-3 gap-1 text-[10px] mt-2 pt-2 border-t border-green-200 dark:border-green-700",children:[(0,k.jsxs)("div",{"data-stat-trabalho":"".concat(r.id),className:"flex items-center gap-0.5 text-green-600 dark:text-green-400",children:[(0,k.jsx)("span",{className:"font-semibold",children:c.diasTrabalhados}),(0,k.jsx)("span",{className:"truncate",children:"Trabalho"})]}),(0,k.jsxs)("div",{"data-stat-folga":"".concat(r.id),className:"flex items-center gap-0.5 text-yellow-600 dark:text-yellow-400",children:[(0,k.jsx)("span",{className:"font-semibold",children:c.folgas}),(0,k.jsx)("span",{className:"truncate",children:"Folgas"})]}),(0,k.jsxs)("div",{className:"flex items-center gap-0.5 text-orange-600 dark:text-orange-400",children:[(0,k.jsx)("span",{className:"font-semibold",children:c.feriados}),(0,k.jsx)("span",{className:"truncate",children:"Feriados"})]}),(0,k.jsxs)("div",{className:"flex items-center gap-0.5 text-green-600 dark:text-green-400",children:[(0,k.jsx)("span",{className:"font-semibold",children:c.presencas}),(0,k.jsx)("span",{className:"truncate",children:"\u2713 Pres."})]}),(0,k.jsxs)("div",{className:"flex items-center gap-0.5 text-red-600 dark:text-red-400",children:[(0,k.jsx)("span",{className:"font-semibold",children:c.faltas}),(0,k.jsx)("span",{className:"truncate",children:"\u2717 Faltas"})]}),(0,k.jsxs)("div",{className:"flex items-center gap-0.5 text-blue-600 dark:text-blue-400",children:[(0,k.jsx)("span",{className:"font-semibold",children:c.ferias}),(0,k.jsx)("span",{className:"truncate",children:"F\xe9rias"})]})]})]}),(0,k.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-750 rounded-lg p-2",children:[(0,k.jsx)("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Anota\xe7\xe3o"}),(0,k.jsxs)("button",{onClick:()=>Ve(r.id,a),className:"w-full px-3 py-2 rounded-lg text-xs font-medium transition-all flex items-center justify-center gap-1.5 ".concat(ze(r.id,a)?"bg-yellow-500 text-white hover:bg-yellow-600":"bg-gray-200 dark:bg-gray-600 text-gray-700 dark:text-gray-300 hover:bg-gray-300 dark:hover:bg-gray-500"),children:[(0,k.jsx)(Rd,{className:"w-4 h-4"}),ze(r.id,a)?"Ver/Editar":"Adicionar"]})]}),r.telefone&&(0,k.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-750 rounded-lg p-2",children:[(0,k.jsx)("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Contato"}),(0,k.jsxs)("a",{href:Ie(r.telefone),target:"_blank",rel:"noopener noreferrer",onClick:e=>e.stopPropagation(),className:"flex items-center gap-2 bg-green-50 dark:bg-green-900/20 hover:bg-green-100 dark:hover:bg-green-900/30 border border-green-200 dark:border-green-700 rounded-lg p-2 transition-all group",children:[(0,k.jsx)("div",{className:"w-8 h-8 rounded-full bg-green-500/20 flex items-center justify-center group-hover:bg-green-500/30 transition-colors",children:(0,k.jsx)(jk,{className:"w-4 h-4 text-green-600 dark:text-green-400"})}),(0,k.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,k.jsx)("p",{className:"text-[10px] text-gray-500 dark:text-gray-400",children:"WhatsApp"}),(0,k.jsx)("p",{className:"text-xs font-semibold text-gray-900 dark:text-white truncate",children:Ce(r.telefone)})]}),(0,k.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",className:"w-5 h-5 flex-shrink-0",children:[(0,k.jsx)("path",{fill:"#25D366",d:"M256.064,0h-0.128C114.784,0,0,114.816,0,256c0,56,18.048,107.904,48.736,150.048l-31.904,95.104  l98.4-31.456C155.712,496.512,204,512,256.064,512C397.216,512,512,397.152,512,256S397.216,0,256.064,0z"}),(0,k.jsx)("path",{fill:"#FFFFFF",d:"M405.024,361.504c-6.176,17.44-30.688,31.904-50.24,36.128c-13.376,2.848-30.848,5.12-89.664-19.264  c-75.232-31.168-123.68-107.616-127.456-112.576c-3.616-4.96-30.4-40.48-30.4-77.216s18.656-54.624,26.176-62.304  c6.176-6.304,16.384-9.184,26.176-9.184c3.168,0,6.016,0.16,8.576,0.288c7.52,0.32,11.296,0.768,16.256,12.64  c6.176,14.88,21.216,51.616,23.008,55.392c1.824,3.776,3.648,8.896,1.088,13.856c-2.4,5.12-4.512,7.392-8.288,11.744  c-3.776,4.352-7.36,7.68-11.136,12.352c-3.456,4.064-7.36,8.416-3.008,15.936c4.352,7.36,19.392,31.904,41.536,51.616  c28.576,25.44,51.744,33.568,60.032,37.024c6.176,2.56,13.536,1.952,18.048-2.848c5.728-6.176,12.8-16.416,20-26.496  c5.12-7.232,11.584-8.128,18.368-5.568c6.912,2.4,43.488,20.48,51.008,24.224c7.52,3.776,12.48,5.568,14.304,8.736  C411.2,329.152,411.2,344.032,405.024,361.504z"})]})]})]}),(0,k.jsxs)("div",{className:"bg-gradient-to-br from-blue-50 to-cyan-50 dark:from-blue-900/20 dark:to-cyan-900/20 rounded-lg p-2 border border-blue-200 dark:border-blue-700",children:[(0,k.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,k.jsxs)("label",{className:"text-xs font-bold text-blue-700 dark:text-blue-300 flex items-center gap-1",children:[(0,k.jsx)(Ld,{className:"w-4 h-4 fill-blue-500"}),"Avaliar"]}),(0,k.jsx)("button",{onClick:()=>me(he===r.id?null:r.id),className:"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-200 transition-colors text-xs",children:he===r.id?"\u25b2":"\u25bc"})]}),he===r.id&&(0,k.jsxs)("div",{className:"space-y-2 animate-in fade-in slide-in-from-top duration-300",children:[(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-[10px] font-medium text-blue-700 dark:text-blue-300 mb-1",children:"Avalia\xe7\xe3o (1-5 estrelas)"}),(0,k.jsx)("div",{className:"flex gap-1 justify-center bg-white dark:bg-gray-800 rounded-lg p-2",children:[1,2,3,4,5].map(e=>(0,k.jsx)("button",{type:"button",onClick:()=>ge((0,n.A)((0,n.A)({},fe),{},{estrelas:e})),onMouseEnter:()=>xe(e),onMouseLeave:()=>xe(0),className:"transition-all transform hover:scale-110 focus:outline-none focus:scale-110",children:(0,k.jsx)(Ld,{className:"w-6 h-6 transition-all ".concat(e<=(pe||fe.estrelas)?"fill-yellow-400 text-yellow-400 drop-shadow-lg":"text-gray-300 dark:text-gray-600")})},e))}),fe.estrelas>0&&(0,k.jsxs)("p",{className:"text-[10px] text-center mt-1 text-blue-600 dark:text-blue-400 font-medium",children:["+",2*fe.estrelas," pts \u2022 ",5===fe.estrelas?"\u2b50 Excelente!":4===fe.estrelas?"\ud83d\ude0a Muito Bom!":3===fe.estrelas?"\ud83d\udc4d Bom":2===fe.estrelas?"\ud83d\ude10 Regular":"\ud83d\ude14 Melhorar"]})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-[10px] font-medium text-blue-700 dark:text-blue-300 mb-1",children:"Coment\xe1rio (opcional)"}),(0,k.jsx)("textarea",{value:fe.comentario,onChange:e=>ge((0,n.A)((0,n.A)({},fe),{},{comentario:e.target.value})),placeholder:"Observa\xe7\xf5es...",className:"w-full px-2 py-1.5 bg-white dark:bg-gray-800 border border-blue-200 dark:border-blue-700 rounded-lg text-xs text-gray-900 dark:text-white placeholder-gray-400 dark:placeholder-gray-500 focus:ring-1 focus:ring-blue-500 focus:border-transparent resize-none transition-all",rows:"2"})]}),(0,k.jsxs)("button",{onClick:()=>(async(e,t)=>{if(Pe)if(0!==fe.estrelas)try{const r=(0,s.collection)(P.db,"avaliacoes"),a=new Date,n={funcionarioId:String(e),funcionarioNome:t,supervisorId:(null===u||void 0===u?void 0:u.uid)||"",supervisorNome:(null===u||void 0===u?void 0:u.nome)||(null===u||void 0===u?void 0:u.email)||"Sistema",data:a.toISOString().split("T")[0],hora:"".concat(String(a.getHours()).padStart(2,"0"),":").concat(String(a.getMinutes()).padStart(2,"0")),estrelas:Number(fe.estrelas),comentario:fe.comentario.trim(),status:"ativa",tipo:"avaliacao_supervisor",tipoAvaliacao:fe.estrelas>=4?"positiva":fe.estrelas<=2?"negativa":"neutra",anonima:!1,dataCriacao:(0,s.O5)()};await(0,s.gS)(r,n);const i=(0,s.doc)(P.db,"funcionarios",e),o=await(0,s.x7)(i);if(o.exists()){const e=(o.data().pontos||0)+2*fe.estrelas;await(0,s.updateDoc)(i,{pontos:e})}zb.success("Avalia\xe7\xe3o salva com sucesso! +"+2*fe.estrelas+" pontos",{position:"top-right",autoClose:3e3}),ge({estrelas:0,comentario:""}),me(null),xe(0)}catch(r){console.error("Erro ao salvar avalia\xe7\xe3o:",r),zb.error("Erro ao salvar avalia\xe7\xe3o. Tente novamente.",{position:"top-right",autoClose:3e3})}else zb.warning("Por favor, selecione uma avalia\xe7\xe3o em estrelas",{position:"top-right",autoClose:3e3});else zb.warning("Voc\xea n\xe3o tem permiss\xe3o para avaliar funcion\xe1rios.",{position:"top-right",autoClose:3e3})})(r.id,r.nome),disabled:0===fe.estrelas,className:"w-full py-2 rounded-lg text-xs font-bold transition-all flex items-center justify-center gap-1.5 ".concat(0===fe.estrelas?"bg-gray-300 dark:bg-gray-700 text-gray-500 dark:text-gray-400 cursor-not-allowed":"bg-gradient-to-r from-blue-500 to-cyan-500 hover:from-blue-600 hover:to-cyan-600 text-white shadow-lg hover:shadow-xl transform hover:scale-105"),children:[(0,k.jsx)(Ld,{className:"w-4 h-4"}),"Enviar"]})]})]}),(0,k.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-750 rounded-lg p-2",children:[(0,k.jsx)("label",{className:"block text-xs font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Presen\xe7a e Folga"}),(0,k.jsxs)("div",{className:"grid grid-cols-3 gap-1",children:[(0,k.jsxs)("button",{onClick:e=>Oe(r.id,a,!0!==l||null),className:"py-2 rounded-lg text-xs font-bold transition-all flex flex-col items-center justify-center gap-0.5 relative overflow-hidden ".concat(!0===l?"bg-green-600 text-white scale-105 ring-2 ring-green-300":"bg-gray-200 dark:bg-gray-600 text-gray-600 dark:text-gray-300 hover:bg-green-100 dark:hover:bg-green-800"),children:[(0,k.jsx)(lk,{className:"w-4 h-4"}),(0,k.jsx)("span",{className:"text-[10px]",children:"Presente"})]}),(0,k.jsxs)("button",{onClick:e=>Oe(r.id,a,!1===l&&null),className:"py-2 rounded-lg text-xs font-bold transition-all flex flex-col items-center justify-center gap-0.5 relative overflow-hidden ".concat(!1===l?"bg-red-600 text-white scale-105 ring-2 ring-red-300":"bg-gray-200 dark:bg-gray-600 text-gray-600 dark:text-gray-300 hover:bg-red-100 dark:hover:bg-red-800"),children:[(0,k.jsx)(Id,{className:"w-4 h-4"}),(0,k.jsx)("span",{className:"text-[10px]",children:"Ausente"})]}),(0,k.jsxs)("button",{onClick:e=>Re(r.id,a,"FOLGA"===i?"VAZIO":"FOLGA",e),className:"py-2 rounded-lg text-xs font-bold transition-all flex flex-col items-center justify-center gap-0.5 relative overflow-hidden ".concat("FOLGA"===i?"bg-yellow-500 text-white scale-105 ring-2 ring-yellow-300":"bg-gray-200 dark:bg-gray-600 text-gray-600 dark:text-gray-300 hover:bg-yellow-100 dark:hover:bg-yellow-800"),children:[(0,k.jsx)("span",{className:"text-lg",children:"\ud83d\udcc5"}),(0,k.jsx)("span",{className:"text-[10px]",children:"Folga"})]})]})]})]})})()]}),re&&(0,k.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:(0,k.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-2xl max-w-md w-full p-6",children:[(0,k.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,k.jsx)("h3",{className:"text-2xl font-bold text-gray-800 dark:text-white",children:"Selecionar Data"}),(0,k.jsx)("button",{onClick:()=>ae(!1),className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:(0,k.jsx)(Id,{className:"w-6 h-6"})})]}),(0,k.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,k.jsx)("button",{onClick:()=>{const e=new Date(ne);e.setMonth(e.getMonth()-1),se(e)},className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:(0,k.jsx)(pN,{className:"w-6 h-6"})}),(0,k.jsxs)("div",{className:"flex items-center gap-3",children:[(0,k.jsx)("select",{value:ne.getMonth(),onChange:e=>{const t=new Date(ne);t.setMonth(parseInt(e.target.value)),se(t)},className:"px-3 py-2 rounded-lg bg-gray-50 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 text-gray-800 dark:text-white font-medium focus:ring-2 focus:ring-blue-500",children:["Janeiro","Fevereiro","Mar\xe7o","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"].map((e,t)=>(0,k.jsx)("option",{value:t,children:e},t))}),(0,k.jsx)("select",{value:ne.getFullYear(),onChange:e=>{const t=new Date(ne);t.setFullYear(parseInt(e.target.value)),se(t)},className:"px-3 py-2 rounded-lg bg-gray-50 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 text-gray-800 dark:text-white font-medium focus:ring-2 focus:ring-blue-500",children:Array.from({length:10},(e,t)=>(new Date).getFullYear()-2+t).map(e=>(0,k.jsx)("option",{value:e,children:e},e))})]}),(0,k.jsx)("button",{onClick:()=>{const e=new Date(ne);e.setMonth(e.getMonth()+1),se(e)},className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:(0,k.jsx)(xN,{className:"w-6 h-6"})})]}),(0,k.jsxs)("div",{className:"mb-6",children:[(0,k.jsx)("div",{className:"grid grid-cols-7 gap-1 mb-2",children:["Dom","Seg","Ter","Qua","Qui","Sex","S\xe1b"].map(e=>(0,k.jsx)("div",{className:"text-center text-sm font-bold text-gray-600 dark:text-gray-400 py-2",children:e},e))}),(0,k.jsx)("div",{className:"grid grid-cols-7 gap-1",children:(()=>{const e=new Date(ne.getFullYear(),ne.getMonth(),1),t=new Date(ne.getFullYear(),ne.getMonth()+1,0),r=e.getDay(),a=t.getDate(),n=new Date,s="".concat(n.getFullYear(),"-").concat(String(n.getMonth()+1).padStart(2,"0"),"-").concat(String(n.getDate()).padStart(2,"0")),i=[];for(let o=0;o<r;o++)i.push((0,k.jsx)("div",{className:"aspect-square"},"vazio-".concat(o)));for(let o=1;o<=a;o++){const e=new Date(ne.getFullYear(),ne.getMonth(),o),t="".concat(e.getFullYear(),"-").concat(String(e.getMonth()+1).padStart(2,"0"),"-").concat(String(o).padStart(2,"0"))===s,r=e.getDate()===f.getDate()&&e.getMonth()===f.getMonth()&&e.getFullYear()===f.getFullYear(),a=0===e.getDay()||6===e.getDay();i.push((0,k.jsx)("button",{onClick:()=>{const e=new Date(ne.getFullYear(),ne.getMonth(),o);g(e),m(e),ae(!1)},className:"aspect-square flex items-center justify-center rounded-lg font-semibold transition-all ".concat(r?"bg-blue-600 text-white ring-4 ring-blue-300 scale-110":t?"bg-green-500 text-white hover:bg-green-600":a?"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-600":"bg-white dark:bg-gray-800 text-gray-800 dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 border border-gray-200 dark:border-gray-700"),children:o},o))}return i})()})]}),(0,k.jsxs)("div",{className:"flex gap-3",children:[(0,k.jsx)("button",{onClick:()=>{const e=new Date;se(e),g(e),m(e),ae(!1)},className:"flex-1 px-4 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors font-medium",children:"Ir para Hoje"}),(0,k.jsx)("button",{onClick:()=>ae(!1),className:"flex-1 px-4 py-3 bg-gray-200 dark:bg-gray-600 text-gray-800 dark:text-white rounded-lg hover:bg-gray-300 dark:hover:bg-gray-500 transition-colors font-medium",children:"Cancelar"})]})]})}),(0,k.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg overflow-hidden ".concat("diario"===V&&window.innerWidth<768?"hidden":""),children:(0,k.jsx)("div",{className:"overflow-x-auto",children:(0,k.jsxs)("table",{className:"w-full border-collapse",children:[(0,k.jsx)("thead",{children:(0,k.jsxs)("tr",{className:"bg-green-600 dark:bg-green-700 text-white",children:[(0,k.jsx)("th",{className:"sticky left-0 z-20 bg-green-600 dark:bg-green-700 px-2 py-3 text-left font-semibold border-r border-green-500 dark:border-green-600 w-[180px] max-w-[180px]",children:"Colaborador"}),Me.map(e=>{let{dia:t,diaSemana:r,ehFimDeSemana:a}=e;const n=Ue(t);return(0,k.jsx)("th",{className:"px-2 py-3 text-center font-semibold text-xs border-r border-green-500 dark:border-green-600 min-w-[60px] ".concat(a?"bg-green-700 dark:bg-green-800":""),children:(0,k.jsxs)("div",{className:"flex flex-col items-center gap-1",children:[(0,k.jsx)("div",{className:"md:text-xs text-sm",children:r}),(0,k.jsx)("div",{className:"md:text-lg text-2xl font-bold",children:t}),(0,k.jsx)("button",{onClick:()=>(e=>{const t=Ue(e);K({aberto:!0,dia:e,anotacao:t})})(t),className:"p-1 rounded transition-colors ".concat(n?"bg-yellow-500 text-white hover:bg-yellow-600":"bg-green-500 bg-opacity-30 hover:bg-opacity-50"),title:n?"Ver anota\xe7\xe3o do dia":"Adicionar anota\xe7\xe3o do dia",children:(0,k.jsx)(yN,{className:"md:w-3 md:h-3 w-6 h-6"})})]})},t)}),(0,k.jsx)("th",{className:"px-4 py-3 text-center font-semibold border-l-2 border-green-500 dark:border-green-600 min-w-[120px]",children:"Estat\xedsticas"})]})}),(0,k.jsx)("tbody",{children:0===Fe.length?(0,k.jsx)("tr",{children:(0,k.jsx)("td",{colSpan:Me.length+3,className:"px-4 py-8 text-center text-gray-500 dark:text-gray-400",children:"Nenhum funcion\xe1rio encontrado"})}):Fe.map((e,t)=>{var r,a;const n=Ge(e.id);return(0,k.jsxs)("tr",{className:"".concat(t%2===0?"bg-gray-50 dark:bg-gray-750":"bg-white dark:bg-gray-800"," hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors"),children:[(0,k.jsx)("td",{className:"sticky left-0 z-10 px-2 py-2 border-r-2 border-gray-300 dark:border-gray-600 bg-inherit w-[180px] max-w-[180px]",children:(0,k.jsxs)("div",{className:"flex items-center gap-2",children:[(0,k.jsx)("div",{className:"flex-shrink-0",children:e.photoURL?(0,k.jsx)("img",{src:e.photoURL,alt:e.nome,className:"w-10 h-10 rounded-full object-cover border-2 border-green-400 dark:border-green-500 shadow-sm"}):(0,k.jsx)("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-green-400 to-blue-500 flex items-center justify-center border-2 border-green-400 dark:border-green-500 shadow-sm",children:(0,k.jsx)("span",{className:"text-sm font-bold text-white",children:(null===(r=e.nome)||void 0===r||null===(a=r.charAt(0))||void 0===a?void 0:a.toUpperCase())||"?"})})}),(0,k.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,k.jsxs)("div",{className:"flex items-center gap-1 mb-0.5",children:[(0,k.jsx)("span",{className:"font-bold text-gray-800 dark:text-white text-sm truncate block max-w-[120px]",title:e.nome,children:e.nome}),(0,k.jsx)("button",{onClick:()=>{return t=e.id,void A(e=>e.includes(t)?e.filter(e=>e!==t):[...e,t]);var t},className:"flex-shrink-0 w-4 h-4 rounded-full border flex items-center justify-center transition-all ".concat(E.includes(e.id)?"bg-gray-400 border-gray-500":"bg-white dark:bg-gray-700 border-gray-300 dark:border-gray-600 hover:border-green-500 dark:hover:border-green-400"),title:E.includes(e.id)?"Mostrar funcion\xe1rio":"Ocultar funcion\xe1rio",children:E.includes(e.id)?(0,k.jsx)(gr,{className:"w-2.5 h-2.5 text-white"}):(0,k.jsx)(pr,{className:"w-2.5 h-2.5 text-gray-400 dark:text-gray-500"})})]}),(0,k.jsxs)("div",{className:"flex flex-col gap-0.5",children:[(0,k.jsx)("span",{className:"text-[10px] font-semibold px-1.5 py-0.5 rounded bg-gradient-to-r from-blue-500 to-blue-600 text-white shadow-sm inline-block max-w-fit truncate",title:e.cargo,children:e.cargo||"N/A"}),e.setor&&(0,k.jsx)("span",{className:"text-[10px] font-medium px-1.5 py-0.5 rounded bg-purple-100 dark:bg-purple-900/30 text-purple-700 dark:text-purple-300 border border-purple-200 dark:border-purple-700 inline-block max-w-fit truncate",title:e.setor,children:e.setor})]})]})]})}),Me.map(t=>{let{dia:r,ehFimDeSemana:a}=t;const n=He(e.id,r),s=_e[n]||_e.VAZIO,i=Be(e.id,r),o=ze(e.id,r);return(0,k.jsx)("td",{className:"px-1 py-1 border-r border-gray-200 dark:border-gray-700 ".concat(a?"bg-gray-100 dark:bg-gray-750":""),children:(0,k.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,k.jsx)("select",{value:n,onChange:t=>Re(e.id,r,t.target.value),className:"w-full px-1 py-1 text-xs font-bold text-center rounded cursor-pointer border-0 ".concat(s.cor," ").concat(s.corTexto," focus:ring-2 focus:ring-green-500"),children:Object.entries(_e).map(e=>{let[t,r]=e;return(0,k.jsx)("option",{value:t,children:r.label},t)})}),(0,k.jsxs)("div",{className:"flex gap-0.5 justify-center",children:[(0,k.jsx)("button",{onClick:t=>Oe(e.id,r,!0!==i||null),className:"flex-1 px-1 py-0.5 rounded text-xs font-bold transition-all ".concat(!0===i?"bg-green-600 text-white scale-105":"bg-gray-200 dark:bg-gray-600 text-gray-600 dark:text-gray-300 hover:bg-green-100 dark:hover:bg-green-800"),title:"Presente",children:(0,k.jsx)(lk,{className:"w-3 h-3 mx-auto"})}),(0,k.jsx)("button",{onClick:t=>Oe(e.id,r,!1===i&&null),className:"flex-1 px-1 py-0.5 rounded text-xs font-bold transition-all ".concat(!1===i?"bg-red-600 text-white scale-105":"bg-gray-200 dark:bg-gray-600 text-gray-600 dark:text-gray-300 hover:bg-red-100 dark:hover:bg-red-800"),title:"Falta",children:(0,k.jsx)(Id,{className:"w-3 h-3 mx-auto"})})]}),(0,k.jsx)("button",{onClick:()=>Ve(e.id,r),className:"w-full px-1 py-0.5 rounded text-xs transition-colors ".concat(o?"bg-blue-600 text-white hover:bg-blue-700":"bg-gray-200 dark:bg-gray-600 text-gray-600 dark:text-gray-300 hover:bg-blue-100 dark:hover:bg-blue-800"),title:o?"Ver anota\xe7\xe3o":"Adicionar anota\xe7\xe3o",children:(0,k.jsx)(Rd,{className:"w-3 h-3 mx-auto"})})]})},r)}),(0,k.jsx)("td",{className:"px-4 py-3 border-l-2 border-gray-300 dark:border-gray-600 bg-inherit",children:(0,k.jsxs)("div",{className:"flex flex-col gap-1 text-xs",children:[(0,k.jsxs)("div",{className:"flex justify-between",children:[(0,k.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"Trabalho:"}),(0,k.jsx)("span",{className:"font-bold text-green-600 dark:text-green-400",children:n.diasTrabalhados})]}),(0,k.jsxs)("div",{className:"flex justify-between",children:[(0,k.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"Folgas:"}),(0,k.jsx)("span",{className:"font-bold text-yellow-600 dark:text-yellow-400",children:n.folgas})]}),(0,k.jsxs)("div",{className:"flex justify-between",children:[(0,k.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"F\xe9rias:"}),(0,k.jsx)("span",{className:"font-bold text-orange-600 dark:text-orange-400",children:n.ferias})]}),(0,k.jsxs)("div",{className:"flex justify-between",children:[(0,k.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"Atestados:"}),(0,k.jsx)("span",{className:"font-bold text-red-600 dark:text-red-400",children:n.atestados})]}),(0,k.jsx)("div",{className:"h-px bg-gray-300 dark:bg-gray-600 my-1"}),(0,k.jsxs)("div",{className:"flex justify-between",children:[(0,k.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"\u2713 Presen\xe7as:"}),(0,k.jsx)("span",{className:"font-bold text-green-600 dark:text-green-400",children:n.presencas})]}),(0,k.jsxs)("div",{className:"flex justify-between",children:[(0,k.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"\u2717 Faltas:"}),(0,k.jsx)("span",{className:"font-bold text-red-600 dark:text-red-400",children:n.faltas})]})]})})]},e.id)})})]})})}),Q&&(0,k.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,k.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-2xl w-full max-h-[80vh] overflow-hidden flex flex-col",children:[(0,k.jsxs)("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:[(0,k.jsxs)("h3",{className:"text-xl font-bold text-gray-800 dark:text-white flex items-center gap-2",children:[(0,k.jsx)(tw,{className:"w-6 h-6"}),"Gerenciar Visibilidade dos Funcion\xe1rios"]}),(0,k.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-2",children:"Selecione os funcion\xe1rios que deseja ocultar da tabela de escala"})]}),(0,k.jsx)("div",{className:"flex-1 overflow-y-auto p-6",children:(0,k.jsx)("div",{className:"space-y-2",children:p.filter(e=>"todos"===T||e.setor===T).map(e=>(0,k.jsxs)("div",{className:"flex items-center justify-between p-3 rounded-lg border-2 transition-all ".concat(E.includes(e.id)?"border-orange-500 bg-orange-50 dark:bg-orange-900/20":"border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-750"),children:[(0,k.jsx)("div",{className:"flex items-center gap-3",children:(0,k.jsxs)("div",{className:"flex flex-col",children:[(0,k.jsx)("span",{className:"font-semibold text-gray-800 dark:text-white",children:e.nome}),(0,k.jsxs)("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:[e.cargo," \u2022 ",e.setor]})]})}),(0,k.jsx)("button",{onClick:()=>{return t=e.id,void A(e=>e.includes(t)?e.filter(e=>e!==t):[...e,t]);var t},className:"flex items-center gap-2 px-4 py-2 rounded-lg font-medium transition-colors ".concat(E.includes(e.id)?"bg-green-600 text-white hover:bg-green-700":"bg-orange-600 text-white hover:bg-orange-700"),children:E.includes(e.id)?(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(pr,{className:"w-4 h-4"}),"Mostrar"]}):(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(gr,{className:"w-4 h-4"}),"Ocultar"]})})]},e.id))})}),(0,k.jsxs)("div",{className:"p-6 border-t border-gray-200 dark:border-gray-700 flex gap-3",children:[E.length>0&&(0,k.jsxs)("button",{onClick:()=>A([]),className:"flex-1 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors font-medium",children:["Mostrar Todos (",E.length,")"]}),(0,k.jsx)("button",{onClick:()=>Y(!1),className:"flex-1 px-4 py-2 bg-gray-300 dark:bg-gray-600 text-gray-800 dark:text-white rounded-lg hover:bg-gray-400 dark:hover:bg-gray-500 transition-colors font-medium",children:"Fechar"})]})]})}),X&&(0,k.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,k.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-4xl w-full max-h-[85vh] overflow-hidden flex flex-col",children:[(0,k.jsxs)("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:[(0,k.jsxs)("h3",{className:"text-xl font-bold text-gray-800 dark:text-white flex items-center gap-2",children:[(0,k.jsx)(gN,{className:"w-6 h-6 text-purple-500"}),"Gerenciar Funcion\xe1rios e Hor\xe1rios"]}),(0,k.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-2",children:"Configure hor\xe1rios de trabalho e gerencie a visibilidade dos funcion\xe1rios"}),(0,k.jsxs)("div",{className:"flex gap-2 mt-4",children:[(0,k.jsx)("button",{onClick:()=>we("horarios"),className:"flex-1 px-4 py-2 rounded-lg font-medium transition-all shadow-md ".concat("horarios"===be?"bg-gradient-to-r from-purple-600 to-indigo-600 text-white shadow-purple-500/50":"bg-gradient-to-r from-gray-100 to-gray-200 dark:from-gray-700 dark:to-gray-800 text-gray-700 dark:text-gray-300 hover:from-gray-200 hover:to-gray-300 dark:hover:from-gray-600 dark:hover:to-gray-700"),children:"\u23f0 Configurar Hor\xe1rios"}),(()=>{const e=((null===u||void 0===u?void 0:u.cargo)||"").toLowerCase();return(It(null===u||void 0===u?void 0:u.nivel)||e.includes("supervisor")||e.includes("encarregado")||e.includes("gerente"))&&(0,k.jsx)("button",{onClick:()=>we("criar-horarios"),className:"flex-1 px-4 py-2 rounded-lg font-medium transition-all shadow-md ".concat("criar-horarios"===be?"bg-gradient-to-r from-blue-600 to-cyan-600 text-white shadow-blue-500/50":"bg-gradient-to-r from-gray-100 to-gray-200 dark:from-gray-700 dark:to-gray-800 text-gray-700 dark:text-gray-300 hover:from-gray-200 hover:to-gray-300 dark:hover:from-gray-600 dark:hover:to-gray-700"),children:"\u2795 Criar Hor\xe1rios"})})()]})]}),(0,k.jsxs)("div",{className:"flex-1 overflow-y-auto p-6",children:["horarios"===be&&(0,k.jsxs)("div",{className:"space-y-6",children:[(0,k.jsx)("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-blue-900/20 dark:to-indigo-900/20 border-2 border-blue-300 dark:border-blue-600 rounded-xl p-4 shadow-lg",children:(0,k.jsxs)("p",{className:"text-sm text-blue-900 dark:text-blue-200 leading-relaxed",children:[(0,k.jsxs)("strong",{className:"flex items-center gap-2 mb-2",children:[(0,k.jsx)("span",{className:"text-blue-600 dark:text-blue-400",children:"\u2139\ufe0f"})," Atribui\xe7\xe3o de Hor\xe1rios"]}),"Defina os hor\xe1rios de trabalho para cada funcion\xe1rio. Use os hor\xe1rios padr\xe3o",(0,k.jsx)("span",{className:"font-bold bg-blue-200 dark:bg-blue-800 px-2 py-0.5 rounded mx-1",children:"M"}),",",(0,k.jsx)("span",{className:"font-bold bg-blue-200 dark:bg-blue-800 px-2 py-0.5 rounded mx-1",children:"M1"}),",",(0,k.jsx)("span",{className:"font-bold bg-blue-200 dark:bg-blue-800 px-2 py-0.5 rounded mx-1",children:"M4"}),"ou os hor\xe1rios personalizados criados para cada setor.",(0,k.jsx)("br",{}),(0,k.jsxs)("span",{className:"text-xs italic mt-2 block text-blue-700 dark:text-blue-300 bg-blue-100 dark:bg-blue-800/30 p-2 rounded",children:["\ud83d\udca1 Para criar novos hor\xe1rios personalizados, clique na aba ",(0,k.jsx)("strong",{children:'"\u2795 Criar Hor\xe1rios"'})]})]})}),(0,k.jsxs)("div",{className:"space-y-3",children:[(0,k.jsx)("h4",{className:"text-lg font-bold text-gray-800 dark:text-white mb-4 flex items-center gap-2",children:(0,k.jsx)("span",{className:"bg-gradient-to-r from-indigo-500 to-purple-500 text-white rounded-lg px-3 py-1 text-sm",children:"\ud83d\udc65 Atribuir Hor\xe1rios aos Funcion\xe1rios"})}),Fe.map(e=>(0,k.jsxs)("div",{className:"flex items-center justify-between p-4 rounded-xl border-2 border-gray-200 dark:border-gray-700 bg-gradient-to-r from-white to-gray-50 dark:from-gray-800 dark:to-gray-750 shadow-md hover:shadow-lg transition-all",children:[(0,k.jsxs)("div",{className:"flex flex-col",children:[(0,k.jsx)("span",{className:"font-bold text-gray-900 dark:text-white",children:e.nome}),(0,k.jsxs)("span",{className:"text-xs text-gray-600 dark:text-gray-400 font-medium",children:[e.cargo," \u2022 ",e.setor]})]}),(0,k.jsxs)("div",{className:"flex gap-2 flex-wrap",children:[["M","M1","M4","VAZIO"].map(t=>{var r;const a=_e[t],n=(null===(r=Z[e.id])||void 0===r?void 0:r.tipoEscala)===t;return(0,k.jsx)("button",{onClick:()=>qe(e.id,t),className:"px-4 py-2 rounded-lg font-bold text-xs transition-all transform hover:scale-105 active:scale-95 shadow-md ".concat(n?"".concat(a.cor," ").concat(a.corTexto," ring-4 ring-purple-400 dark:ring-purple-500 shadow-lg"):"bg-gradient-to-br from-gray-200 to-gray-300 dark:from-gray-600 dark:to-gray-700 text-gray-700 dark:text-gray-300 hover:from-gray-300 hover:to-gray-400 dark:hover:from-gray-500 dark:hover:to-gray-600"),children:a.label},t)}),Object.values(ke).filter(t=>t.setorId===e.setorId||t.setorNome===e.setor).map(t=>{var r;const a=(null===(r=Z[e.id])||void 0===r?void 0:r.tipoEscala)===t.nome;return(0,k.jsx)("button",{onClick:()=>qe(e.id,t.nome),className:"px-4 py-2 rounded-lg font-bold text-xs transition-all transform hover:scale-105 active:scale-95 shadow-md ".concat(a?"bg-gradient-to-r from-purple-500 to-indigo-500 text-white ring-4 ring-purple-400 dark:ring-purple-500 shadow-lg":"bg-gradient-to-br from-purple-200 to-indigo-200 dark:from-purple-700 dark:to-indigo-700 text-purple-800 dark:text-purple-200 hover:from-purple-300 hover:to-indigo-300 dark:hover:from-purple-600 dark:hover:to-indigo-600"),title:"".concat(t.nome,": ").concat(t.descricao),children:t.nome},t.id)})]})]},e.id))]})]}),"criar-horarios"===be&&(0,k.jsxs)("div",{className:"space-y-6",children:[(0,k.jsx)("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 dark:from-green-900/20 dark:to-emerald-900/20 border-2 border-green-300 dark:border-green-600 rounded-xl p-4 shadow-lg",children:(0,k.jsxs)("p",{className:"text-sm text-green-900 dark:text-green-200 leading-relaxed",children:[(0,k.jsxs)("strong",{className:"flex items-center gap-2 mb-2",children:[(0,k.jsx)("span",{className:"text-green-600 dark:text-green-400",children:"\u2728"})," Criar Hor\xe1rios Personalizados"]}),"Crie hor\xe1rios espec\xedficos para os funcion\xe1rios do seu setor. Os hor\xe1rios criados aqui ficar\xe3o dispon\xedveis apenas para funcion\xe1rios do setor selecionado."]})}),(0,k.jsxs)("div",{className:"bg-gradient-to-br from-blue-50 via-cyan-50 to-blue-100 dark:from-blue-900/30 dark:via-cyan-900/30 dark:to-blue-800/30 border-2 border-blue-300 dark:border-blue-600 rounded-xl p-6 shadow-xl",children:[(0,k.jsxs)("h4",{className:"text-xl font-bold text-blue-900 dark:text-blue-200 mb-6 flex items-center gap-3",children:[(0,k.jsx)("span",{className:"bg-gradient-to-r from-blue-500 to-cyan-500 text-white rounded-full w-10 h-10 flex items-center justify-center text-2xl shadow-lg",children:"\u2795"}),"Novo Hor\xe1rio Personalizado"]}),(0,k.jsxs)("div",{className:"space-y-5",children:[(0,k.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-5",children:[(0,k.jsxs)("div",{children:[(0,k.jsxs)("label",{className:"block text-sm font-bold text-blue-900 dark:text-blue-200 mb-3 uppercase tracking-wide flex items-center gap-2",children:[(0,k.jsx)("span",{className:"text-blue-600",children:"\ud83d\udcdd"})," Nome do Hor\xe1rio *"]}),(0,k.jsx)("input",{type:"text",placeholder:"Ex: A, B, T1",value:je.nome,onChange:e=>Se((0,n.A)((0,n.A)({},je),{},{nome:e.target.value.toUpperCase()})),className:"w-full px-4 py-3 border-2 border-blue-300 dark:border-blue-600 rounded-xl bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-4 focus:ring-blue-500/50 focus:border-blue-500 transition-all shadow-md text-lg font-bold",maxLength:"3",required:!0}),(0,k.jsx)("p",{className:"text-xs text-blue-700 dark:text-blue-300 mt-2",children:"M\xe1ximo 3 caracteres (ex: A, T1, N2)"})]}),(0,k.jsxs)("div",{children:[(0,k.jsxs)("label",{className:"block text-sm font-bold text-blue-900 dark:text-blue-200 mb-3 uppercase tracking-wide flex items-center gap-2",children:[(0,k.jsx)("span",{className:"text-blue-600",children:"\u23f0"})," Per\xedodo *"]}),(0,k.jsx)("input",{type:"text",placeholder:"08:00-17:00",value:je.descricao,onChange:e=>Se((0,n.A)((0,n.A)({},je),{},{descricao:e.target.value})),className:"w-full px-4 py-3 border-2 border-blue-300 dark:border-blue-600 rounded-xl bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-4 focus:ring-blue-500/50 focus:border-blue-500 transition-all shadow-md text-lg",required:!0}),(0,k.jsx)("p",{className:"text-xs text-blue-700 dark:text-blue-300 mt-2",children:"Formato: HH:MM-HH:MM"})]}),(0,k.jsxs)("div",{children:[(0,k.jsxs)("label",{className:"block text-sm font-bold text-blue-900 dark:text-blue-200 mb-3 uppercase tracking-wide flex items-center gap-2",children:[(0,k.jsx)("span",{className:"text-blue-600",children:"\ud83c\udfe2"})," Setor *"]}),(0,k.jsxs)("select",{value:je.setor,onChange:e=>Se((0,n.A)((0,n.A)({},je),{},{setor:e.target.value})),className:"w-full px-4 py-3 border-2 border-blue-300 dark:border-blue-600 rounded-xl bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-4 focus:ring-blue-500/50 focus:border-blue-500 transition-all shadow-md text-lg",required:!0,children:[(0,k.jsx)("option",{value:"",children:"Selecione o setor..."}),M.map(e=>(0,k.jsx)("option",{value:e,children:e},e))]}),(0,k.jsx)("p",{className:"text-xs text-blue-700 dark:text-blue-300 mt-2",children:"Hor\xe1rio ser\xe1 exclusivo deste setor"})]})]}),(0,k.jsxs)("button",{onClick:async()=>{if(je.nome.trim()&&je.descricao.trim()&&je.setor)try{var e;const t=(0,s.collection)(P.db,"horarios_personalizados");await(0,s.gS)(t,{nome:je.nome.trim().toUpperCase(),descricao:je.descricao.trim(),setorNome:je.setor,setorId:"",empresaId:(null===u||void 0===u?void 0:u.empresaId)||"",empresaNome:(null===(e=F.find(e=>e.id===(null===u||void 0===u?void 0:u.empresaId)))||void 0===e?void 0:e.nome)||"",criadoPor:(null===u||void 0===u?void 0:u.nome)||(null===u||void 0===u?void 0:u.email)||"",criadoPorId:(null===u||void 0===u?void 0:u.id)||"",ativo:!0,dataCriacao:(0,s.O5)(),dataAtualizacao:(0,s.O5)()}),zb.success("\u2705 Hor\xe1rio ".concat(je.nome," criado com sucesso!")),Se({nome:"",descricao:"",setor:""})}catch(t){console.error("Erro ao criar hor\xe1rio:",t),zb.error("Erro ao criar hor\xe1rio. Tente novamente.")}else zb.warning("Preencha todos os campos obrigat\xf3rios!")},className:"w-full px-8 py-4 bg-gradient-to-r from-blue-600 via-cyan-600 to-blue-600 text-white rounded-xl hover:from-blue-700 hover:via-cyan-700 hover:to-blue-700 transition-all font-bold text-lg shadow-2xl hover:shadow-blue-500/50 transform hover:scale-[1.02] active:scale-[0.98] flex items-center justify-center gap-3",children:[(0,k.jsx)("span",{className:"text-2xl",children:"\u2795"}),"Criar Hor\xe1rio Personalizado"]})]})]}),(0,k.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-lg border-2 border-gray-200 dark:border-gray-700",children:[(0,k.jsx)("h4",{className:"text-xl font-bold text-gray-900 dark:text-white mb-6 flex items-center gap-3",children:(0,k.jsx)("span",{className:"bg-gradient-to-r from-blue-500 to-cyan-500 text-white rounded-lg px-4 py-2",children:"\ud83d\udccb Hor\xe1rios Personalizados Criados"})}),Object.values(ke).length>0?(0,k.jsx)("div",{className:"space-y-3",children:Object.values(ke).filter(e=>It(null===u||void 0===u?void 0:u.nivel)||e.setorNome===(null===u||void 0===u?void 0:u.setor)||e.criadoPorId===(null===u||void 0===u?void 0:u.id)).map(e=>(0,k.jsxs)("div",{className:"flex items-center justify-between p-5 rounded-xl border-2 border-purple-200 dark:border-purple-700 bg-gradient-to-r from-purple-50 to-indigo-50 dark:from-purple-900/20 dark:to-indigo-900/20 shadow-md hover:shadow-lg transition-all",children:[(0,k.jsxs)("div",{className:"flex items-center gap-4",children:[(0,k.jsx)("span",{className:"px-5 py-3 bg-gradient-to-r from-purple-600 to-indigo-600 text-white font-black rounded-xl text-2xl shadow-lg",children:e.nome}),(0,k.jsxs)("div",{className:"flex flex-col",children:[(0,k.jsx)("span",{className:"font-bold text-gray-900 dark:text-white text-lg",children:e.descricao}),(0,k.jsxs)("div",{className:"flex gap-4 text-sm text-gray-600 dark:text-gray-400 mt-1",children:[(0,k.jsxs)("span",{children:["\ud83c\udfe2 ",e.setorNome]}),e.criadoPor&&(0,k.jsxs)("span",{children:["\ud83d\udc64 ",e.criadoPor]})]})]})]}),(0,k.jsx)("button",{onClick:async()=>{if(window.confirm("Deseja realmente excluir o hor\xe1rio ".concat(e.nome,"?")))try{await(0,s.deleteDoc)((0,s.doc)(P.db,"horarios_personalizados",e.id)),zb.success("Hor\xe1rio exclu\xeddo com sucesso!")}catch(t){console.error("Erro ao excluir hor\xe1rio:",t),zb.error("Erro ao excluir hor\xe1rio")}},className:"px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-all shadow-md transform hover:scale-105 active:scale-95",children:(0,k.jsx)(nw,{className:"w-5 h-5"})})]},e.id))}):(0,k.jsxs)("div",{className:"text-center py-12 text-gray-500 dark:text-gray-400",children:[(0,k.jsx)(xu,{className:"w-16 h-16 mx-auto mb-4 opacity-50"}),(0,k.jsx)("p",{className:"text-lg font-medium",children:"Nenhum hor\xe1rio personalizado criado ainda"}),(0,k.jsx)("p",{className:"text-sm mt-2",children:"Use o formul\xe1rio acima para criar seu primeiro hor\xe1rio"})]})]})]})]}),(0,k.jsx)("div",{className:"p-6 border-t border-gray-200 dark:border-gray-700 bg-gradient-to-r from-gray-50 to-gray-100 dark:from-gray-800 dark:to-gray-900",children:(0,k.jsx)("button",{onClick:()=>{J(!1),we("horarios")},className:"w-full px-6 py-3 bg-gradient-to-r from-gray-600 to-gray-700 dark:from-gray-500 dark:to-gray-600 text-white rounded-lg hover:from-gray-700 hover:to-gray-800 dark:hover:from-gray-400 dark:hover:to-gray-500 transition-all font-bold shadow-lg transform hover:scale-[1.02] active:scale-[0.98]",children:"\u2713 Fechar"})})]})}),ye&&(0,k.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,k.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full",children:[(0,k.jsxs)("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:[(0,k.jsxs)("h3",{className:"text-xl font-bold text-gray-800 dark:text-white flex items-center gap-2",children:[(0,k.jsx)(tw,{className:"w-6 h-6 text-blue-500"}),"Filtros Avan\xe7ados"]}),(0,k.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-2",children:"Filtre os funcion\xe1rios por empresa e setor"})]}),(0,k.jsxs)("div",{className:"p-6 space-y-4",children:[(0,k.jsxs)("div",{children:[(0,k.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2 flex items-center gap-2",children:[(0,k.jsx)(Wb,{className:"w-4 h-4"}),"Empresa"]}),(0,k.jsxs)("select",{value:C,onChange:e=>{I(e.target.value),D("todos")},className:"w-full px-4 py-3 border-2 border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-800 dark:text-white font-medium focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all",children:[(0,k.jsx)("option",{value:"todas",children:"\ud83c\udfe2 Todas as Empresas"}),F.map(e=>(0,k.jsx)("option",{value:e.id,children:e.nome},e.id))]})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Setor"}),(0,k.jsxs)("select",{value:T,onChange:e=>D(e.target.value),className:"w-full px-4 py-3 border-2 border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-800 dark:text-white font-medium focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all",disabled:"todas"===C&&0===Le.length,children:[(0,k.jsx)("option",{value:"todos",children:"\ud83c\udfd7\ufe0f Todos os Setores"}),Le.map(e=>(0,k.jsx)("option",{value:e,children:e},e))]})]}),("todas"!==C||"todos"!==T)&&(0,k.jsxs)("div",{className:"bg-blue-50 dark:bg-blue-900/20 border-2 border-blue-200 dark:border-blue-700 rounded-lg p-3",children:[(0,k.jsx)("p",{className:"text-xs font-semibold text-blue-800 dark:text-blue-300 mb-2",children:"\u2713 Filtros Ativos:"}),(0,k.jsxs)("div",{className:"space-y-1",children:["todas"!==C&&(0,k.jsxs)("p",{className:"text-xs text-blue-700 dark:text-blue-400",children:["\u2022 Empresa: ",(0,k.jsx)("span",{className:"font-semibold",children:null===(r=F.find(e=>e.id===C))||void 0===r?void 0:r.nome})]}),"todos"!==T&&(0,k.jsxs)("p",{className:"text-xs text-blue-700 dark:text-blue-400",children:["\u2022 Setor: ",(0,k.jsx)("span",{className:"font-semibold",children:T})]})]})]})]}),(0,k.jsxs)("div",{className:"p-6 border-t border-gray-200 dark:border-gray-700 flex gap-3",children:[("todas"!==C||"todos"!==T)&&(0,k.jsxs)("button",{onClick:()=>{I("todas"),D("todos")},className:"flex-1 px-4 py-2 bg-gray-200 dark:bg-gray-600 text-gray-800 dark:text-white rounded-lg hover:bg-gray-300 dark:hover:bg-gray-500 transition-colors font-medium flex items-center justify-center gap-2",children:[(0,k.jsx)(Id,{className:"w-4 h-4"}),"Limpar"]}),(0,k.jsxs)("button",{onClick:()=>ve(!1),className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium flex items-center justify-center gap-2",children:[(0,k.jsx)(lk,{className:"w-4 h-4"}),"Aplicar"]})]})]})}),H.aberto&&(0,k.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,k.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full p-6",children:[(0,k.jsxs)("h3",{className:"text-xl font-bold text-gray-800 dark:text-white mb-4 flex items-center gap-2",children:[(0,k.jsx)(Rd,{className:"w-6 h-6"}),"Anota\xe7\xe3o do Funcion\xe1rio"]}),(0,k.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:["Funcion\xe1rio: ",null===(a=p.find(e=>e.id===H.funcionarioId))||void 0===a?void 0:a.nome,(0,k.jsx)("br",{}),"Dia: ",H.dia,"/",f.getMonth()+1,"/",f.getFullYear()]}),(0,k.jsx)("textarea",{value:H.anotacao,onChange:e=>G((0,n.A)((0,n.A)({},H),{},{anotacao:e.target.value})),className:"w-full h-32 px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-800 dark:text-white focus:ring-2 focus:ring-blue-500 resize-none",placeholder:"Digite sua anota\xe7\xe3o aqui..."}),(0,k.jsxs)("div",{className:"flex gap-3 mt-4",children:[(0,k.jsx)("button",{onClick:()=>(async(e,t,r)=>{if(Pe)try{const a="".concat(f.getFullYear(),"-").concat(String(f.getMonth()+1).padStart(2,"0")),n="".concat(a,"-").concat(String(t).padStart(2,"0")),i="".concat(e,"_").concat(n);r&&""!==r.trim()?await(0,s.setDoc)((0,s.doc)(P.db,"anotacoes_funcionarios",a,"registros",i),{funcionarioId:e,data:n,anotacao:r.trim(),criadoPor:(null===u||void 0===u?void 0:u.email)||"Sistema",criadoEm:new Date}):await(0,s.deleteDoc)((0,s.doc)(P.db,"anotacoes_funcionarios",a,"registros",i)),G({aberto:!1,tipo:null,funcionarioId:null,dia:null,anotacao:""})}catch(a){console.error("Erro ao salvar anota\xe7\xe3o:",a),zb.error("Erro ao salvar anota\xe7\xe3o. Tente novamente.",{position:"top-right",autoClose:4e3})}else zb.warning("Voc\xea n\xe3o tem permiss\xe3o para adicionar anota\xe7\xf5es.",{position:"top-right",autoClose:3e3})})(H.funcionarioId,H.dia,H.anotacao),className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium",children:"Salvar"}),(0,k.jsx)("button",{onClick:()=>G({aberto:!1,tipo:null,funcionarioId:null,dia:null,anotacao:""}),className:"flex-1 px-4 py-2 bg-gray-300 dark:bg-gray-600 text-gray-800 dark:text-white rounded-lg hover:bg-gray-400 dark:hover:bg-gray-500 transition-colors font-medium",children:"Cancelar"})]})]})}),W.aberto&&(0,k.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,k.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-md w-full p-6",children:[(0,k.jsxs)("h3",{className:"text-xl font-bold text-gray-800 dark:text-white mb-4 flex items-center gap-2",children:[(0,k.jsx)(yN,{className:"w-6 h-6"}),"Anota\xe7\xe3o do Dia"]}),(0,k.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:["Data: ",W.dia,"/",f.getMonth()+1,"/",f.getFullYear()]}),(0,k.jsx)("textarea",{value:W.anotacao,onChange:e=>K((0,n.A)((0,n.A)({},W),{},{anotacao:e.target.value})),className:"w-full h-32 px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-800 dark:text-white focus:ring-2 focus:ring-yellow-500 resize-none",placeholder:"Digite uma anota\xe7\xe3o geral para este dia..."}),(0,k.jsxs)("div",{className:"flex gap-3 mt-4",children:[(0,k.jsx)("button",{onClick:()=>(async(e,t)=>{if(Pe)try{const r="".concat(f.getFullYear(),"-").concat(String(f.getMonth()+1).padStart(2,"0")),a="".concat(r,"-").concat(String(e).padStart(2,"0"));t&&""!==t.trim()?await(0,s.setDoc)((0,s.doc)(P.db,"anotacoes_dias",r,"registros",a),{data:a,anotacao:t.trim(),criadoPor:(null===u||void 0===u?void 0:u.email)||"Sistema",criadoEm:new Date}):await(0,s.deleteDoc)((0,s.doc)(P.db,"anotacoes_dias",r,"registros",a)),K({aberto:!1,dia:null,anotacao:""})}catch(r){console.error("Erro ao salvar anota\xe7\xe3o do dia:",r),zb.error("Erro ao salvar anota\xe7\xe3o. Tente novamente.",{position:"top-right",autoClose:4e3})}else zb.warning("Voc\xea n\xe3o tem permiss\xe3o para adicionar anota\xe7\xf5es.",{position:"top-right",autoClose:3e3})})(W.dia,W.anotacao),className:"flex-1 px-4 py-2 bg-yellow-600 text-white rounded-lg hover:bg-yellow-700 transition-colors font-medium",children:"Salvar"}),(0,k.jsx)("button",{onClick:()=>K({aberto:!1,dia:null,anotacao:""}),className:"flex-1 px-4 py-2 bg-gray-300 dark:bg-gray-600 text-gray-800 dark:text-white rounded-lg hover:bg-gray-400 dark:hover:bg-gray-500 transition-colors font-medium",children:"Cancelar"})]})]})}),ie.aberto&&(0,k.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,k.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl max-w-2xl w-full max-h-[80vh] flex flex-col",children:[(0,k.jsxs)("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:[(0,k.jsxs)("div",{className:"flex items-center justify-between",children:[(0,k.jsxs)("h3",{className:"text-2xl font-bold text-gray-800 dark:text-white flex items-center gap-2",children:[(0,k.jsx)(iu,{className:"w-6 h-6 text-green-600"}),ie.titulo]}),(0,k.jsx)("button",{onClick:()=>oe({aberto:!1,tipo:null,dados:[],titulo:""}),className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:(0,k.jsx)(Id,{className:"w-6 h-6"})})]}),(0,k.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-2",children:f.toLocaleDateString("pt-BR",{month:"long",year:"numeric"})})]}),(0,k.jsx)("div",{className:"flex-1 overflow-y-auto p-6",children:"feriados"===ie.tipo&&ie.dados.length>0?(0,k.jsx)("div",{className:"space-y-3",children:ie.dados.map((e,t)=>(0,k.jsx)("div",{className:"bg-gradient-to-r from-orange-50 to-red-50 dark:from-orange-900/20 dark:to-red-900/20 border-l-4 border-orange-500 rounded-lg p-4",children:(0,k.jsxs)("div",{className:"flex items-start justify-between",children:[(0,k.jsxs)("div",{className:"flex-1",children:[(0,k.jsx)("h4",{className:"font-bold text-lg text-gray-800 dark:text-white",children:e.nome}),(0,k.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:[e.diaSemana,", ",e.data]})]}),(0,k.jsx)("div",{className:"bg-orange-600 text-white rounded-full w-10 h-10 flex items-center justify-center font-bold text-lg",children:e.dia})]})},t))}):"uteis"===ie.tipo&&ie.dados.length>0?(0,k.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:ie.dados.map((e,t)=>(0,k.jsxs)("div",{className:"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-700 rounded-lg p-3 text-center",children:[(0,k.jsx)("div",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:e.dia}),(0,k.jsx)("div",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1",children:e.diaSemana})]},t))}):"finsdesemana"===ie.tipo&&ie.dados.length>0?(0,k.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:ie.dados.map((e,t)=>(0,k.jsxs)("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-700 rounded-lg p-3 text-center",children:[(0,k.jsx)("div",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400",children:e.dia}),(0,k.jsx)("div",{className:"text-xs text-gray-600 dark:text-gray-400 mt-1",children:e.diaSemana})]},t))}):(0,k.jsx)("div",{className:"text-center text-gray-500 dark:text-gray-400 py-8",children:"Nenhum registro encontrado"})}),(0,k.jsx)("div",{className:"p-4 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-750",children:(0,k.jsxs)("div",{className:"text-center text-sm text-gray-600 dark:text-gray-400",children:[(0,k.jsx)("span",{className:"font-bold text-lg text-gray-800 dark:text-white",children:ie.dados.length})," ","feriados"===ie.tipo?"feriado(s)":"uteis"===ie.tipo?"dia(s) \xfatil(eis)":"fim(ns) de semana"]})})]})}),le&&(0,k.jsxs)("div",{className:"fixed inset-0 pointer-events-none z-50 overflow-hidden",children:[Array.from({length:25}).map((e,t)=>{const r=2*Math.PI*t/25,a=40*Math.random(),n=le.destino.x+Math.cos(r)*(80+a),s=le.destino.y+Math.sin(r)*(80+a),i=150*Math.random(),o=1+.3*Math.random(),l={presente:{bg:"bg-green-500",glow:"#22c55e",sombra:"0 0 20px rgba(34, 197, 94, 0.8)"},ausente:{bg:"bg-red-500",glow:"#ef4444",sombra:"0 0 20px rgba(239, 68, 68, 0.8)"},folga:{bg:"bg-yellow-400",glow:"#facc15",sombra:"0 0 20px rgba(250, 204, 21, 0.8)"}}[le.tipo],c=2+2*Math.random();return(0,k.jsx)("div",{className:"absolute ".concat(l.bg," rounded-full"),style:{width:"".concat(c,"px"),height:"".concat(c,"px"),left:"".concat(le.origem.x,"px"),top:"".concat(le.origem.y,"px"),animation:"particle-flow-".concat(t," ").concat(o,"s cubic-bezier(0.4, 0, 0.2, 1) forwards"),animationDelay:"".concat(i,"ms"),boxShadow:l.sombra,filter:"blur(0.5px)"},children:(0,k.jsx)("style",{children:"\n                  @keyframes particle-flow-".concat(t," {\n                    0% {\n                      transform: translate(0, 0) scale(1) rotate(0deg);\n                      opacity: 1;\n                    }\n                    30% {\n                      transform: translate(").concat(.3*(n-le.origem.x),"px, ").concat(.3*(s-le.origem.y),"px) scale(1.8) rotate(").concat(120*t,"deg);\n                      opacity: 0.9;\n                    }\n                    60% {\n                      transform: translate(").concat(.7*(n-le.origem.x),"px, ").concat(.7*(s-le.origem.y),"px) scale(1.2) rotate(").concat(240*t,"deg);\n                      opacity: 0.7;\n                    }\n                    100% {\n                      transform: translate(").concat(n-le.origem.x,"px, ").concat(s-le.origem.y,"px) scale(0) rotate(").concat(360*t,"deg);\n                      opacity: 0;\n                    }\n                  }\n                ")})},"particle-".concat(t))}),(0,k.jsx)("div",{className:"absolute rounded-full ".concat("presente"===le.tipo?"bg-green-500/30":"ausente"===le.tipo?"bg-red-500/30":"bg-yellow-400/30"),style:{left:"".concat(le.origem.x,"px"),top:"".concat(le.origem.y,"px"),width:"20px",height:"20px",transform:"translate(-50%, -50%)",animation:"ripple-effect 0.8s ease-out forwards"},children:(0,k.jsx)("style",{children:"\n              @keyframes ripple-effect {\n                0% {\n                  transform: translate(-50%, -50%) scale(1);\n                  opacity: 0.8;\n                }\n                100% {\n                  transform: translate(-50%, -50%) scale(8);\n                  opacity: 0;\n                }\n              }\n            "})})]}),de&&(0,k.jsxs)("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center bg-black/80 backdrop-blur-sm",children:[(0,k.jsx)("style",{children:"\n            @keyframes scan-line {\n              0%, 100% { transform: translateY(-100%); }\n              50% { transform: translateY(100%); }\n            }\n            @keyframes scan-line-warning {\n              0%, 100% { transform: translateY(-100%) scaleX(1.2); }\n              50% { transform: translateY(100%) scaleX(1.2); }\n            }\n            @keyframes pulse-glow-presente {\n              0%, 100% { box-shadow: 0 0 20px rgba(34, 197, 94, 0.5); }\n              50% { box-shadow: 0 0 40px rgba(34, 197, 94, 0.8), 0 0 60px rgba(34, 197, 94, 0.4); }\n            }\n            @keyframes pulse-glow-ausente {\n              0%, 100% { box-shadow: 0 0 20px rgba(239, 68, 68, 0.5); }\n              50% { box-shadow: 0 0 40px rgba(239, 68, 68, 0.8), 0 0 60px rgba(239, 68, 68, 0.4); }\n            }\n            @keyframes pulse-glow-folga {\n              0%, 100% { box-shadow: 0 0 20px rgba(251, 191, 36, 0.5); }\n              50% { box-shadow: 0 0 40px rgba(251, 191, 36, 0.8), 0 0 60px rgba(251, 191, 36, 0.4); }\n            }\n            @keyframes sun-rays {\n              0% { transform: rotate(0deg) scale(1); opacity: 0.8; }\n              50% { transform: rotate(180deg) scale(1.1); opacity: 1; }\n              100% { transform: rotate(360deg) scale(1); opacity: 0.8; }\n            }\n            @keyframes confetti-fall {\n              0% { transform: translateY(-20px) rotate(0deg); opacity: 0; }\n              10% { opacity: 1; }\n              90% { opacity: 1; }\n              100% { transform: translateY(400px) rotate(720deg); opacity: 0; }\n            }\n            @keyframes beach-scan {\n              0% { top: 0%; }\n              50% { top: 50%; }\n              100% { top: 100%; }\n            }\n            @keyframes sun-draw {\n              0% { stroke-dashoffset: 300; opacity: 0; }\n              50% { opacity: 1; }\n              100% { stroke-dashoffset: 0; opacity: 1; }\n            }\n            @keyframes rotate-border {\n              0% { transform: rotate(0deg); }\n              100% { transform: rotate(360deg); }\n            }\n            @keyframes rotate-border-reverse {\n              0% { transform: rotate(360deg); }\n              100% { transform: rotate(0deg); }\n            }\n            @keyframes data-flow {\n              0% { transform: translateX(-100%); opacity: 0; }\n              50% { opacity: 1; }\n              100% { transform: translateX(100%); opacity: 0; }\n            }\n            @keyframes check-draw {\n              0% { stroke-dashoffset: 100; }\n              100% { stroke-dashoffset: 0; }\n            }\n            @keyframes x-draw {\n              0% { stroke-dashoffset: 200; }\n              100% { stroke-dashoffset: 0; }\n            }\n            @keyframes hologram-flicker {\n              0%, 100% { opacity: 1; }\n              50% { opacity: 0.8; }\n            }\n            @keyframes glitch-effect {\n              0%, 100% { transform: translate(0, 0); opacity: 1; }\n              20% { transform: translate(-2px, 2px); opacity: 0.8; }\n              40% { transform: translate(2px, -2px); opacity: 0.9; }\n              60% { transform: translate(-2px, -2px); opacity: 0.7; }\n              80% { transform: translate(2px, 2px); opacity: 0.85; }\n            }\n            @keyframes shake {\n              0%, 100% { transform: translateX(0); }\n              25% { transform: translateX(-5px) rotate(-2deg); }\n              75% { transform: translateX(5px) rotate(2deg); }\n            }\n            @keyframes warning-pulse {\n              0%, 100% { opacity: 1; transform: scale(1); }\n              50% { opacity: 0.6; transform: scale(1.1); }\n            }\n          "}),(0,k.jsxs)("div",{className:"relative",children:[(0,k.jsxs)("div",{className:"relative rounded-2xl p-8 border-2 shadow-2xl overflow-hidden ".concat("presente"===de.tipo?"bg-gradient-to-br from-gray-900 via-emerald-900/50 to-gray-900 border-green-500/50":"ausente"===de.tipo?"bg-gradient-to-br from-gray-900 via-red-900/50 to-gray-900 border-red-500/50":"bg-gradient-to-br from-gray-900 via-amber-900/50 to-gray-900 border-yellow-500/50"),children:[(0,k.jsx)("div",{className:"absolute inset-0 rounded-2xl overflow-hidden pointer-events-none",children:(0,k.jsx)("div",{className:"absolute inset-[-2px] opacity-50 ".concat("presente"===de.tipo?"bg-gradient-to-r from-green-500 via-emerald-500 to-green-500":"ausente"===de.tipo?"bg-gradient-to-r from-red-500 via-orange-500 to-red-500":"bg-gradient-to-r from-yellow-400 via-amber-500 via-orange-400 via-pink-400 to-yellow-400"),style:{animation:"presente"===de.tipo?"rotate-border 3s linear infinite":"ausente"===de.tipo?"rotate-border-reverse 2s linear infinite":"rotate-border 4s linear infinite"}})}),(0,k.jsx)("div",{className:"absolute inset-0 opacity-10",children:(0,k.jsx)("div",{className:"absolute inset-0",style:{backgroundImage:"presente"===de.tipo?"linear-gradient(rgba(34, 197, 94, 0.5) 1px, transparent 1px), linear-gradient(90deg, rgba(34, 197, 94, 0.5) 1px, transparent 1px)":"ausente"===de.tipo?"linear-gradient(rgba(239, 68, 68, 0.5) 1px, transparent 1px), linear-gradient(90deg, rgba(239, 68, 68, 0.5) 1px, transparent 1px)":"linear-gradient(rgba(251, 191, 36, 0.5) 1px, transparent 1px), linear-gradient(90deg, rgba(251, 191, 36, 0.5) 1px, transparent 1px)",backgroundSize:"20px 20px"}})}),"ausente"===de.tipo&&"scanning"===de.fase&&(0,k.jsx)("div",{className:"absolute inset-0 pointer-events-none",children:(0,k.jsxs)("div",{className:"absolute top-4 right-4 flex items-center gap-2 animate-pulse",children:[(0,k.jsx)("div",{className:"w-3 h-3 bg-red-500 rounded-full",style:{animation:"warning-pulse 1s ease-in-out infinite"}}),(0,k.jsx)("span",{className:"text-red-400 text-xs font-bold",children:"ALERTA"})]})}),"folga"===de.tipo&&(0,k.jsx)("div",{className:"absolute inset-0 pointer-events-none overflow-hidden",children:[...Array(15)].map((e,t)=>(0,k.jsx)("div",{className:"absolute w-2 h-2 rounded-full",style:{left:"".concat(100*Math.random(),"%"),top:"-20px",backgroundColor:["#fbbf24","#fb923c","#ec4899","#06b6d4","#a855f7"][t%5],animation:"confetti-fall ".concat(2+2*Math.random(),"s linear ").concat(.5*Math.random(),"s infinite")}},t))}),(0,k.jsxs)("div",{className:"relative z-10 flex flex-col items-center gap-6 min-w-[400px]",children:[(0,k.jsxs)("div",{className:"relative",children:[(0,k.jsx)("div",{className:"absolute inset-[-20px] rounded-full border-4 animate-ping ".concat("presente"===de.tipo?"border-green-500/30":"ausente"===de.tipo?"border-red-500/30":"border-yellow-500/30")}),(0,k.jsx)("div",{className:"absolute inset-[-10px] rounded-full border-2 ".concat("presente"===de.tipo?"border-emerald-400/50":"ausente"===de.tipo?"border-orange-400/50":"border-amber-400/50"),style:{animation:"presente"===de.tipo?"pulse-glow-presente 2s ease-in-out infinite":"ausente"===de.tipo?"pulse-glow-ausente 2s ease-in-out infinite":"pulse-glow-folga 2s ease-in-out infinite"}}),"folga"===de.tipo&&(0,k.jsx)("div",{className:"absolute inset-[-30px] pointer-events-none",children:(0,k.jsxs)("svg",{className:"w-full h-full",viewBox:"0 0 200 200",style:{animation:"sun-rays 5s linear infinite"},children:[[...Array(12)].map((e,t)=>(0,k.jsx)("line",{x1:"100",y1:"100",x2:"100",y2:"20",stroke:"url(#sunGradient)",strokeWidth:"2",strokeLinecap:"round",opacity:"0.6",transform:"rotate(".concat(30*t," 100 100)")},t)),(0,k.jsx)("defs",{children:(0,k.jsxs)("linearGradient",{id:"sunGradient",x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[(0,k.jsx)("stop",{offset:"0%",stopColor:"#fbbf24",stopOpacity:"0"}),(0,k.jsx)("stop",{offset:"100%",stopColor:"#f59e0b",stopOpacity:"1"})]})})]})}),(0,k.jsxs)("div",{className:"relative w-32 h-32 rounded-full overflow-hidden border-4 shadow-2xl ".concat("presente"===de.tipo?"border-green-500":"ausente"===de.tipo?"border-red-500":"border-yellow-400"),style:{animation:"ausente"===de.tipo&&"scanning"===de.fase?"shake 0.5s ease-in-out infinite":"none"},children:[null!==(i=de.funcionario)&&void 0!==i&&i.photoURL?(0,k.jsx)("img",{src:de.funcionario.photoURL,alt:de.funcionario.nome,className:"w-full h-full object-cover",style:{animation:"ausente"===de.tipo&&"analyzing"===de.fase?"glitch-effect 0.3s ease-in-out infinite":"hologram-flicker 3s ease-in-out infinite"}}):(0,k.jsx)("div",{className:"w-full h-full bg-gradient-to-br flex items-center justify-center text-white text-4xl font-bold ".concat("presente"===de.tipo?"from-green-600 to-emerald-600":"ausente"===de.tipo?"from-red-600 to-orange-600":"from-yellow-500 to-amber-600"),children:(null===(o=de.funcionario)||void 0===o||null===(l=o.nome)||void 0===l?void 0:l.charAt(0))||"?"}),"scanning"===de.fase&&(0,k.jsx)("div",{className:"absolute inset-0 overflow-hidden",children:"presente"===de.tipo?(0,k.jsx)("div",{className:"absolute w-full h-1 bg-gradient-to-r from-transparent via-emerald-400 to-transparent",style:{animation:"scan-line 2s ease-in-out infinite"}}):"ausente"===de.tipo?(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)("div",{className:"absolute w-full h-2 bg-gradient-to-r from-transparent via-red-500 to-transparent shadow-lg shadow-red-500/50",style:{animation:"scan-line-warning 1.5s ease-in-out infinite"}}),(0,k.jsx)("div",{className:"absolute w-full h-0.5 bg-gradient-to-r from-transparent via-orange-400 to-transparent",style:{animation:"scan-line-warning 1.5s ease-in-out infinite 0.3s"}})]}):(0,k.jsx)("div",{className:"absolute w-full h-1.5 bg-gradient-to-r from-transparent via-yellow-300 to-transparent shadow-lg shadow-yellow-300/50",style:{animation:"beach-scan 2.5s ease-in-out infinite"}})}),"analyzing"===de.fase&&(0,k.jsx)("div",{className:"absolute inset-0 opacity-30",children:(0,k.jsx)("div",{className:"absolute inset-0",style:{backgroundImage:"presente"===de.tipo?"linear-gradient(rgba(34, 197, 94, 0.8) 1px, transparent 1px), linear-gradient(90deg, rgba(34, 197, 94, 0.8) 1px, transparent 1px)":"ausente"===de.tipo?"linear-gradient(rgba(239, 68, 68, 0.8) 1px, transparent 1px), linear-gradient(90deg, rgba(239, 68, 68, 0.8) 1px, transparent 1px)":"linear-gradient(rgba(251, 191, 36, 0.8) 1px, transparent 1px), linear-gradient(90deg, rgba(251, 191, 36, 0.8) 1px, transparent 1px)",backgroundSize:"10px 10px"}})})]}),["analyzing","verifying"].includes(de.fase)&&(0,k.jsx)(k.Fragment,{children:"presente"===de.tipo?[0,1,2,3,4].map(e=>(0,k.jsx)("div",{className:"absolute w-2 h-2 bg-emerald-400 rounded-full shadow-lg shadow-emerald-400/50",style:{top:"50%",left:"50%",animation:"orbit-".concat(e," ").concat(2+.5*e,"s linear infinite"),transformOrigin:"0 0"},children:(0,k.jsx)("style",{children:"\n                              @keyframes orbit-".concat(e," {\n                                from {\n                                  transform: rotate(").concat(72*e,"deg) translateX(80px) rotate(").concat(72*-e,"deg);\n                                }\n                                to {\n                                  transform: rotate(").concat(360+72*e,"deg) translateX(80px) rotate(").concat(-360-72*e,"deg);\n                                }\n                              }\n                            ")})},e)):"ausente"===de.tipo?[0,1,2,3,4,5,6].map(e=>(0,k.jsx)("div",{className:"absolute rounded-full shadow-lg ".concat(e%2===0?"w-3 h-3 bg-red-500 shadow-red-500/50":"w-2 h-2 bg-orange-400 shadow-orange-400/50"),style:{top:"50%",left:"50%",animation:"orbit-warning-".concat(e," ").concat(1.5+.3*e,"s linear infinite"),transformOrigin:"0 0"},children:(0,k.jsx)("style",{children:"\n                              @keyframes orbit-warning-".concat(e," {\n                                from {\n                                  transform: rotate(").concat(51.4*e,"deg) translateX(").concat(70+20*Math.random(),"px) rotate(").concat(51.4*-e,"deg) scale(").concat(.8+.4*Math.random(),");\n                                }\n                                to {\n                                  transform: rotate(").concat(360+51.4*e,"deg) translateX(").concat(70+20*Math.random(),"px) rotate(").concat(-360-51.4*e,"deg) scale(").concat(1+.5*Math.random(),");\n                                }\n                              }\n                            ")})},e)):[0,1,2,3,4,5,6,7,8].map(e=>{const t=["#fbbf24","#fb923c","#ec4899","#06b6d4","#a855f7"];return(0,k.jsx)("div",{className:"absolute w-2 h-2 rounded-full shadow-lg",style:{backgroundColor:t[e%t.length],boxShadow:"0 0 10px ".concat(t[e%t.length]),top:"50%",left:"50%",animation:"orbit-celebration-".concat(e," ").concat(2.5+.3*e,"s ease-in-out infinite"),transformOrigin:"0 0"},children:(0,k.jsx)("style",{children:"\n                                @keyframes orbit-celebration-".concat(e," {\n                                  from {\n                                    transform: rotate(").concat(40*e,"deg) translateX(").concat(75+e%3*10,"px) rotate(").concat(40*-e,"deg);\n                                  }\n                                  to {\n                                    transform: rotate(").concat(360+40*e,"deg) translateX(").concat(75+e%3*10,"px) rotate(").concat(-360-40*e,"deg);\n                                  }\n                                }\n                              ")})},e)})})]}),(0,k.jsxs)("div",{className:"text-center space-y-2",children:[(0,k.jsx)("h3",{className:"text-2xl font-bold tracking-wider ".concat("presente"===de.tipo?"text-white":"ausente"===de.tipo?"text-red-100":"text-yellow-50"),children:(null===(c=de.funcionario)||void 0===c?void 0:c.nome)||"Funcion\xe1rio"}),(0,k.jsxs)("p",{className:"text-sm font-mono ".concat("presente"===de.tipo?"text-emerald-300":"ausente"===de.tipo?"text-orange-300":"text-amber-300"),children:["ID: ",de.funcionarioId]}),(0,k.jsx)("p",{className:"text-sm ".concat("presente"===de.tipo?"text-emerald-300":"ausente"===de.tipo?"text-red-300":"text-yellow-300"),children:(null===(d=de.funcionario)||void 0===d?void 0:d.cargo)||"Cargo n\xe3o definido"})]}),(0,k.jsxs)("div",{className:"w-full space-y-3",children:[(0,k.jsx)("div",{className:"h-2 bg-gray-800 rounded-full overflow-hidden",children:(0,k.jsx)("div",{className:"h-full transition-all duration-1000 ".concat("presente"===de.tipo?"bg-gradient-to-r from-green-500 via-emerald-400 to-green-500":"ausente"===de.tipo?"bg-gradient-to-r from-red-500 via-orange-400 to-red-500":"bg-gradient-to-r from-yellow-400 via-amber-500 via-orange-400 to-pink-400"," ").concat("scanning"===de.fase?"w-1/4":"analyzing"===de.fase?"w-1/2":"verifying"===de.fase?"w-3/4":"w-full"),style:{animation:"data-flow 2s ease-in-out infinite"}})}),(0,k.jsxs)("div",{className:"text-center",children:["scanning"===de.fase&&(0,k.jsxs)("div",{className:"space-y-1",children:[(0,k.jsx)("p",{className:"text-lg font-mono animate-pulse ".concat("presente"===de.tipo?"text-emerald-400":"ausente"===de.tipo?"text-red-400":"text-yellow-400"),children:"[ SCANNING ]"}),(0,k.jsx)("p",{className:"text-sm ".concat("presente"===de.tipo?"text-green-300":"ausente"===de.tipo?"text-orange-300":"text-amber-300"),children:"presente"===de.tipo?"Digitalizando biometria facial...":"ausente"===de.tipo?"\u26a0\ufe0f Verificando aus\xeancia do funcion\xe1rio...":"\ud83c\udf34 Verificando folga programada..."})]}),"analyzing"===de.fase&&(0,k.jsxs)("div",{className:"space-y-1",children:[(0,k.jsx)("p",{className:"text-lg font-mono animate-pulse ".concat("presente"===de.tipo?"text-emerald-400":"ausente"===de.tipo?"text-red-400":"text-yellow-400"),children:"[ ANALYZING ]"}),(0,k.jsx)("p",{className:"text-sm ".concat("presente"===de.tipo?"text-green-300":"ausente"===de.tipo?"text-orange-300":"text-amber-300"),children:"presente"===de.tipo?"Processando dados do funcion\xe1rio...":"ausente"===de.tipo?"\u26a0\ufe0f Analisando motivo da aus\xeancia...":"\u2600\ufe0f Processando dia de descanso..."})]}),"verifying"===de.fase&&(0,k.jsxs)("div",{className:"space-y-1",children:[(0,k.jsx)("p",{className:"text-lg font-mono animate-pulse ".concat("presente"===de.tipo?"text-emerald-400":"ausente"===de.tipo?"text-red-400":"text-yellow-400"),children:"[ VERIFYING ]"}),(0,k.jsx)("p",{className:"text-sm ".concat("presente"===de.tipo?"text-green-300":"ausente"===de.tipo?"text-orange-300":"text-amber-300"),children:"presente"===de.tipo?"Verificando credenciais...":"ausente"===de.tipo?"\u26a0\ufe0f Registrando falta no sistema...":"\ud83c\udfd6\ufe0f Confirmando folga merecida..."})]}),"confirmed"===de.fase&&(0,k.jsxs)("div",{className:"space-y-3",children:[(0,k.jsx)("div",{className:"flex justify-center",children:(0,k.jsx)("div",{className:"relative w-20 h-20",children:(0,k.jsxs)("svg",{className:"w-full h-full",viewBox:"0 0 100 100",children:[(0,k.jsx)("circle",{cx:"50",cy:"50",r:"45",fill:"none",stroke:"presente"===de.tipo?"#10b981":"ausente"===de.tipo?"#ef4444":"#fbbf24",strokeWidth:"4",className:"opacity-20"}),(0,k.jsx)("circle",{cx:"50",cy:"50",r:"45",fill:"none",stroke:"presente"===de.tipo?"#10b981":"ausente"===de.tipo?"#ef4444":"#fbbf24",strokeWidth:"4",strokeDasharray:"283",strokeDashoffset:"0",className:"animate-spin",style:{transformOrigin:"center",animationDuration:"1s"}}),"presente"===de.tipo&&(0,k.jsx)("path",{d:"M30 50 L45 65 L70 35",fill:"none",stroke:"#10b981",strokeWidth:"6",strokeLinecap:"round",strokeLinejoin:"round",strokeDasharray:"100",strokeDashoffset:"100",style:{animation:"check-draw 0.5s ease-out 0.3s forwards"}}),"ausente"===de.tipo&&(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)("path",{d:"M35 35 L65 65",fill:"none",stroke:"#ef4444",strokeWidth:"6",strokeLinecap:"round",strokeDasharray:"100",strokeDashoffset:"100",style:{animation:"x-draw 0.5s ease-out 0.3s forwards"}}),(0,k.jsx)("path",{d:"M65 35 L35 65",fill:"none",stroke:"#ef4444",strokeWidth:"6",strokeLinecap:"round",strokeDasharray:"100",strokeDashoffset:"100",style:{animation:"x-draw 0.5s ease-out 0.5s forwards"}})]}),"folga"===de.tipo&&(0,k.jsxs)("g",{children:[(0,k.jsx)("circle",{cx:"50",cy:"50",r:"18",fill:"#fbbf24",stroke:"#f59e0b",strokeWidth:"2",strokeDasharray:"150",strokeDashoffset:"150",style:{animation:"sun-draw 0.8s ease-out 0.2s forwards"}}),[...Array(8)].map((e,t)=>(0,k.jsx)("line",{x1:"50",y1:"50",x2:"50",y2:"25",stroke:"#fbbf24",strokeWidth:"3",strokeLinecap:"round",strokeDasharray:"25",strokeDashoffset:"25",transform:"rotate(".concat(45*t," 50 50)"),style:{animation:"sun-draw 0.5s ease-out ".concat(.3+.05*t,"s forwards"),transformOrigin:"50px 50px"}},t))]})]})})}),(0,k.jsx)("p",{className:"text-xl font-bold tracking-wide ".concat("presente"===de.tipo?"text-green-400":"ausente"===de.tipo?"text-red-400":"text-yellow-400"),children:"presente"===de.tipo?"\u2713 PRESEN\xc7A CONFIRMADA":"ausente"===de.tipo?"\u2717 FALTA REGISTRADA":"\ud83c\udf89 FOLGA CONFIRMADA"}),(0,k.jsx)("p",{className:"text-sm ".concat("presente"===de.tipo?"text-green-300":"ausente"===de.tipo?"text-orange-300":"text-amber-300"),children:"presente"===de.tipo?"Funcion\xe1rio marcado como presente":"ausente"===de.tipo?"\u26a0\ufe0f Aus\xeancia registrada no sistema":"\u2600\ufe0f Aproveite seu dia de descanso!"}),(0,k.jsx)("p",{className:"text-xs ".concat("presente"===de.tipo?"text-emerald-400":"ausente"===de.tipo?"text-red-300":"text-yellow-300"),children:(new Date).toLocaleString("pt-BR")})]})]}),(0,k.jsxs)("div",{className:"grid grid-cols-3 gap-2 pt-4 border-t ".concat("presente"===de.tipo?"border-green-500/30":"ausente"===de.tipo?"border-red-500/30":"border-yellow-500/30"),children:[(0,k.jsxs)("div",{className:"text-center",children:[(0,k.jsx)("p",{className:"text-xs text-gray-400",children:"Dia"}),(0,k.jsx)("p",{className:"text-sm font-mono ".concat("presente"===de.tipo?"text-emerald-400":"ausente"===de.tipo?"text-orange-400":"text-amber-400"),children:de.dia})]}),(0,k.jsxs)("div",{className:"text-center",children:[(0,k.jsx)("p",{className:"text-xs text-gray-400",children:"Status"}),(0,k.jsx)("p",{className:"text-sm font-mono ".concat("presente"===de.tipo?"text-green-400":"ausente"===de.tipo?"text-red-400":"text-yellow-400"),children:"presente"===de.tipo?"PRESENTE":"ausente"===de.tipo?"AUSENTE":"FOLGA"})]}),(0,k.jsxs)("div",{className:"text-center",children:[(0,k.jsx)("p",{className:"text-xs text-gray-400",children:"Hora"}),(0,k.jsx)("p",{className:"text-sm font-mono ".concat("presente"===de.tipo?"text-emerald-400":"ausente"===de.tipo?"text-orange-400":"text-amber-400"),children:(new Date).toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"})})]})]})]})]})]}),"confirmed"===de.fase&&(0,k.jsx)(k.Fragment,{children:[0,1,2,3].map(e=>(0,k.jsx)("div",{className:"absolute inset-0 ".concat("presente"===de.tipo?"bg-green-500/10":"bg-red-500/10"),style:{animation:"pulse-glow 1s ease-out ".concat(.2*e,"s"),borderRadius:"50%",transform:"scale(".concat(1+.5*e,")")}},e))})]})]})]}):(0,k.jsx)("div",{className:"flex items-center justify-center h-screen bg-gray-50 dark:bg-gray-900",children:(0,k.jsxs)("div",{className:"text-center bg-white dark:bg-gray-800 p-8 rounded-lg shadow-lg",children:[(0,k.jsx)("div",{className:"text-red-500 mb-4",children:(0,k.jsx)(iu,{className:"w-16 h-16 mx-auto"})}),(0,k.jsx)("h2",{className:"text-2xl font-bold text-gray-800 dark:text-white mb-2",children:"Acesso Negado"}),(0,k.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"Voc\xea n\xe3o tem permiss\xe3o para acessar a escala de trabalho."}),(0,k.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-500 mt-2",children:"Apenas supervisores e administradores podem visualizar e editar escalas."})]})})};var bN=r(9976),wN=r.n(bN);const kN=t=>{let{funcionarios:r,adicionarFuncionario:a,removerFuncionario:n,atualizarFuncionario:s,readonly:i}=t;const[o,l]=(0,e.useState)("funcionarios"),{usuario:c}=Nt(),d=e=>e===jt.ADMIN||e!==jt.FUNCIONARIO&&e<=jt.SUPERVISOR,u=[{id:"funcionarios",nome:"Funcion\xe1rios",icone:uk,descricao:"Gerencie colaboradores e suas informa\xe7\xf5es",permissao:()=>Dt.canView(null===c||void 0===c?void 0:c.nivel)},{id:"tarefas",nome:"Tarefas",icone:Gb,descricao:"Atribua e acompanhe tarefas dos funcion\xe1rios",permissao:()=>Dt.canView(null===c||void 0===c?void 0:c.nivel)},{id:"escala",nome:"Escala",icone:iu,descricao:"Gerencie hor\xe1rios e turnos de trabalho",permissao:()=>d(null===c||void 0===c?void 0:c.nivel)}].filter(e=>e.permissao());return(0,k.jsxs)("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 p-4 md:p-6",children:[(0,k.jsx)("div",{className:"max-w-7xl mx-auto mb-6",children:(0,k.jsx)("div",{className:"bg-gradient-to-r from-blue-500 to-blue-600 rounded-2xl p-6 shadow-xl",children:(0,k.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,k.jsx)("div",{className:"p-3 bg-white/20 rounded-xl backdrop-blur-sm",children:(0,k.jsx)(uk,{className:"w-8 h-8 text-white"})}),(0,k.jsxs)("div",{children:[(0,k.jsx)("h1",{className:"text-2xl md:text-3xl font-bold text-white",children:"Gest\xe3o de Funcion\xe1rios"}),(0,k.jsx)("p",{className:"text-blue-100 text-sm md:text-base",children:"Gerencie colaboradores, tarefas e escalas em um s\xf3 lugar"})]})]})})}),(0,k.jsx)("div",{className:"max-w-7xl mx-auto mb-6",children:(0,k.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg p-2",children:(0,k.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2",children:u.map(e=>{const t=e.icone,r=o===e.id;return(0,k.jsxs)("button",{onClick:()=>l(e.id),className:"\n                    flex items-center gap-3 p-4 rounded-lg transition-all duration-200\n                    ".concat(r?"bg-gradient-to-r from-blue-500 to-blue-600 text-white shadow-lg scale-105":"bg-gray-50 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-600","\n                  "),children:[(0,k.jsx)("div",{className:"\n                    p-2 rounded-lg\n                    ".concat(r?"bg-white/20":"bg-white dark:bg-gray-600","\n                  "),children:(0,k.jsx)(t,{className:"w-5 h-5 ".concat(r?"text-white":"text-blue-600 dark:text-blue-400")})}),(0,k.jsxs)("div",{className:"text-left flex-1",children:[(0,k.jsx)("div",{className:"font-semibold ".concat(r?"text-white":"text-gray-900 dark:text-white"),children:e.nome}),(0,k.jsx)("div",{className:"text-xs ".concat(r?"text-white/80":"text-gray-500 dark:text-gray-400"),children:e.descricao})]})]},e.id)})})})}),(0,k.jsx)("div",{className:"max-w-7xl mx-auto",children:(()=>{switch(o){case"funcionarios":return Dt.canView(null===c||void 0===c?void 0:c.nivel)?(0,k.jsx)(fN,{funcionarios:r,adicionarFuncionario:a,removerFuncionario:n,atualizarFuncionario:s,readonly:!Dt.canManageEmployees(null===c||void 0===c?void 0:c.nivel)}):(0,k.jsx)(wN(),{message:"Voc\xea n\xe3o tem permiss\xe3o para visualizar os funcion\xe1rios."});case"tarefas":return Dt.canView(null===c||void 0===c?void 0:c.nivel)?(0,k.jsx)(zk,{showOnlyUserTasks:(null===c||void 0===c?void 0:c.nivel)===jt.FUNCIONARIO}):(0,k.jsx)(wN(),{message:"Voc\xea n\xe3o tem permiss\xe3o para visualizar as tarefas."});case"escala":return d(null===c||void 0===c?void 0:c.nivel)?(0,k.jsx)(vN,{usuarioAtual:c}):(0,k.jsx)(wN(),{message:"Voc\xea n\xe3o tem permiss\xe3o para visualizar a escala de trabalho."});default:return null}})()})]})},NN=y("crown",[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]]),jN=y("info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]),SN=t=>{let{nivel:r,onChange:a,disabled:n=!1,usuarioLogadoNivel:s=null,showIcon:i=!0,showDescription:o=!0}=t;const l=(()=>{const e=[];return console.log("\ud83d\udd0d NivelPermissaoSelector - usuarioLogadoNivel:",s),console.log("\ud83d\udd0d NIVEIS_PERMISSAO.ADMIN:",jt.ADMIN),console.log("\ud83d\udd0d Compara\xe7\xe3o (===):",s===jt.ADMIN),console.log("\ud83d\udd0d Tipo do usuarioLogadoNivel:",typeof s),s!==jt.ADMIN&&0!==s||Object.entries(jt).forEach(t=>{let[r,a]=t;e.push({valor:a,label:St[a],icone:Et[a],key:r})}),e.sort((e,t)=>e.valor-t.valor)})(),c=e=>({[jt.ADMIN]:NN,[jt.FUNCIONARIO]:mu,[jt.SUPERVISOR]:T,[jt.GERENTE_SETOR]:uk,[jt.GERENTE_GERAL]:Wb,[jt.RH]:Kb,[jt.CEO]:ou}[e]||mu);return 0===l.length?(0,k.jsx)("div",{className:"p-4 bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg",children:(0,k.jsxs)("p",{className:"text-yellow-800 dark:text-yellow-200 text-sm flex items-center gap-2",children:[(0,k.jsx)(jN,{className:"w-4 h-4"}),"Voc\xea n\xe3o tem permiss\xe3o para gerenciar n\xedveis de usu\xe1rio."]})}):(0,k.jsxs)("div",{className:"space-y-2",children:[(0,k.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"N\xedvel de Permiss\xe3o *"}),(0,k.jsx)("select",{value:r,onChange:e=>a(parseInt(e.target.value)),disabled:n,className:"\n          w-full px-3 py-2 \n          bg-gray-50 dark:bg-gray-700 \n          border border-gray-200 dark:border-gray-600 \n          rounded-lg \n          text-gray-900 dark:text-white \n          placeholder-gray-500 dark:placeholder-gray-400 \n          focus:ring-2 focus:ring-blue-500 focus:border-transparent\n          ".concat(n?"opacity-50 cursor-not-allowed":"cursor-pointer","\n        "),children:l.map(e=>(0,k.jsxs)("option",{value:e.valor,children:[i&&e.icone," ",e.label," (N\xedvel ",e.valor,")"]},e.valor))}),o&&null!==r&&void 0!==r&&(0,k.jsx)("div",{className:"mt-2 p-3 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg",children:(0,k.jsxs)("p",{className:"text-sm text-blue-800 dark:text-blue-200 flex items-center gap-2",children:[e.createElement(c(r),{className:"w-4 h-4"}),(d=r,{[jt.ADMIN]:"Acesso total ao sistema - Todas as permiss\xf5es",[jt.FUNCIONARIO]:"Acesso b\xe1sico - Opera\xe7\xf5es do dia a dia",[jt.SUPERVISOR]:"Supervisiona equipe - Gerencia opera\xe7\xf5es do setor",[jt.GERENTE_SETOR]:"Gerencia setor - Controle de funcion\xe1rios e processos",[jt.GERENTE_GERAL]:"Gerencia m\xfaltiplos setores - Vis\xe3o estrat\xe9gica",[jt.RH]:"Recursos Humanos - Gest\xe3o de pessoal",[jt.CEO]:"Diretor Executivo - Lideran\xe7a organizacional"}[d]||"N\xedvel desconhecido")]})}),(0,k.jsx)("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:l.map(t=>(0,k.jsx)("div",{onClick:()=>!n&&a(t.valor),className:"\n              p-3 border rounded-lg cursor-pointer transition-all duration-200\n              ".concat(r===t.valor?"border-blue-500 bg-blue-50 dark:bg-blue-900/30 ring-2 ring-blue-500":"border-gray-200 dark:border-gray-600 bg-white dark:bg-gray-800 hover:border-blue-300 hover:bg-blue-25 dark:hover:bg-blue-900/10","\n              ").concat(n?"opacity-50 cursor-not-allowed":"","\n            "),children:(0,k.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,k.jsx)("div",{className:"p-2 bg-blue-100 dark:bg-blue-900/30 rounded-lg",children:e.createElement(c(t.valor),{className:"w-5 h-5 text-blue-600 dark:text-blue-400"})}),(0,k.jsxs)("div",{children:[(0,k.jsx)("p",{className:"font-medium text-gray-900 dark:text-white text-sm",children:t.label}),(0,k.jsxs)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:["N\xedvel ",t.valor]})]})]})},t.valor))}),(0,k.jsx)("div",{className:"mt-4 p-3 bg-gray-50 dark:bg-gray-800 rounded-lg",children:(0,k.jsxs)("p",{className:"text-xs text-gray-600 dark:text-gray-400 flex items-center gap-2",children:[(0,k.jsx)(jN,{className:"w-4 h-4 flex-shrink-0"}),(0,k.jsxs)("span",{children:[(0,k.jsx)("strong",{children:"Sistema Reversivo:"})," N\xfameros menores = Maior permiss\xe3o. N\xedvel 0 (Administrador) tem m\xe1xima permiss\xe3o, N\xedvel 6 (CEO) tem permiss\xf5es espec\xedficas."]})]})})]});var d},_N=y("user-cog",[["path",{d:"M10 15H6a4 4 0 0 0-4 4v2",key:"1nfge6"}],["path",{d:"m14.305 16.53.923-.382",key:"1itpsq"}],["path",{d:"m15.228 13.852-.923-.383",key:"eplpkm"}],["path",{d:"m16.852 12.228-.383-.923",key:"13v3q0"}],["path",{d:"m16.852 17.772-.383.924",key:"1i8mnm"}],["path",{d:"m19.148 12.228.383-.923",key:"1q8j1v"}],["path",{d:"m19.53 18.696-.382-.924",key:"vk1qj3"}],["path",{d:"m20.772 13.852.924-.383",key:"n880s0"}],["path",{d:"m20.772 16.148.924.383",key:"1g6xey"}],["circle",{cx:"18",cy:"15",r:"3",key:"gjjjvw"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]]),EN=y("mail",[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]]),AN=y("lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),{classes:CN,colors:IN}=hw,TN=()=>{const{usuarios:t,usuario:r,criarUsuario:a,atualizarUsuario:i,removerUsuario:o}=Nt(),[l,c]=(0,e.useState)(!1),[d,u]=(0,e.useState)(null),[h,m]=(0,e.useState)(!1),[f,g]=(0,e.useState)(!1),[p,x]=(0,e.useState)(""),[y,v]=(0,e.useState)(""),[w,N]=(0,e.useState)(null),[j,S]=(0,e.useState)(""),[_,E]=(0,e.useState)([]),[A,C]=(0,e.useState)([]),[T,F]=(0,e.useState)([]),[L,M]=(0,e.useState)({}),[R,O]=(0,e.useState)({nome:"",email:"",senha:"",nivel:jt.FUNCIONARIO,ativo:!0,empresaId:"",setorId:"",cargo:"",semEmpresaSetor:!1});if((0,e.useEffect)(()=>{(async()=>{try{const[e,t,r]=await Promise.all([(0,s.GG)((0,s.collection)(P.db,"empresas")),(0,s.GG)((0,s.collection)(P.db,"setores")),(0,s.GG)((0,s.collection)(P.db,"funcionarios"))]);E(e.docs.map(e=>(0,n.A)({id:e.id},e.data()))),C(t.docs.map(e=>(0,n.A)({id:e.id},e.data()))),F(r.docs.map(e=>(0,n.A)({id:e.id},e.data())))}catch(e){console.error("Erro ao carregar dados:",e)}})()},[]),(0,e.useEffect)(()=>{(async()=>{if(!t.length||!T.length)return;const e={};for(const a of t){const t=T.find(e=>{var t,r,n,s;return(null===(t=e.email)||void 0===t?void 0:t.toLowerCase())===(null===(r=a.email)||void 0===r?void 0:r.toLowerCase())||(null===(n=e.nome)||void 0===n?void 0:n.toLowerCase())===(null===(s=a.nome)||void 0===s?void 0:s.toLowerCase())});if(t)try{const r=(0,s.P)((0,s.collection)(P.db,"avaliacoes"),(0,s._M)("funcionarioId","==",t.id)),i=(await(0,s.GG)(r)).docs.map(e=>(0,n.A)((0,n.A)({},e.data()),{},{nota:Number(e.data().estrelas||e.data().nota||0)})),o=i.length>0?i.reduce((e,t)=>e+t.nota,0)/i.length:0;e[a.id]={funcionarioId:t.id,photoURL:t.photoURL,telefone:t.telefone,cargo:t.cargo,avaliacoes:i,totalAvaliacoes:i.length,mediaAvaliacao:o}}catch(r){console.error("Erro ao carregar estat\xedsticas do usu\xe1rio ".concat(a.email,":"),r)}}M(e)})()},[t,T]),!r)return(0,k.jsxs)("div",{className:"bg-gray-200 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-xl shadow-sm p-8 text-center",children:[(0,k.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-[#1D9BF0] mx-auto mb-4"}),(0,k.jsx)("p",{className:IN.textSecondary,children:"Carregando dados do usu\xe1rio..."})]});const B=(null===r||void 0===r?void 0:r.nivel)===jt.FUNCIONARIO,z=(()=>{const e=[];return(null===r||void 0===r?void 0:r.nivel)===jt.ADMIN&&Object.entries(jt).forEach(t=>{let[r,a]=t;e.push({valor:a,label:St[a],key:r})}),e.sort((e,t)=>e.valor-t.valor)})(),U=()=>{O({nome:"",email:"",senha:"",nivel:jt.FUNCIONARIO,ativo:!0,empresaId:"",setorId:"",cargo:"",semEmpresaSetor:!1}),u(null),m(!1),x(""),v("")},V=()=>{c(!1),U()},q=t.filter(e=>{const t=r.nivel===jt.ADMIN||(r.nivel<=jt.GERENTE_SETOR&&e.nivel>jt.GERENTE_SETOR||e.id===r.id),a=j.toLowerCase(),n=!j||e.nome.toLowerCase().includes(a)||e.email.toLowerCase().includes(a)||e.empresaNome&&e.empresaNome.toLowerCase().includes(a)||e.setorNome&&e.setorNome.toLowerCase().includes(a)||e.cargo&&e.cargo.toLowerCase().includes(a);return t&&n}).sort((e,t)=>e.nome.localeCompare(t.nome));return(0,k.jsxs)("div",{className:"space-y-6",children:[(0,k.jsxs)("div",{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl shadow-lg p-6",children:[(0,k.jsxs)("div",{className:"space-y-4",children:[(0,k.jsxs)("div",{className:"flex items-center justify-between",children:[(0,k.jsxs)("div",{className:"flex items-center gap-3",children:[(0,k.jsx)("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-500 to-purple-600 dark:from-[#1D9BF0] dark:to-purple-500 rounded-xl flex items-center justify-center shadow-md",children:(0,k.jsx)(_N,{className:"w-6 h-6 text-white"})}),(0,k.jsxs)("div",{children:[(0,k.jsxs)("h2",{className:"text-xl font-bold ".concat(IN.text),children:[(0,k.jsx)("span",{className:"hidden sm:inline",children:"Gerenciamento de Usu\xe1rios"}),(0,k.jsx)("span",{className:"sm:hidden",children:"Usu\xe1rios"})]}),(0,k.jsx)("p",{className:"text-sm ".concat(IN.textSecondary," hidden sm:block"),children:"Usu\xe1rios com acesso ao sistema - Seguran\xe7a SHA-512"}),(0,k.jsx)("p",{className:"text-xs ".concat(IN.textSecondary," sm:hidden"),children:"Acesso ao sistema"})]})]}),z.length>0&&(0,k.jsxs)("button",{onClick:()=>{B||(U(),c(!0))},className:"flex items-center gap-2 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 dark:from-[#1D9BF0] dark:to-[#1A8CD8] dark:hover:from-[#1A8CD8] dark:hover:to-[#1D9BF0] text-white px-6 py-2.5 rounded-full transition-all shadow-md hover:shadow-lg transform hover:scale-105",children:[(0,k.jsx)(D,{className:"w-5 h-5"}),(0,k.jsx)("span",{className:"font-medium hidden sm:inline",children:"Novo Usu\xe1rio"}),(0,k.jsx)("span",{className:"font-medium sm:hidden",children:"Novo"})]})]}),(0,k.jsxs)("div",{className:"relative",children:[(0,k.jsx)(Ft,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400 pointer-events-none"}),(0,k.jsx)("input",{type:"text",placeholder:"Buscar por nome, email, empresa, setor ou fun\xe7\xe3o...",value:j,onChange:e=>S(e.target.value),className:"w-full pl-12 pr-12 py-3 bg-gray-50 dark:bg-gray-700 border-2 border-gray-200 dark:border-gray-600 rounded-xl text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:ring-2 focus:ring-blue-500 dark:focus:ring-[#1D9BF0] focus:border-transparent transition-all shadow-sm"}),j&&(0,k.jsx)("button",{onClick:()=>S(""),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:(0,k.jsx)(Id,{className:"w-5 h-5"})})]}),(0,k.jsxs)("div",{className:"flex items-center gap-2 text-xs bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-700 rounded-lg px-3 py-2",children:[(0,k.jsx)(I,{className:"w-4 h-4 text-green-600 dark:text-green-400"}),(0,k.jsxs)("span",{className:"text-green-700 dark:text-green-300 font-medium",children:["Senhas criptografadas com SHA-512 | ",q.length," usu\xe1rio",1!==q.length?"s":""," cadastrado",1!==q.length?"s":""]})]})]}),p&&(0,k.jsx)("div",{className:"bg-gray-200 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-xl shadow-sm mt-4 p-4 border border-red-500 border-opacity-20 bg-red-500 bg-opacity-10 text-red-500 dark:border-[#F4212E] dark:bg-[#F4212E] dark:text-[#F4212E]",children:p}),y&&(0,k.jsx)("div",{className:"bg-gray-200 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-xl shadow-sm mt-4 p-4 border border-green-500 border-opacity-20 bg-green-500 bg-opacity-10 text-green-500 dark:border-[#00BA7C] dark:bg-[#00BA7C] dark:text-[#00BA7C]",children:y})]}),(0,k.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6",children:0===q.length?(0,k.jsx)("div",{className:"col-span-full",children:(0,k.jsx)("div",{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl shadow-lg p-12",children:(0,k.jsxs)("div",{className:"flex flex-col items-center justify-center space-y-3",children:[(0,k.jsx)("div",{className:"w-16 h-16 bg-gray-100 dark:bg-gray-700 rounded-full flex items-center justify-center",children:(0,k.jsx)(mu,{className:"w-8 h-8 text-gray-400 dark:text-gray-500"})}),(0,k.jsxs)("div",{className:"text-center",children:[(0,k.jsx)("p",{className:"text-lg font-medium ".concat(IN.text),children:"Nenhum usu\xe1rio encontrado"}),(0,k.jsx)("p",{className:"text-sm ".concat(IN.textSecondary," mt-1"),children:j?"Tente ajustar os termos de busca":"Adicione usu\xe1rios para come\xe7ar"})]})]})})}):q.map(e=>{const t=L[e.id]||{},a=Number(t.mediaAvaliacao)||0,n=t.totalAvaliacoes||0;return(0,k.jsxs)("div",{className:"group relative overflow-hidden bg-white/80 backdrop-blur-sm dark:bg-gray-800/80 rounded-2xl border border-white/20 dark:border-gray-700/50 hover:border-blue-400/50 dark:hover:border-blue-500/50 transition-all duration-500 hover:shadow-2xl hover:shadow-blue-500/25 dark:hover:shadow-blue-500/10",children:[(0,k.jsx)("div",{className:"absolute inset-0 bg-gradient-to-br from-blue-50/50 via-white/50 to-purple-50/50 dark:from-blue-900/10 dark:via-gray-800/50 dark:to-purple-900/10 opacity-0 group-hover:opacity-100 transition-opacity duration-500"}),(0,k.jsx)("div",{className:"absolute left-0 top-0 bottom-0 w-1.5 rounded-l-2xl ".concat(e.ativo?e.nivel===jt.ADMIN?"bg-gradient-to-b from-red-500 to-red-700":"bg-gradient-to-b from-blue-400 via-purple-500 to-blue-600":"bg-gradient-to-b from-red-400 to-red-600"," shadow-lg"),children:(0,k.jsx)("div",{className:"absolute inset-0 bg-gradient-to-b from-white/30 to-transparent rounded-l-2xl"})}),(0,k.jsxs)("div",{className:"relative pl-6 pr-5 py-6",children:[(0,k.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,k.jsxs)("div",{className:"flex items-start gap-4 flex-1 min-w-0",children:[(0,k.jsxs)("div",{className:"relative flex-shrink-0",children:[(0,k.jsx)("div",{className:"h-16 w-16 rounded-2xl flex items-center justify-center font-bold text-white shadow-lg overflow-hidden ".concat(e.nivel===jt.ADMIN?"bg-gradient-to-br from-red-500 to-red-700":e.nivel===jt.GERENTE_GERAL?"bg-gradient-to-br from-blue-500 to-blue-700":e.nivel===jt.GERENTE_SETOR?"bg-gradient-to-br from-blue-400 to-blue-600":e.nivel===jt.SUPERVISOR?"bg-gradient-to-br from-green-500 to-green-700":"bg-gradient-to-br from-yellow-500 to-yellow-700"),children:t.photoURL?(0,k.jsx)("img",{src:t.photoURL,alt:e.nome,className:"w-full h-full object-cover"}):(0,k.jsx)("span",{className:"text-2xl",children:e.nome.charAt(0).toUpperCase()})}),2===e.senhaVersion&&(0,k.jsx)("div",{className:"absolute -bottom-1 -right-1 bg-green-500 rounded-full p-1 shadow-lg",children:(0,k.jsx)(I,{className:"w-3.5 h-3.5 text-white"})})]}),(0,k.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,k.jsxs)("div",{className:"flex items-center gap-2 mb-1 flex-wrap",children:[(0,k.jsx)("h3",{className:"text-lg font-bold ".concat(IN.text," truncate"),children:e.nome}),e.id===r.id&&(0,k.jsx)("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300",children:"Voc\xea"})]}),(0,k.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,k.jsx)(EN,{className:"w-3.5 h-3.5 text-gray-400"}),(0,k.jsx)("p",{className:"text-sm ".concat(IN.textSecondary," truncate"),children:e.email})]}),(0,k.jsxs)("span",{className:"inline-flex items-center gap-1.5 px-3 py-1 text-xs font-bold rounded-full shadow-sm ".concat(e.nivel===jt.ADMIN?"bg-gradient-to-r from-red-500 to-red-600 text-white":e.nivel===jt.GERENTE_GERAL?"bg-gradient-to-r from-blue-500 to-blue-600 text-white":e.nivel===jt.GERENTE_SETOR?"bg-gradient-to-r from-blue-400 to-blue-500 text-white":e.nivel===jt.SUPERVISOR?"bg-gradient-to-r from-green-500 to-green-600 text-white":"bg-gradient-to-r from-yellow-500 to-yellow-600 text-white"),children:[(0,k.jsx)(I,{className:"w-3 h-3"}),St[e.nivel]]})]})]}),(0,k.jsx)("span",{className:"flex-shrink-0 inline-flex items-center gap-1.5 px-3 py-1 text-xs font-bold rounded-full shadow-sm ".concat(e.ativo?"bg-gradient-to-r from-green-500 to-green-600 text-white":"bg-gradient-to-r from-red-500 to-red-600 text-white"),children:e.ativo?(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(Fd,{className:"w-3 h-3"}),"Ativo"]}):(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(b,{className:"w-3 h-3"}),"Inativo"]})})]}),(0,k.jsxs)("div",{className:"space-y-3 mb-4",children:[(e.empresaNome||e.setorNome)&&(0,k.jsxs)("div",{className:"flex items-start gap-2",children:[(0,k.jsx)(Wb,{className:"w-4 h-4 text-blue-500 dark:text-blue-400 flex-shrink-0 mt-0.5"}),(0,k.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,k.jsx)("p",{className:"text-sm font-medium ".concat(IN.text," truncate"),children:e.empresaNome||(0,k.jsx)("span",{className:"text-gray-400 italic",children:"Sem empresa"})}),e.setorNome&&(0,k.jsx)("p",{className:"text-xs ".concat(IN.textSecondary," truncate"),children:e.setorNome})]})]}),(t.cargo||e.cargo)&&(0,k.jsxs)("div",{className:"flex items-center gap-2",children:[(0,k.jsx)(Kb,{className:"w-4 h-4 text-purple-500 dark:text-purple-400"}),(0,k.jsx)("p",{className:"text-sm ".concat(IN.text),children:t.cargo||e.cargo})]}),t.telefone&&(0,k.jsxs)("div",{className:"flex items-center gap-2",children:[(0,k.jsx)(jk,{className:"w-4 h-4 text-green-500 dark:text-green-400"}),(0,k.jsx)("p",{className:"text-sm ".concat(IN.text),children:t.telefone})]}),n>0&&(0,k.jsxs)("div",{className:"flex items-center gap-2 p-3 bg-gradient-to-r from-yellow-50 to-orange-50 dark:from-yellow-900/20 dark:to-orange-900/20 rounded-lg border border-yellow-200/50 dark:border-yellow-700/30",children:[(0,k.jsx)(Ld,{className:"w-5 h-5 text-yellow-500 fill-yellow-500"}),(0,k.jsxs)("div",{className:"flex-1",children:[(0,k.jsxs)("div",{className:"flex items-center gap-2",children:[(0,k.jsx)("span",{className:"text-lg font-bold ".concat(IN.text),children:a.toFixed(1)}),(0,k.jsx)("div",{className:"flex gap-0.5",children:[1,2,3,4,5].map(e=>(0,k.jsx)(Ld,{className:"w-3.5 h-3.5 ".concat(e<=Math.round(a)?"text-yellow-500 fill-yellow-500":"text-gray-300 dark:text-gray-600")},e))})]}),(0,k.jsxs)("p",{className:"text-xs ".concat(IN.textSecondary),children:[n," avalia\xe7\xe3o",1!==n?"\xf5es":""]})]})]}),(0,k.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,k.jsx)(xu,{className:"w-4 h-4 text-gray-400"}),(0,k.jsx)("span",{className:IN.textSecondary,children:e.ultimoLogin?(0,k.jsxs)(k.Fragment,{children:["\xdaltimo acesso: ",new Date(e.ultimoLogin).toLocaleDateString("pt-BR")]}):(0,k.jsx)("span",{className:"italic",children:"Nunca acessou"})})]})]}),(0,k.jsxs)("div",{className:"flex gap-2 pt-3 border-t border-gray-200 dark:border-gray-700",children:[Dt.canEditUser(r.nivel,r.id,e.id,e.nivel)&&(0,k.jsxs)("button",{onClick:t=>{t.stopPropagation(),(e=>{Dt.canEditUser(r.nivel,r.id,e.id,e.nivel)?(O({nome:e.nome,email:e.email,senha:"",nivel:e.nivel,ativo:e.ativo,empresaId:e.empresaId||"",setorId:e.setorId||"",cargo:e.cargo||"",semEmpresaSetor:!e.empresaId&&!e.setorId}),u(e),c(!0)):x("Voc\xea n\xe3o tem permiss\xe3o para editar este usu\xe1rio.")})(e)},className:"flex-1 flex items-center justify-center gap-2 px-4 py-2 bg-blue-500 hover:bg-blue-600 dark:bg-blue-600 dark:hover:bg-blue-700 text-white rounded-lg transition-all shadow-sm text-sm font-medium",children:[(0,k.jsx)(gw,{className:"w-4 h-4"}),"Editar"]}),r.nivel===jt.ADMIN&&"admin"!==e.email&&e.id!==r.id&&(0,k.jsxs)("button",{onClick:t=>{t.stopPropagation(),(e=>{Dt.canEditUser(r.nivel,r.id,e.id,e.nivel)?N(e):x("Voc\xea n\xe3o tem permiss\xe3o para remover este usu\xe1rio.")})(e)},className:"flex items-center justify-center gap-2 px-4 py-2 bg-red-500 hover:bg-red-600 dark:bg-red-600 dark:hover:bg-red-700 text-white rounded-lg transition-all shadow-sm text-sm font-medium",children:[(0,k.jsx)(nw,{className:"w-4 h-4"}),"Remover"]})]})]})]},e.id)})}),l&&(0,k.jsx)("div",{className:"fixed inset-0 bg-black/50 dark:bg-black/70 flex items-center justify-center z-50 p-4",children:(0,k.jsxs)("div",{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl shadow-2xl max-w-md w-full flex flex-col max-h-[90vh] md:max-h-[85vh]",children:[(0,k.jsxs)("div",{className:"flex items-center justify-between p-4 md:p-6 border-b border-gray-200 dark:border-gray-700 flex-shrink-0",children:[(0,k.jsx)("h3",{className:"text-lg md:text-xl font-bold ".concat(IN.text),children:d?"Editar Usu\xe1rio":"Novo Usu\xe1rio"}),(0,k.jsx)("button",{onClick:V,className:"p-2 hover:bg-[#1D9BF0] hover:bg-opacity-10 rounded-full transition-colors",children:(0,k.jsx)(Id,{className:"w-5 h-5 md:w-6 md:h-6 text-[#1D9BF0]"})})]}),(0,k.jsx)("div",{className:"flex-1 overflow-y-auto p-4 md:p-6",children:(0,k.jsxs)("div",{className:"space-y-3 md:space-y-4",children:[(0,k.jsxs)("div",{children:[(0,k.jsxs)("label",{className:"flex items-center gap-2 text-sm font-medium ".concat(IN.text," mb-2"),children:[(0,k.jsx)(mu,{className:"w-4 h-4"}),"Nome Completo *"]}),(0,k.jsx)("input",{type:"text",value:R.nome,onChange:e=>O((0,n.A)((0,n.A)({},R),{},{nome:e.target.value})),className:"w-full px-4 py-2 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:ring-2 focus:ring-[#1D9BF0] focus:border-transparent",placeholder:"Digite o nome completo",disabled:f})]}),(0,k.jsxs)("div",{children:[(0,k.jsxs)("label",{className:"flex items-center gap-2 text-sm font-medium ".concat(IN.text," mb-2"),children:[(0,k.jsx)(EN,{className:"w-4 h-4"}),"Email/Usu\xe1rio *"]}),(0,k.jsx)("input",{type:"text",value:R.email,onChange:e=>O((0,n.A)((0,n.A)({},R),{},{email:e.target.value})),className:"w-full px-4 py-2 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:ring-2 focus:ring-[#1D9BF0] focus:border-transparent",placeholder:"Digite o email ou nome de usu\xe1rio",disabled:f})]}),(0,k.jsxs)("div",{children:[(0,k.jsxs)("label",{className:"flex items-center gap-2 text-sm font-medium ".concat(IN.text," mb-2"),children:[(0,k.jsx)(AN,{className:"w-4 h-4"}),"Senha ",d?"(deixe vazio para manter a atual)":"*"]}),(0,k.jsxs)("div",{className:"relative",children:[(0,k.jsx)("input",{type:h?"text":"password",value:R.senha,onChange:e=>O((0,n.A)((0,n.A)({},R),{},{senha:e.target.value})),className:"w-full px-4 py-2 pr-10 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:ring-2 focus:ring-[#1D9BF0] focus:border-transparent",placeholder:d?"Nova senha":"Digite a senha",disabled:f}),(0,k.jsx)("button",{type:"button",onClick:()=>m(!h),className:"absolute right-3 top-2 p-1 hover:bg-[#1D9BF0] hover:bg-opacity-10 rounded-full transition-colors",disabled:f,children:h?(0,k.jsx)(gr,{className:"w-5 h-5 text-[#1D9BF0]"}):(0,k.jsx)(pr,{className:"w-5 h-5 text-[#1D9BF0]"})})]})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium ".concat(IN.text," mb-2"),children:"N\xedvel de Acesso *"}),(0,k.jsx)(SN,{nivel:R.nivel,onChange:e=>O((0,n.A)((0,n.A)({},R),{},{nivel:e})),disabled:f,usuarioLogadoNivel:null===r||void 0===r?void 0:r.nivel})]}),R.nivel!==jt.ADMIN&&(0,k.jsxs)("div",{className:"flex items-center p-3 bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-700 rounded-lg",children:[(0,k.jsx)("input",{type:"checkbox",id:"semEmpresaSetor",checked:R.semEmpresaSetor,onChange:e=>{const t=e.target.checked;O((0,n.A)((0,n.A)({},R),{},{semEmpresaSetor:t,empresaId:t?"":R.empresaId,setorId:t?"":R.setorId}))},className:"h-4 w-4 text-yellow-600 focus:ring-yellow-500 border-yellow-400 rounded",disabled:f}),(0,k.jsx)("label",{htmlFor:"semEmpresaSetor",className:"ml-2 text-sm ".concat(IN.text),children:"Registrar sem empresa/setor (n\xe3o recomendado)"})]}),R.nivel!==jt.ADMIN&&!R.semEmpresaSetor&&(0,k.jsxs)(k.Fragment,{children:[(0,k.jsxs)("div",{children:[(0,k.jsxs)("label",{className:"flex items-center gap-2 text-sm font-medium ".concat(IN.text," mb-2"),children:[(0,k.jsx)(Wb,{className:"w-4 h-4"}),"Empresa *"]}),(0,k.jsxs)("select",{value:R.empresaId,onChange:e=>O((0,n.A)((0,n.A)({},R),{},{empresaId:e.target.value,setorId:""})),className:"w-full px-3 py-2 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:ring-2 focus:ring-[#1D9BF0] focus:border-transparent",disabled:f,children:[(0,k.jsx)("option",{value:"",children:"Selecione uma empresa"}),_.map(e=>(0,k.jsx)("option",{value:e.id,children:e.nome},e.id))]})]}),(0,k.jsxs)("div",{children:[(0,k.jsxs)("label",{className:"flex items-center gap-2 text-sm font-medium ".concat(IN.text," mb-2"),children:[(0,k.jsx)(Kb,{className:"w-4 h-4"}),"Setor *"]}),(0,k.jsxs)("select",{value:R.setorId,onChange:e=>O((0,n.A)((0,n.A)({},R),{},{setorId:e.target.value})),className:"w-full px-3 py-2 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:ring-2 focus:ring-[#1D9BF0] focus:border-transparent",disabled:f||!R.empresaId,children:[(0,k.jsx)("option",{value:"",children:"Selecione um setor"}),A.filter(e=>!R.empresaId||e.empresaId===R.empresaId).map(e=>(0,k.jsx)("option",{value:e.id,children:e.nome},e.id))]}),!R.empresaId&&(0,k.jsx)("p",{className:"text-xs ".concat(IN.textSecondary," mt-1"),children:"Selecione uma empresa primeiro"})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium ".concat(IN.text," mb-2"),children:"Cargo/Fun\xe7\xe3o"}),(0,k.jsx)("input",{type:"text",value:R.cargo,onChange:e=>O((0,n.A)((0,n.A)({},R),{},{cargo:e.target.value})),className:"w-full px-3 py-2 bg-gray-50 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg text-gray-900 dark:text-white placeholder-gray-500 dark:placeholder-gray-400 focus:ring-2 focus:ring-[#1D9BF0] focus:border-transparent",placeholder:"Ex: Analista, Supervisor, etc.",disabled:f})]})]}),(0,k.jsxs)("div",{className:"flex items-center",children:[(0,k.jsx)("input",{type:"checkbox",id:"ativo",checked:R.ativo,onChange:e=>O((0,n.A)((0,n.A)({},R),{},{ativo:e.target.checked})),className:"h-4 w-4 text-[#1D9BF0] focus:ring-[#1D9BF0] border-[#1D9BF0] rounded",disabled:f}),(0,k.jsx)("label",{htmlFor:"ativo",className:"ml-2 text-sm ".concat(IN.text),children:"Usu\xe1rio ativo"})]}),p&&(0,k.jsx)("div",{className:"mt-4 p-3 md:p-4 rounded-lg border border-[#F4212E] border-opacity-20 bg-[#F4212E] bg-opacity-10 text-[#F4212E] text-sm",children:p}),y&&(0,k.jsx)("div",{className:"mt-4 p-3 md:p-4 rounded-lg border border-[#00BA7C] border-opacity-20 bg-[#00BA7C] bg-opacity-10 text-[#00BA7C] text-sm",children:y})]})}),(0,k.jsxs)("div",{className:"flex justify-end gap-3 p-4 md:p-6 border-t border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-900 flex-shrink-0",children:[(0,k.jsx)("button",{onClick:V,disabled:f,className:"px-4 md:px-6 py-2 md:py-2.5 bg-white dark:bg-gray-700 border border-gray-300 dark:border-gray-600 ".concat(IN.text," rounded-full hover:bg-gray-100 dark:hover:bg-gray-600 transition-all disabled:opacity-50 font-medium text-sm md:text-base"),children:"Cancelar"}),(0,k.jsx)("button",{onClick:async()=>{x(""),v(""),g(!0);const e=(()=>{if(!R.nome.trim())return"Nome \xe9 obrigat\xf3rio";if(!R.email.trim())return"Email/usu\xe1rio \xe9 obrigat\xf3rio";if(!d&&!R.senha)return"Senha \xe9 obrigat\xf3ria";if(R.senha&&R.senha.length<4)return"Senha deve ter pelo menos 4 caracteres";const e=t.find(e=>e.email===R.email&&(!d||e.id!==d.id));if(e)return"Este email/usu\xe1rio j\xe1 est\xe1 em uso";if(R.nivel!==jt.ADMIN&&!R.semEmpresaSetor){if(!R.empresaId)return'Selecione uma empresa ou marque "Registrar sem empresa/setor"';if(!R.setorId)return'Selecione um setor ou marque "Registrar sem empresa/setor"'}return null})();if(e)return x(e),void g(!1);try{var r;const e={nome:R.nome.trim(),email:R.email.trim(),nivel:R.nivel,ativo:R.ativo};if(!R.semEmpresaSetor&&R.nivel!==jt.ADMIN){e.empresaId=R.empresaId,e.setorId=R.setorId;const t=_.find(e=>e.id===R.empresaId),r=A.find(e=>e.id===R.setorId);t&&(e.empresaNome=t.nome),r&&(e.setorNome=r.nome)}let t;null!==(r=R.cargo)&&void 0!==r&&r.trim()&&(e.cargo=R.cargo.trim()),R.senha&&(e.senha=R.senha),d?(t=await i(d.id,e),v("Usu\xe1rio atualizado com sucesso!")):(t=await a(e),v("Usu\xe1rio criado com sucesso!")),t.success?setTimeout(()=>{V()},1500):x(t.message||"Erro ao salvar usu\xe1rio")}catch(n){x("Erro ao salvar usu\xe1rio: "+n.message)}finally{g(!1)}},disabled:f,className:"px-4 md:px-6 py-2 md:py-2.5 bg-[#1D9BF0] text-white rounded-full hover:bg-[#1A8CD8] transition-all disabled:opacity-50 font-medium text-sm md:text-base shadow-lg",children:f?(0,k.jsxs)("div",{className:"flex items-center gap-2",children:[(0,k.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),(0,k.jsx)("span",{children:"Salvando..."})]}):d?"Atualizar":"Criar"})]})]})}),w&&(0,k.jsx)("div",{className:"fixed inset-0 bg-black/50 dark:bg-black/70 flex items-center justify-center z-50",children:(0,k.jsx)("div",{className:"bg-gray-200 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-xl shadow-sm max-w-md w-full mx-4",children:(0,k.jsxs)("div",{className:"p-6",children:[(0,k.jsx)("div",{className:"flex items-center mb-4",children:(0,k.jsx)("div",{className:"mx-auto flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-[#F4212E] bg-opacity-10",children:(0,k.jsx)(rw,{className:"h-6 w-6 text-[#F4212E]"})})}),(0,k.jsxs)("div",{className:"text-center",children:[(0,k.jsx)("h3",{className:"text-lg font-medium ".concat(IN.text," mb-2"),children:"Confirmar Remo\xe7\xe3o"}),(0,k.jsxs)("p",{className:"text-sm ".concat(IN.textSecondary," mb-4"),children:["Tem certeza que deseja remover o usu\xe1rio ",(0,k.jsx)("strong",{children:w.nome}),"? Esta a\xe7\xe3o n\xe3o pode ser desfeita."]})]}),(0,k.jsxs)("div",{className:"flex justify-center space-x-3",children:[(0,k.jsx)("button",{onClick:()=>N(null),disabled:f,className:"px-4 py-2 bg-black bg-opacity-5 dark:bg-opacity-20 ".concat(IN.text," rounded-full hover:bg-opacity-10 dark:hover:bg-opacity-30 transition-colors disabled:opacity-50"),children:"Cancelar"}),(0,k.jsx)("button",{onClick:async()=>{if(w){g(!0);try{const e=await o(w.id);e.success?(v("Usu\xe1rio removido com sucesso!"),N(null),setTimeout(()=>v(""),3e3)):x(e.message||"Erro ao remover usu\xe1rio")}catch(e){x("Erro ao remover usu\xe1rio: "+e.message)}finally{g(!1)}}},disabled:f,className:"px-4 py-2 bg-[#F4212E] text-white rounded-full hover:bg-opacity-90 transition-colors disabled:opacity-50",children:f?(0,k.jsxs)("div",{className:"flex items-center gap-2",children:[(0,k.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Removendo..."]}):"Remover"})]})]})})})]})},DN=t=>{let{onClose:r,onConfirm:a,emprestimo:n}=t;const[s,i]=(0,e.useState)(!1);return(0,k.jsx)(k.Fragment,{children:(0,k.jsx)("div",{className:"fixed inset-0 bg-black/50 dark:bg-black/70 z-40 flex items-center justify-center",children:(0,k.jsxs)("div",{className:"relative bg-white dark:bg-gray-800 dark:bg-gray-800 rounded-lg shadow-xl max-w-lg w-full p-6 m-4 z-50",children:[(0,k.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,k.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Confirmar Devolu\xe7\xe3o"}),(0,k.jsx)("button",{onClick:r,className:"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300",children:(0,k.jsx)(Id,{className:"w-5 h-5"})})]}),(0,k.jsx)("div",{className:"mb-6",children:(0,k.jsxs)("label",{className:"flex items-start space-x-3",children:[(0,k.jsx)("input",{type:"checkbox",checked:s,onChange:e=>i(e.target.checked),className:"mt-1 h-4 w-4 text-blue-600 border-gray-200 dark:border-gray-600 rounded"}),(0,k.jsxs)("div",{className:"space-y-1",children:[(0,k.jsx)("span",{className:"text-sm font-medium text-gray-900 dark:text-white",children:"Ferramenta devolvida por terceiros"}),(0,k.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Marque esta op\xe7\xe3o se a ferramenta foi devolvida por outra pessoa que n\xe3o o respons\xe1vel pelo empr\xe9stimo."})]})]})}),(0,k.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,k.jsx)("button",{type:"button",onClick:r,className:"px-4 py-2 text-gray-700 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white",children:"Cancelar"}),(0,k.jsx)("button",{type:"button",onClick:()=>{a(s),r()},className:"px-4 py-2 bg-blue-600 text-gray-900 dark:text-white rounded hover:bg-blue-700 transition-colors",children:"Confirmar Devolu\xe7\xe3o"})]})]})})})},PN=t=>{let{emprestimo:r,onClose:a,onConfirm:n}=t;const[s,i]=(0,e.useState)(!1);if(!r||!Array.isArray(r.ferramentas))return console.error("Empr\xe9stimo inv\xe1lido:",r),(0,k.jsxs)("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-xl max-w-lg w-full",children:[(0,k.jsx)("h2",{className:"text-xl font-semibold mb-4 text-red-600",children:"Erro"}),(0,k.jsx)("p",{className:"text-gray-600 dark:text-gray-300 mb-4",children:"N\xe3o foi poss\xedvel carregar os dados do empr\xe9stimo."}),(0,k.jsx)("div",{className:"flex justify-end",children:(0,k.jsx)("button",{onClick:a,className:"px-4 py-2 bg-gray-600 text-gray-900 dark:text-white rounded hover:bg-gray-700 transition-colors",children:"Fechar"})})]});return(0,k.jsxs)("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-xl max-w-lg w-full",children:[(0,k.jsx)("h2",{className:"text-xl font-semibold mb-4 dark:text-white",children:"Devolu\xe7\xe3o de Ferramentas"}),(0,k.jsxs)("form",{onSubmit:e=>{e.preventDefault(),n(r.ferramentas,s)},children:[(0,k.jsxs)("div",{className:"mb-4",children:[(0,k.jsx)("p",{className:"text-gray-600 dark:text-gray-300 mb-2",children:"Ferramenta a ser devolvida:"}),(0,k.jsx)("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:r.ferramentas.map(e=>(0,k.jsx)("div",{className:"flex items-center",children:(0,k.jsxs)("span",{className:"text-gray-700 dark:text-gray-200",children:[e.nome,e.quantidade>1&&(0,k.jsxs)("span",{className:"text-gray-500 dark:text-gray-400 ml-2",children:["(",e.quantidade," unidades)"]})]})},e.id))})]}),(0,k.jsx)("div",{className:"mb-6",children:(0,k.jsxs)("label",{className:"flex items-center space-x-3 cursor-pointer",children:[(0,k.jsx)("input",{type:"checkbox",checked:s,onChange:e=>i(e.target.checked),className:"form-checkbox h-5 w-5 text-blue-600 rounded border-gray-200 dark:border-gray-600 dark:border-gray-600"}),(0,k.jsx)("span",{className:"text-gray-700 dark:text-gray-200",children:"Devolvido por terceiros"})]})}),(0,k.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,k.jsx)("button",{type:"button",onClick:a,className:"px-4 py-2 text-gray-600 dark:text-gray-300 hover:text-gray-800 dark:hover:text-gray-100",children:"Cancelar"}),(0,k.jsx)("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-gray-900 dark:text-white rounded hover:bg-blue-700 transition-colors",children:"Confirmar Devolu\xe7\xe3o"})]})]})]})},FN=t=>{let{emprestimos:r=[],devolverFerramentas:a=()=>{},removerEmprestimo:n=()=>{},atualizarDisponibilidade:i=()=>!0}=t;const[o,l]=(0,e.useState)(""),[c,d]=(0,e.useState)("todos"),[u,h]=(0,e.useState)("todos"),[m,f]=(0,e.useState)({}),[g,p]=(0,e.useState)(!1),[x,y]=(0,e.useState)(!1),[v,b]=(0,e.useState)(null),[w,N]=(0,e.useState)(null),[j,S]=(0,e.useState)(!1),[_,E]=(0,e.useState)(null),[C,I]=(0,e.useState)(!1),[T,D]=(0,e.useState)(null),{usuario:F}=Nt(),L=F&&F.nivel>=jt.SUPERVISOR,M=(r||[]).filter(e=>{if(!e||!e.dataEmprestimo)return!1;if(!((e,t)=>{if(!e)return!1;const r=new Date,a=new Date(e);switch(t){case"hoje":return a.getDate()===r.getDate()&&a.getMonth()===r.getMonth()&&a.getFullYear()===r.getFullYear();case"semana":const e=new Date(r);return e.setDate(r.getDate()-7),a>=e;case"mes":const t=new Date(r);return t.setMonth(r.getMonth()-1),a>=t;default:return!0}})(e.dataEmprestimo,c))return!1;if("todos"!==u&&e.status!==u)return!1;const t=(e.nomeFuncionario||e.colaborador||"").toLowerCase(),r=e.nomeFerramentas||[],a=o.toLowerCase();return t.includes(a)||r.some(e=>e.toLowerCase().includes(a))}).sort((e,t)=>{const r=null!==e&&void 0!==e&&e.dataEmprestimo?new Date(e.dataEmprestimo):new Date;return(null!==t&&void 0!==t&&t.dataEmprestimo?new Date(t.dataEmprestimo):new Date)-r}),R=e=>e&&"object"===typeof e?Array.isArray(e.ferramentas)&&e.ferramentas.length>0:(console.error("Empr\xe9stimo inv\xe1lido:",e),!1);return(0,k.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6",children:[(0,k.jsx)("div",{className:"flex justify-between items-center mb-4",children:(0,k.jsxs)("div",{className:"flex gap-4 items-center",children:[(0,k.jsxs)("div",{className:"relative flex-1 min-w-[350px]",children:[(0,k.jsx)(Ft,{className:"w-4 h-4 absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),(0,k.jsx)("input",{type:"text",placeholder:"       Buscar por colaborador ou ferramenta...",value:o,onChange:e=>l(e.target.value),className:"w-full h-10 pl-10 pr-4 border border-gray-200 dark:border-gray-600 dark:border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#1D9BF0] dark:bg-white dark:bg-gray-700 dark:text-white dark:placeholder-gray-500 text-sm"})]}),(0,k.jsxs)("select",{value:c,onChange:e=>d(e.target.value),className:"border border-gray-200 dark:border-gray-600 dark:border-gray-300 dark:border-gray-600 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-[#1D9BF0] dark:bg-white dark:bg-gray-700 dark:text-white hover:bg-gray-50 dark:hover:bg-gray-700",children:[(0,k.jsx)("option",{value:"todos",children:"Todos os per\xedodos"}),(0,k.jsx)("option",{value:"hoje",children:"Hoje"}),(0,k.jsx)("option",{value:"semana",children:"\xdaltimos 7 dias"}),(0,k.jsx)("option",{value:"mes",children:"\xdaltimo m\xeas"})]}),(0,k.jsxs)("select",{value:u,onChange:e=>h(e.target.value),className:"border border-gray-200 dark:border-gray-600 dark:border-gray-300 dark:border-gray-600 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-[#1D9BF0] dark:bg-white dark:bg-gray-700 dark:text-white hover:bg-gray-50 dark:hover:bg-gray-700",children:[(0,k.jsx)("option",{value:"todos",children:"Todos os status"}),(0,k.jsx)("option",{value:"emprestado",children:"N\xe3o devolvidos"}),(0,k.jsx)("option",{value:"devolvido",children:"Devolvidos"})]})]})}),(0,k.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:M.map(e=>(0,k.jsx)("div",{className:"bg-white dark:bg-gray-700 rounded-lg shadow-md overflow-hidden hover:shadow-lg transition-shadow duration-200",children:(0,k.jsxs)("div",{className:"p-4",children:[(0,k.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,k.jsxs)("div",{children:[(0,k.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-1",children:e.nomeFuncionario||e.colaborador||"-"}),(0,k.jsx)("div",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat("emprestado"===e.status?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"),children:"emprestado"===e.status?(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(xu,{className:"w-3 h-3 inline mr-1"}),"Emprestado"]}):(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(Fd,{className:"w-3 h-3 inline mr-1"}),"Devolvido"]})})]}),(0,k.jsxs)("div",{className:"flex gap-2",children:["emprestado"===e.status&&R(e)&&(0,k.jsx)("button",{onClick:()=>(e=>{if(!e||!Array.isArray(r))return void console.error("ID inv\xe1lido ou empr\xe9stimos n\xe3o \xe9 um array:",{id:e,emprestimos:r});const t=r.find(t=>t.id===e);if(!t)return void console.error("Empr\xe9stimo n\xe3o encontrado com o ID:",e);if(!Array.isArray(t.ferramentas))return void console.error("Empr\xe9stimo sem array de ferramentas v\xe1lido:",t);const a=JSON.parse(JSON.stringify(t));0!==a.ferramentas.length?t.ferramentas.length>1?(N(a),y(!0)):(b(a),p(!0)):console.error("Empr\xe9stimo sem ferramentas para devolver:",a)})(e.id),className:"text-green-600 hover:text-green-800 p-1.5 transition-colors duration-200 rounded-full hover:bg-green-100 dark:hover:bg-green-900",title:"Marcar como devolvido",children:(0,k.jsx)(Fd,{className:"w-5 h-5"})}),(0,k.jsx)("button",{onClick:()=>(e=>{E(e),S(!0)})(e),className:"text-red-600 hover:text-red-800 p-1.5 transition-colors duration-200 rounded-full hover:bg-red-100 dark:hover:bg-red-900",title:"Remover registro",children:(0,k.jsx)(nw,{className:"w-5 h-5"})})]})]}),(0,k.jsxs)("div",{className:"space-y-2 mb-4",children:[(0,k.jsx)("h4",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Ferramentas:"}),(0,k.jsx)("div",{className:"space-y-1",children:Array.isArray(null===e||void 0===e?void 0:e.ferramentas)?e.ferramentas.map((t,r)=>{var a;const n=null===(a=e.ferramentasParcialmenteDevolvidas)||void 0===a?void 0:a.some(e=>e.ferramentas.some(e=>e.id===t.id));return(0,k.jsxs)("div",{className:"flex items-center gap-2 text-sm ".concat(n?"text-gray-400 dark:text-gray-500":"text-gray-700 dark:text-gray-200"),children:[(0,k.jsx)(yu,{className:"w-3 h-3 ".concat(n?"text-gray-400":"")}),(0,k.jsxs)("span",{className:n?"line-through":"",children:[t.nome,t.quantidade>1&&(0,k.jsxs)("span",{className:"text-gray-500 dark:text-gray-400 ml-1",children:["(",t.quantidade," unidades)"]})]})]},r)}):(0,k.jsx)("div",{className:"text-sm text-gray-500",children:"Sem ferramentas"})})]}),(0,k.jsxs)("div",{className:"space-y-2 text-sm mb-4",children:[(0,k.jsxs)("div",{className:"flex justify-between text-gray-600 dark:text-gray-300",children:[(0,k.jsx)("span",{children:"Retirada:"}),(0,k.jsx)("span",{children:wu(e.dataEmprestimo)})]}),(0,k.jsxs)("div",{className:"flex justify-between text-gray-600 dark:text-gray-300",children:[(0,k.jsx)("span",{children:"Devolu\xe7\xe3o:"}),(0,k.jsx)("span",{children:e.dataDevolucao?(0,k.jsxs)("div",{className:"text-right",children:[(0,k.jsx)("div",{children:wu(e.dataDevolucao)}),e.devolvidoPorTerceiros&&(0,k.jsx)("div",{className:"text-xs text-orange-600 mt-1",children:"Devolvido por terceiros"})]}):(0,k.jsx)("span",{className:"text-gray-400",children:"-"})})]})]}),(0,k.jsx)("div",{className:"border-t border-gray-200 dark:border-gray-600 pt-3 mt-2 mb-3",children:(0,k.jsxs)("button",{onClick:()=>(e=>{D(e),I(!0)})(e),className:"w-full flex items-center justify-center gap-2 px-4 py-2.5 bg-purple-600 hover:bg-purple-700 text-white rounded-lg transition-colors duration-200 font-medium text-sm",children:[(0,k.jsx)(A,{className:"w-4 h-4"}),"Ver Comprovante"]})}),(0,k.jsx)("div",{className:"border-t border-gray-200 dark:border-gray-600 pt-3 mt-2",children:(0,k.jsxs)("div",{className:"group min-h-[60px] rounded-md relative ".concat(L?"hover:bg-gray-100 dark:hover:bg-gray-600":""),children:[(0,k.jsx)("div",{className:"flex items-center justify-between mb-1",children:(0,k.jsx)("div",{className:"text-sm font-medium text-gray-500 dark:text-gray-400 flex items-center gap-1",children:(0,k.jsx)("span",{children:"Observa\xe7\xf5es"})})}),(0,k.jsx)("div",{id:"observacoes-".concat(e.id),contentEditable:L,onBlur:async t=>{if(!L)return;let r=t.target.textContent.trim();const a=e.observacoes||"";if(r){if(r!==a)try{const t=(0,s.doc)(P.db,"emprestimos",e.id),n={observacoes:r,historicoObservacoes:(0,s.hq)({data:(new Date).toISOString(),usuario:F.email,observacao:r,observacaoAnterior:a})};await(0,s.updateDoc)(t,n)}catch(n){console.error("Erro ao salvar observa\xe7\xf5es:",n),alert("Erro ao salvar as observa\xe7\xf5es. Por favor, tente novamente."),t.target.textContent=a||"Clique para adicionar observa\xe7\xf5es"}}else t.target.textContent="Clique para adicionar observa\xe7\xf5es"},className:"text-sm p-2 rounded whitespace-pre-wrap transition-colors duration-200 min-h-[40px]\n                      ".concat(L?"cursor-text focus:outline-none focus:bg-white dark:focus:bg-gray-700 focus:ring-1 focus:ring-blue-500":"","\n                      ").concat(e.observacoes?"text-gray-700 dark:text-gray-200":"text-gray-400 dark:text-gray-500 italic","\n                    "),suppressContentEditableWarning:!0,children:e.observacoes||(L?"Clique para adicionar observa\xe7\xf5es":"Nenhuma observa\xe7\xe3o")})]})})]})},e.id))}),g&&v&&(0,k.jsx)("div",{className:"fixed inset-0 bg-black/50 dark:bg-black/70 flex items-center justify-center z-50",children:(0,k.jsx)(DN,{emprestimo:v,onClose:()=>{p(!1),b(null)},onConfirm:async e=>{try{if(!v)return void console.error("Nenhum empr\xe9stimo selecionado");if("function"!==typeof a)return void console.error("devolverFerramentas n\xe3o \xe9 uma fun\xe7\xe3o");console.log("Realizando devolu\xe7\xe3o do empr\xe9stimo",v.id),await a(v.id,i,e),b(null),p(!1)}catch(t){console.error("Erro ao devolver ferramentas:",t)}}})}),x&&w&&Array.isArray(w.ferramentas)&&(0,k.jsx)("div",{className:"fixed inset-0 bg-black/50 dark:bg-black/70 flex items-center justify-center z-50",children:(0,k.jsx)(PN,{emprestimo:w,onClose:()=>{y(!1),N(null)},onConfirm:(e,t)=>{(async(e,t,r)=>{if(e&&Array.isArray(t)&&0!==t.length)if(Array.isArray(e.ferramentas)){console.log("Iniciando devolu\xe7\xe3o parcial:",{emprestimo:e,ferramentasSelecionadas:t,devolvidoPorTerceiros:r});try{const n=e.ferramentas.filter(e=>!t.find(t=>t.id===e.id));if(0===n.length)a(e.id,i,r);else{const s={ferramentas:n,ferramentasParcialmenteDevolvidas:[...e.ferramentasParcialmenteDevolvidas||[],{ferramentas:t,dataDevolucao:(new Date).toISOString(),devolvidoPorTerceiros:r}]};"function"===typeof a&&a(e.id,i,r,s)}}catch(n){console.error("Erro ao fazer devolu\xe7\xe3o parcial:",n)}y(!1),N(null)}else console.error("Empr\xe9stimo sem array de ferramentas v\xe1lido:",e);else console.error("Par\xe2metros inv\xe1lidos:",{emprestimo:e,ferramentasSelecionadas:t})})(w,e,t)}})}),j&&(0,k.jsx)("div",{className:"fixed inset-0 bg-black/50 dark:bg-black/70 flex items-center justify-center z-50",children:(0,k.jsxs)("div",{className:"bg-white dark:bg-gray-700 rounded-lg p-6 max-w-md w-full border border-gray-200 dark:border-gray-600 dark:border-gray-600",children:[(0,k.jsx)("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4",children:"Confirmar Exclus\xe3o"}),(0,k.jsxs)("p",{className:"text-gray-500 dark:text-gray-400 mb-6",children:["Tem certeza que deseja excluir este registro de empr\xe9stimo do hist\xf3rico?",(null===_||void 0===_?void 0:_.nomeFuncionario)&&(0,k.jsxs)("span",{className:"block mt-2",children:["Empr\xe9stimo de: ",(0,k.jsx)("span",{className:"text-white",children:_.nomeFuncionario})]})]}),(0,k.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,k.jsx)("button",{onClick:()=>{S(!1),E(null)},className:"px-4 py-2 text-sm rounded-lg bg-[#38444D] text-gray-900 dark:text-white hover:bg-[#454F59] transition-colors",children:"Cancelar"}),(0,k.jsx)("button",{onClick:()=>{_&&n(_.id,i),S(!1),E(null)},className:"px-4 py-2 text-sm rounded-lg bg-[#F4212E] text-gray-900 dark:text-white hover:bg-[#E01D29] transition-colors",children:"Excluir"})]})]})}),C&&T&&(0,k.jsx)(vb,{emprestimo:T,onClose:()=>{I(!1),D(null)}})]})},LN=(0,e.createContext)(),MN=t=>{let{children:r}=t;const{usuario:a}=Nt(),[i,o]=(0,e.useState)({}),[l,c]=(0,e.useState)(0),[d,u]=(0,e.useState)({}),[h,m]=(0,e.useState)(!0),f=(0,e.useRef)(null),g=(0,e.useRef)({});(0,e.useEffect)(()=>{console.log("MessageNotificationProvider: usu\xe1rio atual:",a)},[a]),(0,e.useEffect)(()=>{f.current=new Audio("/sounds/notification.wav"),f.current.volume=.5},[]);const p=(0,e.useCallback)(()=>{f.current&&h&&(f.current.currentTime=0,f.current.play().catch(e=>{console.log("Erro ao tocar som de notifica\xe7\xe3o:",e)}))},[h]),x=(0,e.useCallback)(()=>{m(e=>!e)},[]),y=(0,e.useCallback)(async(e,t)=>{if(window.Capacitor&&window.Capacitor.Plugins.LocalNotifications)try{const{LocalNotifications:r}=window.Capacitor.Plugins;"granted"===(await r.requestPermissions()).display&&await r.schedule({notifications:[{title:e,body:t,id:Date.now(),sound:"notification.mp3",schedule:{at:new Date(Date.now()+100)},smallIcon:"ic_stat_icon_config_sample",iconColor:"#EF4444"}]})}catch(r){console.error("Erro ao enviar notifica\xe7\xe3o push:",r)}else if("Notification"in window&&"granted"===Notification.permission)try{new Notification(e,{body:t,icon:"/logo.png",badge:"/logo.png",tag:"workflow-message",requireInteraction:!1})}catch(r){console.error("Erro ao criar notifica\xe7\xe3o desktop:",r)}},[]),v=(0,e.useCallback)(e=>{let{remetente:t,conteudo:r,chatId:a,id:n}=e;p(),y("Nova mensagem de ".concat(t.nome),r)},[p,y]),b=(0,e.useCallback)(()=>{console.log("Notifica\xe7\xf5es limpas")},[]);(0,e.useEffect)(()=>{"Notification"in window&&"default"===Notification.permission&&Notification.requestPermission()},[]);const w=(0,e.useCallback)(async e=>{if(null!==a&&void 0!==a&&a.id)try{if(console.log("MessageNotificationContext: Marcando mensagens como lidas para",e),!a||!a.id)return void console.warn("MessageNotificationContext: usu\xe1rio ou usuario.id n\xe3o definido");const t=(0,s.collection)(P.db,"chats"),r=(0,s.P)(t,(0,s._M)("participants","array-contains",a.id)),i=await(0,s.GG)(r);for(const l of i.docs){const t=l.data(),r=t.participants||[];if(l.id===e||"group"!==t.type&&r.includes(e)){console.log("MessageNotificationContext: Chat encontrado:",l.id);const r=(0,s.collection)(P.db,"chats",l.id,"messages"),i=(0,s.P)(r,(0,s._M)("senderId","!=",a.id),(0,s._M)("read","==",!1)),c=await(0,s.GG)(i);console.log("MessageNotificationContext: Marcando",c.size,"mensagens como lidas");const d=c.docs.map(e=>(0,s.updateDoc)((0,s.doc)(P.db,"chats",l.id,"messages",e.id),{read:!0,readAt:(0,s.O5)()}));await Promise.all(d);const u="group"===t.type?l.id:e;o(e=>{const t=(0,n.A)({},e);return delete t[u],t});break}}}catch(t){console.error("Erro ao marcar mensagens como lidas:",t)}},[a]);(0,e.useEffect)(()=>{if(null===a||void 0===a||!a.id)return void console.log("MessageNotificationContext: usu\xe1rio n\xe3o dispon\xedvel");console.log("MessageNotificationContext: iniciando monitor para usu\xe1rio",a.id);const e=[],t=(0,s.collection)(P.db,"chats"),r=(0,s.P)(t,(0,s._M)("participants","array-contains",a.id)),i=(0,s.aQ)(r,t=>{e.forEach(e=>e()),e.length=0,t.docs.forEach(t=>{const r=t.data(),i=r.participants||[],l="group"===r.type?null:i.find(e=>e!==a.id);if(!l&&"group"!==r.type)return;const c=(0,s.collection)(P.db,"chats",t.id,"messages"),d=(0,s.P)(c,(0,s._M)("senderId","!=",a.id),(0,s._M)("read","==",!1)),h=(0,s.aQ)(d,async e=>{const a=e.size,i="group"===r.type?t.id:l;o(e=>{const t=(0,n.A)({},e);return a>0?t[i]=a:delete t[i],t});const c=g.current[i]||0;if(console.log("MessageNotificationContext: Verificando novas mensagens",{chatId:t.id,countKey:i,unreadCount:a,previousCount:c,hasNewMessages:a>c}),a>c&&a>0){console.log("MessageNotificationContext: Nova mensagem detectada!");const t=e.docs[e.docs.length-1];if(t){var d;const e=t.data();console.log("MessageNotificationContext: Dados da mensagem:",e);const a=e.senderId;let o=e.senderName||"Usu\xe1rio";if(!e.senderName&&a)try{const e=await(0,s.x7)((0,s.doc)(P.db,"funcionarios",a));e.exists()&&(o=e.data().nome||"Usu\xe1rio")}catch(h){console.error("Erro ao buscar dados do remetente:",h)}console.log("MessageNotificationContext: Tocando som e enviando notifica\xe7\xe3o..."),p();const l="group"===r.type?"".concat(o," em ").concat(r.name):"Nova mensagem de ".concat(o),c=null!==(d=e.text)&&void 0!==d&&d.substring(0,100)||"audio"===e.type?"\ud83c\udfa4 \xc1udio":"Voc\xea recebeu uma nova mensagem";y(l,c),u(t=>(0,n.A)((0,n.A)({},t),{},{[i]:{conteudo:e.text,remetente:o,timestamp:e.timestamp}}))}}g.current[i]=a});e.push(h)})},e=>{console.error("MessageNotificationContext: Erro no listener de conversas:",e)});return()=>{i(),e.forEach(e=>e())}},[a,p,y]),(0,e.useEffect)(()=>{const e=Object.values(i).reduce((e,t)=>e+t,0);c(e)},[i]);const N={unreadCounts:i,totalUnread:l,lastMessages:d,markMessagesAsRead:w,playNotificationSound:p,sendNotification:v,clearNotifications:b,soundEnabled:h,toggleSound:x};return(0,k.jsx)(LN.Provider,{value:N,children:r})},RN=(0,e.createContext)(),ON=()=>{const t=(0,e.useContext)(RN);if(!t)throw new Error("useNotifications deve ser usado dentro de NotificationProvider");return t},BN=t=>{let{children:r}=t;const{usuario:a}=Nt(),[i,o]=(0,e.useState)([]),[l,c]=(0,e.useState)(0),[d,u]=(0,e.useState)(!0),h=(0,e.useRef)(null),m=(0,e.useRef)(new Set);(0,e.useEffect)(()=>{h.current=new Audio("/sounds/notification.wav"),h.current.volume=.5},[]);const f=(0,e.useCallback)(()=>{h.current&&d&&(h.current.currentTime=0,h.current.play().catch(e=>{console.log("Erro ao tocar som de notifica\xe7\xe3o:",e)}))},[d]),g=(0,e.useCallback)(async(e,t)=>{if(window.Capacitor&&window.Capacitor.Plugins.LocalNotifications)try{const{LocalNotifications:r}=window.Capacitor.Plugins;"granted"===(await r.requestPermissions()).display&&await r.schedule({notifications:[{title:e,body:t,id:Date.now(),sound:"notification.mp3",schedule:{at:new Date(Date.now()+100)},smallIcon:"ic_stat_icon_config_sample",iconColor:"#EF4444"}]})}catch(r){console.error("Erro ao enviar notifica\xe7\xe3o push:",r)}else if("Notification"in window&&"granted"===Notification.permission)try{new Notification(e,{body:t,icon:"/logo.png",badge:"/logo.png",tag:"workflow-notification",requireInteraction:!1})}catch(r){console.error("Erro ao criar notifica\xe7\xe3o desktop:",r)}},[]);(0,e.useEffect)(()=>{"Notification"in window&&"default"===Notification.permission&&Notification.requestPermission()},[]),(0,e.useEffect)(()=>{if(null===a||void 0===a||!a.id)return;console.log("NotificationProvider: Monitorando notifica\xe7\xf5es para",a.id);const e=(0,s.P)((0,s.collection)(P.db,"notificacoes"),(0,s._M)("usuarioId","==",a.id),(0,s.My)("timestamp","desc")),t=(0,s.aQ)(e,e=>{const t=e.docs.map(e=>(0,n.A)({id:e.id},e.data()));o(t),c(t.filter(e=>!e.lida).length),e.docChanges().forEach(e=>{if("added"===e.type){var t;const r=(0,n.A)({id:e.doc.id},e.doc.data());!((null===(t=r.timestamp)||void 0===t?void 0:t.toDate)&&Date.now()-r.timestamp.toDate().getTime()<5e3)||m.current.has(r.id)||r.lida||(console.log("NotificationProvider: Nova notifica\xe7\xe3o detectada!",r),m.current.add(r.id),f(),g(r.titulo,r.mensagem))}})});return()=>t()},[a,f,g]);const p=(0,e.useCallback)(()=>{u(e=>!e)},[]),x={notifications:i,unreadCount:l,markAsRead:async e=>{try{await(0,s.updateDoc)((0,s.doc)(P.db,"notificacoes",e),{lida:!0})}catch(t){console.error("Erro ao marcar notifica\xe7\xe3o como lida:",t)}},markAllAsRead:async()=>{try{const e=i.filter(e=>!e.lida);await Promise.all(e.map(e=>(0,s.updateDoc)((0,s.doc)(P.db,"notificacoes",e.id),{lida:!0})))}catch(e){console.error("Erro ao marcar todas como lidas:",e)}},soundEnabled:d,toggleSound:p,createNotification:async function(e,t,r,a){let n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};try{await(0,s.gS)((0,s.collection)(P.db,"notificacoes"),{usuarioId:e,tipo:t,titulo:r,mensagem:a,lida:!1,timestamp:(0,s.O5)(),dados:n}),console.log("Notifica\xe7\xe3o criada:",{usuarioId:e,tipo:t,titulo:r})}catch(i){console.error("Erro ao criar notifica\xe7\xe3o:",i)}}};return(0,k.jsx)(RN.Provider,{value:x,children:r})},zN=y("pin",[["path",{d:"M12 17v5",key:"bb1du9"}],["path",{d:"M9 10.76a2 2 0 0 1-1.11 1.79l-1.78.9A2 2 0 0 0 5 15.24V16a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-.76a2 2 0 0 0-1.11-1.79l-1.78-.9A2 2 0 0 1 15 10.76V7a1 1 0 0 1 1-1 2 2 0 0 0 0-4H8a2 2 0 0 0 0 4 1 1 0 0 1 1 1z",key:"1nkz8b"}]]),UN=y("archive",[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]]),VN=t=>{let{onSelectConversa:r,conversaSelecionada:a,onNovaConversa:n,onOpenNotificationSettings:s,conversas:i=[],loading:o=!1,formatarTimestamp:l=()=>""}=t;const[c,d]=(0,e.useState)(""),[u,h]=(0,e.useState)("todas");(0,e.useEffect)(()=>{console.log("***********************************************"),console.log("ListaConversas - Props conversas MUDARAM"),console.log("Quantidade recebida:",i.length),console.log("IDs:",i.map(e=>e.id)),console.log("Loading:",o),console.trace("Stack trace"),console.log("***********************************************")},[i,o]);const m=i.filter(e=>{var t,r,a;const n=""===c||(null===(t=e.nome)||void 0===t?void 0:t.toLowerCase().includes(c.toLowerCase()))||(null===(r=e.ultimaMensagem)||void 0===r||null===(a=r.texto)||void 0===a?void 0:a.toLowerCase().includes(c.toLowerCase()));return"nao-lidas"===u?n&&e.naoLidas>0:"arquivadas"===u?n&&e.arquivado:n});return o?(0,k.jsx)("div",{className:"h-full flex items-center justify-center",children:(0,k.jsxs)("div",{className:"text-center",children:[(0,k.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto mb-4"}),(0,k.jsx)("p",{className:"text-gray-500 dark:text-gray-400",children:"Carregando conversas..."}),(0,k.jsx)("p",{className:"text-xs text-gray-400 dark:text-gray-500 mt-2",children:"Se demorar muito, abra o console (F12) para ver os logs"})]})}):(console.log("\ud83d\udcca ListaConversas - Status:",{loading:o,totalConversas:i.length,conversasFiltradas:m.length,filtro:u,busca:c}),(0,k.jsxs)("div",{className:"h-full flex flex-col bg-white dark:bg-gray-800",children:[(0,k.jsxs)("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:[(0,k.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,k.jsx)("h1",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:"Mensagens"}),(0,k.jsxs)("div",{className:"flex gap-2",children:[(0,k.jsx)("button",{onClick:s,className:"p-2.5 bg-gray-200 hover:bg-gray-300 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-300 rounded-full transition-all transform hover:scale-110",title:"Configura\xe7\xf5es de notifica\xe7\xf5es",children:(0,k.jsx)(Od,{className:"w-5 h-5"})}),(0,k.jsx)("button",{onClick:n,className:"p-2.5 bg-blue-500 hover:bg-blue-600 text-white rounded-full transition-all transform hover:scale-110 shadow-lg",title:"Nova conversa",children:(0,k.jsx)(D,{className:"w-5 h-5"})})]})]}),(0,k.jsxs)("div",{className:"relative",children:[(0,k.jsx)(Ft,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),(0,k.jsx)("input",{type:"text",value:c,onChange:e=>d(e.target.value),placeholder:"Buscar conversas...",className:"w-full pl-10 pr-4 py-2 bg-gray-100 dark:bg-gray-700 rounded-full border-none outline-none focus:ring-2 focus:ring-blue-500 text-gray-900 dark:text-gray-100 placeholder-gray-500"})]}),(0,k.jsx)("div",{className:"flex gap-2 mt-3",children:["todas","nao-lidas","arquivadas"].map(e=>(0,k.jsx)("button",{onClick:()=>h(e),className:"px-3 py-1 rounded-full text-sm transition-colors ".concat(u===e?"bg-blue-500 text-white":"bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-600"),children:"todas"===e?"Todas":"nao-lidas"===e?"N\xe3o lidas":"Arquivadas"},e))})]}),(0,k.jsx)("div",{className:"flex-1 overflow-y-auto",children:0===m.length?(0,k.jsxs)("div",{className:"text-center py-12 px-4",children:[(0,k.jsx)("div",{className:"text-gray-500 dark:text-gray-400 mb-3",children:c?"Nenhuma conversa encontrada":"Nenhuma conversa ainda"}),!c&&(0,k.jsxs)(k.Fragment,{children:[(0,k.jsxs)("p",{className:"text-sm text-gray-400 dark:text-gray-500 mb-4",children:["Clique no bot\xe3o ",(0,k.jsx)("span",{className:"text-blue-500 font-semibold",children:"+"})," para iniciar uma conversa"]}),(0,k.jsx)("p",{className:"text-xs text-gray-400 dark:text-gray-500",children:"\ud83d\udca1 Dica: Abra o console (F12) para ver logs de debug"})]})]}):m.map(e=>{var t,n,s;const i=e.naoLidas||0,o=(null===a||void 0===a?void 0:a.id)===e.id;return(0,k.jsxs)("div",{onClick:()=>r(e),className:"flex items-center gap-3 p-4 cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors border-b border-gray-100 dark:border-gray-700 ".concat(o?"bg-blue-50 dark:bg-blue-900/20":""),children:[(0,k.jsxs)("div",{className:"relative flex-shrink-0",children:[(0,k.jsx)("div",{className:"w-12 h-12 rounded-full bg-gradient-to-br from-blue-400 to-blue-600 flex items-center justify-center text-white font-bold text-lg overflow-hidden",children:e.photoURL?(0,k.jsx)("img",{src:e.photoURL,alt:e.nome||"Usu\xe1rio",className:"w-full h-full object-cover",onError:t=>{var r;t.target.style.display="none",t.target.parentElement.textContent=(null===(r=e.nome)||void 0===r?void 0:r.charAt(0).toUpperCase())||"?"}}):(null===(t=e.nome)||void 0===t?void 0:t.charAt(0).toUpperCase())||"?"}),i>0&&(0,k.jsx)("div",{className:"absolute -top-1 -right-1 w-5 h-5 bg-red-500 rounded-full flex items-center justify-center text-white text-xs font-bold",children:i>9?"9+":i})]}),(0,k.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,k.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,k.jsx)("h3",{className:"font-semibold truncate ".concat(i>0?"text-gray-900 dark:text-gray-100":"text-gray-700 dark:text-gray-300"),children:e.nome||"Conversa"}),(0,k.jsx)("span",{className:"text-xs text-gray-500 dark:text-gray-400 flex-shrink-0 ml-2",children:l(null===(n=e.ultimaMensagem)||void 0===n?void 0:n.timestamp)})]}),(0,k.jsx)("p",{className:"text-sm truncate ".concat(i>0?"text-gray-900 dark:text-gray-100 font-medium":"text-gray-500 dark:text-gray-400"),children:(null===(s=e.ultimaMensagem)||void 0===s?void 0:s.texto)||"Sem mensagens"})]}),(0,k.jsxs)("div",{className:"flex flex-col items-end gap-1",children:[e.fixado&&(0,k.jsx)(zN,{className:"w-4 h-4 text-gray-400"}),e.arquivado&&(0,k.jsx)(UN,{className:"w-4 h-4 text-gray-400"})]})]},e.id)})})]}))},qN=y("check-check",[["path",{d:"M18 6 7 17l-5-5",key:"116fxf"}],["path",{d:"m22 10-7.5 7.5L13 16",key:"ke71qq"}]]),HN=y("file",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]]),GN=y("mic",[["path",{d:"M12 19v3",key:"npa21l"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["rect",{x:"9",y:"2",width:"6",height:"13",rx:"3",key:"s6n7sd"}]]),WN={ENVIANDO:"enviando",ENVIADA:"enviada",ENTREGUE:"entregue",LIDA:"lida",ERRO:"erro"},KN={TEXTO:"texto",IMAGEM:"imagem",ARQUIVO:"arquivo",AUDIO:"audio",VIDEO:"video",LOCALIZACAO:"localizacao",SISTEMA:"sistema"},QN={ONLINE:"online",OFFLINE:"offline",AUSENTE:"ausente",NAO_PERTURBE:"nao_perturbe"},YN={PRIVADA:"privada",GRUPO:"grupo"},XN={MAX_MESSAGE_LENGTH:5e3,MAX_FILE_SIZE:16777216,MAX_IMAGE_SIZE:5242880,MAX_VIDEO_SIZE:16777216,MAX_AUDIO_DURATION:300,MESSAGES_PER_PAGE:50,TYPING_TIMEOUT:3e3},JN={BLOCKED_USER:"blocked_user",CONVERSATION_NOT_FOUND:"conversation_not_found",PERMISSION_DENIED:"permission_denied",FILE_TOO_LARGE:"file_too_large",INVALID_FILE_TYPE:"invalid_file_type",NETWORK_ERROR:"network_error",UNKNOWN_ERROR:"unknown_error"},ZN=e=>{let{isOpen:t,onClose:r,onDeleteForMe:a,onDeleteForEveryone:n,canDeleteForEveryone:s=!1,isOwnMessage:i=!1,messagePreview:o=""}=e;return t?(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)("div",{className:"fixed inset-0 bg-black/50 z-50 animate-fadeIn",onClick:r}),(0,k.jsx)("div",{className:"fixed bottom-0 left-0 right-0 z-50 animate-slideUp",children:(0,k.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-t-3xl shadow-2xl",children:[(0,k.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700",children:[(0,k.jsxs)("div",{className:"flex-1",children:[(0,k.jsx)("h3",{className:"font-semibold text-gray-900 dark:text-gray-100",children:"Apagar mensagem"}),o&&(0,k.jsxs)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1 truncate",children:['"',o,'"']})]}),(0,k.jsx)("button",{onClick:r,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-full transition-colors","aria-label":"Fechar",children:(0,k.jsx)(Id,{className:"w-5 h-5 text-gray-500"})})]}),(0,k.jsxs)("div",{className:"p-2",children:[(0,k.jsxs)("button",{onClick:()=>{a(),r()},className:"w-full flex items-center gap-3 p-4 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-xl transition-colors text-left",children:[(0,k.jsx)("div",{className:"w-10 h-10 bg-gray-100 dark:bg-gray-700 rounded-full flex items-center justify-center flex-shrink-0",children:(0,k.jsx)(nw,{className:"w-5 h-5 text-gray-600 dark:text-gray-400"})}),(0,k.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,k.jsx)("p",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Apagar para mim"}),(0,k.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Voc\xea n\xe3o ver\xe1 mais esta mensagem"})]})]}),i&&(0,k.jsx)(k.Fragment,{children:s?(0,k.jsxs)("button",{onClick:()=>{n(),r()},className:"w-full flex items-center gap-3 p-4 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-xl transition-colors text-left",children:[(0,k.jsx)("div",{className:"w-10 h-10 bg-red-100 dark:bg-red-900/30 rounded-full flex items-center justify-center flex-shrink-0",children:(0,k.jsx)(nw,{className:"w-5 h-5 text-red-600 dark:text-red-400"})}),(0,k.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,k.jsx)("p",{className:"font-medium text-red-600 dark:text-red-400",children:"Apagar para todos"}),(0,k.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Todos os participantes n\xe3o ver\xe3o esta mensagem"})]})]}):(0,k.jsxs)("div",{className:"flex items-start gap-3 p-4 bg-gray-50 dark:bg-gray-700/50 rounded-xl",children:[(0,k.jsx)("div",{className:"w-10 h-10 bg-gray-200 dark:bg-gray-600 rounded-full flex items-center justify-center flex-shrink-0",children:(0,k.jsx)(xu,{className:"w-5 h-5 text-gray-400"})}),(0,k.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,k.jsx)("p",{className:"font-medium text-gray-600 dark:text-gray-400 text-sm",children:"Tempo limite excedido"}),(0,k.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"Mensagens s\xf3 podem ser apagadas para todos em at\xe9 30 minutos ap\xf3s o envio"})]})]})})]}),(0,k.jsx)("div",{className:"p-4 pt-2",children:(0,k.jsx)("button",{onClick:r,className:"w-full py-3 text-center font-medium text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-100 transition-colors",children:"Cancelar"})})]})}),(0,k.jsx)("style",{jsx:!0,children:"\n        @keyframes fadeIn {\n          from { opacity: 0; }\n          to { opacity: 1; }\n        }\n        \n        @keyframes slideUp {\n          from { transform: translateY(100%); }\n          to { transform: translateY(0); }\n        }\n        \n        .animate-fadeIn {\n          animation: fadeIn 0.2s ease-out;\n        }\n        \n        .animate-slideUp {\n          animation: slideUp 0.3s cubic-bezier(0.16, 1, 0.3, 1);\n        }\n      "})]}):null},$N=t=>{var r,a,n,s,i;let{mensagem:o,isPropriaMsg:l,showAvatar:c=!0,groupWithPrevious:d=!1,onEdit:u,onDelete:h,onDeleteForMe:m,onDeleteForEveryone:f,onDownload:g}=t;const[p,x]=(0,e.useState)(!1),[y,v]=(0,e.useState)(!1),[b,N]=(0,e.useState)(!1),[j,S]=(0,e.useState)(null),[_,E]=(0,e.useState)(!1),[A,C]=(0,e.useState)(!1),[I,T]=(0,e.useState)(!1);(0,e.useEffect)(()=>{const e=()=>{T(window.innerWidth<768)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]);const D=()=>{if(!l||!o.timestamp)return!1;return Date.now()-(o.timestamp.toDate?o.timestamp.toDate().getTime():new Date(o.timestamp).getTime())<18e5},P=()=>{if(o.deletada)return(0,k.jsxs)("div",{className:"italic text-gray-500 dark:text-gray-400 flex items-center gap-2",children:[(0,k.jsx)(nw,{className:"w-4 h-4"}),(0,k.jsx)("span",{children:"Mensagem deletada"})]});switch(o.tipo){case KN.IMAGEM:return(0,k.jsxs)("div",{className:"space-y-1.5 sm:space-y-2",children:[(0,k.jsxs)("div",{className:"relative rounded-lg overflow-hidden max-w-[250px] sm:max-w-xs md:max-w-sm",children:[!b&&(0,k.jsx)("div",{className:"absolute inset-0 bg-gray-200 dark:bg-gray-700 animate-pulse"}),(0,k.jsx)("img",{src:o.anexoUrl,alt:o.texto,className:"w-full h-auto rounded-lg cursor-pointer hover:opacity-90 transition-opacity active:opacity-75",onClick:()=>window.open(o.anexoUrl,"_blank"),onLoad:()=>N(!0),loading:"lazy"})]}),o.texto&&(0,k.jsx)("p",{className:"text-xs sm:text-sm",children:o.texto})]});case KN.ARQUIVO:return(0,k.jsxs)("div",{className:"flex items-center gap-2 sm:gap-3 p-2.5 sm:p-3 bg-gray-100 dark:bg-gray-700 rounded-lg cursor-pointer hover:bg-gray-200 dark:hover:bg-gray-600 active:bg-gray-300 dark:active:bg-gray-500 transition-colors",onClick:()=>null===g||void 0===g?void 0:g(o.anexoUrl,o.texto),children:[(0,k.jsx)("div",{className:"w-9 h-9 sm:w-10 sm:h-10 bg-blue-100 dark:bg-blue-900/30 rounded-lg flex items-center justify-center flex-shrink-0",children:(0,k.jsx)(HN,{className:"w-4 h-4 sm:w-5 sm:h-5 text-blue-600 dark:text-blue-400"})}),(0,k.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,k.jsx)("p",{className:"text-xs sm:text-sm font-medium truncate",children:o.texto}),(0,k.jsx)("p",{className:"text-[10px] sm:text-xs text-gray-500 dark:text-gray-400",children:"Clique para baixar"})]}),(0,k.jsx)(Gd,{className:"w-4 h-4 sm:w-5 sm:h-5 text-gray-400 flex-shrink-0"})]});case KN.VIDEO:return(0,k.jsxs)("div",{className:"space-y-1.5 sm:space-y-2",children:[(0,k.jsx)("div",{className:"relative rounded-lg overflow-hidden max-w-[250px] sm:max-w-xs md:max-w-sm",children:(0,k.jsx)("video",{src:o.anexoUrl,controls:!0,className:"w-full h-auto rounded-lg",preload:"metadata"})}),o.texto&&(0,k.jsx)("p",{className:"text-xs sm:text-sm",children:o.texto})]});case KN.AUDIO:return(0,k.jsxs)("div",{className:"flex items-center gap-2 sm:gap-3",children:[(0,k.jsx)("div",{className:"w-7 h-7 sm:w-8 sm:h-8 bg-green-100 dark:bg-green-900/30 rounded-full flex items-center justify-center flex-shrink-0",children:(0,k.jsx)(GN,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4 text-green-600 dark:text-green-400"})}),(0,k.jsx)("audio",{src:o.anexoUrl,controls:!0,className:"flex-1 h-8 sm:h-10",preload:"metadata"})]});case KN.SISTEMA:return(0,k.jsx)("div",{className:"text-center text-[10px] sm:text-xs text-gray-500 dark:text-gray-400 py-1.5 sm:py-2 px-2",children:o.texto});default:return(0,k.jsx)("div",{className:"whitespace-pre-wrap break-words",children:o.texto})}};return o.tipo===KN.SISTEMA?(0,k.jsx)("div",{className:"flex justify-center py-1.5 sm:py-2 px-2",children:(0,k.jsx)("div",{className:"bg-gray-100 dark:bg-gray-800 rounded-lg px-3 sm:px-4 py-1.5 sm:py-2 max-w-[90%] sm:max-w-md",children:P()})}):(0,k.jsxs)("div",{className:"flex gap-1.5 sm:gap-2 ".concat(l?"flex-row-reverse":"flex-row"," ").concat(d?"mt-0.5 sm:mt-1":"mt-2 sm:mt-3 md:mt-4"," ").concat(_?"scale-95 transition-transform":""),onMouseEnter:()=>x(!0),onMouseLeave:()=>x(!1),children:[c&&!d&&(0,k.jsx)("div",{className:"w-7 h-7 sm:w-8 sm:h-8 rounded-full bg-gradient-to-br from-blue-400 to-blue-600 flex items-center justify-center text-white text-xs sm:text-sm font-bold flex-shrink-0 overflow-hidden",children:null!==(r=o.remetente)&&void 0!==r&&r.photoURL?(0,k.jsx)("img",{src:o.remetente.photoURL,alt:(null===(a=o.remetente)||void 0===a?void 0:a.nome)||"Usu\xe1rio",className:"w-full h-full object-cover",onError:e=>{var t,r;e.target.style.display="none",e.target.parentElement.textContent=(null===(t=o.remetente)||void 0===t||null===(r=t.nome)||void 0===r?void 0:r.charAt(0).toUpperCase())||"?"}}):(null===(n=o.remetente)||void 0===n||null===(s=n.nome)||void 0===s?void 0:s.charAt(0).toUpperCase())||"?"}),!c&&!d&&(0,k.jsx)("div",{className:"w-7 sm:w-8"}),(0,k.jsxs)("div",{className:"relative max-w-[85%] sm:max-w-[75%] md:max-w-[70%] lg:max-w-[65%] ".concat(l?"items-end":"items-start"),children:[p&&!o.deletada&&(0,k.jsxs)("div",{className:"absolute top-0 ".concat(l?"left-0 -translate-x-full":"right-0 translate-x-full"," flex gap-0.5 sm:gap-1 bg-white dark:bg-gray-800 rounded-lg shadow-lg p-0.5 sm:p-1 z-10"),children:[l&&u&&o.tipo===KN.TEXTO&&(0,k.jsx)("button",{onClick:()=>u(o),className:"p-1.5 sm:p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded transition-colors active:scale-95",title:"Editar","aria-label":"Editar mensagem",children:(0,k.jsx)(Nk,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4 text-gray-600 dark:text-gray-400"})}),(m||f||h)&&(0,k.jsxs)("div",{className:"relative",children:[(0,k.jsx)("button",{onClick:()=>v(!y),className:"p-1.5 sm:p-2 hover:bg-red-100 dark:hover:bg-red-900/30 rounded transition-colors active:scale-95",title:"Apagar","aria-label":"Apagar mensagem",children:(0,k.jsx)(nw,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4 text-red-600 dark:text-red-400"})}),y&&(0,k.jsxs)("div",{className:"absolute top-full mt-1 right-0 bg-white dark:bg-gray-800 rounded-lg shadow-xl border border-gray-200 dark:border-gray-700 py-1 min-w-[160px] sm:min-w-[180px] z-20",onMouseLeave:()=>v(!1),onTouchEnd:e=>e.stopPropagation(),children:[m&&(0,k.jsxs)("button",{onClick:()=>{m(o),v(!1)},className:"w-full px-3 sm:px-4 py-2 text-left text-xs sm:text-sm hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors flex items-center gap-2 text-gray-700 dark:text-gray-300 active:scale-95",children:[(0,k.jsx)(nw,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4 flex-shrink-0"}),(0,k.jsx)("span",{children:"Apagar para mim"})]}),l&&f&&D()&&(0,k.jsxs)("button",{onClick:()=>{f(o),v(!1)},className:"w-full px-3 sm:px-4 py-2 text-left text-xs sm:text-sm hover:bg-red-100 dark:hover:bg-red-900/30 transition-colors flex items-center gap-2 text-red-600 dark:text-red-400 active:scale-95",children:[(0,k.jsx)(nw,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4 flex-shrink-0"}),(0,k.jsx)("span",{children:"Apagar para todos"})]}),l&&f&&!D()&&(0,k.jsx)("div",{className:"px-3 sm:px-4 py-2 text-xs text-gray-500 dark:text-gray-400 italic border-t border-gray-200 dark:border-gray-700",children:"Mensagens s\xf3 podem ser apagadas para todos em at\xe9 30 minutos"}),!m&&!f&&h&&(0,k.jsxs)("button",{onClick:()=>{h(o),v(!1)},className:"w-full px-3 sm:px-4 py-2 text-left text-xs sm:text-sm hover:bg-red-100 dark:hover:bg-red-900/30 transition-colors flex items-center gap-2 text-red-600 dark:text-red-400 active:scale-95",children:[(0,k.jsx)(nw,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4 flex-shrink-0"}),(0,k.jsx)("span",{children:"Deletar"})]})]})]})]}),(0,k.jsxs)("div",{className:"rounded-xl sm:rounded-2xl px-3 sm:px-4 py-2 shadow-sm text-sm sm:text-base ".concat(l?"bg-blue-500 text-white rounded-br-none":"bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 border border-gray-200 dark:border-gray-700 rounded-bl-none"," ").concat(d?"rounded-tl-xl sm:rounded-tl-2xl rounded-tr-xl sm:rounded-tr-2xl":""),onTouchStart:e=>{if(!I||o.deletada)return;E(!0);const t=setTimeout(()=>{C(!0),E(!1),navigator.vibrate&&navigator.vibrate(50)},500);S(t)},onTouchEnd:()=>{j&&(clearTimeout(j),S(null)),E(!1)},onTouchMove:()=>{j&&(clearTimeout(j),S(null)),E(!1)},children:[(null===(i=o.remetente)||void 0===i?void 0:i.nome)&&!d&&(0,k.jsx)("p",{className:"text-xs font-semibold mb-1 truncate ".concat(l?"text-blue-100":"text-blue-600 dark:text-blue-400"),children:o.remetente.nome}),P(),(0,k.jsxs)("div",{className:"flex items-center justify-end gap-1 mt-1 text-[10px] sm:text-xs ".concat(l?"text-white/70":"text-gray-500 dark:text-gray-400"),children:[o.editada&&(0,k.jsx)("span",{className:"italic",children:"editada"}),(0,k.jsx)("span",{className:"whitespace-nowrap",children:(()=>{if(!o.timestamp)return"";return(o.timestamp.toDate?o.timestamp.toDate():new Date(o.timestamp)).toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"})})()}),(()=>{if(!l)return null;switch(o.status){case WN.ENVIANDO:return(0,k.jsx)(xu,{className:"w-4 h-4 text-gray-400 animate-spin"});case WN.ENVIADA:return(0,k.jsx)(lk,{className:"w-4 h-4 text-gray-400"});case WN.ENTREGUE:return(0,k.jsx)(qN,{className:"w-4 h-4 text-gray-400"});case WN.LIDA:return(0,k.jsx)(qN,{className:"w-4 h-4 text-blue-500"});case WN.ERRO:return(0,k.jsx)(w,{className:"w-4 h-4 text-red-500"});default:return null}})()]})]})]}),(0,k.jsx)(ZN,{isOpen:A,onClose:()=>C(!1),onDeleteForMe:()=>null===m||void 0===m?void 0:m(o),onDeleteForEveryone:()=>null===f||void 0===f?void 0:f(o),canDeleteForEveryone:D(),isOwnMessage:l,messagePreview:(()=>{var e,t;return o.tipo===KN.TEXTO?(null===(e=o.texto)||void 0===e?void 0:e.substring(0,50))+((null===(t=o.texto)||void 0===t?void 0:t.length)>50?"...":""):o.tipo===KN.IMAGEM?"\ud83d\udcf7 Imagem":o.tipo===KN.VIDEO?"\ud83c\udfa5 V\xeddeo":o.tipo===KN.AUDIO?"\ud83c\udfb5 \xc1udio":o.tipo===KN.ARQUIVO?"\ud83d\udcce Arquivo":""})()})]})},ej=y("image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]),tj=y("smile",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 14s1.5 2 4 2 4-2 4-2",key:"1y1vjs"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]]),rj=y("send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]),aj=t=>{let{onEnviar:r}=t;const[a,n]=(0,e.useState)(""),[s,i]=(0,e.useState)(!1),[o,l]=(0,e.useState)(!1),c=(0,e.useRef)(null),d=async e=>{e.preventDefault(),a.trim()&&!s&&(i(!0),await r(a,"texto"),n(""),i(!1))};return(0,k.jsxs)("form",{onSubmit:d,className:"bg-white dark:bg-gray-800 border-t border-gray-200 dark:border-gray-700 p-2 sm:p-3 md:p-4 flex-shrink-0",children:[(0,k.jsxs)("div",{className:"flex items-end gap-1.5 sm:gap-2",children:[(0,k.jsxs)("div",{className:"flex gap-0.5 sm:gap-1",children:[(0,k.jsx)("input",{type:"file",ref:c,accept:"image/*",onChange:async e=>{var t;const a=null===(t=e.target.files)||void 0===t?void 0:t[0];if(a)if(a.type.startsWith("image/"))if(a.size>10485760)alert("A imagem deve ter no m\xe1ximo 10MB");else{l(!0);try{const e=Date.now(),t="mensagens/".concat(e,"_").concat(a.name),n=(0,xt.KR)(P.storage,t);await(0,xt.D)(n,a);const s=await(0,xt.qk)(n);await r(s,"imagem",{nomeArquivo:a.name,tamanho:a.size})}catch(n){console.error("Erro ao enviar imagem:",n),alert("Erro ao enviar imagem. Tente novamente.")}finally{l(!1),c.current&&(c.current.value="")}}else alert("Por favor, selecione apenas imagens")},className:"hidden"}),(0,k.jsx)("button",{type:"button",onClick:()=>{var e;return null===(e=c.current)||void 0===e?void 0:e.click()},disabled:o,className:"p-1.5 sm:p-2 text-gray-500 hover:text-blue-500 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-full transition-colors disabled:opacity-50 disabled:cursor-not-allowed active:scale-95",title:"Enviar imagem","aria-label":"Enviar imagem",children:o?(0,k.jsx)("div",{className:"w-4 h-4 sm:w-5 sm:h-5 border-2 border-blue-500 border-t-transparent rounded-full animate-spin"}):(0,k.jsx)(ej,{className:"w-4 h-4 sm:w-5 sm:h-5"})}),(0,k.jsx)("button",{type:"button",className:"p-1.5 sm:p-2 text-gray-500 hover:text-blue-500 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-full transition-colors hidden sm:flex active:scale-95",title:"Emoji (em breve)","aria-label":"Emoji",disabled:!0,children:(0,k.jsx)(tj,{className:"w-4 h-4 sm:w-5 sm:h-5"})})]}),(0,k.jsx)("div",{className:"flex-1 relative",children:(0,k.jsx)("textarea",{value:a,onChange:e=>n(e.target.value),onKeyPress:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),d(e))},placeholder:"Digite uma mensagem...",disabled:s||o,rows:1,className:"w-full px-3 sm:px-4 py-2 text-sm sm:text-base bg-gray-100 dark:bg-gray-700 text-gray-900 dark:text-white border border-gray-300 dark:border-gray-600 rounded-full focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none disabled:opacity-50 disabled:cursor-not-allowed",style:{minHeight:"36px",maxHeight:"100px"},onInput:e=>{e.target.style.height="auto",e.target.style.height=Math.min(e.target.scrollHeight,100)+"px"}})}),(0,k.jsx)("button",{type:"submit",disabled:!a.trim()||s||o,className:"p-2 sm:p-2.5 md:p-3 bg-blue-500 text-white rounded-full hover:bg-blue-600 active:scale-95 transition-all disabled:opacity-50 disabled:cursor-not-allowed flex-shrink-0",title:"Enviar mensagem","aria-label":"Enviar mensagem",children:s?(0,k.jsx)("div",{className:"w-4 h-4 sm:w-5 sm:h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}):(0,k.jsx)(rj,{className:"w-4 h-4 sm:w-5 sm:h-5"})})]}),(0,k.jsx)("p",{className:"hidden sm:block text-xs text-gray-500 dark:text-gray-400 mt-2 text-center",children:"Pressione Enter para enviar \u2022 Shift + Enter para nova linha"})]})},nj=t=>{var r;let{conversa:a,onBack:n,mensagens:s=[],enviando:i,enviarMensagem:o,enviarArquivo:l,deletarMensagem:c,apagarParaMim:d,apagarParaTodos:u,editarMensagem:h,carregarMensagensAntigas:m,atualizarDigitacao:f,verificarBloqueio:g,getOutroParticipante:p,buscarInfoParticipante:x}=t;const[y,v]=(0,e.useState)(!1),[b,w]=(0,e.useState)(!1),[N,j]=(0,e.useState)(!1),[S,_]=(0,e.useState)([]),[E,A]=(0,e.useState)(""),C=(0,e.useRef)(null),I=(0,e.useRef)(null),T=(0,e.useRef)([]);(0,e.useEffect)(()=>{console.log("\ud83e\ude9f JanelaChat - Mensagens recebidas via props:",(null===s||void 0===s?void 0:s.length)||0),console.log("\ud83c\udd94 IDs das mensagens:",(null===s||void 0===s?void 0:s.map(e=>e.id))||[]),console.log("\ud83d\udce6 Array completo de mensagens:",s),s&&s.length>0?(console.log("\u2705 Atualizando mensagensLocal com",s.length,"mensagens"),_(s),T.current=s):s&&0===s.length&&T.current.length>0?console.log("\u26a0\ufe0f Props com array vazio mas ref tem mensagens! Mantendo as do ref"):console.log("\ud83d\udced Sem mensagens ainda"),F()},[s]),(0,e.useEffect)(()=>{D(),P()},[a]);const D=async()=>{if(a){const e=await g(a.id);w(e)}},P=async()=>{if(a&&"grupo"!==a.tipo){const e=p(a);if(e&&x){const t=await x(e);t&&A(t.nome||t.email||"Usuario")}}},F=()=>{var e;null===(e=C.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})},L=async()=>{j(!0);try{await m()}finally{j(!1)}},M=(e,t)=>{const r=document.createElement("a");r.href=e,r.download=t||"arquivo",r.click()};p(a);return(0,k.jsxs)("div",{className:"flex flex-col h-full bg-gray-50 dark:bg-gray-900",children:[(0,k.jsxs)("div",{className:"bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 p-3 sm:p-4 flex items-center gap-2 sm:gap-3 sticky top-0 z-10",children:[(0,k.jsx)("button",{onClick:n,className:"lg:hidden p-1.5 sm:p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-full transition-colors active:scale-95","aria-label":"Voltar",children:"\u2190"}),(0,k.jsx)("div",{className:"w-9 h-9 sm:w-10 sm:h-10 md:w-11 md:h-11 rounded-full bg-gradient-to-br from-blue-400 to-blue-600 flex items-center justify-center text-white font-bold overflow-hidden flex-shrink-0",children:a.photoURL?(0,k.jsx)("img",{src:a.photoURL,alt:a.nome||E||"Usu\xe1rio",className:"w-full h-full object-cover",onError:e=>{var t;e.target.style.display="none",e.target.parentElement.textContent=(null===(t=a.nome||E)||void 0===t?void 0:t.charAt(0).toUpperCase())||"?"}}):(null===(r=a.nome||E)||void 0===r?void 0:r.charAt(0).toUpperCase())||"?"}),(0,k.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,k.jsx)("h2",{className:"font-semibold text-sm sm:text-base md:text-lg text-gray-900 dark:text-gray-100 truncate",children:a.nome||E||"Conversa"}),(0,k.jsx)("p",{className:"text-xs sm:text-sm text-gray-500 dark:text-gray-400 truncate",children:b?"\ud83d\udeab Bloqueado":"Online"})]})]}),(0,k.jsxs)("div",{ref:I,onScroll:e=>{const{scrollTop:t,scrollHeight:r,clientHeight:a}=e.target;v(!(r-t-a<100)),0!==t||N||L()},className:"flex-1 overflow-y-auto p-2 sm:p-3 md:p-4 space-y-1 overscroll-contain",style:{WebkitOverflowScrolling:"touch",scrollBehavior:"smooth"},children:[N&&(0,k.jsx)("div",{className:"flex justify-center py-2 sm:py-3",children:(0,k.jsx)(Td,{className:"w-4 h-4 sm:w-5 sm:h-5 animate-spin text-gray-400"})}),0===S.length&&(0,k.jsxs)("div",{className:"text-center text-gray-500 py-6 sm:py-8 md:py-12 px-4",children:[(0,k.jsx)("p",{className:"text-sm sm:text-base",children:"Nenhuma mensagem ainda"}),(0,k.jsxs)("p",{className:"text-xs mt-2 opacity-70",children:["Props tem ",(null===s||void 0===s?void 0:s.length)||0," mensagens"]}),(0,k.jsxs)("p",{className:"text-xs opacity-70",children:["Local tem ",S.length," mensagens"]}),(0,k.jsxs)("p",{className:"text-xs opacity-70",children:["Ref tem ",T.current.length," mensagens"]})]}),S.filter(e=>{var t;return null===(t=e.deletadaPara)||void 0===t||!t.includes(a.userId)}).map((e,t)=>{var r,n;const s=S[t-1],i=s&&s.remetenteId===e.remetenteId&&(null===(r=e.timestamp)||void 0===r?void 0:r.seconds)-(null===(n=s.timestamp)||void 0===n?void 0:n.seconds)<60;return(0,k.jsx)($N,{mensagem:e,isPropriaMsg:e.remetenteId===a.userId,groupWithPrevious:i,onEdit:e=>{const t=prompt("Editar mensagem:",e.texto);t&&h(a.id,e.id,t)},onDeleteForMe:e=>{confirm("Apagar esta mensagem para voc\xea? Ela continuar\xe1 vis\xedvel para outros participantes.")&&d(a.id,e.id)},onDeleteForEveryone:e=>{confirm("Apagar esta mensagem para todos? Ela ser\xe1 removida para todos os participantes.")&&u(a.id,e.id)},onDownload:M},e.id)}),(0,k.jsx)("div",{ref:C})]}),y&&(0,k.jsx)("button",{onClick:F,className:"absolute bottom-20 sm:bottom-24 md:bottom-28 right-3 sm:right-4 md:right-8 p-2 sm:p-2.5 md:p-3 bg-blue-500 text-white rounded-full shadow-lg hover:bg-blue-600 active:scale-95 transition-all z-10","aria-label":"Rolar para baixo",children:(0,k.jsx)(Qb,{className:"w-4 h-4 sm:w-5 sm:h-5"})}),(0,k.jsx)(aj,{onEnviar:e=>o(a.id,e),onEnviarArquivo:(e,t)=>l(a.id,e,t),onDigitando:e=>f(a.id,e),disabled:i,bloqueado:b})]})},sj=t=>{let{isOpen:r,onClose:a,onIniciarConversa:i,onCriarGrupo:o,usuarioAtual:l}=t;const[c,d]=(0,e.useState)("individual"),[u,h]=(0,e.useState)(""),[m,f]=(0,e.useState)(""),[g,p]=(0,e.useState)(""),[x,y]=(0,e.useState)([]),[v,b]=(0,e.useState)([]),[w,N]=(0,e.useState)(!1);(0,e.useEffect)(()=>{r&&j()},[r]);const j=async()=>{try{N(!0);const e=(0,s.collection)(P.db,"usuarios"),t=(0,s.P)(e,(0,s._M)("id","!=",(null===l||void 0===l?void 0:l.id)||"")),r=(await(0,s.GG)(t)).docs.map(e=>(0,n.A)({id:e.id},e.data()));b(r)}catch(e){console.error("Erro ao carregar usu\xe1rios:",e)}finally{N(!1)}},S=v.filter(e=>{var t,r,a;return(null===(t=e.nome)||void 0===t?void 0:t.toLowerCase().includes(u.toLowerCase()))||(null===(r=e.cargo)||void 0===r?void 0:r.toLowerCase().includes(u.toLowerCase()))||(null===(a=e.email)||void 0===a?void 0:a.toLowerCase().includes(u.toLowerCase()))}),_=()=>{d("individual"),h(""),f(""),p(""),y([]),a()},E="individual"===c&&1===x.length||"grupo"===c&&m.trim()&&x.length>=2;return r?(0,k.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:(0,k.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl w-full max-w-md max-h-[90vh] flex flex-col",children:[(0,k.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700",children:[(0,k.jsx)("h2",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"Nova Conversa"}),(0,k.jsx)("button",{onClick:_,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-full transition-colors",children:(0,k.jsx)(Id,{className:"w-5 h-5 text-gray-500 dark:text-gray-400"})})]}),(0,k.jsx)("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:(0,k.jsxs)("div",{className:"flex gap-2",children:[(0,k.jsxs)("button",{onClick:()=>{d("individual"),y([])},className:"flex-1 py-2 px-4 rounded-lg font-medium transition-colors ".concat("individual"===c?"bg-blue-500 text-white":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"),children:[(0,k.jsx)(mu,{className:"w-4 h-4 inline mr-2"}),"Individual"]}),(0,k.jsxs)("button",{onClick:()=>{d("grupo"),y([])},className:"flex-1 py-2 px-4 rounded-lg font-medium transition-colors ".concat("grupo"===c?"bg-blue-500 text-white":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"),children:[(0,k.jsx)(uk,{className:"w-4 h-4 inline mr-2"}),"Grupo"]})]})}),"grupo"===c&&(0,k.jsxs)("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700 space-y-3",children:[(0,k.jsx)("input",{type:"text",placeholder:"Nome do grupo *",value:m,onChange:e=>f(e.target.value),className:"w-full px-4 py-2 bg-gray-100 dark:bg-gray-700 text-gray-900 dark:text-white border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),(0,k.jsx)("textarea",{placeholder:"Descri\xe7\xe3o do grupo (opcional)",value:g,onChange:e=>p(e.target.value),rows:2,className:"w-full px-4 py-2 bg-gray-100 dark:bg-gray-700 text-gray-900 dark:text-white border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none"})]}),(0,k.jsxs)("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700",children:[(0,k.jsxs)("div",{className:"relative",children:[(0,k.jsx)(Ft,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),(0,k.jsx)("input",{type:"text",placeholder:"Buscar usu\xe1rios...",value:u,onChange:e=>h(e.target.value),className:"w-full pl-10 pr-4 py-2 bg-gray-100 dark:bg-gray-700 text-gray-900 dark:text-white border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),x.length>0&&(0,k.jsxs)("div",{className:"mt-2 text-sm text-gray-600 dark:text-gray-400",children:[x.length," ","grupo"===c?"participante(s)":"usu\xe1rio"," selecionado(s)","grupo"===c&&x.length<2&&(0,k.jsx)("span",{className:"text-red-500 ml-2",children:"(m\xednimo 2 participantes)"})]})]}),(0,k.jsx)("div",{className:"flex-1 overflow-y-auto p-4",children:w?(0,k.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,k.jsx)(Td,{className:"w-8 h-8 animate-spin text-blue-500"})}):0===S.length?(0,k.jsx)("div",{className:"text-center py-8",children:(0,k.jsx)("p",{className:"text-gray-500 dark:text-gray-400",children:u?"Nenhum usu\xe1rio encontrado":"Nenhum usu\xe1rio dispon\xedvel"})}):(0,k.jsx)("div",{className:"space-y-2",children:S.map(e=>{var t;const r=x.includes(e.id),a="grupo"===c||0===x.length||r;return(0,k.jsxs)("button",{onClick:()=>{return a&&(t=e.id,void y(e=>e.includes(t)?e.filter(e=>e!==t):[...e,t]));var t},disabled:!a,className:"w-full p-3 rounded-lg flex items-center gap-3 transition-colors ".concat(r?"bg-blue-50 dark:bg-blue-900/20 border-2 border-blue-500":"bg-gray-50 dark:bg-gray-700 border-2 border-transparent hover:bg-gray-100 dark:hover:bg-gray-600"," ").concat(a?"":"opacity-50 cursor-not-allowed"),children:[(0,k.jsx)("div",{className:"w-10 h-10 rounded-full flex items-center justify-center ".concat(r?"bg-blue-500":"bg-gradient-to-br from-blue-500 to-blue-600"," text-white font-semibold flex-shrink-0"),children:e.avatar?(0,k.jsx)("img",{src:e.avatar,alt:e.nome,className:"w-full h-full rounded-full object-cover"}):(null===(t=e.nome)||void 0===t?void 0:t.charAt(0).toUpperCase())||"?"}),(0,k.jsxs)("div",{className:"flex-1 text-left min-w-0",children:[(0,k.jsx)("h4",{className:"font-semibold text-gray-900 dark:text-white truncate",children:e.nome}),e.cargo&&(0,k.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 truncate",children:e.cargo})]}),a&&(0,k.jsx)("div",{className:"w-5 h-5 rounded-full border-2 flex items-center justify-center flex-shrink-0 ".concat(r?"bg-blue-500 border-blue-500":"border-gray-300 dark:border-gray-600"),children:r&&(0,k.jsx)("svg",{className:"w-3 h-3 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:(0,k.jsx)("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})})]},e.id)})})}),(0,k.jsxs)("div",{className:"p-4 border-t border-gray-200 dark:border-gray-700 flex gap-2",children:[(0,k.jsx)("button",{onClick:_,className:"flex-1 py-2 px-4 bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-600 font-medium transition-colors",children:"Cancelar"}),(0,k.jsx)("button",{onClick:()=>{"individual"===c&&1===x.length?(i(x[0]),_()):"grupo"===c&&m.trim()&&x.length>=2&&(o(m,g,x),_())},disabled:!E,className:"flex-1 py-2 px-4 bg-blue-500 text-white rounded-lg hover:bg-blue-600 font-medium transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"individual"===c?"Iniciar Conversa":"Criar Grupo"})]})]})}):null},ij=y("bell-off",[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M17 17H4a1 1 0 0 1-.74-1.673C4.59 13.956 6 12.499 6 8a6 6 0 0 1 .258-1.742",key:"178tsu"}],["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M8.668 3.01A6 6 0 0 1 18 8c0 2.687.77 4.653 1.707 6.05",key:"1hqiys"}]]),oj=y("test-tube",[["path",{d:"M14.5 2v17.5c0 1.4-1.1 2.5-2.5 2.5c-1.4 0-2.5-1.1-2.5-2.5V2",key:"125lnx"}],["path",{d:"M8.5 2h7",key:"csnxdl"}],["path",{d:"M14.5 16h-5",key:"1ox875"}]]),lj=y("monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]),cj=y("volume-2",[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]]),dj=y("volume-x",[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["line",{x1:"22",x2:"16",y1:"9",y2:"15",key:"1ewh16"}],["line",{x1:"16",x2:"22",y1:"9",y2:"15",key:"5ykzw1"}]]),uj=y("smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]),hj="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",mj="google.c.a.c_id",fj=1e4;var gj,pj;function xj(e){const t=new Uint8Array(e);return btoa(String.fromCharCode(...t)).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function yj(e){const t=(e+"=".repeat((4-e.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),r=atob(t),a=new Uint8Array(r.length);for(let n=0;n<r.length;++n)a[n]=r.charCodeAt(n);return a}!function(e){e[e.DATA_MESSAGE=1]="DATA_MESSAGE",e[e.DISPLAY_NOTIFICATION=3]="DISPLAY_NOTIFICATION"}(gj||(gj={})),function(e){e.PUSH_RECEIVED="push-received",e.NOTIFICATION_CLICKED="notification-clicked"}(pj||(pj={}));const vj="fcm_token_details_db",bj="fcm_token_object_Store";const wj="firebase-messaging-store";let kj=null;function Nj(){return kj||(kj=(0,K.openDB)("firebase-messaging-database",1,{upgrade:(e,t)=>{if(0===t)e.createObjectStore(wj)}})),kj}async function jj(e){const t=_j(e),r=await Nj(),a=await r.transaction(wj).objectStore(wj).get(t);if(a)return a;{const t=await async function(e){if("databases"in indexedDB){const e=(await indexedDB.databases()).map(e=>e.name);if(!e.includes(vj))return null}let t=null;return(await(0,K.openDB)(vj,5,{upgrade:async(r,a,n,s)=>{if(a<2)return;if(!r.objectStoreNames.contains(bj))return;const i=s.objectStore(bj),o=await i.index("fcmSenderId").get(e);if(await i.clear(),o)if(2===a){var l;const e=o;if(!e.auth||!e.p256dh||!e.endpoint)return;t={token:e.fcmToken,createTime:null!==(l=e.createTime)&&void 0!==l?l:Date.now(),subscriptionOptions:{auth:e.auth,p256dh:e.p256dh,endpoint:e.endpoint,swScope:e.swScope,vapidKey:"string"===typeof e.vapidKey?e.vapidKey:xj(e.vapidKey)}}}else if(3===a){const e=o;t={token:e.fcmToken,createTime:e.createTime,subscriptionOptions:{auth:xj(e.auth),p256dh:xj(e.p256dh),endpoint:e.endpoint,swScope:e.swScope,vapidKey:xj(e.vapidKey)}}}else if(4===a){const e=o;t={token:e.fcmToken,createTime:e.createTime,subscriptionOptions:{auth:xj(e.auth),p256dh:xj(e.p256dh),endpoint:e.endpoint,swScope:e.swScope,vapidKey:xj(e.vapidKey)}}}}})).close(),await(0,K.deleteDB)(vj),await(0,K.deleteDB)("fcm_vapid_details_db"),await(0,K.deleteDB)("undefined"),function(e){if(!e||!e.subscriptionOptions)return!1;const{subscriptionOptions:t}=e;return"number"===typeof e.createTime&&e.createTime>0&&"string"===typeof e.token&&e.token.length>0&&"string"===typeof t.auth&&t.auth.length>0&&"string"===typeof t.p256dh&&t.p256dh.length>0&&"string"===typeof t.endpoint&&t.endpoint.length>0&&"string"===typeof t.swScope&&t.swScope.length>0&&"string"===typeof t.vapidKey&&t.vapidKey.length>0}(t)?t:null}(e.appConfig.senderId);if(t)return await Sj(e,t),t}}async function Sj(e,t){const r=_j(e),a=(await Nj()).transaction(wj,"readwrite");return await a.objectStore(wj).put(t,r),await a.done,t}function _j(e){let{appConfig:t}=e;return t.appId}const Ej={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"only-available-in-window":"This method is available in a Window context.","only-available-in-sw":"This method is available in a service worker context.","permission-default":"The notification permission was not granted and dismissed instead.","permission-blocked":"The notification permission was not granted and blocked instead.","unsupported-browser":"This browser doesn't support the API's required to use the Firebase SDK.","indexed-db-unsupported":"This browser doesn't support indexedDb.open() (ex. Safari iFrame, Firefox Private Browsing, etc)","failed-service-worker-registration":"We are unable to register the default service worker. {$browserErrorMessage}","token-subscribe-failed":"A problem occurred while subscribing the user to FCM: {$errorInfo}","token-subscribe-no-token":"FCM returned no token when subscribing the user to push.","token-unsubscribe-failed":"A problem occurred while unsubscribing the user from FCM: {$errorInfo}","token-update-failed":"A problem occurred while updating the user from FCM: {$errorInfo}","token-update-no-token":"FCM returned no token when updating the user to push.","use-sw-after-get-token":"The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.","invalid-sw-registration":"The input to useServiceWorker() must be a ServiceWorkerRegistration.","invalid-bg-handler":"The input to setBackgroundMessageHandler() must be a function.","invalid-vapid-key":"The public VAPID key must be a string.","use-vapid-key-after-get-token":"The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used."},Aj=new G.FA("messaging","Messaging",Ej);async function Cj(e,t){const r={method:"DELETE",headers:await Tj(e)};try{const a=await fetch("".concat(Ij(e.appConfig),"/").concat(t),r),n=await a.json();if(n.error){const e=n.error.message;throw Aj.create("token-unsubscribe-failed",{errorInfo:e})}}catch(a){throw Aj.create("token-unsubscribe-failed",{errorInfo:null===a||void 0===a?void 0:a.toString()})}}function Ij(e){let{projectId:t}=e;return"".concat("https://fcmregistrations.googleapis.com/v1","/projects/").concat(t,"/registrations")}async function Tj(e){let{appConfig:t,installations:r}=e;const a=await r.getToken();return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t.apiKey,"x-goog-firebase-installations-auth":"FIS ".concat(a)})}function Dj(e){let{p256dh:t,auth:r,endpoint:a,vapidKey:n}=e;const s={web:{endpoint:a,auth:r,p256dh:t}};return n!==hj&&(s.web.applicationPubKey=n),s}async function Pj(e){const t=await async function(e,t){const r=await e.pushManager.getSubscription();if(r)return r;return e.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:yj(t)})}(e.swRegistration,e.vapidKey),r={vapidKey:e.vapidKey,swScope:e.swRegistration.scope,endpoint:t.endpoint,auth:xj(t.getKey("auth")),p256dh:xj(t.getKey("p256dh"))},a=await jj(e.firebaseDependencies);if(a){if(function(e,t){const r=t.vapidKey===e.vapidKey,a=t.endpoint===e.endpoint,n=t.auth===e.auth,s=t.p256dh===e.p256dh;return r&&a&&n&&s}(a.subscriptionOptions,r))return Date.now()>=a.createTime+6048e5?async function(e,t){try{const r=await async function(e,t){const r=await Tj(e),a=Dj(t.subscriptionOptions),n={method:"PATCH",headers:r,body:JSON.stringify(a)};let s;try{const r=await fetch("".concat(Ij(e.appConfig),"/").concat(t.token),n);s=await r.json()}catch(i){throw Aj.create("token-update-failed",{errorInfo:null===i||void 0===i?void 0:i.toString()})}if(s.error){const e=s.error.message;throw Aj.create("token-update-failed",{errorInfo:e})}if(!s.token)throw Aj.create("token-update-no-token");return s.token}(e.firebaseDependencies,t),a=(0,n.A)((0,n.A)({},t),{},{token:r,createTime:Date.now()});return await Sj(e.firebaseDependencies,a),r}catch($_){throw $_}}(e,{token:a.token,createTime:Date.now(),subscriptionOptions:r}):a.token;try{await Cj(e.firebaseDependencies,a.token)}catch($_){console.warn($_)}return Fj(e.firebaseDependencies,r)}return Fj(e.firebaseDependencies,r)}async function Fj(e,t){const r=await async function(e,t){const r=await Tj(e),a=Dj(t),n={method:"POST",headers:r,body:JSON.stringify(a)};let s;try{const t=await fetch(Ij(e.appConfig),n);s=await t.json()}catch(i){throw Aj.create("token-subscribe-failed",{errorInfo:null===i||void 0===i?void 0:i.toString()})}if(s.error){const e=s.error.message;throw Aj.create("token-subscribe-failed",{errorInfo:e})}if(!s.token)throw Aj.create("token-subscribe-no-token");return s.token}(e,t),a={token:r,createTime:Date.now(),subscriptionOptions:t};return await Sj(e,a),a.token}function Lj(e){const t={from:e.from,collapseKey:e.collapse_key,messageId:e.fcmMessageId};return function(e,t){if(!t.notification)return;e.notification={};const r=t.notification.title;r&&(e.notification.title=r);const a=t.notification.body;a&&(e.notification.body=a);const n=t.notification.image;n&&(e.notification.image=n);const s=t.notification.icon;s&&(e.notification.icon=s)}(t,e),function(e,t){if(!t.data)return;e.data=t.data}(t,e),function(e,t){var r,a,n,s,i;if(!t.fcmOptions&&(null===(r=t.notification)||void 0===r||!r.click_action))return;e.fcmOptions={};const o=null!==(a=null===(n=t.fcmOptions)||void 0===n?void 0:n.link)&&void 0!==a?a:null===(s=t.notification)||void 0===s?void 0:s.click_action;o&&(e.fcmOptions.link=o);const l=null===(i=t.fcmOptions)||void 0===i?void 0:i.analytics_label;l&&(e.fcmOptions.analyticsLabel=l)}(t,e),t}function Mj(e){return Aj.create("missing-app-config-values",{valueName:e})}!function(e,t){const r=[];for(let a=0;a<e.length;a++)r.push(e.charAt(a)),a<t.length&&r.push(t.charAt(a));r.join("")}("AzSCbw63g1R0nCw85jG8","Iaya3yLKwmgvh7cF0q4");class Rj{constructor(e,t,r){this.deliveryMetricsExportedToBigQueryEnabled=!1,this.onBackgroundMessageHandler=null,this.onMessageHandler=null,this.logEvents=[],this.isLogServiceStarted=!1;const a=function(e){if(!e||!e.options)throw Mj("App Configuration Object");if(!e.name)throw Mj("App Name");const t=["projectId","apiKey","appId","messagingSenderId"],{options:r}=e;for(const a of t)if(!r[a])throw Mj(a);return{appName:e.name,projectId:r.projectId,apiKey:r.apiKey,appId:r.appId,senderId:r.messagingSenderId}}(e);this.firebaseDependencies={app:e,appConfig:a,installations:t,analyticsProvider:r}}_delete(){return Promise.resolve()}}async function Oj(e){try{e.swRegistration=await navigator.serviceWorker.register("/firebase-messaging-sw.js",{scope:"/firebase-cloud-messaging-push-scope"}),e.swRegistration.update().catch(()=>{}),await async function(e){return new Promise((t,r)=>{const a=setTimeout(()=>r(new Error("Service worker not registered after ".concat(fj," ms"))),fj),n=e.installing||e.waiting;e.active?(clearTimeout(a),t()):n?n.onstatechange=e=>{var r;"activated"===(null===(r=e.target)||void 0===r?void 0:r.state)&&(n.onstatechange=null,clearTimeout(a),t())}:(clearTimeout(a),r(new Error("No incoming service worker found.")))})}(e.swRegistration)}catch($_){throw Aj.create("failed-service-worker-registration",{browserErrorMessage:null===$_||void 0===$_?void 0:$_.message})}}async function Bj(e,t){if(!navigator)throw Aj.create("only-available-in-window");if("default"===Notification.permission&&await Notification.requestPermission(),"granted"!==Notification.permission)throw Aj.create("permission-blocked");return await async function(e,t){t?e.vapidKey=t:e.vapidKey||(e.vapidKey=hj)}(e,null===t||void 0===t?void 0:t.vapidKey),await async function(e,t){if(t||e.swRegistration||await Oj(e),t||!e.swRegistration){if(!(t instanceof ServiceWorkerRegistration))throw Aj.create("invalid-sw-registration");e.swRegistration=t}}(e,null===t||void 0===t?void 0:t.serviceWorkerRegistration),Pj(e)}async function zj(e,t,r){const a=function(e){switch(e){case pj.NOTIFICATION_CLICKED:return"notification_open";case pj.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}(t);(await e.firebaseDependencies.analyticsProvider.get()).logEvent(a,{message_id:r[mj],message_name:r["google.c.a.c_l"],message_time:r["google.c.a.ts"],message_device_time:Math.floor(Date.now()/1e3)})}async function Uj(e,t){const r=t.data;if(!r.isFirebaseMessaging)return;e.onMessageHandler&&r.messageType===pj.PUSH_RECEIVED&&("function"===typeof e.onMessageHandler?e.onMessageHandler(Lj(r)):e.onMessageHandler.next(Lj(r)));const a=r.data;var n;"object"===typeof(n=a)&&n&&mj in n&&"1"===a["google.c.a.e"]&&await zj(e,r.messageType,a)}const Vj="@firebase/messaging",qj="0.12.23",Hj=e=>{const t=new Rj(e.getProvider("app").getImmediate(),e.getProvider("installations-internal").getImmediate(),e.getProvider("analytics-internal"));return navigator.serviceWorker.addEventListener("message",e=>Uj(t,e)),t},Gj=e=>{const t=e.getProvider("messaging").getImmediate();return{getToken:e=>Bj(t,e)}};function Wj(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,q.Sx)();return async function(){try{await(0,G.eX)()}catch($_){return!1}return"undefined"!==typeof window&&(0,G.zW)()&&(0,G.dM)()&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}().then(e=>{if(!e)throw Aj.create("unsupported-browser")},e=>{throw Aj.create("indexed-db-unsupported")}),(0,q.j6)((0,G.Ku)(e),"messaging").getImmediate()}function Kj(e,t){return function(e,t){if(!navigator)throw Aj.create("only-available-in-window");return e.onMessageHandler=t,()=>{e.onMessageHandler=null}}(e=(0,G.Ku)(e),t)}(0,q.om)(new W.uA("messaging",Hj,"PUBLIC")),(0,q.om)(new W.uA("messaging-internal",Gj,"PRIVATE")),(0,q.KO)(Vj,qj),(0,q.KO)(Vj,qj,"esm2020");const Qj=new class{constructor(){this.messaging=null,this.currentUserId=null,this.initialized=!1,this.notificationQueue=[],this.sounds={message:null,mention:null,call:null},this.preferences={enabled:!0,sound:!0,vibration:!0,desktop:!0,mobile:!0,showPreview:!0,playOnFocus:!1},this.loadSounds(),this.loadPreferences(),this.setupVisibilityListener()}async initialize(e){if(this.initialized&&this.currentUserId===e)return console.log("\u2705 NotificationManager j\xe1 inicializado"),{success:!0,message:"J\xe1 inicializado"};console.log("\ud83d\ude80 Inicializando NotificationManager para:",e),this.currentUserId=e;try{if(!("Notification"in window))throw new Error("Navegador n\xe3o suporta notifica\xe7\xf5es");const t=await this.requestPermission();return"granted"!==t?{success:!1,message:"Permiss\xe3o negada",permission:t}:(await this.initializeFirebaseMessaging(e),await this.registerServiceWorker(),await this.loadPendingNotifications(),this.initialized=!0,console.log("\u2705 NotificationManager inicializado com sucesso"),{success:!0,message:"Notifica\xe7\xf5es ativadas",permission:"granted"})}catch(t){return console.error("\u274c Erro ao inicializar NotificationManager:",t),{success:!1,message:t.message,error:t}}}async requestPermission(){if("granted"===Notification.permission)return"granted";if("denied"===Notification.permission)return zb.warn("Notifica\xe7\xf5es bloqueadas. Ative nas configura\xe7\xf5es do navegador.",{autoClose:5e3}),"denied";const e=await Notification.requestPermission();return"granted"===e?zb.success("Notifica\xe7\xf5es ativadas! \ud83d\udd14",{icon:"\u2705"}):zb.info("Notifica\xe7\xf5es desativadas",{icon:"\u2139\ufe0f"}),e}async initializeFirebaseMessaging(e){try{if(await this.isCapacitorPlatform())return console.log("\ud83d\udcf1 Inicializando notifica\xe7\xf5es mobile com Capacitor"),void await this.setupCapacitorNotifications(e);console.log("\ud83c\udf10 Inicializando notifica\xe7\xf5es web com FCM");const{default:t}=await Promise.resolve().then(r.bind(r,2410));this.messaging=Wj(t);const a={NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_ENV:"production"}.REACT_APP_FIREBASE_VAPID_KEY;if(!a)return console.warn("\u26a0\ufe0f VAPID key n\xe3o configurada - usando modo local"),void this.setupLocalMode();const n=await async function(e,t){return Bj(e=(0,G.Ku)(e),t)}(this.messaging,{vapidKey:a});n&&(await this.saveToken(e,n),console.log("\ud83d\udcf1 Token FCM salvo")),Kj(this.messaging,e=>{console.log("\ud83d\udce8 Mensagem FCM recebida:",e),this.handleFCMMessage(e)})}catch(t){console.error("\u274c Erro ao inicializar FCM:",t),this.setupLocalMode()}}async isCapacitorPlatform(){try{const{Capacitor:e}=await r.e(344).then(r.bind(r,9344));return e.isNativePlatform()}catch(Z_){return!1}}async setupCapacitorNotifications(e){try{const{PushNotifications:t}=await r.e(914).then(r.bind(r,914)),{Capacitor:a}=await r.e(344).then(r.bind(r,9344));console.log("\ud83d\udcf1 Plataforma:",a.getPlatform());let n=await t.checkPermissions();if("prompt"===n.receive&&(n=await t.requestPermissions()),"granted"!==n.receive)return void console.warn("\u274c Permiss\xe3o de notifica\xe7\xf5es negada");await t.register(),console.log("\u2705 Push notifications registradas"),await t.addListener("registration",async t=>{console.log("\ud83d\udcf1 Push registration token:",t.value),await this.saveToken(e,t.value)}),await t.addListener("registrationError",e=>{console.error("\u274c Erro ao registrar push:",e)}),await t.addListener("pushNotificationReceived",e=>{console.log("\ud83d\udce8 Push recebido:",e),this.handleCapacitorNotification(e)}),await t.addListener("pushNotificationActionPerformed",e=>{var t,r;console.log("\ud83d\udc46 Notifica\xe7\xe3o clicada:",e);const a=null===(t=e.notification)||void 0===t||null===(r=t.data)||void 0===r?void 0:r.conversaId;this.handleNotificationClick(a)})}catch(t){console.error("\u274c Erro ao configurar Capacitor notifications:",t)}}handleCapacitorNotification(e){const{title:t,body:r,data:a}=e;if(this.isOnMessagesPage()&&this.isWindowActive())return zb.info(r||"Nova mensagem",{icon:"\ud83d\udcac",autoClose:3e3}),void(this.preferences.sound&&this.playSound("message"));console.log("\ud83d\udcec Notifica\xe7\xe3o recebida pelo sistema:",t)}async registerServiceWorker(){if("serviceWorker"in navigator)try{const e=await navigator.serviceWorker.register("/service-worker.js");return console.log("\u2705 Service Worker registrado:",e.scope),this.setupServiceWorkerCommunication(e),e}catch(e){console.error("\u274c Erro ao registrar Service Worker:",e)}}setupServiceWorkerCommunication(e){navigator.serviceWorker.addEventListener("message",e=>{console.log("\ud83d\udcec Mensagem do SW:",e.data),"NOTIFICATION_CLICKED"===e.data.type&&this.handleNotificationClick(e.data.conversaId)}),this.sendMessageToSW({type:"UPDATE_CONFIG",preferences:this.preferences})}sendMessageToSW(e){navigator.serviceWorker.controller&&navigator.serviceWorker.controller.postMessage(e)}handleFCMMessage(e){const t=e.notification||{},r=e.data||{};if(this.isOnMessagesPage()&&this.isWindowActive())return console.log("\ud83d\udd15 Usu\xe1rio est\xe1 na p\xe1gina - notifica\xe7\xe3o suprimida"),this.preferences.sound&&this.preferences.playOnFocus&&this.playSound("message"),void zb.info(t.body||"Nova mensagem",{icon:"\ud83d\udcac",autoClose:3e3,position:"bottom-right"});this.showNotification({title:t.title||"Nova Mensagem",body:t.body||"Voc\xea recebeu uma mensagem",icon:t.icon||"/logo192.png",conversaId:r.conversaId,senderId:r.senderId,senderName:r.senderName})}async showNotification(e){const{title:t,body:r,icon:a="/logo192.png",conversaId:n=null,senderId:s=null,senderName:i=null}=e;if(this.preferences.enabled&&this.preferences.desktop)if("granted"===Notification.permission)try{const e=new Notification(t,{body:this.preferences.showPreview?r:"Nova mensagem",icon:a,badge:"/logo192.png",tag:"msg-".concat(n||Date.now()),data:{conversaId:n,senderId:s,senderName:i,url:n?"/#/mensagens?conversa=".concat(n):"/#/mensagens"},requireInteraction:!1,vibrate:this.preferences.vibration?[200,100,200]:[],silent:!this.preferences.sound});e.onclick=()=>{window.focus(),this.handleNotificationClick(n),e.close()},setTimeout(()=>e.close(),1e4),this.preferences.sound&&this.playSound("message"),this.notificationQueue.push({id:Date.now(),title:t,body:r,conversaId:n,timestamp:(new Date).toISOString()}),this.notificationQueue.length>50&&(this.notificationQueue=this.notificationQueue.slice(-50)),this.updateBadge(1)}catch(o){console.error("\u274c Erro ao mostrar notifica\xe7\xe3o:",o),zb.info(r,{icon:"\ud83d\udcac",autoClose:5e3})}else console.warn("\u26a0\ufe0f Sem permiss\xe3o para notifica\xe7\xf5es");else console.log("\ud83d\udd15 Notifica\xe7\xf5es desativadas nas prefer\xeancias")}updateBadge(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if("setAppBadge"in navigator){const t=this.getCurrentUnreadCount()+e;navigator.setAppBadge(t).catch(e=>{console.log("Badge API n\xe3o suportada:",e)}),this.sendMessageToSW({type:"UPDATE_BADGE",count:t})}}clearBadge(){"clearAppBadge"in navigator&&navigator.clearAppBadge().catch(()=>{}),this.sendMessageToSW({type:"CLEAR_BADGE"})}getCurrentUnreadCount(){return this.notificationQueue.length}loadSounds(){try{this.sounds.message=new Audio("/sounds/notification.mp3"),this.sounds.message.volume=.5,this.sounds.mention=new Audio("/sounds/mention.mp3"),this.sounds.mention.volume=.6,this.sounds.call=new Audio("/sounds/call.mp3"),this.sounds.call.volume=.7}catch(e){console.log("\u2139\ufe0f Sons n\xe3o dispon\xedveis")}}playSound(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"message";if(!this.preferences.sound)return;const t=this.sounds[e];t&&(t.currentTime=0,t.play().catch(e=>{console.log("N\xe3o foi poss\xedvel tocar o som:",e)}))}loadPreferences(){try{const e=localStorage.getItem("notification_preferences");e&&(this.preferences=(0,n.A)((0,n.A)({},this.preferences),JSON.parse(e)))}catch(e){console.error("Erro ao carregar prefer\xeancias:",e)}}savePreferences(e){this.preferences=(0,n.A)((0,n.A)({},this.preferences),e),localStorage.setItem("notification_preferences",JSON.stringify(this.preferences)),this.sendMessageToSW({type:"UPDATE_CONFIG",preferences:this.preferences})}getPreferences(){return(0,n.A)({},this.preferences)}isOnMessagesPage(){return window.location.hash.includes("#/mensagens")||window.location.pathname.includes("/mensagens")}isWindowActive(){return document.hasFocus()&&!document.hidden}setupVisibilityListener(){document.addEventListener("visibilitychange",()=>{"visible"===document.visibilityState&&this.isOnMessagesPage()&&this.clearBadge()})}handleNotificationClick(e){window.location.hash=e?"#/mensagens?conversa=".concat(e):"#/mensagens",this.clearBadge()}setupLocalMode(){console.log("\ud83d\udd27 Modo local ativado (sem FCM)")}async saveToken(e,t){try{const r=(0,s.doc)(P.db,"usuarios",e),a={token:t,platform:"web",browser:navigator.userAgent,registeredAt:(0,s.O5)(),lastUsed:(0,s.O5)()};await(0,s.setDoc)(r,{fcmTokens:(0,s.hq)(a),notificationPreferences:this.preferences},{merge:!0}),console.log("\u2705 Token FCM salvo no Firestore")}catch(r){console.error("\u274c Erro ao salvar token:",r)}}async loadPendingNotifications(){if(navigator.serviceWorker.controller){const e=new MessageChannel;e.port1.onmessage=e=>{e.data.notifications&&(this.notificationQueue=e.data.notifications,console.log("\ud83d\udcec Notifica\xe7\xf5es pendentes carregadas:",this.notificationQueue.length))},navigator.serviceWorker.controller.postMessage({type:"GET_PENDING_NOTIFICATIONS"},[e.port2])}}async sendTestNotification(){await this.showNotification({title:"Teste de Notifica\xe7\xe3o \ud83e\uddea",body:"Sistema de notifica\xe7\xf5es funcionando perfeitamente!",icon:"/logo192.png"}),zb.success("Notifica\xe7\xe3o de teste enviada!",{icon:"\u2705"})}cleanup(){this.initialized=!1,this.currentUserId=null,this.notificationQueue=[],this.clearBadge()}},Yj=Qj,Xj=t=>{let{onClose:r}=t;const[a,s]=(0,e.useState)(Yj.getPreferences()),[i,o]=(0,e.useState)(Notification.permission),[l,c]=(0,e.useState)(!1);(0,e.useEffect)(()=>{s(Yj.getPreferences()),o(Notification.permission)},[]);const d=(e,t)=>{const r=(0,n.A)((0,n.A)({},a),{},{[e]:t});s(r),Yj.savePreferences(r),zb.success("Configura\xe7\xe3o salva!",{icon:"\u2705",autoClose:2e3})};return(0,k.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:(0,k.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[(0,k.jsx)("div",{className:"sticky top-0 bg-gradient-to-r from-blue-500 to-purple-600 p-6 text-white",children:(0,k.jsxs)("div",{className:"flex items-center justify-between",children:[(0,k.jsxs)("div",{className:"flex items-center gap-3",children:[(0,k.jsx)(Od,{className:"w-8 h-8"}),(0,k.jsxs)("div",{children:[(0,k.jsx)("h2",{className:"text-2xl font-bold",children:"Configura\xe7\xf5es de Notifica\xe7\xf5es"}),(0,k.jsx)("p",{className:"text-blue-100 text-sm mt-1",children:"Personalize como voc\xea recebe notifica\xe7\xf5es"})]})]}),(0,k.jsx)("button",{onClick:r,className:"p-2 hover:bg-white/20 rounded-full transition-colors",children:"\u2715"})]})}),(0,k.jsxs)("div",{className:"p-6 space-y-6",children:[(0,k.jsxs)("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 dark:from-blue-900/20 dark:to-purple-900/20 rounded-xl p-6 border-2 border-blue-200 dark:border-blue-700",children:[(0,k.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,k.jsxs)("div",{children:[(0,k.jsx)("h3",{className:"text-lg font-bold text-gray-900 dark:text-white flex items-center gap-2",children:"granted"===i?(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(Od,{className:"w-5 h-5 text-green-500"}),"Notifica\xe7\xf5es Ativadas"]}):(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(ij,{className:"w-5 h-5 text-gray-400"}),"Notifica\xe7\xf5es Desativadas"]})}),(0,k.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:"granted"===i?"Voc\xea receber\xe1 notifica\xe7\xf5es de novas mensagens":"denied"===i?"Notifica\xe7\xf5es bloqueadas. Habilite nas configura\xe7\xf5es do navegador.":"Clique no bot\xe3o para ativar notifica\xe7\xf5es"})]}),"granted"!==i&&(0,k.jsx)("button",{onClick:"denied"===i?()=>{zb.info("Abra as configura\xe7\xf5es do navegador para gerenciar permiss\xf5es",{autoClose:5e3})}:async()=>{c(!0);try{const e=await Yj.requestPermission();o(e),"granted"===e?zb.success("Notifica\xe7\xf5es ativadas!",{icon:"\ud83d\udd14"}):zb.warn("Permiss\xe3o negada",{icon:"\u26a0\ufe0f"})}catch(e){zb.error("Erro ao solicitar permiss\xe3o")}finally{c(!1)}},disabled:l,className:"px-6 py-3 bg-gradient-to-r from-blue-500 to-purple-600 text-white rounded-lg font-semibold hover:from-blue-600 hover:to-purple-700 transition-all shadow-lg disabled:opacity-50",children:"denied"===i?"Configura\xe7\xf5es":"Ativar"})]}),"granted"===i&&(0,k.jsxs)("button",{onClick:async()=>{if("granted"===i){c(!0);try{await Yj.sendTestNotification()}catch(e){zb.error("Erro ao enviar teste")}finally{c(!1)}}else zb.warn("Ative as notifica\xe7\xf5es primeiro!")},disabled:l,className:"w-full px-4 py-2 bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-200 rounded-lg font-medium hover:bg-gray-50 dark:hover:bg-gray-600 transition-colors flex items-center justify-center gap-2 border-2 border-gray-200 dark:border-gray-600",children:[(0,k.jsx)(oj,{className:"w-4 h-4"}),"Enviar Notifica\xe7\xe3o de Teste"]})]}),(0,k.jsxs)("div",{className:"space-y-4",children:[(0,k.jsx)("h3",{className:"text-lg font-bold text-gray-900 dark:text-white",children:"Prefer\xeancias"}),(0,k.jsxs)("div",{className:"flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-700/50 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:[(0,k.jsxs)("div",{className:"flex items-center gap-3",children:[(0,k.jsx)(lj,{className:"w-5 h-5 text-blue-500"}),(0,k.jsxs)("div",{children:[(0,k.jsx)("p",{className:"font-medium text-gray-900 dark:text-white",children:"Notifica\xe7\xf5es no Desktop"}),(0,k.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Mostrar notifica\xe7\xf5es do navegador"})]})]}),(0,k.jsxs)("label",{className:"relative inline-flex items-center cursor-pointer",children:[(0,k.jsx)("input",{type:"checkbox",checked:a.desktop,onChange:e=>d("desktop",e.target.checked),className:"sr-only peer"}),(0,k.jsx)("div",{className:"w-11 h-6 bg-gray-300 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-600 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"})]})]}),(0,k.jsxs)("div",{className:"flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-700/50 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:[(0,k.jsxs)("div",{className:"flex items-center gap-3",children:[a.sound?(0,k.jsx)(cj,{className:"w-5 h-5 text-green-500"}):(0,k.jsx)(dj,{className:"w-5 h-5 text-gray-400"}),(0,k.jsxs)("div",{children:[(0,k.jsx)("p",{className:"font-medium text-gray-900 dark:text-white",children:"Som de Notifica\xe7\xe3o"}),(0,k.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Tocar som ao receber mensagens"})]})]}),(0,k.jsxs)("label",{className:"relative inline-flex items-center cursor-pointer",children:[(0,k.jsx)("input",{type:"checkbox",checked:a.sound,onChange:e=>d("sound",e.target.checked),className:"sr-only peer"}),(0,k.jsx)("div",{className:"w-11 h-6 bg-gray-300 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-600 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"})]})]}),(0,k.jsxs)("div",{className:"flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-700/50 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:[(0,k.jsxs)("div",{className:"flex items-center gap-3",children:[(0,k.jsx)(uj,{className:"w-5 h-5 text-purple-500"}),(0,k.jsxs)("div",{children:[(0,k.jsx)("p",{className:"font-medium text-gray-900 dark:text-white",children:"Vibra\xe7\xe3o"}),(0,k.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Vibrar ao receber notifica\xe7\xf5es (mobile)"})]})]}),(0,k.jsxs)("label",{className:"relative inline-flex items-center cursor-pointer",children:[(0,k.jsx)("input",{type:"checkbox",checked:a.vibration,onChange:e=>d("vibration",e.target.checked),className:"sr-only peer"}),(0,k.jsx)("div",{className:"w-11 h-6 bg-gray-300 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-600 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"})]})]}),(0,k.jsxs)("div",{className:"flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-700/50 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:[(0,k.jsxs)("div",{className:"flex items-center gap-3",children:[a.showPreview?(0,k.jsx)(pr,{className:"w-5 h-5 text-blue-500"}):(0,k.jsx)(gr,{className:"w-5 h-5 text-gray-400"}),(0,k.jsxs)("div",{children:[(0,k.jsx)("p",{className:"font-medium text-gray-900 dark:text-white",children:"Mostrar Preview"}),(0,k.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Exibir conte\xfado da mensagem na notifica\xe7\xe3o"})]})]}),(0,k.jsxs)("label",{className:"relative inline-flex items-center cursor-pointer",children:[(0,k.jsx)("input",{type:"checkbox",checked:a.showPreview,onChange:e=>d("showPreview",e.target.checked),className:"sr-only peer"}),(0,k.jsx)("div",{className:"w-11 h-6 bg-gray-300 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-600 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"})]})]})]}),(0,k.jsx)("div",{className:"bg-blue-50 dark:bg-blue-900/20 border-2 border-blue-200 dark:border-blue-700 rounded-lg p-4",children:(0,k.jsxs)("p",{className:"text-sm text-blue-900 dark:text-blue-200",children:[(0,k.jsx)("strong",{children:"\ud83d\udca1 Dica:"})," As notifica\xe7\xf5es n\xe3o aparecer\xe3o quando voc\xea estiver com a p\xe1gina de mensagens aberta e ativa. Isso evita notifica\xe7\xf5es desnecess\xe1rias!"]})})]}),(0,k.jsx)("div",{className:"border-t border-gray-200 dark:border-gray-700 p-6",children:(0,k.jsx)("button",{onClick:r,className:"w-full px-6 py-3 bg-gradient-to-r from-blue-500 to-purple-600 text-white rounded-lg font-semibold hover:from-blue-600 hover:to-purple-700 transition-all shadow-lg",children:"Fechar"})})]})})};const Jj=new class{constructor(){this.conversasRef=(0,s.collection)(P.db,"conversas"),this.usuariosRef=(0,s.collection)(P.db,"usuarios")}async getOrCreateConversation(e,t){try{const r=(0,s.P)(this.conversasRef,(0,s._M)("tipo","==",YN.PRIVADA),(0,s._M)("participantes","array-contains",e)),a=(await(0,s.GG)(r)).docs.find(e=>e.data().participantes.includes(t));if(a)return(0,n.A)({id:a.id},a.data());const i={tipo:YN.PRIVADA,participantes:[e,t],participantesInfo:{[e]:{naoLidas:0,ultimaVez:(0,s.O5)(),silenciado:!1,arquivado:!1,fixado:!1},[t]:{naoLidas:0,ultimaVez:(0,s.O5)(),silenciado:!1,arquivado:!1,fixado:!1}},ultimaMensagem:null,criadaEm:(0,s.O5)(),atualizadaEm:(0,s.O5)(),bloqueios:{}},o=await(0,s.gS)(this.conversasRef,i);return(0,n.A)({id:o.id},i)}catch(r){throw console.error("Erro ao criar/buscar conversa:",r),r}}async createGroup(e,t,r,a){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;try{const o={};[e,...a].forEach(t=>{o[t]={naoLidas:0,ultimaVez:(0,s.O5)(),silenciado:!1,arquivado:!1,fixado:!1,admin:t===e}});const l={tipo:YN.GRUPO,nome:t,descricao:r||"",imagemUrl:i,adminId:e,participantes:[e,...a],participantesInfo:o,ultimaMensagem:null,criadaEm:(0,s.O5)(),atualizadaEm:(0,s.O5)(),bloqueios:{}},c=await(0,s.gS)(this.conversasRef,l);return await this.sendSystemMessage(c.id,"Grupo criado"),(0,n.A)({id:c.id},l)}catch(o){throw console.error("Erro ao criar grupo:",o),o}}listenToConversations(e,t){console.log("\ud83d\udd0d Buscando conversas para usu\xe1rio:",e);const r=(0,s.P)(this.conversasRef,(0,s._M)("participantes","array-contains",e),(0,s.My)("atualizadaEm","desc"));return(0,s.aQ)(r,async r=>{if(console.log("\ud83d\udce6 Snapshot recebido:",r.size,"conversas"),r.empty)return console.log("\ud83d\udced Nenhuma conversa encontrada para este usu\xe1rio"),void t([]);const a=r.docs.map(async t=>{var r,a,s,i,o,l,c,d;const u=t.data();let h=u.nome,m=u.imagemUrl||null;if(u.tipo===YN.PRIVADA){const t=u.participantes.find(t=>t!==e);if(t){const e=await this.getUserInfo(t);h=(null===e||void 0===e?void 0:e.nome)||"Usu\xe1rio",m=(null===e||void 0===e?void 0:e.photoURL)||null,console.log("\ud83d\udc64 Participante buscado:",{nome:h,photoURL:m,id:t,usuarioCompleto:e}),m||console.warn("\u26a0\ufe0f Usu\xe1rio sem photoURL:",t)}}return(0,n.A)((0,n.A)({id:t.id},u),{},{nome:h,photoURL:m,userId:e,naoLidas:(null===(r=u.participantesInfo)||void 0===r||null===(a=r[e])||void 0===a?void 0:a.naoLidas)||0,arquivado:(null===(s=u.participantesInfo)||void 0===s||null===(i=s[e])||void 0===i?void 0:i.arquivado)||!1,silenciado:(null===(o=u.participantesInfo)||void 0===o||null===(l=o[e])||void 0===l?void 0:l.silenciado)||!1,fixado:(null===(c=u.participantesInfo)||void 0===c||null===(d=c[e])||void 0===d?void 0:d.fixado)||!1})}),s=await Promise.all(a);console.log("\ud83d\udccb Conversas processadas:",s.length),console.log("\ud83d\udd0d Detalhes:",s),t(s)},e=>{console.error("\u274c Erro ao escutar conversas:",e),console.error("Detalhes do erro:",e.message,e.code),t([])})}async updateConversationSettings(e,t,r){try{const a=(0,s.doc)(this.conversasRef,e),n={};Object.keys(r).forEach(e=>{n["participantesInfo.".concat(t,".").concat(e)]=r[e]}),await(0,s.updateDoc)(a,n)}catch(a){throw console.error("Erro ao atualizar configura\xe7\xf5es:",a),a}}async sendMessage(e,t,r){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:KN.TEXTO,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;try{console.log("\ud83d\udce8 sendMessage chamado:",{conversaId:e,remetenteId:t,tipo:a});if(await this.isBlocked(e,t))throw console.error("\ud83d\udeab Usu\xe1rio bloqueado"),new Error(JN.BLOCKED_USER);const o=(0,s.doc)(this.conversasRef,e),l=await(0,s.x7)(o);if(!l.exists())throw new Error("Conversa n\xe3o encontrada");const c=l.data(),d=c.participantes||[];console.log("\ud83d\udc65 Participantes:",d);const u=r||"",h=Date.now(),m=(0,s.collection)(P.db,"conversas/".concat(e,"/mensagens")),f={texto:u,remetenteId:t,tipo:a,anexoUrl:i,status:WN.ENVIADA,timestamp:(0,s.O5)(),timestampCliente:h,encrypted:!1,editada:!1,deletada:!1,leitaPor:[t],entregueA:[t],conversaId:e};console.log("\ud83d\udcbe Salvando mensagem no Firestore...");const g=await(0,s.gS)(m,f);console.log("\u2705 Mensagem salva com ID:",g.id);const p=a===KN.TEXTO?r.substring(0,50):"\ud83d\udcce ".concat(a);await(0,s.updateDoc)(o,{ultimaMensagem:{id:g.id,texto:p,remetenteId:t,timestamp:new Date},atualizadaEm:(0,s.O5)()}),console.log("\ud83d\udd04 \xdaltima mensagem atualizada");for(const e of d)e!==t&&await(0,s.updateDoc)(o,{["participantesInfo.".concat(e,".naoLidas")]:(0,s.GV)(1)});return console.log("\ud83d\udcca Contador atualizado"),await this.sendPushNotifications(e,t,d,u,a,c),console.log("\ud83c\udf89 Mensagem enviada e criptografada!"),(0,n.A)((0,n.A)({id:g.id},f),{},{texto:u})}catch(o){throw console.error("\u274c Erro ao enviar mensagem:",o),console.error("Stack:",o.stack),o}}async sendPushNotifications(e,t,r,a,n,i){try{console.log("\ud83d\udd14 Enviando notifica\xe7\xf5es push...");const o=(0,s.doc)(this.usuariosRef,t),l=await(0,s.x7)(o),c=l.exists()&&l.data().nome||"Usu\xe1rio",d=i.tipo===YN.GRUPO?i.nome||"Grupo":c;let u="";switch(n){case KN.TEXTO:u=a.length>50?a.substring(0,50)+"...":a;break;case KN.IMAGEM:u="\ud83d\udcf7 Imagem";break;case KN.VIDEO:u="\ud83c\udfa5 V\xeddeo";break;case KN.AUDIO:u="\ud83c\udfa4 \xc1udio";break;case KN.ARQUIVO:u="\ud83d\udcce Arquivo";break;default:u="Nova mensagem"}const h=r.filter(e=>e!==t).map(async r=>{try{await(0,s.gS)((0,s.collection)(P.db,"notificacoes"),{usuarioId:r,tipo:"mensagem",titulo:d,mensagem:u,remetente:c,lida:!1,timestamp:(0,s.O5)(),dados:{conversaId:e,mensagemTipo:n,remetenteId:t}}),console.log("\u2705 Notifica\xe7\xe3o criada para ".concat(r))}catch(a){console.error("\u274c Erro ao enviar notifica\xe7\xe3o para ".concat(r,":"),a)}});await Promise.all(h),console.log("\ud83d\udd14 Notifica\xe7\xf5es push enviadas!")}catch(o){console.error("\u274c Erro ao enviar notifica\xe7\xf5es:",o)}}async sendSystemMessage(e,t){try{const r=(0,s.collection)(P.db,"conversas/".concat(e,"/mensagens")),a={texto:t,remetenteId:"system",tipo:KN.SISTEMA,status:WN.ENVIADA,timestamp:(0,s.O5)(),editada:!1,deletada:!1};await(0,s.gS)(r,a)}catch(r){console.error("Erro ao enviar mensagem do sistema:",r)}}listenToMessages(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:XN.MESSAGES_PER_PAGE,a=arguments.length>3?arguments[3]:void 0;console.log("\ud83d\udc42 Escutando mensagens para conversa:",e),console.log("\ud83d\udc64 Usu\xe1rio atual:",t),console.log("\ud83d\udcca Limite de mensagens:",r);const i=(0,s.collection)(P.db,"conversas/".concat(e,"/mensagens")),o=(0,s.P)(i,(0,s.My)("timestamp","desc"),(0,s.AB)(r));return(0,s.aQ)(o,async e=>{if(console.log("\ud83d\udce8 Snapshot de mensagens recebido:",e.size),console.log("\ud83d\udd04 Tipo de mudan\xe7a:",e.docChanges().map(e=>({type:e.type,id:e.doc.id}))),e.empty)return console.log("\ud83d\udced Nenhuma mensagem encontrada"),void a([]);try{var t,r,s,i;console.log("\ud83d\udcdd Processando mensagens sem criptografia");const o=e.docs.map(async e=>{const t=e.data();let r=null;if(t.remetenteId)try{r=await this.getUserInfo(t.remetenteId)}catch(a){console.error("Erro ao buscar info do remetente:",a)}return(0,n.A)((0,n.A)({id:e.id},t),{},{remetente:r})}),l=(await Promise.all(o)).reverse();console.log("\u2705 Mensagens processadas:",l.length),console.log("\ud83d\udcdd Primeira mensagem:",null===(t=l[0])||void 0===t||null===(r=t.texto)||void 0===r?void 0:r.substring(0,50)),console.log("\ud83d\udcdd \xdaltima mensagem:",null===(s=l[l.length-1])||void 0===s||null===(i=s.texto)||void 0===i?void 0:i.substring(0,50)),a(l)}catch(o){console.error("\u274c Erro ao processar mensagens:",o),console.error("Stack trace:",o.stack);const t=e.docs.map(e=>(0,n.A)({id:e.id},e.data())).reverse();a(t)}},e=>{console.error("\u274c Erro ao escutar mensagens:",e),console.error("Detalhes:",e.message),a([])})}async loadOlderMessages(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:XN.MESSAGES_PER_PAGE;try{const a=(0,s.collection)(P.db,"conversas/".concat(e,"/mensagens")),i=(0,s.P)(a,(0,s.My)("timestamp","desc"),(0,s.HM)(t),(0,s.AB)(r));return(await(0,s.GG)(i)).docs.map(e=>(0,n.A)({id:e.id},e.data())).reverse()}catch(a){throw console.error("Erro ao carregar mensagens antigas:",a),a}}async markMessagesAsRead(e,t,r){try{const a=(0,s.wP)(P.db),n=(0,s.collection)(P.db,"conversas/".concat(e,"/mensagens"));r.forEach(e=>{const r=(0,s.doc)(n,e);a.update(r,{status:WN.LIDA,leitaPor:[t]})});const i=(0,s.doc)(this.conversasRef,e);a.update(i,{["participantesInfo.".concat(t,".naoLidas")]:0}),await a.commit(),console.log("\u2705 Mensagens marcadas como lidas com sucesso")}catch(a){throw console.error("Erro ao marcar mensagens como lidas:",a),a}}async markAsRead(e,t,r){return this.markMessagesAsRead(e,t,r)}async clearUnreadCount(e,t){try{const r=(0,s.doc)(this.conversasRef,e);await(0,s.updateDoc)(r,{["participantesInfo.".concat(t,".naoLidas")]:0}),console.log("\u2705 Contador de n\xe3o lidas zerado imediatamente")}catch(r){throw console.error("Erro ao zerar contador de n\xe3o lidas:",r),r}}async deleteMessage(e,t){let r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];try{const a=(0,s.doc)(P.db,"conversas/".concat(e,"/mensagens"),t);r?await(0,s.updateDoc)(a,{deletada:!0,texto:"Mensagem deletada"}):await(0,s.deleteDoc)(a)}catch(a){throw console.error("Erro ao deletar mensagem:",a),a}}async deleteMessageForMe(e,t,r){try{const a=(0,s.doc)(P.db,"conversas/".concat(e,"/mensagens"),t),n=await(0,s.x7)(a);if(!n.exists())throw new Error("Mensagem n\xe3o encontrada");const i=n.data().deletadaPara||[];i.includes(r)||await(0,s.updateDoc)(a,{deletadaPara:[...i,r]}),console.log("\u2705 Mensagem apagada para o usu\xe1rio:",r)}catch(a){throw console.error("Erro ao apagar mensagem para mim:",a),a}}async deleteMessageForEveryone(e,t,r){try{const a=(0,s.doc)(P.db,"conversas/".concat(e,"/mensagens"),t),n=await(0,s.x7)(a);if(!n.exists())throw new Error("Mensagem n\xe3o encontrada");if(n.data().remetenteId!==r)throw new Error("Apenas o remetente pode apagar para todos");await(0,s.updateDoc)(a,{deletada:!0,deletadaParaTodos:!0,texto:"Esta mensagem foi apagada",deletadaEm:(0,s.O5)()}),console.log("\u2705 Mensagem apagada para todos")}catch(a){throw console.error("Erro ao apagar mensagem para todos:",a),a}}async editMessage(e,t,r){try{const a=(0,s.doc)(P.db,"conversas/".concat(e,"/mensagens"),t);await(0,s.updateDoc)(a,{texto:r,editada:!0,editadaEm:(0,s.O5)()})}catch(a){throw console.error("Erro ao editar mensagem:",a),a}}async uploadFile(e,t,r){try{const a=e.name.split(".").pop(),n="".concat(t,"/").concat(r,"/").concat(Date.now(),".").concat(a),s=(0,xt.KR)(P.storage,"mensagens/".concat(n)),i=await(0,xt.D)(s,e);return await(0,xt.qk)(i.ref)}catch(a){throw console.error("Erro ao fazer upload:",a),a}}async deleteFile(e){try{const t=(0,xt.KR)(P.storage,e);await(0,xt.XR)(t)}catch(t){console.error("Erro ao deletar arquivo:",t)}}async updateUserStatus(e,t){try{const r=(0,s.doc)(this.usuariosRef,e);await(0,s.updateDoc)(r,{status:t,ultimaVez:(0,s.O5)()})}catch(r){throw console.error("Erro ao atualizar status:",r),r}}listenToUserStatus(e,t){const r=(0,s.doc)(this.usuariosRef,e);return(0,s.aQ)(r,e=>{e.exists()&&t(e.data())})}async updateTypingStatus(e,t,r){try{const a=(0,s.doc)(this.conversasRef,e);r?await(0,s.updateDoc)(a,{["digitando.".concat(t)]:(0,s.O5)()}):await(0,s.updateDoc)(a,{["digitando.".concat(t)]:null})}catch(a){console.error("Erro ao atualizar digita\xe7\xe3o:",a)}}async blockUser(e,t,r){try{const a=(0,s.doc)(this.conversasRef,e);await(0,s.updateDoc)(a,{["bloqueios.".concat(t)]:r}),await this.sendSystemMessage(e,"Usu\xe1rio bloqueado")}catch(a){throw console.error("Erro ao bloquear usu\xe1rio:",a),a}}async unblockUser(e,t){try{const r=(0,s.doc)(this.conversasRef,e);await(0,s.updateDoc)(r,{["bloqueios.".concat(t)]:null}),await this.sendSystemMessage(e,"Usu\xe1rio desbloqueado")}catch(r){throw console.error("Erro ao desbloquear usu\xe1rio:",r),r}}async isBlocked(e,t){try{const r=(0,s.doc)(this.conversasRef,e),a=await(0,s.x7)(r);if(!a.exists())return!1;const n=a.data().bloqueios||{};return Object.values(n).includes(t)}catch(r){return console.error("Erro ao verificar bloqueio:",r),!1}}async updateLastMessage(e,t){try{const r=(0,s.doc)(this.conversasRef,e);await(0,s.updateDoc)(r,{ultimaMensagem:t,atualizadaEm:(0,s.O5)()})}catch(r){console.error("Erro ao atualizar \xfaltima mensagem:",r)}}async incrementUnreadCount(e,t){try{const r=(0,s.doc)(this.conversasRef,e),a=await(0,s.x7)(r);if(!a.exists())return;const n=a.data().participantes,i=(0,s.wP)(P.db);n.forEach(e=>{e!==t&&i.update(r,{["participantesInfo.".concat(e,".naoLidas")]:(0,s.GV)(1)})}),await i.commit()}catch(r){console.error("Erro ao incrementar n\xe3o lidas:",r)}}async searchMessages(e,t){try{const r=(0,s.collection)(P.db,"conversas/".concat(e,"/mensagens")),a=await(0,s.GG)(r);return a.docs.map(e=>(0,n.A)({id:e.id},e.data())).filter(e=>e.texto.toLowerCase().includes(t.toLowerCase()))}catch(r){throw console.error("Erro ao buscar mensagens:",r),r}}async getTotalUnreadCount(e){try{const t=(0,s.P)(this.conversasRef,(0,s._M)("participantes","array-contains",e)),r=await(0,s.GG)(t);let a=0;return r.docs.forEach(t=>{var r;const n=null===(r=t.data().participantesInfo)||void 0===r?void 0:r[e];n&&!n.silenciado&&(a+=n.naoLidas||0)}),a}catch(t){return console.error("Erro ao contar n\xe3o lidas:",t),0}}async getUserInfo(e){try{const t=(0,s.collection)(P.db,"funcionarios"),r=(0,s.P)(t,(0,s._M)("userId","==",e)),a=await(0,s.GG)(r);if(!a.empty){const e=a.docs[0].data();return console.log("\u2705 Funcion\xe1rio encontrado com foto:",e.photoURL),(0,n.A)({id:a.docs[0].id},e)}const i=(0,s.doc)(this.usuariosRef,e),o=await(0,s.x7)(i);if(o.exists()){const e=o.data(),r=(0,s.P)(t,(0,s._M)("email","==",e.email)),a=await(0,s.GG)(r);if(!a.empty){const e=a.docs[0].data();return console.log("\u2705 Funcion\xe1rio encontrado pelo email com foto:",e.photoURL),(0,n.A)({id:a.docs[0].id},e)}return console.log("\u26a0\ufe0f Usu\xe1rio encontrado mas sem funcion\xe1rio vinculado"),(0,n.A)({id:o.id},e)}return console.warn("\u274c Usu\xe1rio n\xe3o encontrado:",e),null}catch(t){return console.error("Erro ao buscar informa\xe7\xf5es do usu\xe1rio:",t),null}}},Zj=Jj,$j=()=>{const{usuario:t}=Nt(),[a,i]=(0,e.useState)([]),[o,l]=(0,e.useState)(null),[c,d]=(0,e.useState)([]),[u,h]=(0,e.useState)(!(null!==t&&void 0!==t&&t.id)),[m,f]=(0,e.useState)(!1),[g,p]=(0,e.useState)({}),[x,y]=(0,e.useState)(0),v=(0,e.useRef)(null),b=(0,e.useRef)(null),w=(0,e.useRef)(null),k=(0,e.useRef)({}),N=(0,e.useRef)(null),j=(0,e.useRef)(null),S=(0,e.useRef)([]),_=(0,e.useRef)({}),E=(0,e.useCallback)(e=>{console.log("\ud83d\udd14 Configurando listener de notifica\xe7\xf5es...");try{const{collection:t,query:a,where:n,orderBy:s,onSnapshot:i}=r(9329),{db:o}=r(2410),l=a(t(o,"notificacoes"),n("usuarioId","==",e),n("tipo","==","mensagem"),n("lida","==",!1),s("timestamp","desc"));w.current=i(l,e=>{e.docChanges().forEach(e=>{if("added"===e.type){const t=e.doc.data();C(t)}})}),console.log("\u2705 Listener de notifica\xe7\xf5es configurado")}catch(t){console.error("\u274c Erro ao configurar listener de notifica\xe7\xf5es:",t)}},[]),A=(0,e.useCallback)(e=>{console.log("\ud83c\udf10 Configurando listeners globais para",e.length,"conversas"),e.forEach(e=>{if(k.current[e.id])return;console.log("\ud83d\udc42 Criando listener global para conversa:",e.id);const r=(0,s.collection)(P.db,"conversas",e.id,"mensagens"),a=(0,s.P)(r,(0,s.My)("timestamp","desc"),(0,s.AB)(1)),o=(0,s.aQ)(a,r=>{r.docChanges().forEach(r=>{if("added"===r.type){const o=(0,n.A)({id:r.doc.id},r.doc.data());var a,s;if(_.current[e.id]!==o.id)if(console.log("\ud83d\udce9 NOVA MENSAGEM RECEBIDA em tempo real!",e.id),console.log("De:",o.remetenteId),console.log("Texto preview:",o.textoOriginal||(null===(a=o.texto)||void 0===a?void 0:a.substring(0,30))),_.current[e.id]=o.id,o.remetenteId!==t.id)if(console.log("\ud83d\udd04 For\xe7ando atualiza\xe7\xe3o da lista de conversas..."),i(t=>{var r;const a=t.findIndex(t=>t.id===e.id);if(-1===a)return t;const s=[...t],i=(0,n.A)((0,n.A)({},s[a]),{},{ultimaMensagem:o.textoOriginal||o.texto,atualizadaEm:o.timestamp,naoLidas:(null===(r=j.current)||void 0===r?void 0:r.id)===e.id?0:(s[a].naoLidas||0)+1});s.splice(a,1),s.unshift(i),console.log("\u2705 Lista de conversas atualizada! Nova ordem:",s.map(e=>e.id));const l=s.reduce((e,t)=>e+(t.naoLidas||0),0);return y(l),console.log("\ud83d\udd14 Total de n\xe3o lidas atualizado para:",l),s}),(null===(s=j.current)||void 0===s?void 0:s.id)!==e.id)try{const e=new Audio("/sounds/notification.mp3");e.volume=.3,e.play().catch(e=>console.log("Som n\xe3o dispon\xedvel"))}catch($_){}}})});k.current[e.id]=o}),Object.keys(k.current).forEach(t=>{e.find(e=>e.id===t)||(console.log("\ud83e\uddf9 Limpando listener obsoleto:",t),k.current[t](),delete k.current[t],delete _.current[t])})},[null===t||void 0===t?void 0:t.id]),C=(0,e.useCallback)(e=>{var t;console.log("\ud83d\udd14 Nova notifica\xe7\xe3o de mensagem:",e);const{titulo:r,mensagem:a,remetente:n,dados:s}=e,i=null===s||void 0===s?void 0:s.conversaId;if((null===(t=j.current)||void 0===t?void 0:t.id)===i)return void console.log("\ud83d\udd15 Usu\xe1rio j\xe1 est\xe1 nesta conversa, n\xe3o mostrar notifica\xe7\xe3o");const o=window.location.hash.includes("#/mensagens")||window.location.pathname.includes("/mensagens"),l=document.hasFocus()&&!document.hidden;if(o&&l)return console.log("\ud83d\udd15 Usu\xe1rio est\xe1 na p\xe1gina de mensagens ativa, apenas toast"),void zb.info("".concat(n,": ").concat(a),{icon:"\ud83d\udcac",autoClose:4e3,onClick:()=>{i&&(window.location.hash="#/mensagens?conversa=".concat(i))}});if("Notification"in window&&"granted"===Notification.permission){"serviceWorker"in navigator&&navigator.serviceWorker?(console.log("\ud83d\udcf1 Enviando notifica\xe7\xe3o via Service Worker..."),navigator.serviceWorker.ready.then(e=>{if(!e||!e.showNotification)return console.warn("\u26a0\ufe0f Registration.showNotification n\xe3o dispon\xedvel"),void c(n,a,i);e.showNotification(n||r||"Nova Mensagem",{body:a,icon:"/logo192.png",badge:"/logo192.png",tag:"msg-".concat(i),data:{conversaId:i,url:i?"/#/mensagens?conversa=".concat(i):"/#/mensagens",timestamp:Date.now()},requireInteraction:!1,vibrate:[200,100,200],actions:[{action:"open",title:"\ud83d\udcd6 Abrir"}],silent:!1}).then(()=>{console.log("\u2705 Notifica\xe7\xe3o enviada via Service Worker")}).catch(e=>{console.error("\u274c Erro ao enviar notifica\xe7\xe3o via SW:",e),c(n,a,i)})}).catch(e=>{console.error("\u274c Service Worker n\xe3o dispon\xedvel:",e),c(n,a,i)})):c(n,a,i);try{const e=new Audio("/sounds/notification.mp3");e.volume=.5,e.play().catch(e=>console.log("Som n\xe3o dispon\xedvel"))}catch($_){}}function c(e,t,r){console.log("\ud83c\udf10 Mostrando notifica\xe7\xe3o web (fallback)...");const a=new Notification(e||"Nova Mensagem",{body:t,icon:"/logo192.png",badge:"/logo192.png",tag:"msg-".concat(r),requireInteraction:!1,vibrate:[200,100,200],data:{conversaId:r}});a.onclick=()=>{window.focus(),window.location.hash=r?"#/mensagens?conversa=".concat(r):"#/mensagens",a.close()},setTimeout(()=>a.close(),1e4)}zb.info("".concat(n,": ").concat(a),{icon:"\ud83d\udcac",autoClose:5e3,onClick:()=>{i&&(window.location.hash="#/mensagens?conversa=".concat(i))}})},[]);(0,e.useEffect)(()=>{if(!t)return console.log("Nenhum usuario logado"),void h(!1);if(!t.id)return console.error('ERRO CRITICO: Usuario sem campo "id"!'),console.error("Usuario recebido:",t),zb.error("Erro: Usuario sem ID. Faca logout e login novamente."),void h(!1);console.log("useMensagens: Inicializando para usuario:",t.id),console.log("Nome:",t.nome),console.log("Email:",t.email);try{const e=localStorage.getItem("conversas_backup");if(e){const t=JSON.parse(e);t&&t.length>0&&(console.log("RECUPERANDO",t.length,"conversas do backup"),S.current=t,i(t))}}catch($_){console.warn("Nao foi possivel recuperar backup:",$_)}return Zj.updateUserStatus(t.id,QN.ONLINE).catch(e=>{console.error("Erro ao atualizar status:",e)}),E(t.id),h(!0),console.log("================================================="),console.log("CRIANDO LISTENER DE CONVERSAS para usuario:",t.id),console.log("================================================="),v.current=Zj.listenToConversations(t.id,e=>{if(console.log("================================================="),console.log("CALLBACK DE CONVERSAS EXECUTADO"),console.log("Quantidade:",e.length),console.log("IDs das conversas:",e.map(e=>e.id)),console.log("Conversas completas:",e),0===e.length&&S.current.length>0&&(console.warn("ALERTA: Listener retornou array vazio mas backup tem conversas!"),console.warn("Backup tem",S.current.length,"conversas"),console.warn("USANDO BACKUP ao inves de limpar!"),e=S.current),e.length>0){console.log("Atualizando backup com",e.length,"conversas"),S.current=e;try{localStorage.setItem("conversas_backup",JSON.stringify(e))}catch($_){console.warn("Nao foi possivel salvar backup no localStorage:",$_)}}console.log("Chamando setConversas com",e.length,"conversas"),console.trace("Stack trace do callback"),console.log("================================================="),i(e),h(!1),Q(e),A(e),console.log("setConversas EXECUTADO"),console.log("setLoading(false) EXECUTADO")}),console.log("Listener de conversas CRIADO e ARMAZENADO no ref"),()=>{console.log("Limpeza do useMensagens hook"),v.current&&(console.log("Desconectando listener de conversas"),v.current(),v.current=null),b.current&&(console.log("Desconectando listener de mensagens"),b.current(),b.current=null),w.current&&(console.log("Desconectando listener de notifica\xe7\xf5es"),w.current(),w.current=null),k.current&&(console.log("Desconectando listeners globais de mensagens"),Object.values(k.current).forEach(e=>{"function"===typeof e&&e()}),k.current={}),null!==t&&void 0!==t&&t.id&&Zj.updateUserStatus(t.id,QN.OFFLINE)}},[null===t||void 0===t?void 0:t.id,E,A]),(0,e.useEffect)(()=>{j.current=o},[o]),(0,e.useEffect)(()=>{console.log("\ud83d\udd14\ud83d\udd14\ud83d\udd14 TOTAL N\xc3O LIDAS MUDOU:",x)},[x]),(0,e.useEffect)(()=>{console.log("###############################################"),console.log("ESTADO CONVERSAS MUDOU!"),console.log("Quantidade atual:",a.length),console.log("IDs:",a.map(e=>e.id)),console.log("Backup tem:",S.current.length),console.trace("Stack trace da mudanca"),console.log("###############################################"),0===a.length&&S.current.length>0&&(console.error("!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!"),console.error("ALERTA CRITICO: CONVERSAS FORAM PERDIDAS!"),console.error("Estado atual: 0 conversas"),console.error("Backup tem:",S.current.length,"conversas"),console.error("RESTAURANDO DO BACKUP AUTOMATICAMENTE..."),console.error("!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!"),setTimeout(()=>{console.log("Restaurando conversas do backup..."),i(S.current)},100))},[a]);const I=(0,e.useCallback)(e=>{var r,a;if(console.log("==============================================="),console.log("selecionarConversa CHAMADO"),console.log("Conversa solicitada:",e.id),console.log("Conversa ativa no ref:",null===(r=j.current)||void 0===r?void 0:r.id),console.log("Conversa ativa no state:",null===o||void 0===o?void 0:o.id),console.trace("Stack trace da chamada:"),console.log("==============================================="),(null===(a=j.current)||void 0===a?void 0:a.id)===e.id)return console.log("Mesma conversa ja esta ativa, IGNORANDO"),void console.log("===============================================");console.log("Conversa diferente, procedendo..."),b.current&&(console.log("Desconectando listener de mensagens anterior"),b.current(),b.current=null),console.log("Atualizando conversaAtivaRef.current para:",e.id),j.current=e,console.log("Chamando setConversaAtiva"),l(e);const s=e.naoLidas||0;s>0&&(console.log("\ud83d\udd14 Atualizando contador local instantaneamente..."),i(t=>t.map(t=>t.id===e.id?(0,n.A)((0,n.A)({},t),{},{naoLidas:0}):t)),y(e=>Math.max(0,e-s)),console.log("\u2705 Contador local atualizado! Decrementado:",s)),console.log("\ud83d\udd14 Zerando contador no Firebase..."),Zj.clearUnreadCount(e.id,t.id).catch(e=>{console.error("Erro ao zerar contador:",e)}),X(e.id),console.log("AGUARDANDO mensagens do listener (nao limpando array)"),console.log("Criando listener de mensagens para conversa:",e.id),b.current=Zj.listenToMessages(e.id,t.id,XN.MESSAGES_PER_PAGE,r=>{console.log("================================================="),console.log("CALLBACK DO LISTENER EXECUTADO"),console.log("Para conversa:",e.id),console.log("Quantidade de mensagens:",r.length),console.log("IDs:",r.map(e=>e.id)),console.log("FORCANDO setMensagens com",r.length,"mensagens"),d(r),console.log("setMensagens EXECUTADO COM SUCESSO"),console.log("=================================================");const a=r.filter(e=>{var r;return e.remetenteId!==t.id&&!(null!==(r=e.leitaPor)&&void 0!==r&&r.includes(t.id))}).map(e=>e.id);a.length>0&&V(e.id,a)})},[null===t||void 0===t?void 0:t.id]),T=(0,e.useCallback)(async e=>{try{const r=await Zj.getOrCreateConversation(t.id,e);return I(r),r}catch(r){throw console.error("Erro ao iniciar conversa:",r),zb.error("Nao foi possivel iniciar a conversa"),r}},[null===t||void 0===t?void 0:t.id,I]),D=(0,e.useCallback)(async(e,r,a,n)=>{try{const s=await Zj.createGroup(t.id,e,r,a,n);return zb.success("Grupo criado com sucesso!"),s}catch(s){throw console.error("Erro ao criar grupo:",s),zb.error("Nao foi possivel criar o grupo"),s}},[null===t||void 0===t?void 0:t.id]),F=(0,e.useCallback)(async(e,r)=>{try{await Zj.updateConversationSettings(e,t.id,r),zb.success("Configuracoes atualizadas!")}catch(a){console.error("Erro ao atualizar configuracoes:",a),zb.error("Nao foi possivel atualizar as configuracoes")}},[null===t||void 0===t?void 0:t.id]),L=(0,e.useCallback)(async(e,r)=>{if(r.trim()){f(!0);try{await Zj.sendMessage(e,t.id,r,KN.TEXTO);console.log("\ud83d\udce4 Mensagem enviada! Atualizando lista de conversas..."),i(t=>{const a=t.findIndex(t=>t.id===e);if(-1===a)return t;const s=[...t],i=(0,n.A)((0,n.A)({},s[a]),{},{ultimaMensagem:r.substring(0,50),atualizadaEm:new Date});return s.splice(a,1),s.unshift(i),console.log("\u2705 Lista atualizada ap\xf3s envio!"),s})}catch(a){console.error("Erro ao enviar mensagem:",a),zb.error("Nao foi possivel enviar a mensagem")}finally{f(!1)}}},[null===t||void 0===t?void 0:t.id]),M=(0,e.useCallback)(async(e,r,a)=>{f(!0);try{const s=await Zj.uploadFile(r,a);await Zj.sendMessage(e,t.id,s,a,s),console.log("\ud83d\udce4 Arquivo enviado! Atualizando lista de conversas..."),i(t=>{const r=t.findIndex(t=>t.id===e);if(-1===r)return t;const s=[...t],i=a===KN.IMAGEM?"\ud83d\uddbc\ufe0f":a===KN.AUDIO?"\ud83c\udfb5":a===KN.VIDEO?"\ud83c\udfa5":"\ud83d\udcce",o=(0,n.A)((0,n.A)({},s[r]),{},{ultimaMensagem:"".concat(i," ").concat(a),atualizadaEm:new Date});return s.splice(r,1),s.unshift(o),console.log("\u2705 Lista atualizada ap\xf3s envio de arquivo!"),s})}catch(s){console.error("Erro ao enviar arquivo:",s),zb.error("Nao foi possivel enviar o arquivo")}finally{f(!1)}},[null===t||void 0===t?void 0:t.id]),R=(0,e.useCallback)(async(e,t)=>{try{await Zj.deleteMessage(e,t),zb.success("Mensagem deletada!")}catch(r){console.error("Erro ao deletar mensagem:",r),zb.error("Nao foi possivel deletar a mensagem")}},[]),O=(0,e.useCallback)(async(e,r)=>{try{await Zj.deleteMessageForMe(e,r,t.id),zb.success("Mensagem apagada para voce")}catch(a){console.error("Erro ao apagar mensagem para mim:",a),zb.error("Nao foi possivel apagar a mensagem")}},[null===t||void 0===t?void 0:t.id]),B=(0,e.useCallback)(async(e,r)=>{try{await Zj.deleteMessageForEveryone(e,r,t.id),zb.success("Mensagem apagada para todos")}catch(a){console.error("Erro ao apagar mensagem para todos:",a),zb.error(a.message||"Nao foi possivel apagar a mensagem")}},[null===t||void 0===t?void 0:t.id]),z=(0,e.useCallback)(async(e,t,r)=>{try{await Zj.editMessage(e,t,r),zb.success("Mensagem editada!")}catch(a){console.error("Erro ao editar mensagem:",a),zb.error("Nao foi possivel editar a mensagem")}},[]),U=(0,e.useCallback)(async e=>{try{await Zj.deleteConversationForUser(e,t.id),i(t=>t.filter(t=>t.id!==e)),(null===o||void 0===o?void 0:o.id)===e&&(l(null),d([])),zb.success("Conversa apagada")}catch(r){console.error("Erro ao apagar conversa:",r),zb.error("N\xe3o foi poss\xedvel apagar a conversa")}},[null===t||void 0===t?void 0:t.id,o]),V=(0,e.useCallback)(async(e,r)=>{try{await Zj.markAsRead(e,t.id,r)}catch(a){console.error("Erro ao marcar como lida:",a)}},[null===t||void 0===t?void 0:t.id]),q=(0,e.useCallback)(async()=>{o&&console.log("Carregando mensagens antigas...")},[o]),H=(0,e.useCallback)((e,r)=>{N.current&&clearTimeout(N.current),r?(Zj.setTyping(e,t.id,!0),N.current=setTimeout(()=>{Zj.setTyping(e,t.id,!1)},3e3)):Zj.setTyping(e,t.id,!1)},[null===t||void 0===t?void 0:t.id]),G=(0,e.useCallback)(async e=>{try{return await Zj.isConversationBlocked(e,t.id)}catch(r){return console.error("Erro ao verificar bloqueio:",r),!1}},[null===t||void 0===t?void 0:t.id]),W=(0,e.useCallback)(e=>{var r;return e&&"grupo"!==e.tipo&&(null===(r=e.participantes)||void 0===r?void 0:r.find(e=>e!==t.id))||null},[null===t||void 0===t?void 0:t.id]),K=(0,e.useCallback)(e=>{if(!e)return"";const t=e.toDate?e.toDate():new Date(e),r=new Date-t;if(r<6e4)return"Agora";if(r<36e5){const e=Math.floor(r/6e4);return"".concat(e,"min")}if(r<864e5){const e=Math.floor(r/36e5);return"".concat(e,"h")}if(r<6048e5){const e=Math.floor(r/864e5);return"".concat(e,"d")}return t.toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit"})},[]),Q=(0,e.useCallback)(e=>{const t=e.reduce((e,t)=>e+(t.naoLidas||0),0);console.log("\ud83d\udd14 Total de n\xe3o lidas atualizado:",t),console.log("\ud83d\udcca Conversas com n\xe3o lidas:",e.filter(e=>e.naoLidas>0).map(e=>({id:e.id,nome:e.nome,naoLidas:e.naoLidas}))),y(t)},[]),Y=(0,e.useCallback)(async e=>{try{return await Zj.getUserInfo(e)}catch(t){return console.error("Erro ao buscar info do participante:",t),null}},[]),X=(0,e.useCallback)(async e=>{try{const{collection:a,query:n,where:s,getDocs:i,updateDoc:o,doc:l}=r(9329),{db:c}=r(2410),d=n(a(c,"notificacoes"),s("usuarioId","==",t.id),s("tipo","==","mensagem"),s("dados.conversaId","==",e),s("lida","==",!1)),u=(await i(d)).docs.map(e=>o(l(c,"notificacoes",e.id),{lida:!0}));await Promise.all(u),console.log("\u2705 Notifica\xe7\xf5es marcadas como lidas")}catch(a){console.error("\u274c Erro ao marcar notifica\xe7\xf5es como lidas:",a)}},[null===t||void 0===t?void 0:t.id]);return{conversas:a,conversaAtiva:o,mensagens:c,loading:u,enviando:m,digitando:g,totalNaoLidas:x,selecionarConversa:I,iniciarConversa:T,criarGrupo:D,atualizarConfiguracoesConversa:F,apagarConversa:U,enviarMensagem:L,enviarArquivo:M,deletarMensagem:R,apagarParaMim:O,apagarParaTodos:B,editarMensagem:z,marcarComoLidas:V,carregarMensagensAntigas:q,atualizarDigitacao:H,verificarBloqueio:G,getOutroParticipante:W,buscarInfoParticipante:Y,formatarTimestamp:K}},eS=()=>{const{usuario:t}=Nt(),r=$j(),{conversaAtiva:a,conversas:n,loading:s,selecionarConversa:i,iniciarConversa:o,criarGrupo:l,mensagens:c,enviando:d,enviarMensagem:u,enviarArquivo:h,deletarMensagem:m,apagarParaMim:f,apagarParaTodos:g,editarMensagem:p,carregarMensagensAntigas:x,atualizarDigitacao:y,verificarBloqueio:v,getOutroParticipante:b,buscarInfoParticipante:w,formatarTimestamp:N}=r,[j,S]=(0,e.useState)(!1),[_,E]=(0,e.useState)(!1),[A,C]=(0,e.useState)(!1);(0,e.useEffect)(()=>{console.log(">>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>"),console.log("MensagensMain - Conversas do hook MUDARAM"),console.log("Quantidade:",n.length),console.log("IDs:",n.map(e=>e.id)),console.log("Loading:",s),console.log(">>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>")},[n,s]),(0,e.useEffect)(()=>(null!==t&&void 0!==t&&t.id&&Yj.initialize(t.id).then(e=>{console.log("\u2705 Sistema de notifica\xe7\xf5es inicializado:",e),"granted"===e.permission?console.log("\ud83d\udd14 Permiss\xe3o de notifica\xe7\xf5es concedida"):console.log("\ud83d\udd15 Permiss\xe3o de notifica\xe7\xf5es:",e.permission)}).catch(e=>{console.error("\u274c Erro ao inicializar notifica\xe7\xf5es:",e)}),()=>{Yj&&Yj.cleanup()}),[null===t||void 0===t?void 0:t.id]);return(0,k.jsxs)("div",{className:"h-screen flex bg-gray-100 dark:bg-gray-900",children:[(0,k.jsx)("div",{className:"\n        w-full lg:w-96 border-r border-gray-200 dark:border-gray-700\n        ".concat(j?"hidden lg:block":"block","\n      "),children:(0,k.jsx)(VN,{onSelectConversa:e=>{console.log("\ud83d\uddb1\ufe0f MensagensMain.handleSelectConversa chamado para:",e.id),console.trace("\ud83d\udccd Stack trace da chamada:"),i(e),S(!0)},conversaSelecionada:a,onNovaConversa:()=>E(!0),onOpenNotificationSettings:()=>C(!0),conversas:n,loading:s,formatarTimestamp:N})}),(0,k.jsx)(sj,{isOpen:_,onClose:()=>E(!1),onIniciarConversa:async e=>{const t=await o(e);t&&(i(t),S(!0))},onCriarGrupo:async(e,t,r)=>{const a=await l(e,t,r);a&&(i(a),S(!0))},usuarioAtual:t}),A&&(0,k.jsx)(Xj,{onClose:()=>C(!1)}),(0,k.jsx)("div",{className:"\n        flex-1 \n        ".concat(j?"flex":"hidden lg:flex","\n      "),children:a?(0,k.jsx)(nj,{conversa:a,onBack:()=>{S(!1)},mensagens:c,enviando:d,enviarMensagem:u,enviarArquivo:h,deletarMensagem:m,apagarParaMim:f,apagarParaTodos:g,editarMensagem:p,carregarMensagensAntigas:x,atualizarDigitacao:y,verificarBloqueio:v,getOutroParticipante:b,buscarInfoParticipante:w}):(0,k.jsx)("div",{className:"flex-1 flex items-center justify-center bg-gray-50 dark:bg-gray-900",children:(0,k.jsxs)("div",{className:"text-center",children:[(0,k.jsx)("div",{className:"w-24 h-24 bg-blue-100 dark:bg-blue-900/20 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,k.jsx)(Rd,{className:"w-12 h-12 text-blue-500"})}),(0,k.jsx)("h2",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100 mb-2",children:"Sistema de Mensagens"}),(0,k.jsx)("p",{className:"text-gray-500 dark:text-gray-400",children:"Selecione uma conversa para come\xe7ar"})]})})})]})},tS=()=>{const[t,r]=(0,e.useState)([]),[a,i]=(0,e.useState)(!0);return(0,e.useEffect)(()=>{const e=(0,s.P)((0,s.collection)(P.db,"emprestimos"),(0,s.My)("dataUltimaTransferencia","desc")),t=(0,s.aQ)(e,e=>{const t=[];e.docs.forEach(e=>{var r;const a=e.data();(null===(r=a.historicoTransferencias)||void 0===r?void 0:r.length)>0&&a.historicoTransferencias.forEach(r=>{t.push((0,n.A)((0,n.A)({id:e.id,emprestimoId:e.id},r),{},{ferramentas:a.ferramentas}))})}),r(t),i(!1)});return()=>t()},[]),a?(0,k.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,k.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500 dark:border-[#1D9BF0]"})}):(0,k.jsx)("div",{className:"space-y-4",children:0===t.length?(0,k.jsxs)("div",{className:"bg-white dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg p-8 text-center",children:[(0,k.jsx)(lu,{className:"w-16 h-16 mx-auto text-gray-400 dark:text-gray-500 mb-4"}),(0,k.jsx)("p",{className:"text-lg font-medium text-gray-900 dark:text-white",children:"Nenhuma transfer\xeancia registrada"}),(0,k.jsx)("p",{className:"text-gray-600 dark:text-gray-300",children:"As transfer\xeancias aparecer\xe3o aqui quando forem realizadas"})]}):(0,k.jsx)("div",{className:"space-y-4",children:t.map((e,t)=>(0,k.jsxs)("div",{className:"bg-white dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-lg p-6",children:[(0,k.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,k.jsxs)("div",{children:[(0,k.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,k.jsx)("span",{className:"text-gray-600 dark:text-gray-300",children:"De:"}),(0,k.jsx)("span",{className:"font-medium text-gray-900 dark:text-white",children:e.de}),(0,k.jsx)(vu,{className:"w-4 h-4 text-blue-500 dark:text-[#1D9BF0]"}),(0,k.jsx)("span",{className:"text-gray-600 dark:text-gray-300",children:"Para:"}),(0,k.jsx)("span",{className:"font-medium text-gray-900 dark:text-white",children:e.para})]}),(0,k.jsxs)("div",{className:"flex items-center gap-4 text-sm text-gray-600 dark:text-gray-300",children:[(0,k.jsxs)("div",{className:"flex items-center gap-1",children:[(0,k.jsx)(iu,{className:"w-4 h-4"}),bu(e.data)]}),(0,k.jsxs)("div",{className:"flex items-center gap-1",children:[(0,k.jsx)(xu,{className:"w-4 h-4"}),new Date(e.data).toLocaleTimeString()]})]})]}),(0,k.jsxs)("div",{className:"text-sm text-gray-600 dark:text-gray-300 bg-blue-100 dark:bg-[#1D9BF0] dark:bg-opacity-10 px-2 py-1 rounded-full",children:["#",e.emprestimoId.slice(-4)]})]}),(0,k.jsxs)("div",{className:"mt-4",children:[(0,k.jsx)("h4",{className:"text-sm font-medium text-gray-900 dark:text-white mb-2",children:"Ferramentas:"}),(0,k.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:e.ferramentas.map((e,t)=>(0,k.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-600 border border-gray-200 dark:border-gray-500 rounded-lg flex items-center gap-2 p-2",children:[(0,k.jsx)(lu,{className:"w-4 h-4 text-gray-400 dark:text-gray-500"}),(0,k.jsxs)("span",{className:"text-sm text-gray-900 dark:text-white",children:["string"===typeof e?e:e.nome,"string"!==typeof e&&e.quantidade>1&&" (".concat(e.quantidade,")")]}),"string"!==typeof e&&e.codigo&&(0,k.jsx)("span",{className:"text-xs text-gray-500 dark:text-gray-400 ml-2",children:e.codigo})]},t))})]})]},"".concat(e.emprestimoId,"-").concat(t)))})})};var rS=r(2868),aS=r.n(rS);const nS=e.createContext(void 0),sS=e=>{let{children:t}=e;const r=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};console.log("Event tracked:",e,t);try{const e=(0,n.A)((0,n.A)({},t),{},{timestamp:(new Date).toISOString(),userAgent:navigator.userAgent,language:navigator.language,screenResolution:"".concat(window.screen.width,"x").concat(window.screen.height)});console.log("Full event data:",e)}catch(r){console.error("Error tracking event:",r)}},a={trackEvent:r,trackPageView:e=>{r("page_view",{page:e})},trackUserAction:(e,t)=>{r("user_action",(0,n.A)({action:e},t))},trackError:(e,t)=>{r("error",(0,n.A)({message:e},t))},trackFeatureUsage:(e,t)=>{r("feature_usage",(0,n.A)({feature:e},t))},trackPerformance:(e,t)=>{r("performance",{metric:e,value:t})}};return(0,k.jsx)(nS.Provider,{value:a,children:t})},iS=y("list",[["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 18h.01",key:"1tta3j"}],["path",{d:"M3 6h.01",key:"1rqtza"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 18h13",key:"1lx6n3"}],["path",{d:"M8 6h13",key:"ik3vkj"}]]),oS=t=>{let{emprestimos:r,inventario:a}=t;const[n,s]=(0,e.useState)("total"),i=new Date,[o,l]=(0,e.useState)(i.getMonth()),[c,d]=(0,e.useState)(i.getFullYear()),[u,h]=(0,e.useState)(!1),[m,f]=(0,e.useState)(!1),g=[{value:"total",label:"Total",icon:xu},{value:"dia",label:"Hoje",icon:iu},{value:"semana",label:"Esta Semana",icon:iu},{value:"quinzenal",label:"\xdaltimas 2 Semanas",icon:iu},{value:"mes",label:"Este M\xeas",icon:iu},{value:"ano",label:"Este Ano",icon:iu}];(0,e.useEffect)(()=>{if(!u)return;const e=e=>{const t=document.getElementById("filter-dropdown");t&&!t.contains(e.target)&&h(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[u]);const p=r.reduce((e,t)=>(e=>{const t=new Date(e),r=new Date;switch(n){case"dia":return t.toDateString()===r.toDateString();case"semana":const e=new Date(r);e.setDate(r.getDate()-r.getDay());const a=new Date(e);return a.setDate(e.getDate()+6),t>=e&&t<=a;case"quinzenal":const n=new Date(r);return n.setDate(r.getDate()-14),t>=n&&t<=r;case"mes":return t.getMonth()===r.getMonth()&&t.getFullYear()===r.getFullYear();case"ano":return t.getFullYear()===r.getFullYear();default:return!0}})(t.dataEmprestimo)?(t.ferramentas&&t.ferramentas.forEach(t=>{const r=("object"===typeof t?t.nome:t).trim().toLowerCase();if(r.includes("bateria")&&r.includes("makita"))return;const a="object"===typeof t&&t.quantidade||1;e[r]=(e[r]||0)+a}),e):e,{}),x=Object.entries(p).sort((e,t)=>{let[,r]=e,[,a]=t;return a-r}).slice(0,10).map(e=>{let[t,r]=e;const n=a.find(e=>e.nome.trim().toLowerCase()===t);return{nome:n?n.nome:t,count:r}}),y=Object.entries(p).sort((e,t)=>{let[,r]=e,[,a]=t;return a-r}).map(e=>{let[t,r]=e;const n=a.find(e=>e.nome.trim().toLowerCase()===t);return{nome:n?n.nome:t,count:r}});return(0,k.jsxs)("div",{className:"bg-gray-200 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-xl shadow-sm p-4 hover:border-blue-500 dark:hover:border-[#1D9BF0] transition-colors",children:[(0,k.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,k.jsxs)("div",{className:"flex items-center gap-2",children:[(0,k.jsx)(Hb,{className:"w-5 h-5 text-blue-500 dark:text-[#1D9BF0]"}),(0,k.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Ferramentas Mais Utilizadas"})]}),(0,k.jsxs)("div",{className:"flex gap-2",children:[(0,k.jsxs)("div",{className:"relative",children:[(0,k.jsx)("button",{onClick:()=>h(e=>!e),className:"px-3 py-1 rounded-full text-sm transition-colors bg-blue-500 dark:bg-[#1D9BF0] text-white flex items-center gap-1.5",children:(()=>{const e=g.find(e=>e.value===n),t=(null===e||void 0===e?void 0:e.icon)||xu;return(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(t,{className:"w-4 h-4"}),(0,k.jsx)("span",{children:(null===e||void 0===e?void 0:e.label)||"Total"})]})})()}),u&&(0,k.jsx)("div",{id:"filter-dropdown",className:"absolute right-0 mt-2 w-48 bg-gray-200 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-xl shadow-lg z-50",children:(0,k.jsx)("div",{className:"p-2",children:g.map(e=>{const t=e.icon;return(0,k.jsxs)("button",{onClick:()=>{s(e.value),h(!1)},className:"w-full flex items-center gap-2 px-3 py-2 rounded-lg text-sm transition-colors ".concat(n===e.value?"bg-blue-500 dark:bg-[#1D9BF0] text-white":"text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-600"),children:[(0,k.jsx)(t,{className:"w-4 h-4"}),(0,k.jsx)("span",{children:e.label})]},e.value)})})})]}),(0,k.jsx)("button",{onClick:()=>f(!0),className:"p-1 text-gray-400 dark:text-gray-500 hover:text-gray-600 dark:hover:text-gray-300 transition-colors opacity-60 hover:opacity-100",title:"Ver ranking completo",children:(0,k.jsx)(iS,{className:"w-3.5 h-3.5"})})]})]}),(0,k.jsx)("div",{className:"space-y-2",children:x.length>0?x.map((e,t)=>{let{nome:r,count:a}=e;return(0,k.jsxs)("div",{className:"flex items-center justify-between p-2 rounded hover:bg-gray-50 dark:hover:bg-white dark:bg-gray-700 transition-colors",children:[(0,k.jsxs)("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[(0,k.jsx)("div",{className:"flex items-center justify-center w-6",children:t<3?(0,k.jsx)(ou,{className:"w-5 h-5 ".concat(0===t?"text-yellow-500":1===t?"text-gray-400":"text-amber-700")}):(0,k.jsx)("span",{className:"text-gray-600 dark:text-gray-500 dark:text-gray-400 text-sm font-medium",children:t+1})}),(0,k.jsx)("span",{className:"text-gray-700 dark:text-gray-500 dark:text-gray-400 truncate",children:r.charAt(0).toUpperCase()+r.slice(1)})]}),(0,k.jsxs)("div",{className:"flex items-center gap-2 ml-3",children:[(0,k.jsx)(xu,{className:"w-4 h-4 text-blue-500 dark:text-[#1D9BF0]"}),(0,k.jsxs)("span",{className:"text-gray-900 dark:text-white font-medium whitespace-nowrap",children:[a,"x"]})]})]},r)}):(0,k.jsx)("div",{className:"text-center text-gray-600 dark:text-gray-500 dark:text-gray-400 py-4",children:"mensal"===n?"Nenhum empr\xe9stimo registrado este m\xeas":"Nenhum empr\xe9stimo registrado ainda"})}),m&&(0,k.jsx)("div",{className:"fixed inset-0 bg-black/50 dark:bg-black/70 flex items-center justify-center z-50",children:(0,k.jsxs)("div",{className:"bg-gray-200 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-xl shadow-lg w-full max-w-2xl mx-4 max-h-[80vh] overflow-hidden",children:[(0,k.jsxs)("div",{className:"p-4 border-b border-gray-300 dark:border-gray-600 flex items-center justify-between",children:[(0,k.jsxs)("div",{className:"flex items-center gap-2",children:[(0,k.jsx)(iS,{className:"w-5 h-5 text-blue-500 dark:text-[#1D9BF0]"}),(0,k.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"Ranking Completo - Ferramentas Mais Utilizadas"})]}),(0,k.jsx)("button",{onClick:()=>f(!1),className:"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-white transition-colors",children:(0,k.jsx)(Id,{className:"w-5 h-5"})})]}),(0,k.jsx)("div",{className:"p-4 overflow-y-auto max-h-[60vh]",children:y.length>0?(0,k.jsx)("div",{className:"space-y-3",children:y.map((e,t)=>(0,k.jsxs)("div",{className:"flex items-center gap-3 p-3 bg-gray-100 dark:bg-gray-600 rounded-lg",children:[(0,k.jsx)("div",{className:"flex-shrink-0 w-8 h-8 bg-blue-500 dark:bg-[#1D9BF0] text-white rounded-full flex items-center justify-center text-sm font-medium",children:t+1}),(0,k.jsx)("div",{className:"flex-1",children:(0,k.jsx)("h4",{className:"text-gray-900 dark:text-white font-medium",children:e.nome})}),(0,k.jsx)("div",{className:"text-right",children:(0,k.jsxs)("span",{className:"text-lg font-bold text-gray-900 dark:text-white",children:[e.count,"x"]})})]},e.nome))}):(0,k.jsx)("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:"Nenhum empr\xe9stimo registrado ainda"})})]})})]})},lS=["Domingo","Segunda","Ter\xe7a","Quarta","Quinta","Sexta","S\xe1bado"],cS=[{valor:0,nome:"Janeiro"},{valor:1,nome:"Fevereiro"},{valor:2,nome:"Mar\xe7o"},{valor:3,nome:"Abril"},{valor:4,nome:"Maio"},{valor:5,nome:"Junho"},{valor:6,nome:"Julho"},{valor:7,nome:"Agosto"},{valor:8,nome:"Setembro"},{valor:9,nome:"Outubro"},{valor:10,nome:"Novembro"},{valor:11,nome:"Dezembro"}],dS=e=>{let{isOpen:t,onClose:r,onConfirm:a,message:n}=e;return t?(0,k.jsx)("div",{className:"fixed inset-0 bg-black/50 dark:bg-black/70 flex items-center justify-center z-50",children:(0,k.jsxs)("div",{className:"bg-gray-200 dark:bg-gray-700 rounded-xl shadow-lg w-full max-w-md mx-4 p-4",children:[(0,k.jsxs)("div",{className:"flex items-start gap-3 mb-4",children:[(0,k.jsx)(w,{className:"w-5 h-5 text-yellow-500 flex-shrink-0 mt-0.5"}),(0,k.jsxs)("div",{className:"flex-1",children:[(0,k.jsx)("h3",{className:"text-gray-900 dark:text-white font-medium mb-2",children:"Confirmar Remo\xe7\xe3o"}),(0,k.jsx)("p",{className:"text-gray-500 dark:text-gray-400 text-sm",children:n})]})]}),(0,k.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,k.jsx)("button",{onClick:r,className:"px-4 py-2 text-sm text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-white transition-colors",children:"Cancelar"}),(0,k.jsx)("button",{onClick:a,className:"px-4 py-2 text-sm bg-red-500/10 text-red-500 hover:bg-red-500/20 rounded transition-colors",children:"Remover"})]})]})}):null},uS=e=>{let{isOpen:t,onClose:r,title:a,children:n}=e;return t?(0,k.jsx)("div",{className:"fixed inset-0 bg-black/50 dark:bg-black/70 flex items-center justify-center z-50",children:(0,k.jsxs)("div",{className:"bg-gray-200 dark:bg-gray-700 rounded-xl shadow-lg w-full max-w-2xl mx-4",children:[(0,k.jsxs)("div",{className:"p-4 border-b border-gray-200 dark:border-gray-600 dark:border-gray-600 flex items-center justify-between",children:[(0,k.jsx)("h3",{className:"text-gray-900 dark:text-white font-medium",children:a}),(0,k.jsx)("button",{onClick:r,className:"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-white transition-colors",children:(0,k.jsx)(Id,{className:"w-5 h-5"})})]}),(0,k.jsx)("div",{className:"p-4",children:n})]})}):null},hS=t=>{let{emprestimos:r,onEmprestimoRemovido:a}=t;const n=new Date,[i,o]=(0,e.useState)(null),[l,c]=(0,e.useState)(null),[d,u]=(0,e.useState)(null),[h,m]=(0,e.useState)(n.getMonth()),[f,g]=(0,e.useState)(n.getFullYear()),[p,x]=(0,e.useState)({isOpen:!1,emprestimoId:null,message:""}),[y,v]=(0,e.useState)(!1);e.useEffect(()=>{if(!y)return;const e=e=>{const t=document.getElementById("date-picker-dropdown");t&&!t.contains(e.target)&&v(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[y]);const b=(e,t)=>{const r={day:"2-digit",month:"2-digit"};return"".concat(e.toLocaleDateString("pt-BR",r)," - ").concat(t.toLocaleDateString("pt-BR",r))},w=r.filter(e=>{if(!e.dataEmprestimo)return!1;const t=new Date(e.dataEmprestimo);return t.getMonth()===h&&t.getFullYear()===f}),N=w.reduce((e,t)=>{if(t.dataEmprestimo){const r=new Date(t.dataEmprestimo),a=lS[r.getDay()],n=new Date(r).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"2-digit"}),s=r.getTime();e[a]||(e[a]={count:0,emprestimos:[],ultimaData:n,timestamp:s}),s>e[a].timestamp&&(e[a].ultimaData=n,e[a].timestamp=s),e[a].count+=1,e[a].emprestimos.push(t)}return e},{}),j=(()=>{const e={},t=new Date(f,h,1);new Date(f,h+1,0).getDate();let r=new Date(t);0===r.getDay()||1===r.getDay()||r.getDay();1!==r.getDay()&&r.setDate(r.getDate()-r.getDay()+1);let a=1;for(;r.getMonth()===h||r.getDate()<=7;){const t=new Date(r),n=new Date(r);n.setDate(n.getDate()+5);if(e["Semana ".concat(a)]={count:0,emprestimos:[],dateRange:b(t,n)},r.setDate(r.getDate()+7),a++,t.getMonth()>h)break}return e})(),S=w.reduce((e,t)=>{if(t.dataEmprestimo){const r=new Date(t.dataEmprestimo),a=(e=>{const t=new Date(e.getFullYear(),e.getMonth(),1);let r=new Date(t);1!==r.getDay()&&r.setDate(r.getDate()-r.getDay()+1);const a=Math.floor((e-r)/864e5);return Math.floor(a/7)+1})(r),n="Semana ".concat(a);if(!e[n]){const t=new Date(r.getFullYear(),r.getMonth(),1);let s=new Date(t);1!==s.getDay()&&s.setDate(s.getDate()-s.getDay()+1);const i=new Date(s);i.setDate(i.getDate()+7*(a-1));const o=new Date(i);o.setDate(o.getDate()+5),e[n]={count:0,emprestimos:[],dateRange:b(i,o)}}e[n].count+=1,e[n].emprestimos.push(t)}return e},j),_=w.reduce((e,t)=>{if(t.dataEmprestimo){const r=new Date(t.dataEmprestimo).getHours(),a=r<12?"Manh\xe3":r<18?"Tarde":"Noite";e[a]||(e[a]={count:0,emprestimos:[]}),e[a].count+=1,e[a].emprestimos.push(t)}return e},{}),E=Math.max(...Object.values(N).map(e=>e.count),...Object.values(S).map(e=>e.count),...Object.values(_).map(e=>e.count)),A=e=>new Date(e).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"2-digit",hour:"2-digit",minute:"2-digit"});return(0,k.jsxs)(k.Fragment,{children:[(0,k.jsxs)("div",{className:"bg-gray-200 dark:bg-gray-700 p-4 rounded-xl border border-gray-200 dark:border-gray-600 dark:border-gray-600 hover:border-blue-500 dark:hover:border-[#1D9BF0] transition-colors",children:[(0,k.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,k.jsxs)("div",{className:"flex items-center gap-2",children:[(0,k.jsx)(xu,{className:"w-5 h-5 text-blue-500 dark:text-[#1D9BF0]"}),(0,k.jsx)("h3",{className:"text-gray-900 dark:text-white font-medium",children:"An\xe1lise de Tempo"}),(0,k.jsxs)("div",{className:"relative ml-2",children:[(0,k.jsx)("button",{onClick:()=>v(e=>!e),className:"p-1.5 hover:bg-[#38444D] rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 dark:focus:ring-[#1D9BF0] focus:ring-offset-1 focus:ring-offset-[#192734]",title:"Selecionar per\xedodo",children:(0,k.jsx)(iu,{className:"w-5 h-5 text-blue-500 dark:text-[#1D9BF0]"})}),y&&(0,k.jsx)("div",{id:"date-picker-dropdown",className:"absolute right-0 mt-2 w-[280px] bg-gray-200 dark:bg-gray-700 dark:bg-gray-800 rounded-xl shadow-lg border border-gray-200 dark:border-gray-600 dark:border-gray-600 z-50",children:(0,k.jsxs)("div",{className:"p-3",children:[(0,k.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,k.jsx)("button",{onClick:()=>g(f-1),className:"p-1.5 hover:bg-[#38444D] rounded-full transition-colors text-gray-500 dark:text-gray-400 hover:text-white",children:(0,k.jsx)(pN,{className:"w-4 h-4"})}),(0,k.jsx)("span",{className:"text-gray-900 dark:text-white font-medium",children:f}),(0,k.jsx)("button",{onClick:()=>g(f+1),className:"p-1.5 hover:bg-[#38444D] rounded-full transition-colors text-gray-500 dark:text-gray-400 hover:text-white",children:(0,k.jsx)(xN,{className:"w-4 h-4"})})]}),(0,k.jsx)("div",{className:"grid grid-cols-3 gap-2",children:cS.map(e=>(0,k.jsx)("button",{onClick:()=>{m(e.valor),v(!1)},className:"\n                            p-2 rounded text-sm font-medium transition-colors\n                            ".concat(h===e.valor?"bg-blue-500 dark:bg-[#1D9BF0] text-white":"text-gray-500 dark:text-gray-400 hover:bg-[#38444D] hover:text-white","\n                          "),children:e.nome.substring(0,3)},e.valor))})]})})]})]}),(0,k.jsxs)("div",{className:"text-gray-500 dark:text-gray-400 text-sm",children:[cS[h].nome," ",f]})]}),(0,k.jsxs)("div",{className:"space-y-6",children:[(0,k.jsxs)("div",{children:[(0,k.jsx)("h4",{className:"text-gray-500 dark:text-gray-400 text-sm mb-2",children:"Dias da Semana"}),(0,k.jsx)("div",{className:"space-y-1",children:Object.entries(N).filter(e=>{let[t,r]=e;return r.count>0}).sort((e,t)=>{let[r,a]=e,[n,s]=t;return s.timestamp-a.timestamp}).map(e=>{let[t,r]=e;const a=lS[n.getDay()],s=t===a&&h===n.getMonth()&&f===n.getFullYear();return(0,k.jsxs)("div",{className:"flex items-center gap-2 cursor-pointer p-1 rounded transition-colors ".concat(s?"bg-blue-500 dark:bg-[#1D9BF0]/10 hover:bg-blue-500 dark:bg-[#1D9BF0]/20":"hover:bg-[#38444D]/30"),onClick:()=>{o(t),c("dia")},children:[(0,k.jsxs)("div",{className:"w-48 text-sm flex items-center gap-2",children:[(0,k.jsxs)("span",{className:"w-20 text-white",children:[t," ",s&&"(Hoje)"]}),(0,k.jsxs)("span",{className:"text-white",children:["(",r.ultimaData,")"]})]}),(0,k.jsx)("div",{className:"flex-1 bg-[#38444D] rounded-full h-2",children:(0,k.jsx)("div",{className:"bg-blue-500 dark:bg-[#1D9BF0] h-2 rounded-full",style:{width:"".concat((r.count||0)/E*100,"%")}})}),(0,k.jsx)("div",{className:"w-8 text-right text-white text-sm",children:r.count}),(0,k.jsx)(xN,{className:"w-4 h-4 text-white"})]},t)})})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("h4",{className:"text-gray-500 dark:text-gray-400 text-sm mb-2",children:"Semanas do M\xeas"}),(0,k.jsx)("div",{className:"space-y-1",children:Object.entries(S).filter(e=>{let[t,r]=e;return r.count>0}).map(e=>{let[t,r]=e;return(0,k.jsxs)("div",{className:"flex items-center gap-2 cursor-pointer hover:bg-[#38444D]/30 p-1 rounded transition-colors",onClick:()=>{o(t),c("semana")},children:[(0,k.jsxs)("div",{className:"w-48 text-gray-500 dark:text-gray-400 text-sm flex items-center gap-2",children:[(0,k.jsx)("span",{className:"w-20",children:t}),(0,k.jsxs)("span",{className:"text-gray-500 dark:text-gray-400/70",children:["(",r.dateRange,")"]})]}),(0,k.jsx)("div",{className:"flex-1 bg-[#38444D] rounded-full h-2",children:(0,k.jsx)("div",{className:"bg-blue-500 dark:bg-[#1D9BF0] h-2 rounded-full",style:{width:"".concat((r.count||0)/E*100,"%")}})}),(0,k.jsx)("div",{className:"w-8 text-right text-gray-500 dark:text-gray-400 text-sm",children:r.count}),(0,k.jsx)(xN,{className:"w-4 h-4 text-gray-500 dark:text-gray-400"})]},t)})})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("h4",{className:"text-gray-500 dark:text-gray-400 text-sm mb-2",children:"Per\xedodos do Dia"}),(0,k.jsx)("div",{className:"space-y-1",children:["Manh\xe3","Tarde","Noite"].map(e=>{var t,r;return(0,k.jsxs)("div",{className:"flex items-center gap-2 cursor-pointer hover:bg-[#38444D]/30 p-1 rounded transition-colors",onClick:()=>{o(e),c("periodo")},children:[(0,k.jsx)("div",{className:"w-20 text-gray-500 dark:text-gray-400 text-sm",children:e}),(0,k.jsx)("div",{className:"flex-1 bg-[#38444D] rounded-full h-2",children:(0,k.jsx)("div",{className:"bg-blue-500 dark:bg-[#1D9BF0] h-2 rounded-full",style:{width:"".concat(((null===(t=_[e])||void 0===t?void 0:t.count)||0)/E*100,"%")}})}),(0,k.jsx)("div",{className:"w-8 text-right text-gray-500 dark:text-gray-400 text-sm",children:(null===(r=_[e])||void 0===r?void 0:r.count)||0}),(0,k.jsx)(xN,{className:"w-4 h-4 text-gray-500 dark:text-gray-400"})]},e)})})]})]})]}),(0,k.jsx)(uS,{isOpen:!!i,onClose:()=>{o(null),c(null),u(null)},title:"Empr\xe9stimos em ".concat(i||""),children:(0,k.jsx)("div",{className:"space-y-4 max-h-[60vh] overflow-y-auto",children:((e,t,r)=>{const a=("dia"===l?null===(e=N[i])||void 0===e?void 0:e.emprestimos:"semana"===l?null===(t=S[i])||void 0===t?void 0:t.emprestimos:(null===(r=_[i])||void 0===r?void 0:r.emprestimos)||[]).reduce((e,t)=>{var r;const a=t.nomeFuncionario||t.colaborador||(null===(r=t.funcionario)||void 0===r?void 0:r.nome)||t.funcionario||t.nome_funcionario||"Funcion\xe1rio n\xe3o especificado";return e[a]||(e[a]=[]),e[a].push(t),e},{});return Object.entries(a).sort((e,t)=>{let[r]=e,[a]=t;return r.localeCompare(a)}).map(e=>{let[t,r]=e;return(0,k.jsxs)("div",{className:"bg-[#38444D] rounded-lg overflow-hidden transition-all duration-200 ease-in-out",children:[(0,k.jsxs)("div",{className:"flex items-center gap-3 p-4 cursor-pointer hover:bg-blue-500 dark:bg-[#1D9BF0]/10 transition-colors ".concat(d===t?"bg-blue-500 dark:bg-[#1D9BF0]/10":""),onClick:()=>u(d===t?null:t),children:[(0,k.jsx)(mu,{className:"w-5 h-5 text-blue-500 dark:text-[#1D9BF0]"}),(0,k.jsxs)("div",{className:"flex-1",children:[(0,k.jsx)("h4",{className:"text-gray-900 dark:text-white font-medium",children:t}),(0,k.jsxs)("div",{className:"space-y-1",children:[(0,k.jsx)("div",{className:"flex items-center gap-2 text-sm text-gray-500 dark:text-gray-400",children:(0,k.jsxs)("span",{children:[r.length," empr\xe9stimo",1!==r.length?"s":""]})}),(0,k.jsx)("div",{className:"flex items-center gap-3 text-sm",children:(()=>{const e=(e=>e.reduce((e,t)=>{var r;const a=(null===(r=t.ferramentas)||void 0===r?void 0:r.length)||0;return t.dataDevolucao?e.devolvidas+=a:e.emprestadas+=a,e.total+=a,e},{total:0,devolvidas:0,emprestadas:0}))(r);return(0,k.jsxs)(k.Fragment,{children:[(0,k.jsxs)("span",{className:"flex items-center gap-1",children:[(0,k.jsx)("span",{className:"w-2 h-2 rounded-full bg-green-500"}),(0,k.jsxs)("span",{className:"text-green-500",children:[e.devolvidas," devolvida",1!==e.devolvidas?"s":""]})]}),(0,k.jsxs)("span",{className:"flex items-center gap-1",children:[(0,k.jsx)("span",{className:"w-2 h-2 rounded-full bg-yellow-500"}),(0,k.jsxs)("span",{className:"text-yellow-500",children:[e.emprestadas," emprestada",1!==e.emprestadas?"s":""]})]})]})})()})]})]}),(0,k.jsx)(xN,{className:"w-5 h-5 text-gray-500 dark:text-gray-400 transition-transform ".concat(d===t?"rotate-90":"")})]}),d===t&&(0,k.jsx)("div",{className:"p-4 border-t border-[#192734] space-y-3 bg-gray-200 dark:bg-gray-700 dark:bg-gray-800/50",children:r.map((e,t)=>{var r;return(0,k.jsx)("div",{className:"bg-gray-200 dark:bg-gray-700 p-4 rounded-lg",children:(0,k.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,k.jsxs)("div",{className:"flex justify-between items-start",children:[(0,k.jsxs)("div",{className:"flex items-center gap-2",children:[(0,k.jsx)(iu,{className:"w-4 h-4 text-blue-500 dark:text-[#1D9BF0]"}),(0,k.jsx)("span",{className:"text-gray-900 dark:text-white",children:A(e.dataEmprestimo)})]}),(0,k.jsx)("div",{className:"flex justify-end",children:(0,k.jsx)("button",{onClick:t=>{t.stopPropagation(),x({isOpen:!0,emprestimoId:e.id,message:"Tem certeza que deseja remover este empr\xe9stimo? Esta a\xe7\xe3o n\xe3o pode ser desfeita."})},className:"p-1.5 hover:bg-red-500/10 rounded transition-colors",title:"Remover empr\xe9stimo",children:(0,k.jsx)(nw,{className:"w-4 h-4 text-red-500"})})})]}),(0,k.jsxs)("div",{className:"flex items-start gap-2",children:[(0,k.jsx)(Md,{className:"w-4 h-4 text-blue-500 dark:text-[#1D9BF0] mt-1"}),(0,k.jsxs)("div",{className:"flex-1",children:[(0,k.jsxs)("div",{className:"flex items-center gap-2 text-gray-500 dark:text-gray-400 mb-1",children:[(0,k.jsx)("span",{children:"Ferramentas:"}),(0,k.jsx)("span",{className:"text-sm px-2 py-0.5 rounded ".concat(e.dataDevolucao?"bg-green-500/20 text-green-500":"bg-yellow-500/20 text-yellow-500"),children:e.dataDevolucao?"Devolvido":"Em andamento"})]}),(0,k.jsx)("div",{className:"flex flex-wrap gap-2",children:null===(r=e.ferramentas)||void 0===r?void 0:r.map((e,t)=>(0,k.jsx)("span",{className:"bg-[#38444D] px-2 py-1 rounded text-sm text-white",children:"string"===typeof e?e:e.nome},t))})]})]}),e.dataDevolucao&&(0,k.jsxs)("div",{className:"flex items-center gap-2 mt-2 text-sm text-gray-500 dark:text-gray-400",children:[(0,k.jsx)(iu,{className:"w-4 h-4 text-green-500"}),(0,k.jsxs)("span",{children:["Devolvido em: ",A(e.dataDevolucao)]})]})]})},t)})})]},t)})})()})}),(0,k.jsx)(dS,{isOpen:p.isOpen,onClose:()=>x({isOpen:!1,emprestimoId:null,message:""}),message:p.message,onConfirm:async()=>{try{p.emprestimoId&&(await(0,s.deleteDoc)((0,s.doc)(P.db,"emprestimos",p.emprestimoId)),a&&a(p.emprestimoId),x({isOpen:!1,emprestimoId:null,message:""}))}catch(e){console.error("Erro ao remover empr\xe9stimo:",e)}}})]})},mS=y("activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]),fS=e=>{let{emprestimos:t,funcionarios:r}=e;const a=t.reduce((e,t)=>{if(t.tarefa){const r=t.tarefa.toLowerCase().trim();e[r]||(e[r]={count:0,funcionarios:{},nome:t.tarefa}),e[r].count+=1,e[r].funcionarios[t.funcionarioId]=(e[r].funcionarios[t.funcionarioId]||0)+1}return e},{}),s=Object.values(a).sort((e,t)=>t.count-e.count).slice(0,5),i=s.map(e=>{const t=Object.entries(e.funcionarios).sort((e,t)=>{let[,r]=e,[,a]=t;return a-r}).slice(0,3).map(e=>{var t;let[a,n]=e;return{funcionario:(null===(t=r.find(e=>e.id===a))||void 0===t?void 0:t.nome)||"Funcion\xe1rio Removido",count:n}});return(0,n.A)((0,n.A)({},e),{},{topFuncionarios:t})});return(0,k.jsxs)("div",{className:"bg-gray-200 dark:bg-gray-700 p-4 rounded-xl border border-gray-200 dark:border-gray-600 dark:border-gray-600 hover:border-blue-500 dark:hover:border-[#1D9BF0] transition-colors",children:[(0,k.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,k.jsx)(mS,{className:"w-5 h-5 text-blue-500 dark:text-[#1D9BF0]"}),(0,k.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"An\xe1lise de Tarefas"})]}),(0,k.jsx)("div",{className:"space-y-6",children:i.map((e,t)=>(0,k.jsxs)("div",{className:"space-y-3",children:[(0,k.jsxs)("div",{className:"flex justify-between items-center",children:[(0,k.jsx)("h4",{className:"text-gray-500 dark:text-gray-400 font-medium",children:e.nome}),(0,k.jsxs)("span",{className:"text-white bg-blue-500 dark:bg-[#1D9BF0]/20 px-2 py-1 rounded-full text-sm",children:[e.count,"x realizadas"]})]}),(0,k.jsx)("div",{className:"pl-4 border-l-2 border-gray-200 dark:border-gray-600 dark:border-gray-600 space-y-2",children:e.topFuncionarios.map((e,t)=>(0,k.jsxs)("div",{className:"flex items-center gap-2",children:[(0,k.jsx)(uk,{className:"w-4 h-4 text-blue-500 dark:text-[#1D9BF0]"}),(0,k.jsx)("span",{className:"text-gray-500 dark:text-gray-400 text-sm",children:e.funcionario}),(0,k.jsxs)("span",{className:"text-white text-sm",children:["(",e.count,"x)"]})]},t))})]},t))})]})},gS=e=>{let{title:t,value:r,icon:a,color:n}=e;return(0,k.jsx)("div",{className:"bg-gray-200 dark:bg-gray-700 border border-gray-300 dark:border-gray-600 rounded-xl shadow-sm p-4 hover:border-blue-500 dark:hover:border-[#1D9BF0] transition-colors",children:(0,k.jsxs)("div",{className:"flex items-center gap-4",children:[(0,k.jsx)("div",{className:"p-3 rounded-lg ".concat(n||"bg-blue-500/10 dark:bg-[#1D9BF0]/10"),children:(0,k.jsx)(a,{className:"w-6 h-6 ".concat(n?"text-white":"text-blue-500 dark:text-[#1D9BF0]")})}),(0,k.jsxs)("div",{children:[(0,k.jsx)("h3",{className:"text-sm text-gray-900 dark:text-gray-300 font-medium",children:t}),(0,k.jsx)("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:r})]})]})})},pS=e=>{let{stats:t}=e;const r=t.inventario.length,a=t.funcionarios.length,n=t.emprestimos.filter(e=>"emprestado"===e.status).length,s=t.ferramentasDanificadas.length,i=t.ferramentasPerdidas.length,o=t.compras.filter(e=>"pendente"===e.status).length,l=t.compras.filter(e=>"concluida"===e.status).length;return(0,k.jsxs)("div",{className:"space-y-6",children:[(0,k.jsx)("h2",{className:"text-xl font-bold text-gray-900 dark:text-white mb-4",children:"Dashboard"}),(0,k.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[(0,k.jsx)(gS,{title:"Total de Ferramentas",value:r,icon:Hb}),(0,k.jsx)(gS,{title:"Funcion\xe1rios Ativos",value:a,icon:uk,color:"bg-green-500/20"}),(0,k.jsx)(gS,{title:"Empr\xe9stimos Ativos",value:n,icon:tu,color:"bg-blue-500/20"}),(0,k.jsx)(gS,{title:"Ferramentas Danificadas",value:s,icon:rw,color:"bg-yellow-500/20"}),(0,k.jsx)(gS,{title:"Ferramentas Perdidas",value:i,icon:w,color:"bg-red-500/20"}),(0,k.jsx)(gS,{title:"Compras Pendentes",value:o,icon:qb,color:"bg-orange-500/20"}),(0,k.jsx)(gS,{title:"Compras Conclu\xeddas",value:l,icon:Fd,color:"bg-emerald-500/20"})]}),(0,k.jsxs)("div",{className:"mt-8 grid grid-cols-1 lg:grid-cols-3 gap-4",children:[(0,k.jsx)(oS,{emprestimos:t.emprestimos,inventario:t.inventario}),(0,k.jsx)(hS,{emprestimos:t.emprestimos}),(0,k.jsx)(fS,{emprestimos:t.emprestimos,funcionarios:t.funcionarios})]})]})},xS=y("circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),yS=t=>{var r,a;let{cronograma:i,onClose:o,onAtualizar:l}=t;const[c,d]=(0,e.useState)(""),[u,h]=(0,e.useState)(i.tarefasPorDia||{}),[m,f]=(0,e.useState)(""),{showToast:g}=_(),p=[{key:"domingo",label:"Domingo",labelCompleto:"Domingo",emoji:"\ud83d\udcc5"},{key:"segunda",label:"Segunda",labelCompleto:"Segunda-feira",emoji:"\ud83d\udcc5"},{key:"terca",label:"Ter\xe7a",labelCompleto:"Ter\xe7a-feira",emoji:"\ud83d\udcc5"},{key:"quarta",label:"Quarta",labelCompleto:"Quarta-feira",emoji:"\ud83d\udcc5"},{key:"quinta",label:"Quinta",labelCompleto:"Quinta-feira",emoji:"\ud83d\udcc5"},{key:"sexta",label:"Sexta",labelCompleto:"Sexta-feira",emoji:"\ud83d\udcc5"},{key:"sabado",label:"S\xe1bado",labelCompleto:"S\xe1bado",emoji:"\ud83d\udcc5"}],x={alta:{label:"\ud83d\udd34 Alta",color:"bg-red-100 text-red-800 border-red-300"},media:{label:"\ud83d\udfe1 M\xe9dia",color:"bg-yellow-100 text-yellow-800 border-yellow-300"},baixa:{label:"\ud83d\udfe2 Baixa",color:"bg-green-100 text-green-800 border-green-300"}};(0,e.useEffect)(()=>{const e=["domingo","segunda","terca","quarta","quinta","sexta","sabado"][(new Date).getDay()];d(e),f(e)},[]);const y=async(e,t)=>{try{const r=(0,n.A)({},u);r[e]=r[e].map(e=>e.id===t?(0,n.A)((0,n.A)({},e),{},{concluida:!e.concluida}):e),h(r),await(0,s.updateDoc)((0,s.doc)(P.db,"cronogramasSemanais",i.id),{tarefasPorDia:r}),g("Status atualizado!","success"),l&&l()}catch(r){console.error("Erro ao atualizar tarefa:",r),g("Erro ao atualizar tarefa","error")}},v=e=>{const t=["domingo","segunda","terca","quarta","quinta","sexta","sabado"],r=t.indexOf(c);return t.indexOf(e)<=r},b=e=>{const t=new Date(i.dataInicio+"T00:00:00"),r=["domingo","segunda","terca","quarta","quinta","sexta","sabado"].indexOf(e),a=new Date(t);return a.setDate(t.getDate()+r),a.toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit"})},N=(()=>{let e=0,t=0;return Object.values(u).forEach(r=>{e+=r.length,t+=r.filter(e=>e.concluida).length}),{total:e,concluidas:t}})(),j=N.total>0?N.concluidas/N.total*100:0;return(0,k.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,k.jsxs)("div",{className:"bg-white dark:bg-gray-900 rounded-2xl shadow-2xl w-full max-w-5xl max-h-[90vh] overflow-hidden flex flex-col",children:[(0,k.jsxs)("div",{className:"bg-gradient-to-r from-[#1D9BF0] via-[#1A8CD8] to-[#1779BE] text-white p-6",children:[(0,k.jsxs)("div",{className:"flex justify-between items-start",children:[(0,k.jsxs)("div",{className:"flex-1",children:[(0,k.jsxs)("h2",{className:"text-2xl font-bold flex items-center gap-2",children:[(0,k.jsx)(iu,{className:"w-7 h-7"}),"Cronograma Semanal"]}),(0,k.jsxs)("p",{className:"text-blue-100 mt-2",children:["In\xedcio: ",new Date(i.dataInicio+"T00:00:00").toLocaleDateString("pt-BR",{day:"2-digit",month:"long",year:"numeric"})]})]}),(0,k.jsx)("button",{onClick:o,className:"text-white hover:bg-white hover:bg-opacity-20 p-2 rounded-lg transition-colors",children:(0,k.jsx)(Id,{className:"w-6 h-6"})})]}),(0,k.jsxs)("div",{className:"mt-6",children:[(0,k.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,k.jsx)("span",{className:"text-sm font-medium",children:"Progresso Geral"}),(0,k.jsxs)("span",{className:"text-sm font-bold",children:[N.concluidas," / ",N.total," tarefas"]})]}),(0,k.jsx)("div",{className:"w-full bg-white bg-opacity-20 rounded-full h-3 overflow-hidden",children:(0,k.jsx)("div",{className:"bg-white h-full rounded-full transition-all duration-500 shadow-lg",style:{width:"".concat(j,"%")}})}),(0,k.jsxs)("p",{className:"text-xs text-blue-100 mt-1",children:[j.toFixed(0),"% conclu\xeddo"]})]})]}),(0,k.jsxs)("div",{className:"flex-1 overflow-hidden flex",children:[(0,k.jsx)("div",{className:"w-48 bg-gray-50 dark:bg-gray-800 border-r border-gray-200 dark:border-gray-700 overflow-y-auto",children:(0,k.jsxs)("div",{className:"p-3",children:[(0,k.jsx)("h3",{className:"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase mb-2 px-2",children:"Dias da Semana"}),p.map(e=>{const t=u[e.key]||[],r=t.filter(e=>e.concluida).length,a=t.length,n=e.key===c;return(0,k.jsxs)("button",{onClick:()=>f(e.key),className:"w-full text-left px-3 py-3 rounded-lg mb-2 transition-all ".concat(m===e.key?"bg-gradient-to-r from-[#1D9BF0] to-[#1A8CD8] text-white shadow-md":n?"bg-[#1D9BF0]/10 dark:bg-[#1D9BF0]/20 text-[#1D9BF0] hover:bg-[#1D9BF0]/20 dark:hover:bg-[#1D9BF0]/30":"bg-white dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-600"),children:[(0,k.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,k.jsx)("span",{className:"font-medium text-sm",children:e.label}),n&&(0,k.jsx)("span",{className:"text-xs font-bold ".concat(m===e.key?"text-white":"text-[#1D9BF0]"),children:"HOJE"})]}),(0,k.jsxs)("div",{className:"flex items-center justify-between",children:[(0,k.jsx)("span",{className:"text-xs opacity-80",children:b(e.key)}),(0,k.jsxs)("span",{className:"text-xs font-bold ".concat(m===e.key?"text-white":a===r&&a>0?"text-green-600 dark:text-green-400":"text-gray-500 dark:text-gray-400"),children:[r,"/",a]})]}),a>0&&(0,k.jsx)("div",{className:"mt-2 w-full bg-white dark:bg-gray-600 bg-opacity-30 rounded-full h-1",children:(0,k.jsx)("div",{className:"h-full rounded-full transition-all ".concat(m===e.key?"bg-white":"bg-[#1D9BF0]"),style:{width:"".concat(r/a*100,"%")}})})]},e.key)})]})}),(0,k.jsxs)("div",{className:"flex-1 overflow-y-auto p-6 bg-white dark:bg-gray-900",children:[(0,k.jsxs)("div",{className:"mb-6",children:[(0,k.jsx)("h3",{className:"text-2xl font-bold text-gray-800 dark:text-gray-100",children:null===(r=p.find(e=>e.key===m))||void 0===r?void 0:r.labelCompleto}),(0,k.jsxs)("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:[b(m)," \u2022 ",(null===(a=u[m])||void 0===a?void 0:a.length)||0," tarefas"]})]}),!v(m)&&(0,k.jsxs)("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-700 rounded-lg p-4 mb-4 flex items-start gap-3",children:[(0,k.jsx)(w,{className:"w-5 h-5 text-yellow-600 dark:text-yellow-400 flex-shrink-0 mt-0.5"}),(0,k.jsxs)("div",{children:[(0,k.jsx)("p",{className:"font-medium text-yellow-800 dark:text-yellow-300",children:"Tarefas bloqueadas"}),(0,k.jsx)("p",{className:"text-sm text-yellow-700 dark:text-yellow-400 mt-1",children:"Voc\xea s\xf3 pode iniciar as tarefas deste dia quando chegar a data programada."})]})]}),(0,k.jsx)("div",{className:"space-y-3",children:u[m]&&0!==u[m].length?u[m].map((e,t)=>{const r=x[e.prioridade]||x.media,a=v(m);return(0,k.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border-2 transition-all ".concat(e.concluida?"border-green-300 dark:border-green-700 bg-green-50 dark:bg-green-900/20":a?"border-gray-200 dark:border-gray-700 hover:border-[#1D9BF0] dark:hover:border-[#1D9BF0] hover:shadow-md":"border-gray-200 dark:border-gray-700 opacity-60"),children:(0,k.jsx)("div",{className:"p-5",children:(0,k.jsxs)("div",{className:"flex items-start gap-4",children:[(0,k.jsx)("button",{onClick:()=>a&&y(m,e.id),disabled:!a,className:"flex-shrink-0 mt-1 ".concat(a?"cursor-pointer":"cursor-not-allowed opacity-50"),children:e.concluida?(0,k.jsx)(Fd,{className:"w-7 h-7 text-green-600 dark:text-green-400"}):(0,k.jsx)(xS,{className:"w-7 h-7 ".concat(a?"text-gray-400 dark:text-gray-500 hover:text-[#1D9BF0]":"text-gray-300 dark:text-gray-600")})}),(0,k.jsxs)("div",{className:"flex-1",children:[(0,k.jsx)("div",{className:"flex items-start justify-between gap-3 mb-3",children:(0,k.jsxs)("div",{className:"flex-1",children:[(0,k.jsx)("h4",{className:"font-semibold text-lg ".concat(e.concluida?"text-gray-500 dark:text-gray-400 line-through":"text-gray-800 dark:text-gray-100"),children:e.titulo}),e.descricao&&(0,k.jsx)("p",{className:"text-sm mt-1 ".concat(e.concluida?"text-gray-400 dark:text-gray-500":"text-gray-600 dark:text-gray-400"),children:e.descricao})]})}),(0,k.jsxs)("div",{className:"flex items-center gap-3 flex-wrap",children:[(0,k.jsxs)("div",{className:"flex items-center gap-1.5 text-gray-600",children:[(0,k.jsx)(xu,{className:"w-4 h-4"}),(0,k.jsx)("span",{className:"text-sm font-medium",children:e.horario})]}),(0,k.jsx)("span",{className:"px-3 py-1 rounded-full text-xs font-medium border ".concat(r.color),children:r.label}),e.tipo&&(0,k.jsx)("span",{className:"px-3 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-700",children:e.tipo}),e.concluida&&(0,k.jsxs)("span",{className:"ml-auto px-3 py-1 rounded-full text-xs font-bold bg-green-600 text-white flex items-center gap-1",children:[(0,k.jsx)(Fd,{className:"w-3 h-3"}),"Conclu\xedda"]})]}),!e.concluida&&a&&(0,k.jsxs)("button",{onClick:()=>y(m,e.id),className:"mt-3 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm font-medium flex items-center gap-2",children:[(0,k.jsx)(Fd,{className:"w-4 h-4"}),"Marcar como Conclu\xedda"]})]})]})})},e.id)}):(0,k.jsxs)("div",{className:"text-center py-16 bg-gray-50 dark:bg-gray-800 rounded-xl border-2 border-dashed border-gray-300 dark:border-gray-600",children:[(0,k.jsx)(iu,{className:"w-16 h-16 text-gray-300 dark:text-gray-600 mx-auto mb-3"}),(0,k.jsx)("p",{className:"text-gray-500 dark:text-gray-400 text-lg font-medium",children:"Nenhuma tarefa programada"}),(0,k.jsx)("p",{className:"text-gray-400 dark:text-gray-500 text-sm mt-1",children:"Este dia est\xe1 livre!"})]})})]})]}),(0,k.jsx)("div",{className:"bg-gray-50 p-4 border-t border-gray-200",children:(0,k.jsxs)("div",{className:"flex justify-between items-center",children:[(0,k.jsx)("div",{className:"text-sm text-gray-600",children:(0,k.jsxs)("span",{className:"font-medium",children:[N.concluidas," de ",N.total," tarefas conclu\xeddas"]})}),(0,k.jsx)("button",{onClick:o,className:"px-6 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors",children:"Fechar"})]})})]})})},vS=()=>{const[t,r]=(0,e.useState)([]),[a,i]=(0,e.useState)(null),{usuario:o}=Nt();(0,e.useEffect)(()=>{if(!o)return;const e=(0,s.P)((0,s.collection)(P.db,"cronogramasSemanais"),(0,s._M)("funcionariosIds","array-contains",o.id),(0,s._M)("status","==","ativo")),t=(0,s.aQ)(e,e=>{const t=e.docs.map(e=>(0,n.A)({id:e.id},e.data()));r(t)});return()=>t()},[o]);return 0===t.length?null:(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)("div",{className:"space-y-4",children:t.map(e=>{const t=(e=>{let t=0,r=0;return Object.values(e.tarefasPorDia||{}).forEach(e=>{t+=e.length,r+=e.filter(e=>e.concluida).length}),{total:t,concluidas:r}})(e),r=t.total>0?t.concluidas/t.total*100:0,a=(e=>{var t;const r=["domingo","segunda","terca","quarta","quinta","sexta","sabado"][(new Date).getDay()];return(null===(t=e.tarefasPorDia)||void 0===t?void 0:t[r])||[]})(e),n=new Date(e.dataInicio+"T00:00:00");return(0,k.jsxs)("div",{onClick:()=>i(e),className:"bg-gradient-to-br from-[#1D9BF0] via-[#1A8CD8] to-[#1779BE] dark:from-[#1D9BF0] dark:via-[#1A8CD8] dark:to-[#1779BE] rounded-xl shadow-lg hover:shadow-xl transition-all cursor-pointer p-6 text-white",children:[(0,k.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,k.jsxs)("div",{className:"flex items-center gap-3",children:[(0,k.jsx)("div",{className:"w-12 h-12 bg-white bg-opacity-20 dark:bg-white dark:bg-opacity-30 rounded-xl flex items-center justify-center",children:(0,k.jsx)(iu,{className:"w-7 h-7"})}),(0,k.jsxs)("div",{children:[(0,k.jsx)("h3",{className:"text-xl font-bold",children:"Cronograma Semanal"}),(0,k.jsxs)("p",{className:"text-blue-100 dark:text-blue-100 text-sm",children:["In\xedcio: ",n.toLocaleDateString("pt-BR",{day:"2-digit",month:"short"})]})]})]}),(0,k.jsx)(xN,{className:"w-6 h-6"})]}),(0,k.jsxs)("div",{className:"mb-4",children:[(0,k.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,k.jsx)("span",{className:"text-sm font-medium",children:"Progresso Semanal"}),(0,k.jsxs)("span",{className:"text-sm font-bold",children:[t.concluidas," / ",t.total]})]}),(0,k.jsx)("div",{className:"w-full bg-white bg-opacity-20 dark:bg-white dark:bg-opacity-30 rounded-full h-2.5",children:(0,k.jsx)("div",{className:"bg-white dark:bg-white h-full rounded-full transition-all duration-500 shadow-md",style:{width:"".concat(r,"%")}})}),(0,k.jsxs)("p",{className:"text-xs text-blue-100 dark:text-blue-100 mt-1",children:[r.toFixed(0),"% conclu\xeddo"]})]}),a.length>0&&(0,k.jsxs)("div",{className:"bg-white bg-opacity-10 dark:bg-white dark:bg-opacity-20 rounded-lg p-4 backdrop-blur-sm",children:[(0,k.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,k.jsx)(xu,{className:"w-4 h-4"}),(0,k.jsx)("span",{className:"font-semibold text-sm",children:"Tarefas de Hoje"}),(0,k.jsxs)("span",{className:"ml-auto bg-white bg-opacity-20 dark:bg-white dark:bg-opacity-30 px-2 py-0.5 rounded-full text-xs font-bold",children:[a.filter(e=>e.concluida).length," / ",a.length]})]}),(0,k.jsxs)("div",{className:"space-y-2",children:[a.slice(0,3).map((e,t)=>(0,k.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[e.concluida?(0,k.jsx)(Fd,{className:"w-4 h-4 flex-shrink-0"}):(0,k.jsx)("div",{className:"w-4 h-4 border-2 border-white rounded-full flex-shrink-0"}),(0,k.jsx)("span",{className:e.concluida?"line-through opacity-70":"",children:e.titulo})]},e.id)),a.length>3&&(0,k.jsxs)("p",{className:"text-xs opacity-75 ml-6",children:["+",a.length-3," mais ",a.length-3===1?"tarefa":"tarefas"]})]})]}),(0,k.jsxs)("div",{className:"mt-4 pt-4 border-t border-white border-opacity-20 dark:border-white dark:border-opacity-30 flex items-center justify-between",children:[(0,k.jsx)("span",{className:"text-sm font-medium",children:"Ver cronograma completo"}),(0,k.jsx)("div",{className:"w-8 h-8 bg-white bg-opacity-20 dark:bg-white dark:bg-opacity-30 rounded-full flex items-center justify-center",children:(0,k.jsx)(xN,{className:"w-5 h-5"})})]})]},e.id)})}),a&&(0,k.jsx)(yS,{cronograma:a,onClose:()=>i(null),onAtualizar:()=>{}})]})},bS=e=>{const t=20*(e.ferramentasDevolvidas||0),r=50*(e.tarefasConcluidas||0),a=e.mediaEstrelas?Math.round(10*e.mediaEstrelas):0;return{total:t+r+a,detalhes:{ferramentas:t,tarefas:r,avaliacao:a}}},wS=()=>{const{usuario:t}=Nt(),{funcionarios:r}=(eu(),or()),[a,i]=(0,e.useState)(null),o=r.find(e=>{var r,a;const n=e.email&&(null===t||void 0===t?void 0:t.email)&&e.email.toLowerCase()===t.email.toLowerCase(),s=e.id===(null===t||void 0===t?void 0:t.id),i=e.id===(null===t||void 0===t?void 0:t.uid),o=String(e.id)===String(null===t||void 0===t?void 0:t.id),l=(null===(r=String(e.email))||void 0===r?void 0:r.toLowerCase())===(null===(a=String(null===t||void 0===t?void 0:t.email))||void 0===a?void 0:a.toLowerCase()),c=e.nome&&(null===t||void 0===t?void 0:t.nome)&&e.nome.toLowerCase()===t.nome.toLowerCase();return!!(n||s||i||o||l||c)&&(console.log("\ud83c\udfaf Match encontrado para funcion\xe1rio:",{funcionario:e.nome,email:e.email,id:e.id,photoURL:e.photoURL,matchType:n?"email":s?"id":i?"uid":o?"stringId":l?"stringEmail":"nome"}),!0)});(0,e.useEffect)(()=>{if(o)return i(o),void console.log("\u2705 Usando dados do FuncionariosProvider:",o);if(null===t||void 0===t||!t.email)return;console.log("\u26a0\ufe0f funcionarioInfo n\xe3o encontrado no contexto, buscando diretamente do Firestore..."),console.log("Buscando por email:",t.email,"ID:",t.id);const e=(0,s.aQ)((0,s.P)((0,s.collection)(P.db,"funcionarios"),(0,s._M)("email","==",t.email)),e=>{if(e.empty)console.log('\u26a0\ufe0f N\xe3o encontrado em "funcionarios", tentando "usuario"...');else{const t=(0,n.A)({id:e.docs[0].id},e.docs[0].data());console.log('\u2705 Dados encontrados em "funcionarios":',t),i(t)}}),r=(0,s.aQ)((0,s.doc)(P.db,"usuario",t.id),e=>{if(e.exists()){const t=(0,n.A)({id:e.id},e.data());console.log('\u2705 Dados encontrados em "usuario":',t),i(e=>e||t)}else console.log('\u274c Nenhum dado encontrado em "usuario"')});return()=>{e(),r()}},[null===t||void 0===t?void 0:t.email,o]);const l=o||a;(0,e.useEffect)(()=>{const e=(null===l||void 0===l?void 0:l.photoURL)||(null===t||void 0===t?void 0:t.photoURL);console.log("\ud83d\udc64 USU\xc1RIO LOGADO (ProfileTab):",{id:null===t||void 0===t?void 0:t.id,nome:null===t||void 0===t?void 0:t.nome,email:null===t||void 0===t?void 0:t.email,funcionarioInfo:o,dadosFuncionario:a,dadosExibicao:l,cargo_funcionarioInfo:null===o||void 0===o?void 0:o.cargo,cargo_dadosFuncionario:null===a||void 0===a?void 0:a.cargo,cargo_dadosExibicao:null===l||void 0===l?void 0:l.cargo,photoURL_funcionarioInfo:null===o||void 0===o?void 0:o.photoURL,photoURL_dadosFuncionario:null===a||void 0===a?void 0:a.photoURL,photoURL_dadosExibicao:null===l||void 0===l?void 0:l.photoURL,photoURL_usuario:null===t||void 0===t?void 0:t.photoURL,"\ud83d\uddbc\ufe0f FOTO QUE SER\xc1 EXIBIDA":e||"Nenhuma foto dispon\xedvel"}),e||(console.warn("\u26a0\ufe0f Nenhuma foto encontrada para o usu\xe1rio:",null===t||void 0===t?void 0:t.nome),console.warn("Verifique se o funcion\xe1rio tem photoURL cadastrado no Firestore"))},[l,r,t,o,a]);const[c,d]=(0,e.useState)("inventario"),[u,h]=(0,e.useState)([]),[m,f]=(0,e.useState)(""),[g,p]=(0,e.useState)({tarefasConcluidas:0,ferramentasEmprestadas:0,ferramentasDevolvidas:0,mediaEstrelas:0,totalAvaliacoes:0,pontos:{total:0,detalhes:{ferramentas:0,tarefas:0,avaliacao:0}}}),[x,y]=(0,e.useState)([]),[v,b]=(0,e.useState)(!1);Tt(null===t||void 0===t?void 0:t.nivel);(0,e.useEffect)(()=>{if(null===t||void 0===t||!t.id)return;console.log("Buscando cargo do funcion\xe1rio:",t.id);const e=(0,s.aQ)((0,s.P)((0,s.collection)(P.db,"funcionarios"),(0,s._M)("id","==",String(t.id))),e=>{if(e.empty)console.log("Funcion\xe1rio n\xe3o encontrado na cole\xe7\xe3o"),f("");else{const t=e.docs[0].data();console.log("Dados do funcion\xe1rio encontrados:",t),f(t.cargo||"")}});return()=>e()},[null===t||void 0===t?void 0:t.id]);return(0,e.useEffect)(()=>{if(null===t||void 0===t||!t.id)return void console.log("ID do usu\xe1rio n\xe3o dispon\xedvel ainda");console.log("Carregando avalia\xe7\xf5es para usu\xe1rio:",t.id);const e=(0,s.collection)(P.db,"avaliacoes"),r=(0,s.P)(e,(0,s._M)("funcionarioId","==",String(t.id)),(0,s._M)("status","==","ativa")),a=(0,s.aQ)(r,e=>{console.log("Snapshot de avalia\xe7\xf5es recebido:",e.size,"documentos");const t=e.docs.map(e=>{const t=e.data();return(0,n.A)((0,n.A)({id:e.id},t),{},{estrelas:Number(t.estrelas),data:t.data})});console.log("Avalia\xe7\xf5es processadas:",t);const r=t.sort((e,t)=>new Date(t.data)-new Date(e.data));if(y(r),t.length>0){const e=t.reduce((e,t)=>e+t.estrelas,0),r=e/t.length;console.log("Atualizando estat\xedsticas:",{mediaEstrelas:r,totalAvaliacoes:t.length,somaEstrelas:e}),p(e=>(0,n.A)((0,n.A)({},e),{},{mediaEstrelas:r,totalAvaliacoes:t.length}))}else console.log("Nenhuma avalia\xe7\xe3o encontrada"),p(e=>(0,n.A)((0,n.A)({},e),{},{mediaEstrelas:0,totalAvaliacoes:0}))},e=>{console.error("Erro ao carregar avalia\xe7\xf5es:",e)});return()=>a()},[null===t||void 0===t?void 0:t.id]),(0,e.useEffect)(()=>{if(console.log("Iniciando carregamento de empr\xe9stimos para usu\xe1rio:",null===t||void 0===t?void 0:t.id),null===t||void 0===t||!t.id)return void console.log("ID do usu\xe1rio n\xe3o dispon\xedvel ainda");const e=(0,s.aQ)((0,s.P)((0,s.collection)(P.db,"emprestimos"),(0,s._M)("funcionarioId","==",String(t.id))),e=>{const t=e.docs.map(e=>(0,n.A)({id:e.id},e.data()));console.log("Empr\xe9stimos encontrados:",t.length),console.log("Detalhes dos empr\xe9stimos:",t),h(t)});return()=>e()},[t.id]),(0,e.useEffect)(()=>{(async()=>{try{console.log("Buscando estat\xedsticas para usu\xe1rio:",t);const e=(0,s.collection)(P.db,"tarefas"),r=(0,s.P)(e,(0,s._M)("funcionariosIds","array-contains",t.nome)),a=await(0,s.GG)(r);let i=0,o=0,l=0;console.log("Total de tarefas encontradas:",a.size),a.forEach(e=>{const t=e.data();console.log("Tarefa encontrada:",t),"concluida"===t.status&&(i++,t.avaliacaoSupervisor&&(console.log("Avalia\xe7\xe3o encontrada:",t.avaliacaoSupervisor),o+=Number(t.avaliacaoSupervisor),l++))}),console.log("Tarefas conclu\xeddas:",i),console.log("Total avalia\xe7\xf5es:",l),console.log("Soma estrelas:",o);const c=(0,s.collection)(P.db,"emprestimos"),d=(0,s.P)(c,(0,s._M)("funcionarioId","==",String(t.id))),u=await(0,s.GG)(d);let h=0;u.forEach(e=>{const t=e.data();var r;(console.log("Empr\xe9stimo encontrado:",t),"ativo"===t.status||"emprestado"===t.status)&&(h+=(null===(r=t.ferramentas)||void 0===r?void 0:r.length)||0)}),console.log("Ferramentas emprestadas:",h);const m=l>0?o/l:0;let f=0;u.forEach(e=>{const t=e.data();var r;"devolvido"===t.status&&(f+=(null===(r=t.ferramentas)||void 0===r?void 0:r.length)||0)});const g={tarefasConcluidas:i,ferramentasEmprestadas:h,ferramentasDevolvidas:f,mediaEstrelas:m,totalAvaliacoes:l},x=bS({tarefasConcluidas:i,ferramentasDevolvidas:f,mediaEstrelas:m});p((0,n.A)((0,n.A)({},g),{},{pontos:x}))}catch(e){console.error("Erro ao buscar estat\xedsticas:",e)}})()},[t.id]),(0,k.jsxs)("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:[(0,k.jsxs)("div",{className:"relative",children:[(0,k.jsxs)("div",{className:"h-48 bg-gradient-to-br from-blue-500 via-sky-500 to-purple-600 relative overflow-hidden",children:[(0,k.jsx)("div",{className:"absolute inset-0 bg-gradient-to-t from-black/20 to-transparent"}),(0,k.jsx)("div",{className:"absolute top-0 right-0 w-96 h-96 bg-white/10 rounded-full blur-3xl -translate-y-1/2 translate-x-1/2"}),(0,k.jsx)("div",{className:"absolute bottom-0 left-0 w-64 h-64 bg-purple-500/20 rounded-full blur-2xl translate-y-1/2 -translate-x-1/4"}),(0,k.jsx)("div",{className:"absolute inset-0 opacity-10",style:{backgroundImage:"radial-gradient(circle, white 1px, transparent 1px)",backgroundSize:"20px 20px"}})]}),(0,k.jsx)("div",{className:"absolute -bottom-16 left-8",children:(0,k.jsx)("div",{className:"relative group",children:(0,k.jsx)("div",{className:"w-32 h-32 rounded-full border-4 border-white dark:border-gray-900 bg-gradient-to-br from-gray-100 to-gray-200 dark:from-gray-700 dark:to-gray-800 flex items-center justify-center overflow-hidden shadow-2xl transform transition-transform duration-300 group-hover:scale-105",children:null!==l&&void 0!==l&&l.photoURL||null!==t&&void 0!==t&&t.photoURL?(0,k.jsx)("img",{src:(null===l||void 0===l?void 0:l.photoURL)||(null===t||void 0===t?void 0:t.photoURL),alt:(null===t||void 0===t?void 0:t.nome)||"Usu\xe1rio",className:"w-full h-full object-cover",onError:e=>{console.error("Erro ao carregar foto:",e.target.src),e.target.style.display="none"}}):(0,k.jsx)(ak,{className:"w-20 h-20 text-gray-400"})})})})]}),(0,k.jsx)("div",{className:"mt-20 px-6",children:(0,k.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-6 shadow-xl border border-gray-100 dark:border-gray-700",children:(0,k.jsx)("div",{className:"flex items-start justify-between",children:(0,k.jsxs)("div",{className:"flex-1",children:[(0,k.jsx)("h2",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-2",children:t.nome}),(0,k.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,k.jsx)("span",{className:"px-3 py-1.5 rounded-full bg-blue-500 text-white text-sm font-semibold shadow-md",children:(null===l||void 0===l?void 0:l.cargo)||"N/A"}),((null===l||void 0===l?void 0:l.setor)||t.setorNome)&&(0,k.jsx)("span",{className:"px-3 py-1.5 rounded-full bg-purple-500 text-white text-sm font-semibold shadow-md",children:(null===l||void 0===l?void 0:l.setor)||t.setorNome})]}),(t.empresaNome||t.setorNome)&&(0,k.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 mb-4",children:[t.empresaNome&&(0,k.jsxs)("div",{className:"flex items-center gap-3 p-3 bg-gray-50 dark:bg-gray-900/50 rounded-xl",children:[(0,k.jsx)("div",{className:"bg-blue-500 p-2 rounded-lg",children:(0,k.jsx)(Wb,{className:"w-4 h-4 text-white"})}),(0,k.jsxs)("div",{children:[(0,k.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Empresa"}),(0,k.jsx)("p",{className:"text-sm font-semibold text-gray-900 dark:text-white",children:t.empresaNome})]})]}),t.setorNome&&(0,k.jsxs)("div",{className:"flex items-center gap-3 p-3 bg-gray-50 dark:bg-gray-900/50 rounded-xl",children:[(0,k.jsx)("div",{className:"bg-purple-500 p-2 rounded-lg",children:(0,k.jsx)(uk,{className:"w-4 h-4 text-white"})}),(0,k.jsxs)("div",{children:[(0,k.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Setor"}),(0,k.jsx)("p",{className:"text-sm font-semibold text-gray-900 dark:text-white",children:t.setorNome})]})]})]}),(0,k.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-500 dark:text-gray-400 bg-gray-50 dark:bg-gray-900/50 px-3 py-2 rounded-lg w-fit",children:[(0,k.jsx)(iu,{className:"w-4 h-4"}),(0,k.jsxs)("span",{children:["Membro desde ",hb(new Date(t.dataCriacao||Date.now()),"MMMM yyyy",{locale:yb})]})]})]})})})}),(0,k.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mt-6 px-6",children:[(0,k.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-6 shadow-lg border border-gray-100 dark:border-gray-700 hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1",children:[(0,k.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,k.jsx)("div",{className:"bg-gradient-to-br from-green-400 to-emerald-500 p-3 rounded-xl shadow-lg",children:(0,k.jsx)(Fd,{className:"w-6 h-6 text-white"})}),(0,k.jsx)("span",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:g.tarefasConcluidas})]}),(0,k.jsx)("p",{className:"text-sm font-semibold text-gray-600 dark:text-gray-400",children:"Tarefas Conclu\xeddas"}),(0,k.jsx)("div",{className:"mt-2 h-2 bg-gray-100 dark:bg-gray-700 rounded-full overflow-hidden",children:(0,k.jsx)("div",{className:"h-full bg-gradient-to-r from-green-400 to-emerald-500 rounded-full",style:{width:"75%"}})})]}),(0,k.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-6 shadow-lg border border-gray-100 dark:border-gray-700 hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1",children:[(0,k.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,k.jsx)("div",{className:"bg-gradient-to-br from-blue-400 to-sky-500 p-3 rounded-xl shadow-lg",children:(0,k.jsx)(Md,{className:"w-6 h-6 text-white"})}),(0,k.jsx)("span",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:g.ferramentasEmprestadas})]}),(0,k.jsx)("p",{className:"text-sm font-semibold text-gray-600 dark:text-gray-400",children:"Ferramentas Emprestadas"}),(0,k.jsx)("div",{className:"mt-2 h-2 bg-gray-100 dark:bg-gray-700 rounded-full overflow-hidden",children:(0,k.jsx)("div",{className:"h-full bg-gradient-to-r from-blue-400 to-sky-500 rounded-full",style:{width:"60%"}})})]}),(0,k.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-6 shadow-lg border border-gray-100 dark:border-gray-700 hover:shadow-xl transition-all duration-300 transform hover:-translate-y-1",children:[(0,k.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,k.jsx)("div",{className:"bg-gradient-to-br from-yellow-400 to-orange-500 p-3 rounded-xl shadow-lg",children:(0,k.jsx)(Ld,{className:"w-6 h-6 text-white"})}),(0,k.jsx)("span",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:g.mediaEstrelas.toFixed(1)})]}),(0,k.jsxs)("p",{className:"text-sm font-semibold text-gray-600 dark:text-gray-400",children:[g.totalAvaliacoes," ",1===g.totalAvaliacoes?"Avalia\xe7\xe3o":"Avalia\xe7\xf5es"]}),(0,k.jsx)("div",{className:"mt-2 flex gap-1",children:[1,2,3,4,5].map(e=>(0,k.jsx)(Ld,{className:"w-3 h-3 ".concat(e<=Math.round(g.mediaEstrelas)?"fill-yellow-400 text-yellow-400":"text-gray-300 dark:text-gray-600")},e))})]})]}),(0,k.jsx)("div",{className:"mt-6 px-6",children:(0,k.jsxs)("div",{className:"rounded-2xl p-6 shadow-2xl border border-blue-400/50",style:{backgroundColor:"#1988d3"},children:[(0,k.jsx)("div",{className:"flex items-center justify-between mb-4",children:(0,k.jsxs)("div",{className:"flex items-center gap-3",children:[(0,k.jsx)("div",{className:"bg-white/20 backdrop-blur-sm p-3 rounded-xl",children:(0,k.jsx)(nu,{className:"w-7 h-7 text-white"})}),(0,k.jsxs)("div",{children:[(0,k.jsx)("p",{className:"text-white/80 text-sm font-medium",children:"Detalhamento de Pontos"}),(0,k.jsxs)("p",{className:"text-3xl font-bold text-white",children:[g.pontos.total," pontos"]})]})]})}),(0,k.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[(0,k.jsxs)("div",{className:"bg-white/10 backdrop-blur-sm rounded-xl p-4 border border-white/20",children:[(0,k.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,k.jsx)(Md,{className:"w-4 h-4 text-white"}),(0,k.jsx)("span",{className:"text-xs text-white/80 font-medium",children:"Ferramentas Devolvidas"})]}),(0,k.jsxs)("div",{className:"flex items-baseline gap-1",children:[(0,k.jsx)("span",{className:"text-2xl font-bold text-white",children:g.pontos.detalhes.ferramentas}),(0,k.jsx)("span",{className:"text-sm text-white/60",children:"pts"})]})]}),(0,k.jsxs)("div",{className:"bg-white/10 backdrop-blur-sm rounded-xl p-4 border border-white/20",children:[(0,k.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,k.jsx)(Fd,{className:"w-4 h-4 text-white"}),(0,k.jsx)("span",{className:"text-xs text-white/80 font-medium",children:"Tarefas Conclu\xeddas"})]}),(0,k.jsxs)("div",{className:"flex items-baseline gap-1",children:[(0,k.jsx)("span",{className:"text-2xl font-bold text-white",children:g.pontos.detalhes.tarefas}),(0,k.jsx)("span",{className:"text-sm text-white/60",children:"pts"})]})]}),(0,k.jsxs)("div",{className:"bg-white/10 backdrop-blur-sm rounded-xl p-4 border border-white/20",children:[(0,k.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,k.jsx)(Ld,{className:"w-4 h-4 text-white"}),(0,k.jsx)("span",{className:"text-xs text-white/80 font-medium",children:"Avalia\xe7\xf5es"})]}),(0,k.jsxs)("div",{className:"flex items-baseline gap-1",children:[(0,k.jsx)("span",{className:"text-2xl font-bold text-white",children:g.pontos.detalhes.avaliacao}),(0,k.jsx)("span",{className:"text-sm text-white/60",children:"pts"})]})]})]})]})}),(0,k.jsx)("div",{className:"mt-6 px-6",children:(0,k.jsxs)("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[(0,k.jsxs)("button",{className:"relative overflow-hidden rounded-2xl p-6 transition-all duration-300 transform hover:scale-105 ".concat("inventario"===c?"shadow-xl":"bg-white dark:bg-gray-800 border-2 border-gray-200 dark:border-gray-700"),style:"inventario"===c?{backgroundColor:"#1988d3",boxShadow:"0 20px 25px -5px rgba(25, 136, 211, 0.5), 0 8px 10px -6px rgba(25, 136, 211, 0.5)"}:{},onClick:()=>d("inventario"),children:["inventario"===c&&(0,k.jsx)("div",{className:"absolute inset-0 bg-white/10"}),(0,k.jsxs)("div",{className:"relative flex items-center gap-3",children:[(0,k.jsx)("div",{className:"p-3 rounded-xl ".concat("inventario"===c?"bg-white/20 backdrop-blur-sm":"bg-blue-100 dark:bg-blue-900/30"),children:(0,k.jsx)(Md,{className:"w-6 h-6 ".concat("inventario"===c?"text-white":"text-blue-600 dark:text-blue-400")})}),(0,k.jsxs)("div",{className:"text-left",children:[(0,k.jsx)("h3",{className:"font-bold text-lg ".concat("inventario"===c?"text-white":"text-gray-900 dark:text-white"),children:"Meu Invent\xe1rio"}),(0,k.jsxs)("p",{className:"text-sm ".concat("inventario"===c?"text-white/80":"text-gray-500 dark:text-gray-400"),children:[(null===u||void 0===u?void 0:u.filter(e=>"devolvido"!==e.status).length)||0," ativos"]})]})]})]}),(0,k.jsxs)("button",{className:"relative overflow-hidden rounded-2xl p-6 transition-all duration-300 transform hover:scale-105 ".concat("tarefas"===c?"shadow-xl":"bg-white dark:bg-gray-800 border-2 border-gray-200 dark:border-gray-700"),style:"tarefas"===c?{backgroundColor:"#1988d3",boxShadow:"0 20px 25px -5px rgba(25, 136, 211, 0.5), 0 8px 10px -6px rgba(25, 136, 211, 0.5)"}:{},onClick:()=>d("tarefas"),children:["tarefas"===c&&(0,k.jsx)("div",{className:"absolute inset-0 bg-white/10"}),(0,k.jsxs)("div",{className:"relative flex items-center gap-3",children:[(0,k.jsx)("div",{className:"p-3 rounded-xl ".concat("tarefas"===c?"bg-white/20 backdrop-blur-sm":"bg-blue-100 dark:bg-blue-900/30"),children:(0,k.jsx)(Fd,{className:"w-6 h-6 ".concat("tarefas"===c?"text-white":"text-blue-600 dark:text-blue-400")})}),(0,k.jsxs)("div",{className:"text-left",children:[(0,k.jsx)("h3",{className:"font-bold text-lg ".concat("tarefas"===c?"text-white":"text-gray-900 dark:text-white"),children:"Minhas Tarefas"}),(0,k.jsxs)("p",{className:"text-sm ".concat("tarefas"===c?"text-white/80":"text-gray-500 dark:text-gray-400"),children:[g.tarefasConcluidas," conclu\xeddas"]})]})]})]})]})}),(0,k.jsxs)("div",{className:"px-6 pb-6",children:["inventario"===c&&u&&(0,k.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-6 shadow-lg border border-gray-100 dark:border-gray-700",children:(0,k.jsx)(Vb,{emprestimos:u})}),"tarefas"===c&&(0,k.jsxs)("div",{className:"space-y-6",children:[(0,k.jsx)(vS,{}),(0,k.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-2xl p-6 shadow-lg border border-gray-100 dark:border-gray-700",children:(0,k.jsx)(zk,{funcionarios:r,showOnlyUserTasks:!0,showAddButton:!1,readOnly:!1,userFilter:null===t||void 0===t?void 0:t.nome,defaultFiltros:{status:"todas",periodo:"todos",avaliacao:"todas"}})})]})]})]})},kS=()=>(0,k.jsx)(ir,{children:(0,k.jsx)(wS,{})});function NS(e){return jv(e,Date.now())}function jS(e,t){const r=+Sv(e)-+Sv(t);return r<0?-1:r>0?1:r}function SS(e,t,r){const[a,n]=Ev(null===r||void 0===r?void 0:r.in,e,t);return 12*(a.getFullYear()-n.getFullYear())+(a.getMonth()-n.getMonth())}function _S(e,t){const r=Sv(e,null===t||void 0===t?void 0:t.in);return r.setHours(23,59,59,999),r}function ES(e,t){const r=Sv(e,null===t||void 0===t?void 0:t.in),a=r.getMonth();return r.setFullYear(r.getFullYear(),a+1,0),r.setHours(23,59,59,999),r}function AS(e,t){const r=Sv(e,null===t||void 0===t?void 0:t.in);return+_S(r,t)===+ES(r,t)}function CS(e,t,r){const[a,n,s]=Ev(null===r||void 0===r?void 0:r.in,e,e,t),i=jS(n,s),o=Math.abs(SS(n,s));if(o<1)return 0;1===n.getMonth()&&n.getDate()>27&&n.setDate(30),n.setMonth(n.getMonth()-i*o);let l=jS(n,s)===-i;AS(a)&&1===o&&1===jS(a,s)&&(l=!1);const c=i*(o-+l);return 0===c?0:c}function IS(e,t){return+Sv(e)-+Sv(t)}function TS(e,t,r){const a=IS(e,t)/1e3;return(n=null===r||void 0===r?void 0:r.roundingMethod,e=>{const t=(n?Math[n]:Math.trunc)(e);return 0===t?0:t})(a);var n}function DS(e,t,r){var a,n;const s=bv(),i=null!==(a=null!==(n=null===r||void 0===r?void 0:r.locale)&&void 0!==n?n:s.locale)&&void 0!==a?a:yv,o=jS(e,t);if(isNaN(o))throw new RangeError("Invalid time value");const l=Object.assign({},r,{addSuffix:null===r||void 0===r?void 0:r.addSuffix,comparison:o}),[c,d]=Ev(null===r||void 0===r?void 0:r.in,...o>0?[t,e]:[e,t]),u=TS(d,c),h=(_v(d)-_v(c))/1e3,m=Math.round((u-h)/60);let f;if(m<2)return null!==r&&void 0!==r&&r.includeSeconds?u<5?i.formatDistance("lessThanXSeconds",5,l):u<10?i.formatDistance("lessThanXSeconds",10,l):u<20?i.formatDistance("lessThanXSeconds",20,l):u<40?i.formatDistance("halfAMinute",0,l):u<60?i.formatDistance("lessThanXMinutes",1,l):i.formatDistance("xMinutes",1,l):0===m?i.formatDistance("lessThanXMinutes",1,l):i.formatDistance("xMinutes",m,l);if(m<45)return i.formatDistance("xMinutes",m,l);if(m<90)return i.formatDistance("aboutXHours",1,l);if(m<1440){const e=Math.round(m/60);return i.formatDistance("aboutXHours",e,l)}if(m<2520)return i.formatDistance("xDays",1,l);if(m<kv){const e=Math.round(m/1440);return i.formatDistance("xDays",e,l)}if(m<86400)return f=Math.round(m/kv),i.formatDistance("aboutXMonths",f,l);if(f=CS(d,c),f<12){const e=Math.round(m/kv);return i.formatDistance("xMonths",e,l)}{const e=f%12,t=Math.trunc(f/12);return e<3?i.formatDistance("aboutXYears",t,l):e<9?i.formatDistance("overXYears",t,l):i.formatDistance("almostXYears",t+1,l)}}function PS(e,t){return DS(e,NS(e),t)}const FS=e=>{let{tipo:t}=e;switch(t){case"tarefa":return(0,k.jsx)(fu,{className:"w-5 h-5 text-blue-500"});case"emprestimo":return(0,k.jsx)(Md,{className:"w-5 h-5 text-green-500"});case"ferramenta":return(0,k.jsx)(Md,{className:"w-5 h-5 text-orange-500"});default:return(0,k.jsx)(Od,{className:"w-5 h-5 text-gray-500"})}},LS=t=>{let{onNavigate:r}=t;const{usuario:a}=Nt(),{notifications:i,unreadCount:o,markAsRead:l,markAllAsRead:c,soundEnabled:d,toggleSound:u}=ON(),[h,m]=(0,e.useState)("todas"),[f,g]=(0,e.useState)(!1),[p,x]=(0,e.useState)([]);(0,e.useEffect)(()=>{if(null===a||void 0===a||!a.id)return void console.log("NotificationsPage: Usu\xe1rio n\xe3o autenticado");const e=a.nome||a.id;console.log("NotificationsPage: Buscando tarefas para usu\xe1rio:",{id:a.id,nome:a.nome,email:a.email,buscandoPor:e});const t=(0,s.collection)(P.db,"tarefas"),r=(0,s.P)(t,(0,s._M)("funcionariosIds","array-contains",e)),i=(0,s.aQ)(r,t=>{console.log("NotificationsPage: Snapshot recebido, docs:",t.docs.length),console.log("NotificationsPage: Buscando com crit\xe9rio:",e);const r=t.docs.map(e=>{const t=e.data();return console.log("Tarefa encontrada:",(0,n.A)({id:e.id},t)),(0,n.A)({id:e.id},t)});r.sort((e,t)=>{const r=e.dataCriacao?new Date(e.dataCriacao).getTime():0;return(t.dataCriacao?new Date(t.dataCriacao).getTime():0)-r}),console.log("NotificationsPage: Tarefas ordenadas:",r.length),x(r)},e=>{console.error("NotificationsPage: Erro ao carregar tarefas:",e)});return()=>i()},[a]);const y=e=>{if(!e)return"";try{var t;return PS((null===e||void 0===e||null===(t=e.toDate)||void 0===t?void 0:t.call(e))||new Date(e),{addSuffix:!0,locale:yb})}catch(r){return""}},v=i.filter(e=>"nao-lidas"===h?!e.lida:"tarefa"===h?"tarefa"===e.tipo:"emprestimo"!==h||"emprestimo"===e.tipo),b=e=>{switch(e){case"tarefa":return"Tarefa";case"emprestimo":return"Empr\xe9stimo";case"ferramenta":return"Ferramenta";default:return"Notifica\xe7\xe3o"}};return(0,k.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100 dark:from-gray-900 dark:to-gray-800 p-4",children:(0,k.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,k.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 mb-6",children:[(0,k.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,k.jsxs)("div",{className:"flex items-center gap-3",children:[(0,k.jsx)("div",{className:"p-3 bg-blue-100 dark:bg-blue-900 rounded-full",children:(0,k.jsx)(Od,{className:"w-6 h-6 text-blue-600 dark:text-blue-300"})}),(0,k.jsxs)("div",{children:[(0,k.jsx)("h1",{className:"text-2xl font-bold text-gray-800 dark:text-white",children:"Notifica\xe7\xf5es"}),(0,k.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:o>0?"".concat(o," n\xe3o lida").concat(o>1?"s":""):"Nenhuma notifica\xe7\xe3o n\xe3o lida"})]})]}),(0,k.jsxs)("div",{className:"flex items-center gap-2",children:[(0,k.jsx)("button",{onClick:u,className:"p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",title:d?"Desativar som":"Ativar som",children:d?(0,k.jsx)(cj,{className:"w-5 h-5 text-gray-600 dark:text-gray-400"}):(0,k.jsx)(dj,{className:"w-5 h-5 text-gray-600 dark:text-gray-400"})}),(0,k.jsx)("button",{onClick:()=>g(!f),className:"p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",title:"Filtros",children:(0,k.jsx)(tw,{className:"w-5 h-5 text-gray-600 dark:text-gray-400"})}),o>0&&(0,k.jsxs)("button",{onClick:c,className:"flex items-center gap-2 px-4 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded-lg transition-colors",children:[(0,k.jsx)(qN,{className:"w-4 h-4"}),(0,k.jsx)("span",{className:"hidden sm:inline",children:"Marcar todas como lidas"})]})]})]}),f&&(0,k.jsx)("div",{className:"flex flex-wrap gap-2 pt-4 border-t dark:border-gray-700",children:[{value:"todas",label:"Todas"},{value:"nao-lidas",label:"N\xe3o lidas"},{value:"tarefa",label:"Tarefas"},{value:"emprestimo",label:"Empr\xe9stimos"}].map(e=>{let{value:t,label:r}=e;return(0,k.jsx)("button",{onClick:()=>m(t),className:"px-4 py-2 rounded-lg transition-colors ".concat(h===t?"bg-blue-500 text-white":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"),children:r},t)})})]}),("todas"===h||"tarefa"===h)&&0===p.length&&(0,k.jsxs)("div",{className:"mb-6 bg-gray-50 dark:bg-gray-800/50 rounded-lg p-6 text-center",children:[(0,k.jsx)(fu,{className:"w-12 h-12 text-gray-400 dark:text-gray-600 mx-auto mb-3"}),(0,k.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"Nenhuma tarefa atribu\xedda a voc\xea ainda"})]}),("todas"===h||"tarefa"===h)&&p.length>0&&(0,k.jsxs)("div",{className:"mb-6",children:[(0,k.jsxs)("h2",{className:"text-lg font-bold text-gray-800 dark:text-white mb-3 px-2 flex items-center gap-2",children:[(0,k.jsx)(fu,{className:"w-5 h-5"}),"Suas Tarefas (",p.length,")"]}),(0,k.jsx)("div",{className:"space-y-3",children:p.map(e=>(0,k.jsx)("div",{onClick:()=>{r&&r("tarefas")},className:"bg-white dark:bg-gray-800 rounded-xl shadow hover:shadow-lg transition-all cursor-pointer border-l-4 border-blue-500 hover:scale-[1.01] group",title:"Clique para ir para Tarefas",children:(0,k.jsx)("div",{className:"p-4",children:(0,k.jsxs)("div",{className:"flex items-start gap-4",children:[(0,k.jsx)("div",{className:"flex-shrink-0 p-3 rounded-full bg-blue-100 dark:bg-blue-900",children:(0,k.jsx)(fu,{className:"w-5 h-5 text-blue-600 dark:text-blue-300"})}),(0,k.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,k.jsx)("div",{className:"flex items-start justify-between gap-2 mb-2",children:(0,k.jsxs)("div",{children:[(0,k.jsx)("h3",{className:"font-bold text-lg text-gray-900 dark:text-white mb-1",children:e.titulo}),(0,k.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[(0,k.jsx)("span",{className:"px-2 py-1 text-xs font-semibold rounded-full ".concat("alta"===e.prioridade?"bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-300":"media"===e.prioridade?"bg-yellow-100 dark:bg-yellow-900 text-yellow-700 dark:text-yellow-300":"bg-green-100 dark:bg-green-900 text-green-700 dark:text-green-300"),children:"alta"===e.prioridade?"\ud83d\udd34 Alta":"media"===e.prioridade?"\ud83d\udfe1 M\xe9dia":"\ud83d\udfe2 Baixa"}),(0,k.jsx)("span",{className:"px-2 py-1 text-xs font-semibold rounded-full ".concat("concluida"===e.status?"bg-green-100 dark:bg-green-900 text-green-700 dark:text-green-300":"em_andamento"===e.status?"bg-blue-100 dark:bg-blue-900 text-blue-700 dark:text-blue-300":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300"),children:"concluida"===e.status?"\u2705 Conclu\xedda":"em_andamento"===e.status?"\ud83d\udd04 Em Andamento":"\u23f3 Pendente"})]})]})}),(0,k.jsx)("p",{className:"text-sm text-gray-700 dark:text-gray-300 mb-3 whitespace-pre-wrap",children:e.descricao}),e.funcionarios&&e.funcionarios.length>0&&(0,k.jsxs)("div",{className:"mb-3 flex items-center gap-2 flex-wrap",children:[(0,k.jsx)(uk,{className:"w-4 h-4 text-gray-500 dark:text-gray-400"}),(0,k.jsx)("div",{className:"flex gap-1 flex-wrap",children:e.funcionarios.map((e,t)=>(0,k.jsx)("span",{className:"px-2 py-1 text-xs font-medium bg-blue-50 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 rounded-full border border-blue-200 dark:border-blue-800",children:e.nome},t))})]}),(0,k.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,k.jsxs)("div",{className:"flex items-center gap-4 text-xs text-gray-500 dark:text-gray-400",children:[(0,k.jsxs)("div",{className:"flex items-center gap-1",children:[(0,k.jsx)(xu,{className:"w-3.5 h-3.5"}),(0,k.jsxs)("span",{children:["Criada ",y(e.dataCriacao)]})]}),e.criadoPor&&(0,k.jsxs)("div",{className:"flex items-center gap-1",children:[(0,k.jsx)("span",{children:"por"}),(0,k.jsx)("span",{className:"font-medium text-gray-700 dark:text-gray-300",children:e.criadoPor.nome||"Administrador"})]})]}),(0,k.jsx)(xN,{className:"w-5 h-5 text-gray-400 group-hover:text-blue-500 group-hover:translate-x-1 transition-all"})]})]})]})})},e.id))})]}),(0,k.jsx)("div",{className:"space-y-3",children:0===v.length&&0===p.length?(0,k.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-8 text-center",children:[(0,k.jsx)(Od,{className:"w-16 h-16 text-gray-300 dark:text-gray-600 mx-auto mb-4"}),(0,k.jsx)("p",{className:"text-gray-500 dark:text-gray-400",children:"todas"===h?"Nenhuma notifica\xe7\xe3o ou tarefa ainda":"Nenhuma notifica\xe7\xe3o ".concat("nao-lidas"===h?"n\xe3o lida":'do tipo "'.concat(h,'"'))})]}):v.length>0?(0,k.jsxs)(k.Fragment,{children:[(0,k.jsxs)("h2",{className:"text-lg font-bold text-gray-800 dark:text-white mb-3 px-2 flex items-center gap-2",children:[(0,k.jsx)(Od,{className:"w-5 h-5"}),"Notifica\xe7\xf5es (",v.length,")"]}),v.map(e=>(0,k.jsx)("div",{onClick:()=>(e=>{e.lida||l(e.id),r&&("tarefa"===e.tipo?r("tarefas"):"emprestimo"===e.tipo&&r("emprestimos"))})(e),className:"bg-white dark:bg-gray-800 rounded-xl shadow hover:shadow-lg transition-all cursor-pointer overflow-hidden hover:scale-[1.01] group ".concat(e.lida?"":"border-l-4 border-blue-500"),title:"tarefa"===e.tipo?"Clique para ir para Tarefas":"emprestimo"===e.tipo?"Clique para ir para Empr\xe9stimos":"",children:(0,k.jsx)("div",{className:"p-4",children:(0,k.jsxs)("div",{className:"flex items-start gap-4",children:[(0,k.jsx)("div",{className:"flex-shrink-0 p-3 rounded-full ".concat(e.lida?"bg-gray-100 dark:bg-gray-700":"bg-blue-100 dark:bg-blue-900"),children:(0,k.jsx)(FS,{tipo:e.tipo})}),(0,k.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,k.jsxs)("div",{className:"flex items-start justify-between gap-2 mb-1",children:[(0,k.jsxs)("div",{className:"flex items-center gap-2",children:[(0,k.jsx)("h3",{className:"font-semibold ".concat(e.lida?"text-gray-600 dark:text-gray-400":"text-gray-900 dark:text-white"),children:e.titulo}),(0,k.jsx)("span",{className:"px-2 py-0.5 text-xs font-medium rounded-full bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-400",children:b(e.tipo)})]}),!e.lida&&(0,k.jsx)("div",{className:"w-2 h-2 rounded-full bg-blue-500 flex-shrink-0"})]}),(0,k.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:e.mensagem}),(0,k.jsxs)("div",{className:"flex items-center justify-between",children:[(0,k.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-500",children:y(e.timestamp)}),("tarefa"===e.tipo||"emprestimo"===e.tipo)&&(0,k.jsx)(xN,{className:"w-4 h-4 text-gray-400 group-hover:text-blue-500 group-hover:translate-x-1 transition-all"})]})]})]})})},e.id))]}):null}),i.length>0&&(0,k.jsx)("div",{className:"mt-6 bg-blue-50 dark:bg-blue-900/20 rounded-lg p-4",children:(0,k.jsxs)("div",{className:"flex items-start gap-3",children:[(0,k.jsx)(w,{className:"w-5 h-5 text-blue-500 flex-shrink-0 mt-0.5"}),(0,k.jsxs)("div",{className:"text-sm text-blue-800 dark:text-blue-300",children:[(0,k.jsx)("p",{className:"font-medium mb-1",children:"Sobre as notifica\xe7\xf5es"}),(0,k.jsxs)("ul",{className:"space-y-1 text-blue-700 dark:text-blue-400",children:[(0,k.jsx)("li",{children:"\u2022 Voc\xea receber\xe1 notifica\xe7\xf5es quando novas tarefas forem atribu\xeddas a voc\xea"}),(0,k.jsx)("li",{children:"\u2022 Notifica\xe7\xf5es tamb\xe9m ser\xe3o enviadas quando ferramentas forem emprestadas em seu nome"}),(0,k.jsx)("li",{children:"\u2022 Use os filtros para organizar as notifica\xe7\xf5es por tipo"})]})]})]})})]})})};class MS{constructor(e,t){this.sourceDb=e,this.targetDb=t,this.syncLog=[]}log(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const a={timestamp:(new Date).toISOString(),type:t,message:e,data:r};this.syncLog.push(a);const n={info:"\u2139\ufe0f",success:"\u2705",error:"\u274c",warning:"\u26a0\ufe0f"}[t]||"\u2139\ufe0f";console.log("".concat(n," [FirebaseSync] ").concat(e),r||"")}async copyCollection(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{this.log("Iniciando c\xf3pia da cole\xe7\xe3o: ".concat(e));const{batchSize:a=500,onProgress:n=null,filters:i=[],overwrite:o=!1}=t;let l=(0,s.collection)(this.sourceDb,e);i.forEach(e=>{l=(0,s.P)(l,(0,s._M)(e.field,e.operator,e.value))});const c=await(0,s.GG)(l),d=c.size;if(this.log("".concat(d," documentos encontrados em ").concat(e)),0===d)return this.log("Cole\xe7\xe3o ".concat(e," est\xe1 vazia"),"warning"),{success:!0,copied:0,errors:0};let u=0,h=0,m=(0,s.wP)(this.targetDb),f=0;for(const t of c.docs)try{const r=t.data(),i=(0,s.doc)(this.targetDb,e,t.id);if(!o){if((await(0,s.x7)(i)).exists()){this.log("Documento ".concat(t.id," j\xe1 existe, pulando"),"warning");continue}}m.set(i,r),f++,f>=a&&(await m.commit(),u+=f,this.log("".concat(u,"/").concat(d," documentos copiados"),"success"),n&&n(u,d),m=(0,s.wP)(this.targetDb),f=0)}catch(r){h++,this.log("Erro ao copiar documento ".concat(t.id),"error",r)}return f>0&&(await m.commit(),u+=f),this.log("\u2705 Cole\xe7\xe3o ".concat(e," copiada: ").concat(u," documentos"),"success"),{success:!0,collection:e,total:d,copied:u,errors:h,timestamp:(new Date).toISOString()}}catch(r){return this.log("\u274c Erro ao copiar cole\xe7\xe3o ".concat(e),"error",r),{success:!1,collection:e,error:r.message,timestamp:(new Date).toISOString()}}}async syncCollection(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"dataCriacao";try{this.log("Iniciando sincroniza\xe7\xe3o bidirecional: ".concat(e));const r=(0,s.collection)(this.sourceDb,e),a=(0,s.collection)(this.targetDb,e),[n,i]=await Promise.all([(0,s.GG)(r),(0,s.GG)(a)]),o=new Map,l=new Map;n.forEach(e=>{o.set(e.id,{id:e.id,data:e.data()})}),i.forEach(e=>{l.set(e.id,{id:e.id,data:e.data()})});let c=0,d=0,u=0;for(const[h,m]of o.entries()){const r=l.get(h);if(r){const a=m.data[t],n=r.data[t];this.isNewer(a,n)?(await(0,s.setDoc)((0,s.doc)(this.targetDb,e,h),m.data),u++):this.isNewer(n,a)&&(await(0,s.setDoc)((0,s.doc)(this.sourceDb,e,h),r.data),d++)}else await(0,s.setDoc)((0,s.doc)(this.targetDb,e,h),m.data),c++}for(const[t,h]of l.entries())o.has(t)||(await(0,s.setDoc)((0,s.doc)(this.sourceDb,e,t),h.data),d++);return this.log("\u2705 Sincroniza\xe7\xe3o conclu\xedda: ".concat(e),"success",{copiedToTarget:c,copiedToSource:d,updated:u}),{success:!0,collection:e,copiedToTarget:c,copiedToSource:d,updated:u,total:o.size+l.size,timestamp:(new Date).toISOString()}}catch(r){return this.log("\u274c Erro ao sincronizar ".concat(e),"error",r),{success:!1,collection:e,error:r.message,timestamp:(new Date).toISOString()}}}async copyAllCollections(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.log("Iniciando c\xf3pia de ".concat(e.length," cole\xe7\xf5es"));const r=[];let a=0;for(const s of e){a++,t&&t(a,e.length,s);const n=await this.copyCollection(s,{onProgress:(r,n)=>{t&&t(a,e.length,s,r,n)}});r.push(n),await new Promise(e=>setTimeout(e,1e3))}const n={total:r.length,successful:r.filter(e=>e.success).length,failed:r.filter(e=>!e.success).length,totalCopied:r.reduce((e,t)=>e+(t.copied||0),0),totalErrors:r.reduce((e,t)=>e+(t.errors||0),0),results:r,timestamp:(new Date).toISOString()};return this.log("\u2705 Backup completo conclu\xeddo","success",n),n}async syncAllCollections(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.log("Iniciando sincroniza\xe7\xe3o de ".concat(e.length," cole\xe7\xf5es"));const r=[];let a=0;for(const s of e){a++,t&&t(a,e.length,s);const n=await this.syncCollection(s);r.push(n),await new Promise(e=>setTimeout(e,1e3))}const n={total:r.length,successful:r.filter(e=>e.success).length,failed:r.filter(e=>!e.success).length,totalSynced:r.reduce((e,t)=>e+(t.copiedToTarget||0)+(t.copiedToSource||0),0),results:r,timestamp:(new Date).toISOString()};return this.log("\u2705 Sincroniza\xe7\xe3o completa conclu\xedda","success",n),n}isNewer(e,t){if(!e)return!1;if(!t)return!0;return(e instanceof s.Dc?e.toDate():new Date(e))>(t instanceof s.Dc?t.toDate():new Date(t))}getLog(){return this.syncLog}clearLog(){this.syncLog=[]}}const RS=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{autoRotate:r=!0,rotationInterval:a=864e5,syncOnRotation:s=!0,collections:i=["usuarios","mensagens","notificacoes","tarefas","emprestimos","inventario","empresas","setores","cargos","presenca","horarios","folgas","configuracoes"],onRotationStart:o=null,onRotationComplete:l=null,onSyncProgress:c=null,onError:d=null}=t,[u,h]=(0,e.useState)(nr.activeDatabase),[m,f]=(0,e.useState)(!1),[g,p]=(0,e.useState)(!1),[x,y]=(0,e.useState)(nr.lastRotation),[v,b]=(0,e.useState)(null),[w,k]=(0,e.useState)(null),[N,j]=(0,e.useState)([]),S=(0,e.useRef)(null),_=(0,e.useRef)(null),E=(0,e.useCallback)(()=>{const e=new Date(x.getTime()+a);return b(e),e},[x,a]),A=(0,e.useCallback)(async()=>{try{p(!0),k({current:0,total:i.length,collection:null});const e="primary"===u?Xt:Jt,t="primary"===u?Jt:Xt;_.current||(_.current=((e,t)=>new MS(e,t))(e,t)),console.log("\ud83d\udd04 Iniciando sincroniza\xe7\xe3o: ".concat(u," \u2192 ").concat("primary"===u?"backup":"primary"));const r=await _.current.syncAllCollections(i,(e,t,r)=>{k({current:e,total:t,collection:r,percentage:Math.round(e/t*100)}),c&&c(e,t,r)});return console.log("\u2705 Sincroniza\xe7\xe3o conclu\xedda:",r),r}catch(e){throw console.error("\u274c Erro na sincroniza\xe7\xe3o:",e),d&&d(e),e}finally{p(!1),k(null)}},[u,i,c,d]),C=(0,e.useCallback)(async()=>{if(m)console.warn("\u26a0\ufe0f Rota\xe7\xe3o j\xe1 em andamento");else try{f(!0),o&&o(u),console.log("\ud83d\udd04 Iniciando rota\xe7\xe3o do database: ".concat(u));let e=null;s&&(e=await A());const t=nr.switchDatabase();h(t),y(nr.lastRotation);const r={timestamp:(new Date).toISOString(),from:u,to:t,synced:s,syncResult:e};j(e=>[...e,r]);const a=JSON.parse(localStorage.getItem("rotationHistory")||"[]");return a.push(r),a.length>50&&a.shift(),localStorage.setItem("rotationHistory",JSON.stringify(a)),console.log("\u2705 Rota\xe7\xe3o conclu\xedda: ".concat(u," \u2192 ").concat(t)),l&&l(t,r),E(),r}catch(e){throw console.error("\u274c Erro na rota\xe7\xe3o:",e),d&&d(e),e}finally{f(!1)}},[m,u,s,A,o,l,d,E]),I=(0,e.useCallback)(async()=>{nr.needsRotation()&&r&&(console.log("\u23f0 Tempo de rota\xe7\xe3o atingido, executando rota\xe7\xe3o autom\xe1tica"),await C())},[r,C]),T=(0,e.useCallback)(async()=>(console.log("\ud83d\udd04 Rota\xe7\xe3o manual iniciada"),await C()),[C]),D=(0,e.useCallback)(async()=>(console.log("\ud83d\udd04 Sincroniza\xe7\xe3o manual iniciada"),await A()),[A]),P=(0,e.useCallback)(()=>{const e=nr.getInfo();return(0,n.A)((0,n.A)({},e),{},{nextRotation:v,isRotating:m,isSyncing:g,syncProgress:w,rotationHistory:N,autoRotate:r,rotationInterval:a})},[v,m,g,w,N,r,a]);return(0,e.useEffect)(()=>{const e=JSON.parse(localStorage.getItem("rotationHistory")||"[]");j(e)},[]),(0,e.useEffect)(()=>nr.addListener(e=>{console.log("\ud83d\udce1 Database alterado: ".concat(e)),h(e),y(nr.lastRotation),E()}),[E]),(0,e.useEffect)(()=>{if(r)return E(),S.current=setInterval(()=>{I()},6e4),I(),()=>{S.current&&clearInterval(S.current)}},[r,I,E]),{activeDatabase:u,lastRotation:x,nextRotation:v,isRotating:m,isSyncing:g,syncProgress:w,rotationHistory:N,forceRotation:T,forceSync:D,checkRotation:I,getInfo:P,needsRotation:nr.needsRotation(),hoursUntilRotation:nr.getInfo().hoursUntilRotation,autoRotate:r}},OS=["children"],BS=(0,e.createContext)(null),zS=t=>{let{children:r}=t,s=(0,a.A)(t,OS);const[i,o]=(0,e.useState)(!1),[l,c]=(0,e.useState)(null),d=RS((0,n.A)({autoRotate:!0,rotationInterval:864e5,syncOnRotation:!0,collections:["usuarios","mensagens","notificacoes","tarefas","emprestimos","inventario","empresas","setores","cargos","presenca","horarios","folgas","configuracoes"],onRotationStart:e=>{console.log("\ud83d\udd04 Rota\xe7\xe3o iniciada de: ".concat(e)),c({type:"info",title:"Rota\xe7\xe3o de Database",message:"Alternando database de ".concat(e,"..."),timestamp:new Date}),o(!0)},onRotationComplete:(e,t)=>{console.log("\u2705 Rota\xe7\xe3o conclu\xedda para: ".concat(e)),c({type:"success",title:"Rota\xe7\xe3o Conclu\xedda",message:"Database alternado para ".concat(e," com sucesso!"),timestamp:new Date}),setTimeout(()=>{o(!1)},5e3)},onSyncProgress:(e,t,r)=>{console.log("\ud83d\udcca Sincronizando ".concat(r,": ").concat(e,"/").concat(t))},onError:e=>{console.error("\u274c Erro na rota\xe7\xe3o:",e),c({type:"error",title:"Erro na Rota\xe7\xe3o",message:e.message,timestamp:new Date}),o(!0),setTimeout(()=>{o(!1)},1e4)}},s));return(0,k.jsxs)(BS.Provider,{value:(0,n.A)((0,n.A)({},d),{},{notification:l,showNotification:i,closeNotification:()=>o(!1)}),children:[r,i&&l&&(0,k.jsx)(US,{notification:l,onClose:()=>o(!1)})]})},US=e=>{let{notification:t,onClose:r}=e;const{type:a,title:n,message:s}=t;return(0,k.jsx)("div",{className:"fixed bottom-4 right-4 z-50 animate-slide-up",children:(0,k.jsx)("div",{className:"".concat({info:"bg-blue-500",success:"bg-green-500",error:"bg-red-500",warning:"bg-yellow-500"}[a]," text-white rounded-lg shadow-lg p-4 min-w-[300px] max-w-md"),children:(0,k.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[(0,k.jsxs)("div",{className:"flex items-start gap-3",children:[(0,k.jsx)("span",{className:"text-2xl",children:{info:"\ud83d\udd04",success:"\u2705",error:"\u274c",warning:"\u26a0\ufe0f"}[a]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("h3",{className:"font-semibold text-lg",children:n}),(0,k.jsx)("p",{className:"text-sm opacity-90 mt-1",children:s})]})]}),(0,k.jsx)("button",{onClick:r,className:"text-white hover:opacity-80 transition-opacity",children:"\u2715"})]})})})},VS=["usuarios","mensagens","notificacoes","tarefas","emprestimos","inventario","empresas","setores","cargos","presenca","horarios","folgas","configuracoes","escalas","backups","logs","auditoria","permissoes","relatorios"],qS=async(e,t,r)=>{try{const a=(0,s.collection)(e,t),n=(await(0,s.GG)(a)).docs,i=n.length;let o=null,l=new Set;return n.slice(0,10).forEach(e=>{const t=e.data();["createdAt","updatedAt","timestamp","dataCreated","dataModificacao"].forEach(e=>{if(t[e]){var r;const a=null!==(r=t[e])&&void 0!==r&&r.toDate?t[e].toDate():new Date(t[e]);(!o||a>o)&&(o=a)}}),Object.keys(t).forEach(e=>l.add(e))}),{name:t,database:r,documentCount:i,lastUpdated:o,sampleFields:Array.from(l).slice(0,10),isEmpty:0===i,hasData:i>0}}catch(a){return console.error("\u274c Erro ao acessar cole\xe7\xe3o ".concat(t," em ").concat(r,":"),a),{name:t,database:r,documentCount:0,error:a.message,isEmpty:!0,hasData:!1}}},HS=async(e,t)=>{console.log("\ud83d\udcca Listando cole\xe7\xf5es do banco ".concat(t,"..."));const r=[];for(const a of VS){const n=await qS(e,a,t);r.push(n)}return r.sort((e,t)=>(t.documentCount||0)-(e.documentCount||0)),r},GS=async()=>{console.log("\ud83d\udd0d Iniciando scan de todas as cole\xe7\xf5es...");try{const[e,t]=await Promise.all([HS(Xt,"Firebase Principal (garden-c0b50)"),HS(Jt,"Firebase Backup (garden-backup)")]),r={primary:{name:"Firebase Principal",projectId:"garden-c0b50",collections:e,totalCollections:e.filter(e=>e.hasData).length,totalDocuments:e.reduce((e,t)=>e+(t.documentCount||0),0)},backup:{name:"Firebase Backup",projectId:"garden-backup",collections:t,totalCollections:t.filter(e=>e.hasData).length,totalDocuments:t.reduce((e,t)=>e+(t.documentCount||0),0)}},a=2,s=r.primary.totalCollections+r.backup.totalCollections,i=r.primary.totalDocuments+r.backup.totalDocuments;return console.log("\u2705 Scan completo:",{totalDatabases:a,totalCollections:s,totalDocuments:i}),(0,n.A)((0,n.A)({},r),{},{totals:{databases:a,collections:s,documents:i},scanTime:(new Date).toISOString()})}catch(e){throw console.error("\u274c Erro ao listar cole\xe7\xf5es:",e),e}},WS=async()=>{console.log("\ud83d\udd0d Comparando cole\xe7\xf5es entre bancos...");const e=await GS(),{primary:t,backup:r}=e,a=VS.map(e=>{const a=t.collections.find(t=>t.name===e),n=r.collections.find(t=>t.name===e),s=(null===a||void 0===a?void 0:a.documentCount)||0,i=(null===n||void 0===n?void 0:n.documentCount)||0,o=Math.abs(s-i);return{name:e,primary:{count:s,hasData:s>0,lastUpdated:null===a||void 0===a?void 0:a.lastUpdated},backup:{count:i,hasData:i>0,lastUpdated:null===n||void 0===n?void 0:n.lastUpdated},difference:o,inSync:0===o,needsSync:o>0,status:0===o?"synced":o<10?"minor-diff":"major-diff"}}),n=a.filter(e=>e.inSync).length,s=a.filter(e=>e.needsSync).length;return console.log("\ud83d\udcca Compara\xe7\xe3o completa:",{total:a.length,synced:n,outOfSync:s}),{collections:a,summary:{total:a.length,synced:n,outOfSync:s,syncPercentage:(n/a.length*100).toFixed(1)},timestamp:(new Date).toISOString()}},KS=y("server",[["rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2",key:"ngkwjq"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2",key:"iecqi9"}],["line",{x1:"6",x2:"6.01",y1:"6",y2:"6",key:"16zg32"}],["line",{x1:"6",x2:"6.01",y1:"18",y2:"18",key:"nzw8ys"}]]),QS=y("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),YS=t=>{let{isOpen:r,onClose:a,onServerAdded:l}=t;const[c,d]=(0,e.useState)({name:"",description:"",apiKey:"",authDomain:"",projectId:"",storageBucket:"",messagingSenderId:"",appId:"",measurementId:""}),[u,h]=(0,e.useState)(!1),[m,f]=(0,e.useState)(!1),[g,p]=(0,e.useState)(null),[x,y]=(0,e.useState)(!1),v=()=>{d({name:"",description:"",apiKey:"",authDomain:"",projectId:"",storageBucket:"",messagingSenderId:"",appId:"",measurementId:""}),p(null),h(!1),a()},w=c.name&&c.projectId&&c.apiKey&&c.authDomain;return(0,k.jsx)(Pr,{children:r&&(0,k.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black bg-opacity-50",children:(0,k.jsxs)(Cd.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},className:"bg-white dark:bg-gray-800 rounded-2xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-hidden",children:[(0,k.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700",children:[(0,k.jsxs)("div",{className:"flex items-center gap-3",children:[(0,k.jsx)("div",{className:"w-12 h-12 bg-blue-100 dark:bg-blue-900 rounded-xl flex items-center justify-center",children:(0,k.jsx)(D,{className:"w-6 h-6 text-blue-600 dark:text-blue-400"})}),(0,k.jsxs)("div",{children:[(0,k.jsx)("h2",{className:"text-xl font-bold text-gray-800 dark:text-white",children:"Adicionar Servidor Firebase"}),(0,k.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Configure um novo banco de dados Firebase"})]})]}),(0,k.jsx)("button",{onClick:v,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:(0,k.jsx)(Id,{className:"w-5 h-5 text-gray-500"})})]}),(0,k.jsx)("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-200px)]",children:(0,k.jsxs)("div",{className:"space-y-6",children:[(0,k.jsxs)("div",{className:"space-y-4",children:[(0,k.jsxs)("h3",{className:"text-lg font-semibold text-gray-800 dark:text-white flex items-center gap-2",children:[(0,k.jsx)(KS,{className:"w-5 h-5"}),"Informa\xe7\xf5es B\xe1sicas"]}),(0,k.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Nome do Servidor"}),(0,k.jsx)("input",{type:"text",value:c.name,onChange:e=>d((0,n.A)((0,n.A)({},c),{},{name:e.target.value})),placeholder:"Ex: Firebase Produ\xe7\xe3o",className:"w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-800 dark:text-white focus:ring-2 focus:ring-blue-500"})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Project ID"}),(0,k.jsx)("input",{type:"text",value:c.projectId,onChange:e=>d((0,n.A)((0,n.A)({},c),{},{projectId:e.target.value})),placeholder:"meu-projeto-firebase",className:"w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-800 dark:text-white focus:ring-2 focus:ring-blue-500"})]})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Descri\xe7\xe3o (Opcional)"}),(0,k.jsx)("textarea",{value:c.description,onChange:e=>d((0,n.A)((0,n.A)({},c),{},{description:e.target.value})),placeholder:"Descri\xe7\xe3o do servidor ou ambiente...",rows:2,className:"w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-800 dark:text-white focus:ring-2 focus:ring-blue-500"})]})]}),(0,k.jsxs)("div",{className:"space-y-4",children:[(0,k.jsxs)("h3",{className:"text-lg font-semibold text-gray-800 dark:text-white flex items-center gap-2",children:[(0,k.jsx)(I,{className:"w-5 h-5"}),"Configura\xe7\xe3o Firebase"]}),(0,k.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"API Key"}),(0,k.jsxs)("div",{className:"relative",children:[(0,k.jsx)("input",{type:u?"text":"password",value:c.apiKey,onChange:e=>d((0,n.A)((0,n.A)({},c),{},{apiKey:e.target.value})),placeholder:"AIzaSy...",className:"w-full px-4 py-3 pr-12 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-800 dark:text-white focus:ring-2 focus:ring-blue-500"}),(0,k.jsx)("button",{type:"button",onClick:()=>h(!u),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700",children:u?(0,k.jsx)(gr,{className:"w-4 h-4"}):(0,k.jsx)(pr,{className:"w-4 h-4"})})]})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Auth Domain"}),(0,k.jsx)("input",{type:"text",value:c.authDomain,onChange:e=>d((0,n.A)((0,n.A)({},c),{},{authDomain:e.target.value})),placeholder:"meu-projeto.firebaseapp.com",className:"w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-800 dark:text-white focus:ring-2 focus:ring-blue-500"})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Storage Bucket"}),(0,k.jsx)("input",{type:"text",value:c.storageBucket,onChange:e=>d((0,n.A)((0,n.A)({},c),{},{storageBucket:e.target.value})),placeholder:"meu-projeto.firebasestorage.app",className:"w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-800 dark:text-white focus:ring-2 focus:ring-blue-500"})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Messaging Sender ID"}),(0,k.jsx)("input",{type:"text",value:c.messagingSenderId,onChange:e=>d((0,n.A)((0,n.A)({},c),{},{messagingSenderId:e.target.value})),placeholder:"123456789012",className:"w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-800 dark:text-white focus:ring-2 focus:ring-blue-500"})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"App ID"}),(0,k.jsx)("input",{type:"text",value:c.appId,onChange:e=>d((0,n.A)((0,n.A)({},c),{},{appId:e.target.value})),placeholder:"1:123:web:abc123",className:"w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-800 dark:text-white focus:ring-2 focus:ring-blue-500"})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Measurement ID (Opcional)"}),(0,k.jsx)("input",{type:"text",value:c.measurementId,onChange:e=>d((0,n.A)((0,n.A)({},c),{},{measurementId:e.target.value})),placeholder:"G-XXXXXXXXXX",className:"w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-800 dark:text-white focus:ring-2 focus:ring-blue-500"})]})]})]}),(0,k.jsxs)("div",{className:"space-y-4",children:[(0,k.jsxs)("div",{className:"flex items-center justify-between",children:[(0,k.jsxs)("h3",{className:"text-lg font-semibold text-gray-800 dark:text-white flex items-center gap-2",children:[(0,k.jsx)(Wd,{className:"w-5 h-5"}),"Teste de Conex\xe3o"]}),(0,k.jsxs)("button",{onClick:async()=>{f(!0),p(null);try{const e={apiKey:c.apiKey,authDomain:c.authDomain,projectId:c.projectId,storageBucket:c.storageBucket,messagingSenderId:c.messagingSenderId,appId:c.appId,measurementId:c.measurementId},t="test-".concat(Date.now()),r=(0,i.Wp)(e,t),a=(0,s.aU)(r),n=((0,o.xI)(r),(0,xt.c7)(r),(0,s.collection)(a,"test-connection"));await(0,s.GG)(n),p({success:!0,message:"Conex\xe3o estabelecida com sucesso!",details:{firestore:!0,auth:!0,storage:!0,projectId:c.projectId}}),await r.delete()}catch(e){console.error("\u274c Erro ao testar conex\xe3o:",e),p({success:!1,message:"Falha na conex\xe3o",error:e.message,details:{firestore:!1,auth:!1,storage:!1}})}finally{f(!1)}},disabled:!w||m,className:"flex items-center gap-2 px-4 py-2 bg-blue-500 hover:bg-blue-600 disabled:bg-gray-400 text-white rounded-lg transition-colors disabled:cursor-not-allowed",children:[m?(0,k.jsx)(QS,{className:"w-4 h-4 animate-spin"}):(0,k.jsx)(Wd,{className:"w-4 h-4"}),m?"Testando...":"Testar Conex\xe3o"]})]}),g&&(0,k.jsxs)(Cd.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"p-4 rounded-lg border ".concat(g.success?"bg-green-50 dark:bg-green-900/20 border-green-200 dark:border-green-800":"bg-red-50 dark:bg-red-900/20 border-red-200 dark:border-red-800"),children:[(0,k.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[g.success?(0,k.jsx)(Fd,{className:"w-5 h-5 text-green-600"}):(0,k.jsx)(b,{className:"w-5 h-5 text-red-600"}),(0,k.jsx)("span",{className:"font-medium ".concat(g.success?"text-green-800 dark:text-green-300":"text-red-800 dark:text-red-300"),children:g.message})]}),g.success&&(0,k.jsxs)("div",{className:"grid grid-cols-3 gap-2 text-sm",children:[(0,k.jsxs)("div",{className:"flex items-center gap-1 text-green-600",children:[(0,k.jsx)(Fd,{className:"w-3 h-3"}),"Firestore"]}),(0,k.jsxs)("div",{className:"flex items-center gap-1 text-green-600",children:[(0,k.jsx)(Fd,{className:"w-3 h-3"}),"Auth"]}),(0,k.jsxs)("div",{className:"flex items-center gap-1 text-green-600",children:[(0,k.jsx)(Fd,{className:"w-3 h-3"}),"Storage"]})]}),g.error&&(0,k.jsx)("div",{className:"text-sm text-red-600 dark:text-red-400 mt-2",children:g.error})]})]})]})}),(0,k.jsxs)("div",{className:"flex items-center justify-end gap-3 p-6 border-t border-gray-200 dark:border-gray-700",children:[(0,k.jsx)("button",{onClick:v,className:"px-6 py-2 text-gray-600 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:"Cancelar"}),(0,k.jsxs)("button",{onClick:async()=>{if(null!==g&&void 0!==g&&g.success){y(!0);try{const e={id:"firebase-".concat(Date.now()),name:c.name,description:c.description,config:{apiKey:c.apiKey,authDomain:c.authDomain,projectId:c.projectId,storageBucket:c.storageBucket,messagingSenderId:c.messagingSenderId,appId:c.appId,measurementId:c.measurementId},createdAt:(new Date).toISOString(),lastTested:(new Date).toISOString(),status:"active"},t=JSON.parse(localStorage.getItem("firebaseServers")||"[]");t.push(e),localStorage.setItem("firebaseServers",JSON.stringify(t)),l&&l(e),d({name:"",description:"",apiKey:"",authDomain:"",projectId:"",storageBucket:"",messagingSenderId:"",appId:"",measurementId:""}),p(null),a(),alert("Servidor Firebase adicionado com sucesso!")}catch(e){console.error("\u274c Erro ao salvar servidor:",e),alert("Erro ao salvar servidor. Tente novamente.")}finally{y(!1)}}else alert("Por favor, teste a conex\xe3o antes de salvar.")},disabled:!(null!==g&&void 0!==g&&g.success)||x,className:"flex items-center gap-2 px-6 py-2 bg-blue-500 hover:bg-blue-600 disabled:bg-gray-400 text-white rounded-lg transition-colors disabled:cursor-not-allowed",children:[x?(0,k.jsx)(QS,{className:"w-4 h-4 animate-spin"}):(0,k.jsx)(D,{className:"w-4 h-4"}),x?"Salvando...":"Adicionar Servidor"]})]})]})})})},XS=(e,t)=>{const r={id:t,totalFields:0,fieldTypes:{},nestedObjects:0,arrays:0,timestamps:0,references:0,estimatedSize:JSON.stringify(e).length,structure:{}},a=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";Object.entries(e).forEach(e=>{let[n,s]=e;const i=t?"".concat(t,".").concat(n):n;r.totalFields++;let o=typeof s,l={type:o,path:i};null===s?o="null":Array.isArray(s)?(o="array",r.arrays++,l.length=s.length,l.itemTypes=[...new Set(s.map(e=>typeof e))]):s&&"object"===typeof s?s.toDate&&"function"===typeof s.toDate?(o="timestamp",r.timestamps++,l.value=s.toDate().toISOString()):s.path&&s.firestore?(o="reference",r.references++,l.path=s.path):(o="object",r.nestedObjects++,a(s,i)):"string"===typeof s?(l.length=s.length,s.match(/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}/)?l.pattern="iso-date":s.match(/^[a-f0-9]{32}$/i)?l.pattern="md5-hash":s.match(/^[a-f0-9]{64}$/i)?l.pattern="sha256-hash":s.match(/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/)?l.pattern="email":s.match(/^https?:\/\//)&&(l.pattern="url")):"number"===typeof s&&(l.isInteger=Number.isInteger(s),l.value=s),r.fieldTypes[o]||(r.fieldTypes[o]=0),r.fieldTypes[o]++,r.structure[i]=l})};return a(e),r},JS=async function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};try{const{pageSize:a=20,startAfterDoc:n=null,orderField:i=null,orderDirection:o="asc",searchField:l=null,searchValue:c=null,includeAnalysis:d=!0}=r;console.log("\ud83d\udcca Buscando documentos da cole\xe7\xe3o: ".concat(t));let u=(0,s.collection)(e,t);i&&(u=(0,s.P)(u,(0,s.My)(i,o))),l&&c&&(u=(0,s.P)(u,(0,s._M)(l,">=",c),(0,s._M)(l,"<=",c+"\uf8ff"))),n&&(u=(0,s.P)(u,(0,s.HM)(n))),u=(0,s.P)(u,(0,s.AB)(a));const h=await(0,s.GG)(u),m=[];let f={commonFields:{},fieldFrequency:{},dataTypes:{},totalDocuments:h.size,estimatedCollectionSize:0};return h.docs.forEach(e=>{const t=e.data(),r={id:e.id,data:t,metadata:{exists:!0,hasPendingWrites:e.metadata.hasPendingWrites,isEqual:!1}};d&&(r.analysis=XS(t,e.id),f.estimatedCollectionSize+=r.analysis.estimatedSize,Object.keys(r.analysis.structure).forEach(e=>{f.commonFields[e]||(f.commonFields[e]=0),f.commonFields[e]++;const t=r.analysis.structure[e].type;f.dataTypes[t]||(f.dataTypes[t]=0),f.dataTypes[t]++})),m.push(r)}),f.fieldFrequency=Object.entries(f.commonFields).sort((e,t)=>{let[,r]=e,[,a]=t;return a-r}).reduce((e,t)=>{let[r,a]=t;return e[r]={count:a,percentage:(a/f.totalDocuments*100).toFixed(1)},e},{}),{documents:m,analysis:f,hasMore:h.size===a,lastDocument:h.docs[h.docs.length-1]||null,pageInfo:{currentPage:n?"N/A":1,pageSize:a,totalInPage:h.size}}}catch(a){throw console.error("\u274c Erro ao buscar documentos da cole\xe7\xe3o ".concat(t,":"),a),a}},ZS=async(e,t,r)=>{try{console.log("\ud83d\udcc4 Buscando documento: ".concat(t,"/").concat(r));const a=(0,s.doc)(e,t,r),n=await(0,s.x7)(a);if(!n.exists())return{exists:!1,id:r,collection:t};const i=n.data();return{exists:!0,id:r,collection:t,data:i,analysis:XS(i,r),metadata:{hasPendingWrites:n.metadata.hasPendingWrites,fromCache:n.metadata.fromCache,path:n.ref.path}}}catch(a){throw console.error("\u274c Erro ao buscar documento ".concat(r,":"),a),a}},$S=async function(e,t,r){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};try{const{searchFields:i=["nome","title","name","email","id"],maxResults:o=50}=a;console.log('\ud83d\udd0d Buscando "'.concat(r,'" na cole\xe7\xe3o ').concat(t));const l=(0,s.collection)(e,t),c=[];for(const e of i)try{const t=(0,s.P)(l,(0,s._M)(e,">=",r),(0,s._M)(e,"<=",r+"\uf8ff"),(0,s.AB)(o));(await(0,s.GG)(t)).docs.forEach(t=>{const r=c.find(e=>e.id===t.id);if(!r){const r=t.data();c.push({id:t.id,data:r,matchedField:e,matchedValue:r[e],analysis:XS(r,t.id)})}})}catch(n){console.warn("\u26a0\ufe0f Erro ao buscar no campo ".concat(e,":"),n.message)}return{searchTerm:r,results:c.slice(0,o),totalFound:c.length,searchedFields:i}}catch(i){throw console.error("\u274c Erro na busca:",i),i}},e_=async function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100;try{console.log("\ud83d\udcc8 Analisando estat\xedsticas da cole\xe7\xe3o: ".concat(t));const a=(0,s.collection)(e,t),i=(0,s.P)(a,(0,s.AB)(r)),o=await(0,s.GG)(i),l={collectionName:t,sampleSize:o.size,totalAnalyzed:o.size,fieldAnalysis:{},dataPatterns:{},sizeAnalysis:{totalSize:0,averageSize:0,minSize:1/0,maxSize:0},timestamps:{earliest:null,latest:null,fields:[]}};return o.docs.forEach(e=>{const t=e.data(),r=XS(t,e.id);l.sizeAnalysis.totalSize+=r.estimatedSize,l.sizeAnalysis.minSize=Math.min(l.sizeAnalysis.minSize,r.estimatedSize),l.sizeAnalysis.maxSize=Math.max(l.sizeAnalysis.maxSize,r.estimatedSize),Object.entries(r.structure).forEach(e=>{let[r,a]=e;if(l.fieldAnalysis[r]||(l.fieldAnalysis[r]={frequency:0,type:a.type,patterns:[],samples:[]}),l.fieldAnalysis[r].frequency++,l.fieldAnalysis[r].samples.length<5)if("timestamp"===a.type&&a.value){l.fieldAnalysis[r].samples.push(a.value);const e=new Date(a.value);(!l.timestamps.earliest||e<new Date(l.timestamps.earliest))&&(l.timestamps.earliest=a.value),(!l.timestamps.latest||e>new Date(l.timestamps.latest))&&(l.timestamps.latest=a.value),l.timestamps.fields.includes(r)||l.timestamps.fields.push(r)}else if("string"===a.type||"number"===a.type){const e=t[r.split(".")[0]];void 0!==e&&l.fieldAnalysis[r].samples.length<3&&l.fieldAnalysis[r].samples.push(e)}a.pattern&&!l.fieldAnalysis[r].patterns.includes(a.pattern)&&l.fieldAnalysis[r].patterns.push(a.pattern)})}),l.sampleSize>0&&(l.sizeAnalysis.averageSize=l.sizeAnalysis.totalSize/l.sampleSize,l.sizeAnalysis.minSize=l.sizeAnalysis.minSize===1/0?0:l.sizeAnalysis.minSize),l.fieldAnalysis=Object.entries(l.fieldAnalysis).sort((e,t)=>{let[,r]=e,[,a]=t;return a.frequency-r.frequency}).reduce((e,t)=>{let[r,a]=t;return e[r]=(0,n.A)((0,n.A)({},a),{},{percentage:(a.frequency/l.sampleSize*100).toFixed(1)}),e},{}),l}catch(a){throw console.error("\u274c Erro ao analisar estat\xedsticas:",a),a}},t_=y("layers",[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]]),r_=y("link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]),a_=y("type",[["path",{d:"M12 4v16",key:"1654pz"}],["path",{d:"M4 7V5a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v2",key:"e0r10z"}],["path",{d:"M9 20h6",key:"s66wpe"}]]),n_=y("grid-3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]),s_=t=>{var r,a,n;let{isOpen:s,onClose:i,collection:o,database:l}=t;const[c,d]=(0,e.useState)("documents"),[u,h]=(0,e.useState)([]),[m,f]=(0,e.useState)(!1),[g,p]=(0,e.useState)(null),[x,y]=(0,e.useState)(null),[v,b]=(0,e.useState)(null),[N,j]=(0,e.useState)(null),[S,_]=(0,e.useState)(""),[E,C]=(0,e.useState)(1),[I,T]=(0,e.useState)(20),[D,P]=(0,e.useState)(!1),[F,L]=(0,e.useState)(null),[M,R]=(0,e.useState)(""),[O,B]=(0,e.useState)("asc"),[z,U]=(0,e.useState)("grid"),V="primary"===l?Xt:Jt,q="primary"===l?"Firebase Principal":"Firebase Backup",H=async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(o){f(!0),p(null);try{const t={pageSize:I,startAfterDoc:e?F:null,orderField:M||null,orderDirection:O,includeAnalysis:!0},r=await JS(V,o.name,t);e?h(e=>[...e,...r.documents]):(h(r.documents),C(1)),P(r.hasMore),L(r.lastDocument)}catch(t){console.error("\u274c Erro ao carregar documentos:",t),p(t.message)}finally{f(!1)}}},G=async()=>{if(o&&S.trim()){f(!0);try{const e=await $S(V,o.name,S,{maxResults:50});j(e)}catch(e){console.error("\u274c Erro na busca:",e),p(e.message)}finally{f(!1)}}},W=async e=>{f(!0);try{const t=await ZS(V,o.name,e);y(t)}catch(t){console.error("\u274c Erro ao carregar documento:",t),p(t.message)}finally{f(!1)}},K=(e,t)=>{const r=new Blob([JSON.stringify(e,null,2)],{type:"application/json"}),a=URL.createObjectURL(r),n=document.createElement("a");n.href=a,n.download=t,document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(a)},Q=(e,t)=>{if(null===e||void 0===e)return(0,k.jsx)("span",{className:"text-gray-400 italic",children:"null"});switch(t){case"timestamp":return(0,k.jsxs)("div",{className:"flex items-center gap-2",children:[(0,k.jsx)(iu,{className:"w-4 h-4 text-blue-500"}),(0,k.jsx)("span",{className:"text-blue-600 dark:text-blue-400",children:new Date(e).toLocaleString("pt-BR")})]});case"array":return(0,k.jsxs)("div",{className:"flex items-center gap-2",children:[(0,k.jsx)(iS,{className:"w-4 h-4 text-green-500"}),(0,k.jsxs)("span",{className:"text-green-600 dark:text-green-400",children:["Array (",Array.isArray(e)?e.length:0," itens)"]})]});case"object":return(0,k.jsxs)("div",{className:"flex items-center gap-2",children:[(0,k.jsx)(t_,{className:"w-4 h-4 text-purple-500"}),(0,k.jsxs)("span",{className:"text-purple-600 dark:text-purple-400",children:["Object (","object"===typeof e?Object.keys(e).length:0," campos)"]})]});case"reference":return(0,k.jsxs)("div",{className:"flex items-center gap-2",children:[(0,k.jsx)(r_,{className:"w-4 h-4 text-orange-500"}),(0,k.jsxs)("span",{className:"text-orange-600 dark:text-orange-400",children:["Refer\xeancia: ",e]})]});case"string":return(0,k.jsxs)("div",{className:"flex items-center gap-2",children:[(0,k.jsx)(a_,{className:"w-4 h-4 text-gray-500"}),(0,k.jsxs)("span",{className:"text-gray-700 dark:text-gray-300",children:["string"===typeof e?e.substring(0,100):String(e),"string"===typeof e&&e.length>100&&"..."]})]});case"number":return(0,k.jsxs)("div",{className:"flex items-center gap-2",children:[(0,k.jsx)(ow,{className:"w-4 h-4 text-indigo-500"}),(0,k.jsx)("span",{className:"text-indigo-600 dark:text-indigo-400",children:e})]});case"boolean":return(0,k.jsxs)("div",{className:"flex items-center gap-2",children:[e?(0,k.jsx)(Fd,{className:"w-4 h-4 text-green-500"}):(0,k.jsx)(Id,{className:"w-4 h-4 text-red-500"}),(0,k.jsx)("span",{className:e?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400",children:e?"true":"false"})]});default:return(0,k.jsx)("span",{className:"text-gray-700 dark:text-gray-300",children:String(e)})}},Y=()=>{h([]),y(null),b(null),j(null),_(""),p(null),C(1),L(null),d("documents")};return(0,e.useEffect)(()=>{s&&o&&(Y(),H())},[s,o]),(0,e.useEffect)(()=>{s&&o&&("statistics"!==c||v||(async()=>{if(o){f(!0);try{const e=await e_(V,o.name,100);b(e)}catch(e){console.error("\u274c Erro ao carregar estat\xedsticas:",e),p(e.message)}finally{f(!1)}}})())},[c,s,o]),s?(0,k.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black bg-opacity-50",children:(0,k.jsxs)(Cd.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},className:"bg-white dark:bg-gray-800 rounded-2xl shadow-2xl w-full max-w-7xl max-h-[95vh] overflow-hidden flex flex-col",children:[(0,k.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700",children:[(0,k.jsxs)("div",{className:"flex items-center gap-3",children:[(0,k.jsx)("div",{className:"w-12 h-12 bg-blue-100 dark:bg-blue-900 rounded-xl flex items-center justify-center",children:(0,k.jsx)(A,{className:"w-6 h-6 text-blue-600 dark:text-blue-400"})}),(0,k.jsxs)("div",{children:[(0,k.jsx)("h2",{className:"text-xl font-bold text-gray-800 dark:text-white",children:"Visualizador de Documentos"}),(0,k.jsxs)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[null===o||void 0===o?void 0:o.name," \u2022 ",q," \u2022 ",u.length," documentos carregados"]})]})]}),(0,k.jsxs)("div",{className:"flex items-center gap-2",children:[(0,k.jsxs)("div",{className:"flex items-center gap-1 p-1 bg-gray-100 dark:bg-gray-700 rounded-lg",children:[(0,k.jsx)("button",{onClick:()=>d("documents"),className:"px-3 py-2 rounded-md text-sm font-medium transition-colors ".concat("documents"===c?"bg-blue-500 text-white":"text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200"),children:(0,k.jsx)(n_,{className:"w-4 h-4"})}),(0,k.jsx)("button",{onClick:()=>d("statistics"),className:"px-3 py-2 rounded-md text-sm font-medium transition-colors ".concat("statistics"===c?"bg-blue-500 text-white":"text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200"),children:(0,k.jsx)(tu,{className:"w-4 h-4"})}),(0,k.jsx)("button",{onClick:()=>d("search"),className:"px-3 py-2 rounded-md text-sm font-medium transition-colors ".concat("search"===c?"bg-blue-500 text-white":"text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200"),children:(0,k.jsx)(Ft,{className:"w-4 h-4"})})]}),(0,k.jsx)("button",{onClick:()=>{Y(),i()},className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:(0,k.jsx)(Id,{className:"w-5 h-5 text-gray-500"})})]})]}),(0,k.jsxs)("div",{className:"flex-1 overflow-hidden flex",children:[(0,k.jsxs)("div",{className:"flex-1 overflow-y-auto p-6",children:[g&&(0,k.jsxs)("div",{className:"mb-4 p-4 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg",children:[(0,k.jsxs)("div",{className:"flex items-center gap-2 text-red-700 dark:text-red-400",children:[(0,k.jsx)(w,{className:"w-5 h-5"}),(0,k.jsx)("span",{className:"font-medium",children:"Erro"})]}),(0,k.jsx)("p",{className:"text-red-600 dark:text-red-400 mt-1",children:g})]}),m&&(0,k.jsxs)("div",{className:"flex items-center justify-center py-12",children:[(0,k.jsx)(QS,{className:"w-8 h-8 animate-spin text-blue-500"}),(0,k.jsx)("span",{className:"ml-3 text-gray-600 dark:text-gray-400",children:"Carregando..."})]}),"documents"===c&&!m&&u.length>0&&(0,k.jsxs)("div",{className:"space-y-4",children:[(0,k.jsxs)("div",{className:"flex items-center justify-between",children:[(0,k.jsxs)("div",{className:"flex items-center gap-4",children:[(0,k.jsxs)("select",{value:I,onChange:e=>T(Number(e.target.value)),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-800 dark:text-white text-sm",children:[(0,k.jsx)("option",{value:10,children:"10 por p\xe1gina"}),(0,k.jsx)("option",{value:20,children:"20 por p\xe1gina"}),(0,k.jsx)("option",{value:50,children:"50 por p\xe1gina"})]}),(0,k.jsxs)("select",{value:z,onChange:e=>U(e.target.value),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-800 dark:text-white text-sm",children:[(0,k.jsx)("option",{value:"grid",children:"Grid"}),(0,k.jsx)("option",{value:"list",children:"Lista"}),(0,k.jsx)("option",{value:"json",children:"JSON"})]})]}),(0,k.jsxs)("div",{className:"flex items-center gap-2",children:[(0,k.jsxs)("button",{onClick:()=>H(),disabled:m,className:"flex items-center gap-2 px-4 py-2 bg-blue-500 hover:bg-blue-600 disabled:bg-gray-400 text-white rounded-lg transition-colors text-sm",children:[(0,k.jsx)(Kd,{className:"w-4 h-4"}),"Atualizar"]}),(0,k.jsxs)("button",{onClick:()=>K(u,"".concat(o.name,"_documents.json")),className:"flex items-center gap-2 px-4 py-2 bg-green-500 hover:bg-green-600 text-white rounded-lg transition-colors text-sm",children:[(0,k.jsx)(Gd,{className:"w-4 h-4"}),"Download"]})]})]}),"grid"===z&&(0,k.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:u.map(e=>{var t,r,a,n;return(0,k.jsxs)(Cd.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4 border border-gray-200 dark:border-gray-600 hover:shadow-lg transition-shadow cursor-pointer",onClick:()=>W(e.id),children:[(0,k.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,k.jsx)("h3",{className:"font-semibold text-gray-800 dark:text-white truncate",children:e.id}),(0,k.jsx)(pr,{className:"w-4 h-4 text-gray-500"})]}),(0,k.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,k.jsxs)("div",{className:"flex justify-between",children:[(0,k.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"Campos:"}),(0,k.jsx)("span",{className:"font-medium text-gray-800 dark:text-white",children:(null===(t=e.analysis)||void 0===t?void 0:t.totalFields)||0})]}),(0,k.jsxs)("div",{className:"flex justify-between",children:[(0,k.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"Tamanho:"}),(0,k.jsxs)("span",{className:"font-medium text-gray-800 dark:text-white",children:[(null===(r=e.analysis)||void 0===r?void 0:r.estimatedSize)||0," bytes"]})]}),(0,k.jsxs)("div",{className:"flex justify-between",children:[(0,k.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"Objetos:"}),(0,k.jsx)("span",{className:"font-medium text-gray-800 dark:text-white",children:(null===(a=e.analysis)||void 0===a?void 0:a.nestedObjects)||0})]})]}),(0,k.jsx)("div",{className:"mt-3 flex flex-wrap gap-1",children:Object.entries((null===(n=e.analysis)||void 0===n?void 0:n.fieldTypes)||{}).map(e=>{let[t,r]=e;return(0,k.jsxs)("span",{className:"px-2 py-1 bg-blue-100 dark:bg-blue-900 text-blue-700 dark:text-blue-300 rounded text-xs",children:[t,": ",r]},t)})})]},e.id)})}),D&&(0,k.jsx)("div",{className:"text-center mt-6",children:(0,k.jsxs)("button",{onClick:()=>H(!0),disabled:m,className:"flex items-center gap-2 mx-auto px-6 py-3 bg-blue-500 hover:bg-blue-600 disabled:bg-gray-400 text-white rounded-lg transition-colors",children:[m?(0,k.jsx)(QS,{className:"w-5 h-5 animate-spin"}):(0,k.jsx)(xN,{className:"w-5 h-5"}),"Carregar Mais"]})})]}),"statistics"===c&&!m&&v&&(0,k.jsxs)("div",{className:"space-y-6",children:[(0,k.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,k.jsxs)("div",{className:"bg-blue-50 dark:bg-blue-900/20 rounded-lg p-4",children:[(0,k.jsx)("div",{className:"text-sm text-gray-600 dark:text-gray-400 mb-1",children:"Documentos Analisados"}),(0,k.jsx)("div",{className:"text-2xl font-bold text-gray-800 dark:text-white",children:v.totalAnalyzed})]}),(0,k.jsxs)("div",{className:"bg-green-50 dark:bg-green-900/20 rounded-lg p-4",children:[(0,k.jsx)("div",{className:"text-sm text-gray-600 dark:text-gray-400 mb-1",children:"Tamanho Total"}),(0,k.jsxs)("div",{className:"text-2xl font-bold text-gray-800 dark:text-white",children:[(v.sizeAnalysis.totalSize/1024).toFixed(1),"KB"]})]}),(0,k.jsxs)("div",{className:"bg-purple-50 dark:bg-purple-900/20 rounded-lg p-4",children:[(0,k.jsx)("div",{className:"text-sm text-gray-600 dark:text-gray-400 mb-1",children:"Tamanho M\xe9dio"}),(0,k.jsxs)("div",{className:"text-2xl font-bold text-gray-800 dark:text-white",children:[v.sizeAnalysis.averageSize.toFixed(0),"B"]})]}),(0,k.jsxs)("div",{className:"bg-orange-50 dark:bg-orange-900/20 rounded-lg p-4",children:[(0,k.jsx)("div",{className:"text-sm text-gray-600 dark:text-gray-400 mb-1",children:"Campos \xdanicos"}),(0,k.jsx)("div",{className:"text-2xl font-bold text-gray-800 dark:text-white",children:Object.keys(v.fieldAnalysis).length})]})]}),(0,k.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-6",children:[(0,k.jsx)("h3",{className:"text-lg font-bold text-gray-800 dark:text-white mb-4",children:"An\xe1lise de Campos"}),(0,k.jsx)("div",{className:"space-y-3",children:Object.entries(v.fieldAnalysis).slice(0,10).map(e=>{let[t,r]=e;return(0,k.jsxs)("div",{className:"flex items-center justify-between p-3 bg-white dark:bg-gray-600 rounded-lg",children:[(0,k.jsxs)("div",{className:"flex items-center gap-3",children:[(0,k.jsx)("div",{className:"w-8 h-8 bg-blue-100 dark:bg-blue-900 rounded-full flex items-center justify-center",children:(0,k.jsx)(a_,{className:"w-4 h-4 text-blue-600 dark:text-blue-400"})}),(0,k.jsxs)("div",{children:[(0,k.jsx)("div",{className:"font-medium text-gray-800 dark:text-white",children:t}),(0,k.jsxs)("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:[r.type," \u2022 ",r.frequency," docs (",r.percentage,"%)"]})]})]}),r.samples.length>0&&(0,k.jsxs)("div",{className:"text-sm text-gray-600 dark:text-gray-400 max-w-xs truncate",children:["Exemplo: ",JSON.stringify(r.samples[0]).substring(0,50),"..."]})]},t)})})]})]}),"search"===c&&(0,k.jsxs)("div",{className:"space-y-4",children:[(0,k.jsxs)("div",{className:"flex gap-4",children:[(0,k.jsx)("input",{type:"text",value:S,onChange:e=>_(e.target.value),placeholder:"Digite o termo para buscar...",className:"flex-1 px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-800 dark:text-white",onKeyPress:e=>"Enter"===e.key&&G()}),(0,k.jsxs)("button",{onClick:G,disabled:m||!S.trim(),className:"flex items-center gap-2 px-6 py-3 bg-blue-500 hover:bg-blue-600 disabled:bg-gray-400 text-white rounded-lg transition-colors",children:[(0,k.jsx)(Ft,{className:"w-5 h-5"}),"Buscar"]})]}),N&&(0,k.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-6",children:[(0,k.jsxs)("h3",{className:"text-lg font-bold text-gray-800 dark:text-white mb-4",children:['Resultados da Busca: "',N.searchTerm,'"']}),(0,k.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:[N.totalFound," resultados encontrados"]}),(0,k.jsx)("div",{className:"space-y-3",children:N.results.map(e=>(0,k.jsxs)("div",{className:"p-4 bg-white dark:bg-gray-600 rounded-lg border border-gray-200 dark:border-gray-500 cursor-pointer hover:shadow-lg transition-shadow",onClick:()=>W(e.id),children:[(0,k.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,k.jsx)("span",{className:"font-medium text-gray-800 dark:text-white",children:e.id}),(0,k.jsxs)("span",{className:"text-sm text-blue-600 dark:text-blue-400",children:["Campo: ",e.matchedField]})]}),(0,k.jsxs)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Valor encontrado: ",JSON.stringify(e.matchedValue).substring(0,100),"..."]})]},e.id))})]})]})]}),x&&(0,k.jsx)("div",{className:"w-1/3 border-l border-gray-200 dark:border-gray-700 overflow-y-auto",children:(0,k.jsxs)("div",{className:"p-6",children:[(0,k.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,k.jsx)("h3",{className:"text-lg font-bold text-gray-800 dark:text-white",children:"Detalhes do Documento"}),(0,k.jsx)("button",{onClick:()=>y(null),className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:(0,k.jsx)(Id,{className:"w-4 h-4 text-gray-500"})})]}),(0,k.jsxs)("div",{className:"space-y-4",children:[(0,k.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4",children:[(0,k.jsx)("h4",{className:"font-semibold text-gray-800 dark:text-white mb-3",children:"Informa\xe7\xf5es"}),(0,k.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,k.jsxs)("div",{className:"flex justify-between",children:[(0,k.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"ID:"}),(0,k.jsx)("span",{className:"font-mono text-gray-800 dark:text-white",children:x.id})]}),(0,k.jsxs)("div",{className:"flex justify-between",children:[(0,k.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"Cole\xe7\xe3o:"}),(0,k.jsx)("span",{className:"font-medium text-gray-800 dark:text-white",children:x.collection})]}),(0,k.jsxs)("div",{className:"flex justify-between",children:[(0,k.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"Campos:"}),(0,k.jsx)("span",{className:"font-medium text-gray-800 dark:text-white",children:(null===(r=x.analysis)||void 0===r?void 0:r.totalFields)||0})]}),(0,k.jsxs)("div",{className:"flex justify-between",children:[(0,k.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"Tamanho:"}),(0,k.jsxs)("span",{className:"font-medium text-gray-800 dark:text-white",children:[(null===(a=x.analysis)||void 0===a?void 0:a.estimatedSize)||0," bytes"]})]})]})]}),(0,k.jsxs)("div",{className:"flex gap-2",children:[(0,k.jsxs)("button",{onClick:()=>{return e=x.data,void navigator.clipboard.writeText(JSON.stringify(e,null,2));var e},className:"flex items-center gap-2 px-3 py-2 bg-gray-100 dark:bg-gray-600 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-500 transition-colors text-sm",children:[(0,k.jsx)(nN,{className:"w-4 h-4"}),"Copiar"]}),(0,k.jsxs)("button",{onClick:()=>K(x,"".concat(x.id,".json")),className:"flex items-center gap-2 px-3 py-2 bg-blue-100 dark:bg-blue-900 text-blue-700 dark:text-blue-300 rounded-lg hover:bg-blue-200 dark:hover:bg-blue-800 transition-colors text-sm",children:[(0,k.jsx)(Gd,{className:"w-4 h-4"}),"Download"]})]}),(0,k.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4",children:[(0,k.jsx)("h4",{className:"font-semibold text-gray-800 dark:text-white mb-3",children:"Dados"}),(0,k.jsx)("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:Object.entries((null===(n=x.analysis)||void 0===n?void 0:n.structure)||{}).map(e=>{let[t,r]=e;return(0,k.jsxs)("div",{className:"border-b border-gray-200 dark:border-gray-600 pb-2",children:[(0,k.jsx)("div",{className:"font-medium text-gray-800 dark:text-white text-sm mb-1",children:t}),(0,k.jsx)("div",{className:"text-xs",children:Q(x.data[t.split(".")[0]],r.type)})]},t)})})]})]})]})})]})]})}):null},i_=y("folder-open",[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]]),o_=y("cloud",[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]]),l_=e=>{let{message:t,details:r}=e;return(0,k.jsx)("div",{className:"min-h-screen flex items-center justify-center p-4 bg-gradient-to-br from-gray-50 to-gray-100 dark:from-gray-900 dark:to-gray-800",children:(0,k.jsxs)(Cd.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"max-w-md w-full bg-white dark:bg-gray-800 rounded-2xl shadow-2xl p-8 text-center",children:[(0,k.jsx)("div",{className:"flex justify-center mb-6",children:(0,k.jsx)("div",{className:"w-20 h-20 rounded-full bg-red-100 dark:bg-red-900/30 flex items-center justify-center",children:(0,k.jsx)(rw,{className:"w-10 h-10 text-red-600 dark:text-red-400"})})}),(0,k.jsx)("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-3",children:"Oops! Algo deu errado"}),(0,k.jsx)("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:t||"N\xe3o foi poss\xedvel carregar o sistema de backup."}),r&&(0,k.jsx)("div",{className:"bg-gray-50 dark:bg-gray-900 rounded-lg p-4 mb-6 text-left",children:(0,k.jsx)("p",{className:"text-xs font-mono text-gray-700 dark:text-gray-300 break-words",children:r})}),(0,k.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,k.jsx)("button",{onClick:()=>window.location.reload(),className:"w-full px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium transition-colors",children:"Recarregar P\xe1gina"}),(0,k.jsx)("a",{href:"/",className:"w-full px-6 py-3 bg-gray-200 hover:bg-gray-300 dark:bg-gray-700 dark:hover:bg-gray-600 text-gray-900 dark:text-white rounded-lg font-medium transition-colors inline-block",children:"Voltar ao In\xedcio"})]})]})})},c_=()=>{const t=(()=>{const t=(0,e.useContext)(BS);if(!t)throw new Error("useDatabaseRotationContext deve ser usado dentro de DatabaseRotationProvider");return t})();if(!t)return(0,k.jsx)(l_,{message:"Sistema de backup n\xe3o dispon\xedvel",details:"O contexto de rota\xe7\xe3o de banco de dados n\xe3o foi inicializado. Verifique se DatabaseRotationProvider est\xe1 configurado."});const{activeDatabase:r,lastRotation:a,nextRotation:i,isRotating:o,isSyncing:l,syncProgress:c,rotationHistory:d,forceRotation:u,forceSync:h,getInfo:m,hoursUntilRotation:f,autoRotate:g}=t,[p,x]=(0,e.useState)({primary:{read:0,write:0,lastOperation:null,healthy:!0},backup:{read:0,write:0,lastOperation:null,healthy:!0}}),[y,v]=(0,e.useState)({rotationInterval:24,autoRotate:!0,autoSync:!0,notificationsEnabled:!0}),[w,N]=(0,e.useState)(null),[j,S]=(0,e.useState)(!1),[_,E]=(0,e.useState)(!1),[C,T]=(0,e.useState)(!1),[P,F]=(0,e.useState)(null),[L,M]=(0,e.useState)(!1),[R,O]=(0,e.useState)(!1),[B,z]=(0,e.useState)("grid"),[U,V]=(0,e.useState)("all"),[q,H]=(0,e.useState)(null),[G,W]=(0,e.useState)(!1),[K,Q]=(0,e.useState)([]),[Y,J]=(0,e.useState)(!1),[Z,$]=(0,e.useState)(null),[ee,te]=(0,e.useState)(null),re=async(e,t)=>{const r="primary"===t?S:E;r(!0);const a={database:t,timestamp:(new Date).toISOString(),tests:[]};try{const r=performance.now(),i=await(0,s.gS)((0,s.collection)(e,"backup_test"),{test:!0,timestamp:(0,s.O5)(),message:"Test write operation"}),o=performance.now()-r;a.tests.push({name:"Escrita",status:"success",time:o.toFixed(2)+"ms",details:"Documento ".concat(i.id," criado")});const l=performance.now(),c=await(0,s.GG)((0,s.collection)(e,"backup_test")),d=performance.now()-l;a.tests.push({name:"Leitura",status:"success",time:d.toFixed(2)+"ms",details:"".concat(c.size," documentos lidos")});const u=performance.now();await(0,s.updateDoc)((0,s.doc)(e,"backup_test",i.id),{updated:!0,updateTimestamp:(0,s.O5)()});const h=performance.now()-u;a.tests.push({name:"Atualiza\xe7\xe3o",status:"success",time:h.toFixed(2)+"ms",details:"Documento atualizado"});const m=performance.now();await(0,s.deleteDoc)((0,s.doc)(e,"backup_test",i.id));const f=performance.now()-m;a.tests.push({name:"Exclus\xe3o",status:"success",time:f.toFixed(2)+"ms",details:"Documento removido"}),x(e=>(0,n.A)((0,n.A)({},e),{},{[t]:(0,n.A)((0,n.A)({},e[t]),{},{read:e[t].read+1,write:e[t].write+3,lastOperation:(new Date).toISOString(),healthy:!0})})),a.success=!0,a.summary="Todos os testes passaram! Lat\xeancia m\xe9dia: ".concat(((o+d+h+f)/4).toFixed(2),"ms")}catch(i){a.success=!1,a.error=i.message,a.tests.push({name:"Erro",status:"error",details:i.message}),x(e=>(0,n.A)((0,n.A)({},e),{},{[t]:(0,n.A)((0,n.A)({},e[t]),{},{healthy:!1})}))}N(a),r(!1)},ae=async()=>{M(!0);try{console.log("\ud83d\udd0d Carregando cole\xe7\xf5es de todos os bancos...");const e=await GS();F(e);const t=await WS();H(t),console.log("\u2705 Cole\xe7\xf5es carregadas:",e.totals)}catch(e){console.error("\u274c Erro ao carregar cole\xe7\xf5es:",e),alert("Erro ao carregar cole\xe7\xf5es. Verifique a conex\xe3o com o Firebase.")}finally{M(!1)}},ne=(e,t)=>{$(e),te(t),J(!0)},se=()=>{if(!P)return[];const e=[...P.primary.collections.map(e=>(0,n.A)((0,n.A)({},e),{},{database:"primary"})),...P.backup.collections.map(e=>(0,n.A)((0,n.A)({},e),{},{database:"backup"}))];switch(U){case"primary":return P.primary.collections.filter(e=>e.hasData);case"backup":return P.backup.collections.filter(e=>e.hasData);case"synced":return(null===q||void 0===q?void 0:q.collections.filter(e=>e.inSync&&e.primary.hasData))||[];case"out-of-sync":return(null===q||void 0===q?void 0:q.collections.filter(e=>e.needsSync&&(e.primary.hasData||e.backup.hasData)))||[];default:return e.filter(e=>e.hasData)}};(0,e.useEffect)(()=>{const e=localStorage.getItem("backupSettings");if(e)try{v(JSON.parse(e))}catch(t){console.error("Erro ao carregar configura\xe7\xf5es:",t)}},[]),(0,e.useEffect)(()=>{const e=setTimeout(()=>{ae()},2e3);return()=>clearTimeout(e)},[]),(0,e.useEffect)(()=>{(()=>{try{const e=JSON.parse(localStorage.getItem("firebaseServers")||"[]");Q(e)}catch(e){console.error("\u274c Erro ao carregar servidores:",e),Q([])}})()},[]),(0,e.useEffect)(()=>{const e=setInterval(()=>{const e=m();x(t=>({primary:(0,n.A)((0,n.A)({},t.primary),{},{lastOperation:"primary"===e.activeDatabase?(new Date).toISOString():t.primary.lastOperation}),backup:(0,n.A)((0,n.A)({},t.backup),{},{lastOperation:"backup"===e.activeDatabase?(new Date).toISOString():t.backup.lastOperation})}))},5e3);return()=>clearInterval(e)},[m]);const ie=e=>e?new Date(e).toLocaleString("pt-BR"):"Nunca";return(0,k.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100 dark:from-gray-900 dark:to-gray-800 p-6",children:(0,k.jsxs)("div",{className:"max-w-7xl mx-auto space-y-6",children:[(0,k.jsxs)("div",{className:"flex items-center justify-between",children:[(0,k.jsxs)("div",{children:[(0,k.jsxs)("h1",{className:"text-3xl font-bold text-gray-800 dark:text-white flex items-center gap-3",children:[(0,k.jsx)(mS,{className:"w-8 h-8"}),"Monitoramento de Backup"]}),(0,k.jsx)("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:"Sistema de rota\xe7\xe3o autom\xe1tica entre databases"})]}),(0,k.jsxs)("button",{onClick:()=>T(!C),className:"flex items-center gap-2 px-4 py-2 bg-gray-200 dark:bg-gray-700 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors",children:[(0,k.jsx)(gN,{className:"w-5 h-5"}),"Configura\xe7\xf5es"]})]}),(0,k.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,k.jsxs)(Cd.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"p-6 rounded-xl shadow-lg ".concat("primary"===r?"bg-gradient-to-br from-blue-500 to-blue-600":"bg-gradient-to-br from-blue-600 to-blue-700"," text-white"),children:[(0,k.jsx)(xr,{className:"w-8 h-8 mb-3"}),(0,k.jsx)("div",{className:"text-sm opacity-90",children:"Database Ativo"}),(0,k.jsx)("div",{className:"text-2xl font-bold mt-1",children:"primary"===r?"Principal":"Backup"})]}),(0,k.jsxs)(Cd.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"p-6 rounded-xl shadow-lg bg-white dark:bg-gray-800",children:[(0,k.jsx)(Kd,{className:"w-8 h-8 mb-3 ".concat(o?"animate-spin text-blue-500":"text-gray-400")}),(0,k.jsx)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Status"}),(0,k.jsx)("div",{className:"text-xl font-bold text-gray-800 dark:text-white mt-1",children:o?"Rotacionando":l?"Sincronizando":"Ativo"})]}),(0,k.jsxs)(Cd.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"p-6 rounded-xl shadow-lg bg-white dark:bg-gray-800",children:[(0,k.jsx)(xu,{className:"w-8 h-8 mb-3 text-orange-500"}),(0,k.jsx)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Pr\xf3xima Rota\xe7\xe3o"}),(0,k.jsx)("div",{className:"text-xl font-bold text-gray-800 dark:text-white mt-1",children:(e=>{if(e<0)return"0h 0m";const t=Math.floor(e),r=Math.floor(60*(e-t));return"".concat(t,"h ").concat(r,"m")})(f)})]}),(0,k.jsxs)(Cd.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"p-6 rounded-xl shadow-lg bg-white dark:bg-gray-800",children:[p.primary.healthy&&p.backup.healthy?(0,k.jsx)(Fd,{className:"w-8 h-8 mb-3 text-green-500"}):(0,k.jsx)(b,{className:"w-8 h-8 mb-3 text-red-500"}),(0,k.jsx)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Sa\xfade"}),(0,k.jsx)("div",{className:"text-xl font-bold text-gray-800 dark:text-white mt-1",children:p.primary.healthy&&p.backup.healthy?"Saud\xe1vel":"Alerta"})]})]}),(0,k.jsx)(Pr,{children:(o||l)&&c&&(0,k.jsxs)(Cd.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6",children:[(0,k.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,k.jsxs)("div",{className:"flex items-center gap-3",children:[(0,k.jsx)(Kd,{className:"w-5 h-5 animate-spin text-blue-500"}),(0,k.jsx)("span",{className:"font-semibold text-gray-800 dark:text-white",children:o?"Rota\xe7\xe3o em Andamento":"Sincroniza\xe7\xe3o em Andamento"})]}),(0,k.jsxs)("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:[c.current,"/",c.total," (",c.percentage,"%)"]})]}),(0,k.jsx)("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-3 mb-2",children:(0,k.jsx)(Cd.div,{className:"bg-gradient-to-r from-blue-500 to-blue-700 h-3 rounded-full",initial:{width:0},animate:{width:"".concat(c.percentage,"%")},transition:{duration:.5}})}),(0,k.jsxs)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Sincronizando: ",c.collection]})]})}),(0,k.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,k.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6",children:[(0,k.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,k.jsxs)("div",{className:"flex items-center gap-3",children:[(0,k.jsx)("div",{className:"w-12 h-12 bg-blue-100 dark:bg-blue-900 rounded-xl flex items-center justify-center",children:(0,k.jsx)(xr,{className:"w-6 h-6 text-blue-600 dark:text-blue-400"})}),(0,k.jsxs)("div",{children:[(0,k.jsx)("h3",{className:"text-lg font-bold text-gray-800 dark:text-white",children:"Firebase Principal"}),(0,k.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"garden-c0b50"})]})]}),"primary"===r&&(0,k.jsx)("span",{className:"px-3 py-1 bg-green-100 text-green-700 rounded-full text-sm font-semibold",children:"Ativo"})]}),(0,k.jsxs)("div",{className:"space-y-4",children:[(0,k.jsxs)("div",{className:"flex items-center justify-between py-3 border-b border-gray-200 dark:border-gray-700",children:[(0,k.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"Leituras"}),(0,k.jsx)("span",{className:"font-semibold text-gray-800 dark:text-white",children:p.primary.read.toLocaleString()})]}),(0,k.jsxs)("div",{className:"flex items-center justify-between py-3 border-b border-gray-200 dark:border-gray-700",children:[(0,k.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"Escritas"}),(0,k.jsx)("span",{className:"font-semibold text-gray-800 dark:text-white",children:p.primary.write.toLocaleString()})]}),(0,k.jsxs)("div",{className:"flex items-center justify-between py-3 border-b border-gray-200 dark:border-gray-700",children:[(0,k.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"\xdaltima Opera\xe7\xe3o"}),(0,k.jsx)("span",{className:"font-semibold text-gray-800 dark:text-white text-sm",children:ie(p.primary.lastOperation)})]}),(0,k.jsxs)("div",{className:"flex items-center justify-between py-3",children:[(0,k.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"Status"}),(0,k.jsx)("span",{className:"flex items-center gap-2 font-semibold ".concat(p.primary.healthy?"text-green-600":"text-red-600"),children:p.primary.healthy?(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(Fd,{className:"w-4 h-4"}),"Saud\xe1vel"]}):(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(b,{className:"w-4 h-4"}),"Erro"]})})]})]}),(0,k.jsx)("button",{onClick:()=>re(Xt,"primary"),disabled:j,className:"w-full mt-6 flex items-center justify-center gap-2 px-4 py-3 bg-blue-500 text-white rounded-lg hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:j?(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(Kd,{className:"w-5 h-5 animate-spin"}),"Testando..."]}):(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(Wd,{className:"w-5 h-5"}),"Testar Conex\xe3o"]})})]}),(0,k.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6",children:[(0,k.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,k.jsxs)("div",{className:"flex items-center gap-3",children:[(0,k.jsx)("div",{className:"w-12 h-12 bg-blue-100 dark:bg-blue-900 rounded-xl flex items-center justify-center",children:(0,k.jsx)(xr,{className:"w-6 h-6 text-blue-600 dark:text-blue-400"})}),(0,k.jsxs)("div",{children:[(0,k.jsx)("h3",{className:"text-lg font-bold text-gray-800 dark:text-white",children:"Firebase Backup"}),(0,k.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"garden-backup"})]})]}),"backup"===r&&(0,k.jsx)("span",{className:"px-3 py-1 bg-green-100 text-green-700 rounded-full text-sm font-semibold",children:"Ativo"})]}),(0,k.jsxs)("div",{className:"space-y-4",children:[(0,k.jsxs)("div",{className:"flex items-center justify-between py-3 border-b border-gray-200 dark:border-gray-700",children:[(0,k.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"Leituras"}),(0,k.jsx)("span",{className:"font-semibold text-gray-800 dark:text-white",children:p.backup.read.toLocaleString()})]}),(0,k.jsxs)("div",{className:"flex items-center justify-between py-3 border-b border-gray-200 dark:border-gray-700",children:[(0,k.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"Escritas"}),(0,k.jsx)("span",{className:"font-semibold text-gray-800 dark:text-white",children:p.backup.write.toLocaleString()})]}),(0,k.jsxs)("div",{className:"flex items-center justify-between py-3 border-b border-gray-200 dark:border-gray-700",children:[(0,k.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"\xdaltima Opera\xe7\xe3o"}),(0,k.jsx)("span",{className:"font-semibold text-gray-800 dark:text-white text-sm",children:ie(p.backup.lastOperation)})]}),(0,k.jsxs)("div",{className:"flex items-center justify-between py-3",children:[(0,k.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"Status"}),(0,k.jsx)("span",{className:"flex items-center gap-2 font-semibold ".concat(p.backup.healthy?"text-green-600":"text-red-600"),children:p.backup.healthy?(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(Fd,{className:"w-4 h-4"}),"Saud\xe1vel"]}):(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(b,{className:"w-4 h-4"}),"Erro"]})})]})]}),(0,k.jsx)("button",{onClick:()=>re(Jt,"backup"),disabled:_,className:"w-full mt-6 flex items-center justify-center gap-2 px-4 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:_?(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(Kd,{className:"w-5 h-5 animate-spin"}),"Testando..."]}):(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(Wd,{className:"w-5 h-5"}),"Testar Conex\xe3o"]})})]})]}),(0,k.jsx)(Pr,{children:w&&(0,k.jsxs)(Cd.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6",children:[(0,k.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,k.jsxs)("h3",{className:"text-lg font-bold text-gray-800 dark:text-white flex items-center gap-2",children:[(0,k.jsx)(tu,{className:"w-5 h-5"}),"Resultados do Teste - ",w.database]}),(0,k.jsx)("button",{onClick:()=>N(null),className:"text-gray-500 hover:text-gray-700 dark:hover:text-gray-300",children:"\u2715"})]}),w.success?(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)("div",{className:"mb-4 p-4 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg",children:(0,k.jsxs)("p",{className:"text-green-800 dark:text-green-300 font-semibold flex items-center gap-2",children:[(0,k.jsx)(Fd,{className:"w-5 h-5"}),w.summary]})}),(0,k.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:w.tests.map((e,t)=>(0,k.jsxs)("div",{className:"p-4 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[(0,k.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,k.jsx)("span",{className:"font-semibold text-gray-800 dark:text-white",children:e.name}),(0,k.jsx)(Fd,{className:"w-4 h-4 text-green-500"})]}),(0,k.jsx)("div",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400 mb-1",children:e.time}),(0,k.jsx)("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:e.details})]},t))})]}):(0,k.jsx)("div",{className:"p-4 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg",children:(0,k.jsxs)("p",{className:"text-red-800 dark:text-red-300 font-semibold flex items-center gap-2",children:[(0,k.jsx)(b,{className:"w-5 h-5"}),w.error]})})]})}),(0,k.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,k.jsxs)("button",{onClick:u,disabled:o||l,className:"flex items-center justify-center gap-2 px-6 py-4 bg-gradient-to-r from-blue-500 to-blue-700 text-white rounded-xl hover:from-blue-600 hover:to-blue-800 disabled:opacity-50 disabled:cursor-not-allowed transition-all shadow-lg hover:shadow-xl",children:[(0,k.jsx)(Kd,{className:"w-5 h-5"}),"For\xe7ar Rota\xe7\xe3o Agora"]}),(0,k.jsxs)("button",{onClick:h,disabled:o||l,className:"flex items-center justify-center gap-2 px-6 py-4 bg-gradient-to-r from-green-500 to-teal-600 text-white rounded-xl hover:from-green-600 hover:to-teal-700 disabled:opacity-50 disabled:cursor-not-allowed transition-all shadow-lg hover:shadow-xl",children:[(0,k.jsx)(xr,{className:"w-5 h-5"}),"For\xe7ar Sincroniza\xe7\xe3o"]}),(0,k.jsxs)("button",{onClick:()=>{const e=m();console.log("\ud83d\udcca Info do Sistema:",e),alert("Informa\xe7\xf5es enviadas para o console (F12)")},className:"flex items-center justify-center gap-2 px-6 py-4 bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-white rounded-xl hover:bg-gray-300 dark:hover:bg-gray-600 transition-all shadow-lg hover:shadow-xl",children:[(0,k.jsx)(Pd,{className:"w-5 h-5"}),"Ver M\xe9tricas Completas"]})]}),(0,k.jsx)(Pr,{children:C&&(0,k.jsxs)(Cd.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 overflow-hidden",children:[(0,k.jsxs)("h3",{className:"text-xl font-bold text-gray-800 dark:text-white mb-6 flex items-center gap-2",children:[(0,k.jsx)(gN,{className:"w-6 h-6"}),"Configura\xe7\xf5es do Sistema"]}),(0,k.jsxs)("div",{className:"space-y-6",children:[(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2",children:"Intervalo de Rota\xe7\xe3o (horas)"}),(0,k.jsx)("input",{type:"number",min:"1",max:"168",value:y.rotationInterval,onChange:e=>v((0,n.A)((0,n.A)({},y),{},{rotationInterval:parseInt(e.target.value)})),className:"w-full px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-800 dark:text-white focus:ring-2 focus:ring-blue-500"}),(0,k.jsxs)("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:["Atualmente: ",y.rotationInterval,"h = ",(y.rotationInterval/24).toFixed(1)," dia(s)"]})]}),(0,k.jsxs)("div",{className:"flex items-center justify-between",children:[(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300",children:"Rota\xe7\xe3o Autom\xe1tica"}),(0,k.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Alternar databases automaticamente no intervalo definido"})]}),(0,k.jsx)("button",{onClick:()=>v((0,n.A)((0,n.A)({},y),{},{autoRotate:!y.autoRotate})),className:"relative w-14 h-7 rounded-full transition-colors ".concat(y.autoRotate?"bg-blue-500":"bg-gray-300 dark:bg-gray-600"),children:(0,k.jsx)(Cd.div,{className:"absolute top-1 left-1 w-5 h-5 bg-white rounded-full",animate:{x:y.autoRotate?28:0},transition:{type:"spring",stiffness:500,damping:30}})})]}),(0,k.jsxs)("div",{className:"flex items-center justify-between",children:[(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300",children:"Sincroniza\xe7\xe3o ao Rotacionar"}),(0,k.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Sincronizar dados automaticamente ao alternar databases"})]}),(0,k.jsx)("button",{onClick:()=>v((0,n.A)((0,n.A)({},y),{},{autoSync:!y.autoSync})),className:"relative w-14 h-7 rounded-full transition-colors ".concat(y.autoSync?"bg-green-500":"bg-gray-300 dark:bg-gray-600"),children:(0,k.jsx)(Cd.div,{className:"absolute top-1 left-1 w-5 h-5 bg-white rounded-full",animate:{x:y.autoSync?28:0},transition:{type:"spring",stiffness:500,damping:30}})})]}),(0,k.jsxs)("div",{className:"flex items-center justify-between",children:[(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-semibold text-gray-700 dark:text-gray-300",children:"Notifica\xe7\xf5es"}),(0,k.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Mostrar notifica\xe7\xf5es de rota\xe7\xe3o e sincroniza\xe7\xe3o"})]}),(0,k.jsx)("button",{onClick:()=>v((0,n.A)((0,n.A)({},y),{},{notificationsEnabled:!y.notificationsEnabled})),className:"relative w-14 h-7 rounded-full transition-colors ".concat(y.notificationsEnabled?"bg-blue-600":"bg-gray-300 dark:bg-gray-600"),children:(0,k.jsx)(Cd.div,{className:"absolute top-1 left-1 w-5 h-5 bg-white rounded-full",animate:{x:y.notificationsEnabled?28:0},transition:{type:"spring",stiffness:500,damping:30}})})]}),(0,k.jsxs)("button",{onClick:()=>{localStorage.setItem("backupSettings",JSON.stringify(y)),alert("Configura\xe7\xf5es salvas! Recarregue a p\xe1gina para aplicar.")},className:"w-full flex items-center justify-center gap-2 px-6 py-3 bg-gradient-to-r from-blue-500 to-blue-700 text-white rounded-lg hover:from-blue-600 hover:to-blue-800 transition-all shadow-lg hover:shadow-xl",children:[(0,k.jsx)(uw,{className:"w-5 h-5"}),"Salvar Configura\xe7\xf5es"]})]})]})}),(0,k.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6",children:[(0,k.jsxs)("h3",{className:"text-xl font-bold text-gray-800 dark:text-white mb-6 flex items-center gap-2",children:[(0,k.jsx)(xu,{className:"w-6 h-6"}),"Hist\xf3rico de Rota\xe7\xf5es (\xdaltimas 10)"]}),0===d.length?(0,k.jsx)("p",{className:"text-gray-500 dark:text-gray-400 text-center py-8",children:"Nenhuma rota\xe7\xe3o registrada ainda"}):(0,k.jsx)("div",{className:"space-y-3",children:d.slice(-10).reverse().map((e,t)=>(0,k.jsxs)(Cd.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.05*t},className:"flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[(0,k.jsxs)("div",{className:"flex items-center gap-4",children:[(0,k.jsx)(Kd,{className:"w-5 h-5 text-blue-500"}),(0,k.jsxs)("div",{children:[(0,k.jsxs)("div",{className:"font-semibold text-gray-800 dark:text-white",children:[e.from," \u2192 ",e.to]}),(0,k.jsx)("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:ie(e.timestamp)})]})]}),e.synced&&e.syncResult&&(0,k.jsxs)("div",{className:"text-sm text-green-600 dark:text-green-400 flex items-center gap-2",children:[(0,k.jsx)(Fd,{className:"w-4 h-4"}),e.syncResult.totalSynced||0," docs sincronizados"]})]},t))})]}),(0,k.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6",children:[(0,k.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,k.jsxs)("div",{className:"flex items-center gap-3",children:[(0,k.jsxs)("h3",{className:"text-xl font-bold text-gray-800 dark:text-white flex items-center gap-2",children:[(0,k.jsx)(i_,{className:"w-6 h-6"}),"Cole\xe7\xf5es dos Bancos de Dados"]}),P&&(0,k.jsxs)("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:[P.totals.databases," bancos \u2022 ",P.totals.collections," cole\xe7\xf5es \u2022 ",P.totals.documents.toLocaleString()," documentos"]})]}),(0,k.jsxs)("div",{className:"flex items-center gap-2",children:[(0,k.jsxs)("button",{onClick:()=>{ae()},disabled:L,className:"flex items-center gap-2 px-4 py-2 bg-blue-100 dark:bg-blue-900 text-blue-700 dark:text-blue-300 rounded-lg hover:bg-blue-200 dark:hover:bg-blue-800 transition-colors disabled:opacity-50",children:[(0,k.jsx)(Kd,{className:"w-4 h-4 ".concat(L?"animate-spin":"")}),"Atualizar"]}),(0,k.jsxs)("button",{onClick:()=>O(!R),className:"flex items-center gap-2 px-4 py-2 bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors",children:[R?(0,k.jsx)(gr,{className:"w-4 h-4"}):(0,k.jsx)(pr,{className:"w-4 h-4"}),R?"Ocultar":"Mostrar"]})]})]}),P&&(0,k.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[(0,k.jsxs)("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 dark:from-blue-900/20 dark:to-blue-800/20 rounded-lg p-4",children:[(0,k.jsx)("div",{className:"text-sm text-gray-600 dark:text-gray-400 mb-1",children:"Firebase Principal"}),(0,k.jsx)("div",{className:"text-2xl font-bold text-gray-800 dark:text-white",children:P.primary.totalCollections}),(0,k.jsxs)("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:[P.primary.totalDocuments.toLocaleString()," docs"]})]}),(0,k.jsxs)("div",{className:"bg-gradient-to-br from-purple-50 to-purple-100 dark:from-purple-900/20 dark:to-purple-800/20 rounded-lg p-4",children:[(0,k.jsx)("div",{className:"text-sm text-gray-600 dark:text-gray-400 mb-1",children:"Firebase Backup"}),(0,k.jsx)("div",{className:"text-2xl font-bold text-gray-800 dark:text-white",children:P.backup.totalCollections}),(0,k.jsxs)("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:[P.backup.totalDocuments.toLocaleString()," docs"]})]}),q&&(0,k.jsxs)(k.Fragment,{children:[(0,k.jsxs)("div",{className:"bg-gradient-to-br from-green-50 to-green-100 dark:from-green-900/20 dark:to-green-800/20 rounded-lg p-4",children:[(0,k.jsx)("div",{className:"text-sm text-gray-600 dark:text-gray-400 mb-1",children:"Sincronizadas"}),(0,k.jsx)("div",{className:"text-2xl font-bold text-gray-800 dark:text-white",children:q.summary.synced}),(0,k.jsxs)("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:[q.summary.syncPercentage,"% do total"]})]}),(0,k.jsxs)("div",{className:"bg-gradient-to-br from-red-50 to-red-100 dark:from-red-900/20 dark:to-red-800/20 rounded-lg p-4",children:[(0,k.jsx)("div",{className:"text-sm text-gray-600 dark:text-gray-400 mb-1",children:"Dessincronizadas"}),(0,k.jsx)("div",{className:"text-2xl font-bold text-gray-800 dark:text-white",children:q.summary.outOfSync}),(0,k.jsx)("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Precisam sync"})]})]})]}),L&&(0,k.jsxs)("div",{className:"text-center py-8",children:[(0,k.jsx)(Kd,{className:"w-8 h-8 animate-spin mx-auto mb-4 text-blue-500"}),(0,k.jsx)("p",{className:"text-gray-500 dark:text-gray-400",children:"Carregando cole\xe7\xf5es..."})]}),(0,k.jsx)(Pr,{children:R&&P&&(0,k.jsxs)(Cd.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"overflow-hidden",children:[(0,k.jsxs)("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4 mb-6",children:[(0,k.jsxs)("div",{className:"flex items-center gap-2",children:[(0,k.jsx)(tw,{className:"w-4 h-4 text-gray-500"}),(0,k.jsxs)("select",{value:U,onChange:e=>V(e.target.value),className:"px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-800 dark:text-white text-sm",children:[(0,k.jsx)("option",{value:"all",children:"Todas as Cole\xe7\xf5es"}),(0,k.jsx)("option",{value:"primary",children:"Apenas Principal"}),(0,k.jsx)("option",{value:"backup",children:"Apenas Backup"}),(0,k.jsx)("option",{value:"synced",children:"Sincronizadas"}),(0,k.jsx)("option",{value:"out-of-sync",children:"Dessincronizadas"})]})]}),(0,k.jsxs)("div",{className:"flex items-center gap-2",children:[(0,k.jsx)("button",{onClick:()=>z("grid"),className:"p-2 rounded-lg transition-colors ".concat("grid"===B?"bg-blue-100 dark:bg-blue-900 text-blue-700 dark:text-blue-300":"bg-gray-100 dark:bg-gray-700 text-gray-500 dark:text-gray-400"),children:(0,k.jsx)(n_,{className:"w-4 h-4"})}),(0,k.jsx)("button",{onClick:()=>z("list"),className:"p-2 rounded-lg transition-colors ".concat("list"===B?"bg-blue-100 dark:bg-blue-900 text-blue-700 dark:text-blue-300":"bg-gray-100 dark:bg-gray-700 text-gray-500 dark:text-gray-400"),children:(0,k.jsx)(iS,{className:"w-4 h-4"})})]})]}),"grid"===B?(0,k.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:se().map((e,t)=>{var r;return(0,k.jsxs)(Cd.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.05*t},className:"bg-gradient-to-br from-gray-50 to-gray-100 dark:from-gray-700 dark:to-gray-600 rounded-lg p-4 border border-gray-200 dark:border-gray-600",children:[(0,k.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,k.jsxs)("div",{className:"flex items-center gap-2",children:[(0,k.jsx)(A,{className:"w-5 h-5 text-blue-500"}),(0,k.jsx)("h4",{className:"font-semibold text-gray-800 dark:text-white",children:e.name})]}),(0,k.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat("primary"===e.database?"bg-blue-100 text-blue-700 dark:bg-blue-900 dark:text-blue-300":"bg-purple-100 text-purple-700 dark:bg-purple-900 dark:text-purple-300"),children:"primary"===e.database?"Principal":"Backup"})]}),(0,k.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,k.jsxs)("div",{className:"flex justify-between",children:[(0,k.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"Documentos:"}),(0,k.jsx)("span",{className:"font-medium text-gray-800 dark:text-white",children:(null===(r=e.documentCount)||void 0===r?void 0:r.toLocaleString())||0})]}),e.lastUpdated&&(0,k.jsxs)("div",{className:"flex justify-between",children:[(0,k.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"Atualizada:"}),(0,k.jsx)("span",{className:"font-medium text-gray-800 dark:text-white text-xs",children:ie(e.lastUpdated)})]}),e.error&&(0,k.jsxs)("div",{className:"text-red-500 text-xs mt-2",children:["Erro: ",e.error]})]}),(0,k.jsx)("div",{className:"mt-4 pt-3 border-t border-gray-200 dark:border-gray-600",children:(0,k.jsxs)("button",{onClick:()=>ne(e,e.database),className:"w-full flex items-center justify-center gap-2 px-3 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded-lg transition-colors text-sm font-medium",children:[(0,k.jsx)(pr,{className:"w-4 h-4"}),"Ver Detalhes"]})})]},"".concat(e.database,"-").concat(e.name))})}):(0,k.jsx)("div",{className:"space-y-2",children:se().map((e,t)=>{var r;return(0,k.jsxs)(Cd.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.02*t},className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[(0,k.jsxs)("div",{className:"flex items-center gap-3",children:[(0,k.jsx)(A,{className:"w-4 h-4 text-blue-500"}),(0,k.jsx)("span",{className:"font-medium text-gray-800 dark:text-white",children:e.name}),(0,k.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat("primary"===e.database?"bg-blue-100 text-blue-700 dark:bg-blue-900 dark:text-blue-300":"bg-purple-100 text-purple-700 dark:bg-purple-900 dark:text-purple-300"),children:"primary"===e.database?"Principal":"Backup"})]}),(0,k.jsxs)("div",{className:"flex items-center gap-4 text-sm",children:[(0,k.jsxs)("span",{className:"text-gray-600 dark:text-gray-400",children:[(null===(r=e.documentCount)||void 0===r?void 0:r.toLocaleString())||0," docs"]}),e.lastUpdated&&(0,k.jsx)("span",{className:"text-gray-500 dark:text-gray-400 text-xs",children:ie(e.lastUpdated)}),(0,k.jsxs)("button",{onClick:()=>ne(e,e.database),className:"flex items-center gap-2 px-3 py-1 bg-blue-500 hover:bg-blue-600 text-white rounded-lg transition-colors text-sm",children:[(0,k.jsx)(pr,{className:"w-4 h-4"}),"Ver Detalhes"]})]})]},"".concat(e.database,"-").concat(e.name))})}),0===se().length&&(0,k.jsxs)("div",{className:"text-center py-8",children:[(0,k.jsx)(i_,{className:"w-12 h-12 mx-auto mb-4 text-gray-400"}),(0,k.jsx)("p",{className:"text-gray-500 dark:text-gray-400",children:"Nenhuma cole\xe7\xe3o encontrada com o filtro selecionado"})]})]})}),!P&&!L&&(0,k.jsx)("div",{className:"text-center py-8",children:(0,k.jsxs)("button",{onClick:ae,className:"flex items-center gap-2 mx-auto px-6 py-3 bg-blue-500 hover:bg-blue-600 text-white rounded-lg transition-colors",children:[(0,k.jsx)(Ft,{className:"w-5 h-5"}),"Carregar Cole\xe7\xf5es"]})})]}),(0,k.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6",children:[(0,k.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,k.jsxs)("div",{className:"flex items-center gap-3",children:[(0,k.jsxs)("h3",{className:"text-xl font-bold text-gray-800 dark:text-white flex items-center gap-2",children:[(0,k.jsx)(KS,{className:"w-6 h-6"}),"Gerenciamento de Servidores"]}),(0,k.jsxs)("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:[2+K.length," servidores conectados"]})]}),(0,k.jsxs)("button",{onClick:()=>W(!0),className:"flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-green-500 to-green-600 text-white rounded-lg hover:from-green-600 hover:to-green-700 transition-all shadow-lg hover:shadow-xl",children:[(0,k.jsx)(D,{className:"w-4 h-4"}),"Adicionar Servidor"]})]}),(0,k.jsxs)("div",{className:"space-y-4",children:[(0,k.jsxs)("h4",{className:"text-lg font-semibold text-gray-800 dark:text-white flex items-center gap-2",children:[(0,k.jsx)(I,{className:"w-5 h-5"}),"Servidores Padr\xe3o"]}),(0,k.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,k.jsxs)("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 dark:from-blue-900/20 dark:to-blue-800/20 rounded-lg p-4 border border-blue-200 dark:border-blue-800",children:[(0,k.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,k.jsxs)("div",{className:"flex items-center gap-2",children:[(0,k.jsx)(xr,{className:"w-5 h-5 text-blue-500"}),(0,k.jsx)("h5",{className:"font-semibold text-gray-800 dark:text-white",children:"Firebase Principal"})]}),(0,k.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat("primary"===r?"bg-green-100 text-green-700 dark:bg-green-900 dark:text-green-300":"bg-gray-100 text-gray-700 dark:bg-gray-900 dark:text-gray-300"),children:"primary"===r?"Ativo":"Inativo"})]}),(0,k.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,k.jsxs)("div",{className:"flex justify-between",children:[(0,k.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"Project ID:"}),(0,k.jsx)("span",{className:"font-medium text-gray-800 dark:text-white",children:"garden-c0b50"})]}),(0,k.jsxs)("div",{className:"flex justify-between",children:[(0,k.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"Status:"}),(0,k.jsxs)("span",{className:"flex items-center gap-1 text-green-600",children:[(0,k.jsx)(Fd,{className:"w-3 h-3"}),"Conectado"]})]}),P&&(0,k.jsxs)("div",{className:"flex justify-between",children:[(0,k.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"Cole\xe7\xf5es:"}),(0,k.jsx)("span",{className:"font-medium text-gray-800 dark:text-white",children:P.primary.totalCollections})]})]})]}),(0,k.jsxs)("div",{className:"bg-gradient-to-br from-purple-50 to-purple-100 dark:from-purple-900/20 dark:to-purple-800/20 rounded-lg p-4 border border-purple-200 dark:border-purple-800",children:[(0,k.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,k.jsxs)("div",{className:"flex items-center gap-2",children:[(0,k.jsx)(xr,{className:"w-5 h-5 text-purple-500"}),(0,k.jsx)("h5",{className:"font-semibold text-gray-800 dark:text-white",children:"Firebase Backup"})]}),(0,k.jsx)("span",{className:"px-2 py-1 rounded-full text-xs font-medium ".concat("backup"===r?"bg-green-100 text-green-700 dark:bg-green-900 dark:text-green-300":"bg-gray-100 text-gray-700 dark:bg-gray-900 dark:text-gray-300"),children:"backup"===r?"Ativo":"Inativo"})]}),(0,k.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,k.jsxs)("div",{className:"flex justify-between",children:[(0,k.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"Project ID:"}),(0,k.jsx)("span",{className:"font-medium text-gray-800 dark:text-white",children:"garden-backup"})]}),(0,k.jsxs)("div",{className:"flex justify-between",children:[(0,k.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"Status:"}),(0,k.jsxs)("span",{className:"flex items-center gap-1 text-green-600",children:[(0,k.jsx)(Fd,{className:"w-3 h-3"}),"Conectado"]})]}),P&&(0,k.jsxs)("div",{className:"flex justify-between",children:[(0,k.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"Cole\xe7\xf5es:"}),(0,k.jsx)("span",{className:"font-medium text-gray-800 dark:text-white",children:P.backup.totalCollections})]})]})]})]})]}),K.length>0&&(0,k.jsxs)("div",{className:"space-y-4 mt-6",children:[(0,k.jsxs)("h4",{className:"text-lg font-semibold text-gray-800 dark:text-white flex items-center gap-2",children:[(0,k.jsx)(o_,{className:"w-5 h-5"}),"Servidores Customizados"]}),(0,k.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:K.map(e=>(0,k.jsxs)(Cd.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-gradient-to-br from-gray-50 to-gray-100 dark:from-gray-700 dark:to-gray-600 rounded-lg p-4 border border-gray-200 dark:border-gray-600",children:[(0,k.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,k.jsxs)("div",{className:"flex items-center gap-2",children:[(0,k.jsx)(KS,{className:"w-5 h-5 text-gray-500"}),(0,k.jsx)("h5",{className:"font-semibold text-gray-800 dark:text-white",children:e.name})]}),(0,k.jsx)("button",{onClick:()=>(e=>{if(confirm("Tem certeza que deseja remover este servidor?")){const t=K.filter(t=>t.id!==e);Q(t),localStorage.setItem("firebaseServers",JSON.stringify(t))}})(e.id),className:"text-red-500 hover:text-red-700 p-1",children:(0,k.jsx)(X,{className:"w-4 h-4"})})]}),(0,k.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,k.jsxs)("div",{className:"flex justify-between",children:[(0,k.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"Project ID:"}),(0,k.jsx)("span",{className:"font-medium text-gray-800 dark:text-white",children:e.config.projectId})]}),(0,k.jsxs)("div",{className:"flex justify-between",children:[(0,k.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"Adicionado:"}),(0,k.jsx)("span",{className:"font-medium text-gray-800 dark:text-white text-xs",children:ie(e.createdAt)})]}),e.description&&(0,k.jsx)("div",{className:"text-gray-600 dark:text-gray-400 text-xs mt-2",children:e.description}),(0,k.jsxs)("div",{className:"flex justify-between mt-3",children:[(0,k.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"Status:"}),(0,k.jsxs)("span",{className:"flex items-center gap-1 text-orange-600",children:[(0,k.jsx)(xu,{className:"w-3 h-3"}),"Standby"]})]})]})]},e.id))})]}),0===K.length&&(0,k.jsxs)("div",{className:"mt-6 text-center py-8 border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg",children:[(0,k.jsx)(KS,{className:"w-12 h-12 mx-auto mb-4 text-gray-400"}),(0,k.jsx)("p",{className:"text-gray-500 dark:text-gray-400 mb-4",children:"Nenhum servidor customizado adicionado"}),(0,k.jsxs)("button",{onClick:()=>W(!0),className:"flex items-center gap-2 mx-auto px-6 py-3 bg-blue-500 hover:bg-blue-600 text-white rounded-lg transition-colors",children:[(0,k.jsx)(D,{className:"w-5 h-5"}),"Adicionar Primeiro Servidor"]})]})]}),(0,k.jsx)(YS,{isOpen:G,onClose:()=>W(!1),onServerAdded:e=>{Q(t=>[...t,e]),console.log("\u2705 Novo servidor adicionado:",e.name)}}),(0,k.jsx)(s_,{isOpen:Y,onClose:()=>{J(!1),$(null),te(null)},collection:Z,database:ee})]})})};class d_ extends e.Component{constructor(e){super(e),this.state={hasError:!1,error:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){console.error("\u274c Erro no BackupMonitoringPage:",e,t)}render(){var e;return this.state.hasError?(0,k.jsx)(l_,{message:"Erro ao carregar o sistema de backup",details:null===(e=this.state.error)||void 0===e?void 0:e.message}):this.props.children}}const u_=()=>(0,k.jsx)(d_,{children:(0,k.jsx)(c_,{})}),h_=y("code",[["path",{d:"m16 18 6-6-6-6",key:"eg8j8"}],["path",{d:"m8 6-6 6 6 6",key:"ppft3o"}]]),m_=y("external-link",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]),f_=()=>{const{usuario:t}=Nt(),[r,a]=(0,e.useState)([]),[i,o]=(0,e.useState)(!0),[l,c]=(0,e.useState)("todos"),[d,u]=(0,e.useState)(""),[h,m]=(0,e.useState)(null),[f,g]=(0,e.useState)(!1),p=At(null===t||void 0===t?void 0:t.nivel);(0,e.useEffect)(()=>{if(null===t||void 0===t||!t.id)return;let e;e=p?(0,s.P)((0,s.collection)(P.db,"errorReports"),(0,s.My)("timestamp","desc")):(0,s.P)((0,s.collection)(P.db,"errorReports"),(0,s._M)("usuarioId","==",t.id),(0,s.My)("timestamp","desc"));const r=(0,s.aQ)(e,e=>{const t=e.docs.map(e=>(0,n.A)({id:e.id},e.data()));a(t),o(!1)});return()=>r()},[null===t||void 0===t?void 0:t.id,p]);const x=r.filter(e=>{var t,r,a;const n="todos"===l||e.status===l,s=!d||(null===(t=e.errorMessage)||void 0===t?void 0:t.toLowerCase().includes(d.toLowerCase()))||(null===(r=e.usuarioNome)||void 0===r?void 0:r.toLowerCase().includes(d.toLowerCase()))||(null===(a=e.errorCode)||void 0===a?void 0:a.toLowerCase().includes(d.toLowerCase()));return n&&s}),y=async(e,r)=>{try{const a=(0,s.doc)(P.db,"errorReports",e);await(0,s.updateDoc)(a,{status:r,atualizadoEm:(new Date).toISOString(),atualizadoPor:t.email})}catch(a){console.error("Erro ao atualizar status:",a)}},v=e=>{let{status:t}=e;const r={pendente:{color:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-300",icon:xu,label:"Pendente"},analisando:{color:"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-300",icon:Kd,label:"Analisando"},resolvido:{color:"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300",icon:Fd,label:"Resolvido"},fechado:{color:"bg-gray-100 text-gray-800 dark:bg-gray-900/30 dark:text-gray-300",icon:b,label:"Fechado"}},a=r[t]||r.pendente,n=a.icon;return(0,k.jsxs)("span",{className:"inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium ".concat(a.color),children:[(0,k.jsx)(n,{className:"w-3 h-3"}),a.label]})},w=e=>{var t,r,a;let{relatorio:n,onClose:i}=e;return n?(0,k.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",children:(0,k.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-2xl max-w-3xl w-full max-h-[90vh] overflow-hidden flex flex-col",children:[(0,k.jsx)("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:(0,k.jsxs)("div",{className:"flex items-start justify-between gap-4",children:[(0,k.jsxs)("div",{className:"flex-1",children:[(0,k.jsx)("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:"Detalhes do Erro"}),(0,k.jsx)(v,{status:n.status})]}),(0,k.jsx)("button",{onClick:i,className:"p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:(0,k.jsx)(b,{className:"w-6 h-6 text-gray-500"})})]})}),(0,k.jsxs)("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:[(0,k.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-900/50 rounded-xl p-4",children:[(0,k.jsxs)("h3",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-3 flex items-center gap-2",children:[(0,k.jsx)(mu,{className:"w-4 h-4"}),"Informa\xe7\xf5es do Usu\xe1rio"]}),(0,k.jsxs)("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[(0,k.jsxs)("div",{children:[(0,k.jsx)("span",{className:"text-gray-500 dark:text-gray-400",children:"Nome:"}),(0,k.jsx)("p",{className:"text-gray-900 dark:text-white font-medium",children:n.usuarioNome})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("span",{className:"text-gray-500 dark:text-gray-400",children:"Email:"}),(0,k.jsx)("p",{className:"text-gray-900 dark:text-white font-medium",children:n.usuarioEmail})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("span",{className:"text-gray-500 dark:text-gray-400",children:"Data:"}),(0,k.jsx)("p",{className:"text-gray-900 dark:text-white font-medium",children:hb(new Date(n.timestamp),"dd/MM/yyyy '\xe0s' HH:mm",{locale:yb})})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("span",{className:"text-gray-500 dark:text-gray-400",children:"C\xf3digo:"}),(0,k.jsx)("p",{className:"text-gray-900 dark:text-white font-mono font-medium",children:n.errorCode})]})]})]}),(0,k.jsxs)("div",{children:[(0,k.jsxs)("h3",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2 flex items-center gap-2",children:[(0,k.jsx)(rw,{className:"w-4 h-4"}),"Mensagem de Erro"]}),(0,k.jsx)("div",{className:"bg-red-50 dark:bg-red-900/20 rounded-xl p-4",children:(0,k.jsx)("p",{className:"text-sm text-red-800 dark:text-red-300 font-mono break-all",children:n.errorMessage})})]}),n.errorStack&&(0,k.jsxs)("div",{children:[(0,k.jsxs)("h3",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2 flex items-center gap-2",children:[(0,k.jsx)(h_,{className:"w-4 h-4"}),"Stack Trace"]}),(0,k.jsx)("div",{className:"bg-gray-900 rounded-xl p-4 overflow-x-auto",children:(0,k.jsx)("pre",{className:"text-xs text-green-400 font-mono whitespace-pre-wrap break-all",children:n.errorStack})})]}),n.descricao&&(0,k.jsxs)("div",{children:[(0,k.jsxs)("h3",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-2 flex items-center gap-2",children:[(0,k.jsx)(Rd,{className:"w-4 h-4"}),"Descri\xe7\xe3o do Usu\xe1rio"]}),(0,k.jsx)("div",{className:"bg-blue-50 dark:bg-blue-900/20 rounded-xl p-4",children:(0,k.jsx)("p",{className:"text-sm text-gray-700 dark:text-gray-300",children:n.descricao})})]}),(0,k.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-900/50 rounded-xl p-4",children:[(0,k.jsx)("h3",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300 mb-3",children:"Informa\xe7\xf5es T\xe9cnicas"}),(0,k.jsxs)("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[(0,k.jsxs)("div",{children:[(0,k.jsx)("span",{className:"text-gray-500 dark:text-gray-400",children:"Navegador:"}),(0,k.jsx)("p",{className:"text-gray-900 dark:text-white font-medium",children:(null===(t=n.browserInfo)||void 0===t?void 0:t.name)||"N/A"})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("span",{className:"text-gray-500 dark:text-gray-400",children:"Vers\xe3o:"}),(0,k.jsx)("p",{className:"text-gray-900 dark:text-white font-medium",children:(null===(r=n.browserInfo)||void 0===r?void 0:r.version)||"N/A"})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("span",{className:"text-gray-500 dark:text-gray-400",children:"SO:"}),(0,k.jsx)("p",{className:"text-gray-900 dark:text-white font-medium",children:(null===(a=n.browserInfo)||void 0===a?void 0:a.os)||"N/A"})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("span",{className:"text-gray-500 dark:text-gray-400",children:"URL:"}),(0,k.jsx)("p",{className:"text-gray-900 dark:text-white font-medium truncate",children:n.url||"N/A"})]})]})]})]}),p&&(0,k.jsxs)("div",{className:"p-6 border-t border-gray-200 dark:border-gray-700 flex gap-3",children:[(0,k.jsx)("button",{onClick:()=>y(n.id,"analisando"),disabled:"analisando"===n.status,className:"flex-1 px-4 py-2 bg-blue-500 hover:bg-blue-600 disabled:bg-gray-300 dark:disabled:bg-gray-700 text-white rounded-lg font-medium transition-colors",children:"Marcar como Analisando"}),(0,k.jsx)("button",{onClick:()=>y(n.id,"resolvido"),disabled:"resolvido"===n.status,className:"flex-1 px-4 py-2 bg-green-500 hover:bg-green-600 disabled:bg-gray-300 dark:disabled:bg-gray-700 text-white rounded-lg font-medium transition-colors",children:"Marcar como Resolvido"}),(0,k.jsx)("button",{onClick:()=>(async e=>{if(window.confirm("Tem certeza que deseja excluir este relat\xf3rio?"))try{await(0,s.deleteDoc)((0,s.doc)(P.db,"errorReports",e))}catch(t){console.error("Erro ao excluir relat\xf3rio:",t)}})(n.id),className:"px-4 py-2 bg-red-500 hover:bg-red-600 text-white rounded-lg font-medium transition-colors",children:(0,k.jsx)(nw,{className:"w-5 h-5"})})]})]})}):null};return i?(0,k.jsx)("div",{className:"flex items-center justify-center h-96",children:(0,k.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})}):(0,k.jsxs)("div",{className:"space-y-6",children:[(0,k.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-sm border border-gray-200 dark:border-gray-700",children:[(0,k.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,k.jsxs)("div",{children:[(0,k.jsxs)("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white flex items-center gap-2",children:[(0,k.jsx)(rw,{className:"w-7 h-7 text-red-500"}),"Relat\xf3rios de Erros"]}),(0,k.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1",children:p?"Gerencie todos os relat\xf3rios de erro do sistema":"Seus relat\xf3rios de erro enviados"})]}),(0,k.jsxs)("div",{className:"flex items-center gap-2",children:[(0,k.jsx)("span",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:x.length}),(0,k.jsx)("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:1===x.length?"relat\xf3rio":"relat\xf3rios"})]})]}),(0,k.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4",children:[(0,k.jsxs)("div",{className:"flex-1 relative",children:[(0,k.jsx)(Ft,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),(0,k.jsx)("input",{type:"text",placeholder:"Buscar por mensagem, usu\xe1rio ou c\xf3digo...",value:d,onChange:e=>u(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),(0,k.jsxs)("div",{className:"flex items-center gap-2",children:[(0,k.jsx)(tw,{className:"w-5 h-5 text-gray-400"}),(0,k.jsxs)("select",{value:l,onChange:e=>c(e.target.value),className:"px-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,k.jsx)("option",{value:"todos",children:"Todos"}),(0,k.jsx)("option",{value:"pendente",children:"Pendente"}),(0,k.jsx)("option",{value:"analisando",children:"Analisando"}),(0,k.jsx)("option",{value:"resolvido",children:"Resolvido"}),(0,k.jsx)("option",{value:"fechado",children:"Fechado"})]})]})]})]}),0===x.length?(0,k.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-12 text-center border border-gray-200 dark:border-gray-700",children:[(0,k.jsx)(Fd,{className:"w-16 h-16 text-green-500 mx-auto mb-4"}),(0,k.jsx)("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white mb-2",children:"Nenhum erro encontrado"}),(0,k.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:d||"todos"!==l?"Tente ajustar os filtros de busca":"N\xe3o h\xe1 relat\xf3rios de erro no momento"})]}):(0,k.jsx)("div",{className:"space-y-3",children:x.map(e=>(0,k.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-sm border border-gray-200 dark:border-gray-700 hover:shadow-md transition-shadow cursor-pointer",onClick:()=>{m(e),g(!0)},children:(0,k.jsxs)("div",{className:"flex items-start justify-between gap-4",children:[(0,k.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,k.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,k.jsx)(v,{status:e.status}),(0,k.jsx)("span",{className:"text-xs text-gray-500 dark:text-gray-400 font-mono",children:e.errorCode})]}),(0,k.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-1 truncate",children:e.errorMessage}),(0,k.jsxs)("div",{className:"flex items-center gap-4 text-sm text-gray-600 dark:text-gray-400",children:[(0,k.jsxs)("span",{className:"flex items-center gap-1",children:[(0,k.jsx)(mu,{className:"w-4 h-4"}),e.usuarioNome]}),(0,k.jsxs)("span",{className:"flex items-center gap-1",children:[(0,k.jsx)(iu,{className:"w-4 h-4"}),hb(new Date(e.timestamp),"dd/MM/yyyy '\xe0s' HH:mm",{locale:yb})]})]})]}),(0,k.jsx)(m_,{className:"w-5 h-5 text-gray-400 flex-shrink-0"})]})},e.id))}),f&&(0,k.jsx)(w,{relatorio:h,onClose:()=>{g(!1),m(null)}})]})},g_=y("key",[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]]),p_=y("user-plus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]),x_=()=>{const e="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",t=[];for(let r=0;r<3;r++){let r="";for(let t=0;t<3;t++)r+=e.charAt(Math.floor(36*Math.random()));t.push(r)}return t.join("-")},y_=async(e,t)=>{try{console.log("\ud83d\udd0d Validando c\xf3digo:",{codigo:e,usuarioEmail:t});const r=(0,s.P)((0,s.collection)(Jt,"codigosRedefinicao"),(0,s._M)("codigo","==",e.toUpperCase())),a=await(0,s.GG)(r);if(a.empty)return console.log("\u274c C\xf3digo n\xe3o encontrado"),{valido:!1,motivo:"C\xf3digo inv\xe1lido ou n\xe3o existe"};const n=a.docs[0],i=n.data();if(console.log("\ud83d\udccb C\xf3digo encontrado:",{usado:i.usado,expiraEm:i.expiraEm,usuarioEmail:i.usuarioEmail}),i.usado)return console.log("\u274c C\xf3digo j\xe1 foi usado"),{valido:!1,motivo:"Este c\xf3digo j\xe1 foi utilizado"};const o=new Date(i.expiraEm);return new Date>o?(console.log("\u274c C\xf3digo expirado"),{valido:!1,motivo:"Este c\xf3digo expirou"}):i.usuarioEmail&&i.usuarioEmail!==t?(console.log("\u274c C\xf3digo n\xe3o pertence a este usu\xe1rio"),{valido:!1,motivo:"Este c\xf3digo n\xe3o pode ser usado por este usu\xe1rio"}):(console.log("\u2705 C\xf3digo v\xe1lido!"),{valido:!0,id:n.id,codigo:i.codigo,usuarioEmail:i.usuarioEmail,empresaId:i.empresaId,setorId:i.setorId,nivelUsuario:i.nivelUsuario||"usuario"})}catch(r){return console.error("\u274c Erro ao validar c\xf3digo:",r),{valido:!1,motivo:"Erro ao validar c\xf3digo: "+r.message}}},v_=()=>{var t,r;const{usuario:a,usuarios:i}=Nt(),[o,l]=(0,e.useState)("redefinicao"),[c,d]=(0,e.useState)([]),[u,h]=(0,e.useState)([]),[m,f]=(0,e.useState)(!1),[g,p]=(0,e.useState)(!1),[x,y]=(0,e.useState)(""),[v,b]=(0,e.useState)(24),[N,j]=(0,e.useState)(""),[S,_]=(0,e.useState)(""),[E,A]=(0,e.useState)("1"),[C,P]=(0,e.useState)([]),[F,L]=(0,e.useState)([]),[M,R]=(0,e.useState)(null),[O,B]=(0,e.useState)(!1),[z,U]=(0,e.useState)(""),[V,q]=(0,e.useState)("todos"),[H,G]=(0,e.useState)("");(0,e.useEffect)(()=>{Q(),W();const e=setInterval(Q,3e4);return()=>clearInterval(e)},[o]),(0,e.useEffect)(()=>{N?K(N):(L([]),_(""))},[N]);const W=async()=>{try{console.log("\ud83c\udfe2 Carregando empresas...");const e=(0,s.collection)(ar,"empresas"),t=(await(0,s.GG)(e)).docs.map(e=>(0,n.A)({id:e.id},e.data()));console.log("\u2705 Empresas carregadas:",t),P(t)}catch(e){console.error("\u274c Erro ao carregar empresas:",e)}},K=async e=>{try{console.log("\ud83d\udcc1 Carregando setores para empresa:",e);const t=(0,s.collection)(ar,"setores"),r=(await(0,s.GG)(t)).docs.map(e=>(0,n.A)({id:e.id},e.data()));console.log("\ud83d\udccb Todos os setores:",r);const a=r.filter(t=>t.empresaId===e);console.log("\u2705 Setores filtrados:",a),L(a)}catch(t){console.error("\u274c Erro ao carregar setores:",t)}},Q=async()=>{if("redefinicao"===o){const e=await(async()=>{try{const e=(0,s.P)((0,s.collection)(Jt,"codigosRedefinicao"),(0,s._M)("usado","==",!1)),t=await(0,s.GG)(e),r=[],a=new Date;return t.forEach(e=>{const t=e.data(),s=new Date(t.expiraEm),i=a>s;r.push((0,n.A)((0,n.A)({id:e.id},t),{},{expirado:i,tempoRestante:i?0:Math.floor((s-a)/6e4)}))}),r.sort((e,t)=>new Date(t.criadoEm)-new Date(e.criadoEm)),{success:!0,codigos:r}}catch(e){return console.error("\u274c Erro ao listar c\xf3digos:",e),{success:!1,codigos:[],error:e.message}}})();e.success&&d(e.codigos)}else if("criacao"===o){const e=await(async()=>{try{const e=await(0,s.GG)((0,s.collection)(Jt,"codigosCriacaoContas")),t=new Date,r=e.docs.map(e=>{const r=e.data(),a=new Date(r.expiraEm),n=t>a||r.usado,s=n?0:Math.max(0,Math.floor((a-t)/6e4));return{id:e.id,codigo:r.codigo,tipo:"criacao",usuarioEmail:null,criadoPor:r.criadoPor,criadoEm:r.criadoEm,expiraEm:r.expiraEm,usado:r.usado,usadoEm:r.usadoEm,usadoPor:r.usadoPor,empresaId:r.empresaId,setorId:r.setorId,nivelUsuario:r.nivelUsuario,expirado:n,tempoRestante:s}});return r.sort((e,t)=>new Date(t.criadoEm)-new Date(e.criadoEm)),console.log("\ud83d\udccb ".concat(r.length," c\xf3digos de cria\xe7\xe3o encontrados")),{success:!0,codigos:r}}catch(e){return console.error("\u274c Erro ao listar c\xf3digos de cria\xe7\xe3o:",e),{success:!1,codigos:[],error:e.message}}})();e.success&&h(e.codigos)}},Y=async e=>{if(!confirm("Tem certeza que deseja revogar este c\xf3digo?"))return;const t=await(async e=>{try{return await(0,s.deleteDoc)((0,s.doc)(Jt,"codigosRedefinicao",e)),console.log("\u2705 C\xf3digo revogado:",e),{success:!0,message:"C\xf3digo revogado com sucesso"}}catch(t){return console.error("\u274c Erro ao revogar c\xf3digo:",t),{success:!1,message:"Erro ao revogar c\xf3digo: "+t.message}}})(e);t.success?await Q():alert(t.message)},X=e=>{navigator.clipboard.writeText(e),B(e),setTimeout(()=>B(!1),2e3)},J=()=>{p(!1),R(null),y(""),b(24),j(""),_(""),A("1"),U("")},Z="redefinicao"===o?c:u,$=Z.filter(e=>{if("ativos"===V&&e.expirado)return!1;if("expirados"===V&&!e.expirado)return!1;if(H){const t=H.toLowerCase();return e.codigo.toLowerCase().includes(t)||e.usuarioEmail&&e.usuarioEmail.toLowerCase().includes(t)}return!0}),ee={total:Z.length,ativos:Z.filter(e=>!e.expirado).length,expirados:Z.filter(e=>e.expirado).length,genericos:Z.filter(e=>!e.usuarioEmail&&!e.expirado).length};return(0,k.jsxs)("div",{className:"space-y-6",children:[(0,k.jsxs)("div",{className:"flex flex-col space-y-4",children:[(0,k.jsxs)("div",{className:"flex items-center justify-between",children:[(0,k.jsxs)("div",{children:[(0,k.jsxs)("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white flex items-center gap-2",children:[(0,k.jsx)(g_,{className:"w-6 h-6 text-blue-600 dark:text-blue-400"}),"Gerenciamento de C\xf3digos"]}),(0,k.jsx)("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:"Gere c\xf3digos para redefini\xe7\xe3o de senha e cria\xe7\xe3o de novas contas"})]}),(0,k.jsxs)("button",{onClick:async()=>{p(!0),await W()},className:"flex items-center gap-2 px-4 py-2 bg-[#1d9bf0] hover:bg-[#1a8cd8] text-white rounded-lg transition-colors",children:[(0,k.jsx)(D,{className:"w-4 h-4"}),"redefinicao"===o?"C\xf3digo de Redefini\xe7\xe3o":"C\xf3digo de Cria\xe7\xe3o"]})]}),(0,k.jsxs)("div",{className:"flex space-x-1 bg-gray-100 dark:bg-gray-800 p-1 rounded-lg",children:[(0,k.jsxs)("button",{onClick:()=>l("redefinicao"),className:"flex items-center gap-2 px-4 py-2 rounded-md text-sm font-medium transition-colors ".concat("redefinicao"===o?"bg-white dark:bg-gray-700 text-blue-600 dark:text-blue-400 shadow-sm":"text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200"),children:[(0,k.jsx)(T,{className:"w-4 h-4"}),"Redefini\xe7\xe3o de Senha"]}),(0,k.jsxs)("button",{onClick:()=>l("criacao"),className:"flex items-center gap-2 px-4 py-2 rounded-md text-sm font-medium transition-colors ".concat("criacao"===o?"bg-white dark:bg-gray-700 text-green-600 dark:text-green-400 shadow-sm":"text-gray-600 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200"),children:[(0,k.jsx)(p_,{className:"w-4 h-4"}),"Cria\xe7\xe3o de Contas"]})]})]}),(0,k.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,k.jsx)("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg border border-gray-200 dark:border-gray-700",children:(0,k.jsxs)("div",{className:"flex items-center justify-between",children:[(0,k.jsxs)("div",{children:[(0,k.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Total"}),(0,k.jsx)("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:ee.total})]}),(0,k.jsx)(g_,{className:"w-8 h-8 text-gray-400"})]})}),(0,k.jsx)("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg border border-gray-200 dark:border-gray-700",children:(0,k.jsxs)("div",{className:"flex items-center justify-between",children:[(0,k.jsxs)("div",{children:[(0,k.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Ativos"}),(0,k.jsx)("p",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:ee.ativos})]}),(0,k.jsx)(Fd,{className:"w-8 h-8 text-green-400"})]})}),(0,k.jsx)("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg border border-gray-200 dark:border-gray-700",children:(0,k.jsxs)("div",{className:"flex items-center justify-between",children:[(0,k.jsxs)("div",{children:[(0,k.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Expirados"}),(0,k.jsx)("p",{className:"text-2xl font-bold text-red-600 dark:text-red-400",children:ee.expirados})]}),(0,k.jsx)(xu,{className:"w-8 h-8 text-red-400"})]})}),(0,k.jsx)("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg border border-gray-200 dark:border-gray-700",children:(0,k.jsxs)("div",{className:"flex items-center justify-between",children:[(0,k.jsxs)("div",{children:[(0,k.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Gen\xe9ricos"}),(0,k.jsx)("p",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400",children:ee.genericos})]}),(0,k.jsx)(I,{className:"w-8 h-8 text-blue-400"})]})})]}),(0,k.jsx)("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg border border-gray-200 dark:border-gray-700",children:(0,k.jsxs)("div",{className:"flex flex-col md:flex-row gap-4",children:[(0,k.jsxs)("div",{className:"flex-1 relative",children:[(0,k.jsx)(Ft,{className:"w-4 h-4 absolute left-3 top-3 text-gray-400"}),(0,k.jsx)("input",{type:"text",value:H,onChange:e=>G(e.target.value),placeholder:"Buscar por c\xf3digo ou usu\xe1rio...",className:"w-full pl-10 pr-4 py-2 border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white rounded-lg focus:ring-2 focus:ring-blue-500"})]}),(0,k.jsxs)("div",{className:"flex gap-2",children:[(0,k.jsx)("button",{onClick:()=>q("todos"),className:"px-4 py-2 rounded-lg transition-colors ".concat("todos"===V?"bg-[#1d9bf0] text-white":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"),children:"Todos"}),(0,k.jsx)("button",{onClick:()=>q("ativos"),className:"px-4 py-2 rounded-lg transition-colors ".concat("ativos"===V?"bg-green-600 text-white":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"),children:"Ativos"}),(0,k.jsx)("button",{onClick:()=>q("expirados"),className:"px-4 py-2 rounded-lg transition-colors ".concat("expirados"===V?"bg-red-600 text-white":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"),children:"Expirados"})]}),(0,k.jsxs)("div",{className:"flex gap-2",children:[(0,k.jsx)("button",{onClick:Q,disabled:m,className:"px-4 py-2 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-300 rounded-lg transition-colors disabled:opacity-50",children:(0,k.jsx)(Kd,{className:"w-4 h-4 ".concat(m?"animate-spin":"")})}),ee.expirados>0&&(0,k.jsx)("button",{onClick:async()=>{if(!confirm("Deseja remover todos os c\xf3digos expirados?"))return;f(!0);const e=await(async()=>{try{const e=await(0,s.GG)((0,s.collection)(Jt,"codigosRedefinicao")),t=new Date;let r=0;const a=[];return e.forEach(e=>{const n=e.data(),i=new Date(n.expiraEm);t>i&&(a.push((0,s.deleteDoc)(e.ref)),r++)}),await Promise.all(a),console.log("\u2705 ".concat(r," c\xf3digo(s) expirado(s) removido(s)")),{success:!0,removidos:r,message:"".concat(r," c\xf3digo(s) expirado(s) removido(s)")}}catch(e){return console.error("\u274c Erro ao limpar c\xf3digos expirados:",e),{success:!1,removidos:0,message:"Erro ao limpar c\xf3digos: "+e.message}}})();e.success?(await Q(),alert(e.message)):alert(e.message),f(!1)},disabled:m,className:"px-4 py-2 bg-red-100 dark:bg-red-900/30 hover:bg-red-200 dark:hover:bg-red-900/50 text-red-700 dark:text-red-400 rounded-lg transition-colors disabled:opacity-50",children:(0,k.jsx)(nw,{className:"w-4 h-4"})})]})]})}),(0,k.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700 overflow-hidden",children:0===$.length?(0,k.jsxs)("div",{className:"text-center py-12 text-gray-500 dark:text-gray-400",children:[(0,k.jsx)(g_,{className:"w-16 h-16 mx-auto mb-4 opacity-20"}),(0,k.jsx)("p",{children:"Nenhum c\xf3digo encontrado"})]}):(0,k.jsx)("div",{className:"overflow-x-auto",children:(0,k.jsxs)("table",{className:"w-full",children:[(0,k.jsx)("thead",{className:"bg-gray-50 dark:bg-gray-700",children:(0,k.jsxs)("tr",{children:[(0,k.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"C\xf3digo"}),(0,k.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Usu\xe1rio"}),(0,k.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Status"}),(0,k.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Expira Em"}),(0,k.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"Tempo Restante"}),(0,k.jsx)("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"A\xe7\xf5es"})]})}),(0,k.jsx)("tbody",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:$.map(e=>(0,k.jsxs)("tr",{className:e.expirado?"opacity-50":"",children:[(0,k.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,k.jsxs)("div",{className:"flex items-center gap-2",children:[(0,k.jsx)("code",{className:"text-sm font-mono font-bold text-blue-600 dark:text-blue-400",children:e.codigo}),(0,k.jsx)("button",{onClick:()=>X(e.codigo),className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",title:"Copiar c\xf3digo",children:O===e.codigo?(0,k.jsx)(Fd,{className:"w-4 h-4 text-green-500"}):(0,k.jsx)(nN,{className:"w-4 h-4"})})]})}),(0,k.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:e.usuarioEmail?(0,k.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-900 dark:text-white",children:[(0,k.jsx)(mu,{className:"w-4 h-4 text-gray-400"}),e.usuarioEmail]}):(0,k.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-500 dark:text-gray-400",children:[(0,k.jsx)(I,{className:"w-4 h-4"}),"Gen\xe9rico"]})}),(0,k.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:e.expirado?(0,k.jsx)("span",{className:"px-2 py-1 text-xs rounded-full bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-400",children:"Expirado"}):(0,k.jsx)("span",{className:"px-2 py-1 text-xs rounded-full bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400",children:"Ativo"})}),(0,k.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:new Date(e.expiraEm).toLocaleString("pt-BR")}),(0,k.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:e.expirado?(0,k.jsx)("span",{className:"text-red-600 dark:text-red-400",children:"Expirado"}):(0,k.jsxs)("span",{className:"text-gray-900 dark:text-white",children:[Math.floor(e.tempoRestante/60),"h ",e.tempoRestante%60,"m"]})}),(0,k.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:(0,k.jsx)("button",{onClick:()=>Y(e.id),className:"text-red-600 hover:text-red-700 dark:text-red-400 dark:hover:text-red-300",title:"Revogar c\xf3digo",children:(0,k.jsx)(nw,{className:"w-4 h-4"})})})]},e.id))})]})})}),(0,k.jsx)(Pr,{children:g&&(0,k.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",children:(0,k.jsx)(Cd.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},className:"bg-white dark:bg-gray-800 rounded-2xl shadow-2xl max-w-md w-full p-6",children:M?(0,k.jsxs)("div",{className:"text-center",children:[(0,k.jsx)(Cd.div,{initial:{scale:0},animate:{scale:1},className:"mx-auto w-20 h-20 bg-green-100 dark:bg-green-900/30 rounded-full flex items-center justify-center mb-4",children:(0,k.jsx)(Fd,{className:"w-12 h-12 text-green-600 dark:text-green-400"})}),(0,k.jsx)("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-2",children:"C\xf3digo Gerado!"}),(0,k.jsx)("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:"redefinicao"===o?"Compartilhe este c\xf3digo com o usu\xe1rio para redefinir senha:":"Compartilhe este c\xf3digo para criar uma nova conta:"}),(0,k.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-700 p-4 rounded-lg mb-4",children:[(0,k.jsxs)("div",{className:"flex items-center justify-center gap-2 mb-2",children:[(0,k.jsx)("code",{className:"text-3xl font-mono font-bold text-blue-600 dark:text-blue-400",children:M.codigo}),(0,k.jsx)("button",{onClick:()=>X(M.codigo),className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:O===M.codigo?(0,k.jsx)(Fd,{className:"w-5 h-5 text-green-500"}):(0,k.jsx)(nN,{className:"w-5 h-5"})})]}),(0,k.jsxs)("div",{className:"mt-3 space-y-1 text-sm",children:[(0,k.jsxs)("p",{className:"text-gray-700 dark:text-gray-300",children:[(0,k.jsx)("strong",{children:"N\xedvel:"})," ","0"===E?"\ud83d\udc51 Admin (Total)":"1"===E?"\ud83d\udc64 Funcion\xe1rio":"2"===E?"\ud83d\udc54 Supervisor":"3"===E?"\ufffd Gerente Setor":"4"===E?"\ud83c\udfaf Gerente Geral":"5"===E?"\ud83d\udcbc RH":"6"===E?"\ud83c\udfc6 CEO":"N/A"]}),("1"===E||"2"===E||"3"===E)&&(0,k.jsxs)(k.Fragment,{children:[(0,k.jsxs)("p",{className:"text-gray-700 dark:text-gray-300",children:[(0,k.jsx)("strong",{children:"Empresa:"})," ",(null===(t=C.find(e=>e.id===N))||void 0===t?void 0:t.nome)||"N/A"]}),(0,k.jsxs)("p",{className:"text-gray-700 dark:text-gray-300",children:[(0,k.jsx)("strong",{children:"Setor:"})," ",(null===(r=F.find(e=>e.id===S))||void 0===r?void 0:r.nome)||"N/A"]})]}),("0"===E||parseInt(E)>=4)&&(0,k.jsx)("p",{className:"text-yellow-600 dark:text-yellow-400 text-xs",children:"\u26a0\ufe0f Este c\xf3digo cria um usu\xe1rio com vis\xe3o global/permiss\xf5es elevadas"}),(0,k.jsxs)("p",{className:"text-gray-500 dark:text-gray-400 text-xs mt-2",children:["V\xe1lido at\xe9: ",new Date(M.expiraEm).toLocaleString("pt-BR")]})]})]}),(0,k.jsx)("button",{onClick:J,className:"w-full px-4 py-2 bg-[#1d9bf0] hover:bg-[#1a8cd8] text-white rounded-lg transition-colors",children:"Fechar"})]}):(0,k.jsxs)("div",{children:[(0,k.jsx)("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-4",children:"redefinicao"===o?"Gerar C\xf3digo de Redefini\xe7\xe3o":"Gerar C\xf3digo de Cria\xe7\xe3o de Conta"}),(0,k.jsxs)("div",{className:"space-y-4",children:["redefinicao"===o&&(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-200 mb-2",children:"Usu\xe1rio (opcional)"}),(0,k.jsxs)("select",{value:x,onChange:e=>y(e.target.value),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white rounded-lg focus:ring-2 focus:ring-blue-500",disabled:m,children:[(0,k.jsx)("option",{value:"",children:"C\xf3digo Gen\xe9rico"}),i.map(e=>(0,k.jsxs)("option",{value:e.email,children:[e.nome||e.email," (",e.email,")"]},e.id))]}),(0,k.jsx)("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:"Deixe em branco para criar um c\xf3digo que pode ser usado por qualquer usu\xe1rio"})]}),"criacao"===o&&(0,k.jsx)("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4",children:(0,k.jsxs)("div",{className:"flex items-start gap-3",children:[(0,k.jsx)(p_,{className:"w-5 h-5 text-blue-600 dark:text-blue-400 flex-shrink-0 mt-0.5"}),(0,k.jsxs)("div",{className:"text-sm",children:[(0,k.jsx)("p",{className:"font-medium text-blue-900 dark:text-blue-300 mb-1",children:"C\xf3digo de Cria\xe7\xe3o de Conta"}),(0,k.jsx)("p",{className:"text-blue-700 dark:text-blue-400",children:"Este c\xf3digo permitir\xe1 que algu\xe9m crie uma nova conta no sistema com o n\xedvel de permiss\xe3o especificado abaixo."})]})]})}),(0,k.jsxs)("div",{children:[(0,k.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-200 mb-2 flex items-center gap-2",children:[(0,k.jsx)(I,{className:"w-4 h-4"}),"N\xedvel de Permiss\xe3o *"]}),(0,k.jsxs)("select",{value:E,onChange:e=>{A(e.target.value);const t=parseInt(e.target.value);(0===t||t>=4)&&(j(""),_(""))},className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white rounded-lg focus:ring-2 focus:ring-[#1d9bf0]",disabled:m,required:!0,children:[(0,k.jsx)("option",{value:"0",children:"\ud83d\udc51 N\xedvel 0 - Administrador (Acesso Total)"}),(0,k.jsx)("option",{value:"1",children:"\ud83d\udc64 N\xedvel 1 - Funcion\xe1rio (Acesso B\xe1sico)"}),(0,k.jsx)("option",{value:"2",children:"\ud83d\udc54 N\xedvel 2 - Supervisor de Setor"}),(0,k.jsx)("option",{value:"3",children:"\ud83d\udcca N\xedvel 3 - Gerente de Setor"}),(0,k.jsx)("option",{value:"4",children:"\ud83c\udfaf N\xedvel 4 - Gerente Geral"}),(0,k.jsx)("option",{value:"5",children:"\ud83d\udcbc N\xedvel 5 - RH (Recursos Humanos)"}),(0,k.jsx)("option",{value:"6",children:"\ud83c\udfc6 N\xedvel 6 - CEO (Diretor Executivo)"})]}),(0,k.jsxs)("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:["0"===E&&"\u26a0\ufe0f Acesso total ao sistema (n\xe3o vinculado a empresa/setor)","1"===E&&"\ud83d\udccc Acesso b\xe1sico - vinculado a empresa e setor","2"===E&&"\ud83d\udccc Supervisiona equipe - vinculado a setor","3"===E&&"\ud83d\udccc Gerencia setor espec\xedfico - vinculado a setor","4"===E&&"\ud83c\udf10 Gerencia m\xfaltiplos setores (vis\xe3o global)","5"===E&&"\ud83c\udf10 Gest\xe3o de recursos humanos (vis\xe3o global)","6"===E&&"\ud83c\udf10 Diretor executivo - vis\xe3o estrat\xe9gica (vis\xe3o global)"]})]}),("1"===E||"2"===E||"3"===E)&&(0,k.jsxs)("div",{children:[(0,k.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-200 mb-2 flex items-center gap-2",children:[(0,k.jsx)(Wb,{className:"w-4 h-4"}),"Empresa * ",C.length>0&&(0,k.jsxs)("span",{className:"text-xs text-green-500",children:["(",C.length," dispon\xedveis)"]})]}),(0,k.jsxs)("select",{value:N,onChange:e=>{console.log("Empresa selecionada:",e.target.value),j(e.target.value),_("")},className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white rounded-lg focus:ring-2 focus:ring-blue-500",disabled:m,required:!0,children:[(0,k.jsx)("option",{value:"",children:"Selecione uma empresa"}),0===C.length?(0,k.jsx)("option",{disabled:!0,children:"Carregando empresas..."}):C.map(e=>(0,k.jsx)("option",{value:e.id,children:e.nome},e.id))]}),(0,k.jsx)("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:"O usu\xe1rio ser\xe1 registrado nesta empresa"})]}),("1"===E||"2"===E||"3"===E)&&N&&(0,k.jsxs)("div",{children:[(0,k.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-200 mb-2 flex items-center gap-2",children:[(0,k.jsx)(Kb,{className:"w-4 h-4"}),"Setor * ",F.length>0&&(0,k.jsxs)("span",{className:"text-xs text-green-500",children:["(",F.length," dispon\xedveis)"]})]}),(0,k.jsxs)("select",{value:S,onChange:e=>{console.log("Setor selecionado:",e.target.value),_(e.target.value)},className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white rounded-lg focus:ring-2 focus:ring-blue-500",disabled:m,required:!0,children:[(0,k.jsx)("option",{value:"",children:"Selecione um setor"}),0===F.length?(0,k.jsx)("option",{disabled:!0,children:"Carregando setores..."}):F.map(e=>(0,k.jsx)("option",{value:e.id,children:e.nome},e.id))]}),(0,k.jsx)("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:"O usu\xe1rio ser\xe1 registrado neste setor"})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-200 mb-2",children:"Validade (horas)"}),(0,k.jsx)("input",{type:"number",value:v,onChange:e=>b(Math.max(1,parseInt(e.target.value)||24)),min:"1",max:"168",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white rounded-lg focus:ring-2 focus:ring-blue-500",disabled:m}),(0,k.jsx)("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:"O c\xf3digo expirar\xe1 ap\xf3s este per\xedodo"})]}),z&&(0,k.jsxs)("div",{className:"bg-red-50 dark:bg-red-900/30 border border-red-200 dark:border-red-800 text-red-600 dark:text-red-400 px-4 py-3 rounded-lg text-sm flex items-start gap-2",children:[(0,k.jsx)(w,{className:"w-5 h-5 flex-shrink-0 mt-0.5"}),(0,k.jsx)("span",{children:z})]}),(0,k.jsxs)("div",{className:"flex gap-3",children:[(0,k.jsx)("button",{onClick:J,disabled:m,className:"flex-1 px-4 py-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-200 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors disabled:opacity-50",children:"Cancelar"}),(0,k.jsx)("button",{onClick:async()=>{f(!0),U("");const e=parseInt(E);if(e>=1&&e<=3){if(!N)return U("Por favor, selecione uma empresa"),void f(!1);if(!S)return U("Por favor, selecione um setor"),void f(!1)}try{let t;t="redefinicao"===o?await async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:24,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"usuario";try{const o=x_(),l=new Date,c=new Date(l.getTime()+60*r*60*1e3),d={codigo:o,usuarioEmail:t,criadoPor:e,criadoEm:l.toISOString(),expiraEm:c.toISOString(),usado:!1,usadoEm:null,usadoPor:null,empresaId:a,setorId:n,nivelUsuario:i},u=await(0,s.gS)((0,s.collection)(Jt,"codigosRedefinicao"),d);return console.log("\u2705 C\xf3digo de redefini\xe7\xe3o criado:",{id:u.id,codigo:o,usuarioEmail:t||"GEN\xc9RICO",expiraEm:c.toLocaleString("pt-BR")}),{success:!0,codigo:o,id:u.id,expiraEm:c.toISOString()}}catch(o){return console.error("\u274c Erro ao criar c\xf3digo de redefini\xe7\xe3o:",o),{success:!1,error:o.message}}}(a.id,x||null,v,e>=1&&e<=3?N:null,e>=1&&e<=3?S:null,E):await async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:24,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"1";try{const i=x_(),o=new Date,l=new Date(o.getTime()+60*t*60*1e3),c={codigo:i,tipo:"criacao",criadoPor:e,criadoEm:o.toISOString(),expiraEm:l.toISOString(),usado:!1,usadoEm:null,usadoPor:null,empresaId:r,setorId:a,nivelUsuario:n},d=await(0,s.gS)((0,s.collection)(Jt,"codigosCriacaoContas"),c);return console.log("\u2705 C\xf3digo de cria\xe7\xe3o de conta criado:",{id:d.id,codigo:i,nivelUsuario:n,expiraEm:l.toLocaleString("pt-BR")}),{success:!0,codigo:i,id:d.id,expiraEm:l.toISOString(),tipo:"criacao"}}catch(i){return console.error("\u274c Erro ao criar c\xf3digo de cria\xe7\xe3o de conta:",i),{success:!1,error:i.message}}}(a.id,v,e>=1&&e<=3?N:null,e>=1&&e<=3?S:null,E),t.success?(R(t),await Q()):U(t.error||"Erro ao gerar c\xf3digo")}catch(t){console.error("Erro ao gerar c\xf3digo:",t),U("Erro ao gerar c\xf3digo")}finally{f(!1)}},disabled:m,className:"flex-1 px-4 py-2 bg-[#1d9bf0] hover:bg-[#1a8cd8] text-white rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:m?(0,k.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,k.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Gerando..."]}):"Gerar C\xf3digo"})]})]})]})})})})]})},b_=()=>{const[t,r]=(0,e.useState)("backup"),a=[{id:"backup",label:"Backup & Monitoramento",icon:xr,description:"Gerenciamento de backups e sincroniza\xe7\xe3o de dados"},{id:"reset-codes",label:"C\xf3digos de Redefini\xe7\xe3o",icon:I,description:"Gerenciamento de c\xf3digos de reset de senha"},{id:"error-reports",label:"Relat\xf3rios de Erro",icon:A,description:"Visualiza\xe7\xe3o e an\xe1lise de erros do sistema"}];return(0,k.jsxs)("div",{className:"space-y-6",children:[(0,k.jsx)("div",{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl shadow-lg p-6",children:(0,k.jsxs)("div",{className:"flex items-center gap-4",children:[(0,k.jsx)("div",{className:"w-14 h-14 bg-gradient-to-br from-purple-500 to-indigo-600 dark:from-purple-600 dark:to-indigo-700 rounded-xl flex items-center justify-center shadow-lg",children:(0,k.jsx)(gN,{className:"w-7 h-7 text-white"})}),(0,k.jsxs)("div",{children:[(0,k.jsx)("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Administra\xe7\xe3o do Sistema"}),(0,k.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Backup, Monitoramento, C\xf3digos de Redefini\xe7\xe3o e Relat\xf3rios de Erro"})]})]})}),(0,k.jsxs)("div",{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-xl shadow-lg overflow-hidden",children:[(0,k.jsx)("div",{className:"flex flex-wrap border-b border-gray-200 dark:border-gray-700",children:a.map(e=>{const a=e.icon,n=t===e.id;return(0,k.jsxs)("button",{onClick:()=>r(e.id),className:"flex-1 min-w-[200px] relative px-6 py-4 text-left transition-all ".concat(n?"bg-blue-50 dark:bg-blue-900/20 border-b-2 border-blue-600 dark:border-blue-400":"hover:bg-gray-50 dark:hover:bg-gray-700/50"),children:[(0,k.jsxs)("div",{className:"flex items-center gap-3",children:[(0,k.jsx)("div",{className:"p-2 rounded-lg transition-colors ".concat(n?"bg-blue-100 dark:bg-blue-800/50":"bg-gray-100 dark:bg-gray-700"),children:(0,k.jsx)(a,{className:"w-5 h-5 ".concat(n?"text-blue-600 dark:text-blue-400":"text-gray-600 dark:text-gray-400")})}),(0,k.jsxs)("div",{className:"flex-1",children:[(0,k.jsx)("div",{className:"font-medium ".concat(n?"text-blue-600 dark:text-blue-400":"text-gray-900 dark:text-white"),children:e.label}),(0,k.jsx)("div",{className:"text-xs mt-0.5 ".concat(n?"text-blue-600/70 dark:text-blue-400/70":"text-gray-500 dark:text-gray-400"),children:e.description})]})]}),n&&(0,k.jsx)(Cd.div,{layoutId:"activeTab",className:"absolute bottom-0 left-0 right-0 h-0.5 bg-blue-600 dark:bg-blue-400",initial:!1,transition:{type:"spring",stiffness:500,damping:30}})]},e.id)})}),(0,k.jsx)("div",{className:"p-6",children:(0,k.jsxs)(Cd.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},children:["backup"===t&&(0,k.jsx)(u_,{}),"reset-codes"===t&&(0,k.jsx)(v_,{}),"error-reports"===t&&(0,k.jsx)(f_,{})]},t)})]})]})},w_=async function(e,t,r,a){let n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};try{console.log("Criando notifica\xe7\xe3o:",{usuarioId:e,tipo:t,titulo:r,mensagem:a}),await(0,s.gS)((0,s.collection)(P.db,"notificacoes"),{usuarioId:e,tipo:t,titulo:r,mensagem:a,lida:!1,timestamp:(0,s.O5)(),dados:n}),console.log("Notifica\xe7\xe3o criada com sucesso!")}catch(i){throw console.error("Erro ao criar notifica\xe7\xe3o:",i),i}},k_=async function(e,t,r){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const s=Array.isArray(t)?t.map(e=>"string"===typeof e?e:e.nome).slice(0,3).join(", "):t,i=Array.isArray(t)&&t.length>3?" e mais ".concat(t.length-3):"",o="".concat(s).concat(i," foram emprestadas em seu nome").concat(r?" por ".concat(r):"");await w_(e,"emprestimo","\ud83d\udd27 Ferramentas emprestadas",o,(0,n.A)({ferramentas:Array.isArray(t)?t:[t],responsavel:r},a))},N_=t=>{let{usuarioAtual:r}=t;const[a,i]=(0,e.useState)(null),[o,l]=(0,e.useState)(null),[c,d]=(0,e.useState)([]),[u,h]=(0,e.useState)([]),[m,f]=(0,e.useState)([]),[g,p]=(0,e.useState)(!0),[x,y]=(0,e.useState)(null),[v,b]=(0,e.useState)(!1),[w,N]=(0,e.useState)(!1),[j,S]=(0,e.useState)(!1),[_,E]=(0,e.useState)({nome:"",cnpj:"",endereco:"",telefone:"",email:"",ativo:!0}),[C,I]=(0,e.useState)({nome:"",descricao:"",responsavel:"",ativo:!0}),[T,F]=(0,e.useState)({nome:"",descricao:"",ativo:!0}),L=At(null===r||void 0===r?void 0:r.nivel)||It(null===r||void 0===r?void 0:r.nivel);(0,e.useEffect)(()=>{M()},[]),(0,e.useEffect)(()=>{a?R(a.id):(h([]),l(null))},[a]),(0,e.useEffect)(()=>{o?O(o.id):f([])},[o]);const M=async()=>{try{p(!0);const e=(0,s.collection)(P.db,"empresas"),t=(await(0,s.GG)(e)).docs.map(e=>(0,n.A)({id:e.id},e.data()));d(t.filter(e=>!1!==e.ativo))}catch(e){console.error("Erro ao carregar empresas:",e),zb.error("Erro ao carregar empresas")}finally{p(!1)}},R=async e=>{try{const t=(0,s.collection)(P.db,"setores"),r=(0,s.P)(t,(0,s._M)("empresaId","==",e)),a=(await(0,s.GG)(r)).docs.map(e=>(0,n.A)({id:e.id},e.data()));h(a.filter(e=>!1!==e.ativo))}catch(t){console.error("Erro ao carregar setores:",t),zb.error("Erro ao carregar setores")}},O=async e=>{try{const t=(0,s.collection)(P.db,"horarios_personalizados"),r=(0,s.P)(t,(0,s._M)("setorId","==",e)),a=(await(0,s.GG)(r)).docs.map(e=>(0,n.A)({id:e.id},e.data()));f(a.filter(e=>!1!==e.ativo))}catch(t){console.error("Erro ao carregar hor\xe1rios:",t),zb.error("Erro ao carregar hor\xe1rios")}},B=(e,t)=>{y((0,n.A)((0,n.A)({},e),{},{tipo:t})),"empresa"===t?(E(e),b(!0)):"setor"===t?(I(e),N(!0)):"horario"===t&&(F(e),S(!0))},z=()=>{y(null),E({nome:"",cnpj:"",endereco:"",telefone:"",email:"",ativo:!0}),I({nome:"",descricao:"",responsavel:"",ativo:!0}),F({nome:"",descricao:"",ativo:!0})},U=e=>{if(!e)return"N/A";return(e.toDate?e.toDate():new Date(e)).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric"})};return g?(0,k.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,k.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600"})}):(0,k.jsxs)("div",{className:"p-4 sm:p-6 space-y-6",children:[(0,k.jsxs)("div",{className:"bg-gradient-to-r from-purple-600 to-indigo-600 rounded-xl p-6 shadow-xl",children:[(0,k.jsxs)("h1",{className:"text-2xl sm:text-3xl font-bold text-white flex items-center gap-3",children:[(0,k.jsx)(Wb,{className:"w-8 h-8"}),"Gerenciamento Unificado"]}),(0,k.jsx)("p",{className:"text-purple-100 mt-2",children:"Gerencie empresas, setores e hor\xe1rios personalizados"})]}),(0,k.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-4 shadow-md",children:(0,k.jsxs)("div",{className:"flex items-center gap-2 text-sm flex-wrap",children:[(0,k.jsx)(Wb,{className:"w-5 h-5 text-purple-600"}),(0,k.jsx)("span",{className:"font-semibold text-gray-700 dark:text-gray-300",children:a?a.nome:"Selecione uma empresa"}),a&&(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(xN,{className:"w-4 h-4 text-gray-400"}),(0,k.jsx)(Kb,{className:"w-5 h-5 text-blue-600"}),(0,k.jsx)("span",{className:"font-semibold text-gray-700 dark:text-gray-300",children:o?o.nome:"Selecione um setor"})]}),o&&(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(xN,{className:"w-4 h-4 text-gray-400"}),(0,k.jsx)(xu,{className:"w-5 h-5 text-green-600"}),(0,k.jsx)("span",{className:"font-semibold text-gray-700 dark:text-gray-300",children:"Hor\xe1rios"})]})]})}),(0,k.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,k.jsx)("div",{className:"space-y-4",children:(0,k.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-lg border-2 border-purple-200 dark:border-purple-700",children:[(0,k.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,k.jsxs)("h2",{className:"text-xl font-bold text-gray-800 dark:text-white flex items-center gap-2",children:[(0,k.jsx)(Wb,{className:"w-6 h-6 text-purple-600"}),"Empresas (",c.length,")"]}),L&&(0,k.jsxs)("button",{onClick:()=>{z(),b(!0)},className:"flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-purple-600 to-indigo-600 text-white rounded-lg hover:from-purple-700 hover:to-indigo-700 transition-all font-bold shadow-md",children:[(0,k.jsx)(D,{className:"w-4 h-4"}),"Nova"]})]}),(0,k.jsx)("div",{className:"space-y-3 max-h-[600px] overflow-y-auto",children:0===c.length?(0,k.jsxs)("div",{className:"text-center py-12 text-gray-500 dark:text-gray-400",children:[(0,k.jsx)(rw,{className:"w-12 h-12 mx-auto mb-2 opacity-50"}),(0,k.jsx)("p",{children:"Nenhuma empresa cadastrada"})]}):c.map(e=>(0,k.jsx)("div",{className:"p-4 rounded-xl border-2 transition-all cursor-pointer hover:shadow-lg ".concat((null===a||void 0===a?void 0:a.id)===e.id?"border-purple-500 bg-purple-50 dark:bg-purple-900/20 shadow-md":"border-gray-200 dark:border-gray-700 hover:border-purple-300 dark:hover:border-purple-600"),onClick:()=>i(e),children:(0,k.jsxs)("div",{className:"flex justify-between items-start mb-3",children:[(0,k.jsxs)("div",{className:"flex-1",children:[(0,k.jsx)("h3",{className:"text-lg font-bold text-gray-900 dark:text-white mb-2",children:e.nome}),e.cnpj&&(0,k.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-600 dark:text-gray-400 mb-1",children:[(0,k.jsx)(A,{className:"w-4 h-4"}),(0,k.jsxs)("span",{children:["CNPJ: ",e.cnpj]})]}),e.telefone&&(0,k.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-600 dark:text-gray-400 mb-1",children:[(0,k.jsx)(jk,{className:"w-4 h-4"}),(0,k.jsx)("span",{children:e.telefone})]}),e.email&&(0,k.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-600 dark:text-gray-400 mb-1",children:[(0,k.jsx)(EN,{className:"w-4 h-4"}),(0,k.jsx)("span",{className:"truncate",children:e.email})]}),e.endereco&&(0,k.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-600 dark:text-gray-400 mb-1",children:[(0,k.jsx)(Dd,{className:"w-4 h-4"}),(0,k.jsx)("span",{className:"text-xs",children:e.endereco})]}),e.dataCriacao&&(0,k.jsxs)("div",{className:"flex items-center gap-2 text-xs text-gray-500 dark:text-gray-500 mt-2",children:[(0,k.jsx)(iu,{className:"w-3 h-3"}),(0,k.jsxs)("span",{children:["Cadastrado em ",U(e.dataCriacao)]})]})]}),L&&(0,k.jsxs)("div",{className:"flex gap-1 ml-2",children:[(0,k.jsx)("button",{onClick:t=>{t.stopPropagation(),B(e,"empresa")},className:"p-2 text-blue-600 hover:bg-blue-100 dark:hover:bg-blue-900/30 rounded-lg transition-colors",children:(0,k.jsx)(Nk,{className:"w-4 h-4"})}),(0,k.jsx)("button",{onClick:t=>{t.stopPropagation(),(async e=>{if(L&&window.confirm("Tem certeza? Todos os setores e hor\xe1rios desta empresa ser\xe3o perdidos."))try{await(0,s.deleteDoc)((0,s.doc)(P.db,"empresas",e)),zb.success("Empresa exclu\xedda com sucesso!"),(null===a||void 0===a?void 0:a.id)===e&&i(null),M()}catch(t){console.error("Erro ao excluir empresa:",t),zb.error("Erro ao excluir empresa")}})(e.id)},className:"p-2 text-red-600 hover:bg-red-100 dark:hover:bg-red-900/30 rounded-lg transition-colors",children:(0,k.jsx)(nw,{className:"w-4 h-4"})})]})]})},e.id))})]})}),(0,k.jsx)("div",{className:"space-y-4",children:(0,k.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-lg border-2 border-blue-200 dark:border-blue-700",children:[(0,k.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,k.jsxs)("h2",{className:"text-xl font-bold text-gray-800 dark:text-white flex items-center gap-2",children:[(0,k.jsx)(Kb,{className:"w-6 h-6 text-blue-600"}),"Setores (",u.length,")"]}),a&&(0,k.jsxs)("button",{onClick:()=>{z(),N(!0)},className:"flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-blue-600 to-cyan-600 text-white rounded-lg hover:from-blue-700 hover:to-cyan-700 transition-all font-bold shadow-md",children:[(0,k.jsx)(D,{className:"w-4 h-4"}),"Novo"]})]}),a?(0,k.jsx)("div",{className:"space-y-3 max-h-[600px] overflow-y-auto",children:0===u.length?(0,k.jsxs)("div",{className:"text-center py-12 text-gray-500 dark:text-gray-400",children:[(0,k.jsx)(rw,{className:"w-12 h-12 mx-auto mb-2 opacity-50"}),(0,k.jsx)("p",{children:"Nenhum setor cadastrado"})]}):u.map(e=>(0,k.jsx)("div",{className:"p-4 rounded-xl border-2 transition-all cursor-pointer hover:shadow-lg ".concat((null===o||void 0===o?void 0:o.id)===e.id?"border-blue-500 bg-blue-50 dark:bg-blue-900/20 shadow-md":"border-gray-200 dark:border-gray-700 hover:border-blue-300 dark:hover:border-blue-600"),onClick:()=>l(e),children:(0,k.jsxs)("div",{className:"flex justify-between items-start mb-2",children:[(0,k.jsxs)("div",{className:"flex-1",children:[(0,k.jsx)("h3",{className:"text-lg font-bold text-gray-900 dark:text-white mb-2",children:e.nome}),e.descricao&&(0,k.jsxs)("div",{className:"flex items-start gap-2 text-sm text-gray-600 dark:text-gray-400 mb-2",children:[(0,k.jsx)(A,{className:"w-4 h-4 mt-0.5"}),(0,k.jsx)("span",{className:"text-xs",children:e.descricao})]}),e.responsavel&&(0,k.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-600 dark:text-gray-400 mb-1",children:[(0,k.jsx)(mu,{className:"w-4 h-4"}),(0,k.jsxs)("span",{children:["Respons\xe1vel: ",e.responsavel]})]}),e.dataCriacao&&(0,k.jsxs)("div",{className:"flex items-center gap-2 text-xs text-gray-500 dark:text-gray-500 mt-2",children:[(0,k.jsx)(iu,{className:"w-3 h-3"}),(0,k.jsxs)("span",{children:["Cadastrado em ",U(e.dataCriacao)]})]})]}),(0,k.jsxs)("div",{className:"flex gap-1 ml-2",children:[(0,k.jsx)("button",{onClick:t=>{t.stopPropagation(),B(e,"setor")},className:"p-2 text-blue-600 hover:bg-blue-100 dark:hover:bg-blue-900/30 rounded-lg transition-colors",children:(0,k.jsx)(Nk,{className:"w-4 h-4"})}),(0,k.jsx)("button",{onClick:t=>{t.stopPropagation(),(async e=>{if(window.confirm("Tem certeza? Todos os hor\xe1rios deste setor ser\xe3o perdidos."))try{await(0,s.deleteDoc)((0,s.doc)(P.db,"setores",e)),zb.success("Setor exclu\xeddo com sucesso!"),(null===o||void 0===o?void 0:o.id)===e&&l(null),R(a.id)}catch(t){console.error("Erro ao excluir setor:",t),zb.error("Erro ao excluir setor")}})(e.id)},className:"p-2 text-red-600 hover:bg-red-100 dark:hover:bg-red-900/30 rounded-lg transition-colors",children:(0,k.jsx)(nw,{className:"w-4 h-4"})})]})]})},e.id))}):(0,k.jsxs)("div",{className:"text-center py-12 text-gray-500 dark:text-gray-400",children:[(0,k.jsx)(rw,{className:"w-12 h-12 mx-auto mb-2 opacity-50"}),(0,k.jsx)("p",{children:"Selecione uma empresa primeiro"})]})]})}),(0,k.jsx)("div",{className:"space-y-4",children:(0,k.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-lg border-2 border-green-200 dark:border-green-700",children:[(0,k.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,k.jsxs)("h2",{className:"text-xl font-bold text-gray-800 dark:text-white flex items-center gap-2",children:[(0,k.jsx)(xu,{className:"w-6 h-6 text-green-600"}),"Hor\xe1rios (",m.length,")"]}),o&&(0,k.jsxs)("button",{onClick:()=>{z(),S(!0)},className:"flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-green-600 to-emerald-600 text-white rounded-lg hover:from-green-700 hover:to-emerald-700 transition-all font-bold shadow-md",children:[(0,k.jsx)(D,{className:"w-4 h-4"}),"Novo"]})]}),o?(0,k.jsx)("div",{className:"space-y-3 max-h-[600px] overflow-y-auto",children:0===m.length?(0,k.jsxs)("div",{className:"text-center py-12 text-gray-500 dark:text-gray-400",children:[(0,k.jsx)(rw,{className:"w-12 h-12 mx-auto mb-2 opacity-50"}),(0,k.jsx)("p",{children:"Nenhum hor\xe1rio cadastrado"})]}):m.map(e=>(0,k.jsx)("div",{className:"p-4 rounded-xl border-2 border-gray-200 dark:border-gray-700 hover:border-green-300 dark:hover:border-green-600 transition-all hover:shadow-lg",children:(0,k.jsxs)("div",{className:"flex justify-between items-start",children:[(0,k.jsxs)("div",{className:"flex-1",children:[(0,k.jsx)("h3",{className:"text-lg font-bold text-gray-900 dark:text-white mb-2",children:e.nome}),e.descricao&&(0,k.jsxs)("div",{className:"flex items-start gap-2 text-sm text-gray-600 dark:text-gray-400 mb-2",children:[(0,k.jsx)(A,{className:"w-4 h-4 mt-0.5"}),(0,k.jsx)("span",{className:"text-xs",children:e.descricao})]}),e.criadoPor&&(0,k.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-600 dark:text-gray-400 mb-1",children:[(0,k.jsx)(mu,{className:"w-4 h-4"}),(0,k.jsxs)("span",{children:["Criado por: ",e.criadoPor]})]}),e.dataCriacao&&(0,k.jsxs)("div",{className:"flex items-center gap-2 text-xs text-gray-500 dark:text-gray-500 mt-2",children:[(0,k.jsx)(iu,{className:"w-3 h-3"}),(0,k.jsxs)("span",{children:["Cadastrado em ",U(e.dataCriacao)]})]})]}),(0,k.jsxs)("div",{className:"flex gap-1 ml-2",children:[(0,k.jsx)("button",{onClick:()=>B(e,"horario"),className:"p-2 text-blue-600 hover:bg-blue-100 dark:hover:bg-blue-900/30 rounded-lg transition-colors",children:(0,k.jsx)(Nk,{className:"w-4 h-4"})}),(0,k.jsx)("button",{onClick:()=>(async e=>{if(window.confirm("Tem certeza que deseja excluir este hor\xe1rio?"))try{await(0,s.deleteDoc)((0,s.doc)(P.db,"horarios_personalizados",e)),zb.success("Hor\xe1rio exclu\xeddo com sucesso!"),O(o.id)}catch(t){console.error("Erro ao excluir hor\xe1rio:",t),zb.error("Erro ao excluir hor\xe1rio")}})(e.id),className:"p-2 text-red-600 hover:bg-red-100 dark:hover:bg-red-900/30 rounded-lg transition-colors",children:(0,k.jsx)(nw,{className:"w-4 h-4"})})]})]})},e.id))}):(0,k.jsxs)("div",{className:"text-center py-12 text-gray-500 dark:text-gray-400",children:[(0,k.jsx)(rw,{className:"w-12 h-12 mx-auto mb-2 opacity-50"}),(0,k.jsx)("p",{children:"Selecione um setor primeiro"})]})]})})]}),v&&(0,k.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:(0,k.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[(0,k.jsx)("div",{className:"sticky top-0 bg-gradient-to-r from-purple-600 to-indigo-600 p-6 rounded-t-2xl",children:(0,k.jsxs)("div",{className:"flex justify-between items-center",children:[(0,k.jsxs)("h2",{className:"text-2xl font-bold text-white flex items-center gap-2",children:[(0,k.jsx)(Wb,{className:"w-7 h-7"}),"empresa"===(null===x||void 0===x?void 0:x.tipo)?"Editar Empresa":"Nova Empresa"]}),(0,k.jsx)("button",{onClick:()=>{b(!1),z()},className:"text-white hover:bg-white/20 p-2 rounded-lg transition-colors",children:(0,k.jsx)(Id,{className:"w-6 h-6"})})]})}),(0,k.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),L)if(_.nome.trim())try{"empresa"===(null===x||void 0===x?void 0:x.tipo)?(await(0,s.updateDoc)((0,s.doc)(P.db,"empresas",x.id),(0,n.A)((0,n.A)({},_),{},{dataAtualizacao:(0,s.O5)()})),zb.success("Empresa atualizada com sucesso!")):(await(0,s.gS)((0,s.collection)(P.db,"empresas"),(0,n.A)((0,n.A)({},_),{},{dataCriacao:(0,s.O5)(),dataAtualizacao:(0,s.O5)()})),zb.success("Empresa cadastrada com sucesso!")),b(!1),z(),M()}catch(t){console.error("Erro ao salvar empresa:",t),zb.error("Erro ao salvar empresa")}else zb.warning("Nome da empresa \xe9 obrigat\xf3rio");else zb.warning("Apenas administradores podem gerenciar empresas")},className:"p-6 space-y-4",children:[(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-bold text-gray-700 dark:text-gray-300 mb-2",children:"Nome da Empresa *"}),(0,k.jsx)("input",{type:"text",value:_.nome,onChange:e=>E((0,n.A)((0,n.A)({},_),{},{nome:e.target.value})),className:"w-full px-4 py-3 border-2 border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-purple-500 focus:border-transparent",required:!0,autoFocus:!0})]}),(0,k.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-bold text-gray-700 dark:text-gray-300 mb-2",children:"CNPJ"}),(0,k.jsx)("input",{type:"text",value:_.cnpj,onChange:e=>E((0,n.A)((0,n.A)({},_),{},{cnpj:e.target.value})),className:"w-full px-4 py-3 border-2 border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-bold text-gray-700 dark:text-gray-300 mb-2",children:"Telefone"}),(0,k.jsx)("input",{type:"text",value:_.telefone,onChange:e=>E((0,n.A)((0,n.A)({},_),{},{telefone:e.target.value})),className:"w-full px-4 py-3 border-2 border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-bold text-gray-700 dark:text-gray-300 mb-2",children:"E-mail"}),(0,k.jsx)("input",{type:"email",value:_.email,onChange:e=>E((0,n.A)((0,n.A)({},_),{},{email:e.target.value})),className:"w-full px-4 py-3 border-2 border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-bold text-gray-700 dark:text-gray-300 mb-2",children:"Endere\xe7o"}),(0,k.jsx)("input",{type:"text",value:_.endereco,onChange:e=>E((0,n.A)((0,n.A)({},_),{},{endereco:e.target.value})),className:"w-full px-4 py-3 border-2 border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-purple-500 focus:border-transparent"})]}),(0,k.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,k.jsxs)("button",{type:"submit",className:"flex-1 px-6 py-3 bg-gradient-to-r from-purple-600 to-indigo-600 text-white rounded-lg hover:from-purple-700 hover:to-indigo-700 transition-all font-bold shadow-lg transform hover:scale-105 flex items-center justify-center gap-2",children:[(0,k.jsx)(uw,{className:"w-5 h-5"}),"empresa"===(null===x||void 0===x?void 0:x.tipo)?"Atualizar":"Cadastrar"]}),(0,k.jsxs)("button",{type:"button",onClick:()=>{b(!1),z()},className:"px-6 py-3 bg-gray-500 hover:bg-gray-600 text-white rounded-lg transition-all font-bold flex items-center justify-center gap-2",children:[(0,k.jsx)(Id,{className:"w-5 h-5"}),"Cancelar"]})]})]})]})}),w&&(0,k.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:(0,k.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[(0,k.jsxs)("div",{className:"sticky top-0 bg-gradient-to-r from-blue-600 to-cyan-600 p-6 rounded-t-2xl",children:[(0,k.jsxs)("div",{className:"flex justify-between items-center",children:[(0,k.jsxs)("h2",{className:"text-2xl font-bold text-white flex items-center gap-2",children:[(0,k.jsx)(Kb,{className:"w-7 h-7"}),"setor"===(null===x||void 0===x?void 0:x.tipo)?"Editar Setor":"Novo Setor"]}),(0,k.jsx)("button",{onClick:()=>{N(!1),z()},className:"text-white hover:bg-white/20 p-2 rounded-lg transition-colors",children:(0,k.jsx)(Id,{className:"w-6 h-6"})})]}),(0,k.jsxs)("p",{className:"text-blue-100 mt-2",children:["Empresa: ",null===a||void 0===a?void 0:a.nome]})]}),(0,k.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),a)if(C.nome.trim())try{"setor"===(null===x||void 0===x?void 0:x.tipo)?(await(0,s.updateDoc)((0,s.doc)(P.db,"setores",x.id),(0,n.A)((0,n.A)({},C),{},{dataAtualizacao:(0,s.O5)()})),zb.success("Setor atualizado com sucesso!")):(await(0,s.gS)((0,s.collection)(P.db,"setores"),(0,n.A)((0,n.A)({},C),{},{empresaId:a.id,empresaNome:a.nome,dataCriacao:(0,s.O5)(),dataAtualizacao:(0,s.O5)()})),zb.success("Setor cadastrado com sucesso!")),N(!1),z(),R(a.id)}catch(t){console.error("Erro ao salvar setor:",t),zb.error("Erro ao salvar setor")}else zb.warning("Nome do setor \xe9 obrigat\xf3rio");else zb.warning("Selecione uma empresa primeiro")},className:"p-6 space-y-4",children:[(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-bold text-gray-700 dark:text-gray-300 mb-2",children:"Nome do Setor *"}),(0,k.jsx)("input",{type:"text",value:C.nome,onChange:e=>I((0,n.A)((0,n.A)({},C),{},{nome:e.target.value})),className:"w-full px-4 py-3 border-2 border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",required:!0,autoFocus:!0})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-bold text-gray-700 dark:text-gray-300 mb-2",children:"Descri\xe7\xe3o"}),(0,k.jsx)("textarea",{value:C.descricao,onChange:e=>I((0,n.A)((0,n.A)({},C),{},{descricao:e.target.value})),className:"w-full px-4 py-3 border-2 border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent",rows:"3"})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-bold text-gray-700 dark:text-gray-300 mb-2",children:"Respons\xe1vel"}),(0,k.jsx)("input",{type:"text",value:C.responsavel,onChange:e=>I((0,n.A)((0,n.A)({},C),{},{responsavel:e.target.value})),className:"w-full px-4 py-3 border-2 border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),(0,k.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,k.jsxs)("button",{type:"submit",className:"flex-1 px-6 py-3 bg-gradient-to-r from-blue-600 to-cyan-600 text-white rounded-lg hover:from-blue-700 hover:to-cyan-700 transition-all font-bold shadow-lg transform hover:scale-105 flex items-center justify-center gap-2",children:[(0,k.jsx)(uw,{className:"w-5 h-5"}),"setor"===(null===x||void 0===x?void 0:x.tipo)?"Atualizar":"Cadastrar"]}),(0,k.jsxs)("button",{type:"button",onClick:()=>{N(!1),z()},className:"px-6 py-3 bg-gray-500 hover:bg-gray-600 text-white rounded-lg transition-all font-bold flex items-center justify-center gap-2",children:[(0,k.jsx)(Id,{className:"w-5 h-5"}),"Cancelar"]})]})]})]})}),j&&(0,k.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:(0,k.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[(0,k.jsxs)("div",{className:"sticky top-0 bg-gradient-to-r from-green-600 to-emerald-600 p-6 rounded-t-2xl",children:[(0,k.jsxs)("div",{className:"flex justify-between items-center",children:[(0,k.jsxs)("h2",{className:"text-2xl font-bold text-white flex items-center gap-2",children:[(0,k.jsx)(xu,{className:"w-7 h-7"}),"horario"===(null===x||void 0===x?void 0:x.tipo)?"Editar Hor\xe1rio":"Novo Hor\xe1rio Personalizado"]}),(0,k.jsx)("button",{onClick:()=>{S(!1),z()},className:"text-white hover:bg-white/20 p-2 rounded-lg transition-colors",children:(0,k.jsx)(Id,{className:"w-6 h-6"})})]}),(0,k.jsxs)("p",{className:"text-green-100 mt-2",children:["Empresa: ",null===a||void 0===a?void 0:a.nome," \u2022 Setor: ",null===o||void 0===o?void 0:o.nome]})]}),(0,k.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),o)if(T.nome.trim())try{"horario"===(null===x||void 0===x?void 0:x.tipo)?(await(0,s.updateDoc)((0,s.doc)(P.db,"horarios_personalizados",x.id),(0,n.A)((0,n.A)({},T),{},{dataAtualizacao:(0,s.O5)()})),zb.success("Hor\xe1rio atualizado com sucesso!")):(await(0,s.gS)((0,s.collection)(P.db,"horarios_personalizados"),(0,n.A)((0,n.A)({},T),{},{setorId:o.id,setorNome:o.nome,empresaId:a.id,empresaNome:a.nome,criadoPor:(null===r||void 0===r?void 0:r.nome)||"Sistema",dataCriacao:(0,s.O5)(),dataAtualizacao:(0,s.O5)()})),zb.success("Hor\xe1rio cadastrado com sucesso!")),S(!1),z(),O(o.id)}catch(t){console.error("Erro ao salvar hor\xe1rio:",t),zb.error("Erro ao salvar hor\xe1rio")}else zb.warning("Nome do hor\xe1rio \xe9 obrigat\xf3rio");else zb.warning("Selecione um setor primeiro")},className:"p-6 space-y-4",children:[(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-bold text-gray-700 dark:text-gray-300 mb-2",children:"Nome do Hor\xe1rio *"}),(0,k.jsx)("input",{type:"text",value:T.nome,onChange:e=>F((0,n.A)((0,n.A)({},T),{},{nome:e.target.value})),className:"w-full px-4 py-3 border-2 border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-green-500 focus:border-transparent",required:!0,autoFocus:!0,placeholder:"Ex: Turno Noturno, Hor\xe1rio Especial"})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-bold text-gray-700 dark:text-gray-300 mb-2",children:"Descri\xe7\xe3o"}),(0,k.jsx)("textarea",{value:T.descricao,onChange:e=>F((0,n.A)((0,n.A)({},T),{},{descricao:e.target.value})),className:"w-full px-4 py-3 border-2 border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white focus:ring-2 focus:ring-green-500 focus:border-transparent",rows:"4",placeholder:"Descreva os detalhes do hor\xe1rio personalizado..."})]}),(0,k.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,k.jsxs)("button",{type:"submit",className:"flex-1 px-6 py-3 bg-gradient-to-r from-green-600 to-emerald-600 text-white rounded-lg hover:from-green-700 hover:to-emerald-700 transition-all font-bold shadow-lg transform hover:scale-105 flex items-center justify-center gap-2",children:[(0,k.jsx)(uw,{className:"w-5 h-5"}),"horario"===(null===x||void 0===x?void 0:x.tipo)?"Atualizar":"Cadastrar"]}),(0,k.jsxs)("button",{type:"button",onClick:()=>{S(!1),z()},className:"px-6 py-3 bg-gray-500 hover:bg-gray-600 text-white rounded-lg transition-all font-bold flex items-center justify-center gap-2",children:[(0,k.jsx)(Id,{className:"w-5 h-5"}),"Cancelar"]})]})]})]})})]})},j_=t=>{let{progress:r,loadingText:a,isComplete:n=!1,fadeOut:s=!1,isRedirecting:i=!1}=t;const[o,l]=(0,e.useState)(0),[c,d]=(0,e.useState)("Iniciando sistema..."),[u,h]=(0,e.useState)(!1),m=void 0!==r?r:o,f=a||c,g=void 0!==r?n:u;return(0,e.useEffect)(()=>{if(void 0===r){const e=[...[{text:"Conectando com o servidor...",duration:800,progress:15},{text:"Carregando configura\xe7\xf5es...",duration:600,progress:30},{text:"Verificando autentica\xe7\xe3o...",duration:700,progress:50},{text:"Carregando dados do usu\xe1rio...",duration:500,progress:70},{text:"Preparando interface...",duration:400,progress:85}],...i?[{text:"Redirecionando para p\xe1gina favorita...",duration:500,progress:95}]:[],{text:"Finalizando...",duration:300,progress:100}];let t=0,r=0;const a=()=>{if(t<e.length){const n=e[t];d(n.text);const s=(n.progress-r)/20,i=setInterval(()=>{r+=s,l(Math.min(r,n.progress)),r>=n.progress&&(clearInterval(i),t++,t<e.length?setTimeout(a,100):d("Sistema carregado!"))},n.duration/20)}};a()}},[r,i]),(0,k.jsxs)("div",{className:"fixed inset-0 min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900 z-50 ".concat(s?"animate-fadeOut":""),style:{transition:s?"opacity 600ms ease-out":"none",opacity:s?0:1},children:[(0,k.jsxs)("div",{className:"text-center p-8",children:[(0,k.jsxs)("div",{className:"mx-auto w-32 h-32 flex items-center justify-center mb-8 relative",children:[(0,k.jsx)(Zd,{src:"/logo.png",alt:"Logo WorkFlow",className:"w-full h-full object-contain relative z-10",style:{animation:g?"bounceSuccess 0.6s ease-in-out":"pulse 2s ease-in-out infinite"}}),!g&&(0,k.jsx)("div",{className:"absolute inset-0 rounded-full border-4 border-blue-500 dark:border-blue-400 opacity-20 animate-ping"}),g&&(0,k.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,k.jsx)("div",{className:"text-6xl text-green-500 animate-checkmark",style:{animation:"checkmarkPop 0.6s ease-in-out"},children:"\u2713"})})]}),(0,k.jsx)("h1",{className:"text-3xl font-bold text-gray-800 dark:text-gray-100 mb-8",children:"WorkFlow"}),(0,k.jsx)("div",{className:"w-96 max-w-full mx-auto mb-6",children:(0,k.jsxs)("div",{className:"relative",children:[(0,k.jsx)("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-3 overflow-hidden shadow-inner",children:(0,k.jsx)("div",{className:"h-full rounded-full transition-all duration-500 ease-out relative overflow-hidden",style:{width:"".concat(Math.max(0,Math.min(100,m)),"%"),background:g?"linear-gradient(90deg, #10b981 0%, #059669 50%, #10b981 100%)":"linear-gradient(90deg, #3b82f6 0%, #1d4ed8 50%, #3b82f6 100%)",backgroundSize:"200% 100%",animation:m<100?"shimmer 2s infinite":"none"},children:m<100&&(0,k.jsx)("div",{className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/30 to-transparent animate-shimmer"})})}),(0,k.jsxs)("div",{className:"flex justify-between items-center mt-2",children:[(0,k.jsx)("span",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:f}),(0,k.jsxs)("span",{className:"text-lg font-bold transition-colors duration-300 ".concat(g?"text-green-600 dark:text-green-400":"text-blue-600 dark:text-blue-400"),children:[Math.round(Math.max(0,Math.min(100,m))),"%"]})]})]})}),g?(0,k.jsxs)("div",{className:"flex justify-center items-center gap-2 mt-4",children:[(0,k.jsx)("div",{className:"w-8 h-8 bg-green-500 rounded-full flex items-center justify-center animate-bounce",children:(0,k.jsx)("span",{className:"text-white text-xl",children:"\u2713"})}),(0,k.jsx)("span",{className:"text-sm text-green-600 dark:text-green-400 font-medium",children:"Carregamento conclu\xeddo!"})]}):(0,k.jsxs)("div",{className:"flex justify-center items-center gap-2 mt-4",children:[(0,k.jsxs)("div",{className:"relative",children:[(0,k.jsx)("div",{className:"w-8 h-8 border-4 border-blue-200 dark:border-blue-800 rounded-full"}),(0,k.jsx)("div",{className:"w-8 h-8 border-4 border-blue-600 dark:border-blue-400 border-t-transparent rounded-full animate-spin absolute top-0 left-0"})]}),(0,k.jsx)("span",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Por favor, aguarde..."})]})]}),(0,k.jsx)("style",{jsx:!0,children:"\n        @keyframes shimmer {\n          0% { background-position: 200% 0; }\n          100% { background-position: -200% 0; }\n        }\n\n        @keyframes bounceSuccess {\n          0%, 20%, 53%, 80%, 100% {\n            transform: translate3d(0,0,0);\n          }\n          40%, 43% {\n            transform: translate3d(0, -15px, 0);\n          }\n          70% {\n            transform: translate3d(0, -7px, 0);\n          }\n          90% {\n            transform: translate3d(0, -2px, 0);\n          }\n        }\n\n        @keyframes checkmarkPop {\n          0% {\n            transform: scale(0);\n            opacity: 0;\n          }\n          50% {\n            transform: scale(1.2);\n            opacity: 1;\n          }\n          100% {\n            transform: scale(1);\n            opacity: 1;\n          }\n        }\n\n        @keyframes animate-shimmer {\n          0% {\n            transform: translateX(-100%);\n          }\n          100% {\n            transform: translateX(100%);\n          }\n        }\n\n        .animate-shimmer {\n          animation: animate-shimmer 2s infinite;\n        }\n\n        .animate-checkmark {\n          animation: checkmarkPop 0.6s ease-in-out;\n        }\n      "})]})},S_=e=>{let{count:t=0,max:r=99,size:a="md",position:n="top-right",className:s=""}=e;if(t<=0)return null;const i=t>r?"".concat(r,"+"):t;return(0,k.jsx)("span",{className:"\n        absolute ".concat({"top-right":"-top-1 -right-1","top-left":"-top-1 -left-1","bottom-right":"-bottom-1 -right-1","bottom-left":"-bottom-1 -left-1"}[n]," \n        ").concat({sm:"min-w-[14px] h-3.5 px-1 text-[9px]",md:"min-w-[18px] h-4.5 px-1 text-[10px]",lg:"min-w-[22px] h-5 px-1.5 text-xs"}[a]," \n        bg-red-500 text-white\n        font-bold rounded-full \n        flex items-center justify-center \n        shadow-lg\n        transition-all duration-200\n        z-10\n        ").concat(s,"\n      "),role:"status","aria-label":"".concat(t," mensagens n\xe3o lidas"),children:i})},__=y("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),E_=t=>{let{onVoltar:r,onSucesso:a}=t;const[i,o]=(0,e.useState)({email:"",novaSenha:"",confirmarSenha:"",codigo:""}),[l,c]=(0,e.useState)(!1),[d,u]=(0,e.useState)(!1),[h,m]=(0,e.useState)(!1),[f,g]=(0,e.useState)(""),[p,x]=(0,e.useState)(!1),[y,v]=(0,e.useState)({nivel:0,texto:"",cor:""}),N=(e,t)=>{o((0,n.A)((0,n.A)({},i),{},{[e]:t})),g(""),"novaSenha"===e&&v((e=>{if(!e)return{nivel:0,texto:"",cor:""};let t=0;const r={tamanho:e.length>=8,maiuscula:/[A-Z]/.test(e),minuscula:/[a-z]/.test(e),numero:/[0-9]/.test(e),especial:/[^A-Za-z0-9]/.test(e)};let a,n,s;return t+=r.tamanho?20:0,t+=r.maiuscula?20:0,t+=r.minuscula?20:0,t+=r.numero?20:0,t+=r.especial?20:0,e.length>12&&(t+=10),e.length>16&&(t+=10),t<40?(a=1,n="Muito Fraca",s="bg-red-500"):t<60?(a=2,n="Fraca",s="bg-orange-500"):t<80?(a=3,n="M\xe9dia",s="bg-yellow-500"):t<100?(a=4,n="Forte",s="bg-green-500"):(a=5,n="Muito Forte",s="bg-emerald-500"),{nivel:a,texto:n,cor:s,requisitos:r}})(t))};return p?(0,k.jsxs)(Cd.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"text-center py-12",children:[(0,k.jsx)(Cd.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.2,type:"spring"},className:"mx-auto w-24 h-24 bg-green-100 dark:bg-green-900/30 rounded-full flex items-center justify-center mb-6",children:(0,k.jsx)(Fd,{className:"w-16 h-16 text-green-600 dark:text-green-400"})}),(0,k.jsx)("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-4",children:"Senha Redefinida!"}),(0,k.jsxs)("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:["Sua senha foi alterada com sucesso.",(0,k.jsx)("br",{}),"Voc\xea j\xe1 pode fazer login com a nova senha."]}),(0,k.jsx)(Cd.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:r,className:"px-6 py-3 bg-green-600 hover:bg-green-700 text-white rounded-lg font-medium transition-colors",children:"Voltar ao Login"})]}):(0,k.jsxs)("div",{className:"max-w-md w-full",children:[(0,k.jsxs)("div",{className:"text-center mb-8",children:[(0,k.jsx)(Cd.div,{initial:{scale:0},animate:{scale:1},className:"mx-auto w-20 h-20 bg-blue-100 dark:bg-blue-900/30 rounded-full flex items-center justify-center mb-4",children:(0,k.jsx)(I,{className:"w-12 h-12 text-blue-600 dark:text-blue-400"})}),(0,k.jsx)("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:"Redefinir Senha"}),(0,k.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"Insira o c\xf3digo fornecido pelo administrador"})]}),(0,k.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),i.email.trim()?i.codigo.trim()?i.novaSenha?i.novaSenha.length<6?(g("A senha deve ter no m\xednimo 6 caracteres"),0):i.novaSenha===i.confirmarSenha||(g("As senhas n\xe3o coincidem"),0):(g("Por favor, insira a nova senha"),0):(g("Por favor, insira o c\xf3digo de redefini\xe7\xe3o"),0):(g("Por favor, insira seu nome de usu\xe1rio ou email"),0)){m(!0),g("");try{const e=await(async(e,t,r)=>{try{console.log("\ud83d\udd04 Iniciando redefini\xe7\xe3o de senha para:",e);const a=await y_(r,e);if(!a.valido)return{success:!1,message:a.motivo};const n=(0,s.collection)(Jt,"usuarios"),i=(0,s.P)(n,(0,s._M)("email","==",e)),o=await(0,s.GG)(i);if(o.empty)return console.log("\u274c Usu\xe1rio n\xe3o encontrado"),{success:!1,message:"Usu\xe1rio n\xe3o encontrado"};const l=o.docs[0].id;console.log("\u2705 Usu\xe1rio encontrado:",l),console.log("\ud83d\udd12 Gerando novo hash SHA-512...");const{hash:c,salt:d,version:u,algorithm:h}=B(t);return await(0,s.updateDoc)((0,s.doc)(Jt,"usuarios",l),{senhaHash:c,senhaSalt:d,senhaVersion:u,senhaAlgorithm:h,senha:null,senhaAtualizadaEm:(new Date).toISOString()}),console.log("\u2705 Senha atualizada no Firebase Backup"),await(0,s.updateDoc)((0,s.doc)(Jt,"codigosRedefinicao",a.id),{usado:!0,usadoEm:(new Date).toISOString(),usadoPor:e}),console.log("\u2705 C\xf3digo marcado como usado"),{success:!0,message:"Senha redefinida com sucesso!"}}catch(a){return console.error("\u274c Erro ao redefinir senha:",a),{success:!1,message:"Erro ao redefinir senha: "+a.message}}})(i.email,i.novaSenha,i.codigo);e.success?(x(!0),setTimeout(()=>{a&&a()},3e3)):g(e.message||"Erro ao redefinir senha")}catch(t){console.error("Erro ao redefinir senha:",t),g("Erro ao processar solicita\xe7\xe3o. Tente novamente.")}finally{m(!1)}}},className:"space-y-5",children:[(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-200 mb-2",children:"Nome de Usu\xe1rio ou Email"}),(0,k.jsxs)("div",{className:"relative",children:[(0,k.jsx)(mu,{className:"w-4 h-4 absolute left-3 top-3.5 text-gray-400 dark:text-gray-500"}),(0,k.jsx)("input",{type:"text",value:i.email,onChange:e=>N("email",e.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Digite seu usu\xe1rio",disabled:h,autoFocus:!0})]})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-200 mb-2",children:"C\xf3digo de Redefini\xe7\xe3o"}),(0,k.jsxs)("div",{className:"relative",children:[(0,k.jsx)(g_,{className:"w-4 h-4 absolute left-3 top-3.5 text-gray-400 dark:text-gray-500"}),(0,k.jsx)("input",{type:"text",value:i.codigo,onChange:e=>N("codigo",e.target.value.toUpperCase()),className:"w-full pl-10 pr-4 py-3 border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent font-mono tracking-wider",placeholder:"ABC-123-XYZ",disabled:h,maxLength:11})]}),(0,k.jsx)("p",{className:"mt-1 text-xs text-gray-500 dark:text-gray-400",children:"C\xf3digo fornecido pelo administrador do sistema"})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-200 mb-2",children:"Nova Senha"}),(0,k.jsxs)("div",{className:"relative",children:[(0,k.jsx)(AN,{className:"w-4 h-4 absolute left-3 top-3.5 text-gray-400 dark:text-gray-500"}),(0,k.jsx)("input",{type:l?"text":"password",value:i.novaSenha,onChange:e=>N("novaSenha",e.target.value),className:"w-full pl-10 pr-12 py-3 border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Digite a nova senha",disabled:h}),(0,k.jsx)("button",{type:"button",onClick:()=>c(!l),className:"absolute right-3 top-3.5 text-gray-400 dark:text-gray-500 hover:text-gray-600 dark:hover:text-gray-300",disabled:h,children:l?(0,k.jsx)(gr,{className:"w-5 h-5"}):(0,k.jsx)(pr,{className:"w-5 h-5"})})]}),i.novaSenha&&(0,k.jsxs)("div",{className:"mt-2",children:[(0,k.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,k.jsx)("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:"For\xe7a da senha:"}),(0,k.jsx)("span",{className:"text-xs font-medium ".concat(y.cor.replace("bg-","text-")),children:y.texto})]}),(0,k.jsx)("div",{className:"h-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden",children:(0,k.jsx)(Cd.div,{initial:{width:0},animate:{width:"".concat(y.nivel/5*100,"%")},className:"h-full ".concat(y.cor)})}),y.requisitos&&(0,k.jsxs)("div",{className:"mt-2 text-xs space-y-1",children:[(0,k.jsxs)("div",{className:"flex items-center gap-1 ".concat(y.requisitos.tamanho?"text-green-600":"text-gray-400"),children:[y.requisitos.tamanho?(0,k.jsx)(Fd,{className:"w-3 h-3"}):(0,k.jsx)(b,{className:"w-3 h-3"}),"M\xednimo 8 caracteres"]}),(0,k.jsxs)("div",{className:"flex items-center gap-1 ".concat(y.requisitos.maiuscula?"text-green-600":"text-gray-400"),children:[y.requisitos.maiuscula?(0,k.jsx)(Fd,{className:"w-3 h-3"}):(0,k.jsx)(b,{className:"w-3 h-3"}),"Letra mai\xfascula"]}),(0,k.jsxs)("div",{className:"flex items-center gap-1 ".concat(y.requisitos.numero?"text-green-600":"text-gray-400"),children:[y.requisitos.numero?(0,k.jsx)(Fd,{className:"w-3 h-3"}):(0,k.jsx)(b,{className:"w-3 h-3"}),"N\xfamero"]})]})]})]}),(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-200 mb-2",children:"Confirmar Nova Senha"}),(0,k.jsxs)("div",{className:"relative",children:[(0,k.jsx)(AN,{className:"w-4 h-4 absolute left-3 top-3.5 text-gray-400 dark:text-gray-500"}),(0,k.jsx)("input",{type:d?"text":"password",value:i.confirmarSenha,onChange:e=>N("confirmarSenha",e.target.value),className:"w-full pl-10 pr-12 py-3 border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Digite a senha novamente",disabled:h}),(0,k.jsx)("button",{type:"button",onClick:()=>u(!d),className:"absolute right-3 top-3.5 text-gray-400 dark:text-gray-500 hover:text-gray-600 dark:hover:text-gray-300",disabled:h,children:d?(0,k.jsx)(gr,{className:"w-5 h-5"}):(0,k.jsx)(pr,{className:"w-5 h-5"})})]}),i.confirmarSenha&&(0,k.jsx)("div",{className:"mt-2",children:i.novaSenha===i.confirmarSenha?(0,k.jsxs)("div",{className:"flex items-center gap-1 text-green-600 text-xs",children:[(0,k.jsx)(Fd,{className:"w-3 h-3"}),"As senhas coincidem"]}):(0,k.jsxs)("div",{className:"flex items-center gap-1 text-red-600 text-xs",children:[(0,k.jsx)(b,{className:"w-3 h-3"}),"As senhas n\xe3o coincidem"]})})]}),(0,k.jsx)(Pr,{children:f&&(0,k.jsxs)(Cd.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"bg-red-50 dark:bg-red-900/30 border border-red-200 dark:border-red-800 text-red-600 dark:text-red-400 px-4 py-3 rounded-lg text-sm flex items-start gap-2",children:[(0,k.jsx)(w,{className:"w-5 h-5 flex-shrink-0 mt-0.5"}),(0,k.jsx)("span",{children:f})]})}),(0,k.jsxs)("div",{className:"flex gap-3",children:[(0,k.jsxs)("button",{type:"button",onClick:r,disabled:h,className:"flex-1 flex items-center justify-center gap-2 py-3 px-4 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-200 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,k.jsx)(__,{className:"w-4 h-4"}),"Voltar"]}),(0,k.jsx)("button",{type:"submit",disabled:h,className:"flex-1 py-3 px-4 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-400 text-white rounded-lg font-medium transition-colors disabled:cursor-not-allowed",children:h?(0,k.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,k.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Processando..."]}):"Redefinir Senha"})]})]}),(0,k.jsx)("div",{className:"mt-6 p-4 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg",children:(0,k.jsxs)("div",{className:"flex gap-2",children:[(0,k.jsx)(w,{className:"w-5 h-5 text-blue-600 dark:text-blue-400 flex-shrink-0 mt-0.5"}),(0,k.jsxs)("div",{className:"text-sm text-blue-800 dark:text-blue-300",children:[(0,k.jsx)("p",{className:"font-medium mb-1",children:"N\xe3o tem um c\xf3digo?"}),(0,k.jsx)("p",{children:"Solicite um c\xf3digo de redefini\xe7\xe3o ao administrador do sistema."})]})]})})]})},A_=t=>{let{onVoltar:r,onSucesso:a}=t;const[i,o]=(0,e.useState)(1),[l,c]=(0,e.useState)({nomeCompleto:"",email:"",senha:"",confirmarSenha:"",codigo:"",fotoPerfil:null,fotoPerfilURL:""}),[d,u]=(0,e.useState)(!1),[h,m]=(0,e.useState)(!1),[f,g]=(0,e.useState)(!1),[p,x]=(0,e.useState)(""),[y,v]=(0,e.useState)(!1),[b,N]=(0,e.useState)(!1),j=(0,e.useRef)(null),S=(0,e.useRef)(null),_=[{numero:1,icone:mu,label:"Nome",campo:"nomeCompleto"},{numero:2,icone:EN,label:"Email",campo:"email"},{numero:3,icone:AN,label:"Senha",campo:"senha"},{numero:4,icone:AN,label:"Confirmar",campo:"confirmarSenha"},{numero:5,icone:ej,label:"Foto",campo:"fotoPerfil"},{numero:6,icone:g_,label:"C\xf3digo",campo:"codigo"}],E=()=>{switch(i){case 1:return l.nomeCompleto.trim().length>0;case 2:return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(l.email);case 3:return l.senha.length>=8;case 4:return l.senha===l.confirmarSenha&&l.senha.length>=8;case 5:return!0;case 6:return l.codigo.trim().length>0;default:return!1}},A=(e=>{let t=0;return e.length>=8&&t++,e.length>=12&&t++,/[a-z]/.test(e)&&/[A-Z]/.test(e)&&t++,/[0-9]/.test(e)&&t++,/[^a-zA-Z0-9]/.test(e)&&t++,t})(l.senha),C=["Muito Fraca","Fraca","M\xe9dia","Forte","Muito Forte"],I=["bg-red-500","bg-orange-500","bg-yellow-500","bg-green-500","bg-emerald-500"],T=e=>{const{name:t,value:r}=e.target;c(e=>(0,n.A)((0,n.A)({},e),{},{[t]:r})),x("")},D=async e=>{const t=e.target.files[0];if(t)if(t.size>5242880)x("A foto deve ter no m\xe1ximo 5MB");else if(t.type.startsWith("image/")){N(!0),x("");try{const e=new FileReader;e.onloadend=()=>{c(r=>(0,n.A)((0,n.A)({},r),{},{fotoPerfil:t,fotoPerfilURL:e.result}))},e.readAsDataURL(t)}catch(r){console.error("Erro ao processar foto:",r),x("Erro ao processar foto. Tente novamente.")}finally{N(!1)}}else x("Por favor, selecione uma imagem v\xe1lida")},P=()=>{c(e=>(0,n.A)((0,n.A)({},e),{},{fotoPerfil:null,fotoPerfilURL:""})),j.current&&(j.current.value=""),S.current&&(S.current.value="")},F=()=>{E()&&i<6&&(o(i+1),x(""))},L=e=>{"Enter"===e.key&&E()&&(i<6?F():M(e))},M=async e=>{if(e.preventDefault(),x(""),E()){g(!0);try{const e=await(async(e,t,r,a)=>{try{console.log("\ud83d\udc64 Criando usu\xe1rio com c\xf3digo:",{nomeCompleto:e,email:t,codigo:a});const n=await y_(a,t);if(!n.valido)return{success:!1,error:n.motivo};if("usuario"===n.nivelUsuario&&(!n.empresaId||!n.setorId))return{success:!1,error:"Este c\xf3digo n\xe3o possui empresa ou setor associados. Entre em contato com o administrador."};const s=B(r);return console.log("\u2705 C\xf3digo validado, dados prontos para registro"),{success:!0,codigoId:n.id,dadosUsuario:{nome:e,email:t,senha:s,empresaId:n.empresaId,setorId:n.setorId,nivel:n.nivelUsuario||"usuario"}}}catch(n){return console.error("\u274c Erro ao criar usu\xe1rio com c\xf3digo:",n),{success:!1,error:n.message}}})(l.codigo,l.email,l.senha,l.nomeCompleto);if(!e.sucesso)return x(e.mensagem||"Erro ao validar c\xf3digo"),void g(!1);const r=(0,s.collection)(vt,"usuarios"),n=(0,s.P)(r,(0,s._M)("email","==",l.email));if(!(await(0,s.GG)(n)).empty)return x("J\xe1 existe um usu\xe1rio cadastrado com este email"),void g(!1);let i="";if(l.fotoPerfil)try{const e=Date.now(),t="perfil_".concat(e,"_").concat(l.fotoPerfil.name),r=(0,xt.KR)(bt,"usuarios/fotos_perfil/".concat(t));await(0,xt.D)(r,l.fotoPerfil),i=await(0,xt.qk)(r),console.log("\u2705 Foto de perfil enviada:",i)}catch(t){console.warn("\u26a0\ufe0f Erro ao fazer upload da foto, continuando sem ela:",t)}const{nome:o,email:c,senha:d}=e.dadosUsuario,{hash:u,salt:h,version:m,algorithm:f}=B(d),p={nome:o||l.nomeCompleto,email:c,senha:u,salt:h,version:m,algorithm:f,nivel:parseInt(e.dadosUsuario.nivel),ativo:!0,criadoEm:(new Date).toISOString(),criadoPorCodigo:l.codigo,bancoDeDados:"workflowbr1",fotoPerfil:i||""},y=parseInt(e.dadosUsuario.nivel);y>=1&&y<=3&&(p.empresaId=e.dadosUsuario.empresaId,p.setorId=e.dadosUsuario.setorId),await(0,s.gS)(r,p),console.log("\u2705 Usu\xe1rio criado com sucesso no workflowbr1:",{nome:p.nome,email:p.email,nivel:p.nivel,banco:"workflowbr1",temFoto:!!i}),v(!0),setTimeout(()=>{a&&a()},3e3)}catch(t){console.error("\u274c Erro ao criar conta:",t),x(t.message||"Erro ao criar conta. Tente novamente.")}finally{g(!1)}}else x("Por favor, preencha todos os campos corretamente")};if(y)return(0,k.jsx)(Cd.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"w-full max-w-md mx-auto p-8 bg-white dark:bg-gray-800 rounded-xl shadow-lg",children:(0,k.jsxs)("div",{className:"text-center",children:[(0,k.jsx)(Cd.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.2,type:"spring"},className:"mx-auto w-20 h-20 bg-green-100 dark:bg-green-900/30 rounded-full flex items-center justify-center mb-4",children:(0,k.jsx)(Fd,{className:"w-12 h-12 text-green-600 dark:text-green-400"})}),(0,k.jsx)("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:"Conta Criada com Sucesso! \ud83c\udf89"}),(0,k.jsx)("p",{className:"text-gray-600 dark:text-gray-300 mb-6",children:"Sua conta foi criada e voc\xea j\xe1 pode fazer login no sistema."}),l.fotoPerfilURL&&(0,k.jsx)(Cd.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.3},className:"mb-4",children:(0,k.jsx)("img",{src:l.fotoPerfilURL,alt:"Foto de perfil",className:"w-24 h-24 rounded-full mx-auto border-4 border-[#1d9bf0] object-cover"})}),(0,k.jsxs)("div",{className:"bg-[#e8f5fe] dark:bg-[#1d9bf0]/20 border border-[#1d9bf0]/30 dark:border-[#1d9bf0]/50 rounded-lg p-4 text-left mb-4",children:[(0,k.jsxs)("p",{className:"text-sm text-[#1d9bf0] dark:text-[#1d9bf0]",children:[(0,k.jsx)("strong",{children:"Email:"})," ",l.email]}),(0,k.jsxs)("p",{className:"text-sm text-[#1d9bf0] dark:text-[#1d9bf0] mt-1",children:[(0,k.jsx)("strong",{children:"Nome:"})," ",l.nomeCompleto]})]}),(0,k.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Redirecionando para a tela de login..."})]})});return(0,k.jsxs)(Cd.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"w-full max-w-md mx-auto p-8 bg-white dark:bg-gray-800 rounded-xl shadow-lg",children:[(0,k.jsxs)("div",{className:"text-center mb-6",children:[(0,k.jsxs)(Cd.div,{initial:{rotate:-180,scale:0},animate:{rotate:0,scale:1},transition:{type:"spring",stiffness:200},className:"mx-auto w-16 h-16 mb-4 relative",children:[(0,k.jsx)("div",{className:"absolute inset-0 bg-[#1d9bf0] rounded-full opacity-70",style:{mixBlendMode:"multiply"}}),(0,k.jsx)("img",{src:"/logo.png",alt:"Logo WorkFlow",className:"w-full h-full object-contain relative z-10"})]}),(0,k.jsx)("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:"Criar Nova Conta"}),(0,k.jsxs)("p",{className:"text-gray-600 dark:text-gray-300 text-sm",children:["Etapa ",i," de 6"]})]}),(0,k.jsxs)("div",{className:"mb-8",children:[(0,k.jsx)("div",{className:"flex justify-between mb-2",children:_.map((e,t)=>{const r=e.icone,a=e.numero<i,n=e.numero===i;return(0,k.jsxs)(Cd.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.1*t},className:"flex flex-col items-center",children:[(0,k.jsx)("div",{className:"w-10 h-10 rounded-full flex items-center justify-center transition-all ".concat(a?"bg-[#1d9bf0] text-white":n?"bg-[#1d9bf0] text-white ring-4 ring-[#1d9bf0]/30":"bg-gray-200 dark:bg-gray-700 text-gray-400"),children:a?(0,k.jsx)(lk,{className:"w-5 h-5"}):(0,k.jsx)(r,{className:"w-5 h-5"})}),(0,k.jsx)("span",{className:"text-xs mt-1 ".concat(n?"text-[#1d9bf0] font-semibold":"text-gray-400"),children:e.label})]},e.numero)})}),(0,k.jsx)("div",{className:"relative h-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden",children:(0,k.jsx)(Cd.div,{initial:{width:0},animate:{width:"".concat(i/6*100,"%")},transition:{duration:.5},className:"absolute left-0 top-0 h-full bg-[#1d9bf0] rounded-full"})})]}),(0,k.jsx)(Pr,{children:p&&(0,k.jsxs)(Cd.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"mb-4 p-3 bg-red-100 dark:bg-red-900/30 border border-red-400 dark:border-red-600 text-red-700 dark:text-red-400 rounded-lg flex items-center gap-2 text-sm",children:[(0,k.jsx)(w,{className:"w-4 h-4 flex-shrink-0"}),(0,k.jsx)("span",{children:p})]})}),(0,k.jsxs)("form",{onSubmit:M,children:[(()=>{const e=_[i-1].icone;return(0,k.jsx)(Pr,{mode:"wait",children:(0,k.jsxs)(Cd.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},transition:{duration:.3},className:"space-y-4",children:[(0,k.jsx)(Cd.div,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:200},className:"mx-auto w-20 h-20 bg-[#e8f5fe] dark:bg-[#1d9bf0]/20 rounded-full flex items-center justify-center mb-6",children:(0,k.jsx)(e,{className:"w-10 h-10 text-[#1d9bf0]"})}),1===i&&(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-200 mb-2 text-center",children:"Nome Completo"}),(0,k.jsx)("input",{type:"text",name:"nomeCompleto",value:l.nomeCompleto,onChange:T,onKeyPress:L,placeholder:"Jo\xe3o da Silva",className:"w-full px-4 py-3 border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white rounded-lg focus:ring-2 focus:ring-[#1d9bf0] focus:border-transparent text-center text-lg",disabled:f,autoFocus:!0,required:!0})]}),2===i&&(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-200 mb-2 text-center",children:"Email"}),(0,k.jsx)("input",{type:"email",name:"email",value:l.email,onChange:T,onKeyPress:L,placeholder:"seu@email.com",className:"w-full px-4 py-3 border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white rounded-lg focus:ring-2 focus:ring-[#1d9bf0] focus:border-transparent text-center text-lg",disabled:f,autoFocus:!0,required:!0})]}),3===i&&(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-200 mb-2 text-center",children:"Senha"}),(0,k.jsxs)("div",{className:"relative",children:[(0,k.jsx)("input",{type:d?"text":"password",name:"senha",value:l.senha,onChange:T,onKeyPress:L,placeholder:"M\xednimo 8 caracteres",className:"w-full px-4 py-3 pr-12 border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white rounded-lg focus:ring-2 focus:ring-[#1d9bf0] focus:border-transparent text-center text-lg",disabled:f,autoFocus:!0,required:!0}),(0,k.jsx)("button",{type:"button",onClick:()=>u(!d),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:d?(0,k.jsx)(gr,{className:"w-5 h-5"}):(0,k.jsx)(pr,{className:"w-5 h-5"})})]}),l.senha&&(0,k.jsxs)(Cd.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"mt-2",children:[(0,k.jsx)("div",{className:"flex gap-1 mb-1",children:[0,1,2,3,4].map(e=>(0,k.jsx)("div",{className:"h-2 flex-1 rounded-full transition-colors ".concat(e<A?I[A-1]:"bg-gray-300 dark:bg-gray-600")},e))}),(0,k.jsx)("p",{className:"text-xs text-center text-gray-600 dark:text-gray-400",children:C[A-1]||"Muito Fraca"})]})]}),4===i&&(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-200 mb-2 text-center",children:"Confirmar Senha"}),(0,k.jsxs)("div",{className:"relative",children:[(0,k.jsx)("input",{type:h?"text":"password",name:"confirmarSenha",value:l.confirmarSenha,onChange:T,onKeyPress:L,placeholder:"Digite a senha novamente",className:"w-full px-4 py-3 pr-12 border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white rounded-lg focus:ring-2 focus:ring-[#1d9bf0] focus:border-transparent text-center text-lg",disabled:f,autoFocus:!0,required:!0}),(0,k.jsx)("button",{type:"button",onClick:()=>m(!h),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:h?(0,k.jsx)(gr,{className:"w-5 h-5"}):(0,k.jsx)(pr,{className:"w-5 h-5"})})]}),l.confirmarSenha&&(0,k.jsx)(Cd.div,{initial:{opacity:0},animate:{opacity:1},className:"mt-2 flex items-center justify-center gap-2",children:l.senha===l.confirmarSenha?(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(lk,{className:"w-4 h-4 text-green-600"}),(0,k.jsx)("span",{className:"text-sm text-green-600",children:"Senhas correspondem"})]}):(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(Id,{className:"w-4 h-4 text-red-600"}),(0,k.jsx)("span",{className:"text-sm text-red-600",children:"Senhas n\xe3o correspondem"})]})})]}),5===i&&(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-200 mb-4 text-center",children:"Foto de Perfil (Opcional)"}),l.fotoPerfilURL?(0,k.jsxs)(Cd.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},className:"relative",children:[(0,k.jsx)("img",{src:l.fotoPerfilURL,alt:"Preview",className:"w-32 h-32 rounded-full mx-auto object-cover border-4 border-[#1d9bf0]"}),(0,k.jsx)("button",{type:"button",onClick:P,className:"absolute top-0 right-1/2 transform translate-x-16 bg-red-500 hover:bg-red-600 text-white p-2 rounded-full transition-colors",children:(0,k.jsx)(Id,{className:"w-4 h-4"})})]}):(0,k.jsxs)("div",{className:"flex gap-3 justify-center",children:[(0,k.jsxs)("button",{type:"button",onClick:()=>{var e;return null===(e=S.current)||void 0===e?void 0:e.click()},disabled:b,className:"flex flex-col items-center gap-2 px-6 py-4 bg-[#1d9bf0] hover:bg-[#1a8cd8] text-white rounded-lg transition-colors disabled:opacity-50",children:[(0,k.jsx)(cN,{className:"w-8 h-8"}),(0,k.jsx)("span",{className:"text-sm",children:"C\xe2mera"})]}),(0,k.jsxs)("button",{type:"button",onClick:()=>{var e;return null===(e=j.current)||void 0===e?void 0:e.click()},disabled:b,className:"flex flex-col items-center gap-2 px-6 py-4 bg-[#1d9bf0] hover:bg-[#1a8cd8] text-white rounded-lg transition-colors disabled:opacity-50",children:[(0,k.jsx)(Kk,{className:"w-8 h-8"}),(0,k.jsx)("span",{className:"text-sm",children:"Galeria"})]}),(0,k.jsx)("input",{ref:S,type:"file",accept:"image/*",capture:"user",onChange:D,className:"hidden"}),(0,k.jsx)("input",{ref:j,type:"file",accept:"image/*",onChange:D,className:"hidden"})]}),(0,k.jsx)("p",{className:"text-xs text-center text-gray-500 dark:text-gray-400 mt-4",children:"Voc\xea pode pular esta etapa e adicionar depois"})]}),6===i&&(0,k.jsxs)("div",{children:[(0,k.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-200 mb-2 text-center",children:"C\xf3digo de Registro"}),(0,k.jsx)("input",{type:"text",name:"codigo",value:l.codigo,onChange:T,onKeyPress:L,placeholder:"ABC-123-XYZ",className:"w-full px-4 py-3 border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white rounded-lg focus:ring-2 focus:ring-[#1d9bf0] focus:border-transparent text-center text-lg font-mono uppercase",disabled:f,autoFocus:!0,required:!0}),(0,k.jsx)("p",{className:"text-xs text-center text-gray-500 dark:text-gray-400 mt-2",children:"C\xf3digo fornecido pelo administrador do sistema"})]})]},i)})})(),(0,k.jsxs)("div",{className:"flex gap-3 mt-6",children:[i>1&&(0,k.jsxs)("button",{type:"button",onClick:()=>{i>1&&(o(i-1),x(""))},disabled:f,className:"flex items-center gap-2 px-4 py-2 text-gray-700 dark:text-gray-300 bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 rounded-lg transition-colors disabled:opacity-50",children:[(0,k.jsx)(__,{className:"w-4 h-4"}),"Voltar"]}),1===i&&(0,k.jsxs)("button",{type:"button",onClick:r,disabled:f,className:"flex items-center gap-2 px-4 py-2 text-gray-700 dark:text-gray-300 bg-gray-200 dark:bg-gray-700 hover:bg-gray-300 dark:hover:bg-gray-600 rounded-lg transition-colors disabled:opacity-50",children:[(0,k.jsx)(__,{className:"w-4 h-4"}),"Cancelar"]}),i<6?(0,k.jsxs)("button",{type:"button",onClick:F,disabled:!E()||f,className:"flex-1 flex items-center justify-center gap-2 px-4 py-3 bg-[#1d9bf0] hover:bg-[#1a8cd8] text-white rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed font-semibold",children:["Pr\xf3ximo",(0,k.jsx)(vu,{className:"w-4 h-4"})]}):(0,k.jsx)("button",{type:"submit",disabled:!E()||f,className:"flex-1 flex items-center justify-center gap-2 px-4 py-3 bg-[#1d9bf0] hover:bg-[#1a8cd8] text-white rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed font-semibold",children:f?(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(Cd.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},children:(0,k.jsx)(w,{className:"w-5 h-5"})}),"Criando..."]}):(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(lk,{className:"w-5 h-5"}),"Criar Conta"]})})]})]}),(0,k.jsx)("p",{className:"text-xs text-center text-gray-400 dark:text-gray-500 mt-4",children:"Pressione Enter para avan\xe7ar"})]})},C_="workflow-garden-secure-key-2025",I_=function(e){const t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:null)||L().lib.WordArray.random(16).toString();return{password:e,hash:L().SHA512(e+t+C_).toString(),salt:t,version:2,algorithm:"SHA-512"}},T_=(e,t)=>{const r=["123456","123456789","12345678","1234567890","123123","111111","222222","333333","000000","999999","password","senha","admin","user","teste","qwerty","abc123","abcdef","asdfgh","zxcvbn","ezequiel","Ezequiel","EZEQUIEL","ezequiel123","Ezequiel123","ezequiel2024","ezequiel2025","ezequiel@123","ezequiel@2024","ezequiel@2025","garden","Garden","GARDEN","garden123","Garden123","garden2024","garden2025","almoxarifado","Almoxarifado","almoxarifado123","senha123","mudar123","trocar123","welcome","Welcome123","1q2w3e4r","1qaz2wsx","qwer1234","asdf1234","01012024","01012025","31122024","31122025","10102024","10102025","20242024","20252025","brasil","Brasil","brasil123","Brazil123","user123","teste123","padrao123","temp123","147258","159357","741852","987654","master","Master123","admin123","Admin123","sistema","Sistema123","empresa","Empresa123"];console.log("\ud83d\udd0d Testando ".concat(r.length," senhas poss\xedveis..."));for(const a of r){if(L().SHA512(a+t+C_).toString()===e)return{found:!0,password:a,message:'\u2705 Senha encontrada: "'.concat(a,'"')}}return{found:!1,password:null,message:"\u274c Senha n\xe3o encontrada na lista. Tente adicionar mais op\xe7\xf5es ou use for\xe7a bruta completa."}},D_=(e,t,r)=>L().SHA512(e+r+C_).toString()===t,P_=(e,t)=>({hash:e,hashLength:e.length,salt:t,saltLength:t.length,algorithm:"SHA-512",version:2,info:"Hash SHA-512 com salt e APP_SECRET"});"undefined"!==typeof window&&(window.passwordDebug={generateHash:I_,bruteForcePassword:T_,testPassword:D_,analyzeHash:P_,help:()=>{console.log('\n\ud83d\udd27 Utilit\xe1rio de Debug de Senhas\n\nFun\xe7\xf5es dispon\xedveis:\n\n1. passwordDebug.generateHash("senha")\n   - Gera um hash para a senha fornecida\n\n2. passwordDebug.testPassword("senha", "hash", "salt")\n   - Testa se uma senha gera o hash fornecido\n\n3. passwordDebug.bruteForcePassword("hash", "salt")\n   - Tenta descobrir a senha usando for\xe7a bruta\n\n4. passwordDebug.analyzeHash("hash", "salt")\n   - Mostra informa\xe7\xf5es sobre o hash\n\nExemplo:\n  passwordDebug.bruteForcePassword(\n    "861a97d64f1222bed7be2ed5fb683351469a4f03219b133b691754a5ba21cf11e22a91c92064251e4119e4c97972b195a879dd4c0889fb82814a6f3df6bd7d17",\n    "6cb062ef5bed7bd85ffd16fc19847b11"\n  );\n      ')}},console.log("\ud83d\udd27 Utilit\xe1rio de Debug de Senhas carregado!"),console.log("Digite passwordDebug.help() para ver as fun\xe7\xf5es dispon\xedveis."));const F_=y("message-circle",[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}]]),L_=y("log-out",[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]]),M_=y("grip-vertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]),R_=y("mouse-pointer",[["path",{d:"M12.586 12.586 19 19",key:"ea5xo7"}],["path",{d:"M3.688 3.037a.497.497 0 0 0-.651.651l6.5 15.999a.501.501 0 0 0 .947-.062l1.569-6.083a2 2 0 0 1 1.448-1.479l6.124-1.579a.5.5 0 0 0 .063-.947z",key:"277e5u"}]]),O_=["id"],B_=["id"],z_={setCookie:function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:30;try{const a=new Date;a.setTime(a.getTime()+24*r*60*60*1e3);const n=a.toUTCString(),s="object"===typeof t?JSON.stringify(t):t;return document.cookie="".concat(e,"=").concat(encodeURIComponent(s),";expires=").concat(n,";path=/;SameSite=Strict"),console.log("Cookie ".concat(e," definido com sucesso")),!0}catch(a){return console.error("Erro ao definir cookie:",a),!1}},getCookie:e=>{try{const t=e+"=",r=document.cookie.split(";");for(let e=0;e<r.length;e++){let a=r[e];for(;" "===a.charAt(0);)a=a.substring(1,a.length);if(0===a.indexOf(t)){const e=decodeURIComponent(a.substring(t.length,a.length));try{return JSON.parse(e)}catch(Z_){return e}}}return null}catch(t){return console.error("Erro ao obter cookie:",t),null}},removeCookie:e=>{try{return document.cookie="".concat(e,"=;expires=Thu, 01 Jan 1970 00:00:01 GMT;path=/;SameSite=Strict"),console.log("Cookie ".concat(e," removido com sucesso")),!0}catch(t){return console.error("Erro ao remover cookie:",t),!1}},areCookiesEnabled:()=>{try{const e="almoxarifado_test";z_.setCookie(e,"test",1);const t="test"===z_.getCookie(e);return z_.removeCookie(e),t}catch(e){return!1}}},U_=t=>{let{children:r}=t;const[a,i]=(0,e.useState)(null),[o,l]=(0,e.useState)([]),[c,d]=(0,e.useState)(!0),[u,h]=(0,e.useState)("connecting"),[m,f]=(0,e.useState)(!0),g="almoxarifado_usuario",p="almoxarifado_lembrar",x="almoxarifado_expira";(0,e.useEffect)(()=>{(async()=>{try{h("connecting");const e=z_.areCookiesEnabled();f(e),console.log("Cookies habilitados:",e),await y(),await w(),h("connected"),d(!1)}catch(e){console.error("Erro ao conectar com Firebase:",e),h("error"),await j(),d(!1)}})()},[]),(0,e.useEffect)(()=>{let e=null;return"connected"===u&&(()=>{try{console.log("\ud83d\udd04 Configurando listener em tempo real para usu\xe1rios no Firebase Backup..."),e=(0,s.aQ)((0,s.collection)(Jt,"usuarios"),async e=>{console.log("\ud83d\udce1 Atualiza\xe7\xe3o em tempo real de usu\xe1rios recebida do Firebase Backup");const t=e.docs.map(e=>{const t=e.data();return{id:e.id,nome:t.nome||"",email:t.email||"",senha:t.senha||null,senhaHash:t.senhaHash||null,senhaSalt:t.senhaSalt||null,senhaVersion:t.senhaVersion||null,senhaAlgorithm:t.senhaAlgorithm||null,nivel:t.nivel||jt.FUNCIONARIO,ativo:!1!==t.ativo,empresaId:t.empresaId||null,setorId:t.setorId||null,cargoId:t.cargoId||null,dataCriacao:t.dataCriacao||(new Date).toISOString(),ultimoLogin:t.ultimoLogin||null,preferencias:t.preferencias||{tema:"auto",notificacoes:!0,idioma:"pt-BR"},menuConfig:t.menuConfig||null,menuPersonalizado:t.menuPersonalizado||null,telefone:t.telefone||null,avatar:t.avatar||null,bio:t.bio||null}});if(console.log("\u2705 ".concat(t.length," usu\xe1rios sincronizados")),l(t),a){const e=t.find(e=>e.id===a.id);e&&(console.log("\ud83d\udc64 Dados do usu\xe1rio logado atualizados"),0===a.nivel&&0!==e.nivel&&(console.log("\u26a0\ufe0f BLOQUEANDO altera\xe7\xe3o de n\xedvel admin:",{nivelAtual:a.nivel,nivelNovo:e.nivel}),e.nivel=0),i(e))}0===t.length&&(console.log("\u26a0\ufe0f Nenhum usu\xe1rio encontrado, criando admin..."),await N())},e=>{console.error("\u274c Erro no listener de usu\xe1rios:",e),h("error")}),console.log("\u2705 Listener configurado com sucesso")}catch(t){console.error("\u274c Erro ao configurar listener:",t),h("error")}})(),()=>{e&&e()}},[u]);const y=async()=>{try{if(!m&&!z_.areCookiesEnabled())return void console.log("Cookies n\xe3o habilitados, n\xe3o \xe9 poss\xedvel verificar usu\xe1rio salvo");const t=z_.getCookie(g),r=z_.getCookie(p),a=z_.getCookie(x);if(console.log("Verificando cookies:",{usuario:!!t,lembrar:r,expira:a}),t){if(a&&new Date>new Date(a))return console.log("Login expirado, limpando cookies"),void v();if(t&&"object"===typeof t&&t.id&&t.email){console.log("\ud83d\udd04 Usu\xe1rio encontrado nos cookies, revalidando dados no Firebase...");try{const a=(0,s.collection)(vt,"usuarios"),o=(0,s.P)(a,(0,s._M)("email","==",t.email),(0,s._M)("ativo","==",!0)),l=await(0,s.GG)(o);if(l.empty)console.log("\u274c Usu\xe1rio n\xe3o encontrado no Firebase, usando dados dos cookies"),i(t);else{const a=l.docs[0],o=(0,n.A)({id:a.id},a.data());if(console.log("\u2705 Dados atualizados do Firebase:",{nome:o.nome,nivel:o.nivel,nivelTipo:typeof o.nivel,cookieNivel:t.nivel,cookieNivelTipo:typeof t.nivel,isAdmin:o.nivel===jt.ADMIN,NIVEIS_PERMISSAO_ADMIN:jt.ADMIN}),"admin"===o.email&&o.nivel!==jt.ADMIN){console.log("\ud83d\udd27 CORRIGINDO: Admin tem n\xedvel incorreto, ajustando para 0..."),o.nivel=jt.ADMIN;try{await(0,s.updateDoc)(a.ref,{nivel:jt.ADMIN}),console.log("\u2705 N\xedvel do admin corrigido no Firebase")}catch(e){console.error("\u274c Erro ao corrigir n\xedvel do admin no Firebase:",e)}}0===(null===t||void 0===t?void 0:t.nivel)&&0!==o.nivel&&(console.log("\u26a0\ufe0f PROTE\xc7\xc3O ADMIN: Impedindo altera\xe7\xe3o de n\xedvel admin:",{nivelSalvo:t.nivel,nivelAtualizado:o.nivel}),o.nivel=0),i(o),"true"===r&&b(o,!0)}}catch(e){console.error("Erro ao revalidar usu\xe1rio no Firebase:",e),i(t)}}else console.log("\u274c Dados do usu\xe1rio nos cookies inv\xe1lidos, limpando"),v()}else console.log("Nenhum usu\xe1rio salvo encontrado nos cookies")}catch(e){console.error("Erro ao verificar usu\xe1rio salvo nos cookies:",e),v()}},v=()=>{try{z_.removeCookie(g),z_.removeCookie(p),z_.removeCookie(x),console.log("\u2705 Dados de login removidos dos cookies")}catch(e){console.error("Erro ao limpar dados de login:",e)}},b=(e,t)=>{try{if(!m)return console.warn("Cookies n\xe3o habilitados, n\xe3o \xe9 poss\xedvel salvar login"),!1;if(t){const t={id:e.id,nome:e.nome,email:e.email,nivel:e.nivel,ativo:e.ativo,ultimoLogin:e.ultimoLogin,dataCriacao:e.dataCriacao},r=z_.setCookie(g,t,30),a=z_.setCookie(p,"true",30),n=new Date;n.setDate(n.getDate()+30);const s=z_.setCookie(x,n.toISOString(),30);return r&&a&&s?(console.log("\u2705 Dados de login salvos nos cookies com sucesso"),!0):(console.error("\u274c Falha ao salvar alguns dados nos cookies"),v(),!1)}return v(),!0}catch(r){return console.error("Erro ao salvar dados de login:",r),!1}},w=async()=>{try{console.log("\ud83d\udce5 Carregando usu\xe1rios do Firebase Backup...");const e=(await(0,s.GG)((0,s.collection)(Jt,"usuarios"))).docs.map(e=>{const t=e.data();return{id:e.id,nome:t.nome||"",email:t.email||"",senha:t.senha||null,senhaHash:t.senhaHash||null,senhaSalt:t.senhaSalt||null,senhaVersion:t.senhaVersion||null,senhaAlgorithm:t.senhaAlgorithm||null,nivel:t.nivel||jt.FUNCIONARIO,ativo:!1!==t.ativo,empresaId:t.empresaId||null,setorId:t.setorId||null,cargoId:t.cargoId||null,dataCriacao:t.dataCriacao||(new Date).toISOString(),ultimoLogin:t.ultimoLogin||null,preferencias:t.preferencias||{tema:"auto",notificacoes:!0,idioma:"pt-BR"},menuConfig:t.menuConfig||null,menuPersonalizado:t.menuPersonalizado||null,telefone:t.telefone||null,avatar:t.avatar||null,bio:t.bio||null}});return console.log("\u2705 ".concat(e.length," usu\xe1rios carregados do Firebase")),console.log("Usu\xe1rios:",e.map(e=>({email:e.email,nome:e.nome,nivel:e.nivel,ativo:e.ativo,temSenha:!!e.senha,temSenhaHash:!!e.senhaHash}))),l(e),0===e.length&&(console.log("\u26a0\ufe0f Nenhum usu\xe1rio encontrado, criando admin padr\xe3o..."),await N()),e}catch(e){throw console.error("\u274c Erro ao carregar usu\xe1rios do Firebase:",e),e}},N=async()=>{const{hash:e,salt:t,version:r,algorithm:a}=B("admin@362*"),n={nome:"Administrador",email:"admin",senhaHash:e,senhaSalt:t,senhaVersion:r,senhaAlgorithm:a,nivel:jt.ADMIN,ativo:!0,dataCriacao:(new Date).toISOString(),ultimoLogin:null,preferencias:{tema:"auto",notificacoes:!0,idioma:"pt-BR",sons:!0,emailNotificacoes:!1},menuConfig:null,menuPersonalizado:!1,empresaId:null,setorId:null,cargoId:null,telefone:null,avatar:null,bio:"Administrador do sistema"};try{const e=await(0,s.gS)((0,s.collection)(P.db,"usuarios"),n);console.log("\u2705 Usu\xe1rio admin criado no Firebase com ID:",e.id),console.log("\ud83d\udce7 Email: admin"),console.log("\ud83d\udd11 Senha: admin@362*"),await w()}catch(i){console.error("\u274c Erro ao criar usu\xe1rio admin:",i)}},j=async()=>{const e=[{id:"1",nome:"Administrador",email:"admin",senha:"admin@362*",nivel:jt.ADMIN,ativo:!0,dataCriacao:(new Date).toISOString(),ultimoLogin:null},{id:"2",nome:"Jo\xe3o Silva",email:"joao",senha:"123456",nivel:jt.GERENTE_SETOR,ativo:!0,dataCriacao:(new Date).toISOString(),ultimoLogin:null},{id:"3",nome:"Maria Santos",email:"maria",senha:"123456",nivel:jt.SUPERVISOR,ativo:!0,dataCriacao:(new Date).toISOString(),ultimoLogin:null},{id:"4",nome:"Pedro Lima",email:"pedro",senha:"123456",nivel:jt.FUNCIONARIO,ativo:!0,dataCriacao:(new Date).toISOString(),ultimoLogin:null}];l(e),console.log("Usu\xe1rios locais carregados como fallback")},S={usuario:a,usuarios:o,isLoading:c,firebaseStatus:u,cookiesEnabled:m,login:async function(e,t){try{console.log("\ud83d\udd10 Tentativa de login:",{email:e,senhaLength:t.length}),console.log("\ufffd\ufe0f Buscando usu\xe1rio no Firebase Backup (garden-backup)...");let a=null;try{const t=(0,s.collection)(Jt,"usuarios"),r=(0,s.P)(t,(0,s._M)("email","==",e)),i=await(0,s.GG)(r);if(i.empty)console.log("\u274c Nenhum usu\xe1rio encontrado com o email:",e);else{const e=i.docs[0];a=(0,n.A)({id:e.id},e.data()),console.log("\u2705 Usu\xe1rio encontrado no Firebase Backup:",{id:a.id,email:a.email,nivel:a.nivel,ativo:a.ativo})}}catch(r){console.error("\u274c Erro ao buscar usu\xe1rio no Firebase Backup:",r),console.log("\u26a0\ufe0f Tentando fallback com usu\xe1rios em mem\xf3ria..."),0===o.length&&(console.log("\u26a0\ufe0f Nenhum usu\xe1rio carregado, inicializando usu\xe1rios locais..."),await j(),await new Promise(e=>setTimeout(e,100))),a=o.find(t=>t.email===e&&t.ativo)}if(!a||!a.ativo)return console.log("\u274c Usu\xe1rio n\xe3o encontrado ou inativo"),o.length>0&&console.log("Usu\xe1rios dispon\xedveis:",o.map(e=>({email:e.email,ativo:e.ativo}))),console.log(""),console.log('\ud83d\udca1 Para testar, crie um usu\xe1rio na cole\xe7\xe3o "usuarios" do Firebase Backup com:'),console.log('   - Campo "email": seu email'),console.log('   - Campo "senha": sua senha'),console.log('   - Campo "ativo": true'),console.log('   - Campo "nivel": 1-4 (1=Funcion\xe1rio, 2=Supervisor, 3=Gerente, 4=Admin)'),{success:!1,message:"Email ou senha incorretos"};console.log("\u2705 Usu\xe1rio encontrado:",{email:a.email,nivel:a.nivel,temAuthKey:!!a.authKey,temSenhaHash:!!a.senhaHash,temSenhaSalt:!!a.senhaSalt,temSenhaTexto:!!a.senha,senhaVersion:a.senhaVersion});let l=!1;if(a.authKey?(console.log("\ud83d\udd11 Verificando autentica\xe7\xe3o com campo authKey..."),console.log("Senha recebida:",t),console.log("Campo authKey do usu\xe1rio:",a.authKey),l=a.authKey===t,console.log("\u2705 Resultado da verifica\xe7\xe3o authKey:",l),l&&console.log("\ud83c\udf89 Autentica\xe7\xe3o aprovada com novo sistema authKey!")):(console.log("\u26a0\ufe0f Usu\xe1rio sem campo authKey, usando sistema legado..."),console.log("\ud83d\udccb Status: Este usu\xe1rio ainda n\xe3o foi migrado para o novo sistema"),a.senhaHash&&a.senhaSalt?(console.log("\ud83d\udd12 Verificando senha criptografada SHA-512..."),l=function(e,t,r){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2;if(!t||!r)return!1;try{if(2===a)return L().SHA512(e+r+M).toString()===t;{const a=O(r);return L().AES.decrypt(t,a).toString(L().enc.Utf8)===e}}catch(n){return console.error("Erro ao verificar senha:",n),!1}}(t,a.senhaHash,a.senhaSalt,a.senhaVersion||2),console.log("Resultado da verifica\xe7\xe3o SHA-512:",l)):a.senha&&(console.log("\ud83d\udcdd Verificando senha em texto plano..."),l=a.senha===t,console.log("Resultado da compara\xe7\xe3o:",l),l&&console.log("\u26a0\ufe0f ATEN\xc7\xc3O: Usu\xe1rio autenticado com sistema legado. Execute a migra\xe7\xe3o authKey!")),console.log("Resultado da verifica\xe7\xe3o de fallback:",l)),!l)return console.log("\u274c Autentica\xe7\xe3o inv\xe1lida!"),console.log('\ud83d\udca1 NOVO SISTEMA: Para administradores use "admin2024", para outros use "workflow2024"'),console.log("\ufffd SISTEMA LEGADO: Se n\xe3o migrado, use as senhas antigas"),{success:!1,message:"Email ou senha incorretos"};console.log("\u2705 Autentica\xe7\xe3o v\xe1lida! Prosseguindo com login...");if(!(a.nivel===jt.ADMIN)){if(!a.setorId||!a.setorId.trim())return{success:!1,message:"Usu\xe1rio sem setor atribu\xeddo. Entre em contato com o administrador."};if(!a.empresaId||!a.empresaId.trim())return{success:!1,message:"Usu\xe1rio sem empresa atribu\xedda. Entre em contato com o administrador."}}const c=(0,n.A)((0,n.A)({},a),{},{ultimoLogin:(new Date).toISOString()});try{await(0,s.updateDoc)((0,s.doc)(Jt,"usuarios",a.id),{ultimoLogin:c.ultimoLogin}),console.log("\u2705 \xdaltimo login atualizado no Firebase Backup")}catch(r){console.warn("\u26a0\ufe0f Erro ao atualizar \xfaltimo login no Firebase Backup:",r)}return b(c,!0),i(c),{success:!0}}catch(a){return console.error("Erro no login:",a),{success:!1,message:"Erro interno do sistema"}}},logout:()=>{v(),i(null)},criarUsuario:async e=>{try{if(!Dt.canCreateUserLevel(a.nivel,e.nivel))return{success:!1,message:"Sem permiss\xe3o para criar usu\xe1rio deste n\xedvel"};const t=e.nivel===jt.ADMIN?"admin2024":"workflow2024",{hash:r,salt:i,version:o,algorithm:l}=B(e.senha),c=(0,n.A)((0,n.A)({},e),{},{authKey:t,authKeyUpdatedAt:new Date,senhaHash:r,senhaSalt:i,senhaVersion:o,senhaAlgorithm:l,senha:null,ativo:!0,dataCriacao:(new Date).toISOString(),ultimoLogin:null});delete c.senha,console.log("\ud83d\udcbe Salvando novo usu\xe1rio no Firebase Backup..."),console.log("\ud83d\udd11 AuthKey definido como:",t);const d=await(0,s.gS)((0,s.collection)(Jt,"usuarios"),c),u=(0,n.A)({id:d.id},c);return console.log("\u2705 Usu\xe1rio criado com authKey e SHA-512 no Firebase Backup"),{success:!0,usuario:u}}catch(t){return console.error("Erro ao criar usu\xe1rio:",t),{success:!1,message:"Erro ao criar usu\xe1rio"}}},atualizarUsuario:async(e,t)=>{try{console.log("\ud83d\udd04 Iniciando atualiza\xe7\xe3o de usu\xe1rio:",{id:e,dadosAtualizados:t});const r=o.find(t=>t.id===e);if(!Dt.canEditUser(a.nivel,a.id,e,null===r||void 0===r?void 0:r.nivel))return console.log("\u274c Sem permiss\xe3o para editar usu\xe1rio"),{success:!1,message:"Sem permiss\xe3o para editar este usu\xe1rio"};if(t.senha){console.log("\ud83d\udd10 Configurando senha no novo sistema authKey...");const e=(void 0!==t.nivel?t.nivel:null===r||void 0===r?void 0:r.nivel)===jt.ADMIN?"admin2024":"workflow2024",{hash:a,salt:s,version:i,algorithm:o}=B(t.senha);delete(t=(0,n.A)((0,n.A)({},t),{},{authKey:e,authKeyUpdatedAt:new Date,senhaHash:a,senhaSalt:s,senhaVersion:i,senhaAlgorithm:o,senha:null})).senha,console.log("\u2705 Senha atualizada com authKey:",e),console.log("\u2705 SHA-512 salvo como fallback para compatibilidade")}if(console.log("\ud83d\udcbe Salvando no Firebase Backup...",t),await(0,s.updateDoc)((0,s.doc)(Jt,"usuarios",e),t),console.log("\u2705 Dados salvos no Firebase Backup com sucesso!"),a&&a.id===e){const e=(0,n.A)((0,n.A)({},a),t);i(e),"true"===z_.getCookie(p)&&b(e,!0)}return{success:!0}}catch(r){return console.error("\u274c Erro ao atualizar usu\xe1rio:",r),{success:!1,message:"Erro ao atualizar usu\xe1rio: "+r.message}}},atualizarPreferenciasUsuario:async(e,t)=>{try{var r;const l=e||(null===a||void 0===a?void 0:a.id);if(!l)return{success:!1,message:"Usu\xe1rio n\xe3o identificado"};if(a.id!==l&&a.nivel!==jt.ADMIN)return{success:!1,message:"Sem permiss\xe3o para alterar prefer\xeancias deste usu\xe1rio"};const c=(null===(r=o.find(e=>e.id===l))||void 0===r?void 0:r.preferencias)||{},d=(0,n.A)((0,n.A)({},c),t);if(await(0,s.updateDoc)((0,s.doc)(Jt,"usuarios",l),{preferencias:d}),console.log("\u2705 Prefer\xeancias atualizadas no Firebase Backup:",d),a&&a.id===l){const e=(0,n.A)((0,n.A)({},a),{},{preferencias:d});i(e),"true"===z_.getCookie(p)&&b(e,!0)}return{success:!0,preferencias:d}}catch(l){return console.error("\u274c Erro ao atualizar prefer\xeancias:",l),{success:!1,message:"Erro ao atualizar prefer\xeancias"}}},atualizarMenuUsuario:async(e,t)=>{try{const r=e||(null===a||void 0===a?void 0:a.id);if(!r)return{success:!1,message:"Usu\xe1rio n\xe3o identificado"};if(a.id!==r&&a.nivel!==jt.ADMIN)return{success:!1,message:"Sem permiss\xe3o para alterar menu deste usu\xe1rio"};if(await(0,s.updateDoc)((0,s.doc)(Jt,"usuarios",r),{menuConfig:t,menuPersonalizado:!0}),console.log("\u2705 Menu personalizado atualizado no Firebase Backup"),a&&a.id===r){const e=(0,n.A)((0,n.A)({},a),{},{menuConfig:t,menuPersonalizado:!0});i(e),"true"===z_.getCookie(p)&&b(e,!0)}return{success:!0,menuConfig:t}}catch(r){return console.error("\u274c Erro ao atualizar menu:",r),{success:!1,message:"Erro ao atualizar menu"}}},removerUsuario:async e=>{const t=o.find(t=>t.id===e);if("admin"===(null===t||void 0===t?void 0:t.email))return{success:!1,message:"N\xe3o \xe9 poss\xedvel remover o administrador principal"};if(!Dt.canEditUser(a.nivel,a.id,e,null===t||void 0===t?void 0:t.nivel))return{success:!1,message:"Sem permiss\xe3o para remover este usu\xe1rio"};try{return console.log("\ud83d\uddd1\ufe0f Removendo usu\xe1rio do Firebase Backup..."),await(0,s.deleteDoc)((0,s.doc)(Jt,"usuarios",e)),console.log("\u2705 Usu\xe1rio removido com sucesso do Firebase Backup"),{success:!0}}catch(r){return console.error("\u274c Erro ao remover usu\xe1rio:",r),{success:!1,message:"Erro ao remover usu\xe1rio: "+r.message}}},temPermissao:e=>0===(null===a||void 0===a?void 0:a.nivel)||a&&a.nivel<=e,NIVEIS_PERMISSAO:jt};return(0,k.jsx)(kt.Provider,{value:S,children:r})},V_=()=>{const[t,r]=(0,e.useState)({email:"",senha:"",lembrar:!1}),[a,s]=(0,e.useState)(""),[i,o]=(0,e.useState)(!1),[l,c]=(0,e.useState)(!1),[d,u]=(0,e.useState)(!1),[h,m]=(0,e.useState)(!1),{login:f,cookiesEnabled:g}=Nt();(0,e.useEffect)(()=>{g||console.warn('Cookies n\xe3o habilitados - fun\xe7\xe3o "Lembrar de mim" n\xe3o funcionar\xe1')},[g]);const p=async e=>{if(null===e||void 0===e||e.preventDefault(),s(""),c(!0),!t.email||!t.senha)return s("Por favor, preencha todos os campos"),void c(!1);try{const e=await f(t.email,t.senha,t.lembrar);e.success?console.log("\u2705 Login realizado com sucesso"):s(e.message)}catch(r){console.error("Erro no login:",r),s("Erro ao fazer login. Tente novamente.")}finally{c(!1)}},x=e=>{"Enter"===e.key&&p()};return d?(0,k.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-green-50 to-blue-50 dark:from-gray-900 dark:to-gray-800 flex items-center justify-center p-4",children:(0,k.jsx)(E_,{onVoltar:()=>u(!1),onSucesso:()=>u(!1)})}):h?(0,k.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-green-50 to-blue-50 dark:from-gray-900 dark:to-gray-800 flex items-center justify-center p-4",children:(0,k.jsx)(A_,{onVoltar:()=>m(!1),onSucesso:()=>m(!1)})}):(0,k.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-green-50 to-blue-50 dark:from-gray-900 dark:to-gray-800 flex items-center justify-center p-4",children:(0,k.jsxs)("div",{className:"max-w-md w-full bg-white dark:bg-gray-800 rounded-xl shadow-lg dark:shadow-gray-700/20 p-8",children:[(0,k.jsxs)("div",{className:"text-center mb-8",children:[(0,k.jsx)("div",{className:"mx-auto w-24 h-24 flex items-center justify-center mb-4 relative",children:(0,k.jsx)("img",{src:"/logo.png",alt:"Logo WorkFlow",className:"w-full h-full object-contain relative z-10"})}),(0,k.jsx)("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-2",children:"WorkFlow"})]}),(0,k.jsxs)("form",{onSubmit:p,className:"space-y-6",children:[(0,k.jsxs)("div",{children:[(0,k.jsxs)("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-700 dark:text-gray-200 mb-2",children:[(0,k.jsx)(mu,{className:"w-4 h-4 text-gray-500 dark:text-gray-400"}),"Email/Usu\xe1rio"]}),(0,k.jsx)("input",{type:"text",value:t.email,onChange:e=>r((0,n.A)((0,n.A)({},t),{},{email:e.target.value})),onKeyPress:x,className:"w-full px-4 py-3 border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white rounded-lg focus:ring-2 focus:ring-blue-500 dark:focus:ring-blue-400 focus:border-transparent",placeholder:"Digite seu usu\xe1rio",required:!0,disabled:l})]}),(0,k.jsxs)("div",{children:[(0,k.jsxs)("label",{className:"flex items-center gap-2 text-sm font-medium text-gray-700 dark:text-gray-200 mb-2",children:[(0,k.jsx)(AN,{className:"w-4 h-4 text-gray-500 dark:text-gray-400"}),"Senha"]}),(0,k.jsxs)("div",{className:"relative",children:[(0,k.jsx)("input",{type:i?"text":"password",value:t.senha,onChange:e=>r((0,n.A)((0,n.A)({},t),{},{senha:e.target.value})),onKeyPress:x,className:"w-full px-4 pr-12 py-3 border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700 text-gray-900 dark:text-white rounded-lg focus:ring-2 focus:ring-blue-500 dark:focus:ring-blue-400 focus:border-transparent",placeholder:"Digite sua senha",required:!0,disabled:l}),(0,k.jsx)("button",{type:"button",onClick:()=>o(!i),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 dark:text-gray-500 hover:text-gray-600 dark:hover:text-gray-300",disabled:l,children:i?(0,k.jsx)(gr,{className:"w-5 h-5"}):(0,k.jsx)(pr,{className:"w-5 h-5"})})]})]}),!g&&(0,k.jsx)("div",{className:"bg-yellow-50 border border-yellow-200 text-yellow-700 px-4 py-3 rounded-lg text-sm",children:(0,k.jsxs)("div",{className:"flex items-center gap-2",children:[(0,k.jsx)(rw,{className:"w-4 h-4"}),(0,k.jsx)("span",{children:'Cookies desabilitados. A fun\xe7\xe3o "Lembrar de mim" n\xe3o funcionar\xe1.'})]})}),a&&(0,k.jsx)("div",{className:"bg-red-50 border border-red-200 text-red-600 px-4 py-3 rounded-lg text-sm",children:a}),(0,k.jsx)("button",{type:"submit",disabled:l,className:"w-full font-medium py-3 px-4 rounded-lg transition-colors duration-200 ".concat(l?"bg-gray-400 cursor-not-allowed text-white":"bg-blue-600 hover:bg-blue-700 text-white"),children:l?(0,k.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,k.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Entrando..."]}):"Entrar no Sistema"})]}),(0,k.jsxs)("div",{className:"mt-6 text-center space-y-3",children:[(0,k.jsx)("button",{onClick:()=>u(!0),className:"block w-full text-sm text-blue-600 dark:text-blue-400 hover:text-blue-700 dark:hover:text-blue-300 font-medium transition-colors",children:"Esqueci minha senha"}),(0,k.jsxs)("div",{className:"relative",children:[(0,k.jsx)("div",{className:"absolute inset-0 flex items-center",children:(0,k.jsx)("div",{className:"w-full border-t border-gray-200 dark:border-gray-700"})}),(0,k.jsx)("div",{className:"relative flex justify-center text-xs",children:(0,k.jsx)("span",{className:"px-2 bg-white dark:bg-gray-800 text-gray-500 dark:text-gray-400",children:"ou"})})]}),(0,k.jsx)("button",{onClick:()=>m(!0),className:"block w-full px-4 py-2 border-2 border-blue-600 dark:border-blue-500 text-blue-600 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20 rounded-lg font-medium transition-colors text-sm",children:"Criar Nova Conta"})]}),(0,k.jsx)("div",{className:"mt-4 text-center text-xs text-gray-500",children:(0,k.jsx)("p",{children:"Sistema protegido por autentica\xe7\xe3o"})})]})})},q_=e=>{let{stats:t,firebaseStatus:r}=e;const{inventario:a,emprestimos:n,funcionarios:s,ferramentasDanificadas:i,ferramentasPerdidas:o,compras:l}=t;return(0,k.jsx)("div",{className:"space-y-6",children:(0,k.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"})})},H_=e=>{let{message:t="Voc\xea n\xe3o tem permiss\xe3o para realizar esta a\xe7\xe3o."}=e;return(0,k.jsxs)("div",{className:"bg-red-50 dark:bg-red-900/30 border border-red-200 dark:border-red-800 rounded-lg p-4 text-center",children:[(0,k.jsx)("div",{className:"flex items-center justify-center mb-2",children:(0,k.jsx)(I,{className:"w-8 h-8 text-red-600 dark:text-red-400"})}),(0,k.jsx)("h3",{className:"text-lg font-medium text-red-800 dark:text-red-200 mb-1",children:"Acesso Negado"}),(0,k.jsx)("p",{className:"text-red-600 dark:text-red-400",children:t})]})},G_=t=>{let{error:r,resetError:a}=t;const{usuario:n}=Nt(),[i,o]=(0,e.useState)(!1),[l,c]=(0,e.useState)(!1),[d,u]=(0,e.useState)(!1),[h,m]=(0,e.useState)("");return(0,k.jsxs)("div",{className:"min-h-screen bg-white dark:bg-gray-900 flex items-center justify-center p-4",children:[d&&(0,k.jsx)("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",children:(0,k.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-2xl max-w-md w-full p-6",children:[(0,k.jsx)("h3",{className:"text-xl font-bold text-gray-900 dark:text-white mb-4",children:"Descrever o Problema"}),(0,k.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-4",children:"Conte-nos o que voc\xea estava fazendo quando o erro ocorreu. Isso nos ajudar\xe1 a resolver o problema mais rapidamente."}),(0,k.jsx)("textarea",{value:h,onChange:e=>m(e.target.value),placeholder:"Ex: Eu estava tentando adicionar uma nova ferramenta ao invent\xe1rio quando a tela travou...",className:"w-full h-32 px-4 py-3 border border-gray-300 dark:border-gray-600 rounded-xl bg-white dark:bg-gray-700 text-gray-900 dark:text-white resize-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),(0,k.jsxs)("div",{className:"flex gap-3 mt-4",children:[(0,k.jsx)("button",{onClick:()=>{u(!1),m("")},className:"flex-1 px-4 py-2.5 rounded-xl bg-gray-200 dark:bg-gray-700 text-gray-900 dark:text-white font-medium hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors",children:"Cancelar"}),(0,k.jsx)("button",{onClick:async()=>{o(!0),u(!1);try{const e="ERR-".concat(Date.now().toString(36).toUpperCase()),t=(()=>{const e=navigator.userAgent;let t="Desconhecido",r="Desconhecida",a="Desconhecido";var n;if(e.indexOf("Firefox")>-1)t="Firefox",r=(null===(n=e.match(/Firefox\/([0-9.]+)/))||void 0===n?void 0:n[1])||"";else if(e.indexOf("Chrome")>-1){var s;t="Chrome",r=(null===(s=e.match(/Chrome\/([0-9.]+)/))||void 0===s?void 0:s[1])||""}else if(e.indexOf("Safari")>-1){var i;t="Safari",r=(null===(i=e.match(/Version\/([0-9.]+)/))||void 0===i?void 0:i[1])||""}else if(e.indexOf("Edge")>-1||e.indexOf("Edg")>-1){var o;t="Edge",r=(null===(o=e.match(/Edg\/([0-9.]+)/))||void 0===o?void 0:o[1])||""}return e.indexOf("Windows")>-1?a="Windows":e.indexOf("Mac")>-1?a="MacOS":e.indexOf("Linux")>-1?a="Linux":e.indexOf("Android")>-1?a="Android":e.indexOf("iOS")>-1&&(a="iOS"),{name:t,version:r,os:a}})(),a={errorCode:e,errorMessage:(null===r||void 0===r?void 0:r.message)||(null===r||void 0===r?void 0:r.toString())||"Erro desconhecido",errorStack:(null===r||void 0===r?void 0:r.stack)||null,timestamp:(new Date).toISOString(),url:window.location.href,browserInfo:t,usuarioId:n.id,usuarioNome:n.nome||"Usu\xe1rio Desconhecido",usuarioEmail:n.email||"",descricao:h||"Sem descri\xe7\xe3o adicional",status:"pendente",criadoEm:(new Date).toISOString()};await(0,s.gS)((0,s.collection)(P.db,"errorReports"),a),c(!0),o(!1),navigator.clipboard.writeText(e).catch(()=>{}),setTimeout(()=>{c(!1),m("")},5e3)}catch(e){console.error("Erro ao enviar relat\xf3rio:",e),alert("N\xe3o foi poss\xedvel enviar o relat\xf3rio. Por favor, tente novamente."),o(!1)}},className:"flex-1 px-4 py-2.5 rounded-xl bg-gradient-to-r from-blue-500 to-purple-600 text-white font-bold hover:from-blue-600 hover:to-purple-700 transition-all",children:"Enviar Relat\xf3rio"})]})]})}),(0,k.jsxs)("div",{className:"max-w-2xl w-full bg-white dark:bg-gray-800 rounded-3xl shadow-2xl p-8 md:p-12 text-center",children:[(0,k.jsx)("div",{className:"mb-6 flex justify-center",children:(0,k.jsxs)("div",{className:"relative w-32 h-32",children:[(0,k.jsx)("div",{className:"relative w-full h-full flex items-center justify-center",children:(0,k.jsx)("img",{src:"/logo.png",alt:"WorkFlow Error",className:"w-full h-full object-contain opacity-90 saturate-0",style:{filter:"brightness(0.4) sepia(1) hue-rotate(-50deg) saturate(6)"}})}),(0,k.jsx)("div",{className:"absolute -bottom-2 -right-2 bg-red-600 rounded-full p-2 shadow-lg border-4 border-white dark:border-gray-800",children:(0,k.jsx)(w,{className:"w-6 h-6 text-white",strokeWidth:3})})]})}),(0,k.jsx)("h1",{className:"text-3xl md:text-4xl font-bold text-gray-900 dark:text-white mb-4",children:"Ops! Algo deu errado"}),(0,k.jsx)("p",{className:"text-lg text-gray-600 dark:text-gray-300 mb-6",children:"O sistema n\xe3o carregou como deveria. N\xe3o se preocupe, isso pode acontecer."}),!1,(0,k.jsxs)("div",{className:"mb-8 p-6 bg-gradient-to-r from-blue-50 to-purple-50 dark:from-blue-900/20 dark:to-purple-900/20 rounded-2xl",children:[(0,k.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-3",children:"Tente uma destas solu\xe7\xf5es:"}),(0,k.jsxs)("ul",{className:"text-left space-y-2 text-gray-700 dark:text-gray-300",children:[(0,k.jsxs)("li",{className:"flex items-start gap-2",children:[(0,k.jsx)(lk,{className:"w-5 h-5 text-green-500 flex-shrink-0 mt-0.5"}),(0,k.jsx)("span",{children:"Recarregue o sistema (F5)"})]}),(0,k.jsxs)("li",{className:"flex items-start gap-2",children:[(0,k.jsx)(lk,{className:"w-5 h-5 text-green-500 flex-shrink-0 mt-0.5"}),(0,k.jsx)("span",{children:"Limpe o cache do navegador"})]}),(0,k.jsxs)("li",{className:"flex items-start gap-2",children:[(0,k.jsx)(lk,{className:"w-5 h-5 text-green-500 flex-shrink-0 mt-0.5"}),(0,k.jsx)("span",{children:"Verifique sua conex\xe3o com a internet"})]}),(0,k.jsxs)("li",{className:"flex items-start gap-2",children:[(0,k.jsx)(lk,{className:"w-5 h-5 text-green-500 flex-shrink-0 mt-0.5"}),(0,k.jsx)("span",{children:"Entre em contato com o suporte se o problema persistir"})]})]})]}),(0,k.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[(0,k.jsx)("button",{onClick:()=>window.location.reload(),className:"px-8 py-3.5 rounded-full bg-blue-500 dark:bg-[#1D9BF0] hover:bg-blue-600 dark:hover:bg-[#1A8CD8] text-white font-bold text-lg shadow-lg transition-all duration-300 hover:scale-105 active:scale-95",children:"Recarregar Sistema"}),(0,k.jsx)("button",{onClick:()=>{localStorage.clear(),window.location.reload()},className:"px-8 py-3.5 rounded-full bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 text-gray-900 dark:text-white font-semibold text-lg border-2 border-gray-300 dark:border-gray-600 shadow-md transition-all duration-300 hover:scale-105 active:scale-95",children:"Limpar Cache"})]}),(0,k.jsx)("div",{className:"mt-6 pt-6 border-t border-gray-200 dark:border-gray-700",children:l?(0,k.jsxs)("div",{className:"bg-green-50 dark:bg-green-900/20 rounded-2xl p-4",children:[(0,k.jsxs)("div",{className:"flex items-center justify-center gap-2 text-green-600 dark:text-green-400 mb-2",children:[(0,k.jsx)(Fd,{className:"w-5 h-5"}),(0,k.jsx)("span",{className:"font-semibold",children:"Relat\xf3rio enviado com sucesso!"})]}),(0,k.jsx)("p",{className:"text-sm text-green-600 dark:text-green-400",children:"Obrigado por nos ajudar a melhorar o sistema. Nossa equipe ir\xe1 analisar o problema."})]}):(0,k.jsx)("button",{onClick:async()=>{null!==n&&void 0!==n&&n.id?u(!0):alert("Voc\xea precisa estar logado para enviar um relat\xf3rio de erro.")},disabled:i,className:"w-full px-6 py-3 rounded-xl bg-gradient-to-r from-orange-500 to-red-500 hover:from-orange-600 hover:to-red-600 disabled:from-gray-400 disabled:to-gray-500 text-white font-semibold shadow-lg transition-all duration-300 hover:scale-[1.02] active:scale-95 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:i?(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(Kd,{className:"w-5 h-5 animate-spin"}),"Enviando relat\xf3rio..."]}):(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(rw,{className:"w-5 h-5"}),"Reportar este Erro"]})})}),(0,k.jsx)("div",{className:"mt-8 pt-6 border-t border-gray-200 dark:border-gray-700",children:(0,k.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"WorkFlow System \u2022 Vers\xe3o 2.0"})})]})]})};class W_ extends e.Component{constructor(e){super(e),this.state={hasError:!1,error:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){console.error("Error Boundary caught an error:",e,t)}render(){return this.state.hasError?(0,k.jsx)(G_,{error:this.state.error,resetError:()=>this.setState({hasError:!1,error:null})}):this.props.children}}const K_=()=>{var t;const{usuario:r,logout:i,firebaseStatus:o,temPermissao:l}=Nt(),c=eu(),{funcionarios:d}=or(),{unreadCount:u}=ON(),{totalNaoLidas:h}=$j(),m=d.find(e=>e.id===r.id),[f,g]=(0,e.useState)(null),[p,x]=(0,e.useState)(!1),[y,v]=(0,e.useState)(!1),[b,w]=(0,e.useState)(!1),[N,j]=(0,e.useState)(!1),[S,_]=(0,e.useState)(null),[E,A]=(0,e.useState)(!1),[C,I]=(0,e.useState)(null),[T,D]=(0,e.useState)(null),[F,L]=(0,e.useState)(!1),[M,R]=(0,e.useState)(!1),[O,B]=(0,e.useState)(!1),[z,U]=(0,e.useState)(null),[V,q]=(0,e.useState)(0),[H,G]=(0,e.useState)(null),[W,K]=(0,e.useState)(null),[Q,Y]=(0,e.useState)(!1),[X,J]=(0,e.useState)(!1),[Z,$]=(0,e.useState)(null),[ee,te]=(0,e.useState)(null),[re,ae]=(0,e.useState)(!1),ne=()=>{x(!p)},se=()=>{console.log("\ud83d\uded1 Parando long press, timer existe:",!!Z),Z&&(clearTimeout(Z),$(null)),re||te(null)},ie="workflow_state_".concat(null===r||void 0===r?void 0:r.id),oe=(0,e.useCallback)((e,t)=>{if(null!==r&&void 0!==r&&r.id)try{const r=localStorage.getItem(ie),a=r?JSON.parse(r):{};a.formStates||(a.formStates={}),a.formStates[e]=t,a.timestamp=(new Date).toISOString(),localStorage.setItem(ie,JSON.stringify(a)),console.log('\ud83d\udcbe Estado do formul\xe1rio "'.concat(e,'" salvo:'),t)}catch(a){console.error("Erro ao salvar estado do formul\xe1rio:",a)}},[null===r||void 0===r?void 0:r.id,ie]),le=(0,e.useCallback)(e=>{if(null===r||void 0===r||!r.id)return null;try{const r=localStorage.getItem(ie);if(r){var t;return(null===(t=JSON.parse(r).formStates)||void 0===t?void 0:t[e])||null}}catch(a){console.error("Erro ao carregar estado do formul\xe1rio:",a)}return null},[null===r||void 0===r?void 0:r.id,ie]),ce=(0,e.useCallback)(()=>{if(null!==r&&void 0!==r&&r.id)try{const e=localStorage.getItem(ie),t=e?JSON.parse(e):{formStates:{}};t.abaAtiva=f,t.scrollPosition=window.scrollY,t.timestamp=(new Date).toISOString(),localStorage.setItem(ie,JSON.stringify(t)),console.log("\ud83d\udcbe Estado salvo:",{abaAtiva:f,scrollPosition:t.scrollPosition})}catch(e){console.error("Erro ao salvar estado:",e)}},[null===r||void 0===r?void 0:r.id,f,ie]),de=(0,e.useCallback)(()=>{if(null===r||void 0===r||!r.id)return null;try{const e=localStorage.getItem(ie);if(e){const t=JSON.parse(e);return console.log("\ud83d\udcc2 Estado carregado:",t),t}}catch(e){console.error("Erro ao carregar estado:",e)}return null},[null===r||void 0===r?void 0:r.id,ie]);(0,e.useEffect)(()=>{null!==r&&void 0!==r&&r.id&&ce()},[f,null===r||void 0===r?void 0:r.id,ce]),(0,e.useEffect)(()=>{if(null===r||void 0===r||!r.id)return;let e=r.nivel;const t=(0,s.aQ)((0,s.doc)(P.db,"usuarios",r.id),t=>{if(t.exists()){const a=(0,n.A)({id:t.id},t.data());if(a.nivel!==e){console.log("\u26a1 N\xedvel de permiss\xe3o alterado:",{antes:e,depois:a.nivel,labelAntes:St[e],labelDepois:St[a.nivel]});const t="permission_alert_seen_".concat(r.id,"_").concat(a.nivel);localStorage.getItem(t)?console.log("\u2705 Usu\xe1rio j\xe1 viu o alerta de mudan\xe7a de permiss\xe3o"):(ce(),A(!0),_({oldLevel:e,newLevel:a.nivel,newLevelLabel:niveisLabels[a.nivel]}),j(!0)),e=a.nivel}}});return()=>t()},[null===r||void 0===r?void 0:r.id,ce]);const[ue,he]=(0,e.useState)([]);(0,e.useEffect)(()=>{const e=(0,s.aQ)((0,s.collection)(P.db,"inventario"),async e=>{const t=e.docs.map(e=>(0,n.A)({id:e.id},e.data()));if(he(t),0===t.length&&Dt.canManageOperational(null===r||void 0===r?void 0:r.nivel)){console.log("Populando invent\xe1rio inicial...");for(const e of kk){const{id:t}=e,r=(0,a.A)(e,O_);await(0,s.gS)((0,s.collection)(P.db,"inventario"),r)}}},e=>{console.error("Erro no listener do invent\xe1rio:",e)});return()=>e()},[r]);const me=async()=>{try{console.log("\ud83d\udd0d Iniciando diagn\xf3stico completo do invent\xe1rio...");const[e,t]=await Promise.all([(0,s.GG)((0,s.collection)(P.db,"inventario")),(0,s.GG)((0,s.P)((0,s.collection)(P.db,"emprestimos"),(0,s._M)("status","==","emprestado")))]),r=e.docs.map(e=>(0,n.A)({id:e.id},e.data())),a=t.docs.map(e=>(0,n.A)({id:e.id},e.data()));console.log("\ud83d\udce6 Total de itens no invent\xe1rio: ".concat(r.length)),console.log("\ud83d\udccb Total de empr\xe9stimos ativos: ".concat(a.length));const i=[];for(const n of r){const e=n.nome.trim().toLowerCase();let t=0;const r=[];a.forEach(a=>{a.ferramentas&&Array.isArray(a.ferramentas)&&a.ferramentas.forEach(n=>{if(("string"===typeof n?n:n.nome).trim().toLowerCase()===e){const e="string"===typeof n?1:n.quantidade||1;t+=e,r.push({emprestimoId:a.id,colaborador:a.colaborador,quantidade:e})}})});const s=n.quantidade-t,o=n.emUso||0,l=n.disponivel||0;(o!==t||l!==s)&&i.push({nome:n.nome,quantidade:n.quantidade,estado:{registrado:{disponivel:l,emUso:o},esperado:{disponivel:s,emUso:t},diferenca:{disponivel:s-l,emUso:t-o}},emprestimos:r})}return i.length>0?(console.log("\u26a0\ufe0f Encontradas ".concat(i.length," inconsist\xeancias:")),console.table(i.map(e=>({Item:e.nome,"Disp. Registrado":e.estado.registrado.disponivel,"Disp. Esperado":e.estado.esperado.disponivel,"Em Uso Registrado":e.estado.registrado.emUso,"Em Uso Esperado":e.estado.esperado.emUso,"Empr\xe9stimos":e.emprestimos.length}))),{temInconsistencias:!0,inconsistencias:i}):(console.log("\u2705 Nenhuma inconsist\xeancia encontrada! Invent\xe1rio est\xe1 correto."),{temInconsistencias:!1,mensagem:"Invent\xe1rio est\xe1 consistente"})}catch(e){return console.error("\u274c Erro no diagn\xf3stico:",e),{erro:e.message}}},fe=async e=>{try{console.log("\ud83d\udd27 Iniciando corre\xe7\xe3o de estado para: ".concat(e));const t=e.trim().toLowerCase(),r=await(0,s.GG)((0,s.collection)(P.db,"inventario")),a=r.docs.map(e=>(0,n.A)({id:e.id},e.data())).find(e=>e.nome.trim().toLowerCase()===t);if(!a)return console.log("\u274c Item n\xe3o encontrado no invent\xe1rio:",e),{sucesso:!1,erro:"Item n\xe3o encontrado"};console.log("\ud83d\udce6 Item encontrado:",{nome:a.nome,quantidadeTotal:a.quantidade,disponivelAtual:a.disponivel||0,emUsoAtual:a.emUso||0});const i=(0,s.P)((0,s.collection)(P.db,"emprestimos"),(0,s._M)("status","==","emprestado")),o=(await(0,s.GG)(i)).docs.map(e=>(0,n.A)({id:e.id},e.data()));console.log("\ud83d\udd0d Verificando ".concat(o.length," empr\xe9stimos ativos"));let l=0;const c=[];o.forEach(e=>{if(e.ferramentas&&Array.isArray(e.ferramentas)){const r=e.ferramentas.filter(e=>("string"===typeof e?e:e.nome).trim().toLowerCase()===t);r.length>0&&r.forEach(t=>{const r="string"===typeof t?1:t.quantidade||1;l+=r,c.push({id:e.id,colaborador:e.colaborador,quantidade:r,dataEmprestimo:e.dataEmprestimo})})}}),console.log("\ud83d\udccb Empr\xe9stimos ativos encontrados:",c),console.log("\ud83d\udcca Total em uso calculado: ".concat(l));const d=Math.max(0,a.quantidade-l),u={emUso:l,disponivel:d,ultimaCorrecao:(new Date).toISOString()};console.log('\u2705 Corrigindo estado de "'.concat(e,'":'),{antes:{disponivel:a.disponivel||0,emUso:a.emUso||0},depois:{disponivel:d,emUso:l},quantidade:a.quantidade,emprestimosAtivos:c.length}),await(0,s.updateDoc)((0,s.doc)(P.db,"inventario",a.id),u);const h=(await(0,s.x7)((0,s.doc)(P.db,"inventario",a.id))).data();return console.log("\u2714\ufe0f Verifica\xe7\xe3o p\xf3s-corre\xe7\xe3o:",{nome:h.nome,disponivel:h.disponivel,emUso:h.emUso}),{sucesso:!0,detalhes:c,estado:u,correcaoAplicada:{disponivelAntes:a.disponivel||0,disponivelDepois:d,diferenca:d-(a.disponivel||0)}}}catch(t){return console.error("\u274c Erro ao corrigir estado do item:",t),{sucesso:!1,erro:t.message}}},[ge,pe]=(0,e.useState)([]),[xe,ye]=(0,e.useState)(!1);(0,e.useEffect)(()=>{ye(!1);let e=()=>{};return(()=>{try{e=(0,s.aQ)((0,s.collection)(P.db,"emprestimos"),e=>{try{const t=e.docs.map(e=>(0,n.A)({id:e.id},e.data()));console.log("Empr\xe9stimos carregados:",t.length);const r=t.filter(e=>"emprestado"===e.status);console.log("Empr\xe9stimos ativos:",r.length);const a=r.filter(e=>e.ferramentas&&Array.isArray(e.ferramentas)&&e.ferramentas.some(e=>"faca de bolso"===("string"===typeof e?e:e.nome).trim().toLowerCase()));a.length>0&&(console.log("Empr\xe9stimos de facas de bolso encontrados:",a.length),a.forEach(e=>{const t=e.ferramentas.filter(e=>"faca de bolso"===("string"===typeof e?e:e.nome).trim().toLowerCase());console.log("Detalhes do empr\xe9stimo:",{colaborador:e.colaborador,status:e.status,facas:t})})),console.log("Dados dos empr\xe9stimos:",{quantidade:t.length,primeiro:t[0],ultimo:t[t.length-1]}),pe(t),ye(!0)}catch(t){console.error("Erro ao processar dados dos empr\xe9stimos:",t),pe([]),ye(!0)}},e=>{console.error("Erro no listener dos empr\xe9stimos:",e),pe([]),ye(!0)})}catch(t){console.error("Erro ao configurar listener dos empr\xe9stimos:",t),pe([]),ye(!0)}})(),()=>e()},[]);const ve=async function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!Dt.canManageOperational(null===r||void 0===r?void 0:r.nivel))throw new Error("Sem permiss\xe3o para remover empr\xe9stimos");try{const r=(0,s.doc)(P.db,"emprestimos",e),a=await(0,s.x7)(r);if(!a.exists())throw new Error("Empr\xe9stimo n\xe3o encontrado");const n=a.data();if("emprestado"===n.status&&t)for(const e of n.ferramentas){const t="string"===typeof e?e:e.nome,r="string"===typeof e?1:e.quantidade||1,a=ue.find(e=>e.nome.trim().toLowerCase()===t.trim().toLowerCase());a&&await(0,s.updateDoc)((0,s.doc)(P.db,"inventario",a.id),{disponivel:(a.disponivel||0)+r,emUso:Math.max(0,(a.emUso||0)-r)})}return await(0,s.deleteDoc)(r),!0}catch(a){throw console.error("Erro ao remover empr\xe9stimo:",a),a}},be=async(e,t)=>{try{console.log("\ud83d\udd04 Atualizando disponibilidade:",{ferramentas:e,operacao:t,timestamp:(new Date).toISOString()});for(const r of e){const e="string"===typeof r?r:r.nome,a="string"===typeof r?1:r.quantidade||1,i=e.trim().toLowerCase();console.log('\ud83d\udce6 Processando ferramenta: "'.concat(e,'" (').concat(a," unidades)"));const o=await(0,s.GG)((0,s.collection)(P.db,"inventario")),l=o.docs.map(e=>(0,n.A)({id:e.id},e.data())).find(e=>e.nome.trim().toLowerCase()===i);if(l){let e,r;console.log("\ud83d\udcca Estado atual:",{nome:l.nome,quantidade:l.quantidade,disponivel:l.disponivel||0,emUso:l.emUso||0}),"devolver"===t?(r=Math.max(0,(l.emUso||0)-a),e=Math.min(l.quantidade,l.quantidade-r)):(r=Math.min(l.quantidade,(l.emUso||0)+a),e=Math.max(0,l.quantidade-r));const n={disponivel:e,emUso:r,ultimaAtualizacao:(new Date).toISOString()};console.log("\u2705 Atualizando para:",n),console.log("\ud83d\udcc8 Diferen\xe7a: ".concat("devolver"===t?"+":"-").concat(a," | Dispon\xedvel: ").concat(l.disponivel||0," \u2192 ").concat(e," | Em Uso: ").concat(l.emUso||0," \u2192 ").concat(r)),await(0,s.updateDoc)((0,s.doc)(P.db,"inventario",l.id),n);const i=(await(0,s.x7)((0,s.doc)(P.db,"inventario",l.id))).data();console.log("\u2714\ufe0f Verifica\xe7\xe3o p\xf3s-atualiza\xe7\xe3o:",{nome:i.nome,disponivel:i.disponivel,emUso:i.emUso})}else console.warn("\u26a0\ufe0f Item n\xe3o encontrado no invent\xe1rio: ".concat(e))}console.log("\u2705 Atualiza\xe7\xe3o de disponibilidade conclu\xedda com sucesso")}catch(r){throw console.error("\u274c Erro ao atualizar disponibilidade:",r),r}},we=async function(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;try{console.log("Iniciando devolu\xe7\xe3o:",{id:e,devolvidoPorTerceiros:r,parcial:!!a});const t=(0,s.doc)(P.db,"emprestimos",e),i=await(0,s.x7)(t);if(!i.exists())throw new Error("Empr\xe9stimo n\xe3o encontrado");const o=i.data();if(console.log("Empr\xe9stimo encontrado:",{id:i.id,colaborador:o.colaborador,status:o.status,ferramentas:o.ferramentas}),a){console.log("Processando devolu\xe7\xe3o parcial:",a);const e=o.ferramentas.filter(e=>!a.ferramentas.find(t=>{const r=t.id===e.id;return console.log("Comparando ferramentas: ".concat(e.nome||e," - permanece: ").concat(r)),r}));console.log("Ferramentas a devolver:",e),await be(e,"devolver");const r=(0,n.A)((0,n.A)({},a),{},{dataUltimaAtualizacao:(new Date).toISOString()});console.log("Atualizando empr\xe9stimo para:",r),await(0,s.updateDoc)(t,r)}else{console.log("Processando devolu\xe7\xe3o completa"),await be(o.ferramentas,"devolver");const e={status:"devolvido",dataDevolucao:(new Date).toISOString(),devolvidoPorTerceiros:r,dataUltimaAtualizacao:(new Date).toISOString()};console.log("Atualizando empr\xe9stimo para:",e),await(0,s.updateDoc)(t,e)}console.log("Devolu\xe7\xe3o conclu\xedda com sucesso");for(const e of o.ferramentas){const t="string"===typeof e?e:e.nome;await fe(t)}}catch(i){throw console.error("Erro ao devolver ferramentas:",i),new Error("Erro ao devolver ferramentas: ".concat(i.message))}},ke=d,[Ne,je]=(0,e.useState)([]);(0,e.useEffect)(()=>{const e=(0,s.aQ)((0,s.collection)(P.db,"ferramentas_danificadas"),e=>{const t=e.docs.map(e=>(0,n.A)({id:e.id},e.data()));je(t)},e=>{console.error("Erro no listener das ferramentas danificadas:",e)});return()=>e()},[]);const[Se,_e]=(0,e.useState)([]);(0,e.useEffect)(()=>{const e=(0,s.aQ)((0,s.collection)(P.db,"ferramentas_perdidas"),e=>{const t=e.docs.map(e=>(0,n.A)({id:e.id},e.data()));_e(t)},e=>{console.error("Erro no listener das ferramentas perdidas:",e)});return()=>e()},[]);const[Ee,Ae]=(0,e.useState)([]);(0,e.useEffect)(()=>{const e=(0,s.aQ)((0,s.collection)(P.db,"compras"),e=>{const t=e.docs.map(e=>(0,n.A)({id:e.id},e.data()));Ae(t)},e=>{console.error("Erro no listener das compras:",e)});return()=>e()},[]);if(!r)return(0,k.jsx)(j_,{});const Ce={inventario:ue,emprestimos:ge,funcionarios:ke,ferramentasDanificadas:Ne,ferramentasPerdidas:Se,compras:Ee},Ie=(0,e.useMemo)(()=>[{id:"meu-perfil",nome:"Meu Perfil",icone:ak,permissao:()=>!0},{id:"ranking",nome:"Ranking",icone:nu,permissao:()=>!0},{id:"notificacoes",nome:"Notifica\xe7\xf5es",icone:Od,permissao:()=>!0},{id:"mensagens",nome:"Mensagens",icone:F_,permissao:()=>!0},{id:"gerenciamento-inventario",nome:"Invent\xe1rio & Empr\xe9stimos",icone:Md,permissao:()=>!0},{id:"funcionarios",nome:"Funcion\xe1rios",icone:uk,permissao:()=>(null===r||void 0===r?void 0:r.nivel)===jt.ADMIN||(null===r||void 0===r?void 0:r.nivel)!==jt.FUNCIONARIO&&(null===r||void 0===r?void 0:r.nivel)<=jt.GERENTE_GERAL},{id:"empresas-setores",nome:"Empresas & Setores",icone:Wb,permissao:()=>(null===r||void 0===r?void 0:r.nivel)===jt.ADMIN||(null===r||void 0===r?void 0:r.nivel)!==jt.FUNCIONARIO&&(null===r||void 0===r?void 0:r.nivel)<=jt.GERENTE_GERAL},{id:"system-admin",nome:"Administra\xe7\xe3o do Sistema",icone:gN,permissao:()=>(null===r||void 0===r?void 0:r.nivel)===jt.ADMIN},{id:"feed-social",nome:"Feed Social",icone:F_,permissao:()=>!0}].filter(e=>e.permissao()),[null===r||void 0===r?void 0:r.nivel]),Te=()=>{if(!Ie||0===Ie.length)return null;let e=Ie.find(e=>e.id===T);if(!e){const t=(null===r||void 0===r?void 0:r.nivel)===jt.FUNCIONARIO?"meu-perfil":"gerenciamento-inventario";e=Ie.find(e=>e.id===t)}if(e&&e.permissao&&"function"===typeof e.permissao&&!e.permissao()){console.log("\u26a0\ufe0f Usu\xe1rio sem permiss\xe3o para p\xe1gina favorita: ".concat(e.id));const t=(null===r||void 0===r?void 0:r.nivel)===jt.FUNCIONARIO?["meu-perfil","gerenciamento-inventario","tarefas","mensagens"]:["meu-perfil","gerenciamento-inventario","funcionarios"];for(const e of t){const t=Ie.find(t=>t.id===e);if(t&&(!t.permissao||t.permissao()))return console.log("\u2705 Usando fallback priorizado: ".concat(e)),t}const a=Ie.find(e=>!e.permissao||"function"!==typeof e.permissao||e.permissao());return a?(console.log("\u2705 Usando fallback geral: ".concat(a.id)),a):(console.warn("\u26a0\ufe0f Nenhuma aba com permiss\xe3o encontrada, usando primeira aba"),Ie[0])}return e};(0,e.useEffect)(()=>{if(null===r||void 0===r||!r.id||E||!F)return;console.log("\ud83c\udfaf Inicializando p\xe1gina inicial (favorito carregado)...");const e=de();if(e&&e.abaAtiva){const t=Ie.find(t=>t.id===e.abaAtiva);if(t&&(!t.permissao||t.permissao()))return console.log("\ud83d\udd04 Restaurando \xfaltima p\xe1gina:",e.abaAtiva),g(e.abaAtiva),void setTimeout(()=>{e.scrollPosition&&window.scrollTo(0,e.scrollPosition)},100);console.log("\u26a0\ufe0f P\xe1gina salva inv\xe1lida ou sem permiss\xe3o:",e.abaAtiva)}const t=Te(),a=t?t.id:"gerenciamento-inventario";console.log("\u2b50 Iniciando com p\xe1gina favorita:",a),g(a)},[null===r||void 0===r?void 0:r.id,de,E,F,Ie]),(0,e.useEffect)(()=>{null!==r&&void 0!==r&&r.id&&(L(!1),I(null))},[null===r||void 0===r?void 0:r.id]),(0,e.useEffect)(()=>{if(null===r||void 0===r||!r.id||0===Ie.length)return;if(null!==C)return;(async()=>{try{console.log("\ud83d\udd04 Carregando configura\xe7\xe3o do menu...");const e=(await(0,s.x7)((0,s.doc)(P.db,"usuarios",r.id))).data(),t=null===e||void 0===e?void 0:e.menuConfig,a=(null===r||void 0===r?void 0:r.nivel)===jt.FUNCIONARIO?"meu-perfil":"emprestimos",n=(null===e||void 0===e?void 0:e.itemFavorito)||a;if(t&&t.length>0)console.log("\u2705 Configura\xe7\xe3o carregada:",{menuConfig:t,favorito:n}),I(t),D(n),L(!0);else{console.log("\ud83d\udcdd Criando configura\xe7\xe3o padr\xe3o...");const e=Ie.filter(e=>"ranking"!==e.id&&"meu-perfil"!==e.id),t=e.map((e,t)=>({id:e.id,visivel:t<4,ordem:t}));I(t),D(a),L(!0)}}catch(e){console.error("\u274c Erro ao carregar menu config:",e);const t=(null===r||void 0===r?void 0:r.nivel)===jt.FUNCIONARIO?"meu-perfil":"emprestimos";D(t),L(!0)}})()},[null===r||void 0===r?void 0:r.id,Ie.length]),(0,e.useEffect)(()=>{if(F&&T&&null!==r&&void 0!==r&&r.id&&!M){console.log("\ud83c\udfe0 Definindo p\xe1gina inicial como favorita:",{itemFavorito:T,nivelUsuario:null===r||void 0===r?void 0:r.nivel,abaAtiva:f}),J(!0);const e=Ie.find(e=>e.id===T);if(e&&e.permissao&&e.permissao())g(T),console.log("\u2705 Redirecionado para p\xe1gina favorita:",T);else{const e=(null===r||void 0===r?void 0:r.nivel)===jt.FUNCIONARIO?"meu-perfil":"emprestimos",t=Ie.find(t=>t.id===e);if(t&&t.permissao&&t.permissao())g(e),console.log("\u2705 Redirecionado para fallback:",e);else{const e=Ie.find(e=>e.permissao&&e.permissao());e&&(g(e.id),console.log("\u26a0\ufe0f Usando primeira aba dispon\xedvel:",e.id))}}R(!0),setTimeout(()=>{J(!1)},300)}},[F,T,null===r||void 0===r?void 0:r.id,M,Ie]),(0,e.useEffect)(()=>{r||(R(!1),L(!1),g(null))},[r]),(0,e.useEffect)(()=>{if(null!==r&&void 0!==r&&r.id&&!f&&Ie.length>0&&F){const e=setTimeout(()=>{g(e=>{if(e)return console.log("\u2705 Aba j\xe1 definida, cancelando timeout:",e),e;const t=(null===r||void 0===r?void 0:r.nivel)===jt.FUNCIONARIO?"meu-perfil":"emprestimos",a=Ie.find(e=>e.id===t);if(a&&a.permissao&&a.permissao())return console.log("\u26a0\ufe0f Timeout - Usando fallback de emerg\xeancia:",t),t;{const e=Ie.find(e=>e.permissao&&e.permissao());if(e)return console.log("\u26a0\ufe0f Timeout - Usando primeira aba dispon\xedvel:",e.id),e.id}return e})},2e3);return()=>clearTimeout(e)}},[null===r||void 0===r?void 0:r.id,F,Ie.length]);const De=async(e,t)=>{if(null!==r&&void 0!==r&&r.id)try{const a=t||T;console.log("\ud83d\udcbe Salvando configura\xe7\xe3o...",{menuConfig:e,itemFavorito:a}),await(0,s.updateDoc)((0,s.doc)(Jt,"usuarios",r.id),{menuConfig:e,itemFavorito:a}),I(e),D(a),Y(!0),console.log("\u2705 Configura\xe7\xe3o salva no Firebase Backup com sucesso!"),setTimeout(()=>Y(!1),2e3)}catch(a){console.error("\u274c Erro ao salvar menu config:",a),alert("Erro ao salvar configura\xe7\xe3o. Tente novamente.")}},Pe=(e,t)=>{e.preventDefault(),null!==H&&H!==t&&(((e,t)=>{if(!C)return;const r=[...C],[a]=r.splice(e,1);r.splice(t,0,a);const s=r.map((e,t)=>(0,n.A)((0,n.A)({},e),{},{ordem:t}));I(s)})(H,t),G(null),K(null))},Fe=()=>{G(null),K(null)},Le=()=>{if(!C)return Ie;const e=new Map(Ie.map(e=>[e.id,e]));return C.sort((e,t)=>e.ordem-t.ordem).map(t=>e.get(t.id)).filter(e=>void 0!==e)},Me=()=>{if(!C)return Ie.filter(e=>"ranking"!==e.id&&"meu-perfil"!==e.id&&e.id!==T).filter(e=>!e.permissao||"function"!==typeof e.permissao||e.permissao()).slice(0,3);return Le().filter(e=>{const t=C.find(t=>t.id===e.id);return!(e.permissao&&"function"===typeof e.permissao&&!e.permissao())&&((null===t||void 0===t?void 0:t.visivel)&&e.id!==T)})};return(0,e.useEffect)(()=>{C&&console.log("\ud83d\udd0d Estado do menu:",{menuPersonalizado:C,itemFavorito:T,"vis\xedveis":C.filter(e=>e.visivel).length})},[C,T]),(0,e.useEffect)(()=>{if(!r||!f||!Ie||0===Ie.length)return;const e=Ie.find(e=>e.id===f);if(e&&e.permissao&&"function"===typeof e.permissao&&!e.permissao()){console.log('\u26a0\ufe0f Usu\xe1rio n\xe3o tem permiss\xe3o para acessar "'.concat(f,'", redirecionando...'));const e=Ie.find(e=>!e.permissao||"function"!==typeof e.permissao||e.permissao());g(e?e.id:"meu-perfil")}},[r,f,Ie]),(0,e.useEffect)(()=>(window.workflowDebug={diagnosticarInventario:me,corrigirEstadoItem:fe,corrigirTodoInventario:async()=>{const e=await me();if(e.temInconsistencias){console.log("\ud83d\udd27 Corrigindo inconsist\xeancias automaticamente...");const t=[];for(const r of e.inconsistencias){console.log("\u2699\ufe0f Corrigindo ".concat(r.nome,"..."));const e=await fe(r.nome);t.push({item:r.nome,sucesso:e.sucesso,correcao:e.correcaoAplicada})}return console.log("\u2705 Corre\xe7\xe3o completa!"),console.table(t),t}return console.log("\u2705 Nenhuma corre\xe7\xe3o necess\xe1ria"),[]}},window.workflowPersistence={salvarFormulario:oe,carregarFormulario:le,limparEstado:()=>{localStorage.removeItem(ie),console.log("\ufffd\ufe0f Estado do aplicativo limpo")},verEstado:()=>{const e=localStorage.getItem(ie);console.log("\ud83d\udccb Estado atual:",e?JSON.parse(e):null)}},console.log("\ud83d\udee0\ufe0f Fun\xe7\xf5es dispon\xedveis no console:"),console.log("  - window.workflowDebug.diagnosticarInventario()"),console.log('  - window.workflowDebug.corrigirEstadoItem("nome do item")'),console.log("  - window.workflowDebug.corrigirTodoInventario()"),console.log('  - window.workflowPersistence.salvarFormulario("abaId", {dados})'),console.log('  - window.workflowPersistence.carregarFormulario("abaId")'),console.log("  - window.workflowPersistence.limparEstado()"),console.log("  - window.workflowPersistence.verEstado()"),()=>{delete window.workflowDebug,delete window.workflowPersistence}),[oe,le,ie]),(0,k.jsx)(ir,{children:(0,k.jsxs)("div",{className:"min-h-screen bg-white dark:bg-black transition-colors duration-200",children:[c&&(0,k.jsx)("header",{className:"fixed top-0 left-0 right-0 z-50 bg-white dark:bg-black border-b border-gray-200 dark:border-gray-700 shadow-sm",children:(0,k.jsx)("div",{className:"flex items-center justify-between px-4 h-16",children:(0,k.jsxs)("div",{className:"flex items-center w-full relative",children:[(0,k.jsx)("div",{className:"flex items-center justify-center w-full",children:(0,k.jsxs)("div",{className:"flex items-center",children:[(0,k.jsx)("div",{className:"relative w-10 h-10 mr-2",children:(0,k.jsx)("img",{src:"/logo.png",alt:"Logo WorkFlow",className:"w-full h-full object-contain relative z-10"})}),(0,k.jsx)("h1",{className:"text-base font-bold text-gray-900 dark:text-white",children:"WorkFlow"})]})}),(0,k.jsx)("div",{className:"absolute right-0",children:(0,k.jsx)(fr,{size:"sm"})})]})})}),c&&p&&(0,k.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-30",onClick:()=>x(!1)}),(0,k.jsx)("nav",{className:"".concat(c?"fixed top-0 bottom-0 left-0 z-50 w-full h-full transform transition-transform duration-300 ease-in-out ".concat(p?"translate-x-0":"-translate-x-full"," bg-white dark:bg-black shadow-lg border-r border-gray-200 dark:border-gray-700"):"".concat(y?"w-16":"w-80"," fixed h-full left-0 transition-all duration-300 ease-in-out bg-white dark:bg-black shadow-lg rounded-lg mt-2 border-r border-gray-200 dark:border-gray-700")),children:(0,k.jsxs)("div",{className:"flex flex-col h-full",children:[!c&&(0,k.jsxs)("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700 flex items-center justify-between",children:[(0,k.jsxs)("div",{className:"flex items-center ".concat(y?"justify-center w-full":""),children:[(0,k.jsx)("div",{className:"relative w-12 h-12",children:(0,k.jsx)("img",{src:"/logo.png",alt:"Logo WorkFlow",className:"w-full h-full object-contain relative z-10"})}),!y&&(0,k.jsx)("div",{className:"ml-3",children:(0,k.jsx)("h1",{className:"text-lg font-bold text-gray-900 dark:text-white",children:"WorkFlow"})})]}),!y&&(0,k.jsx)("button",{onClick:()=>v(!y),className:"p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",title:"Recolher menu",children:(0,k.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"text-gray-600 dark:text-gray-400",children:(0,k.jsx)("path",{d:"m15 18-6-6 6-6"})})})]}),!c&&y&&(0,k.jsx)("div",{className:"p-2 flex justify-center border-b border-gray-200 dark:border-gray-600",children:(0,k.jsx)("button",{onClick:()=>v(!y),className:"p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",title:"Expandir menu",children:(0,k.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"text-gray-600 dark:text-gray-400",children:(0,k.jsx)("path",{d:"m9 18 6-6-6-6"})})})}),c&&p&&(0,k.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-600",children:[(0,k.jsxs)("div",{className:"flex-1 flex items-center justify-center",children:[(0,k.jsx)("div",{className:"relative w-10 h-10 mr-3",children:(0,k.jsx)("img",{src:"/logo.png",alt:"Logo WorkFlow",className:"w-full h-full object-contain relative z-10"})}),(0,k.jsx)("h1",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"WorkFlow"})]}),(0,k.jsx)("button",{onClick:ne,className:"p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",title:"Fechar menu",children:(0,k.jsx)(Id,{className:"w-6 h-6 text-gray-600 dark:text-gray-400"})})]}),c&&p?(0,k.jsx)("div",{className:"flex-1 p-3 overflow-y-auto custom-scrollbar",children:(0,k.jsxs)("div",{className:"grid grid-cols-4 gap-3",children:[Le().map(e=>{if(!e||!e.icone)return null;const t=e.icone;return(0,k.jsxs)("button",{onClick:()=>{g(e.id),x(!1)},className:"flex flex-col items-center justify-center p-2 rounded-xl transition-all duration-200 aspect-square relative ".concat(f===e.id?"bg-blue-500 dark:bg-[#1D9BF0] text-white shadow-lg":"bg-gray-100 dark:bg-gray-800 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-700"),children:[(0,k.jsxs)("div",{className:"relative",children:[(0,k.jsx)(t,{className:"w-6 h-6 mb-1"}),"notificacoes"===e.id&&(0,k.jsx)(S_,{count:u,size:"sm",max:9}),"mensagens"===e.id&&(0,k.jsx)(S_,{count:h,size:"sm",max:99})]}),(0,k.jsx)("span",{className:"text-xs font-medium text-center leading-tight",children:e.nome})]},e.id)}),(0,k.jsxs)("button",{onClick:()=>{g("suporte"),x(!1)},className:"flex flex-col items-center justify-center p-2 rounded-xl transition-all duration-200 aspect-square ".concat("suporte"===f?"bg-blue-500 dark:bg-[#1D9BF0] text-white shadow-lg":"bg-gray-100 dark:bg-gray-800 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-700"),children:[(0,k.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"w-6 h-6 mb-1",children:[(0,k.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,k.jsx)("path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"}),(0,k.jsx)("path",{d:"M12 17h.01"})]}),(0,k.jsx)("span",{className:"text-xs font-medium text-center leading-tight",children:"Suporte"})]}),l(jt.ADMIN)&&(0,k.jsxs)("button",{onClick:()=>{g("usuarios"),x(!1)},className:"flex flex-col items-center justify-center p-2 rounded-xl transition-all duration-200 aspect-square ".concat("usuarios"===f?"bg-blue-500 dark:bg-[#1D9BF0] text-white shadow-lg":"bg-gray-100 dark:bg-gray-800 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-700"),children:[(0,k.jsx)(uk,{className:"w-6 h-6 mb-1"}),(0,k.jsx)("span",{className:"text-xs font-medium text-center leading-tight",children:"Usu\xe1rios"})]}),(null===r||void 0===r?void 0:r.nivel)>jt.FUNCIONARIO&&(0,k.jsxs)(k.Fragment,{children:[(0,k.jsxs)("button",{onClick:()=>{g("dashboard"),x(!1)},className:"flex flex-col items-center justify-center p-2 rounded-xl transition-all duration-200 aspect-square ".concat("dashboard"===f?"bg-blue-500 dark:bg-[#1D9BF0] text-white shadow-lg":"bg-gray-100 dark:bg-gray-800 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-700"),children:[(0,k.jsx)(tu,{className:"w-6 h-6 mb-1"}),(0,k.jsx)("span",{className:"text-xs font-medium text-center leading-tight",children:"Dashboard"})]}),(0,k.jsxs)("button",{onClick:()=>{g("historico-emprestimos"),x(!1)},className:"flex flex-col items-center justify-center p-2 rounded-xl transition-all duration-200 aspect-square ".concat("historico-emprestimos"===f?"bg-blue-500 dark:bg-[#1D9BF0] text-white shadow-lg":"bg-gray-100 dark:bg-gray-800 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-700"),children:[(0,k.jsx)(Uw,{className:"w-6 h-6 mb-1"}),(0,k.jsx)("span",{className:"text-xs font-medium text-center leading-tight",children:"Hist\xf3rico"})]}),(0,k.jsxs)("button",{onClick:()=>{g("historico-transferencias"),x(!1)},className:"flex flex-col items-center justify-center p-2 rounded-xl transition-all duration-200 aspect-square ".concat("historico-transferencias"===f?"bg-blue-500 dark:bg-[#1D9BF0] text-white shadow-lg":"bg-gray-100 dark:bg-gray-800 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-700"),children:[(0,k.jsx)(vu,{className:"w-6 h-6 mb-1"}),(0,k.jsx)("span",{className:"text-xs font-medium text-center leading-tight",children:"Transfer\xeancias"})]})]}),(0,k.jsxs)("button",{onClick:()=>{g("legal"),x(!1)},className:"flex flex-col items-center justify-center p-2 rounded-xl transition-all duration-200 aspect-square ".concat("legal"===f?"bg-blue-500 dark:bg-[#1D9BF0] text-white shadow-lg":"bg-gray-100 dark:bg-gray-800 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-700"),children:[(0,k.jsx)(ru,{className:"w-6 h-6 mb-1"}),(0,k.jsx)("span",{className:"text-xs font-medium text-center leading-tight",children:"Legal"})]})]})}):(0,k.jsx)("div",{className:"flex-1 overflow-y-auto py-2 px-2",children:(0,k.jsx)("div",{className:"space-y-1",children:Ie.filter(e=>e.permissao()).map(e=>{if(!e||!e.icone)return null;const t=e.icone;return(0,k.jsxs)("button",{onClick:()=>{return t=e.id,console.log("\ud83d\uddb1\ufe0f Clique em aba:",t,"Modo edi\xe7\xe3o:",re),g(t),c&&x(!1),void(re&&(ae(!1),te(null)));var t},onMouseDown:()=>(e=>{if(c)return;console.log("\ud83d\uddb1\ufe0f Iniciando long press para:",e),te(e);const t=setTimeout(()=>{console.log("\ud83c\udfaf Long press ativado para:",e),ae(!0),B(!0),navigator.vibrate&&navigator.vibrate(50)},800);$(t)})(e.id),onMouseUp:se,onMouseLeave:se,className:"".concat(y?"justify-center":"justify-start"," w-full flex items-center ").concat(y?"px-0":"space-x-3 px-4"," ").concat(c?"py-4":"py-3"," rounded-full font-medium text-[20px] transition-all duration-200 relative ").concat(f===e.id?"bg-blue-500 dark:bg-[#1D9BF0] text-white":"text-gray-700 dark:text-[#E7E9EA] hover:bg-gray-100 dark:hover:bg-[#1D9BF0]/10"," ").concat(e.id===T&&re?"ring-2 ring-yellow-400 ring-offset-2 ring-offset-gray-50 dark:ring-offset-gray-800":""," ").concat(ee===e.id?"transform scale-95 bg-gray-200 dark:bg-gray-700":""),title:y?e.nome:"",children:[(0,k.jsxs)("div",{className:"relative",children:[(0,k.jsx)(t,{className:"".concat(c?"w-6 h-6":"w-5 h-5"," flex-shrink-0 ").concat(f===e.id?"text-white":"text-gray-700 dark:text-[#E7E9EA] group-hover:text-blue-500 dark:group-hover:text-[#1D9BF0]")}),"notificacoes"===e.id&&(0,k.jsx)(S_,{count:u,size:"md",max:9}),"mensagens"===e.id&&(0,k.jsx)(S_,{count:h,size:"md",max:99}),e.id===T&&(0,k.jsx)("div",{className:"absolute -top-1 -right-1 w-3 h-3 bg-yellow-400 rounded-full flex items-center justify-center",children:(0,k.jsx)("span",{className:"text-yellow-900 text-xs",children:"\u2605"})})]}),!y&&(0,k.jsx)("span",{children:e.nome})]},e.id)})})}),!c&&y&&(0,k.jsx)("div",{className:"px-2 py-2 border-t border-gray-200 dark:border-gray-600",children:(0,k.jsxs)("div",{className:"space-y-1",children:[(0,k.jsx)("button",{onClick:()=>g("suporte"),className:"w-full flex justify-center p-2 rounded-lg transition-colors ".concat("suporte"===f?"bg-blue-500 dark:bg-[#1D9BF0] text-white":"text-gray-700 dark:text-[#E7E9EA] hover:bg-gray-100 dark:hover:bg-[#1D9BF0]/10"),title:"Ajuda",children:(0,k.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,k.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,k.jsx)("path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"}),(0,k.jsx)("path",{d:"M12 17h.01"})]})}),l(jt.ADMIN)&&(0,k.jsx)("button",{onClick:()=>g("usuarios"),className:"w-full flex justify-center p-2 rounded-lg transition-colors ".concat("usuarios"===f?"bg-blue-500 dark:bg-[#1D9BF0] text-white":"text-gray-700 dark:text-[#E7E9EA] hover:bg-gray-100 dark:hover:bg-[#1D9BF0]/10"),title:"Usu\xe1rios",children:(0,k.jsx)(uk,{className:"w-5 h-5"})}),(null===r||void 0===r?void 0:r.nivel)>jt.FUNCIONARIO&&(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)("button",{onClick:()=>g("dashboard"),className:"w-full flex justify-center p-2 rounded-lg transition-colors ".concat("dashboard"===f?"bg-blue-500 dark:bg-[#1D9BF0] text-white":"text-gray-700 dark:text-[#E7E9EA] hover:bg-gray-100 dark:hover:bg-[#1D9BF0]/10"),title:"Dashboard",children:(0,k.jsx)(tu,{className:"w-5 h-5"})}),(0,k.jsx)("button",{onClick:()=>g("historico-emprestimos"),className:"w-full flex justify-center p-2 rounded-lg transition-colors ".concat("historico-emprestimos"===f?"bg-blue-500 dark:bg-[#1D9BF0] text-white":"text-gray-700 dark:text-[#E7E9EA] hover:bg-gray-100 dark:hover:bg-[#1D9BF0]/10"),title:"Hist\xf3rico de Empr\xe9stimos",children:(0,k.jsx)(Uw,{className:"w-5 h-5"})}),(0,k.jsx)("button",{onClick:()=>g("historico-transferencias"),className:"w-full flex justify-center p-2 rounded-lg transition-colors ".concat("historico-transferencias"===f?"bg-blue-500 dark:bg-[#1D9BF0] text-white":"text-gray-700 dark:text-[#E7E9EA] hover:bg-gray-100 dark:hover:bg-[#1D9BF0]/10"),title:"Hist\xf3rico de Transfer\xeancias",children:(0,k.jsx)(vu,{className:"w-5 h-5"})})]}),c&&(0,k.jsx)("div",{className:"w-full flex justify-center p-2",children:(0,k.jsx)(fr,{size:"sm"})}),(0,k.jsx)("button",{onClick:()=>g("legal"),className:"w-full flex justify-center p-2 rounded-lg transition-colors ".concat("legal"===f?"bg-blue-500 dark:bg-[#1D9BF0] text-white":"text-gray-700 dark:text-[#E7E9EA] hover:bg-gray-100 dark:hover:bg-[#1D9BF0]/10"),title:"Legal",children:(0,k.jsx)(ru,{className:"w-5 h-5"})}),(0,k.jsx)("button",{onClick:()=>g("relatorios-erro"),className:"w-full flex justify-center p-2 rounded-lg transition-colors ".concat("relatorios-erro"===f?"bg-blue-500 dark:bg-[#1D9BF0] text-white":"text-gray-700 dark:text-[#E7E9EA] hover:bg-gray-100 dark:hover:bg-[#1D9BF0]/10"),title:"Relat\xf3rios de Erros",children:(0,k.jsx)(rw,{className:"w-5 h-5"})})]})}),!y&&(0,k.jsxs)("div",{className:"".concat(c?"fixed":"absolute"," bottom-0 left-0 right-0 py-3 px-4 bg-white dark:bg-black rounded-b-lg border-t border-gray-200 dark:border-gray-600"),children:[(0,k.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,k.jsx)("div",{className:"w-12 h-12 rounded-full overflow-hidden flex-shrink-0 bg-gray-100 dark:bg-[#16181C]",children:null!==m&&void 0!==m&&m.photoURL?(0,k.jsx)("img",{src:m.photoURL,alt:"Profile",className:"w-full h-full object-cover"}):r.photoURL?(0,k.jsx)("img",{src:r.photoURL,alt:"Profile",className:"w-full h-full object-cover"}):(0,k.jsx)(mu,{className:"w-full h-full p-2 text-gray-600 dark:text-[#71767B]"})}),(0,k.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,k.jsx)("p",{className:"text-base font-bold text-gray-900 dark:text-[#E7E9EA] truncate leading-tight",children:(null===m||void 0===m?void 0:m.nome)||r.nome}),(0,k.jsx)("p",{className:"text-sm text-gray-500 dark:text-[#71767B] truncate leading-tight",children:r.nivel===jt.ADMIN?St[r.nivel]:(null===m||void 0===m?void 0:m.funcao)||r.cargo||St[r.nivel]})]}),(0,k.jsxs)("div",{className:"flex items-center space-x-2",children:[!c&&(0,k.jsx)(fr,{size:"sm"}),(0,k.jsx)("button",{onClick:e=>{e.stopPropagation(),i(),x(!1)},onMouseDown:e=>e.stopPropagation(),onMouseUp:e=>e.stopPropagation(),onMouseLeave:e=>e.stopPropagation(),className:"p-2 rounded-full hover:bg-red-500/10 transition-colors",title:"Sair",children:(0,k.jsx)(L_,{className:"w-5 h-5 text-gray-900 dark:text-[#E7E9EA]"})}),(0,k.jsx)("button",{onClick:e=>{e.stopPropagation(),w(!0),x(!1)},onMouseDown:e=>e.stopPropagation(),onMouseUp:e=>e.stopPropagation(),onMouseLeave:e=>e.stopPropagation(),className:"p-2 rounded-full hover:bg-black/5 dark:hover:bg-[#1D9BF0]/10 transition-colors",title:"Editar perfil",children:(0,k.jsx)(gw,{className:"w-5 h-5 text-gray-900 dark:text-[#E7E9EA]"})})]})]}),!c&&(0,k.jsx)("div",{className:"mt-2",children:(0,k.jsxs)("div",{className:"flex items-center gap-2",children:[(0,k.jsx)("button",{onClick:e=>{e.stopPropagation(),g("suporte"),x(!1)},onMouseDown:e=>e.stopPropagation(),onMouseUp:e=>e.stopPropagation(),onMouseLeave:e=>e.stopPropagation(),className:"p-2.5 rounded-full hover:bg-black/5 dark:hover:bg-[#1D9BF0]/10 transition-colors",title:"Ajuda",children:(0,k.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"text-gray-900 dark:text-[#E7E9EA]",children:[(0,k.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,k.jsx)("path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"}),(0,k.jsx)("path",{d:"M12 17h.01"})]})}),l(jt.ADMIN)&&(0,k.jsx)("button",{onClick:e=>{e.stopPropagation(),g("usuarios"),x(!1)},onMouseDown:e=>e.stopPropagation(),onMouseUp:e=>e.stopPropagation(),onMouseLeave:e=>e.stopPropagation(),className:"p-2.5 rounded-full hover:bg-black/5 dark:hover:bg-[#1D9BF0]/10 transition-colors",title:"Usu\xe1rios",children:(0,k.jsx)(uk,{className:"w-5 h-5 text-gray-900 dark:text-[#E7E9EA]"})}),l(jt.ADMIN)&&(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)("button",{onClick:e=>{e.stopPropagation(),g("dashboard"),x(!1)},onMouseDown:e=>e.stopPropagation(),onMouseUp:e=>e.stopPropagation(),onMouseLeave:e=>e.stopPropagation(),className:"p-2.5 rounded-full hover:bg-black/5 dark:hover:bg-[#1D9BF0]/10 transition-colors",title:"Dashboard",children:(0,k.jsx)(tu,{className:"w-5 h-5 text-gray-900 dark:text-[#E7E9EA]"})}),(0,k.jsx)("button",{onClick:e=>{e.stopPropagation(),g("historico-emprestimos"),x(!1)},onMouseDown:e=>e.stopPropagation(),onMouseUp:e=>e.stopPropagation(),onMouseLeave:e=>e.stopPropagation(),className:"p-2.5 rounded-full hover:bg-black/5 dark:hover:bg-[#1D9BF0]/10 transition-colors",title:"Hist\xf3rico de Empr\xe9stimos",children:(0,k.jsx)(Uw,{className:"w-5 h-5 text-gray-900 dark:text-[#E7E9EA]"})}),(0,k.jsx)("button",{onClick:e=>{e.stopPropagation(),g("historico-transferencias"),x(!1)},onMouseDown:e=>e.stopPropagation(),onMouseUp:e=>e.stopPropagation(),onMouseLeave:e=>e.stopPropagation(),className:"p-2.5 rounded-full hover:bg-black/5 dark:hover:bg-[#1D9BF0]/10 transition-colors",title:"Hist\xf3rico de Transfer\xeancias",children:(0,k.jsx)(vu,{className:"w-5 h-5 text-gray-900 dark:text-[#E7E9EA]"})})]}),(0,k.jsx)("button",{onClick:e=>{e.stopPropagation(),g("legal"),x(!1)},onMouseDown:e=>e.stopPropagation(),onMouseUp:e=>e.stopPropagation(),onMouseLeave:e=>e.stopPropagation(),className:"p-2.5 rounded-full hover:bg-black/5 dark:hover:bg-[#1D9BF0]/10 transition-colors",title:"Legal",children:(0,k.jsx)(ru,{className:"w-5 h-5 text-gray-900 dark:text-[#E7E9EA]"})})]})})]})]})}),(0,k.jsx)(zd,{isOpen:b,onClose:()=>w(!1),userId:r.id}),(0,k.jsx)("main",{className:"".concat(c?"pt-16 pb-20":"".concat(y?"pl-16":"pl-80"," transition-all duration-300 ease-in-out")," w-full min-h-screen bg-white dark:bg-black"),children:(0,k.jsx)("div",{className:"max-w-5xl mx-auto px-4",children:(0,k.jsxs)("div",{className:"py-3",children:["dashboard"===f&&(l(jt.ADMIN)?(0,k.jsx)(pS,{stats:Ce}):(0,k.jsx)(H_,{message:"Voc\xea n\xe3o tem permiss\xe3o para visualizar o dashboard."})),"analytics"===f&&(It(null===r||void 0===r?void 0:r.nivel)?(0,k.jsx)(aS(),{}):(0,k.jsx)(H_,{message:"Voc\xea n\xe3o tem permiss\xe3o para visualizar as an\xe1lises do sistema."})),"legal"===f&&(0,k.jsx)(Pt,{}),"dashboard"===f&&(0,k.jsx)(q_,{stats:Ce}),"meu-perfil"===f&&(0,k.jsx)(kS,{}),"system-admin"===f&&(l(jt.ADMIN)?(0,k.jsx)(b_,{}):(0,k.jsx)(H_,{message:"Voc\xea n\xe3o tem permiss\xe3o para acessar a administra\xe7\xe3o do sistema."})),"gerenciamento-inventario"===f&&(0,k.jsx)(wk,{inventario:ue,emprestimos:ge,adicionarItem:async e=>{if(!Dt.canManageOperational(null===r||void 0===r?void 0:r.nivel))throw new Error("Sem permiss\xe3o para adicionar itens");try{const t=(0,n.A)((0,n.A)({},e),{},{quantidade:Number(e.quantidade),disponivel:Number(e.quantidade)});return await(0,s.gS)((0,s.collection)(P.db,"inventario"),t)}catch(t){throw console.error("Erro ao adicionar item:",t),t}},removerItem:async e=>{if(!Dt.canManageOperational(null===r||void 0===r?void 0:r.nivel))throw new Error("Sem permiss\xe3o para remover itens");try{return await(0,s.deleteDoc)((0,s.doc)(P.db,"inventario",e))}catch(t){throw console.error("Erro ao remover item:",t),t}},atualizarItem:async(e,t)=>{if(!Dt.canManageOperational(null===r||void 0===r?void 0:r.nivel))throw new Error("Sem permiss\xe3o para atualizar itens");try{return await(0,s.updateDoc)((0,s.doc)(P.db,"inventario",e),t)}catch(a){throw console.error("Erro ao atualizar item:",a),a}},reimportarInventario:async()=>{const e=await(0,s.GG)((0,s.collection)(P.db,"inventario"));for(const t of e.docs)await(0,s.deleteDoc)((0,s.doc)(P.db,"inventario",t.id));for(const t of kk){const{id:e}=t,r=(0,a.A)(t,B_);await(0,s.gS)((0,s.collection)(P.db,"inventario"),r)}},corrigirInventario:async()=>{const e=await(0,s.GG)((0,s.collection)(P.db,"inventario"));for(const a of e.docs){const e=a.data();void 0!==e.quantidade&&await(0,s.updateDoc)((0,s.doc)(P.db,"inventario",a.id),{disponivel:e.quantidade,emUso:0})}const t=await(0,s.GG)((0,s.P)((0,s.collection)(P.db,"emprestimos"),(0,s._M)("status","==","emprestado"))),r=new Map;for(const a of t.docs){const e=a.data();if(e.ferramentas&&Array.isArray(e.ferramentas))for(const t of e.ferramentas){const e="string"===typeof t?t:t.nome,a="string"===typeof t?1:t.quantidade||1,n=e.trim().toLowerCase();r.set(n,(r.get(n)||0)+a)}}for(const a of e.docs){const e=a.data(),t=e.nome.trim().toLowerCase(),n=r.get(t)||0,i=e.quantidade-n;await(0,s.updateDoc)((0,s.doc)(P.db,"inventario",a.id),{disponivel:Math.max(0,i),emUso:n})}alert('Invent\xe1rio corrigido: campos "disponivel" e "emUso" atualizados!')},obterDetalhesEmprestimos:e=>{try{console.log("Buscando detalhes para:",e);const t=e.trim().toLowerCase();let r=0;const a=[],n=ge.filter(e=>"emprestado"===e.status);return console.log("Empr\xe9stimos ativos encontrados:",n.length),n.forEach(e=>{if(e.ferramentas&&Array.isArray(e.ferramentas)){const n=e.ferramentas.filter(e=>("string"===typeof e?e:e.nome).trim().toLowerCase()===t);n.length>0&&(console.log("Encontrado em empr\xe9stimo:",e.id),n.forEach(t=>{const n="string"===typeof t?1:t.quantidade||1;r+=n,a.push({colaborador:e.colaborador,funcionario:e.colaborador,quantidade:n,dataEmprestimo:e.dataRetirada?e.dataRetirada:e.dataEmprestimo,horaEmprestimo:e.horaRetirada?e.horaRetirada:e.horaEmprestimo})}))}}),console.log('Estado atual de "'.concat(e,'":'),{nomeNormalizado:t,quantidadeEmUso:r,detalhes:a}),a}catch(t){return console.error("Erro ao obter detalhes dos empr\xe9stimos:",t),[]}},compras:Ee,adicionarCompra:async e=>{if(!Dt.canManagePurchases(null===r||void 0===r?void 0:r.nivel))throw new Error("Sem permiss\xe3o para adicionar compras");try{return await(0,s.gS)((0,s.collection)(P.db,"compras"),e)}catch(t){throw console.error("Erro ao adicionar compra:",t),t}},removerCompra:async e=>{if(!Dt.canManagePurchases(null===r||void 0===r?void 0:r.nivel))throw new Error("Sem permiss\xe3o para remover compras");try{return await(0,s.deleteDoc)((0,s.doc)(P.db,"compras",e))}catch(t){throw console.error("Erro ao remover compra:",t),t}},atualizarCompra:async(e,t)=>{if(!Dt.canManagePurchases(null===r||void 0===r?void 0:r.nivel))throw new Error("Sem permiss\xe3o para atualizar compras");try{return await(0,s.updateDoc)((0,s.doc)(P.db,"compras",e),t)}catch(a){throw console.error("Erro ao atualizar compra:",a),a}},ferramentasDanificadas:Ne,adicionarFerramentaDanificada:async e=>{if(!Dt.canManageOperational(null===r||void 0===r?void 0:r.nivel))throw new Error("Sem permiss\xe3o para adicionar ferramentas danificadas");try{return await(0,s.gS)((0,s.collection)(P.db,"ferramentas_danificadas"),e)}catch(t){throw console.error("Erro ao adicionar ferramenta danificada:",t),t}},atualizarFerramentaDanificada:async(e,t)=>{if(!Dt.canManageOperational(null===r||void 0===r?void 0:r.nivel))throw new Error("Sem permiss\xe3o para atualizar ferramentas danificadas");try{return await(0,s.updateDoc)((0,s.doc)(P.db,"ferramentas_danificadas",e),t)}catch(a){throw console.error("Erro ao atualizar ferramenta danificada:",a),a}},removerFerramentaDanificada:async e=>{if(!Dt.canManageOperational(null===r||void 0===r?void 0:r.nivel))throw new Error("Sem permiss\xe3o para remover ferramentas danificadas");try{return await(0,s.deleteDoc)((0,s.doc)(P.db,"ferramentas_danificadas",e))}catch(t){throw console.error("Erro ao remover ferramenta danificada:",t),t}},ferramentasPerdidas:Se,adicionarFerramentaPerdida:async e=>{if(!Dt.canManageOperational(null===r||void 0===r?void 0:r.nivel))throw new Error("Sem permiss\xe3o para adicionar ferramentas perdidas");try{return await(0,s.gS)((0,s.collection)(P.db,"ferramentas_perdidas"),e)}catch(t){throw console.error("Erro ao adicionar ferramenta perdida:",t),t}},atualizarFerramentaPerdida:async(e,t)=>{if(!Dt.canManageOperational(null===r||void 0===r?void 0:r.nivel))throw new Error("Sem permiss\xe3o para atualizar ferramentas perdidas");try{return await(0,s.updateDoc)((0,s.doc)(P.db,"ferramentas_perdidas",e),t)}catch(a){throw console.error("Erro ao atualizar ferramenta perdida:",a),a}},removerFerramentaPerdida:async e=>{if(!Dt.canManageOperational(null===r||void 0===r?void 0:r.nivel))throw new Error("Sem permiss\xe3o para remover ferramentas perdidas");try{return await(0,s.deleteDoc)((0,s.doc)(P.db,"ferramentas_perdidas",e))}catch(t){throw console.error("Erro ao remover ferramenta perdida:",t),t}},funcionarios:ke,adicionarEmprestimo:async e=>{if(!Dt.canManageOperational(null===r||void 0===r?void 0:r.nivel))throw new Error("Sem permiss\xe3o para adicionar empr\xe9stimos");try{const a=(0,n.A)((0,n.A)({},e),{},{dataEmprestimo:(new Date).toISOString(),colaborador:e.nomeFuncionario,nomeFerramentas:e.ferramentas.map(e=>e.nome),status:"emprestado"});for(const t of e.ferramentas){const e=ue.find(e=>e.nome===t.nome);if(!e||e.disponivel<t.quantidade)throw new Error("Quantidade indispon\xedvel para ".concat(t.nome))}const i=await(0,s.gS)((0,s.collection)(P.db,"emprestimos"),a);await be(e.ferramentas,"emprestar");try{const t=ke.find(t=>t.nome===e.nomeFuncionario);null!==t&&void 0!==t&&t.id&&(await k_(t.id,e.ferramentas,(null===r||void 0===r?void 0:r.nome)||"Respons\xe1vel",{emprestimoId:i.id}),console.log("Notifica\xe7\xe3o de empr\xe9stimo enviada para:",t.nome))}catch(t){console.error("Erro ao enviar notifica\xe7\xe3o de empr\xe9stimo:",t)}return i}catch(a){throw console.error("Erro ao adicionar empr\xe9stimo:",a),a}},removerEmprestimo:ve,atualizarEmprestimo:async(e,t)=>{if(!Dt.canManageOperational(null===r||void 0===r?void 0:r.nivel))throw new Error("Sem permiss\xe3o para atualizar empr\xe9stimos");try{return await(0,s.updateDoc)((0,s.doc)(P.db,"emprestimos",e),t)}catch(a){throw console.error("Erro ao atualizar empr\xe9stimo:",a),a}},devolverFerramentas:we,emprestimosCarregados:xe}),"funcionarios"===f&&(0,k.jsx)(kN,{funcionarios:ke,adicionarFuncionario:async e=>{if(!Dt.canManageEmployees(null===r||void 0===r?void 0:r.nivel))throw new Error("Sem permiss\xe3o para adicionar funcion\xe1rios");try{const t=await(0,s.gS)((0,s.collection)(P.db,"funcionarios"),e),r={nome:e.nome,email:e.nome.toLowerCase().replace(/\s+/g,"."),senha:"1234",nivel:jt.FUNCIONARIO,ativo:!0,dataCriacao:(new Date).toISOString(),ultimoLogin:null,funcionarioId:t.id};return await(0,s.gS)((0,s.collection)(P.db,"usuarios"),r),t}catch(t){throw console.error("Erro ao adicionar funcion\xe1rio:",t),t}},removerFuncionario:async e=>{if(!Dt.canManageEmployees(null===r||void 0===r?void 0:r.nivel))throw new Error("Sem permiss\xe3o para remover funcion\xe1rios");try{return await(0,s.deleteDoc)((0,s.doc)(P.db,"funcionarios",e))}catch(t){throw console.error("Erro ao remover funcion\xe1rio:",t),t}},atualizarFuncionario:async(e,t)=>{if(!Dt.canManageEmployees(null===r||void 0===r?void 0:r.nivel))throw new Error("Sem permiss\xe3o para atualizar funcion\xe1rios");try{return await(0,s.updateDoc)((0,s.doc)(P.db,"funcionarios",e),t)}catch(a){throw console.error("Erro ao atualizar funcion\xe1rio:",a),a}},readonly:!Dt.canManageEmployees(null===r||void 0===r?void 0:r.nivel)}),"empresas-setores"===f&&(0,k.jsx)(N_,{usuarioAtual:r}),"ranking"===f&&(0,k.jsx)(hu,{}),"notificacoes"===f&&(0,k.jsx)(LS,{onNavigate:g}),"mensagens"===f&&(0,k.jsx)(eS,{}),"historico-emprestimos"===f&&((null===r||void 0===r?void 0:r.nivel)===jt.ADMIN?(0,k.jsx)(FN,{emprestimos:ge,devolverFerramentas:we,removerEmprestimo:ve,atualizarDisponibilidade:()=>!0,inventario:ue}):(0,k.jsx)(H_,{message:"Apenas administradores podem visualizar o hist\xf3rico de empr\xe9stimos."})),"usuarios"===f&&(l(jt.ADMIN)?(0,k.jsx)(TN,{}):(0,k.jsx)(H_,{message:"Apenas administradores podem gerenciar usu\xe1rios do sistema."})),"historico-transferencias"===f&&(l(jt.ADMIN)?(0,k.jsx)(tS,{}):(0,k.jsx)(H_,{message:"Apenas administradores podem visualizar o hist\xf3rico de transfer\xeancias."})),"suporte"===f&&(0,k.jsx)(Ot,{})]})})}),c&&!p&&(0,k.jsx)("nav",{className:"fixed bottom-0 left-0 right-0 z-50 bg-white dark:bg-black border-t border-gray-200 dark:border-gray-600 px-2 py-0.5",children:(0,k.jsxs)("div",{className:"flex justify-around items-center",children:[Me().slice(0,2).map(e=>{if(!e||!e.icone)return null;const t=e.icone;return(0,k.jsxs)("button",{onClick:()=>{g(e.id),x(!1)},className:"flex flex-col items-center justify-center p-1 rounded-lg transition-all duration-200 min-w-0 flex-1 ".concat(f===e.id?"text-blue-500 dark:text-[#1D9BF0]":"text-gray-500 dark:text-gray-400"),children:[(0,k.jsx)(t,{className:"w-4 h-4 mb-0.5 ".concat(f===e.id?"text-blue-500 dark:text-[#1D9BF0]":"text-gray-500 dark:text-gray-400")}),(0,k.jsx)("span",{className:"text-xs font-medium truncate w-full text-center leading-tight",children:e.nome})]},e.id)}),(()=>{const e=Te();if(!e||!e.icone)return null;const t=e.icone;return(0,k.jsxs)("button",{onClick:()=>{g(e.id),x(!1)},className:"flex flex-col items-center justify-center p-1 transition-all duration-200 min-w-0 flex-1 transform -translate-y-[20%] hover:scale-105",children:[(0,k.jsx)("div",{className:"w-10 h-10 rounded-full flex items-center justify-center mb-0.5 transition-all duration-300 hover:shadow-lg hover:shadow-blue-200 dark:hover:shadow-blue-900 ".concat(f===e.id?"bg-blue-500 dark:bg-[#1D9BF0] shadow-lg":"bg-blue-500 dark:bg-[#1D9BF0]"),children:(0,k.jsx)(t,{className:"w-5 h-5 text-white"})}),(0,k.jsx)("span",{className:"text-xs font-medium text-center leading-tight ".concat(f===e.id?"text-blue-500 dark:text-[#1D9BF0]":"text-gray-500 dark:text-gray-400"),children:e.nome})]})})(),Me().slice(2,3).map(e=>{if(!e||!e.icone)return null;const t=e.icone;return(0,k.jsxs)("button",{onClick:()=>{g(e.id),x(!1)},className:"flex flex-col items-center justify-center p-1 rounded-lg transition-all duration-200 min-w-0 flex-1 ".concat(f===e.id?"text-blue-500 dark:text-[#1D9BF0]":"text-gray-500 dark:text-gray-400"),children:[(0,k.jsx)(t,{className:"w-4 h-4 mb-0.5 ".concat(f===e.id?"text-blue-500 dark:text-[#1D9BF0]":"text-gray-500 dark:text-gray-400")}),(0,k.jsx)("span",{className:"text-xs font-medium truncate w-full text-center leading-tight",children:e.nome})]},e.id)}),(0,k.jsxs)("button",{onClick:ne,onTouchStart:e=>{e.preventDefault();const t=setTimeout(()=>{B(!0),q(0)},500);U(t);let r=0;const a=setInterval(()=>{r+=20,q(r),r>=100&&clearInterval(a)},100)},onTouchEnd:()=>{z&&(clearTimeout(z),U(null)),q(0)},onTouchMove:()=>{z&&(clearTimeout(z),U(null)),q(0)},className:"flex flex-col items-center justify-center p-1 rounded-lg transition-all duration-200 min-w-0 flex-1 text-gray-500 dark:text-gray-400 relative",children:[V>0&&(0,k.jsx)("div",{className:"absolute inset-0 bg-blue-500 dark:bg-[#1D9BF0] opacity-20 rounded-lg transition-all",style:{clipPath:"inset(".concat(100-V,"% 0 0 0)")}}),(0,k.jsx)(au,{className:"w-4 h-4 mb-0.5 relative z-10"}),(0,k.jsx)("span",{className:"text-xs font-medium truncate w-full text-center leading-tight relative z-10",children:"Menu"})]})]})}),O&&(0,k.jsx)("div",{className:"fixed inset-0 bg-black/80 z-[100] flex items-center justify-center p-4",children:(0,k.jsxs)("div",{className:"bg-white dark:bg-gray-900 rounded-2xl w-full max-w-2xl max-h-[90vh] flex flex-col shadow-2xl",children:[(0,k.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 dark:border-gray-700",children:[(0,k.jsxs)("div",{children:[(0,k.jsx)("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Personalizar Menu"}),(0,k.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:re?"Configure o item selecionado: ".concat(ee||"Menu"):"Escolha quais itens aparecem no menu inferior e sua ordem"})]}),(0,k.jsx)("button",{onClick:()=>{B(!1),ae(!1),te(null)},className:"p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors",children:(0,k.jsx)(Id,{className:"w-6 h-6 text-gray-500 dark:text-gray-400"})})]}),(0,k.jsxs)("div",{className:"flex-1 overflow-y-auto p-6",children:[(0,k.jsxs)("div",{className:"mb-6 p-4 bg-gradient-to-r from-blue-50 to-purple-50 dark:from-blue-900/20 dark:to-purple-900/20 rounded-xl border-2 border-blue-200 dark:border-blue-700",children:[(0,k.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,k.jsx)("div",{className:"w-8 h-8 rounded-full bg-blue-500 flex items-center justify-center",children:(0,k.jsx)(nu,{className:"w-5 h-5 text-white"})}),(0,k.jsxs)("div",{children:[(0,k.jsx)("h3",{className:"font-bold text-gray-900 dark:text-white",children:"P\xe1gina Favorita"}),(0,k.jsx)("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:re?"Clique para definir como p\xe1gina favorita":"Aparece destacada no centro do menu inferior"})]})]}),re&&ee?(0,k.jsxs)("button",{onClick:()=>{D(ee),setTimeout(async()=>{await De(C,ee),B(!1),ae(!1),te(null)},300)},className:"w-full px-4 py-3 bg-gradient-to-r from-blue-500 to-purple-600 text-white rounded-lg font-medium hover:from-blue-600 hover:to-purple-700 transition-all duration-200 flex items-center justify-center gap-2 shadow-lg",children:[(0,k.jsx)(nu,{className:"w-5 h-5"}),'Definir "',null===(t=Ie.find(e=>e.id===ee))||void 0===t?void 0:t.nome,'" como Favorita']}):(0,k.jsx)("select",{value:T,onChange:e=>D(e.target.value),className:"w-full px-4 py-2 bg-white dark:bg-gray-800 border-2 border-blue-300 dark:border-blue-600 rounded-lg text-gray-900 dark:text-white font-medium focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:Ie.map(e=>(0,k.jsx)("option",{value:e.id,children:e.nome},e.id))})]}),(0,k.jsxs)("h3",{className:"font-bold text-gray-900 dark:text-white mb-3 flex items-center gap-2",children:[(0,k.jsx)(M_,{className:"w-5 h-5 text-gray-400"}),"Arraste para Reordenar"]}),(0,k.jsx)("div",{className:"space-y-3",children:C&&Le().map((e,t)=>{const r=C.find(t=>t.id===e.id),a=e.icone,s=H===t,i=W===t;return(0,k.jsxs)("div",{draggable:!0,onDragStart:()=>(e=>{G(e)})(t),onDragOver:e=>((e,t)=>{e.preventDefault(),null!==H&&H!==t&&K(t)})(e,t),onDrop:e=>Pe(e,t),onDragEnd:Fe,className:"flex items-center gap-4 p-4 rounded-xl border-2 transition-all cursor-move ".concat(s?"opacity-50 scale-95":i?"border-yellow-400 dark:border-yellow-500 shadow-lg scale-105":re&&ee===e.id?"bg-gradient-to-r from-purple-100 to-blue-100 dark:from-purple-900/30 dark:to-blue-900/30 border-purple-400 dark:border-purple-500 shadow-xl ring-2 ring-purple-300 dark:ring-purple-600":null!==r&&void 0!==r&&r.visivel?"bg-blue-50 dark:bg-blue-900/20 border-blue-500 dark:border-blue-400":"bg-gray-50 dark:bg-gray-800 border-gray-200 dark:border-gray-700"," ").concat(e.id===T?"ring-2 ring-yellow-400 ring-offset-2 dark:ring-offset-gray-900":""),children:[(0,k.jsx)("div",{className:"flex items-center justify-center",children:(0,k.jsx)(M_,{className:"w-6 h-6 ".concat(null!==r&&void 0!==r&&r.visivel?"text-blue-400 dark:text-blue-300":"text-gray-400 dark:text-gray-500")})}),(0,k.jsxs)("div",{className:"flex items-center gap-3 flex-1",children:[(0,k.jsx)("div",{className:"p-2 rounded-lg ".concat(null!==r&&void 0!==r&&r.visivel?"bg-blue-500 dark:bg-blue-600 text-white":"bg-gray-200 dark:bg-gray-700 text-gray-500 dark:text-gray-400"),children:(0,k.jsx)(a,{className:"w-5 h-5"})}),(0,k.jsxs)("div",{className:"flex-1",children:[(0,k.jsxs)("div",{className:"flex items-center gap-2",children:[(0,k.jsx)("p",{className:"font-medium ".concat(null!==r&&void 0!==r&&r.visivel?"text-gray-900 dark:text-white":"text-gray-500 dark:text-gray-400"),children:e.nome}),re&&ee===e.id&&(0,k.jsxs)("span",{className:"px-2 py-0.5 bg-gradient-to-r from-purple-500 to-blue-500 text-white text-xs font-bold rounded-full flex items-center gap-1 shadow-lg",children:[(0,k.jsx)(R_,{className:"w-3 h-3"}),"Selecionado"]}),e.id===T&&(0,k.jsxs)("span",{className:"px-2 py-0.5 bg-yellow-400 text-yellow-900 text-xs font-bold rounded-full flex items-center gap-1",children:[(0,k.jsx)(nu,{className:"w-3 h-3"}),"Favorito"]})]}),(0,k.jsxs)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Posi\xe7\xe3o: ",t+1]})]})]}),(0,k.jsx)("button",{onClick:()=>(e=>{if(!C)return;const t=C.map(t=>t.id===e?(0,n.A)((0,n.A)({},t),{},{visivel:!t.visivel}):t);I(t)})(e.id),className:"relative inline-flex h-8 w-14 items-center rounded-full transition-colors ".concat(null!==r&&void 0!==r&&r.visivel?"bg-blue-500 dark:bg-blue-600":"bg-gray-300 dark:bg-gray-600"),children:(0,k.jsx)("span",{className:"inline-block h-6 w-6 transform rounded-full bg-white transition-transform ".concat(null!==r&&void 0!==r&&r.visivel?"translate-x-7":"translate-x-1")})})]},e.id)})}),(0,k.jsxs)("div",{className:"mt-8 p-4 bg-gradient-to-br from-gray-100 to-gray-200 dark:from-gray-800 dark:to-gray-900 rounded-xl border-2 border-gray-300 dark:border-gray-700",children:[(0,k.jsxs)("p",{className:"text-sm font-bold text-gray-800 dark:text-gray-200 mb-3 flex items-center gap-2",children:[(0,k.jsx)(pr,{className:"w-4 h-4"}),"Preview do Menu Inferior:"]}),(0,k.jsxs)("div",{className:"flex justify-around items-center bg-white dark:bg-black rounded-xl p-2 border-2 border-gray-300 dark:border-gray-600 shadow-lg",children:[Me().slice(0,2).map(e=>{const t=e.icone;return(0,k.jsxs)("div",{className:"flex flex-col items-center p-2 flex-1",children:[(0,k.jsx)(t,{className:"w-4 h-4 text-gray-500 dark:text-gray-400 mb-1"}),(0,k.jsx)("span",{className:"text-xs text-gray-500 dark:text-gray-400 truncate max-w-full",children:e.nome})]},e.id)}),(()=>{const e=Te(),t=e.icone;return(0,k.jsxs)("div",{className:"flex flex-col items-center p-2 flex-1 relative",children:[(0,k.jsx)("div",{className:"w-8 h-8 rounded-full bg-gradient-to-br from-blue-500 to-blue-600 flex items-center justify-center mb-1 shadow-lg ring-2 ring-blue-300 dark:ring-blue-700",children:(0,k.jsx)(t,{className:"w-4 h-4 text-white"})}),(0,k.jsx)("span",{className:"text-xs text-blue-500 dark:text-blue-400 font-bold truncate max-w-full",children:e.nome}),(0,k.jsx)("div",{className:"absolute -top-1 -right-1",children:(0,k.jsx)(nu,{className:"w-3 h-3 text-yellow-500"})})]})})(),Me().slice(2,3).map(e=>{const t=e.icone;return(0,k.jsxs)("div",{className:"flex flex-col items-center p-2 flex-1",children:[(0,k.jsx)(t,{className:"w-4 h-4 text-gray-500 dark:text-gray-400 mb-1"}),(0,k.jsx)("span",{className:"text-xs text-gray-500 dark:text-gray-400 truncate max-w-full",children:e.nome})]},e.id)}),(0,k.jsxs)("div",{className:"flex flex-col items-center p-2 flex-1",children:[(0,k.jsx)(au,{className:"w-4 h-4 text-gray-500 dark:text-gray-400 mb-1"}),(0,k.jsx)("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Menu"})]})]})]})]}),(0,k.jsxs)("div",{className:"flex justify-end gap-3 p-6 border-t border-gray-200 dark:border-gray-700",children:[(0,k.jsx)("button",{onClick:()=>{B(!1),ae(!1),te(null)},className:"px-6 py-2.5 rounded-full bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 font-medium hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors",children:re?"Fechar":"Cancelar"}),!re&&(0,k.jsx)("button",{onClick:async()=>{await De(C,T),setTimeout(()=>B(!1),500)},className:"px-6 py-2.5 rounded-full bg-blue-500 dark:bg-blue-600 text-white font-medium hover:bg-blue-600 dark:hover:bg-blue-700 transition-colors flex items-center gap-2 shadow-lg",children:Q?(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(lk,{className:"w-4 h-4"}),"Salvo!"]}):(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(uw,{className:"w-4 h-4"}),"Salvar Configura\xe7\xe3o"]})})]})]})}),N&&S&&(0,k.jsx)("div",{className:"fixed inset-0 bg-black/80 z-[110] flex items-center justify-center p-4 backdrop-blur-sm",children:(0,k.jsxs)("div",{className:"bg-white dark:bg-gray-900 rounded-2xl w-full max-w-md shadow-2xl animate-in fade-in zoom-in duration-300",children:[(0,k.jsx)("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:(0,k.jsxs)("div",{className:"flex items-center gap-4",children:[(0,k.jsx)("div",{className:"w-14 h-14 rounded-full bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center flex-shrink-0",children:(0,k.jsx)(Od,{className:"w-7 h-7 text-white"})}),(0,k.jsxs)("div",{children:[(0,k.jsx)("h3",{className:"text-xl font-bold text-gray-900 dark:text-white",children:"N\xedvel de Acesso Alterado"}),(0,k.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-0.5",children:"Suas permiss\xf5es foram atualizadas"})]})]})}),(0,k.jsxs)("div",{className:"p-6 space-y-4",children:[(0,k.jsxs)("div",{className:"bg-blue-50 dark:bg-blue-950/30 rounded-xl p-4 border border-blue-200 dark:border-blue-800",children:[(0,k.jsx)("p",{className:"text-gray-700 dark:text-gray-200 text-center font-medium",children:"Seu n\xedvel de acesso foi alterado para:"}),(0,k.jsxs)("p",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400 text-center mt-2",children:["\u26a1 ",S.newLevelLabel]})]}),(0,k.jsx)("div",{className:"bg-gray-50 dark:bg-gray-800/50 rounded-xl p-4",children:(0,k.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400 text-center",children:["Voc\xea ser\xe1 redirecionado para a p\xe1gina de ",(0,k.jsx)("strong",{children:"notifica\xe7\xf5es"})," para ver os detalhes desta altera\xe7\xe3o."]})})]}),(0,k.jsx)("div",{className:"p-6 border-t border-gray-200 dark:border-gray-700",children:(0,k.jsx)("button",{onClick:()=>{j(!1),g("notificacoes"),console.log("\ud83d\udd14 Redirecionando para notifica\xe7\xf5es ap\xf3s altera\xe7\xe3o de permiss\xe3o"),localStorage.setItem("permission_alert_seen_".concat(r.id,"_").concat(S.newLevel),"true"),setTimeout(()=>{A(!1),console.log("\u2705 Flag de permiss\xe3o alterada limpa. Sistema pode restaurar estado normal.")},1e3)},className:"w-full py-3.5 rounded-full bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700 text-white font-bold text-lg shadow-lg transition-all duration-300 hover:scale-105 active:scale-95",children:"Entendi"})})]})})]})})},Q_=()=>{u();const{usuario:t,loading:r}=Nt(),[a,n]=(0,e.useState)(!1),[s,i]=(0,e.useState)(!1),[o,l]=(0,e.useState)(!1);return(0,e.useEffect)(()=>{if(!r){console.log("\ud83c\udfaf Sistema carregado, iniciando transi\xe7\xe3o suave...");const e=setTimeout(()=>{console.log("\u2705 Iniciando fade-out da tela de loading..."),n(!0),i(!0),setTimeout(()=>{console.log("\ud83d\ude80 Mostrando conte\xfado principal..."),l(!0)},600)},800);return()=>clearTimeout(e)}},[r]),r||!o?(0,k.jsx)(j_,{fadeOut:s}):(0,k.jsx)("div",{className:"animate-fadeIn min-h-screen bg-gray-50 dark:bg-gray-900",children:t?(0,k.jsx)(K_,{}):(0,k.jsx)(V_,{})})},Y_=()=>((()=>{const{usuario:t}=Nt(),r=0===(null===t||void 0===t?void 0:t.nivel),a=(0,e.useCallback)(e=>r?(console.log("Admin detected, allowing all keys"),!0):"F12"===e.key||123===e.keyCode||e.ctrlKey&&e.shiftKey&&["F12","I","J","U","S","P"].includes(e.key)||e.ctrlKey&&"u"===e.key?(e.preventDefault(),!1):void 0,[r]),n=(0,e.useCallback)(e=>{if(r){e.preventDefault();const t=e.target.outerHTML;return navigator.clipboard.writeText(t).then(()=>{alert("HTML copiado para a \xe1rea de transfer\xeancia!"),console.log("HTML copiado:",t)}).catch(e=>{console.error("Erro ao copiar HTML:",e),alert("Erro ao copiar HTML. Verifique o console.")}),!1}return e.preventDefault(),!1},[r]);(0,e.useEffect)(()=>{if(console.log("Security block effect running, isAdmin:",r),!r){function e(){const e=window.outerWidth-window.innerWidth>160,t=window.outerHeight-window.innerHeight>160;(e||t)&&window.location.reload()}window.addEventListener("keydown",a),window.addEventListener("contextmenu",n);const t=setInterval(e,1e3);return()=>{window.removeEventListener("keydown",a),window.removeEventListener("contextmenu",n),clearInterval(t)}}},[a,n,r])})(),(0,k.jsx)(W_,{children:(0,k.jsx)(U_,{children:(0,k.jsx)(zS,{children:(0,k.jsx)(E,{children:(0,k.jsx)(ir,{children:(0,k.jsx)(BN,{children:(0,k.jsx)(MN,{children:(0,k.jsxs)(sS,{children:[(0,k.jsx)(Q_,{}),(0,k.jsx)(Hd,{}),(0,k.jsx)($d,{})]})})})})})})})})),X_=t=>{let{children:r}=t;const[a,n]=(0,e.useState)(!1),[s,i]=(0,e.useState)(0),[o,l]=(0,e.useState)("Iniciando sistema..."),[c,d]=(0,e.useState)(!1),h=u();(0,e.useEffect)(()=>{if(h)return;(async()=>{const e=[{progress:15,text:"Verificando seguran\xe7a...",action:async()=>{await m(),await f()}},{progress:30,text:"Conectando ao banco de dados...",action:async()=>{await g(),await p()}},{progress:50,text:"Carregando configura\xe7\xf5es...",action:async()=>{await x(),await y()}},{progress:70,text:"Preparando componentes...",action:async()=>{await v(),await b()}},{progress:85,text:"Validando credenciais...",action:async()=>{await w(),await N()}},{progress:95,text:"Carregando interface...",action:async()=>{await j(),await S()}},{progress:100,text:"Sistema pronto!",action:async()=>{await _()}}];for(let r=0;r<e.length;r++){const a=e[r];l(a.text);try{await a.action()}catch(t){console.error("Erro no est\xe1gio ".concat(r+1,":"),t)}const n=s,o=a.progress,c=10,d=30,u=(o-n)/c;for(let e=0;e<c;e++)await new Promise(e=>setTimeout(e,d)),i(e=>{const t=e+u;return Math.min(t,o)});i(o)}await new Promise(e=>setTimeout(e,200)),d(!0),await new Promise(e=>setTimeout(e,300)),n(!0)})()},[h]);const m=async()=>{await new Promise(e=>setTimeout(e,50))},f=async()=>{await new Promise(e=>setTimeout(e,50))},g=async()=>{await new Promise(e=>setTimeout(e,100))},p=async()=>{await new Promise(e=>setTimeout(e,50))},x=async()=>{await new Promise(e=>setTimeout(e,50))},y=async()=>{await new Promise(e=>setTimeout(e,50))},v=async()=>{await new Promise(e=>setTimeout(e,100))},b=async()=>{await new Promise(e=>setTimeout(e,50))},w=async()=>{await new Promise(e=>setTimeout(e,100))},N=async()=>{await new Promise(e=>setTimeout(e,50))},j=async()=>{await new Promise(e=>setTimeout(e,50))},S=async()=>{await new Promise(e=>setTimeout(e,50))},_=async()=>{await new Promise(e=>setTimeout(e,50))};return h?null:a?(0,k.jsx)("div",{style:{animation:"fadeIn 0.5s ease-in-out",width:"100%",height:"100%"},children:r}):(0,k.jsx)(j_,{progress:s,loadingText:o,isComplete:c})},J_=()=>(0,k.jsx)(X_,{children:(0,k.jsx)(dr,{children:(0,k.jsx)(Y_,{})})});t.createRoot(document.getElementById("root")).render((0,k.jsx)(J_,{})),Vd()})()})();