# ğŸ—ï¸ Arquitetura do Sistema de Backup AutomÃ¡tico

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         ğŸ–¥ï¸ APLICAÃ‡ÃƒO REACT                          â”‚
â”‚                                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                    ğŸ“± App.jsx                               â”‚   â”‚
â”‚  â”‚                                                              â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚  â”‚     <DatabaseRotationProvider>                     â”‚   â”‚   â”‚
â”‚  â”‚  â”‚                                                      â”‚   â”‚   â”‚
â”‚  â”‚  â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚   â”‚
â”‚  â”‚  â”‚   â”‚  ğŸ¯ useDatabaseRotation Hook                â”‚ â”‚   â”‚   â”‚
â”‚  â”‚  â”‚   â”‚                                               â”‚ â”‚   â”‚   â”‚
â”‚  â”‚  â”‚   â”‚  â€¢ activeDatabase: 'primary'/'backup'       â”‚ â”‚   â”‚   â”‚
â”‚  â”‚  â”‚   â”‚  â€¢ lastRotation: Date                        â”‚ â”‚   â”‚   â”‚
â”‚  â”‚  â”‚   â”‚  â€¢ nextRotation: Date                        â”‚ â”‚   â”‚   â”‚
â”‚  â”‚  â”‚   â”‚  â€¢ isRotating: boolean                       â”‚ â”‚   â”‚   â”‚
â”‚  â”‚  â”‚   â”‚  â€¢ isSyncing: boolean                        â”‚ â”‚   â”‚   â”‚
â”‚  â”‚  â”‚   â”‚  â€¢ syncProgress: {current, total, %}         â”‚ â”‚   â”‚   â”‚
â”‚  â”‚  â”‚   â”‚  â€¢ forceRotation()                           â”‚ â”‚   â”‚   â”‚
â”‚  â”‚  â”‚   â”‚  â€¢ forceSync()                               â”‚ â”‚   â”‚   â”‚
â”‚  â”‚  â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚   â”‚
â”‚  â”‚  â”‚                       â†“                            â”‚   â”‚   â”‚
â”‚  â”‚  â”‚   â° Timer: Verifica a cada 1 minuto              â”‚   â”‚   â”‚
â”‚  â”‚  â”‚   ğŸ”„ Auto-rotaÃ§Ã£o quando >= 24h                   â”‚   â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â”‚                       â†“                                    â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚  â”‚         ğŸ›ï¸ DatabaseRotationPanel                  â”‚   â”‚   â”‚
â”‚  â”‚  â”‚                                                      â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  [ğŸ“Š Status]  [â° Countdown]  [ğŸ”„ Actions]         â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  [ğŸ“œ History] [â„¹ï¸ Info]                            â”‚   â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                     â”‚
â”‚                              â†“                                      â”‚
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚              ğŸ”§ DatabaseManager (Singleton)                â”‚   â”‚
â”‚  â”‚                                                              â”‚   â”‚
â”‚  â”‚  â€¢ activeDatabase: string (localStorage)                   â”‚   â”‚
â”‚  â”‚  â€¢ lastRotation: Date (localStorage)                       â”‚   â”‚
â”‚  â”‚  â€¢ listeners: Array<callback>                              â”‚   â”‚
â”‚  â”‚                                                              â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚   â”‚
â”‚  â”‚  â”‚ getActiveDb â”‚  â”‚switchDatabaseâ”‚  â”‚needsRotationâ”‚       â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                     â”‚
â”‚                              â†“                                      â”‚
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚         ğŸ”„ FirebaseSyncService                             â”‚   â”‚
â”‚  â”‚                                                              â”‚   â”‚
â”‚  â”‚  â€¢ copyCollection(name, options)                           â”‚   â”‚
â”‚  â”‚  â€¢ syncCollection(name, timestampField)                    â”‚   â”‚
â”‚  â”‚  â€¢ copyAllCollections(collections, onProgress)             â”‚   â”‚
â”‚  â”‚  â€¢ syncAllCollections(collections, onProgress)             â”‚   â”‚
â”‚  â”‚                                                              â”‚   â”‚
â”‚  â”‚  Recursos:                                                  â”‚   â”‚
â”‚  â”‚  - Batching (500 docs/batch)                               â”‚   â”‚
â”‚  â”‚  - ComparaÃ§Ã£o de timestamps                                â”‚   â”‚
â”‚  â”‚  - SincronizaÃ§Ã£o bidirecional                              â”‚   â”‚
â”‚  â”‚  - Progress callbacks                                       â”‚   â”‚
â”‚  â”‚  - Error handling                                           â”‚   â”‚
â”‚  â”‚  - Logging detalhado                                        â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                     â”‚
â”‚                              â†“                                      â”‚
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚              ğŸ”¥ Firebase Configuration                     â”‚   â”‚
â”‚  â”‚                                                              â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚   â”‚
â”‚  â”‚  â”‚   Primary Firebase  â”‚      â”‚   Backup Firebase   â”‚     â”‚   â”‚
â”‚  â”‚  â”‚   garden-c0b50      â”‚      â”‚   garden-backup     â”‚     â”‚   â”‚
â”‚  â”‚  â”‚                     â”‚      â”‚                     â”‚     â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ primaryDb        â”‚      â”‚  â€¢ backupDb         â”‚     â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ primaryAuth      â”‚      â”‚  â€¢ backupAuth       â”‚     â”‚   â”‚
â”‚  â”‚  â”‚  â€¢ primaryStorage   â”‚      â”‚  â€¢ backupStorage    â”‚     â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚   â”‚
â”‚  â”‚            â†‘                            â†‘                   â”‚   â”‚
â”‚  â”‚            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚   â”‚
â”‚  â”‚                         |                                    â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚   â”‚
â”‚  â”‚  â”‚  ğŸ”€ Proxy DinÃ¢mico                                â”‚      â”‚   â”‚
â”‚  â”‚  â”‚                                                    â”‚      â”‚   â”‚
â”‚  â”‚  â”‚  export const db = Proxy â†’ activeDatabase        â”‚      â”‚   â”‚
â”‚  â”‚  â”‚  export const auth = Proxy â†’ activeDatabase      â”‚      â”‚   â”‚
â”‚  â”‚  â”‚  export const storage = Proxy â†’ activeDatabase   â”‚      â”‚   â”‚
â”‚  â”‚  â”‚                                                    â”‚      â”‚   â”‚
â”‚  â”‚  â”‚  (Sempre aponta para o database ativo)           â”‚      â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      â˜ï¸ FIREBASE CLOUD                              â”‚
â”‚                                                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚    ğŸ”µ Firebase Principal     â”‚    â”‚    ğŸŸ£ Firebase Backup    â”‚ â”‚
â”‚  â”‚    Project: garden-c0b50     â”‚    â”‚  Project: garden-backup  â”‚ â”‚
â”‚  â”‚                               â”‚    â”‚                           â”‚ â”‚
â”‚  â”‚  ğŸ“¦ ColeÃ§Ãµes:                â”‚    â”‚  ğŸ“¦ ColeÃ§Ãµes:            â”‚ â”‚
â”‚  â”‚  â€¢ usuarios                  â”‚â—„â”€â”€â–ºâ”‚  â€¢ usuarios              â”‚ â”‚
â”‚  â”‚  â€¢ mensagens                 â”‚    â”‚  â€¢ mensagens             â”‚ â”‚
â”‚  â”‚  â€¢ notificacoes              â”‚    â”‚  â€¢ notificacoes          â”‚ â”‚
â”‚  â”‚  â€¢ tarefas                   â”‚    â”‚  â€¢ tarefas               â”‚ â”‚
â”‚  â”‚  â€¢ emprestimos               â”‚    â”‚  â€¢ emprestimos           â”‚ â”‚
â”‚  â”‚  â€¢ inventario                â”‚    â”‚  â€¢ inventario            â”‚ â”‚
â”‚  â”‚  â€¢ empresas                  â”‚    â”‚  â€¢ empresas              â”‚ â”‚
â”‚  â”‚  â€¢ setores                   â”‚    â”‚  â€¢ setores               â”‚ â”‚
â”‚  â”‚  â€¢ cargos                    â”‚    â”‚  â€¢ cargos                â”‚ â”‚
â”‚  â”‚  â€¢ presenca                  â”‚    â”‚  â€¢ presenca              â”‚ â”‚
â”‚  â”‚  â€¢ horarios                  â”‚    â”‚  â€¢ horarios              â”‚ â”‚
â”‚  â”‚  â€¢ folgas                    â”‚    â”‚  â€¢ folgas                â”‚ â”‚
â”‚  â”‚  â€¢ configuracoes             â”‚    â”‚  â€¢ configuracoes         â”‚ â”‚
â”‚  â”‚                               â”‚    â”‚                           â”‚ â”‚
â”‚  â”‚  ğŸ”’ Auth                     â”‚    â”‚  ğŸ”’ Auth                 â”‚ â”‚
â”‚  â”‚  ğŸ“ Storage                  â”‚    â”‚  ğŸ“ Storage              â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚            â†‘                                    â†‘                  â”‚
â”‚            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€ SincronizaÃ§Ã£o â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â”‚                    (Bidirecional, a cada 24h)                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”„ Fluxo de RotaÃ§Ã£o

```
   Hora 0                    Hora 24                   Hora 48
     |                          |                          |
     |    Sistema usa           |    ğŸ”„ ROTAÃ‡ÃƒO           |    Sistema usa
     |    Primary               |                          |    Primary
     |         â†“                |         â†“                |         â†“
     |    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”          |    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”          |    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     |    â”‚ Primary â”‚ âœ…       |    â”‚ Backup  â”‚ âœ…       |    â”‚ Primary â”‚ âœ…
     |    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          |    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          |    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     |    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”          |    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”          |    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     |    â”‚ Backup  â”‚ ğŸ’¤       |    â”‚ Primary â”‚ ğŸ’¤       |    â”‚ Backup  â”‚ ğŸ’¤
     |    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          |    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          |    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     |                          |                          |
     |                          | 1. Sincronizar dados    |
     |                          | 2. Alternar database    |
     |                          | 3. Salvar histÃ³rico     |
     |                          |                          |
```

## ğŸ“Š Fluxo de SincronizaÃ§Ã£o

```
1. ANTES DA ROTAÃ‡ÃƒO
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  Primary    â”‚         â”‚   Backup    â”‚
   â”‚             â”‚         â”‚             â”‚
   â”‚  Docs: 500  â”‚         â”‚  Docs: 480  â”‚
   â”‚  (novos)    â”‚         â”‚  (antigos)  â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

2. DURANTE SINCRONIZAÃ‡ÃƒO
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  Primary    â”‚    ğŸ”„   â”‚   Backup    â”‚
   â”‚             â”‚ â”€â”€â”€â”€â”€â”€â–º â”‚             â”‚
   â”‚  Copiando   â”‚ â—„â”€â”€â”€â”€â”€â”€ â”‚  Copiando   â”‚
   â”‚  20 docs    â”‚    ğŸ”„   â”‚  5 docs     â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
   
   Progresso: â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘ 65%

3. APÃ“S SINCRONIZAÃ‡ÃƒO
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  Primary    â”‚    âœ…   â”‚   Backup    â”‚
   â”‚             â”‚         â”‚             â”‚
   â”‚  Docs: 500  â”‚    â•    â”‚  Docs: 500  â”‚
   â”‚  (idÃªntico) â”‚         â”‚  (idÃªntico) â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

4. ROTAÃ‡ÃƒO COMPLETA
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  Primary    â”‚         â”‚   Backup    â”‚
   â”‚     ğŸ’¤      â”‚         â”‚     âœ…      â”‚
   â”‚  (inativo)  â”‚         â”‚   (ativo)   â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ¯ Componentes e Responsabilidades

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  firebaseDual.js                                       â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚
â”‚  â€¢ Inicializa ambos os Firebases                      â”‚
â”‚  â€¢ Cria DatabaseManager (singleton)                   â”‚
â”‚  â€¢ Gerencia database ativo                            â”‚
â”‚  â€¢ Persiste escolha no localStorage                   â”‚
â”‚  â€¢ Exporta proxies dinÃ¢micos (db, auth, storage)      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  firebaseSync.js                                       â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚
â”‚  â€¢ copyCollection() - Copia coleÃ§Ã£o completa          â”‚
â”‚  â€¢ syncCollection() - Sincroniza bidirecionalmente    â”‚
â”‚  â€¢ copyAllCollections() - Copia todas                 â”‚
â”‚  â€¢ syncAllCollections() - Sincroniza todas            â”‚
â”‚  â€¢ Batching automÃ¡tico (500 docs)                     â”‚
â”‚  â€¢ ComparaÃ§Ã£o de timestamps                           â”‚
â”‚  â€¢ Logging detalhado                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  useDatabaseRotation.js                                â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚
â”‚  â€¢ Timer de verificaÃ§Ã£o (1 min)                       â”‚
â”‚  â€¢ Auto-rotaÃ§Ã£o quando >= 24h                         â”‚
â”‚  â€¢ forceRotation() - RotaÃ§Ã£o manual                   â”‚
â”‚  â€¢ forceSync() - SincronizaÃ§Ã£o manual                 â”‚
â”‚  â€¢ Callbacks (onRotationStart, onComplete, etc)       â”‚
â”‚  â€¢ Estado (isRotating, isSyncing, syncProgress)       â”‚
â”‚  â€¢ HistÃ³rico de rotaÃ§Ãµes                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  DatabaseRotationContext.jsx                           â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚
â”‚  â€¢ Provider do Context                                 â”‚
â”‚  â€¢ Integra useDatabaseRotation                        â”‚
â”‚  â€¢ Gerencia notificaÃ§Ãµes visuais                      â”‚
â”‚  â€¢ ExpÃµe API para componentes                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  DatabaseRotationPanel.jsx                             â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚
â”‚  â€¢ UI visual do sistema                                â”‚
â”‚  â€¢ Cards de status                                     â”‚
â”‚  â€¢ Progress bar de sync                                â”‚
â”‚  â€¢ BotÃµes de aÃ§Ã£o (rotaÃ§Ã£o/sync manual)               â”‚
â”‚  â€¢ HistÃ³rico de rotaÃ§Ãµes                               â”‚
â”‚  â€¢ Modal de informaÃ§Ãµes                                â”‚
â”‚  â€¢ AnimaÃ§Ãµes (Framer Motion)                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ” Fluxo de SeguranÃ§a

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  CONFIGURAÃ‡ÃƒO                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Firebase Principal (Criptografado)  â”‚
    â”‚                                       â”‚
    â”‚  encryptedConfig = {                â”‚
    â”‚    "_k": "base64...",               â”‚
    â”‚    "_d": "base64...",               â”‚
    â”‚    ...                               â”‚
    â”‚  }                                   â”‚
    â”‚                                       â”‚
    â”‚  decrypt() â†’ config real            â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  AUTENTICAÃ‡ÃƒO                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†“
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Firebase Auth                       â”‚
    â”‚                                       â”‚
    â”‚  auth.onAuthStateChanged(user) {    â”‚
    â”‚    if (user) {                       â”‚
    â”‚      user.getIdToken(true);         â”‚
    â”‚    }                                 â”‚
    â”‚  }                                   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  FIRESTORE RULES (Ambos os projetos)                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†“
    allow read, write: if request.auth != null;
```

---

**Legenda:**
- ğŸ”µ Firebase Principal (garden-c0b50)
- ğŸŸ£ Firebase Backup (garden-backup)
- âœ… Database Ativo
- ğŸ’¤ Database Inativo
- ğŸ”„ Sincronizando
- â° Timer Ativo
- ğŸ“¦ ColeÃ§Ã£o
- ğŸ”’ AutenticaÃ§Ã£o
- ğŸ“ Storage

**Data**: 04/10/2025  
**VersÃ£o**: 1.0.0
